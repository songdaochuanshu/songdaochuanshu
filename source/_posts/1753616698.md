---
layout: post
title: "ArcObjects SDK开发 016 在ArcMap中使用Toolbox"
date: "2022-12-15T09:16:32.233Z"
---
ArcObjects SDK开发 016 在ArcMap中使用Toolbox
======================================

**1、如何找到ToolBox**

通过Geoprocessing菜单上的ArcToolbox菜单项，可以打开ArcToolbox面板。

![image1.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517311-183292723.png)

工具栏上也有一个ArcToolbox的按钮，点击该按钮也可以打开。

![image2.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517303-979197555.png)

通过Arccatalog打开。

![image3.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517472-261889825.png)

**2、ArcToolbox面板**

ArcToolbox面板如下图所示。

![image4.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517441-1337128401.png)

ArcToolbox共分为三级，工具箱、工具集和工具。我们经常遇到的有前面带锤子的工具，是ArcGIS安装的时候就安装和注册的系统工具，前面是文本样式的是用py脚本创建的工具，但用的时候，感觉没什么差别。

**3、具体使用一个Tool**

如果想使用某个Tool，可以双击该工具的名称。弹出该工具的参数设置面板，如下图所示。

![image5.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517418-652495267.png)

前面带绿色点的参数为必须要设置的参数，例如输入的矢量数据、输出的矢量数据以及缓冲距离信息等。其他参数名字后面带（optional）为可选参数。

下面共5个按钮。点击OK按钮可执行当前工具。点击Cancel按钮取消设置，并关闭该对话框。点击Environments按钮，可设置Toolbox执行的环境。点击Hide Help按钮可以设置是否显示右侧的帮助面板。点击Tool Help按钮，可以查看该工具的详细信息。点击该按钮弹出的对话框如下图所示。

![image6.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517482-1613154786.png)

该帮助作用非常大，一般会包括以下几个部分。

概要信息，说明该工具主要是做什么用的。

图解信息，有些和图形关系较大的工具会有图解信息。

用法，描述该工具的常用方法。

语法，调用方法，在该模块会介绍各个参数的类型、描述信息以及如何设置等。

代码示例，会提供py脚本的代码示例。

环境设置。

许可信息，是Basic、Standard还是Advanced级别才可以使用。

相关主题，一般是和该工具关联的主题的链接，通过这些链接可以更深入的了解该工具的一些原理、扩展等信息。

**4、如何查看Tool执行结果**

点击OK按钮执行后，执行结果数据一般会直接加载到地图上。点击Geoprocessing菜单下的Results按钮，可以查看执行的Tool的结果。如下图所示。

![image7.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517401-1031063656.png)

该面板记录了本次ArcMap周期内执行的结果信息。包括设置的各种参数，运行环境以及运行过程中的消息记录。在Results面板中，选中一个Tool，点击右键，有很多功能项，如下图所示。

![image8.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517395-1273352686.png)

点击Open按钮可以再次打开工具面板，并且参数是当前已经运行结果的参数。Copy As Python Snippet这个按钮费用有用，点击该按钮，可以把工具执行的内容转换成py脚本代码，这样我们就 可以参考在ArcObjects SDK中调用该工具的时候如何设置参数了。Share As可以把该工具在ArcServer中发布成服务，Save As可以把该工具保存成一个文件。

**5、环境设置**

在具体执行一个Tool的时候，在其下面的按钮中会有设置环境按钮，点击如下图所示。

![image9.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517484-205383268.png)

一些我们常用的环境参数记住即可。例如在做点插值成栅格数据的时候，使用江苏省的雨量站插值降雨数据。如果默认处理，这些点生成的栅格数据肯定不足以覆盖整个江苏省。那就需要在Processing Extent设置要生成的结果数据的范围。

再例如，做水系生成的时候，如果默认的话，在Fill的时候会报错。把Parallel Processing中的线程数修改为0即可。

这些参数如何设置以配合各Tool的使用，需要我们在日常使用的时候，自己去摸索。

**6、****其他功能**

![image10.png](https://img2023.cnblogs.com/blog/146887/202212/146887-20221215160517299-322127994.png)

Search For Tool可以通过关键字查找Tool。ModelBuilder是模型构建器，可以把多个模型按照一定的逻辑整合到一起，完成一个复杂的业务模型。Python是写py脚本的界面。Geoprocessing Options为处理器设置，在该界面中可以设置结果是否覆盖、结果数据在默认目录下保存多长时间等。