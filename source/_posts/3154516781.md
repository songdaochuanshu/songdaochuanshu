---
layout: post
title: "go-zero 微服务实战系列（一、开篇）"
date: "2022-06-06T07:16:12.443Z"
---
go-zero 微服务实战系列（一、开篇）
=====================

前言
--

在社区中经常看到有人问有没有基于 go-zero 的比较完整的项目参考，该类问题本质上是想知道基于 go-zero 的项目的最佳实践。完整的项目应该是一个完整的产品功能，包含产品需求、架构设计、关键流程的编码、表设计以及各种性能优化和数据一致性等，是一个真正贴近生产级的项目，是可以直接拿来在自己的生产项目中进行参考的，而目前社区并没有类似的比较完整的开源项目参考，因此决定和大家一起从零开始基于 go-zero 构建一个完整的贴近生产的项目。

该系列的主题是基于 go-zero 构建一个高并发的系统，为神马要选择这个主题呢？我猜大家一定感受到了 CRUD 的枯燥，而是希望项目是高并发的是带有一定挑战的，可能我们工作中的项目请求量比较低，主要以实现功能为主。但是，现代的互联网产品随时都有面对突发大流量的可能，比如我们的商城平时可能业务流量比较平稳，但某一天运营突然说要做一次秒杀活动来推广，如果没有提前做好应对高并发的准备，我们的服务很可能是扛不住的，结果也就可想而知。所以我们平时就需要提前储备足够多的高并发的知识，当遇到高并发需求的场景的时候就能够从容应对。

该系列为实战系列，过于基础的知识可能会比较少涉及，所以需要大家具备以下基础能力：

*   了解go语言语法和基本使用姿势，[请参考文档](https://go.dev/doc/)
*   本系列项目数据库使用Mysql，[请参考文档](https://dev.mysql.com/doc/)
*   本系列项目缓存使用Redis，[请参考文档](https://redis.io/docs/)
*   本系列项目消息队列使用Kafka，[请参考文档](https://kafka.apache.org/documentation/)
*   了解go-zero基本使用，[请参考文档](https://go-zero.dev/)

为什么选择go-zero？
-------------

go-zero 为我们提供了许多高并发场景下的实用工具，比如为了降低接口耗时我们往往需要并发的请求依赖的服务，这个时候我们可以使用 [mapreduce](https://github.com/zeromicro/go-zero/tree/master/core/mr) 并行的处理请求；面对海量请求为了降低Redis压力和提高响应时间，我们可以使用 [collection](https://github.com/zeromicro/go-zero/tree/master/core/collection) 构建本地缓存；避免用户连续请求造成服务压力可以使用 [limit](https://github.com/zeromicro/go-zero/tree/master/core/limit) 做用户级别的限流等等。好的框架能够给我的项目开发带来事半功倍的效果，Go-zero的简洁易用性与内置的开箱即用的工具和服务治理能力助力我们构建一个高并发高可靠的系统。

产品需求
----

为了更加贴近我们真实的项目开发，项目会基于真实的产品需求进行构建。商城是我们平时接触比较多而又比较复杂的系统，所以我们决定通过构建商城系统来和大家一起学习如何基于 go-zero 构建高并发系统。商城的功能点非常多，我们没有办法把所有的功能点都一一演示，但会实现一个 [mvp版本](https://baike.baidu.com/item/MVP/3714440)，我们会在mvp版本中把 go-zero 的核心功能和构建高并发商城系统的核心点都演示出来。

如下思维导图列出了该电商系统主要实现的功能：

![](https://oscimg.oschina.net/oscnet/up-707d73c4b9202cdb4a0665cb0b17675c2dd.png)

产品原型图
-----

原型图是我们实现功能的主要参考，下面列出了商城系统主要的页面UI，通过这些UI在心中可以大致构建出系统的架构，构建不出来也木有问题，跟随文章一点点前进即可，奥利给！！！

### 首页和分类原型图

可以看到首页功能比较复杂，包含了搜索功能、Banner轮播图、抢购入口、排行榜、推荐等，分类中包含了不同分类的推荐商品

![](https://oscimg.oschina.net/oscnet/up-309e8f5d65172e1f7af2005e40bca3f142a.png)

![](https://oscimg.oschina.net/oscnet/up-f0ecc79008943bbc6a4a3d7cf51d2776756.png)

### 购物车和我的订单原型图

购物车展示了当前登录用户的购物车商品列表，除了商品基本信息还包括了商品数量。我的订单列表中展示了处于不同状态的商品列表

![](https://oscimg.oschina.net/oscnet/up-99de76dda74a9325f5b10d3f7ea44c33418.png)

![](https://oscimg.oschina.net/oscnet/up-4877a0de179e3f2dea5252ac2581c7fdde4.png)

### 商品详情和商品评价原型

商品详情展示了商品的详情信息，同时在该页面可以添加购物车以及立即购买等，用户还可以点击收藏对该商品进行收藏，商品的评价功能是必不可少的，你是不是在购买某件商品的时候也会先看看该商品的用户评价呢？

![](https://oscimg.oschina.net/oscnet/up-2fc3cd17d6f4533b88bd7dc514cc0113da0.png)

![](https://oscimg.oschina.net/oscnet/up-7179acbf0dc5cd29d762331b9f3e1c62a51.png)

以上贴出了商城项目主要实现的功能点和主要页面的原型图，我们的项目也会围绕这些主要的功能点展开。比较核心的功能点，比如请求量非常高的首页Banner我们如何优化，抢购商品如何保证不超卖，交易过程中分布式事务的实现等我们都会重点介绍。

系列文章目录
------

第一篇即为本篇文章，主要对项目做一个概览。

第二篇文章会介绍我们的微服务的划分以及工程目录结构的定义和使用 [_goctl_](https://go-zero.dev/cn/docs/goctl/goctl) 做一些项目代码的初始化工作。

第三篇文章会先定义项目的 API，只有定义好 API 协议之后才能真正的开始写代码，如何协议定义的不清楚会大大增加项目返工的几率，定义好API后紧接着我们需要进行表结构设计，数据库我们使用 MySQL。

第四篇文章主要是和大家一起熟悉下 go-zero 的基本使用，主要包括数据库的增删改查，缓存的操作，自定义中间件，常用工具包比如 mapreduce 的使用等等。

第五六七篇我们着重介绍缓存的使用姿势，在高并发系统中缓存的地位不言而喻，不夸张的说如何缓存设计的不好，那高并发系统也就不复存在。我们会介绍如何利用缓存优化请求量巨大的首页Banner，商品列表缓存实现，以及常见的Cache Aside模式代码该怎么写，还有缓存的一致性、击穿、穿透、雪崩等优化等等。

第八篇和第九篇会介绍如何实现一个简单的秒杀功能，秒杀功能可谓是高并发读和高并发写的典型代表，通过这两篇可以了解到秒杀功能的优化技巧和基本姿势。

第十篇介绍在微服务架构下经常遇到的分布式事务的问题，经过微服务拆分后，微服务间独占数据库，没法利用本地事务，通过该篇文章可以了解到在 go-zero 中的分布式事务的实现方式。

第十一篇介绍我们的业务代码如何写单元测试。

第十二篇服务的可观测性，上线后的服务需要具有可观测性，包括日志、指标监控、链路追踪等。

第十三篇我们会把服务部署上线并进行功能测试。

![](https://oscimg.oschina.net/oscnet/up-bca89f065455ec15b1c540401f48af6080d.png)

结束语
---

本篇文章首先介绍了该系列由来的背景以及我们为什么会选择构建高并发系统这个主题，接着介绍了我们需要构建的高并发的商城系统的主要功能点以及主要的页面原型图，最后列出了本系列的文章标题列表，通过标题列表可以快速了解整个系列的知识体系。

构建一个高并发的系统并不是一件容易的事情，涉及的知识点非常多，但我相信只要我们一起努力就一定能克服这些困难，让自己的技术能力更上一层楼。好在我们可以站在巨人的肩膀上，go-zero 为我们提供了非常强大的构建高并发服务的能力，为我们的系统保驾护航。

希望本篇文章对你有所帮助，谢谢。

_每周一、周四更新_

参考
--

_[https://github.com/zhoushuguang/lebron](https://github.com/zhoushuguang/lebron)_

项目地址
----

[https://github.com/zeromicro/go-zero](https://github.com/zeromicro/go-zero)

欢迎使用 `go-zero` 并 **star** 支持我们！

微信交流群
-----

关注『**微服务实践**』公众号并点击 **交流群** 获取社区群二维码。