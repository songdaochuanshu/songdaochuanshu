---
layout: post
title: "Ros入门21讲"
date: "2022-09-08T19:17:55.797Z"
---
Ros入门21讲
========

一、ROS是什么？
---------

**ROS=通信机制+开发工具+应用功能+生态系统**

**目的：提高机器人研发中的软件复用率。**

### 1、ROS中的通信机制

松耦合分布式通信：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906081510918-701031545.png)

注意：什么是耦合、紧耦合、松耦合？

#### 1.1 耦合

　　**耦合**是两个或多个模块之间的相互关联。在软件工程中，两个模块之间的耦合度越高，维护成本越高。因此，在系统架构的设计过程中，应减少各个模块之间的耦合度，以提高应用的可维护性。

#### 1.2 紧耦合

　　**紧耦合**架构本质是Client/Server的模型，如下图所示：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082124966-86756397.png)

优点是：架构简单、设计简单、开发周期短、能够快速的开发、投入、部署、应用。 但随着集群规模的扩大，系统的稳定性逐渐变差，主要原因如下： 1、同步操作导致对网络资源消耗大。同步操作在数据发送和数据返回之间，有很大一段是空闲的，这种空闲占用是对网络资源的极大浪费。 2、安全控制力度差，因为服务器直接暴露给客户机，容易引发网络攻击行为。 3、程序代码之间关联度过高，不利于模块化处理。

#### 1.3 松耦合

　　**松耦合**架构本质上是在client/server模型之间加入一个代理，把CS模型变成CAS模型。 在新的架构下，客户机的角色不变，代理服务器承担起与客户机的通信，和对客户机的识别判断工作，服务器位于代理服务器后面，对客户机来说不可见，它只负责数据处理工作，另外我们也把CS模型的同步操作改为CAS的代理处理。 如下图所示：

 ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082152693-1818007641.png)

优点如下：

1、多任务并行处理能力获得极大提升。

2、实现负载自适应机制（根据当时运行环境，松耦合架构分配并行工作任务，避免超载现象）。

3、基本杜绝了对Server服务端的网络攻击行为，由于代理服务器的隔绝和筛查作用， 同时结合其它安全管理手段，外部攻击在代理服务器处就被识别和过滤掉了，这样就保护了后面的服务器不受影响。

4、异步操作减少了网络资源消耗和操作关联。

5、提高了系统的可维护性。

原文链接：https://blog.csdn.net/liguangyao213/article/details/123940756

### 2、ROS中的开发工具

#### 2.1命令行&编译器

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082744420-708805099.png)

#### 2.2 TF坐标变换

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082819731-1657397753.png)

####  2.3 QT工具箱

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082852696-1269569041.png)

#### 2.4 Rviz

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906082955451-1193675457.png)

####  2.5 Gazebo

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906083016404-1348964784.png)

###  3、ROS中的应用功能

#### 3.1 Navigation

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906083534616-1201372642.png)

####  3.2 SLAM

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906083604310-1615410836.png)

####  3.3 MoveIt

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906083636619-1497316942.png)

### 4、ROS 中的生态系统

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906083740299-1808439259.png)

二、ROS中的核心概念
-----------

### 1、通信机制

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906085511375-1309148320.png)

### 2、节点与节点管理器

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906090313688-1982257095.png)

###  3、话题通信

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906090817665-1301112406.png)

###  4、服务通信

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906091530020-654198207.png)

###  5、话题VS服务

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906091813746-658020446.png)

###  6、参数

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906092034735-2128829911.png)

### 7、文件系统

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906092342815-580614102.png)

###  三、ROS命令行工具的使用

**常用命令**

**rpt\_graph**  
**rostopic**  
**rosservice**  
**rosnode**  
**rosparam**  
**rosmsg**  
**rossrv**

 以小海龟为例子：

首先启动 ROS Master：

roscore

然后启动小海龟仿真器：

rosrun turtlesim turtlesim\_node

最后要启动小海龟控制节点：

rosrun tuetlesim turtle\_teleop\_key

注意：rosrun（运行对应节点） 用法：rosrun + 功能包 + 功能包结点

例如： rosrun turtlesim

其中，turtlesim是ros安装好后带的学习用的功能包，输入完代码以后双击tab键可以显示出其所有节点。

### 1、rpt\_graph

命令：rpt\_graph

功能：显示系统计算处理工具。

图示：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907220557355-1508636309.png)

右边为**仿真器节点** 左边为**键盘控制节点** 中间turtle1为**话题**（数据）

### 2、rostopic

命令：rostopic list

功能：显示所有的**话题列表**

图示：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906113834393-409436994.png)

  输入 rostopic pub /turtle1/cnd\_vel geometry\_msgs/Twist "linear: +两下tap显示海龟的位置、速度等信息

解析：pub是发布一个话题；/turtle1/cnd\_vel是话题名；后面内容Tab键补全消息结构，双引号的内容为消息结构的具体数据，linear是线速度，angular是角速度

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906113925745-496578862.png)

 此时可以修改上方x y z改速度，修改下方x、y、z改角度（左右方向键选择对应数据更改）

    因为数据是发一次收一次，所以海龟只会短时间运动，如果要长时间运动，则需要给发送频率，

代码修改如下：

​             rostopic pub -r 10 /turtle1/cnd\_vel geonetry\_msgs/Twist "linear:

​            -r 10 表示修改发送频率。

### ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907230830334-892895935.png)

 ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907231001270-1548196918.png)

###   
3、rosservice

命令：rosservice list

功能：显示所有服务命令

图示：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907221202067-1094469953.png)

    rosservice call + 调用list中的命令 发布服务请求

    例： rosservice call /spawn "x: 加一只小海龟 也可更改新出现小乌龟的速度、角度、名字等信息

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906114427247-472472691.png)

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907231622889-1180050961.png)

 下面的那个name是个反馈信息。

  此后再输入rostopic list 效果如下：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220906114454547-1342648072.png)

###  4、rosnode

命令：rosnode

功能：显示所有节点信息

图示：

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907222704207-1677911801.png)

输入rosnode list 列出所有节点 可以看到小乌龟相关的所有节点

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907222830930-864383262.png)

 注意：rosout是启动roscore就会默认启动的一个节点，采集所有节点的日志信息 用于提交给上一层显示 （ros自带）

    输入rosnode info ＋节点名 用于显示节点的信息(包括发送的话题 订阅的话题 pid号等)

 ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907223107367-607941520.png)

 注意：PID是进程识别号（Process Identification）

###  5、rosparam

 命令：rosparam

功能：param就是个中央注册表，可以进行参数的增删改查

**参考链接**：[https://www.jianshu.com/p/e4de8ba7ffb2](https://www.jianshu.com/p/e4de8ba7ffb2)

### 6、rosmsg

 输入 rosmsg show + 话题信息 显示话题信息的类型

![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907231202234-1381754066.png)

### 7、rossrv

命令：rossrv

功能：显示ros服务类型消息信息的相关命令

参考链接：[https://blog.csdn.net/qq\_43280851/article/details/125182206](https://blog.csdn.net/qq_43280851/article/details/125182206)

补充：

    输入 $ rosbag record -a -O cmd\_record 话题记录 记录小乌龟的运动轨迹

    输入 $ rosbag play cmd\_record.bag 话题复现 按小乌龟的运动轨迹复现一次

 解析：-a 是all的意思，保存所有的信息；-o是保存成一个压缩包，后面是压缩包的名字

 ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907232330393-2033794695.png)

 ![](https://img2022.cnblogs.com/blog/2226321/202209/2226321-20220907232819717-962074079.png)