---
layout: post
title: "ReactæŠ¥é”™ä¹‹Function components cannot have string refs"
date: "2022-12-12T20:16:40.393Z"
---
ReactæŠ¥é”™ä¹‹Function components cannot have string refs
===================================================

æ€»è§ˆ
--

å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸º`ref`æ—¶ï¼Œä¼šäº§ç”Ÿ"Function components cannot have string refs"é”™è¯¯ã€‚ä¸ºäº†è§£å†³è¯¥é”™è¯¯ï¼Œä½¿ç”¨`useRef()`é’©å­æ¥å¾—åˆ°ä¸€ä¸ªå¯å˜çš„`ref`å¯¹è±¡ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½œä¸º`ref`ä½¿ç”¨ã€‚

![function-components-cannot-have-string-refs.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d55ff6606924b699a0de07a6d2792e4~tplv-k3u1fbpfcp-watermark.image?)

è¿™é‡Œæœ‰ä¸ªç¤ºä¾‹ç”¨æ¥å±•ç¤ºé”™è¯¯æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚

    // App.js
    
    export default function App() {
      // A string ref has been found within a strict mode tree.
      // â›”ï¸ Function components cannot have string refs.
      // We recommend using useRef() instead.
      return (
        <div>
          <input type="text" id="message" ref="msg" />
        </div>
      );
    }
    

ä¸Šè¿°ä»£ç ç‰‡æ®µçš„é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å­—ç¬¦ä¸²ä½œä¸º`ref`ã€‚

useRef
------

ä¸ºäº†è§£å†³è¯¥é”™è¯¯ï¼Œä½¿ç”¨`useRef`é’©å­æ¥è·å–å¯å˜çš„`ref`å¯¹è±¡ã€‚

    // App.js
    
    import {useEffect, useRef} from 'react';
    
    export default function App() {
      const refContainer = useRef(null);
    
      useEffect(() => {
        // ğŸ‘‡ï¸ this is reference to input element
        console.log(refContainer.current);
    
        refContainer.current.focus();
      }, []);
    
      return (
        <div>
          <input type="text" id="message" ref={refContainer} />
        </div>
      );
    }
    

`useRef()`é’©å­å¯ä»¥è¢«ä¼ é€’ä¸€ä¸ªåˆå§‹å€¼ä½œä¸ºå‚æ•°ã€‚è¯¥é’©å­è¿”å›ä¸€ä¸ªå¯å˜çš„`ref`å¯¹è±¡ï¼Œå…¶`.current`å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ é€’çš„å‚æ•°ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»è®¿é—®`ref`å¯¹è±¡ä¸Šçš„`current`å±æ€§ï¼Œä»¥è·å¾—å¯¹æˆ‘ä»¬è®¾ç½®äº†`ref`å±æ€§çš„`input`å…ƒç´ çš„è®¿é—®ã€‚

å½“æˆ‘ä»¬ä¼ é€’`ref`å±æ€§åˆ°å…ƒç´ ä¸Šæ—¶ï¼Œæ¯”å¦‚è¯´ï¼Œ`<input ref={myRef} />` ã€‚Reactå°†`ref`å¯¹è±¡ä¸Šçš„`.current`å±æ€§è®¾ç½®ä¸ºç›¸åº”çš„DOMèŠ‚ç‚¹ã€‚

> `useRef`é’©å­åˆ›å»ºäº†ä¸€ä¸ªæ™®é€šçš„JavaScriptå¯¹è±¡ï¼Œä½†åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ç»™ä½ ç›¸åŒçš„`ref`å¯¹è±¡ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå‡ ä¹æ˜¯ä¸€ä¸ªå¸¦æœ‰`.current`å±æ€§çš„è®°å¿†åŒ–å¯¹è±¡å€¼ã€‚

ä¸ä¼šé‡æ–°æ¸²æŸ“
------

åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå½“ä½ æ”¹å˜`ref`çš„`current`å±æ€§çš„å€¼æ—¶ï¼Œä¸ä¼šå¼•èµ·é‡æ–°æ¸²æŸ“ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ª`ref`ä¸éœ€è¦åŒ…å«åœ¨`useEffect`é’©å­çš„ä¾èµ–æ•°ç»„ä¸­ï¼Œå› ä¸ºæ”¹å˜å®ƒçš„`current`å±æ€§ä¸ä¼šå¼•èµ·é‡æ–°æ¸²æŸ“ã€‚

    // App.js
    
    import {useEffect, useRef} from 'react';
    
    export default function App() {
      const refContainer = useRef(null);
    
      const refCounter = useRef(0);
    
      useEffect(() => {
        // ğŸ‘‡ï¸ this is reference to input element
        console.log(refContainer.current);
        refContainer.current.focus();
    
        // ğŸ‘‡ï¸ incrementing ref value does not cause re-render
        refCounter.current += 1;
        console.log(refCounter.current);
      }, []);
    
      return (
        <div>
          <input type="text" id="message" ref={refContainer} />
        </div>
      );
    }
    

ä¾‹å­ä¸­çš„`useEffect`é’©å­åªè¿è¡Œäº†2æ¬¡ï¼Œå› ä¸º`useRef`åœ¨å…¶å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶å¹¶æ²¡æœ‰é€šçŸ¥æˆ‘ä»¬ã€‚

æ”¹å˜å¯¹è±¡çš„`current`å±æ€§å¹¶ä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“ã€‚