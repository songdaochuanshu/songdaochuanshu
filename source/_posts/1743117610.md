---
layout: post
title: "JavaScriptä¸­çš„é˜²æŠ–ä¸èŠ‚æµ-å›¾æ–‡ç‰ˆ"
date: "2022-12-18T03:17:01.167Z"
---
JavaScriptä¸­çš„é˜²æŠ–ä¸èŠ‚æµ-å›¾æ–‡ç‰ˆ
=====================

![JavaScriptä¸­çš„é˜²æŠ–ä¸èŠ‚æµ-å›¾æ–‡ç‰ˆ](https://img2023.cnblogs.com/blog/151257/202212/151257-20221216124116655-1787811311.png) é˜²æŠ–ä¸èŠ‚æµç›®çš„éƒ½æ˜¯é¿å…ä¸€å®šæ—¶é—´å†…ï¼Œå¤§é‡é‡å¤çš„æ“ä½œé€ æˆçš„æ€§èƒ½æŸè€—ã€‚å› æ­¤åŸç†ä¹Ÿç±»ä¼¼ï¼Œéƒ½æ˜¯é˜»æ­¢è¿‡å¤šçš„äº‹ä»¶æ‰§è¡Œï¼Œåªä¿ç•™ä¸€éƒ¨åˆ†æ¥æ‰§è¡Œã€‚é€‚ç”¨åœºæ™¯ç•¥æœ‰ä¸åŒï¼Œä¹Ÿæœ‰äº¤å‰ï¼ŒåŠ¨æ‰‹ç»ƒä¹ ä¸€éå°±æ‡‚äº†ã€‚

![image.png](https://img2023.cnblogs.com/blog/151257/202212/151257-20221216144014972-1264642894.png)

01ã€é˜²æŠ–è¿˜æ˜¯èŠ‚æµ
=========

**é˜²æŠ–** ä¸ **èŠ‚æµ** ç›®çš„éƒ½æ˜¯é¿å…ä¸€å®šæ—¶é—´å†…ï¼Œå¤§é‡é‡å¤çš„æ“ä½œé€ æˆçš„æ€§èƒ½æŸè€—ã€‚å› æ­¤åŸç†ä¹Ÿç±»ä¼¼ï¼Œéƒ½æ˜¯é˜»æ­¢è¿‡å¤šçš„äº‹ä»¶æ‰§è¡Œï¼Œåªä¿ç•™ä¸€éƒ¨åˆ†æ¥æ‰§è¡Œã€‚é€‚ç”¨åœºæ™¯ç•¥æœ‰ä¸åŒï¼Œä¹Ÿæœ‰äº¤å‰ï¼ŒåŠ¨æ‰‹ç»ƒä¹ ä¸€éå°±æ‡‚äº†ã€‚

**åŒºåˆ«**

**é˜²æŠ–ï¼ˆDebounceï¼‰**

**èŠ‚æµï¼ˆthrottleï¼‰**

**æè¿°**

ä¸€å®šå»¶è¿Ÿæ—¶é—´å†…ï¼Œè¿ç»­äº‹ä»¶åªæ‰§è¡Œæœ€åä¸€æ¬¡

ä¸€æ®µå›ºå®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡

**åŸç†**

åªä¿ç•™ä¸€ä¸ªå»¶æ—¶`setTimeout()`çš„æ‰§è¡Œå™¨ï¼Œåç»­æ–°çš„æ›¿ä»£æ—§çš„

åˆ¤æ–­æ—¶é—´é—´éš”ï¼Œåœ¨å›ºå®šé—´éš”æ—¶é—´å†…ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚

**æ‰§è¡Œæ¬¡æ•°**

åªæ‰§è¡Œæœ€åä¸€æ¬¡

æ‰§è¡Œé¦–æ¬¡ã€æœ€åä¸€æ¬¡ï¼Œæˆ–é¦–æ¬¡+æœ€åä¸€æ¬¡

**åˆé€‚åœºæ™¯**

è¿ç»­æ“ä½œåªéœ€è¦ä¸€æ¬¡çš„ï¼Œå¦‚å˜æ›´å†…å®¹æäº¤åˆ°åç«¯

è¿ç»­æ“ä½œå®šæœŸæ‰§è¡Œçš„åœºæ™¯ï¼šè¿ç»­çš„UIäº¤äº’ï¼Œå¦‚æ‹–æ‹½ã€æ»šåŠ¨

* * *

02ã€ä»€ä¹ˆæ˜¯é˜²æŠ–ï¼ˆDebounceï¼‰ï¼Ÿ
===================

æŒ‰å­—é¢æ„æ€ç†è§£å°±æ˜¯ **é˜²æ­¢æŠ–åŠ¨**ï¼ˆDebounce /di'bauns/ é˜²æŠ–åŠ¨ï¼‰ï¼Œæœ¬æ¥åªéœ€è¦ç‚¹å‡»ä¸€æ¬¡ï¼Œç»“æœæ‰‹æŠ–æ“ä½œäº†å¾ˆå¤šæ¬¡ï¼Œé‡å¤æ‰§è¡Œå°±é€ æˆäº†é¢å¤–çš„æµªè´¹ã€‚

![image.png](https://img2023.cnblogs.com/blog/151257/202212/151257-20221216144015009-702862692.png)

**ğŸ”¸é˜²æŠ–å‡½æ•°çš„åŸç†**ï¼šåœ¨ä¸€å®šå»¶è¿Ÿæ—¶é—´å†…ï¼Œè¿ç»­è§¦å‘çš„äº‹ä»¶åˆå¹¶åªæ‰§è¡Œ **æœ€å** ä¸€æ¬¡ã€‚æŠ€æœ¯åŸç†æ˜¯ç”¨é—­åŒ…ä¿å­˜ä¸€ä¸ªå»¶æ—¶æ‰§è¡Œå‡½æ•°`setTimeout(func, delayTime)`è¿”å›å˜é‡ï¼Œåªè¦å»¶è¿Ÿæ—¶é—´`delayTime`å†…æ–°è§¦å‘çš„æ‰§è¡Œå™¨ï¼Œå°±ä¼šä»£æ›¿æ—§æ‰§è¡Œå™¨ã€‚

![image](https://img2023.cnblogs.com/blog/151257/202212/151257-20221216144201537-279793375.png)

**ğŸª§å®ç°ä»£ç **ï¼š

    /******************************   é˜²æŠ–å‡½æ•°  ******************************/
    //å‚æ•°funcï¼šéœ€è¦é˜²æŠ–çš„å‡½æ•°
    //å‚æ•°delayTimeï¼šå»¶æ—¶æ—¶é•¿ï¼Œå•ä½ms
    function debounce(func, delayTime) {
        //ç”¨é—­åŒ…è·¯ç¼“å­˜å»¶æ—¶å™¨id
        let timer;
        return function (...args) {
            if (timer)
                clearTimeout(timer);  //æ¸…é™¤-æ›¿æ¢ï¼ŒæŠŠå‰æµªæ‹æ­»åœ¨æ²™æ»©ä¸Š
            timer = setTimeout(() => {
                func.apply(this, args);
            }, delayTime);
        }
    }
    

**ğŸŸ¢é€‚ç”¨åœºæ™¯**ï¼š

*   âœ… æäº¤æŒ‰é’®ï¼Œé¿å…é‡å¤ç‚¹å‡»æäº¤æ•°æ®ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡ã€‚
*   âœ… æ–‡æœ¬æ¡†è¾“å…¥çš„å“åº”ï¼šå¦‚åŸºäºè¾“å…¥æ–‡æœ¬æœåŠ¡ç«¯è”æƒ³æŸ¥è¯¢ï¼Œå¯¹è¾“å…¥å†…å®¹çš„æœåŠ¡ç«¯éªŒè¯ç­‰ï¼Œé˜²æŠ–å°±å¯ä»¥é¿å…æ²¡å¿…è¦çš„è¯·æ±‚ï¼ŒèŠ‚çº¦èµ„æºã€‚
*   âœ… è¿ç»­è§¦å‘çš„äº‹ä»¶ï¼Œå¦‚çª—å£çš„`resize`äº‹ä»¶ã€çª—å£çš„æ»šåŠ¨`scroll`äº‹ä»¶ï¼Œåªå¤„ç†æœ€åä¸€æ¬¡ã€‚

**ğŸª§ä½¿ç”¨æ¡ˆä¾‹**ï¼šæ»šåŠ¨æµè§ˆå™¨æ»šåŠ¨æ¡åˆ°æœ«å°¾ã€‚

*   å¦‚æœä¸ç”¨é˜²æŠ–å‡½æ•°ï¼Œ`scroll`äº‹ä»¶é¢‘ç¹è§¦å‘ï¼Œå…±è§¦å‘äº†29æ¬¡ã€‚
*   åŠ ä¸Šé˜²æŠ–å‡½æ•°ï¼ŒåŒæ ·çš„é€Ÿåº¦ç§»åŠ¨ï¼Œåªè§¦å‘äº†æœ€åä¸€æ¬¡ã€‚

    //ç§»åŠ¨æµè§ˆå™¨æ»šåŠ¨æ¡åˆ°æœ«å°¾ï¼Œæ— é˜²æŠ–
    window.addEventListener('scroll', print); //æ‰§è¡Œäº†29æ¬¡
    //åŠ ä¸Šé˜²æŠ–ï¼Œå»¶è¿Ÿ300ms
    window.addEventListener('scroll', debounce(print, 300)); //æ‰§è¡Œäº†1æ¬¡
    let index = 0;
    function print() {
        console.log(index++);
    }
    

* * *

03ã€ä¸ºä½•è¦èŠ‚æµï¼ˆthrottleï¼‰ï¼Ÿ
===================

**èŠ‚æµ**ï¼ˆthrottleï¼‰å­—é¢æ„æ€å°±æ˜¯èŠ‚çº¦æµé‡ï¼ˆthrottle /ËˆÎ¸rÉ‘Ëtl/ èŠ‚æµé˜€ï¼‰ï¼Œä¸€ä¸ªå°æœ‹å‹ä¸€åˆ†é’Ÿåªèƒ½åƒä¸€å‹ºé¥­ï¼Œæ¯åˆ†é’Ÿå–‚äº†30å‹ºï¼Œå–‚å¾—å¤ªå¿«è¦ä¹ˆé£Ÿç‰©æµªè´¹äº†ï¼Œè¦ä¹ˆè¢«å™åˆ°ã€‚

**ğŸ”¸èŠ‚æµå‡½æ•°çš„åŸç†**ï¼šä¸€å®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ï¼Œåœ¨ä¸€æ®µæ—¶é—´`intervalTime`å†…ï¼Œä¸ç®¡è§¦å‘äº†å¤šå°‘æ¬¡äº‹ä»¶ï¼ˆå¤§äº1ï¼‰éƒ½åªæ‰§è¡Œä¸€æ¬¡ã€‚

*   å› æ­¤é¦–å…ˆéœ€è¦åˆ¤æ–­é—´éš”æ—¶é—´ï¼Œæ˜¯å¦åœ¨é—´éš”æ—¶é—´å†…ã€‚
*   å…·ä½“æ‰§è¡Œçš„æ—¶æœºï¼Œå¯é€‰æ‹©é¦–æ¬¡ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æœ€åä¸€æ¬¡ï¼Œæˆ–è€…é¦–æ¬¡+æœ€åä¸€æ¬¡ã€‚

![image](https://img2023.cnblogs.com/blog/151257/202212/151257-20221216144525495-1636327442.png)

**ğŸª§å®ç°ä»£ç **ï¼šä¸‰ç§å®ç°æ–¹å¼

*   å®ç°1ï¼šå•ä½æ—¶é—´å†…æ‰§è¡Œç¬¬ä¸€æ¬¡ï¼ˆç«‹å³æ‰§è¡Œï¼‰ï¼ŒèŠ‚æµåé¢çš„ï¼ŒåŸºäºæ—¶é—´é—´éš”åˆ¤æ–­ã€‚
*   å®ç°2ï¼šå•ä½æ—¶é—´å†…æ‰§è¡Œç¬¬ä¸€æ¬¡ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰ï¼ŒèŠ‚æµåé¢çš„ï¼ŒåŸºäºå»¶æ—¶å‡½æ•°`setTimeout()`ã€‚
*   å®ç°3ï¼šæ‰§è¡Œé¦–æ¬¡+æœ€åä¸€æ¬¡ï¼ŒèŠ‚æµä¸­é—´çš„ï¼Œæ¯”è¾ƒç»¼åˆå…¨é¢çš„çš„å®ç°æ–¹å¼ï¼

    // å®ç°1ï¼šå•ä½æ—¶é—´å†…æ‰§è¡Œç¬¬ä¸€æ¬¡ï¼ˆç«‹å³æ‰§è¡Œï¼‰ï¼ŒèŠ‚æµåé¢çš„
    function throttle(func, intervalTime = 100) {
        let lastTime = 0;
        return (...args) => {
            let now = Date.now();
            //é¦–æ¬¡è°ƒç”¨ä¼šæ‰§è¡Œ
            if (now - intervalTime > lastTime) {
                func.apply(this, args);
                lastTime = now;
            }
        }
    }
    // å®ç°2ï¼šå•ä½æ—¶é—´å†…æ‰§è¡Œç¬¬ä¸€æ¬¡ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰ï¼ŒèŠ‚æµåé¢çš„
    const throttle2 = (func, intervalTime = 100) => {
        // å®šä¹‰falgï¼Œåˆè¯•ä¸ºtrue
        let flag = true;
        // è¿”å›çš„å‡½æ•°æ˜¯æ¯æ¬¡ç”¨æˆ·å®é™…è°ƒç”¨çš„èŠ‚æµå‡½æ•°
        return (...args) => {
            const ctx = this;
            // å¦‚æœflagä¸ºtrueï¼Œåˆ™æ‰§è¡Œå®šæ—¶å™¨
            if (flag) {
                setTimeout(() => {
                    func.apply(ctx, args);
                    // å‡½æ•°æ‰§è¡Œå®Œæ¯•å=trueï¼›
                    flag = true;
                }, intervalTime);
            }
            //æ²¡æ‰§è¡Œå®Œæˆå‰éƒ½ä¸ºfalse
            flag = false;
        };
    }
    // å®ç°3ï¼šæ‰§è¡Œé¦–æ¬¡+æœ€åä¸€æ¬¡ï¼ŒèŠ‚æµä¸­é—´çš„ï¼Œæ¯”è¾ƒç»¼åˆçš„èŠ‚æµæ–¹å¼ï¼
    function throttleMiddle(func, intervalTime = 100) {
        let timer = null;
        let startTime = 0;
        return (...args) => {
            const ctx = this;
            const now = Date.now();
            if (startTime && now < startTime + intervalTime) {
                //æ›¿æ¢å‰é¢çš„
                clearTimeout(timer);
                timer = setTimeout(() => {
                    startTime = now;
                    func.apply(ctx, args);
                }, Math.max(intervalTime - (Date.now() - startTime), 0)); //å‰©ä½™ç­‰å€™æ—¶é—´
            } else { //æ¯è½®é¦–æ¬¡ä¼šæ‰§è¡Œï¼Œç«‹å³æ‰§è¡Œ
                startTime = now;
                func.apply(ctx, args);
            }
        }
    }
    // èŠ‚æµ-å‡½æ•°æ‰©å±•ï¼Œä½¿ç”¨çš„throttleMiddleç‰ˆæœ¬
    Function.prototype.throttle = function (intervalTime = 100) {
        let func = this;
        let startTime, timer = null;
        //è¿™é‡Œä¸èƒ½ç”¨ç®­å¤´å‡½æ•°ï¼Œä¼šå¯¼è‡´thisæ±¡æŸ“
        return function (...args) {
            const ctx = this;
            let now = Date.now();
            if (startTime && now < startTime + intervalTime) {
                clearTimeout(timer);
                timer = setTimeout(() => {
                    func.apply(this, args);
                    startTime = now;
                }, Math.max(intervalTime - (now - startTime), 0));
            }
            else {
                startTime = now;
                func.apply(ctx, args);
            }
        }
    }
    

**ğŸŸ¢é€‚ç”¨åœºæ™¯**ï¼š

*   âœ… å®šæ—¶ç§’æ€ã€æŠ½å¥–æŒ‰é’®ï¼Œè¿è¡Œå¤šæ¬¡æäº¤ï¼Œé¿å…å¤ªè¿‡é¢‘ç¹çš„æäº¤æŠŠæœåŠ¡ç«¯æå´©äº†ã€‚
*   âœ… è¿ç»­çš„UIäº¤äº’ï¼Œå¦‚DOMæ‹–æ‹½ï¼Œåœ¨çª—å£çš„resizeäº‹ä»¶ã€çª—å£çš„æ»šåŠ¨scrolläº‹ä»¶ä¸­æ›´æ–°UIï¼Œå¦‚æœç”¨é˜²æŠ–ä¼šæœ‰å¡é¡¿çš„ç°è±¡ï¼Œæ›´é€‚åˆç”¨èŠ‚æµã€‚

**ğŸª§ä½¿ç”¨æ¡ˆä¾‹**ï¼šæ»šåŠ¨æµè§ˆå™¨æ»šåŠ¨æ¡åˆ°æœ«å°¾ã€‚

*   å¦‚æœä¸ç”¨é˜²æŠ–å‡½æ•°ï¼Œ`scroll`äº‹ä»¶é¢‘ç¹è§¦å‘ï¼Œå…±è§¦å‘äº†29æ¬¡ã€‚
*   åŠ ä¸ŠèŠ‚æµå‡½æ•°ï¼ŒåŒæ ·çš„é€Ÿåº¦ç§»åŠ¨ï¼Œæ‰§è¡Œäº†4æ¬¡ï¼Œé—´éš”å‡åŒ€ã€‚

    //ç§»åŠ¨æµè§ˆå™¨æ»šåŠ¨æ¡åˆ°æœ«å°¾
    window.addEventListener('scroll', print); //æ‰§è¡Œäº†29æ¬¡
    //åŠ ä¸ŠèŠ‚æµï¼Œå»¶è¿Ÿ300ms
    window.addEventListener('scroll', throttle(print, 300)); //æ‰§è¡Œäº†4æ¬¡
    let index = 0;
    function print() {
        console.log(index++);
    }
    

* * *

> **Â©ï¸ç‰ˆæƒç”³æ˜**ï¼šç‰ˆæƒæ‰€æœ‰@å®‰æœ¨å¤•ï¼Œæœ¬æ–‡å†…å®¹ä»…ä¾›å­¦ä¹ ï¼Œæ¬¢è¿æŒ‡æ­£ã€äº¤æµï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼[_åŸæ–‡ç¼–è¾‘åœ°å€-è¯­é›€_](https://www.yuque.com/kanding/ktech/pkl60belcxaguart)