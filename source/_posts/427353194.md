---
layout: post
title: "模板化的封装，降低业务代码开发"
date: "2022-05-24T01:46:19.610Z"
---
模板化的封装，降低业务代码开发
===============

![模板化的封装，降低业务代码开发](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221504743-1181838071.png) 做这些业务设计时，核心思想是：把常用的逻辑进行封装，流程设计为可配置，这样即可在一定时间内应对业务的需求和变化，降低开发成本的支出，从而使研发更侧重核心业务的管理和抽象封装等内容。

> 复杂的问题，往往需要简单的逻辑；

一、业务背景
======

业务开发是一件复杂且耗时的工程，所以最近几年出了一个很火的概念叫做"低代码"开发，简单的说就是开发人员通过简单的"拖拉拽"配置，快速构建起业务应用，甚至一些业务人员可以自行操作，比如下面常用的一些功能；

![](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221135424-639087812.png)

*   数据报表：通过BI工具快速配置和生成相应的数据报表，降低数据统计的工作量；
*   业务表单：围绕基础的字段库能力，快速构建业务属性的表单结构，避免频繁的扩展版本；
*   审批管理：通过流程的灵活配置，动态管理各种审批场景，例如人事，财务，合同；

做这些业务设计时，核心思想是：把常用的逻辑进行封装，流程设计为可配置，这样即可在一定时间内应对业务的需求和变化，降低开发成本的支出，从而使研发更侧重核心业务的管理和抽象封装等内容。

二、数据报表
======

随着业务的发展，数据报表通常都是系统的必备模块，以往都是在后端提供数据报表的模块，不过近几年少有设计独立的报表统计，都是基于云服务的BI平台快速实现报表的搭建：

![](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221144496-1103616315.png)

*   业务字段：通常报表的维度都是展示对应字段的统计结果，所以业务库的结构解析是基础功能；
*   报表组件：提供基础的报表组件，例如折线图、柱状图、漏斗图等，并设计初始化规则；
*   计算能力：日常数据分析的常用计算方法，基于加减乘除取模等，封装更加灵活的计算策略；
*   报表页面：通过可配置的页面集成多个报表组件，报表组件可以根据占比或者坐标进行布局；

关于数据报表的呈现方式其实有很多种，可视化报表是最常见的，还有一些可能直接基于SQL统计进行定期汇总，以邮件的方式或者公司内部文档的形式输出，解决问题的方式通常不止一种，要学会选择相对合理的策略。

三、业务表单
======

SAAS服务或者常见的管理平台，通常都提供自定义表单的创建能力，通过基础字段库的组合，快速构建相应的业务表单结构，从而应对需求的多变性：

![](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221151625-1131035906.png)

*   字段库：提供业务需求的字段管理，并设计相应的规则约束，例如默认值、提示语、唯一性等等；
    
    *   基础：文本框、文本域、单选、复选、数字框；
    *   进阶：日期、时间、邮件、地址、三级联动、货币与单位；
    *   高级：自定义封装，样式管理与数据加载API；
*   表单库：通过字段库组合构建相应的表单模板，从而对应业务的数据主体，进而实现业务的数据化管理；
    
    *   表单结构：存储表单中字段的基础配置和规则，以便页面的回显；
    *   数据主表：表单对应的业务，建立相应的主表结构，即`biz-form-id`概念；
    *   键值数据：表单中字段和对应的数据录入，即`key-value`结构；
    *   数据索引：由于表单字段的灵活配置，通常构建`No-SQL`搜索结构；
    *   数据回显：基于表单配置的字段，解析响应页面的数据结构，实现数据回显；

基于简单的拖拉拽方式进行表单配置，可以快速生成业务需求的主体结构，只不过整个表单的配置和解析十分复杂，各个节点的管理也更加灵活多变，需要对流程不断优化和模板设计，从而提高复用能力。

四、审批管理
======

报表和表单从整体上看侧重模板化的封装，而审批类的业务则倾向流程的配置化，每个审批场景从开始到结束，完成需要经过多个节点，节点之间又存在递推或者回退的动作：

![](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221158358-1973555249.png)

*   开始：发起方提交审批动作，消息会按照配置流程进行节点通知；
*   节点：配置审批条件(自动或手动)和人员或角色，以及规则定义，例如串行或者并行，回退节点、失败原因等；
*   结束：流程结束后触发通知机制，对流程节点中涉及人员或者其他角色进行消息通知；

![](https://img2022.cnblogs.com/blog/1691717/202205/1691717-20220523221206693-1326989121.png)

在审批流程的管理中，除了涉及大量的规则配置，还需要管理复杂的状态流转，不同的状态描述不同的结果，并根据状态生成相应的事件和动作，从而实现流程开始和结束的完整性。

五、写在最后
======

很多业务需求都是有规律可寻的，例如报表中的计算、表单中的字段和结构、审批中的流程管理，将业务底层不变的规则进行抽象封装，可以是模板化管理或者流程化配置，从而应用对容易变化的业务场景。

![](https://img2020.cnblogs.com/blog/1691717/202008/1691717-20200811231321146-174169065.png)