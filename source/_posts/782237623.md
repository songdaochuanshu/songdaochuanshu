---
layout: post
title: "æœåŠ¡å™¨ä¹‹Apolloå•æœºéƒ¨ç½²(å¿«é€Ÿå®‰è£…)"
date: "2022-10-21T03:53:00.244Z"
---
æœåŠ¡å™¨ä¹‹Apolloå•æœºéƒ¨ç½²(å¿«é€Ÿå®‰è£…)
====================

![æœåŠ¡å™¨ä¹‹Apolloå•æœºéƒ¨ç½²(å¿«é€Ÿå®‰è£…)](https://img2022.cnblogs.com/blog/1775279/202210/1775279-20221021103155192-1969357979.png) ç¿»çœ‹ç½‘ä¸Šéƒ¨ç½²æ•™ç¨‹ï¼Œæ¯”è¾ƒå•°å—¦éº»çƒ¦ä¸”æœ‰å‘ï¼Œæˆ‘åªæƒ³å…ˆéƒ¨ç½²èµ·æ¥çœ‹åˆ°æ•ˆæœï¼›æœåŠ¡å™¨ä¹‹Apolloå•æœºéƒ¨ç½²(å¿«é€Ÿå®‰è£…)ï¼Œåˆ†ä¸ºæ™®é€šéƒ¨ç½²å’Œdockeréƒ¨ç½²

éƒ¨ç½²Apollo
========

apolloå•æœºéƒ¨ç½²(å¿«é€Ÿå®‰è£…)
----------------

`Apollo`å®˜ç½‘ï¼š[https://www.apolloconfig.com/#/zh/deployment/quick-start-docker](https://www.apolloconfig.com/#/zh/deployment/quick-start-docker)  
å®˜ç½‘å•æœºéƒ¨ç½²çš„æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼šæ™®é€šéƒ¨ç½²å’Œdockeréƒ¨ç½²ã€‚

æ™®é€šéƒ¨ç½²
----

éœ€è¦å®‰è£…`MySQL`å’Œ`Java`ç¯å¢ƒã€‚  
`Apollo`æœåŠ¡ç«¯å…±éœ€è¦ä¸¤ä¸ªæ•°æ®åº“ï¼š`ApolloPortalDB`(`apollo`é¡µé¢)å’Œ`ApolloConfigDB`(`apollo`ä½¿ç”¨çš„)ï¼ŒæŠŠæ•°æ®åº“ã€è¡¨çš„åˆ›å»ºå’Œæ ·ä¾‹æ•°æ®éƒ½åˆ†åˆ«å‡†å¤‡äº†`sql`æ–‡ä»¶ï¼Œåªéœ€è¦å¯¼å…¥æ•°æ®åº“å³å¯ã€‚  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319071246-463f7568-7644-48ff-b010-2c9ae6482659.png)  
ç„¶åå»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œè¿›å…¥åˆ°å¿«é€ŸåŒ…ä¸‹é¢(`apollo-quick-start`),ä¸‹é¢æœ‰`demo.sh`,è¿›è¡Œç¼–è¾‘ï¼š  
å°†å¯¹åº”çš„æ•°æ®åº“åå’Œåœ°å€ä¿®æ”¹æˆè‡ªå·±çš„ã€‚  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319071252-15f2636b-9d0b-4ed6-b146-dd06cddd22f0.png)  
**åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰éœ€è¦ç¡®è®¤8070ã€8080ã€8090ç«¯å£æœªè¢«å ç”¨**ï¼Œç„¶åç›´æ¥å¯åŠ¨`./demo.sh`

    ==== starting service ====
    Service logging file is ./service/apollo-service.log
    Started [10768]
    Waiting for config service startup.......
    Config service started. You may visit http://localhost:8080 for service status now!
    Waiting for admin service startup....
    Admin service started
    ==== starting portal ====
    Portal logging file is ./portal/apollo-portal.log
    Started [10846]
    Waiting for portal startup......
    Portal started. You can visit http://localhost:8070 now!
    

é¦–å…ˆä¼šå¯åŠ¨`erueka`æœåŠ¡ï¼Œç„¶åå¯åŠ¨`portal` é…ç½®ä¸­å¿ƒ,æœ€åè®¿é—®`[http://æœåŠ¡å™¨å¤–ç½‘åœ°å€:8070](http://æœåŠ¡å™¨å¤–ç½‘åœ°å€:8070)`å³å¯ï¼›è´¦å·ï¼šapollo,å¯†ç ï¼šadmin;å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319071269-9727ea3d-7233-4caf-8f57-dcbfbf9e3a36.png)  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666315499185-67f3c171-0a53-4342-babc-033805baa17d.png)

dockeréƒ¨ç½²
--------

åŸºäºä¸Šè¿°ç¯å¢ƒ,æˆ‘ä»¬æš‚åœ`demo.sh`çš„æ‰§è¡Œï¼š`./demo.sh stop`,åœ¨å¿«é€ŸåŒ…ä¸­(`apollo-quick-start`)ä½¿ç”¨`docker-compose up`è¿è¡Œ;  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319071390-bf84237c-41e6-4318-b30c-b6a84ef6f169.png)

SpringBooté›†æˆApollo
------------------

è¿™ä¸€æ­¥å°±æ˜¯ä¸ªå‘ğŸ˜‚ï¼Œåˆ›å»º`SpringBoot`ä¸å¤šè¯´ï¼Œåœ¨`maven`ä»“åº“æ‰¾åˆ°å®¢æˆ·ç«¯ï¼›  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319071272-709ce539-373f-43dc-bc1b-f679875ccb6f.png)  
å–æœ€æ–°ç‰ˆå³å¯(æˆªè‡³2022å¹´10æœˆ21æ—¥)ï¼š

    <!-- https://mvnrepository.com/artifact/com.ctrip.framework.apollo/apollo-client -->
    <dependency>
        <groupId>com.ctrip.framework.apollo</groupId>
        <artifactId>apollo-client</artifactId>
        <version>2.0.1</version>
    </dependency>
    
    

é”™è¯¯é…ç½®ï¼š

    server:
      port: 8000
    app:
      id: apolloTest
    apollo:
      bootstrap:
        enabled: true
      meta: http://æœåŠ¡å™¨å¤–ç½‘åœ°å€:8080
    

åœ¨å¯åŠ¨ç±»ä¸Šå¼€å¯`apollo`:`@EnableApolloConfig`

    @SpringBootApplication
    @EnableApolloConfig
    public class ApolloTestApplication {
    
        public static void main(String[] args) {
            SpringApplication.run(ApolloTestApplication.class, args);
        }
    
    }
    

åœ¨**æœåŠ¡å™¨**éƒ¨ç½²çš„`Apollo`ä¼šæœ‰é—®é¢˜ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„æ—¶å€™åœ°å€ä¼šå‡ºç°**æœåŠ¡å™¨çš„å†…ç½‘åœ°å€**ï¼Œé‚£è‚¯å®šæ˜¯è®¿é—®ä¸åˆ°çš„ã€‚  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319072776-f04b761d-1ad4-48f6-97d9-2442a64a94dc.png)  
æ‰€ä»¥æˆ‘ä»¬è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š  
æŒ‡å®šåº”ç”¨çš„`AppId`

    app.id=apolloTest
    

åœ¨æœåŠ¡å¯åŠ¨è®¾ç½®ä¸Šé…ç½®`apollo`å‚æ•°;

    -Dapollo.configService=http://æœåŠ¡å™¨å¤–ç½‘åœ°å€:8080
    

![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319072764-5ae17f9a-47bd-4bcb-bd6f-4b3c351eee96.png)  
éœ€è¦å¯¹åº”èµ·æ¥ï¼Œæ–°å¢é…ç½®key:service,value:hello world,å¹¶ä¸”æ˜¯å·²å‘å¸ƒ  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/27024230/1666319072893-793315aa-2d78-4929-9798-dadec171e12f.png)

    public class TestController {
    
        @Value(value = "${service}")
        private String name;
    
        @RequestMapping("test")
        public String test(){
            return "hello world -->"+name;
        }
    }