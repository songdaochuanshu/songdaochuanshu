---
layout: post
title: "2022i春秋-冬季赛nan’s analysis"
date: "2022-12-26T05:14:53.772Z"
---
2022i春秋-冬季赛nan’s analysis
=========================

下载附件，在tcp的0流可以看到一个keyisChunqiuGame00504

在3流处得到压缩包，密码不是上面那个，后面对附件找了几个小时都没发现压缩包密码，我是笨比。后面才看到有在线环境。

然后找到shell.php

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130045648-2134171072.png)

提示这里有隐藏信息，通过网站访问可以发现异常

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130056979-998417062.png)

知道是零宽隐写,根据特征来选择网站，这里用到这个网站[Zero Width Lib (yuanfux.github.io)](https://yuanfux.github.io/zero-width-web/)

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130110897-57748278.png)

写脚本爆破压缩包密码

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130255052-1929392342.png)

得到0504050405040504

查看根目录下的tips可以知道要切换到root用户，我们需要找到密码

继续找全局隐藏文件，使用命令ls -al -R可以查看当前目录下所有文件，包括子目录下文件

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130311844-89398865.png)

对隐藏文件.index.php查看

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130324906-286314190.png)

发现进行了混淆和加密，通过分析代码，得到代码结果

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130338067-399694153.png)

Base64解得到aes加密的root密码

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130350845-214431473.png)

然后aes解密，key为前面流量分析发现的，iv为压缩包密码

 ![](https://img2023.cnblogs.com/blog/2842002/202212/2842002-20221226130404538-2070349068.png)

后面切换root用户cat /flag即可。