---
layout: post
title: "æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆäº”ï¼‰ï¼šåŸºäºä¼é¹…æ•°æ®é›†çš„å†³ç­–æ ‘åˆ†ç±»é¢„æµ‹"
date: "2023-03-26T01:13:35.310Z"
---
æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆäº”ï¼‰ï¼šåŸºäºä¼é¹…æ•°æ®é›†çš„å†³ç­–æ ‘åˆ†ç±»é¢„æµ‹
=========================

å†³ç­–æ ‘çš„ä¸»è¦ä¼˜ç‚¹ï¼š 1. å…·æœ‰å¾ˆå¥½çš„è§£é‡Šæ€§ï¼Œæ¨¡å‹å¯ä»¥ç”Ÿæˆå¯ä»¥ç†è§£çš„è§„åˆ™ã€‚ 2. å¯ä»¥å‘ç°ç‰¹å¾çš„é‡è¦ç¨‹åº¦ã€‚ 3. æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦è¾ƒä½ã€‚ å†³ç­–æ ‘çš„ä¸»è¦ç¼ºç‚¹ï¼š 1. æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œéœ€è¦é‡‡ç”¨å‡ææŠ€æœ¯å¤„ç†ã€‚ 2. ä¸èƒ½å¾ˆå¥½åˆ©ç”¨è¿ç»­å‹ç‰¹å¾ã€‚ 3. é¢„æµ‹èƒ½åŠ›æœ‰é™ï¼Œæ— æ³•è¾¾åˆ°å…¶ä»–å¼ºç›‘ç£æ¨¡å‹æ•ˆæœã€‚ 4. æ–¹å·®è¾ƒé«˜ï¼Œæ•°æ®åˆ†å¸ƒçš„è½»å¾®æ”¹å˜å¾ˆå®¹æ˜“é€ æˆæ ‘ç»“æ„å®Œå…¨ä¸åŒã€‚

æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆäº”ï¼‰ï¼šåŸºäºä¼é¹…æ•°æ®é›†çš„å†³ç­–æ ‘åˆ†ç±»é¢„æµ‹
=========================

1 é€»å†³ç­–æ ‘çš„ä»‹ç»å’Œåº”ç”¨
============

1.1 å†³ç­–æ ‘çš„ä»‹ç»
----------

å†³ç­–æ ‘æ˜¯ä¸€ç§å¸¸è§çš„åˆ†ç±»æ¨¡å‹ï¼Œåœ¨é‡‘èé£æ§ã€åŒ»ç–—è¾…åŠ©è¯Šæ–­ç­‰è¯¸å¤šè¡Œä¸šå…·æœ‰è¾ƒä¸ºå¹¿æ³›çš„åº”ç”¨ã€‚å†³ç­–æ ‘çš„æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäºæ ‘ç»“æ„å¯¹æ•°æ®è¿›è¡Œåˆ’åˆ†ï¼Œè¿™ç§æ€æƒ³æ˜¯äººç±»å¤„ç†é—®é¢˜æ—¶çš„æœ¬èƒ½æ–¹æ³•ã€‚ä¾‹å¦‚åœ¨å©šæ‹å¸‚åœºä¸­ï¼Œå¥³æ–¹é€šå¸¸ä¼šå…ˆè¯¢é—®ç”·æ–¹æ˜¯å¦æœ‰æˆ¿äº§ï¼Œå¦‚æœæœ‰æˆ¿äº§å†äº†è§£æ˜¯å¦æœ‰è½¦äº§ï¼Œå¦‚æœæœ‰è½¦äº§å†çœ‹æ˜¯å¦æœ‰ç¨³å®šå·¥ä½œâ€¦â€¦æœ€åå¾—å‡ºæ˜¯å¦è¦æ·±å…¥äº†è§£çš„åˆ¤æ–­ã€‚

**ä¸»è¦åº”ç”¨ï¼š**

ç”±äºå†³ç­–æ ‘æ¨¡å‹ä¸­è‡ªå˜é‡ä¸å› å˜é‡çš„éçº¿æ€§å…³ç³»ä»¥åŠå†³ç­–æ ‘ç®€å•çš„è®¡ç®—æ–¹æ³•ï¼Œä½¿å¾—å®ƒæˆä¸ºé›†æˆå­¦ä¹ ä¸­æœ€ä¸ºå¹¿æ³›ä½¿ç”¨çš„åŸºæ¨¡å‹ã€‚**æ¢¯åº¦æå‡æ ‘(GBDT)ï¼ŒXGBoostä»¥åŠLightGBMç­‰å…ˆè¿›çš„é›†æˆæ¨¡å‹**éƒ½é‡‡ç”¨äº†å†³ç­–æ ‘ä½œä¸ºåŸºæ¨¡å‹ï¼Œåœ¨å¹¿å‘Šè®¡ç®—ã€CTRé¢„ä¼°ã€é‡‘èé£æ§ç­‰é¢†åŸŸå¤§æ”¾å¼‚å½©ï¼Œæˆä¸ºå½“ä»Šä¸ç¥ç»ç½‘ç»œç›¸æå¹¶è®ºçš„å¤æ‚æ¨¡å‹ï¼Œæ›´æ˜¯æ•°æ®æŒ–æ˜æ¯”èµ›ä¸­çš„å¸¸å®¢ã€‚åœ¨æ–°çš„ç ”ç©¶ä¸­ï¼Œå—äº¬å¤§å­¦å‘¨å¿—åæ•™æˆæå‡ºä¸€ç§å¤šç²’åº¦çº§è”æ£®æ—æ¨¡å‹ï¼Œåˆ›é€ äº†ä¸€ç§å…¨æ–°çš„åŸºäºå†³ç­–æ ‘çš„æ·±åº¦é›†æˆæ–¹æ³•ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å†³ç­–æ ‘å‘å±•çš„å¦ä¸€ç§å¯èƒ½ã€‚

åŒæ—¶å†³ç­–æ ‘åœ¨ä¸€äº›æ˜ç¡®éœ€è¦å¯è§£é‡Šæ€§æˆ–è€…æå–åˆ†ç±»è§„åˆ™çš„åœºæ™¯ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œè€Œå…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è¿™ä¸€ç‚¹å¾ˆéš¾åšåˆ°ã€‚ä¾‹å¦‚åœ¨åŒ»ç–—è¾…åŠ©ç³»ç»Ÿä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ä¸“ä¸šäººå‘˜å‘ç°é”™è¯¯ï¼Œå¸¸å¸¸å°†å†³ç­–æ ‘ç®—æ³•ç”¨äºè¾…åŠ©ç—…ç—‡æ£€æµ‹ã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ªé¢„æµ‹å“®å–˜æ‚£è€…çš„æ¨¡å‹ä¸­ï¼ŒåŒ»ç”Ÿå‘ç°æµ‹è¯•çš„è®¸å¤šé«˜çº§æ¨¡å‹çš„æ•ˆæœéå¸¸å·®ã€‚åœ¨ä»–ä»¬è¿è¡Œäº†ä¸€ä¸ªå†³ç­–æ ‘æ¨¡å‹åå‘ç°ï¼Œç®—æ³•è®¤ä¸ºå‰§çƒˆå’³å—½çš„ç—…äººæ‚£å“®å–˜çš„é£é™©å¾ˆå°ã€‚ä½†åŒ»ç”Ÿéå¸¸æ¸…æ¥šå‰§çƒˆå’³å—½ä¸€èˆ¬éƒ½ä¼šè¢«ç«‹åˆ»æ£€æŸ¥æ²»ç–—ï¼Œè¿™æ„å‘³ç€æ‚£æœ‰å‰§çƒˆå’³å—½çš„å“®å–˜ç—…äººéƒ½ä¼šé©¬ä¸Šå¾—åˆ°æ”¶æ²»ã€‚ç”¨äºå»ºæ¨¡çš„æ•°æ®è®¤ä¸ºè¿™ç±»ç—…äººé£é™©å¾ˆå°ï¼Œæ˜¯å› ä¸ºæ‰€æœ‰è¿™ç±»ç—…äººéƒ½å¾—åˆ°äº†åŠæ—¶æ²»ç–—ï¼Œæ‰€ä»¥æå°‘æœ‰äººåœ¨æ­¤ä¹‹åæ‚£ç—…æˆ–æ­»äº¡ã€‚

1.2 ç›¸å…³æµç¨‹
--------

*   äº†è§£ å†³ç­–æ ‘ çš„ç†è®ºçŸ¥è¯†
*   æŒæ¡ å†³ç­–æ ‘ çš„ sklearn å‡½æ•°è°ƒç”¨å¹¶å°†å…¶è¿ç”¨åœ¨ä¼é¹…æ•°æ®é›†çš„é¢„æµ‹ä¸­

Part1 Demoå®è·µ

*   Step1:åº“å‡½æ•°å¯¼å…¥
*   Step2:æ¨¡å‹è®­ç»ƒ
*   Step3:æ•°æ®å’Œæ¨¡å‹å¯è§†åŒ–
*   Step4:æ¨¡å‹é¢„æµ‹

Part2 åŸºäºä¼é¹…ï¼ˆpenguinsï¼‰æ•°æ®é›†çš„å†³ç­–æ ‘åˆ†ç±»å®è·µ

*   Step1:åº“å‡½æ•°å¯¼å…¥
*   Step2:æ•°æ®è¯»å–/è½½å…¥
*   Step3:æ•°æ®ä¿¡æ¯ç®€å•æŸ¥çœ‹
*   Step4:å¯è§†åŒ–æè¿°
*   Step5:åˆ©ç”¨ å†³ç­–æ ‘æ¨¡å‹ åœ¨äºŒåˆ†ç±»ä¸Š è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹
*   Step6:åˆ©ç”¨ å†³ç­–æ ‘æ¨¡å‹ åœ¨ä¸‰åˆ†ç±»(å¤šåˆ†ç±»)ä¸Š è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹

3 ç®—æ³•å®æˆ˜
======

3.1Demoå®è·µ
---------

Step1: åº“å‡½æ•°å¯¼å…¥

    ##  åŸºç¡€å‡½æ•°åº“
    import numpy as np 
    
    ## å¯¼å…¥ç”»å›¾åº“
    import matplotlib.pyplot as plt
    import seaborn as sns
    
    ## å¯¼å…¥å†³ç­–æ ‘æ¨¡å‹å‡½æ•°
    from sklearn.tree import DecisionTreeClassifier
    from sklearn import tree
    

Step2: è®­ç»ƒæ¨¡å‹

    ##Demoæ¼”ç¤ºLogisticRegressionåˆ†ç±»
    
    ## æ„é€ æ•°æ®é›†
    x_fearures = np.array([[-1, -2], [-2, -1], [-3, -2], [1, 3], [2, 1], [3, 2]])
    y_label = np.array([0, 1, 0, 1, 0, 1])
    
    ## è°ƒç”¨å†³ç­–æ ‘å›å½’æ¨¡å‹
    tree_clf = DecisionTreeClassifier()
    
    ## è°ƒç”¨å†³ç­–æ ‘æ¨¡å‹æ‹Ÿåˆæ„é€ çš„æ•°æ®é›†
    tree_clf = tree_clf.fit(x_fearures, y_label)
    

Step3: æ•°æ®å’Œæ¨¡å‹å¯è§†åŒ–ï¼ˆéœ€è¦ç”¨åˆ°graphvizå¯è§†åŒ–åº“ï¼‰

    ## å¯è§†åŒ–æ„é€ çš„æ•°æ®æ ·æœ¬ç‚¹
    plt.figure()
    plt.scatter(x_fearures[:,0],x_fearures[:,1], c=y_label, s=50, cmap='viridis')
    plt.title('Dataset')
    plt.show()
    

![](https://ai-studio-static-online.cdn.bcebos.com/db36753cc1e049f4b04c2f3f7aabce9cba96cf0e237c4a21b496fe39668a62a2)

    ## å¯è§†åŒ–å†³ç­–æ ‘
    import graphviz
    dot_data = tree.export_graphviz(tree_clf, out_file=None)
    graph = graphviz.Source(dot_data)
    graph.render("pengunis")
    

    'pengunis.pdf'
    

Step4:æ¨¡å‹é¢„æµ‹

    ## åˆ›å»ºæ–°æ ·æœ¬
    x_fearures_new1 = np.array([[0, -1]])
    x_fearures_new2 = np.array([[2, 1]])
    
    ## åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šåˆ†å¸ƒåˆ©ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
    y_label_new1_predict = tree_clf.predict(x_fearures_new1)
    y_label_new2_predict = tree_clf.predict(x_fearures_new2)
    
    print('The New point 1 predict class:\n',y_label_new1_predict)
    print('The New point 2 predict class:\n',y_label_new2_predict)
    

    The New point 1 predict class:
     [1]
    The New point 2 predict class:
     [0]
    

3.2 åŸºäºpenguins\_rawæ•°æ®é›†çš„å†³ç­–æ ‘å®æˆ˜
----------------------------

åœ¨å®è·µçš„æœ€å¼€å§‹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¼å…¥ä¸€äº›åŸºç¡€çš„å‡½æ•°åº“åŒ…æ‹¬ï¼šnumpy ï¼ˆPythonè¿›è¡Œç§‘å­¦è®¡ç®—çš„åŸºç¡€è½¯ä»¶åŒ…ï¼‰ï¼Œpandasï¼ˆpandasæ˜¯ä¸€ç§å¿«é€Ÿï¼Œå¼ºå¤§ï¼Œçµæ´»ä¸”æ˜“äºä½¿ç”¨çš„å¼€æºæ•°æ®åˆ†æå’Œå¤„ç†å·¥å…·ï¼‰ï¼Œmatplotlibå’Œseabornç»˜å›¾ã€‚

    #ä¸‹è½½éœ€è¦ç”¨åˆ°çš„æ•°æ®é›†
    !wget https://tianchi-media.oss-cn-beijing.aliyuncs.com/DSW/6tree/penguins_raw.csv
    

    --2023-03-22 16:21:32--  https://tianchi-media.oss-cn-beijing.aliyuncs.com/DSW/6tree/penguins_raw.csv
    æ­£åœ¨è§£æä¸»æœº tianchi-media.oss-cn-beijing.aliyuncs.com (tianchi-media.oss-cn-beijing.aliyuncs.com)... 49.7.22.39
    æ­£åœ¨è¿æ¥ tianchi-media.oss-cn-beijing.aliyuncs.com (tianchi-media.oss-cn-beijing.aliyuncs.com)|49.7.22.39|:443... å·²è¿æ¥ã€‚
    å·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”... 200 OK
    é•¿åº¦ï¼š 53098 (52K) [text/csv]
    æ­£åœ¨ä¿å­˜è‡³: â€œpenguins_raw.csvâ€
    
    penguins_raw.csv    100%[===================>]  51.85K  --.-KB/s    in 0.04s   
    
    2023-03-22 16:21:33 (1.23 MB/s) - å·²ä¿å­˜ â€œpenguins_raw.csvâ€ [53098/53098])
    

**Step1ï¼šå‡½æ•°åº“å¯¼å…¥**

    ##  åŸºç¡€å‡½æ•°åº“
    import numpy as np 
    import pandas as pd
    
    ## ç»˜å›¾å‡½æ•°åº“
    import matplotlib.pyplot as plt
    import seaborn as sns
    

æœ¬æ¬¡æˆ‘ä»¬é€‰æ‹©ä¼é¹…æ•°æ®ï¼ˆpalmerpenguinsï¼‰è¿›è¡Œæ–¹æ³•çš„å°è¯•è®­ç»ƒï¼Œè¯¥æ•°æ®é›†ä¸€å…±åŒ…å«8ä¸ªå˜é‡ï¼Œå…¶ä¸­7ä¸ªç‰¹å¾å˜é‡ï¼Œ1ä¸ªç›®æ ‡åˆ†ç±»å˜é‡ã€‚å…±æœ‰150ä¸ªæ ·æœ¬ï¼Œç›®æ ‡å˜é‡ä¸º ä¼é¹…çš„ç±»åˆ« å…¶éƒ½å±äºä¼é¹…ç±»çš„ä¸‰ä¸ªäºšå±ï¼Œåˆ†åˆ«æ˜¯(AdÃ©lie, Chinstrap and Gentoo)ã€‚åŒ…å«çš„ä¸‰ç§ç§ä¼é¹…çš„ä¸ƒä¸ªç‰¹å¾ï¼Œåˆ†åˆ«æ˜¯æ‰€åœ¨å²›å±¿ï¼Œå˜´å·´é•¿åº¦ï¼Œå˜´å·´æ·±åº¦ï¼Œè„šè¹¼é•¿åº¦ï¼Œèº«ä½“ä½“ç§¯ï¼Œæ€§åˆ«ä»¥åŠå¹´é¾„ã€‚

å˜é‡

æè¿°

species

a factor denoting penguin species

island

a factor denoting island in Palmer Archipelago, Antarctica

bill\_length\_mm

a number denoting bill length

bill\_depth\_mm

a number denoting bill depth

flipper\_length\_mm

an integer denoting flipper length

body\_mass\_g

an integer denoting body mass

sex

a factor denoting penguin sex

year

an integer denoting the study year

**Step2ï¼šæ•°æ®è¯»å–/è½½å…¥**

    ## æˆ‘ä»¬åˆ©ç”¨Pandasè‡ªå¸¦çš„read_csvå‡½æ•°è¯»å–å¹¶è½¬åŒ–ä¸ºDataFrameæ ¼å¼
    
    data = pd.read_csv('./penguins_raw.csv')
    

    ## ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä»…é€‰å–å››ä¸ªç®€å•çš„ç‰¹å¾ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹å…¶ä»–ç‰¹å¾çš„å«ä¹‰ä»¥åŠä½¿ç”¨æ–¹æ³•
    data = data[['Species','Culmen Length (mm)','Culmen Depth (mm)',
                'Flipper Length (mm)','Body Mass (g)']]
    

**Step3ï¼šæ•°æ®ä¿¡æ¯ç®€å•æŸ¥çœ‹**

    ## åˆ©ç”¨.info()æŸ¥çœ‹æ•°æ®çš„æ•´ä½“ä¿¡æ¯
    data.info()
    

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 344 entries, 0 to 343
    Data columns (total 5 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   Species              344 non-null    object 
     1   Culmen Length (mm)   342 non-null    float64
     2   Culmen Depth (mm)    342 non-null    float64
     3   Flipper Length (mm)  342 non-null    float64
     4   Body Mass (g)        342 non-null    float64
    dtypes: float64(4), object(1)
    memory usage: 13.6+ KB
    

    ## è¿›è¡Œç®€å•çš„æ•°æ®æŸ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ .head() å¤´éƒ¨.tail()å°¾éƒ¨
    data.head()
    

.dataframe tbody tr th:only-of-type { vertical-align: middle } \\3cpre>\\3ccode>.dataframe tbody tr th { vertical-align: top } .dataframe thead th { text-align: right }

Species

Culmen Length (mm)

Culmen Depth (mm)

Flipper Length (mm)

Body Mass (g)

0

Adelie Penguin (Pygoscelis adeliae)

39.1

18.7

181.0

3750.0

1

Adelie Penguin (Pygoscelis adeliae)

39.5

17.4

186.0

3800.0

2

Adelie Penguin (Pygoscelis adeliae)

40.3

18.0

195.0

3250.0

3

Adelie Penguin (Pygoscelis adeliae)

NaN

NaN

NaN

NaN

4

Adelie Penguin (Pygoscelis adeliae)

36.7

19.3

193.0

3450.0

è¿™é‡Œæˆ‘ä»¬å‘ç°æ•°æ®é›†ä¸­å­˜åœ¨NaNï¼Œä¸€èˆ¬çš„æˆ‘ä»¬è®¤ä¸ºNaNåœ¨æ•°æ®é›†ä¸­ä»£è¡¨äº†ç¼ºå¤±å€¼ï¼Œå¯èƒ½æ˜¯æ•°æ®é‡‡é›†æˆ–å¤„ç†æ—¶äº§ç”Ÿçš„ä¸€ç§é”™è¯¯ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨-1å°†ç¼ºå¤±å€¼è¿›è¡Œå¡«è¡¥ï¼Œè¿˜æœ‰å…¶ä»–ä¾‹å¦‚â€œä¸­ä½æ•°å¡«è¡¥ã€å¹³å‡æ•°å¡«è¡¥â€çš„ç¼ºå¤±å€¼å¤„ç†æ–¹æ³•æœ‰å…´è¶£çš„åŒå­¦ä¹Ÿå¯ä»¥å°è¯•ã€‚

    data = data.fillna(-1)
    

    data.tail()
    

.dataframe tbody tr th:only-of-type { vertical-align: middle } \\3cpre>\\3ccode>.dataframe tbody tr th { vertical-align: top } .dataframe thead th { text-align: right }

Species

Culmen Length (mm)

Culmen Depth (mm)

Flipper Length (mm)

Body Mass (g)

339

Chinstrap penguin (Pygoscelis antarctica)

55.8

19.8

207.0

4000.0

340

Chinstrap penguin (Pygoscelis antarctica)

43.5

18.1

202.0

3400.0

341

Chinstrap penguin (Pygoscelis antarctica)

49.6

18.2

193.0

3775.0

342

Chinstrap penguin (Pygoscelis antarctica)

50.8

19.0

210.0

4100.0

343

Chinstrap penguin (Pygoscelis antarctica)

50.2

18.7

198.0

3775.0

    ## å…¶å¯¹åº”çš„ç±»åˆ«æ ‡ç­¾ä¸º'Adelie Penguin', 'Gentoo penguin', 'Chinstrap penguin'ä¸‰ç§ä¸åŒä¼é¹…çš„ç±»åˆ«ã€‚
    data['Species'].unique()
    

    array(['Adelie Penguin (Pygoscelis adeliae)',
           'Gentoo penguin (Pygoscelis papua)',
           'Chinstrap penguin (Pygoscelis antarctica)'], dtype=object)
    

    ## åˆ©ç”¨value_countså‡½æ•°æŸ¥çœ‹æ¯ä¸ªç±»åˆ«æ•°é‡
    pd.Series(data['Species']).value_counts()
    

    Adelie Penguin (Pygoscelis adeliae)          152
    Gentoo penguin (Pygoscelis papua)            124
    Chinstrap penguin (Pygoscelis antarctica)     68
    Name: Species, dtype: int64
    

    ## å¯¹äºç‰¹å¾è¿›è¡Œä¸€äº›ç»Ÿè®¡æè¿°
    data.describe()
    

.dataframe tbody tr th:only-of-type { vertical-align: middle } \\3cpre>\\3ccode>.dataframe tbody tr th { vertical-align: top } .dataframe thead th { text-align: right }

Culmen Length (mm)

Culmen Depth (mm)

Flipper Length (mm)

Body Mass (g)

count

344.000000

344.000000

344.000000

344.000000

mean

43.660756

17.045640

199.741279

4177.319767

std

6.428957

2.405614

20.806759

861.263227

min

\-1.000000

\-1.000000

\-1.000000

\-1.000000

25%

39.200000

15.500000

190.000000

3550.000000

50%

44.250000

17.300000

197.000000

4025.000000

75%

48.500000

18.700000

213.000000

4750.000000

max

59.600000

21.500000

231.000000

6300.000000

**Step4:å¯è§†åŒ–æè¿°**

    ## ç‰¹å¾ä¸æ ‡ç­¾ç»„åˆçš„æ•£ç‚¹å¯è§†åŒ–
    sns.pairplot(data=data, diag_kind='hist', hue= 'Species')
    plt.show()
    

![](https://ai-studio-static-online.cdn.bcebos.com/27575e20804a47e9aabe74fe85888eb363cc4efab84e44faaee2a5af0102a30d)

ä»ä¸Šå›¾å¯ä»¥å‘ç°ï¼Œåœ¨2Dæƒ…å†µä¸‹ä¸åŒçš„ç‰¹å¾ç»„åˆå¯¹äºä¸åŒç±»åˆ«çš„ä¼é¹…çš„æ•£ç‚¹åˆ†å¸ƒï¼Œä»¥åŠå¤§æ¦‚çš„åŒºåˆ†èƒ½åŠ›ã€‚Culmen Lenthä¸å…¶ä»–ç‰¹å¾çš„ç»„åˆæ•£ç‚¹çš„é‡åˆè¾ƒå°‘ï¼Œæ‰€ä»¥å¯¹äºæ•°æ®é›†çš„åˆ’åˆ†èƒ½åŠ›æœ€å¥½ã€‚

æˆ‘ä»¬å‘ç°

    '''ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å°†æ ‡ç­¾è½¬åŒ–ä¸ºæ•°å­—
           'Adelie Penguin (Pygoscelis adeliae)'        ------0
           'Gentoo penguin (Pygoscelis papua)'          ------1
           'Chinstrap penguin (Pygoscelis antarctica)   ------2 '''
    
    def trans(x):
        if x == data['Species'].unique()[0]:
            return 0
        if x == data['Species'].unique()[1]:
            return 1
        if x == data['Species'].unique()[2]:
            return 2
    
    data['Species'] = data['Species'].apply(trans)
    

    for col in data.columns:
        if col != 'Species':
            sns.boxplot(x='Species', y=col, saturation=0.5, palette='pastel', data=data)
            plt.title(col)
            plt.show()
    

![](https://ai-studio-static-online.cdn.bcebos.com/6978392dbca5488da72e13e95357ed8b692b9ab075984b9d8a489399fadac1aa)  
![](https://ai-studio-static-online.cdn.bcebos.com/b4c5970cfdd54c3b8276d18c29f7582e1618fd84684546e6aff6ea2e3f3929a9)  
![](https://ai-studio-static-online.cdn.bcebos.com/67d4ea55c0f548859fcdc316a7ad4233d19b3544dc36447e850a6535438b2346)  
![](https://ai-studio-static-online.cdn.bcebos.com/abdbd8734d1f48d1819913ed788439de62028a5d9cff4163b2b13fdfec1c05ac)

åˆ©ç”¨ç®±å‹å›¾æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°ä¸åŒç±»åˆ«åœ¨ä¸åŒç‰¹å¾ä¸Šçš„åˆ†å¸ƒå·®å¼‚æƒ…å†µã€‚

    # é€‰å–å…¶å‰ä¸‰ä¸ªç‰¹å¾ç»˜åˆ¶ä¸‰ç»´æ•£ç‚¹å›¾
    from mpl_toolkits.mplot3d import Axes3D
    
    fig = plt.figure(figsize=(10,8))
    ax = fig.add_subplot(111, projection='3d')
    
    data_class0 = data[data['Species']==0].values
    data_class1 = data[data['Species']==1].values
    data_class2 = data[data['Species']==2].values
    # 'setosa'(0), 'versicolor'(1), 'virginica'(2)
    ax.scatter(data_class0[:,0], data_class0[:,1], data_class0[:,2],label=data['Species'].unique()[0])
    ax.scatter(data_class1[:,0], data_class1[:,1], data_class1[:,2],label=data['Species'].unique()[1])
    ax.scatter(data_class2[:,0], data_class2[:,1], data_class2[:,2],label=data['Species'].unique()[2])
    plt.legend()
    
    plt.show()
    

![](https://ai-studio-static-online.cdn.bcebos.com/d9bdfff1179541d89cd775f687b99533edbc79c9717d4ec9a24174430d05a4e4)

**Step5:åˆ©ç”¨ å†³ç­–æ ‘æ¨¡å‹ åœ¨äºŒåˆ†ç±»ä¸Š è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹**

    ## ä¸ºäº†æ­£ç¡®è¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œå°†æ•°æ®åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶åœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œåœ¨æµ‹è¯•é›†ä¸ŠéªŒè¯æ¨¡å‹æ€§èƒ½ã€‚
    from sklearn.model_selection import train_test_split
    
    ## é€‰æ‹©å…¶ç±»åˆ«ä¸º0å’Œ1çš„æ ·æœ¬ ï¼ˆä¸åŒ…æ‹¬ç±»åˆ«ä¸º2çš„æ ·æœ¬ï¼‰
    data_target_part = data[data['Species'].isin([0,1])][['Species']]
    data_features_part = data[data['Species'].isin([0,1])][['Culmen Length (mm)','Culmen Depth (mm)',
                'Flipper Length (mm)','Body Mass (g)']]
    
    ## æµ‹è¯•é›†å¤§å°ä¸º20%ï¼Œ 80%/20%åˆ†
    x_train, x_test, y_train, y_test = train_test_split(data_features_part, data_target_part, test_size = 0.2, random_state = 2020)
    

    ## ä»sklearnä¸­å¯¼å…¥å†³ç­–æ ‘æ¨¡å‹
    from sklearn.tree import DecisionTreeClassifier
    from sklearn import tree
    ## å®šä¹‰ å†³ç­–æ ‘æ¨¡å‹ 
    clf = DecisionTreeClassifier(criterion='entropy')
    # åœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒå†³ç­–æ ‘æ¨¡å‹
    clf.fit(x_train, y_train)
    

    DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='entropy',
                           max_depth=None, max_features=None, max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, presort='deprecated',
                           random_state=None, splitter='best')
    

    ## å¯è§†åŒ–
    import graphviz
    dot_data = tree.export_graphviz(clf, out_file=None)
    graph = graphviz.Source(dot_data)
    graph.render("penguins")
    

    'penguins.pdf'
    

    
    ## åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šåˆ†å¸ƒåˆ©ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
    train_predict = clf.predict(x_train)
    test_predict = clf.predict(x_test)
    from sklearn import metrics
    
    ## åˆ©ç”¨accuracyï¼ˆå‡†ç¡®åº¦ï¼‰ã€é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°ç›®å æ€»é¢„æµ‹æ ·æœ¬æ•°ç›®çš„æ¯”ä¾‹ã€‘è¯„ä¼°æ¨¡å‹æ•ˆæœ
    print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_train,train_predict))
    print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_test,test_predict))
    
    ## æŸ¥çœ‹æ··æ·†çŸ©é˜µ (é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„å„ç±»æƒ…å†µç»Ÿè®¡çŸ©é˜µ)
    confusion_matrix_result = metrics.confusion_matrix(test_predict,y_test)
    print('The confusion matrix result:\n',confusion_matrix_result)
    
    # åˆ©ç”¨çƒ­åŠ›å›¾å¯¹äºç»“æœè¿›è¡Œå¯è§†åŒ–
    plt.figure(figsize=(8, 6))
    sns.heatmap(confusion_matrix_result, annot=True, cmap='Blues')
    plt.xlabel('Predicted labels')
    plt.ylabel('True labels')
    plt.show()
    

    The accuracy of the Logistic Regression is: 0.9954545454545455
    The accuracy of the Logistic Regression is: 1.0
    The confusion matrix result:
     [[31  0]
     [ 0 25]]
    

![](https://ai-studio-static-online.cdn.bcebos.com/aa2bd41356ba401ea2f93bba57ac727a15020f5679c54266bcc6dafe2008f876)

æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å‡†ç¡®åº¦ä¸º1ï¼Œä»£è¡¨æ‰€æœ‰çš„æ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®äº†ã€‚

**Step6:åˆ©ç”¨ å†³ç­–æ ‘æ¨¡å‹ åœ¨ä¸‰åˆ†ç±»(å¤šåˆ†ç±»)ä¸Š è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹**

    ## æµ‹è¯•é›†å¤§å°ä¸º20%ï¼Œ 80%/20%åˆ†
    x_train, x_test, y_train, y_test = train_test_split(data[['Culmen Length (mm)','Culmen Depth (mm)',
                'Flipper Length (mm)','Body Mass (g)']], data[['Species']], test_size = 0.2, random_state = 2020)
    ## å®šä¹‰ å†³ç­–æ ‘æ¨¡å‹ 
    clf = DecisionTreeClassifier()
    # åœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒå†³ç­–æ ‘æ¨¡å‹
    clf.fit(x_train, y_train)
    

    DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                           max_depth=None, max_features=None, max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, presort='deprecated',
                           random_state=None, splitter='best')
    

    ## åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šåˆ†å¸ƒåˆ©ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
    train_predict = clf.predict(x_train)
    test_predict = clf.predict(x_test)
    
    ## ç”±äºå†³ç­–æ ‘æ¨¡å‹æ˜¯æ¦‚ç‡é¢„æµ‹æ¨¡å‹ï¼ˆå‰æ–‡ä»‹ç»çš„ p = p(y=1|x,\theta)ï¼‰,æ‰€æœ‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ predict_proba å‡½æ•°é¢„æµ‹å…¶æ¦‚ç‡
    train_predict_proba = clf.predict_proba(x_train)
    test_predict_proba = clf.predict_proba(x_test)
    
    print('The test predict Probability of each class:\n',test_predict_proba)
    ## å…¶ä¸­ç¬¬ä¸€åˆ—ä»£è¡¨é¢„æµ‹ä¸º0ç±»çš„æ¦‚ç‡ï¼Œç¬¬äºŒåˆ—ä»£è¡¨é¢„æµ‹ä¸º1ç±»çš„æ¦‚ç‡ï¼Œç¬¬ä¸‰åˆ—ä»£è¡¨é¢„æµ‹ä¸º2ç±»çš„æ¦‚ç‡ã€‚
    
    ## åˆ©ç”¨accuracyï¼ˆå‡†ç¡®åº¦ï¼‰ã€é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°ç›®å æ€»é¢„æµ‹æ ·æœ¬æ•°ç›®çš„æ¯”ä¾‹ã€‘è¯„ä¼°æ¨¡å‹æ•ˆæœ
    print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_train,train_predict))
    print('The accuracy of the Logistic Regression is:',metrics.accuracy_score(y_test,test_predict))
    

    The test predict Probability of each class:
     [[0. 0. 1.]
     [0. 1. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 0. 1.]
     [0. 0. 1.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 0. 1.]
     [1. 0. 0.]
     [0. 0. 1.]
     [1. 0. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 0. 1.]
     [0. 0. 1.]
     [0. 1. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 0. 1.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 0. 1.]
     [0. 0. 1.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [0. 0. 1.]
     [0. 0. 1.]
     [0. 1. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 1. 0.]
     [0. 0. 1.]
     [0. 0. 1.]
     [1. 0. 0.]
     [0. 1. 0.]
     [0. 0. 1.]
     [1. 0. 0.]
     [1. 0. 0.]]
    The accuracy of the Logistic Regression is: 0.9963636363636363
    The accuracy of the Logistic Regression is: 0.9565217391304348
    

    ## æŸ¥çœ‹æ··æ·†çŸ©é˜µ
    confusion_matrix_result = metrics.confusion_matrix(test_predict,y_test)
    print('The confusion matrix result:\n',confusion_matrix_result)
    
    # åˆ©ç”¨çƒ­åŠ›å›¾å¯¹äºç»“æœè¿›è¡Œå¯è§†åŒ–
    plt.figure(figsize=(8, 6))
    sns.heatmap(confusion_matrix_result, annot=True, cmap='Blues')
    plt.xlabel('Predicted labels')
    plt.ylabel('True labels')
    plt.show()
    

    The confusion matrix result:
     [[30  1  0]
     [ 0 23  0]
     [ 2  0 13]]
    

![](https://ai-studio-static-online.cdn.bcebos.com/61bee25810374ed39633797cb0118f69eb093eecaecd44cdb4448283d830be37)

3.3 é‡è¦çŸ¥è¯†ç‚¹
---------

### 3.3.1 å†³ç­–æ ‘æ„å»ºçš„ä¼ªä»£ç 

è¾“å…¥ï¼š è®­ç»ƒé›†D={($x\_1$,$y\_1$),($x\_2$,$y\_2$),....,($x\_m$,$y\_m$)};  
ç‰¹å¾é›†A={$a\_1$,$a\_2$,....,$a\_d$}

è¾“å‡ºï¼š ä»¥nodeä¸ºæ ¹èŠ‚ç‚¹çš„ä¸€é¢—å†³ç­–æ ‘

è¿‡ç¨‹ï¼šå‡½æ•°TreeGenerate($D$,$A$)

1.  ç”ŸæˆèŠ‚ç‚¹node
2.  $if$ $D$ä¸­æ ·æœ¬å…¨ä¹¦å±äºåŒä¸€ç±»åˆ«$C$ $then$:
3.  \----å°†nodeæ ‡è®°ä¸º$C$ç±»å¶èŠ‚ç‚¹ï¼›$return$
4.  $if$ $A$ = ç©ºé›† OR Dä¸­æ ·æœ¬åœ¨$A$ä¸Šçš„å–å€¼ç›¸åŒ $then$:
5.  \----å°†nodeæ ‡è®°ä¸ºå¶èŠ‚ç‚¹ï¼Œå…¶ç±»åˆ«æ ‡è®°ä¸º$D$ä¸­æ ·æœ¬æ•°æœ€å¤šçš„ç±»ï¼›$return$
6.  ä» $A$ ä¸­é€‰æ‹©æœ€ä¼˜åˆ’åˆ†å±æ€§ $a\_\*$;
7.  $for$ $a\__$ çš„æ¯ä¸€ä¸ªå€¼ $a\__^v$ $do$:
8.  \----ä¸ºnodeç”Ÿæˆä¸€ä¸ªåˆ†æ”¯ï¼Œä»¤$D\_v$è¡¨ç¤º$D$ä¸­åœ¨$a\__$ä¸Šå–å€¼ä¸º$a\__^v$çš„æ ·æœ¬å­é›†ï¼›
9.  \----$if$ $D\_v$ ä¸ºç©º $then$:
10.  \--------å°†åˆ†æ”¯èŠ‚ç‚¹æ ‡è®°ä¸ºå¶èŠ‚ç‚¹ï¼Œå…¶ç±»åˆ«æ ‡è®°ä¸º$D$ä¸­æ ·æœ¬æœ€å¤šçš„ç±»;$then$
11.  \----$else$:
12.  \--------ä»¥ TreeGenerate($D\_v$,$A${$a\_\*$})ä¸ºåˆ†æ”¯èŠ‚ç‚¹

å†³ç­–æ ‘çš„æ„å»ºè¿‡ç¨‹æ˜¯ä¸€ä¸ªé€’å½’è¿‡ç¨‹ã€‚å‡½æ•°å­˜åœ¨ä¸‰ç§è¿”å›çŠ¶æ€ï¼šï¼ˆ1ï¼‰å½“å‰èŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬å…¨éƒ¨å±äºåŒä¸€ç±»åˆ«ï¼Œæ— éœ€ç»§ç»­åˆ’åˆ†ï¼›ï¼ˆ2ï¼‰å½“å‰å±æ€§é›†ä¸ºç©ºæˆ–è€…æ‰€æœ‰æ ·æœ¬åœ¨æŸä¸ªå±æ€§ä¸Šçš„å–å€¼ç›¸åŒï¼Œæ— æ³•ç»§ç»­åˆ’åˆ†ï¼›ï¼ˆ3ï¼‰å½“å‰èŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬é›†åˆä¸ºç©ºï¼Œæ— æ³•åˆ’åˆ†ã€‚

### 3.3.2 åˆ’åˆ†é€‰æ‹©

ä»ä¸Šè¿°ä¼ªä»£ç ä¸­æˆ‘ä»¬å‘ç°ï¼Œå†³ç­–æ ‘çš„å…³é”®åœ¨äºline6.ä»$A$ä¸­é€‰æ‹©æœ€ä¼˜åˆ’åˆ†å±æ€§$ğ‘\_âˆ—$ï¼Œä¸€èˆ¬æˆ‘ä»¬å¸Œæœ›å†³ç­–æ ‘æ¯æ¬¡åˆ’åˆ†èŠ‚ç‚¹ä¸­åŒ…å«çš„æ ·æœ¬å°½é‡å±äºåŒä¸€ç±»åˆ«ï¼Œä¹Ÿå°±æ˜¯èŠ‚ç‚¹çš„â€œçº¯åº¦â€æ›´é«˜ã€‚

#### 3.3.2.1 ä¿¡æ¯å¢ç›Š

ä¿¡æ¯ç†µæ˜¯ä¸€ç§è¡¡é‡æ•°æ®æ··ä¹±ç¨‹åº¦çš„æŒ‡æ ‡ï¼Œä¿¡æ¯ç†µè¶Šå°ï¼Œåˆ™æ•°æ®çš„â€œçº¯åº¦â€è¶Šé«˜

$\\operatorname{Ent}(D)=-\\sum\_{k=1}^{|\\mathcal{Y}|} p\_{k} \\log _{2} p_$

å…¶ä¸­$p\_k$ä»£è¡¨äº†ç¬¬$k$ç±»æ ·æœ¬åœ¨$D$ä¸­å æœ‰çš„æ¯”ä¾‹ã€‚

å‡è®¾ç¦»æ•£å±æ€§$a$æœ‰$V$ä¸ªå¯èƒ½çš„å–å€¼{$a1$,$a2$,....,$aV$}ï¼Œè‹¥ä½¿ç”¨$a$å¯¹æ•°æ®é›†$D$è¿›è¡Œåˆ’åˆ†ï¼Œåˆ™äº§ç”Ÿ$D$ä¸ªåˆ†æ”¯èŠ‚ç‚¹ï¼Œè®°ä¸º$Dv$ã€‚åˆ™ä½¿ç”¨$a$å¯¹æ•°æ®é›†è¿›è¡Œåˆ’åˆ†æ‰€å¸¦æ¥çš„ä¿¡æ¯å¢ç›Šè¢«å®šä¹‰ä¸ºï¼š

$\\operatorname{Gain}(D, a)=\\operatorname{Ent}(D)-\\sum\_{v=1}^{V} \\frac{\\left|D^{v}\\right|}{|D|} \\operatorname{Ent}\\left(D^{v}\\right)$

ä¸€èˆ¬çš„ä¿¡æ¯å¢ç›Šè¶Šå¤§ï¼Œåˆ™æ„å‘³ç€ä½¿ç”¨ç‰¹å¾$a$æ¥è¿›è¡Œåˆ’åˆ†çš„æ•ˆæœè¶Šå¥½ã€‚

#### 3.3.2.2åŸºå°¼æŒ‡æ•°

$\\begin{aligned}  
\\operatorname{Gini}(D) &=\\sum\_{k=1}^{|\\mathcal{Y}|} \\sum\_{k^{\\prime} \\neq k} p\_{k} p\_{k^{\\prime}} \\  
&=1-\\sum\_{k=1}^{|\\mathcal{Y}|} p\_{k}^{2}  
\\end{aligned}$

åŸºå°¼æŒ‡æ•°åæ˜ äº†ä»æ•°æ®é›†$D$ä¸­éšæœºæŠ½å–ä¸¤ä¸ªçš„ç±»åˆ«æ ‡è®°ä¸ä¸€è‡´çš„æ¦‚ç‡ã€‚

$\\operatorname{Gini}\\operatorname{index}(D, a)=\\sum\_{v=1}^{V} \\frac{\\left|D^{v}\\right|}{|D|} \\operatorname{Gini}\\left(D^{v}\\right)$

ä½¿ç”¨ç‰¹å¾$a$å¯¹æ•°æ®é›†$D$åˆ’åˆ†çš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºä¸Šã€‚

### 3.3.3 é‡è¦å‚æ•°

Criterionè¿™ä¸ªå‚æ•°æ­£æ˜¯ç”¨æ¥å†³å®šæ¨¡å‹ç‰¹å¾é€‰æ‹©çš„è®¡ç®—æ–¹æ³•çš„ã€‚sklearnæä¾›äº†ä¸¤ç§é€‰æ‹©ï¼š

*   è¾“å…¥â€entropyâ€œï¼Œä½¿ç”¨ä¿¡æ¯ç†µï¼ˆEntropyï¼‰
    
*   è¾“å…¥â€giniâ€œï¼Œä½¿ç”¨åŸºå°¼ç³»æ•°ï¼ˆGini Impurityï¼‰
    

random\_stateç”¨æ¥è®¾ç½®åˆ†æä¸­çš„éšæœºæ¨¡å¼çš„å‚æ•°ï¼Œé»˜è®¤Noneï¼Œåœ¨é«˜ç»´åº¦æ—¶éšæœºæ€§ä¼šè¡¨ç°æ›´æ˜æ˜¾ã€‚splitterä¹Ÿæ˜¯ç”¨æ¥æ§åˆ¶å†³ç­–æ ‘ä¸­çš„éšæœºé€‰é¡¹çš„ï¼Œæœ‰ä¸¤ç§è¾“å…¥å€¼ï¼Œè¾“å…¥â€best"ï¼Œå†³ç­–æ ‘åœ¨åˆ†ææ—¶è™½ç„¶éšæœºï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šä¼˜å…ˆé€‰æ‹©æ›´é‡è¦çš„ç‰¹å¾è¿›è¡Œåˆ†æï¼ˆé‡è¦æ€§å¯ä»¥é€šè¿‡å±æ€§feature\_importances\_æŸ¥çœ‹ï¼‰ï¼Œè¾“å…¥â€œrandom"ï¼Œå†³ç­–æ ‘åœ¨åˆ†ææ—¶ä¼šæ›´åŠ éšæœºï¼Œæ ‘ä¼šå› ä¸ºå«æœ‰æ›´å¤šçš„ä¸å¿…è¦ä¿¡æ¯è€Œæ›´æ·±æ›´å¤§ï¼Œå¹¶å› è¿™äº›ä¸å¿…è¦ä¿¡æ¯è€Œé™ä½å¯¹è®­ç»ƒé›†çš„æ‹Ÿåˆã€‚

é™åˆ¶æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œè¶…è¿‡è®¾å®šæ·±åº¦çš„æ ‘æå…¨éƒ¨å‰ªæ‰ã€‚è¿™æ˜¯ç”¨å¾—æœ€å¹¿æ³›çš„å‰ªæå‚æ•°ï¼Œåœ¨é«˜ç»´åº¦ä½æ ·æœ¬é‡æ—¶éå¸¸æœ‰æ•ˆã€‚å†³ç­–æ ‘å¤šç”Ÿé•¿ä¸€å±‚ï¼Œå¯¹æ ·æœ¬é‡çš„éœ€æ±‚ä¼šå¢åŠ ä¸€å€ï¼Œæ‰€ä»¥é™åˆ¶æ ‘æ·±åº¦èƒ½å¤Ÿæœ‰æ•ˆåœ°é™åˆ¶è¿‡æ‹Ÿåˆã€‚

min\_samples\_leaf é™å®šï¼Œä¸€ä¸ªèŠ‚ç‚¹åœ¨åˆ†æåçš„æ¯ä¸ªå­èŠ‚ç‚¹éƒ½å¿…é¡»åŒ…å«è‡³å°‘min\_samples\_leafä¸ªè®­ç»ƒæ ·æœ¬ï¼Œå¦åˆ™åˆ†æå°±ä¸ä¼šå‘ç”Ÿï¼Œæˆ–è€…ï¼Œåˆ†æä¼šæœç€æ»¡è¶³æ¯ä¸ªå­èŠ‚ç‚¹éƒ½åŒ…å«min\_samples\_leafä¸ªæ ·æœ¬çš„æ–¹å‘å»å‘ç”Ÿã€‚ä¸€èˆ¬æ­é…max\_depthä½¿ç”¨ï¼Œåœ¨å›å½’æ ‘ä¸­æœ‰ç¥å¥‡çš„æ•ˆæœï¼Œå¯ä»¥è®©æ¨¡å‹å˜å¾—æ›´åŠ å¹³æ»‘ã€‚è¿™ä¸ªå‚æ•°çš„æ•°é‡è®¾ç½®å¾—å¤ªå°ä¼šå¼•èµ·è¿‡æ‹Ÿåˆï¼Œè®¾ç½®å¾—å¤ªå¤§å°±ä¼šé˜»æ­¢æ¨¡å‹å­¦ä¹ æ•°æ®ã€‚

4.æ€»ç»“
====

å†³ç­–æ ‘çš„ä¸»è¦ä¼˜ç‚¹ï¼š

1.  å…·æœ‰å¾ˆå¥½çš„è§£é‡Šæ€§ï¼Œæ¨¡å‹å¯ä»¥ç”Ÿæˆå¯ä»¥ç†è§£çš„è§„åˆ™ã€‚
2.  å¯ä»¥å‘ç°ç‰¹å¾çš„é‡è¦ç¨‹åº¦ã€‚
3.  æ¨¡å‹çš„è®¡ç®—å¤æ‚åº¦è¾ƒä½ã€‚

å†³ç­–æ ‘çš„ä¸»è¦ç¼ºç‚¹ï¼š

1.  æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œéœ€è¦é‡‡ç”¨å‡ææŠ€æœ¯å¤„ç†ã€‚
2.  ä¸èƒ½å¾ˆå¥½åˆ©ç”¨è¿ç»­å‹ç‰¹å¾ã€‚
3.  é¢„æµ‹èƒ½åŠ›æœ‰é™ï¼Œæ— æ³•è¾¾åˆ°å…¶ä»–å¼ºç›‘ç£æ¨¡å‹æ•ˆæœã€‚
4.  æ–¹å·®è¾ƒé«˜ï¼Œæ•°æ®åˆ†å¸ƒçš„è½»å¾®æ”¹å˜å¾ˆå®¹æ˜“é€ æˆæ ‘ç»“æ„å®Œå…¨ä¸åŒã€‚

æœ¬é¡¹ç›®é“¾æ¥ï¼š[https://www.heywhale.com/home/column/64141d6b1c8c8b518ba97dcc](https://www.heywhale.com/home/column/64141d6b1c8c8b518ba97dcc)

å‚è€ƒé“¾æ¥ï¼š[https://tianchi.aliyun.com/course/278/3422](https://tianchi.aliyun.com/course/278/3422)

* * *

æœ¬äººæœ€è¿‘æ‰“ç®—æ•´åˆMLã€DRLã€NLPç­‰ç›¸å…³é¢†åŸŸçš„ä½“ç³»åŒ–é¡¹ç›®è¯¾ç¨‹ï¼Œæ–¹ä¾¿å…¥é—¨åŒå­¦å¿«é€ŸæŒæ¡ç›¸å…³çŸ¥è¯†ã€‚å£°æ˜ï¼šéƒ¨åˆ†é¡¹ç›®ä¸ºç½‘ç»œç»å…¸é¡¹ç›®æ–¹ä¾¿å¤§å®¶å¿«é€Ÿå­¦ä¹ ï¼Œåç»­ä¼šä¸æ–­å¢æ·»å®æˆ˜ç¯èŠ‚ï¼ˆæ¯”èµ›ã€è®ºæ–‡ã€ç°å®åº”ç”¨ç­‰ï¼‰ã€‚

*   å¯¹äºæœºå™¨å­¦ä¹ è¿™å—è§„åˆ’ä¸ºï¼šåŸºç¡€å…¥é—¨æœºå™¨å­¦ä¹ ç®—æ³•--->ç®€å•é¡¹ç›®å®æˆ˜--->æ•°æ®å»ºæ¨¡æ¯”èµ›----->ç›¸å…³ç°å®ä¸­åº”ç”¨åœºæ™¯é—®é¢˜è§£å†³ã€‚ä¸€æ¡è·¯çº¿å¸®åŠ©å¤§å®¶å­¦ä¹ ï¼Œå¿«é€Ÿå®æˆ˜ã€‚
*   å¯¹äºæ·±åº¦å¼ºåŒ–å­¦ä¹ è¿™å—è§„åˆ’ä¸ºï¼šåŸºç¡€å•æ™ºèƒ½ç®—æ³•æ•™å­¦ï¼ˆgymç¯å¢ƒä¸ºä¸»ï¼‰---->ä¸»æµå¤šæ™ºèƒ½ç®—æ³•æ•™å­¦ï¼ˆgymç¯å¢ƒä¸ºä¸»ï¼‰---->å•æ™ºèƒ½å¤šæ™ºèƒ½é¢˜å®æˆ˜ï¼ˆè®ºæ–‡å¤ç°åä¸šåŠ¡å¦‚ï¼šæ— äººæœºä¼˜åŒ–è°ƒåº¦ã€ç”µåŠ›èµ„æºè°ƒåº¦ç­‰é¡¹ç›®åº”ç”¨ï¼‰
*   è‡ªç„¶è¯­è¨€å¤„ç†ç›¸å…³è§„åˆ’ï¼šé™¤äº†å•ç‚¹ç®—æ³•æŠ€æœ¯å¤–ï¼Œä¸»è¦å›´ç»•çŸ¥è¯†å›¾è°±æ„å»ºè¿›è¡Œï¼šä¿¡æ¯æŠ½å–ç›¸å…³æŠ€æœ¯ï¼ˆå«æ™ºèƒ½æ ‡æ³¨ï¼‰--->çŸ¥è¯†èåˆ---->çŸ¥è¯†æ¨ç†---->å›¾è°±åº”ç”¨

ä¸Šè¿°å¯¹äºä½ æŒæ¡åçš„æœŸè®¸ï¼š

1.  å¯¹äºMLï¼Œå¸Œæœ›ä½ åç»­å¯ä»¥ä¹±æ€æ•°å­¦å»ºæ¨¡ç›¸å…³æ¯”èµ›ï¼ˆå‚åŠ å°±è·å¥–ä¿åº•ï¼Œtopè¿˜æ˜¯éš¾çš„éœ€è¦é’»ç ”ï¼‰
2.  å¯ä»¥å®é™…è§£å†³ç°å®ä¸­ä¸€äº›ä¼˜åŒ–è°ƒåº¦é—®é¢˜ï¼Œè€Œéåœç•™åœ¨gymç¯å¢ƒä¸‹çš„ä¸€äº›æ¸¸æˆdemoç©ç©ã€‚ï¼ˆæ›´æ·±å±‚æ¬¡å¯èƒ½éœ€è¦è‡ªå·±é’»ç ”äº†ï¼Œéš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ï¼‰
3.  æŒæ¡å¯çŸ¥è¯†å›¾è°±å…¨æµç¨‹æ„å»ºå…¶ä¸­å„ä¸ªé‡è¦ç¯èŠ‚ç®—æ³•ï¼ŒåŒ…å«å›¾æ•°æ®åº“ç›¸å…³çŸ¥è¯†ã€‚

è¿™ä¸‰å—é¢†åŸŸè€¦åˆæƒ…å†µæ¯”è¾ƒå¤§ï¼Œåç»­ä¼šé€šè¿‡æ¯”å¦‚ï¼šæœç´¢æ¨èç³»ç»Ÿæ•´ä¸ªé¡¹ç›®è¿›è¡Œè€¦åˆï¼Œå„é¡¹ç®—æ³•éƒ½ä¼šè€¦åˆåœ¨å…¶ä¸­ã€‚ä¸¾ä¾‹ï¼šçŸ¥è¯†å›¾è°±å°±ä¼šç”¨åˆ°ï¼ˆå›¾ç®—æ³•ã€NLPã€MLç›¸å…³ç®—æ³•ï¼‰ï¼Œæœç´¢æ¨èç³»ç»Ÿï¼ˆé™¤äº†è¯¥é¢†åŸŸå¬å›ç²—æ’ç²¾æ’é‡æ’æ··æ’ç­‰ç®—æ³•å¤–ï¼Œè¿˜æœ‰å¼ºåŒ–å­¦ä¹ ã€çŸ¥è¯†å›¾è°±ç­‰è€¦åˆåœ¨å…¶ä¸­ï¼‰ã€‚é¥¼ç”»çš„æœ‰ç‚¹å¤§ï¼Œåé¢æ…¢æ…¢å®ç°ã€‚