---
layout: post
title: "AIå¸¦ä½ çœé’±æ—…æ¸¸ï¼ç²¾å‡†é¢„æµ‹æ°‘å®¿æˆ¿æºä»·æ ¼ï¼"
date: "2022-10-27T16:31:02.657Z"
---
AIå¸¦ä½ çœé’±æ—…æ¸¸ï¼ç²¾å‡†é¢„æµ‹æ°‘å®¿æˆ¿æºä»·æ ¼ï¼
====================

![AIå¸¦ä½ çœé’±æ—…æ¸¸ï¼ç²¾å‡†é¢„æµ‹æ°‘å®¿æˆ¿æºä»·æ ¼ï¼](https://img2022.cnblogs.com/blog/2637458/202210/2637458-20221026172804458-623105010.png) æœ¬æ–‡åŸºäºAirbnbåœ¨å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„æˆ¿æºæ•°æ®ï¼Œæ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè¿›è¡Œæ•°æ®åˆ†æä¸æŒ–æ˜å»ºæ¨¡ï¼Œé¢„æµ‹æ°‘å®¿æˆ¿æºçš„ä»·æ ¼èµ°åŠ¿ã€‚å½“ç„¶ï¼ŒåŒæ ·çš„æ–¹æ³•æ¨¡å¼ä¹Ÿå¯ä»¥åº”ç”¨åœ¨å›½å†…å¹³å°ã€‚

![](https://img-blog.csdnimg.cn/img_convert/1764cd2a9663033300d8645d5e420a6f.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/40)ï¼š[https://www.showmeai.tech/tutorials/40](https://www.showmeai.tech/tutorials/40)  
> ğŸ“˜ [æœºå™¨å­¦ä¹ å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/41)ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/316)ï¼š[https://www.showmeai.tech/article-detail/316](https://www.showmeai.tech/article-detail/316)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

![](https://img-blog.csdnimg.cn/img_convert/570b6acdf4a6e0e1c11c6102796b1158.png)

å¤§å®¶å‡ºå»æ—…æ¸¸æœ€å…³å¿ƒçš„é—®é¢˜ä¹‹ä¸€å°±æ˜¯ä½å®¿ï¼Œåœ¨å›½å¤–ä»¥ Airbnb ä¸ºä»£è¡¨çš„æ°‘å®¿äº’è”ç½‘æ¨¡å¼å½»åº•æ”¹å˜äº†é…’åº—ä¸šï¼Œå¾ˆå¤šæ¸¸å®¢æ›´å–œæ¬¢é¢„è®¢ Airbnb è€Œä¸æ˜¯é…’åº—ï¼Œè€Œåœ¨å›½å†…çš„ç¾å›¢é£çŒªç­‰å¹³å°ï¼Œä¹Ÿæœ‰å¤§é‡çš„æ°‘å®¿å…¥é©»ã€‚

åœ¨ç°åœ¨è¿™ä¸ªä¿¡æ¯é€æ˜å¼€æ”¾çš„äº’è”ç½‘æ—¶ä»£ï¼Œæˆ‘ä»¬èƒ½å¦æ”¶é›†æ•°æ®ä¿¡æ¯ï¼Œå¼€å‘ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹æ¥é¢„æµ‹æˆ¿æºä»·æ ¼ï¼Œä¸ºè‡ªå·±çš„å‡ºè¡Œæä¾›æ›´æ™ºèƒ½åŒ–çš„ä¿¡æ¯å‘¢ï¼Ÿè‚¯å®šæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢[ShowMeAI](https://www.showmeai.tech/)ä»¥Airbnbåœ¨å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„æˆ¿æºæ•°æ®ä¸ºä¾‹ï¼ˆæˆªè‡³ 2022 å¹´ 3 æœˆï¼‰ï¼Œæ¥æ¼”ç¤ºæ•°æ®åˆ†æä¸æŒ–æ˜å»ºæ¨¡çš„å…¨è¿‡ç¨‹ï¼ŒåŒæ ·çš„æ–¹æ³•æ¨¡å¼å¯ä»¥åº”ç”¨åœ¨å¤§å®¶ç†Ÿæ‚‰çš„å›½å†…å¹³å°ä¸Šã€‚

![](https://img-blog.csdnimg.cn/img_convert/1080ad1451cc9cee3b112a20c29ce736.png)

ä¸‹é¢çš„é¡¹ç›®ä¸šåŠ¡å’Œ ğŸ†[**Airbnbæ°‘å®¿æ•°æ®**](http://insideairbnb.com) æ¥æºäº Inside Airbnbï¼ŒåŒ…å«æœ‰å…³ Airbnb å¯¹ä½å®…ç¤¾åŒºå½±å“çš„æ•°æ®å’Œå®£ä¼ ã€‚æ•°æ®æºå¯ä»¥åœ¨ä¸Šè¿°é“¾æ¥ä¸­è·å–ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥è®¿é—®[ShowMeAI](https://www.showmeai.tech/)çš„ç™¾åº¦ç½‘ç›˜åœ°å€ï¼Œè·å–æˆ‘ä»¬ä¸ºå¤§å®¶å­˜å‚¨å¥½çš„é¡¹ç›®æ•°æ®ã€‚

> ğŸ† **å®æˆ˜æ•°æ®é›†ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰**ï¼šå…¬ä¼—å·ã€ShowMeAIç ”ç©¶ä¸­å¿ƒã€å›å¤ã€**å®æˆ˜**ã€ï¼Œæˆ–è€…ç‚¹å‡» [**è¿™é‡Œ**](https://www.showmeai.tech/article-detail/305) è·å–æœ¬æ–‡ [\[22\]åŸºäºAirbnbæ•°æ®çš„æ°‘å®¿æˆ¿ä»·é¢„æµ‹æ¨¡å‹](https://www.showmeai.tech/article-detail/316) ã€**Airbnbæ°‘å®¿æ•°æ®**ã€

> â­ **ShowMeAIå®˜æ–¹GitHub**ï¼š[https://github.com/ShowMeAI-Hub](https://github.com/ShowMeAI-Hub)

ğŸ’¡ ä¸šåŠ¡é—®é¢˜
=======

ä¸€èˆ¬æˆ‘ä»¬éœ€è¦åœ¨å¼€å§‹æŒ–æ˜å’Œå»ºæ¨¡ä¹‹å‰ï¼Œæ·±å…¥äº†è§£æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯å’Œæ•°æ®æƒ…å†µï¼Œæˆ‘ä»¬å…ˆæ€»ç»“äº†ä¸€äº›åœ¨è¿™ä¸ªä¸šåŠ¡åœºæ™¯ä¸‹æˆ‘ä»¬å…³å¿ƒçš„ä¸€äº›ä¸šåŠ¡é—®é¢˜ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ•°æ®åˆ†ææŒ–æ˜æ¥å®Œæˆè¿™äº›ä¸šåŠ¡é—®é¢˜çš„ç†è§£ã€‚

*   å“ªäº›åœ°åŒºæˆ–åŸé•‡çš„ Airbnb æˆ¿æºæœ€å¤šï¼Ÿ
*   æœ€å—æ¬¢è¿çš„æˆ¿å‹æ˜¯ä»€ä¹ˆï¼Ÿ
*   å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„ Airbnb æˆ¿æºä»·æ ¼ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ
*   æˆ¿æºä¸æˆ¿ä¸œçš„åˆ†å¸ƒæƒ…å†µï¼Ÿ
*   å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºæœ‰å“ªäº›æˆ¿å‹å¯ä¾›é€‰æ‹©ï¼Ÿ
*   æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹è¯¥åœ°åŒº Airbnb æˆ¿æºä»·æ ¼çš„æ€è·¯æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
*   åœ¨é¢„æµ‹å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒº Airbnb æˆ¿æºçš„ä»·æ ¼æ—¶ï¼Œå“ªäº›ç‰¹å¾æ›´é‡è¦ï¼Ÿ

ğŸ’¡ æ•°æ®è¯»å–ä¸åˆæ¢
==========

æˆ‘ä»¬å…ˆå¯¼å…¥æœ¬æ¬¡éœ€è¦ä½¿ç”¨åˆ°çš„åˆ†ææŒ–æ˜ä¸å»ºæ¨¡å·¥å…·åº“

    import numpy as np
    import pandas as pd
    from tqdm.notebook import tqdm, trange
    import seaborn as sb
    import matplotlib.pyplot as plt
    %matplotlib inline
    
    from sklearn.linear_model import LinearRegression
    from sklearn.linear_model import Lasso
    from sklearn.model_selection import train_test_split
    from sklearn.metrics import r2_score, mean_squared_error
    from sklearn.preprocessing import StandardScaler
    import statsmodels.api as sm
    from sklearn.ensemble import RandomForestRegressor
    from sklearn.model_selection import GridSearchCV
    from sklearn.pipeline import Pipeline, FeatureUnion
    from sklearn.feature_selection import SelectFromModel
    from sklearn.ensemble import GradientBoostingRegressor
    from statsmodels.stats.outliers_influence import variance_inflation_factor
    from sklearn.inspection import permutation_importance
    
    
    pd.set_option('display.max_columns', None)
    pd.set_option('display.max_rows', None)
    

æ¥ä¸‹æ¥æˆ‘ä»¬è¯»å–å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„æˆ¿æºæ•°æ®

    gm_listings = pd.read_csv('gm_listings-2.csv')
    gm_calendar = pd.read_csv('calendar-2.csv')
    gm_reviews = pd.read_csv('reviews-2.csv')
    

æŸ¥çœ‹æ•°æ®çš„åŸºç¡€ä¿¡æ¯å¦‚ä¸‹

    gm_listings.head()
    

![](https://img-blog.csdnimg.cn/img_convert/f4616d6310933f6eba45d2d3708a20f2.png)

    gm_listings.shape
    # (3584, 74)
    gm_listings.columns
    

![](https://img-blog.csdnimg.cn/img_convert/dc6575249a911d0ddb2e8ebdfef865be.png)

    gm_calendar.head()
    

![](https://img-blog.csdnimg.cn/img_convert/bb2ce52b92fce586cd1374aba417f4a8.png)

    gm_reviews.head()
    

![](https://img-blog.csdnimg.cn/img_convert/44f4ebfa810fb00def18bbdd1b37a061.png)

æˆ‘ä»¬å¯¹æ•°æ®çš„åˆè§ˆå¯ä»¥çœ‹åˆ°ï¼Œå¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„æˆ¿æºæ•°æ®é›†åŒ…å« 3584 è¡Œå’Œ 78 åˆ—ï¼ŒåŒ…å«æœ‰å…³æˆ¿ä¸œã€æˆ¿æºç±»å‹ã€åŒºåŸŸå’Œè¯„çº§çš„ä¿¡æ¯ã€‚

ğŸ’¡ æ•°æ®æ¸…æ´—
=======

![](https://img-blog.csdnimg.cn/img_convert/4d6c9b43cbc8595c4b272a95e4668cd8.png)

> æ•°æ®æ¸…æ´—æ˜¯æœºå™¨å­¦ä¹ å»ºæ¨¡åº”ç”¨çš„ã€ç‰¹å¾å·¥ç¨‹ã€‘é˜¶æ®µçš„æ ¸å¿ƒæ­¥éª¤ï¼Œå®ƒæ¶‰åŠçš„æ–¹æ³•æŠ€èƒ½æ¬¢è¿å¤§å®¶æŸ¥é˜…[ShowMeAI](https://www.showmeai.tech/)å¯¹åº”çš„æ•™ç¨‹æ–‡ç« ï¼Œå¿«å­¦å¿«ç”¨ã€‚
> 
> *   [**æœºå™¨å­¦ä¹ å®æˆ˜ | æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹æœ€å…¨è§£è¯»**](https://www.showmeai.tech/article-detail/208)

ğŸ“Œ å­—æ®µæ¸…æ´—
-------

å› ä¸ºæ•°æ®ä¸­çš„å­—æ®µä¼—å¤šï¼Œæœ‰äº›å­—æ®µæ¯”è¾ƒä¹±ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›æ•°æ®æ¸…æ´—çš„å·¥ä½œï¼Œæ•°æ®åŒ…å«ä¸€äº›å¸¦æœ‰URLçš„åˆ—ï¼Œå¯¹æœ€åçš„é¢„æµ‹ä½œç”¨ä¸å¤§ï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬æ¸…æ´—æ‰ã€‚

    # åˆ é™¤urlå­—æ®µ
    def drop_function(df):
        df = df.drop(columns=['listing_url', 'description', 'host_thumbnail_url', 'host_picture_url', 'latitude', 'longitude', 'picture_url', 'host_url', 'host_location', 'neighbourhood', 'neighbourhood_cleansed', 'host_about', 'has_availability', 'availability_30', 'availability_60', 'availability_90', 'availability_365', 'calendar_last_scraped'])
        
        return df
    
    gm_df = drop_function(gm_listings)
    

åˆ é™¤è¿‡åçš„æ•°æ®å¦‚ä¸‹ï¼Œå¹²å‡€å¾ˆå¤š

![](https://img-blog.csdnimg.cn/img_convert/8c2dc4436c3fe5b5196486aa98937f34.png)

ğŸ“Œ ç¼ºå¤±å€¼å¤„ç†
--------

æ•°æ®ä¸­ä¹ŸåŒ…å«äº†ä¸€äº›ç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬å¯¹å®ƒä»¬è¿›è¡Œåˆ†æå¤„ç†ï¼š

    # æŸ¥çœ‹ç¼ºå¤±å€¼ç™¾åˆ†æ¯”
    (gm_df.isnull().sum()/gm_df.shape[0])* 100
    

å¾—åˆ°å¦‚ä¸‹ç»“æœ

    id                                                0.000000
    scrape_id                                         0.000000
    last_scraped                                      0.000000
    name                                              0.000000
    neighborhood_overview                            41.266741
    host_id                                           0.000000
    host_name                                         0.000000
    host_since                                        0.000000
    host_response_time                               10.212054
    host_response_rate                               10.212054
    host_acceptance_rate                              5.636161
    host_is_superhost                                 0.000000
    host_neighbourhood                               91.657366
    host_listings_count                               0.000000
    host_total_listings_count                         0.000000
    host_verifications                                0.000000
    host_has_profile_pic                              0.000000
    host_identity_verified                            0.000000
    neighbourhood_group_cleansed                      0.000000
    property_type                                     0.000000
    room_type                                         0.000000
    accommodates                                      0.000000
    bathrooms                                       100.000000
    bathrooms_text                                    0.306920
    bedrooms                                          4.687500
    beds                                              2.120536
    amenities                                         0.000000
    price                                             0.000000
    minimum_nights                                    0.000000
    maximum_nights                                    0.000000
    minimum_minimum_nights                            0.000000
    maximum_minimum_nights                            0.000000
    minimum_maximum_nights                            0.000000
    maximum_maximum_nights                            0.000000
    minimum_nights_avg_ntm                            0.000000
    maximum_nights_avg_ntm                            0.000000
    calendar_updated                                100.000000
    number_of_reviews                                 0.000000
    number_of_reviews_ltm                             0.000000
    number_of_reviews_l30d                            0.000000
    first_review                                     19.810268
    last_review                                      19.810268
    review_scores_rating                             19.810268
    review_scores_accuracy                           20.089286
    review_scores_cleanliness                        20.089286
    review_scores_checkin                            20.089286
    review_scores_communication                      20.089286
    review_scores_location                           20.089286
    review_scores_value                              20.089286
    license                                         100.000000
    instant_bookable                                  0.000000
    calculated_host_listings_count                    0.000000
    calculated_host_listings_count_entire_homes       0.000000
    calculated_host_listings_count_private_rooms      0.000000
    calculated_host_listings_count_shared_rooms       0.000000
    reviews_per_month                                19.810268
    dtype: float64
    

æˆ‘ä»¬åˆ†å‡ ç§ä¸åŒçš„æ¯”ä¾‹æƒ…å†µå¯¹ç¼ºå¤±å€¼è¿›è¡Œå¤„ç†ï¼š

*   é«˜ç¼ºå¤±æ¯”ä¾‹çš„å­—æ®µï¼Œå¦‚licenseã€calendar\_updatedã€bathroomsã€host\_neighborhoodç­‰åŒ…å«90%ä»¥ä¸Šçš„NaNå€¼ï¼ŒåŒ…æ‹¬neighborhood overviewæ˜¯41%çš„NaNï¼Œå¹¶ä¸”åŒ…å«æ–‡æœ¬æ•°æ®ã€‚**æˆ‘ä»¬ä¼šç›´æ¥å‰”é™¤è¿™äº›å­—æ®µ**ã€‚
    
*   æ•°å€¼å‹å­—æ®µï¼Œç¼ºå¤±ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨å­—æ®µå¹³å‡å€¼è¿›è¡Œå¡«å……ã€‚è¿™ä¿è¯äº†è¿™äº›å€¼çš„åˆ†å¸ƒè¢«ä¿ç•™ä¸‹æ¥ã€‚è¿™äº›åˆ—åŒ…æ‹¬bedroomsã€bedsã€review\_scores\_ratingã€review\_scores\_accuracyå’Œå…¶ä»–æ‰“åˆ†å­—æ®µã€‚
    
*   ç±»åˆ«å‹å­—æ®µï¼Œåƒbathrooms\_textå’Œhost\_response\_timeï¼Œæˆ‘ä»¬ç”¨ä¼—æ•°è¿›è¡Œå¡«å……ã€‚
    

    # å‰”é™¤é«˜ç¼ºå¤±æ¯”ä¾‹å­—æ®µ
    def drop_function_2(df):
        df = df.drop(columns=['license', 'calendar_updated', 'bathrooms', 'host_neighbourhood', 'neighborhood_overview'])
        
        return df
    
    gm_df = drop_function_2(gm_df)
    
    # å‡å€¼å¡«å……
    def input_mean(df, column_list):
        for columns in column_list: 
            df[columns].fillna(value = df[columns].mean(), inplace=True)
        
        return df
    
    column_list = ['review_scores_rating', 'review_scores_accuracy', 'review_scores_cleanliness',
                  'review_scores_checkin', 'review_scores_communication', 'review_scores_location',
                  'review_scores_value', 'reviews_per_month',
                  'bedrooms', 'beds']
    gm_df = input_mean(gm_df, column_list)
    
    # ä¼—æ•°å¡«å……
    def input_mode(df, column_list):    
        for columns in column_list:        
            df[columns].fillna(value = df[columns].mode()[0], inplace=True)
        
        return df
    
    column_list = ['first_review', 'last_review', 'bathrooms_text', 'host_acceptance_rate', 
                   'host_response_rate', 'host_response_time']
    
    gm_df = input_mode(gm_df, column_list)
    

ğŸ“Œ å­—æ®µç¼–ç 
-------

**host\_is\_superhost** å’Œ **has\_availability** ç­‰åˆ—å¯¹åº”çš„å­—ç¬¦ä¸²å«ä¹‰ä¸º true æˆ– falseï¼Œæˆ‘ä»¬å¯¹å…¶ç¼–ç æ›¿æ¢ä¸º0æˆ–1ã€‚

    gm_df = gm_df.replace({'host_is_superhost': 't', 'host_has_profile_pic': 't', 'host_identity_verified': 't', 'has_availability': 't', 'instant_bookable': 't'}, 1)
    
    gm_df = gm_df.replace({'host_is_superhost': 'f', 'host_has_profile_pic': 'f', 'host_identity_verified': 'f', 'has_availability': 'f', 'instant_bookable': 'f'}, 0)
    

æˆ‘ä»¬æŸ¥çœ‹ä¸‹æ›¿æ¢åçš„æ•°æ®åˆ†å¸ƒ

    gm_df['host_is_superhost'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/df6c91c62c726d9085f6a4f7c3a6090e.png)

ğŸ“Œ å­—æ®µæ ¼å¼è½¬æ¢
---------

ä»·æ ¼ç›¸å…³çš„å­—æ®µï¼Œç›®å‰è¿˜æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒ…å«â€œ$â€ç­‰ç¬¦å·ï¼Œæˆ‘ä»¬å¯¹å…¶å¤„ç†å¹¶è½¬æ¢ä¸ºæ•°å€¼å‹ã€‚

    def string_to_int(df, column):
        # å­—ç¬¦ä¸²æ›¿æ¢æ¸…ç†
        df[column] = df[column].str.replace("$", "")
        df[column] = df[column].str.replace(",", "")
        
        # è½¬ä¸ºæ•°å€¼å‹
        df[column] = pd.to_numeric(df[column]).astype(int)
        
        return df
    
    gm_df = string_to_int(gm_df, 'price')
    

ğŸ“Œ åˆ—è¡¨å‹å­—æ®µç¼–ç 
----------

åƒ`host_verifications`å’Œ`amenities`è¿™æ ·çš„å­—æ®µï¼Œå–å€¼ä¸ºåˆ—è¡¨æ ¼å¼ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œç¼–ç å¤„ç†ï¼ˆç”¨å“‘å˜é‡æ›¿æ¢ï¼‰ã€‚

    # æŸ¥çœ‹åˆ—è¡¨å‹å–å€¼å­—æ®µ
    gm_df_copy = gm_df.copy()
    gm_df_copy['amenities'].head()
    

![](https://img-blog.csdnimg.cn/img_convert/ed9b5655ff066be7802673251305eb41.png)

    gm_df_copy['host_verifications'].head()
    

![](https://img-blog.csdnimg.cn/img_convert/b28bbc79ab452afaefb4a788c05070b7.png)

    # å“‘å˜é‡ç¼–ç 
    gm_df_copy['amenities'] = gm_df_copy['amenities'].str.replace('"', '')
    gm_df_copy['amenities'] = gm_df_copy['amenities'].str.replace(']', "")
    gm_df_copy['amenities'] = gm_df_copy['amenities'].str.replace('[', "")
    
    df_amenities = gm_df_copy['amenities'].str.get_dummies(sep = ",")
    
    gm_df_copy['host_verifications'] = gm_df_copy['host_verifications'].str.replace("'", "")
    gm_df_copy['host_verifications'] = gm_df_copy['host_verifications'].str.replace(']', "")
    gm_df_copy['host_verifications'] = gm_df_copy['host_verifications'].str.replace('[', "")
    
    df_host_ver = gm_df_copy['host_verifications'].str.get_dummies(sep = ",")
    

ç¼–ç åçš„ç»“æœå¦‚ä¸‹æ‰€ç¤º

    df_amenities.head()
    df_host_ver.head()
    

![](https://img-blog.csdnimg.cn/img_convert/d922100f7fc8c1c4df5f56b2c6d61cab.png)

![](https://img-blog.csdnimg.cn/img_convert/f9ffa8148f3b4a77f230d8c9e92ad094.png)

    # åˆ é™¤åŸå§‹å­—æ®µ
    gm_df = gm_df.drop(['host_verifications', 'amenities'], axis=1)
    

ğŸ’¡ æ•°æ®æ¢ç´¢
=======

ä¸‹ä¸€æ­¥æˆ‘ä»¬è¦è¿›è¡Œæ›´å…¨é¢ä¸€äº›çš„æ¢ç´¢æ€§æ•°æ®åˆ†æã€‚

> EDAæ•°æ®åˆ†æéƒ¨åˆ†æ¶‰åŠçš„å·¥å…·åº“ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒ[ShowMeAI](https://www.showmeai.tech/)åˆ¶ä½œçš„å·¥å…·åº“é€ŸæŸ¥è¡¨å’Œæ•™ç¨‹è¿›è¡Œå­¦ä¹ å’Œå¿«é€Ÿä½¿ç”¨ã€‚
> 
> *   [**æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Pandas é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/101)
>     
> *   [**å›¾è§£æ•°æ®åˆ†æï¼šä»å…¥é—¨åˆ°ç²¾é€šç³»åˆ—æ•™ç¨‹**](https://www.showmeai.tech/tutorials/33)
>     

ğŸ“Œ å“ªäº›è¡—åŒºçš„æˆ¿æºæœ€å¤šï¼Ÿ
-------------

    gm_df['neighbourhood_group_cleansed'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/047a470de4b9ca07b9cf0c928cb601b7.png)

    bar_data = gm_df['neighbourhood_group_cleansed'].value_counts().sort_values()
    
    # ä»bar_dataæ„å»ºæ–°çš„dataframe
    bar_data = pd.DataFrame(bar_data).reset_index()
    bar_data['size'] = bar_data['neighbourhood_group_cleansed']/gm_df['neighbourhood_group_cleansed'].count()
    
    # æ’åº 
    bar_data.sort_values(by='size', ascending=False)
    bar_data = bar_data.rename(columns={'index' : 'Towns', 'neighbourhood_group_cleansed' : 'number_of_listings',
                            'size':'fraction_of_total'})
    
    #ç»˜å›¾å±•ç¤º
    #plt.figure(figsize=(10,10));
    bar_data.plot(kind='barh', x ='Towns', y='fraction_of_total', figsize=(8,6))
    plt.title('Towns with the Most listings');
    plt.xlabel('Fraction of Total Listings');
    

![](https://img-blog.csdnimg.cn/img_convert/7b0f72df3109f63255cd9c2b17f7a26b.png)

æ›¼å½»æ–¯ç‰¹é•‡æ‹¥æœ‰å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„å¤§éƒ¨åˆ†æˆ¿æºï¼Œå æ€»æˆ¿æºçš„ 53% (1849)ï¼Œå…¶æ¬¡æ˜¯ç´¢å°”ç¦å¾·ï¼Œå æ€»æˆ¿æºçš„ 17% ï¼›ç‰¹æ‹‰ç¦å¾·ï¼Œå æ€»æˆ¿æºçš„ 9%ã€‚

ğŸ“Œ å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºçš„ Airbnb æˆ¿æºä»·æ ¼åˆ†å¸ƒ
-------------------------

    gm_df['price'].mean(), gm_df['price'].min(), gm_df['price'].max(),gm_df['price'].median()
    # (143.47600446428572, 8, 7372, 79.0)
    

Airbnb æˆ¿æºçš„å‡ä»·ä¸º 143 ç¾å…ƒï¼Œä¸­ä½ä»·ä¸º 79 ç¾å…ƒï¼Œæ•°æ®é›†ä¸­è§‚å¯Ÿåˆ°çš„æœ€é«˜ä»·æ ¼ä¸º 7372 ç¾å…ƒã€‚

    # åˆ’åˆ†ä»·æ ¼æ¡£ä½åŒºé—´
    labels = ['$0 - $100', '$100 - $200', '$200 - $300', '$300 - $400', '$400 - $500', '$500 - $1000', '$1000 - $8000']
    price_cuts = pd.cut(gm_df['price'], bins = [0, 100, 200, 300, 400, 500, 1000, 8000], right=True, labels= labels)
    
    # ä»ä»·æ ¼æ¡£æ„å»ºdataframe
    price_clusters = pd.DataFrame(price_cuts).rename(columns={'price': 'price_clusters'})
    
    # æ‹¼æ¥åŸå§‹dataframe
    gm_df = pd.concat([gm_df, price_clusters], axis=1)
    
    # åˆ†å¸ƒç»˜å›¾
    def price_cluster_plot(df, column, title):    
        plt.figure(figsize=(8,6));
        yx = sb.histplot(data = df[column]);
        
    
        total = float(df[column].count())
        for p in yx.patches:
            width = p.get_width()
            height = p.get_height()
            yx.text(p.get_x() + p.get_width()/2.,height+5, '{:1.1f}%'.format((height/total)*100), ha='center')
        yx.set_title(title);
        plt.xticks(rotation=90)
        
        return yx
    
    price_cluster_plot(gm_df, column='price_clusters', 
                       title='Price distribution of Airbnb Listings in the Greater Manchester Area');
    

![](https://img-blog.csdnimg.cn/img_convert/94721b64eb5b428c3e5874f4c450451b.png)

ä»ä¸Šé¢çš„åˆ†æå’Œå¯è§†åŒ–ç»“æœå¯ä»¥çœ‹å‡ºï¼Œ65.4% çš„æ€»æˆ¿æºä»·æ ¼åœ¨ 0-100 ç¾å…ƒä¹‹é—´ï¼Œè€Œä»·æ ¼åœ¨ 100-200 ç¾å…ƒçš„æˆ¿æºå æ€»æˆ¿æºçš„ 23.4%ã€‚ä¸è¿‡æˆ‘ä»¬ä¹Ÿè§‚å¯Ÿåˆ°æ•°æ®åˆ†å¸ƒæœ‰å¾ˆæ˜æ˜¾çš„é•¿å°¾ç‰¹æ€§ï¼Œä¹Ÿå¯ä»¥æŠŠç‰¹åˆ«é«˜ä»·çš„éƒ¨åˆ†è§†ä½œå¼‚å¸¸å€¼ï¼Œå®ƒä»¬å¯èƒ½ä¼šå¯¹æˆ‘ä»¬çš„åˆ†ææœ‰ä¸€äº›å½±å“ã€‚

ğŸ“Œ æœ€å—æ¬¢è¿çš„æˆ¿å‹æ˜¯ä»€ä¹ˆ
-------------

    # åŸºäºè¯„è®ºé‡ç»Ÿè®¡æ’åº
    ax = gm_df.groupby('property_type').agg(
        median_rating=('review_scores_rating', 'median'),number_of_reviews=('number_of_reviews', 'max')).sort_values(
    by='number_of_reviews', ascending=False).reset_index()
    
    ax.head()
    

![](https://img-blog.csdnimg.cn/img_convert/e963376e45c49c505b5f25f7ef7370f6.png)

åœ¨è¯„è®ºæœ€å¤šçš„å‰ 10 ç§æˆ¿äº§ç±»å‹ä¸­ï¼Œ Entire rental unit è¯„è®ºæ•°é‡æœ€å¤šï¼Œå…¶æ¬¡æ˜¯Private room in rental unitã€‚

    # å¯è§†åŒ–
    bx = ax.loc[:10]
    bx =sb.boxplot(data =bx, x='median_rating', y='property_type')
    bx.set_xlim(4.5, 5)
    plt.title('Most Enjoyed Property types');
    plt.xlabel('Median Rating');
    plt.ylabel('Property Type')
    

![](https://img-blog.csdnimg.cn/img_convert/d4131ce4cc2c577b7da3ef2f81fc4366.png)

ğŸ“Œ æˆ¿ä¸œä¸æˆ¿æºåˆ†å¸ƒ
----------

    # æŒæœ‰æˆ¿æºæœ€å¤šçš„æˆ¿ä¸œ
    host_df = pd.DataFrame(gm_df['host_name'].value_counts()/gm_df['host_name'].count() *100).reset_index()
    host_df = host_df.rename(columns={'index':'name', 'host_name':'perc_count'})
    host_df.head(10)
    

![](https://img-blog.csdnimg.cn/img_convert/917f9c26237ab1262eb75ed788629526.png)

    host_df['perc_count'].loc[:10].sum()
    

ä»ä¸Šè¿°åˆ†æå¯ä»¥çœ‹å‡ºï¼Œæˆ¿æºæœ€å¤šçš„å‰ 10 åæˆ¿ä¸œå æˆ¿æºæ€»æ•°çš„ 13.6%ã€‚

ğŸ“Œ å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒºæä¾›çš„å®¢æˆ¿ç±»å‹åˆ†å¸ƒ
-------------------

    gm_df['room_type'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/ce1e74660fa4a3feb1b82233fc308436.png)

    # åˆ†å¸ƒç»˜å›¾
    zx = sb.countplot(data=gm_df, x='room_type')
    
    total = float(gm_df['room_type'].count())
    for p in zx.patches:
        width = p.get_width()
        height = p.get_height()
        zx.text(p.get_x() + p.get_width()/2.,height+5, '{:1.1f}%'.format((height/total)*100), ha='center')
        zx.set_title('Plot showing different type of rooms available');
        plt.xlabel('Room')
    

![](https://img-blog.csdnimg.cn/img_convert/9233005c28a4e27cbd74725fac7412fe.png)

å¤§éƒ¨åˆ†å®¢æˆ¿æ˜¯ **æ•´æ ‹æˆ¿å±‹/å…¬å¯“** ï¼Œå æˆ¿æºæ€»æ•°çš„ 60%ï¼Œå…¶æ¬¡æ˜¯**ç§äººå®¢æˆ¿**ï¼Œå æˆ¿æºæ€»æ•°çš„ 39%ï¼Œ**å…±äº«æˆ¿é—´** å’Œ **é…’åº—æˆ¿é—´** åˆ†åˆ«å æˆ¿æºçš„ 0.7% å’Œ 0.5%ã€‚

ğŸ’¡ æœºå™¨å­¦ä¹ å»ºæ¨¡
=========

ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨å›å½’å»ºæ¨¡æ–¹æ³•æ¥å¯¹æ°‘å®¿æˆ¿æºä»·æ ¼è¿›è¡Œé¢„ä¼°ã€‚

ğŸ“Œ ç‰¹å¾å·¥ç¨‹
-------

> å…³äºç‰¹å¾å·¥ç¨‹ï¼Œæ¬¢è¿å¤§å®¶æŸ¥é˜…[ShowMeAI](https://www.showmeai.tech/)å¯¹åº”çš„æ•™ç¨‹æ–‡ç« ï¼Œå¿«å­¦å¿«ç”¨ã€‚
> 
> *   [**æœºå™¨å­¦ä¹ å®æˆ˜ | æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹æœ€å…¨è§£è¯»**](https://www.showmeai.tech/article-detail/208)

æˆ‘ä»¬é¦–å…ˆå¯¹åŸå§‹æ•°æ®è¿›è¡Œç‰¹å¾å·¥ç¨‹ï¼Œå¾—åˆ°é€‚åˆå»ºæ¨¡çš„æ•°æ®ç‰¹å¾ã€‚

    # æŸ¥çœ‹æ­¤æ—¶çš„æ•°æ®é›†
    gm_df.head()
    

![](https://img-blog.csdnimg.cn/img_convert/334ca9cb9e986349232b1f9ac7be0ad3.png)

    # å›å½’æ•°æ®é›†
    gm_regression_df = gm_df.copy()
    
    # å‰”é™¤æ— ç”¨å­—æ®µ
    gm_regression_df = gm_regression_df.drop(columns=['id', 'scrape_id', 'last_scraped', 'name', 'host_id', 'host_since', 'first_review', 'last_review', 'price_clusters', 'host_name'])
    
    # å†æ¬¡æŸ¥çœ‹æ•°æ®
    gm_regression_df.head()
    

![](https://img-blog.csdnimg.cn/img_convert/3f51eaf81884c40df7c489e6790b982d.png)

æˆ‘ä»¬å‘ç°`host_response_rate` å’Œ `host_acceptance_rate`å­—æ®µå¸¦æœ‰ç™¾åˆ†å·ï¼Œæˆ‘ä»¬å†åšä¸€ç‚¹æ•°æ®æ¸…æ´—ã€‚

    # å»é™¤ç™¾åˆ†å·å¹¶è½¬æ¢ä¸ºæ•°å€¼å‹
    gm_regression_df['host_response_rate'] =  gm_regression_df['host_response_rate'].str.replace("%", "")
    
    gm_regression_df['host_acceptance_rate'] =  gm_regression_df['host_acceptance_rate'].str.replace("%", "")
       
    # convert to int
    gm_regression_df['host_response_rate'] = pd.to_numeric(gm_regression_df['host_response_rate']).astype(int)
    gm_regression_df['host_acceptance_rate'] =  pd.to_numeric(gm_regression_df['host_acceptance_rate']).astype(int)
    
    # æŸ¥çœ‹è½¬æ¢åç»“æœ
    gm_regression_df['host_response_rate'].head()
    

![](https://img-blog.csdnimg.cn/img_convert/1fe3d4c89a07b0328ca4e2f857e22ff4.png)

bathrooms\_text åˆ—åŒ…å«æ•°å­—å’Œæ–‡æœ¬æ•°æ®çš„ç»„åˆï¼Œæˆ‘ä»¬å¯¹å…¶åšä¸€äº›å¤„ç†

    # æŸ¥çœ‹åŸå§‹å­—æ®µ
    gm_regression_df['bathrooms_text'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/f4e89e9148b05d476fdbafbe32f47bf9.png)

    # åˆ‡åˆ†ä¸æ•°æ®å¤„ç†
    def split_bathroom(df, column, text, new_column):
        df_2 = df[df[column].str.contains(text, case=False)]
        df.loc[df[column].str.contains(text, case=False), new_column] = df_2[column]
        return df
    
    # åº”ç”¨ä¸Šè¿°å‡½æ•°
    gm_regression_df = split_bathroom(gm_regression_df, column='bathrooms_text', text='shared', new_column='shared_bath')
    gm_regression_df = split_bathroom(gm_regression_df, column='bathrooms_text', text='private', new_column='private_bath')
    # æŸ¥çœ‹shared_bathå­—æ®µ
    gm_regression_df['shared_bath'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/84f13f451455582e79f99bcbf556a671.png)

    # æŸ¥çœ‹private_bathå­—æ®µ
    gm_regression_df['private_bath'].value_counts()
    

![](https://img-blog.csdnimg.cn/img_convert/63568bb24b24ab8eae17ba1e9cb6cd58.png)

    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("private bath", "pb", case=False)
    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("private baths", "pbs", case=False)
    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("shared bath", "sb", case=False)
    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("shared baths", "sb", case=False)
    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("shared half-bath", "sb", case=False)
    gm_regression_df['bathrooms_text'] =  gm_regression_df['bathrooms_text'].str.replace("private half-bath", "sb", case=False)
    
    gm_regression_df = split_bathroom(gm_regression_df, column='bathrooms_text', text='bath', new_column='bathrooms_new')
    
    gm_regression_df['shared_bath'] = gm_regression_df['shared_bath'].str.split(" ", expand=True)
    gm_regression_df['private_bath'] = gm_regression_df['private_bath'].str.split(" ", expand=True)
    gm_regression_df['bathrooms_new'] = gm_regression_df['bathrooms_new'].str.split(" ", expand=True)
    
    # å¡«å……ç¼ºå¤±å€¼ä¸º0 
    gm_regression_df = gm_regression_df.fillna(0)
    
    gm_regression_df['shared_bath'] = gm_regression_df['shared_bath'].replace(to_replace='Shared', value=0.5)
    gm_regression_df['private_bath'] = gm_regression_df['private_bath'].replace(to_replace='Private', value=0.5)
    gm_regression_df['bathrooms_new'] = gm_regression_df['bathrooms_new'].replace(to_replace='Half-bath', value=0.5)
    
    # è½¬æˆæ•°å€¼å‹
    gm_regression_df['shared_bath'] = pd.to_numeric(gm_regression_df['shared_bath']).astype(int)
    gm_regression_df['private_bath'] = pd.to_numeric(gm_regression_df['private_bath']).astype(int)
    gm_regression_df['bathrooms_new'] =  pd.to_numeric(gm_regression_df['bathrooms_new']).astype(int)
    
    # æŸ¥çœ‹å¤„ç†åçš„å­—æ®µ
    gm_regression_df[['shared_bath', 'private_bath', 'bathrooms_new']].head()
    

![](https://img-blog.csdnimg.cn/img_convert/2d74b5ed005f4a6bb223004f6793ceeb.png)

ä¸‹é¢æˆ‘ä»¬å¯¹ç±»åˆ«å‹å­—æ®µè¿›è¡Œç¼–ç ï¼Œæ ¹æ®å­—æ®µå«ä¹‰çš„ä¸åŒï¼Œæˆ‘ä»¬ä½¿ç”¨ã€Œåºå·ç¼–ç ã€å’Œã€Œç‹¬çƒ­å‘é‡ç¼–ç ã€ç­‰æ–¹æ³•æ¥å®Œæˆã€‚

    # åºå·ç¼–ç 
    def encoder(df):
        for column in df[['neighbourhood_group_cleansed', 'property_type']].columns:
            labels = df[column].astype('category').cat.categories.tolist()
            replace_map = {column : {k: v for k,v in zip(labels,list(range(1,len(labels)+1)))}}
            df.replace(replace_map, inplace=True)
            print(replace_map)
        
        return df 
    
    gm_regression_df = encoder(gm_regression_df)
    

![](https://img-blog.csdnimg.cn/img_convert/ef3a3b27f4738bf31a1caadcd0d03217.png)

æˆ‘ä»¬å¯¹äº`host_response_time`å’Œ`room_type`å­—æ®µï¼Œä½¿ç”¨ç‹¬çƒ­å‘é‡ç¼–ç ï¼ˆå“‘å˜é‡å˜æ¢ï¼‰

    host_dummy = pd.get_dummies(gm_regression_df['host_response_time'], prefix='host_response')
    room_dummy = pd.get_dummies(gm_regression_df['room_type'], prefix='room_type')
    
    # æ‹¼æ¥ç¼–ç åçš„å­—æ®µ
    gm_regression_df = pd.concat([gm_regression_df, host_dummy, room_dummy], axis=1)
    
    # å‰”é™¤åŸå§‹å­—æ®µ
    gm_regression_df = gm_regression_df.drop(columns=['host_response_time', 'room_type'], axis=1)
    

æˆ‘ä»¬å†æŠŠä¹‹å‰å¤„ç†è¿‡çš„df\_amenitiesåšä¸€ç‚¹å¤„ç†ï¼Œå†æ‹¼æ¥åˆ°æ•°æ®ç‰¹å¾é‡Œ

    df_3 = pd.DataFrame(df_amenities.sum())
    features = df_3['amenities'][:150].to_list()
    amenities_updated = df_amenities.filter(items=(features))
    gm_regression_df = pd.concat([gm_regression_df, amenities_updated], axis=1)
    

æŸ¥çœ‹ä¸€ä¸‹æœ€ç»ˆæ•°æ®çš„ç»´åº¦

    gm_regression_df.shape
    # (3584, 198)
    

æˆ‘ä»¬æœ€åå¾—åˆ°äº†198ä¸ªå­—æ®µï¼Œä¸ºäº†é¿å…ç‰¹å¾ä¹‹é—´çš„å¤šé‡å…±çº¿æ€§ï¼Œä½¿ç”¨æ–¹å·®å› å­æ³•ï¼ˆVIFï¼‰æ¥é€‰æ‹©æœºå™¨å­¦ä¹ æ¨¡å‹çš„ç‰¹å¾ã€‚ VIF å¤§äº 10 çš„ç‰¹å¾è¢«åˆ é™¤ï¼Œå› ä¸ºè¿™äº›ç‰¹å¾çš„æ–¹å·®å¯ä»¥ç”±æ•°æ®é›†ä¸­çš„å…¶ä»–ç‰¹å¾è¡¨ç¤ºå’Œè§£é‡Šã€‚

    # è®¡ç®—VIF
    vif_model = gm_regression_df.drop(['price'], axis=1)
    vif_df = pd.DataFrame()
    vif_df['feature'] = vif_model.columns
    vif_df['VIF'] = [variance_inflation_factor(vif_model.values, i) for i in range(len(vif_model.columns))]
    
    # é€‰å‡ºå°äº10çš„ç‰¹å¾
    vif_df_new = vif_df[vif_df['VIF']<=10]
    feature_list =  vif_df_new['feature'].to_list()
    
    # é€‰å‡ºè¿™äº›ç‰¹å¾å¯¹åº”çš„æ•°æ®
    model_df = gm_regression_df.filter(items=(feature_list))
    model_df.head()
    

![](https://img-blog.csdnimg.cn/img_convert/a2da2e8a86c794c3707b1a84a023e487.png)

æˆ‘ä»¬æ‹¼æ¥ä¸Š`price`ç›®æ ‡æ ‡ç­¾å­—æ®µï¼Œå¯ä»¥æ„å»ºå®Œæ•´çš„æ•°æ®é›†

    price_col = gm_regression_df['price']
    model_df = model_df.join(price_col)
    

ğŸ“Œ æœºå™¨å­¦ä¹ ç®—æ³•
---------

æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å‡ ä¸ªå…¸å‹çš„å›å½’ç®—æ³•ï¼ŒåŒ…æ‹¬çº¿æ€§å›å½’ã€RandomForestRegressionã€Lasso Regression å’Œ GradientBoostingRegressionã€‚

> å…³äºæœºå™¨å­¦ä¹ ç®—æ³•çš„åº”ç”¨æ–¹æ³•ï¼Œæ¬¢è¿å¤§å®¶æŸ¥é˜…[ShowMeAI](https://www.showmeai.tech/)å¯¹åº”çš„æ•™ç¨‹ä¸æ–‡ç« ï¼Œå¿«å­¦å¿«ç”¨ã€‚
> 
> *   [**æœºå™¨å­¦ä¹ å®æˆ˜ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ç©è½¬æœºå™¨å­¦ä¹ ç³»åˆ—**](https://www.showmeai.tech/tutorials/41)
>     
> *   [**æœºå™¨å­¦ä¹ å®æˆ˜ | SKLearnå…¥é—¨ä¸ç®€å•åº”ç”¨æ¡ˆä¾‹**](https://www.showmeai.tech/article-detail/202)
>     
> *   [**æœºå™¨å­¦ä¹ å®æˆ˜ | SKLearnæœ€å…¨åº”ç”¨æŒ‡å—**](https://www.showmeai.tech/article-detail/203)
>     

### çº¿æ€§å›å½’å»ºæ¨¡

    def linear_reg(df, test_size=0.3, random_state=42):
        '''
        æ„å»ºæ¨¡å‹å¹¶è¿”å›è¯„ä¼°ç»“æœ
        è¾“å…¥: æ•°æ®dataframe 
        è¾“å‡º: ç‰¹å¾é‡è¦åº¦ä¸è¯„ä¼°å‡†åˆ™ï¼ˆRMSEä¸R-squaredï¼‰
        '''
        
        X = df.drop(columns=['price'])
        y = df[['price']]
        X_columns = X.columns
        
        # åˆ‡åˆ†è®­ç»ƒé›†ä¸æµ‹è¯•é›†
        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = test_size, random_state=random_state)
    
        # çº¿æ€§å›å½’åˆ†ç±»å™¨    
        clf = LinearRegression()
        
        # å€™é€‰å‚æ•°åˆ—è¡¨      
        parameters = {
                      'n_jobs': [1, 2, 5, 10, 100],
                      'fit_intercept': [True, False]
                     
                      }
        
        # ç½‘æ ¼æœç´¢äº¤å‰éªŒè¯è°ƒå‚    
        cv = GridSearchCV(estimator=clf, param_grid=parameters, cv=3, verbose=3)  
        cv.fit(X_train,y_train)
        
        # æµ‹è¯•é›†é¢„ä¼°
        pred = cv.predict(X_test)
        
        # æ¨¡å‹è¯„ä¼°
        r2 = r2_score(y_test, pred)
        mse = mean_squared_error(y_test, pred)
        rmse = mse **.5
         
        # æœ€ä½³å‚æ•°
        best_par = cv.best_params_
        coefficients = cv.best_estimator_.coef_
            
        #ç‰¹å¾é‡è¦åº¦
        importance = np.abs(coefficients)
        feature_importance = pd.DataFrame(importance, columns=X_columns).T
        #feature_importance = feature_importance.T
        feature_importance.columns = ['importance']
        feature_importance = feature_importance.sort_values('importance', ascending=False)
        
        print("The model performance for testing set")
        print("--------------------------------------")
        print('RMSE is {}'.format(rmse))
        print('R2 score is {}'.format(r2))
        print("\n")
        
        return feature_importance, rmse, r2
        
     linear_feat_importance, linear_rmse, linear_r2 = linear_reg(model_df)
    

![](https://img-blog.csdnimg.cn/img_convert/2f821818f64dc5fe5c3cc9854a160046.png)

### éšæœºæ£®æ—å»ºæ¨¡

    # éšæœºæ£®æ—å»ºæ¨¡
    def random_forest(df):
        '''
        æ„å»ºæ¨¡å‹å¹¶è¿”å›è¯„ä¼°ç»“æœ
        è¾“å…¥: æ•°æ®dataframe 
        è¾“å‡º: ç‰¹å¾é‡è¦åº¦ä¸è¯„ä¼°å‡†åˆ™ï¼ˆRMSEä¸R-squaredï¼‰
        '''
        
        X = df.drop(['price'], axis=1)
        X_columns = X.columns
        
        y = df['price']
    
        X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)
    
        # éšæœºæ£®æ—æ¨¡å‹        
        clf = RandomForestRegressor()
        
        # å€™é€‰å‚æ•°
        parameters = {
    
                    'n_estimators': [50, 100, 200, 300, 400],
                    'max_depth': [2, 3, 4, 5],
                     'max_depth': [80, 90, 100]
            
                         }
    
        # ç½‘æ ¼æœç´¢äº¤å‰éªŒè¯è°ƒå‚
        cv = GridSearchCV(estimator=clf, param_grid=parameters, cv=5, verbose=3)
        model = cv
        model.fit(X_train, y_train)
    
        # æµ‹è¯•é›†é¢„ä¼°
        pred = model.predict(X_test)
    
        # æ¨¡å‹è¯„ä¼°
        mse = mean_squared_error(y_test, pred)
        rmse = mse**.5
        r2 = r2_score(y_test, pred)
          
        # æœ€ä½³è¶…å‚æ•°
        best_par = model.best_params_
        
    
        # ç‰¹å¾é‡è¦åº¦
        r = permutation_importance(model, X_test, y_test,
                               n_repeats=10,
                               random_state=0)
        perm = pd.DataFrame(columns=['AVG_Importance'], index=[i for i in X_train.columns])
        perm['AVG_Importance'] = r.importances_mean
        perm = perm.sort_values(by='AVG_Importance', ascending=False);
        
        return rmse, r2, best_par, perm
    
    # è¿è¡Œå»ºæ¨¡
    r_forest_rmse, r_forest_r2, r_fores_best_params, r_forest_importance = random_forest(model_df)
    

è¿è¡Œç»“æœå¦‚ä¸‹

    Fitting 5 folds for each of 15 candidates, totalling 75 fits
    [CV 1/5] END ..................max_depth=80, n_estimators=50; total time=   2.4s
    [CV 2/5] END ..................max_depth=80, n_estimators=50; total time=   1.9s
    [CV 3/5] END ..................max_depth=80, n_estimators=50; total time=   1.9s
    [CV 4/5] END ..................max_depth=80, n_estimators=50; total time=   1.9s
    [CV 5/5] END ..................max_depth=80, n_estimators=50; total time=   1.9s
    [CV 1/5] END .................max_depth=80, n_estimators=100; total time=   3.8s
    [CV 2/5] END .................max_depth=80, n_estimators=100; total time=   3.8s
    [CV 3/5] END .................max_depth=80, n_estimators=100; total time=   3.9s
    [CV 4/5] END .................max_depth=80, n_estimators=100; total time=   3.8s
    [CV 5/5] END .................max_depth=80, n_estimators=100; total time=   3.8s
    [CV 1/5] END .................max_depth=80, n_estimators=200; total time=   7.5s
    [CV 2/5] END .................max_depth=80, n_estimators=200; total time=   7.7s
    [CV 3/5] END .................max_depth=80, n_estimators=200; total time=   7.7s
    [CV 4/5] END .................max_depth=80, n_estimators=200; total time=   7.6s
    [CV 5/5] END .................max_depth=80, n_estimators=200; total time=   7.6s
    [CV 1/5] END .................max_depth=80, n_estimators=300; total time=  11.3s
    [CV 2/5] END .................max_depth=80, n_estimators=300; total time=  11.4s
    [CV 3/5] END .................max_depth=80, n_estimators=300; total time=  11.7s
    [CV 4/5] END .................max_depth=80, n_estimators=300; total time=  11.4s
    [CV 5/5] END .................max_depth=80, n_estimators=300; total time=  11.4s
    [CV 1/5] END .................max_depth=80, n_estimators=400; total time=  15.1s
    [CV 2/5] END .................max_depth=80, n_estimators=400; total time=  16.4s
    [CV 3/5] END .................max_depth=80, n_estimators=400; total time=  15.6s
    [CV 4/5] END .................max_depth=80, n_estimators=400; total time=  15.2s
    [CV 5/5] END .................max_depth=80, n_estimators=400; total time=  15.6s
    [CV 1/5] END ..................max_depth=90, n_estimators=50; total time=   1.9s
    [CV 2/5] END ..................max_depth=90, n_estimators=50; total time=   1.9s
    [CV 3/5] END ..................max_depth=90, n_estimators=50; total time=   2.0s
    [CV 4/5] END ..................max_depth=90, n_estimators=50; total time=   2.0s
    [CV 5/5] END ..................max_depth=90, n_estimators=50; total time=   2.0s
    [CV 1/5] END .................max_depth=90, n_estimators=100; total time=   3.9s
    [CV 2/5] END .................max_depth=90, n_estimators=100; total time=   3.9s
    [CV 3/5] END .................max_depth=90, n_estimators=100; total time=   4.0s
    [CV 4/5] END .................max_depth=90, n_estimators=100; total time=   3.9s
    [CV 5/5] END .................max_depth=90, n_estimators=100; total time=   3.9s
    [CV 1/5] END .................max_depth=90, n_estimators=200; total time=   8.7s
    [CV 2/5] END .................max_depth=90, n_estimators=200; total time=   8.1s
    [CV 3/5] END .................max_depth=90, n_estimators=200; total time=   8.1s
    [CV 4/5] END .................max_depth=90, n_estimators=200; total time=   7.7s
    [CV 5/5] END .................max_depth=90, n_estimators=200; total time=   8.0s
    [CV 1/5] END .................max_depth=90, n_estimators=300; total time=  11.6s
    [CV 2/5] END .................max_depth=90, n_estimators=300; total time=  11.8s
    [CV 3/5] END .................max_depth=90, n_estimators=300; total time=  12.2s
    [CV 4/5] END .................max_depth=90, n_estimators=300; total time=  12.0s
    [CV 5/5] END .................max_depth=90, n_estimators=300; total time=  13.2s
    [CV 1/5] END .................max_depth=90, n_estimators=400; total time=  15.6s
    [CV 2/5] END .................max_depth=90, n_estimators=400; total time=  15.9s
    [CV 3/5] END .................max_depth=90, n_estimators=400; total time=  16.1s
    [CV 4/5] END .................max_depth=90, n_estimators=400; total time=  15.7s
    [CV 5/5] END .................max_depth=90, n_estimators=400; total time=  15.8s
    [CV 1/5] END .................max_depth=100, n_estimators=50; total time=   1.9s
    [CV 2/5] END .................max_depth=100, n_estimators=50; total time=   2.0s
    [CV 3/5] END .................max_depth=100, n_estimators=50; total time=   2.0s
    [CV 4/5] END .................max_depth=100, n_estimators=50; total time=   2.0s
    [CV 5/5] END .................max_depth=100, n_estimators=50; total time=   2.0s
    [CV 1/5] END ................max_depth=100, n_estimators=100; total time=   4.0s
    [CV 2/5] END ................max_depth=100, n_estimators=100; total time=   4.0s
    [CV 3/5] END ................max_depth=100, n_estimators=100; total time=   4.1s
    [CV 4/5] END ................max_depth=100, n_estimators=100; total time=   4.0s
    [CV 5/5] END ................max_depth=100, n_estimators=100; total time=   4.0s
    [CV 1/5] END ................max_depth=100, n_estimators=200; total time=   7.8s
    [CV 2/5] END ................max_depth=100, n_estimators=200; total time=   7.9s
    [CV 3/5] END ................max_depth=100, n_estimators=200; total time=   8.1s
    [CV 4/5] END ................max_depth=100, n_estimators=200; total time=   7.9s
    [CV 5/5] END ................max_depth=100, n_estimators=200; total time=   7.8s
    [CV 1/5] END ................max_depth=100, n_estimators=300; total time=  11.8s
    [CV 2/5] END ................max_depth=100, n_estimators=300; total time=  12.0s
    [CV 3/5] END ................max_depth=100, n_estimators=300; total time=  12.8s
    [CV 4/5] END ................max_depth=100, n_estimators=300; total time=  11.4s
    [CV 5/5] END ................max_depth=100, n_estimators=300; total time=  11.5s
    [CV 1/5] END ................max_depth=100, n_estimators=400; total time=  15.1s
    [CV 2/5] END ................max_depth=100, n_estimators=400; total time=  15.3s
    [CV 3/5] END ................max_depth=100, n_estimators=400; total time=  15.6s
    [CV 4/5] END ................max_depth=100, n_estimators=400; total time=  15.3s
    [CV 5/5] END ................max_depth=100, n_estimators=400; total time=  15.3s
    

éšæœºæ£®æ—æœ€åçš„ç»“æœå¦‚ä¸‹

    r_forest_rmse, r_forest_r2
    # (218.7941962807868, 0.4208644494689676)
    

### GBDTå»ºæ¨¡

    def GBDT_model(df):
        '''
        æ„å»ºæ¨¡å‹å¹¶è¿”å›è¯„ä¼°ç»“æœ
        è¾“å…¥: æ•°æ®dataframe 
        è¾“å‡º: ç‰¹å¾é‡è¦åº¦ä¸è¯„ä¼°å‡†åˆ™ï¼ˆRMSEä¸R-squaredï¼‰
        '''
        
        X = df.drop(['price'], axis=1)
        Y = df['price']
        X_columns = X.columns
    
        X_train, X_test, y_train, y_test = train_test_split(X, Y, random_state=42)
        
    
            
        clf = GradientBoostingRegressor()
        
        
        parameters = {
    
                    'learning_rate': [0.1, 0.5, 1],
                    'min_samples_leaf': [10, 20, 40 , 60]
                    
            
                         }
        cv = GridSearchCV(estimator=clf, param_grid=parameters, cv=5, verbose=3)
        
        model = cv
        model.fit(X_train, y_train)
        pred = model.predict(X_test)
        
        r2 = r2_score(y_test, pred)
        mse = mean_squared_error(y_test, pred)
        rmse = mse**.5
            
        coefficients = model.best_estimator_.feature_importances_
    
        importance = np.abs(coefficients)
        feature_importance = pd.DataFrame(importance, index= X_columns,
                                          columns=['importance']).sort_values('importance', ascending=False)[:10]
        
        return r2, mse, rmse, feature_importance
    
    GBDT_r2, GBDT_mse, GBDT_rmse, GBDT_feature_importance = GBDT_model(model_df)
    GBDT_r2, GBDT_rmse
    # (0.46352992147034244, 210.58063809645563)
    

ğŸ“Œ ç»“æœ&åˆ†æ
--------

ç›®å‰éšæœºæ£®æ—çš„è¡¨ç°æœ€ç¨³å®šï¼Œè€Œé›†æˆæ¨¡å‹GradientBoostingRegression çš„RÂ²å¾ˆé«˜ï¼ŒRMSE å€¼ä¹Ÿåé«˜ï¼ŒBoostingçš„æ¨¡å‹å—å¼‚å¸¸å€¼å½±å“å¾ˆå¤§ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºæ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼å¼•èµ·çš„ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥åšä¸€ä¸‹ä¼˜åŒ–ï¼Œåˆ é™¤æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥æé«˜æ¨¡å‹æ€§èƒ½ã€‚

ğŸ“Œ æ•ˆæœä¼˜åŒ–
-------

å¼‚å¸¸å€¼åœ¨æ—©äº›æ—¶å€™å°±å·²ç»è¢«è¯†åˆ«å‡ºæ¥äº†ï¼Œæˆ‘ä»¬åŸºäºç»Ÿè®¡çš„æ–¹æ³•æ¥å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚

    # åŸºäºç»Ÿè®¡æ–¹æ³•è®¡ç®—ä»·æ ¼è¾¹ç•Œ
    q3, q1 = np.percentile(model_df['price'], [75, 25])
    iqr = q3 - q1
    q3 + (iqr*1.5)
    
    # å¾—åˆ°ç»“æœ245.0
    

æˆ‘ä»¬æŠŠä»»ä½•é«˜äº 245 ç¾å…ƒçš„å€¼éƒ½è§†ä¸ºå¼‚å¸¸å€¼å¹¶åˆ é™¤ã€‚

    new_model_df = model_df[model_df['price']<245]
    
    # ç»˜åˆ¶æ­¤æ—¶çš„ä»·æ ¼åˆ†å¸ƒ
    sb.histplot(new_model_df['price'])
    plt.title('New price distribution in the dataset')
    

![](https://img-blog.csdnimg.cn/img_convert/4c70883575fa479261c8c99c757fd14e.png)

é‡æ–°è¿è¡Œè¿™äº›ç®—æ³•

    linear_feat_importance, linear_rmse, linear_r2 = linear_reg(new_model_df)
    r_forest_rmse, r_forest_r2, r_fores_best_params, r_forest_importance = random_forest(new_model_df)
    GBDT_r2, GBDT_mse, GBDT_rmse, GBDT_feature_importance = GBDTboost(new_model_df)
    

å¾—åˆ°çš„æ–°ç»“æœå¦‚ä¸‹

![](https://img-blog.csdnimg.cn/img_convert/508bdb7e66caa0b70b8e4c8d7362f8ad.png)

ğŸ’¡ å½’å› åˆ†æ
=======

é‚£ä¹ˆï¼ŒåŸºäºæˆ‘ä»¬çš„æ¨¡å‹æ¥åˆ†æï¼Œåœ¨é¢„æµ‹å¤§æ›¼å½»æ–¯ç‰¹åœ°åŒº Airbnb æˆ¿æºçš„ä»·æ ¼æ—¶ï¼Œå“ªäº›å› ç´ æ›´é‡è¦ï¼Ÿ

    r_feature_importance = r_forest_importance.reset_index()
    r_feature_importance = r_feature_importance.rename(columns={'index':'Feature'})
    r_feature_importance[:15]
    

![](https://img-blog.csdnimg.cn/img_convert/dc0eb6758a64dbafb17620b86b1277fc.png)

    # ç»˜åˆ¶æœ€é‡è¦çš„15ä¸ªå› ç´ 
    r_feature_importance[:15].sort_values(by='AVG_Importance').plot(kind='barh', x='Feature', y='AVG_Importance', figsize=(8,6));
    plt.title('Top 15 Most Imporatant Features');
    

![](https://img-blog.csdnimg.cn/img_convert/713b090431c0836a64405b686d26f65a.png)

æˆ‘ä»¬çš„æ¨¡å‹ç»™å‡ºçš„é‡è¦å› ç´ åŒ…æ‹¬ï¼š

*   **accommodates** ï¼šå¯ä»¥å®¹çº³çš„æœ€å¤§äººæ•°ã€‚
*   **bathrooms\_new** ï¼šéå…±ç”¨æˆ–éç§äººæµ´å®¤çš„æ•°é‡ã€‚
*   **minimum\_nights** ï¼šæˆ¿æºå¯é¢„å®šçš„æœ€å°‘æ™šæ•°ã€‚
*   **number\_of\_reviews** ï¼šæ€»è¯„è®ºæ•°ã€‚
*   **Free street parking** ï¼šå…è´¹è·¯è¾¹åœè½¦ä½çš„å­˜åœ¨æ˜¯å½±å“æ¨¡å‹å®šä»·çš„æœ€é‡è¦çš„ä¾¿åˆ©è®¾æ–½ã€‚
*   **Gym** ï¼šå¥èº«æˆ¿è®¾æ–½ã€‚

ğŸ’¡ æ€»ç»“&å±•æœ›
========

![](https://img-blog.csdnimg.cn/img_convert/0460b9d7b46ac08d03575edb829a5c03.png)

æˆ‘ä»¬é€šè¿‡å¯¹Airbnbçš„æ•°æ®è¿›è¡Œæ·±å…¥æŒ–æ˜åˆ†æå’Œå»ºæ¨¡ï¼Œå®Œæˆå¯¹äºæ°‘å®¿ç§Ÿèµåœºæ™¯ä¸‹çš„AIç†è§£ä¸å»ºæ¨¡é¢„ä¼°ã€‚æˆ‘ä»¬åç»­è¿˜æœ‰ä¸€äº›å¯ä»¥åšçš„äº‹æƒ…ï¼Œæå‡æ¨¡å‹çš„è¡¨ç°ï¼Œå®Œæˆæ›´ç²¾å‡†åœ°é¢„ä¼°ï¼Œæ¯”å¦‚ï¼š

*   æ›´å®Œå–„çš„ç‰¹å¾å·¥ç¨‹ï¼Œç»“åˆä¸šåŠ¡åœºæ™¯æ„å»ºæ›´æœ‰æ•ˆçš„ä¸šåŠ¡ç‰¹å¾ã€‚
*   ä½¿ç”¨xgboostã€lightgbmã€catboostç­‰æ¨¡å‹ã€‚
*   ä½¿ç”¨è´å¶æ–¯è°ƒå‚ç­‰æ–¹æ³•å¯¹è¶…å‚æ•°åšæ›´æ·±å…¥çš„è°ƒä¼˜ã€‚
*   æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œçš„æ–¹æ³•å¼•å…¥ã€‚

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ **æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Pandas é€ŸæŸ¥è¡¨**ï¼š[https://www.showmeai.tech/article-detail/101](https://www.showmeai.tech/article-detail/101)
*   ğŸ“˜ **å›¾è§£æ•°æ®åˆ†æï¼šä»å…¥é—¨åˆ°ç²¾é€šç³»åˆ—æ•™ç¨‹**ï¼š[https://www.showmeai.tech/tutorials/33](https://www.showmeai.tech/tutorials/33)
*   ğŸ“˜ **æœºå™¨å­¦ä¹ å®æˆ˜ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ç©è½¬æœºå™¨å­¦ä¹ ç³»åˆ—**ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)
*   ğŸ“˜ **æœºå™¨å­¦ä¹ å®æˆ˜ | SKLearnå…¥é—¨ä¸ç®€å•åº”ç”¨æ¡ˆä¾‹**ï¼š[https://www.showmeai.tech/article-detail/202](https://www.showmeai.tech/article-detail/202)
*   ğŸ“˜ **æœºå™¨å­¦ä¹ å®æˆ˜ | SKLearnæœ€å…¨åº”ç”¨æŒ‡å—**ï¼š[https://www.showmeai.tech/article-detail/203](https://www.showmeai.tech/article-detail/203)
*   ğŸ“˜ **æœºå™¨å­¦ä¹ å®æˆ˜ | æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹æœ€å…¨è§£è¯»**ï¼š[https://www.showmeai.tech/article-detail/208](https://www.showmeai.tech/article-detail/208)

[![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)](https://www.showmeai.tech/)