---
layout: post
title: "jmeter做性能测试"
date: "2023-02-16T01:23:29.093Z"
---
jmeter做性能测试
===========

一、线程与进程
-------

一个软件/程序，是以进程的方式存在的，一个进程可含多个线程（一个软件可以做多个事情，就是基于线程而实现的）

二、并发的基本概念
---------

并发：

并发用户数：同一时刻，服务器/接口接收到的用户量，例如同一时刻有22个同学同时点击登录按钮，此时并发用户数为22

并发请求数/qps/rps：同一时刻服务器正在处理的请求数 （请求数一般理解为接口的请求数），例如点击登录按钮后，会同时请求8个接口，则并发请求数为22\*8

注意：通常意义上的并发指的是并发用户数

jmeter性能测试原理：通过模拟高并发来测试服务器在一段时间内的性能瓶颈/最大并发

三、设置并发
------

1、设置线程数（在线程属性里设置线程数，一个线程数即为一个人）

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230213172815151-1443451532.png)

*    Ramp-up Period（in seconds）：决定多长时间启动所有线程。如果使用10个线程，ramp-up period是100秒，那么JMeter用100秒使所有10个线程启动并运行。每个线程会在上一个线程启动后10秒（100/10）启动。Ramp-up需要要充足长以避免在启动测试时有一个太大的工作负载，并且要充足小以至于最后一个线程在第一个完成前启动。  一般设置ramp-up=线程数启动，并上下调整到所需的。
*   循环次数：通常使用循环次数增加测试时间，一般设置为100

也可以使用调度器设置时间，通常是5min、10min、30min这种比较短的

2、添加集合点（适用于顺时并发较高的情景，在jmeter中不用设置所有的情况，在并发高的第一个接口设置）

应用场景：抢购/秒杀（等待线程数准备好了再冲）

例子：活动，大转盘，每天九点开启，奖品非常丰富，你做性能测试的时候，怎么模拟这种情况？

设置集合点步骤：

①添加同步定时器

右键http请求--->添加---->定时器---->synchronizing timer

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215164455675-1315850958.png)

②配置定时器

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215164831015-528217357.png)

 四、jmeter中的参数化
--------------

设置并发后，会发现登录接口有的能正常运行，有的报错，这是因为多个人共用同一个账号导致的，所以针对这个情况，需要对数据进行参数化

参数化含义：单个线程需要单独的数据，比如登录的账号和密码

1、参数化步骤

4.1.1：明确哪些数据需要做参数，数据是从哪里来的

4.1.2：准备测试账号

web接口：调用接口准备

小程序：生成openID的算法来创建测试账号的token，再把token按照规则插入到Redis和数据库表中

4.1.3：使用CSV数据文件设置引用数据文件 　　

CVS数据文件设置会自动取出单独的数据，保证没分线程数据是唯一的

①右键线程组--->添加---->配置元件---->CSV数据文件设置

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215172227588-927381762.png)

 ②选取已配置的文件

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215175147547-452904925.png)

 ③信息头管理器中，引用变量

 ![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215175111837-1280502769.png)

 五、聚合报告
-------

即性能测试结果/性能指标，在测试计划中添加

右键测试计划--->添加--->监听器--->聚合报告

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215180054128-2134955894.png)

 指标判断标准：

*   响应时间--平均响应时间：
*   响应时间-90%line、95%line、99%line：当前有多少人在这个时间点的响应时间（决定了绝大用户的使用感受）

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215180813272-1561475902.png)

 不同行业和项目对响应时间会有不同的要求，例如，互联网：500ms以下，例如淘宝业务10毫秒左右；

金融企业，1秒以下为佳，部分复杂业务3s以下

保险企业：3s以下为佳

制造业：5s以下为佳

 一般来说，响应时间都会遵循258原则，即2s以下优秀，2-5s可接受，5-8s良，8s差（不清楚就以8s作为依据）

*   失败率，即出错的概率

项目给出的标准   200qps，失败率不超过0.01%，一般的小公司系统，小于5%即可，比较简单粗略

*   服务器上cpu使用率，即服务器的繁忙程度，原则是不要持续100%，最好是在85%<x<90之间
*   tps：服务器每秒返回的请求数，在jmeter中称为吞吐量，评论服务器性能的辅助指标

![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215183451948-1810092703.png)

 tps最主要的作用是用来找性能瓶颈（一般来说，随着并发数的增加，系统的性能会先稳定增加，之后一段时间系统性能趋于平稳，最后系统性能会下降，系统性能下降的那个点，称为性能拐点，可得到最大并发）

 ![](https://img2023.cnblogs.com/blog/1779185/202302/1779185-20230215184413018-740291293.png)

 注：我们在项目中，一般是只以响应时间、失败率、CPU使用率来判断性能指标就够了