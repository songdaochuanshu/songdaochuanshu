---
layout: post
title: "å¦‚ä½•åœ¨ pyqt ä¸­ä½¿ç”¨åŠ¨ç”»å®ç°å¹³æ»‘æ»šåŠ¨çš„ QScrollArea"
date: "2023-01-25T05:14:41.910Z"
---
å¦‚ä½•åœ¨ pyqt ä¸­ä½¿ç”¨åŠ¨ç”»å®ç°å¹³æ»‘æ»šåŠ¨çš„ QScrollArea
=================================

å‰è¨€
==

åœ¨ä¹‹å‰çš„åšå®¢[ã€Šå¦‚ä½•åœ¨ pyqt ä¸­å®ç°å¹³æ»‘æ»šåŠ¨çš„ QScrollAreaã€‹](https://www.cnblogs.com/zhiyiYo/p/14644028.html)ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®šæ—¶å™¨å’Œé˜Ÿåˆ—å®ç°äº†å¹³æ»‘æ»šåŠ¨ã€‚ä½†æ˜¯å®ç°ä»£ç è¿˜æ˜¯æœ‰ä¸€ç‚¹å¤æ‚ï¼Œæ‰€ä»¥è¿™ç¯‡åšå®¢å°†ä½¿ç”¨ Qt çš„åŠ¨ç”»æ¡†æ¶ `QPropertyAnimation` æ¥å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚

å®ç°è¿‡ç¨‹
====

SmoothScrollBar
---------------

æ»šåŠ¨è¿‡ç¨‹å…¶å®å°±æ˜¯æ”¹å˜ `QScrollBar` çš„ `value()` çš„è¿‡ç¨‹ï¼ŒQt è‡ªå¸¦çš„ `QScrollArea` ä¹‹æ‰€ä»¥æ— æ³•å¹³æ»‘æ»šåŠ¨ï¼Œå°±æ˜¯å› ä¸ºæ»šåŠ¨æ—¶åœ¨ `QScrollBar` çš„ä¸¤ä¸ª `value()` ä¹‹é—´è¿›è¡Œè·³å˜ã€‚å¦‚æœæˆ‘ä»¬èƒ½åœ¨ä¸¤ä¸ªæ»šåŠ¨å€¼ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œå°±èƒ½å®ç°å¹³æ»‘æ»šåŠ¨äº†ï¼Œè¿™é‡Œé€šè¿‡é‡å†™ `setValue()` å‡½æ•°æ¥å¯åŠ¨æ»šåŠ¨åŠ¨ç”»ã€‚

    class SmoothScrollBar(QScrollBar):
        """ Smooth scroll bar """
    
        scrollFinished = pyqtSignal()
    
        def __init__(self, parent=None):
            QScrollBar.__init__(self, parent)
            self.ani = QPropertyAnimation()
            self.ani.setTargetObject(self)
            self.ani.setPropertyName(b"value")
            self.ani.setEasingCurve(QEasingCurve.OutCubic)
            self.ani.setDuration(500)
            self.ani.finished.connect(self.scrollFinished)
    
        def setValue(self, value: int):
            if value == self.value():
                return
    
            # stop running animation
            self.ani.stop()
            self.scrollFinished.emit()
    
            self.ani.setStartValue(self.value())
            self.ani.setEndValue(value)
            self.ani.start()
    
        def scrollValue(self, value: int):
            """ scroll the specified distance """
            value += self.value()
            self.scrollTo(value)
    
        def scrollTo(self, value: int):
            """ scroll to the specified position """
            value = min(self.maximum(), max(self.minimum(), value))
            self.setValue(value)
    
        def mousePressEvent(self, e):
            self.ani.stop()
            super().mousePressEvent(e)
    
        def mouseReleaseEvent(self, e):
            self.ani.stop()
            super().mouseReleaseEvent(e)
    
        def mouseMoveEvent(self, e):
            self.ani.stop()
            super().mouseMoveEvent(e)
    

SmoothScrollArea
----------------

æœ€åéœ€è¦å°† `QScrollArea` çš„é»˜è®¤æ»šåŠ¨æ¡æ›¿æ¢ä¸ºå¹³æ»‘æ»šåŠ¨çš„ `SmoothScrollBar`ï¼š

    
    class SmoothScrollArea(QScrollArea):
        """ Smooth scroll area """
    
        def __init__(self, parent=None):
            super().__init__(parent)
            self.hScrollBar = SmoothScrollBar()
            self.vScrollBar = SmoothScrollBar()
            self.hScrollBar.setOrientation(Qt.Horizontal)
            self.vScrollBar.setOrientation(Qt.Vertical)
            self.setVerticalScrollBar(self.vScrollBar)
            self.setHorizontalScrollBar(self.hScrollBar)
    
        def setScrollAnimation(self, orient, duration, easing=QEasingCurve.OutCubic):
            """ set scroll animation
    
            Parameters
            ----------
            orient: Orient
                scroll orientation
    
            duration: int
                scroll duration
    
            easing: QEasingCurve
                animation type
            """
            bar = self.hScrollBar if orient == Qt.Horizontal else self.vScrollBar
            bar.ani.setDuration(duration)
            bar.ani.setEasingCurve(easing)
    
        def wheelEvent(self, e):
            if e.modifiers() == Qt.NoModifier:
                self.vScrollBar.scrollValue(-e.angleDelta().y())
            else:
                self.hScrollBar.scrollValue(-e.angleDelta().x())
    

æµ‹è¯•
==

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å›¾ç‰‡æŸ¥çœ‹å™¨æµ‹è¯•ç¨‹åºï¼š

    # coding:utf-8
    import sys
    from PyQt5.QtCore import QEasingCurve, Qt
    from PyQt5.QtGui import QPixmap
    from PyQt5.QtWidgets import QApplication, QLabel
    
    
    class Demo(SmoothScrollArea):
    
        def __init__(self):
            super().__init__()
            self.label = QLabel(self)
            self.label.setPixmap(QPixmap("shoko.jpg"))
    
            # customize scroll animation
            self.setScrollAnimation(Qt.Vertical, 400, QEasingCurve.OutQuint)
            self.setScrollAnimation(Qt.Horizontal, 400, QEasingCurve.OutQuint)
    
            self.horizontalScrollBar().setValue(1900)
            self.setWidget(self.label)
            self.resize(1200, 800)
    
    
    if __name__ == '__main__':
        app = QApplication(sys.argv)
        w = Demo()
        w.show()
        app.exec_()
    

æµ‹è¯•ç”¨çš„å›¾ç‰‡å¦‚ä¸‹ï¼ˆç¡å­é…±çœŸå¯çˆ±ğŸ¥°ï¼š

![shoko.jpg](https://img2023.cnblogs.com/blog/2065884/202301/2065884-20230125115717213-1315493252.jpg)

å†™åœ¨æœ€å
====

è‡³æ­¤å¹³æ»‘æ»šåŠ¨çš„å®ç°æ–¹å¼å°±å·²ä»‹ç»å®Œæ¯•äº†ï¼Œæ›´å¤šè‡ªå®šä¹‰å°éƒ¨ä»¶å¯ä»¥å‚è§ [PyQt-Fluent-Widgets](https://github.com/zhiyiYo/PyQt-Fluent-Widgets)ï¼Œä»¥ä¸Š~~