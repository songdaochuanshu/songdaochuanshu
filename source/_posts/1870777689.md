---
layout: post
title: "æ‰‹æ’¸Routerï¼Œè¿˜è¦å•¥Routeræ¡†æ¶ï¼Ÿreact-router/vue-routerèººä¸€è¾¹å»"
date: "2022-09-05T12:37:48.447Z"
---
æ‰‹æ’¸Routerï¼Œè¿˜è¦å•¥Routeræ¡†æ¶ï¼Ÿreact-router/vue-routerèººä¸€è¾¹å»
================================================

![æ‰‹æ’¸Routerï¼Œè¿˜è¦å•¥Routeræ¡†æ¶ï¼Ÿreact-router/vue-routerèººä¸€è¾¹å»](https://img2022.cnblogs.com/blog/1594027/202209/1594027-20220905151345290-801330356.png) æœ‰æ²¡æœ‰å‘ç°ï¼Œåœ¨å¤§å®¶ä½¿ç”¨React/Vueçš„æ—¶å€™ï¼Œæ€»ç¦»ä¸å¼€ä¸€ä¸ªå°å°¾å·´ï¼Œåˆ°å“ªéƒ½å¾—å¸¦ç€ä»–ï¼Œé‚£å°±æ˜¯react-router/vue-routerï¼Œè€ŒåŸºäºå®ƒä»¬çš„ç¬¬ä¸‰æ–¹æ¡†æ¶åˆå‡ºç°å¾ˆå¤šä¸ªæ€§åŒ–çº¦å®šå’Œæ‰©å±•ï¼Œæ¯”å¦‚nuxtjs/nextjs/umijséƒ½çº·çº·æ¨å‡ºè‡ªå·±çš„è·¯ç”±æ–¹æ¡ˆã€‚

æœ‰æ²¡æœ‰å‘ç°ï¼Œåœ¨å¤§å®¶ä½¿ç”¨React/Vueçš„æ—¶å€™ï¼Œæ€»ç¦»ä¸å¼€ä¸€ä¸ªå°å°¾å·´ï¼Œåˆ°å“ªéƒ½å¾—å¸¦ç€ä»–ï¼Œé‚£å°±æ˜¯react-router/vue-routerï¼Œè€ŒåŸºäºå®ƒä»¬çš„ç¬¬ä¸‰æ–¹æ¡†æ¶åˆå‡ºç°å¾ˆå¤šä¸ªæ€§åŒ–çº¦å®šå’Œæ‰©å±•ï¼Œæ¯”å¦‚nuxtjs/nextjs/umijséƒ½çº·çº·æ¨å‡ºè‡ªå·±çš„è·¯ç”±æ–¹æ¡ˆã€‚

æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå…¶å®ä½ å¯ä»¥å®Œå…¨æ‘†è„±ä»–ä»¬éƒ½æŸç¼šï¼Ÿè€Œä¸”å¹¶ä¸å¤æ‚ï¼Œä¸‹é¢å¬æˆ‘æ¥åˆ†æåˆ†æï¼š

Stateå¯ä»¥æ§åˆ¶ä¸€åˆ‡UI
-------------

é¦–å…ˆReact/Vueéƒ½æ˜¯åŸºäºMVVMæ¶æ„ï¼ŒStateå¯ä»¥å†³å®šComponentçš„æ˜¾ç¤ºä¸å¦ï¼Œè€Œä¸”å¾ˆç®€å•ï¼š

    // jsx
    {show? <SubUI /> : null}
    
    // vue
    <SubUI v-if="show" />
    

ä¹Ÿå¯ä»¥æ ¹æ®Stateæ¥åŠ¨æ€æ˜¾ç¤ºç»„ä»¶ï¼š

    <component :is="componentA"></component>
    

æ§åˆ¶UIçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæˆ‘å°±ä¸ä¾‹ä¸¾äº†ï¼Œæ€»ä¹‹Stateæ‰æ˜¯æŒæ§UIçš„å¤§è„‘ä¸­æ¢ã€‚

å°†URLæ˜ å°„ä¸ºState
------------

è·¯ç”±çš„ä½œç”¨ï¼Œæ— éå°±æ˜¯æ ¹æ®Urlæ¥æ§åˆ¶UIå±•ç¤ºï¼Œé‚£ä¹ˆä½ åªéœ€è¦å°†Urlæ˜ å°„æˆä¸ºStateï¼Œä¸å°±è¾¾åˆ°ç›®çš„äº†ï¼Ÿ

Urlä¸»è¦åˆ†2éƒ¨åˆ†ï¼Œ`pathname`å’Œ`query`ï¼Œæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹åº“æä¾›è§£æå®ƒä»¬çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š

*   pathnameè§£æï¼š[path-to-regexp](https://www.npmjs.com/package/path-to-regexp)ï¼š
    
        const regexp = pathToRegexp("/:foo/:bar");
        regexp.exec("/test/route");
        
    
    å…·ä½“ç”¨æ³•å¤§å®¶çœ‹çœ‹å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥äº†ï¼Œå¾ˆç®€å•...
*   queryè§£æï¼šqueryå…¶å®å¾ˆçµæ´»ï¼Œæ²¡æœ‰è§„å®šéå¾—ç”¨ä»€ä¹ˆæ ¼å¼ï¼Œæœ€ç®€å•çš„ä½ ç›´æ¥ç”¨JSON.stringifyå°†åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä½œä¸ºqueryä¹Ÿå¯ä»¥ï¼Œå¦‚æœä½ æƒ³éµå¾ªå¸¸ç”¨çš„æ ¼å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ï¼š[query-string](https://www.npmjs.com/package/query-string) æˆ–è€… [qs](https://www.npmjs.com/package/qs)
    
        queryString.parse(location.search)
        
    

å¥½äº†ï¼Œç°åœ¨ä½ å¯ä»¥æ‹¿åˆ°è§£æUrlåçš„æ•°æ®ï¼Œç„¶åæŠŠå®ƒä»¬è½¬æ¢æˆä½ æƒ³è¦çš„Stateï¼Œå­˜æ”¾åœ¨å…¨å±€Storeä¸­å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ä½ å®šä¹‰ä¸€ä¸ªUrlï¼š

> /member/list/3?uname=lily

    //æå–è·¯ç”±ä¿¡æ¯
    getRouteParams(): RouteParams {
        const query = queryString.parse(location.search);
        const [, curModule='', curView='', id=''] = pathToRegexp('/:curModule/:curView/:id')
        .exec(location.pathname) || [];
        if (curView === 'list') {
           //å¦‚æœæ˜¯åˆ—è¡¨ï¼ŒIDè¡¨ç¤ºå½“å‰é¡µç 
           return {...query, pageCurrent: id, curView}
        } else if(curView === 'detail') {
           return {...query, id, curView}
        }
    }
    
    

ç„¶ååœ¨UIä¸­æ‹¿åˆ°è¿™å‡ ä¸ªStateï¼ˆå¯é€šè¿‡Reduxæˆ–Vuexï¼‰ï¼š

    const Component = ({curView}) => {
      return (
        <>
          {curView === 'list' && <List />}
          {curView === 'detail' &&  <Detail />}
        </>
      );
    };
    

å‘èµ·è·¯ç”±è·³è½¬
------

åŸºäº`pushState`å’Œ`replaceState`ï¼Œå°è£…ä¸€ä¸‹å°±å¯ä»¥äº†ï¼š

    window.history.pushState(null, '', url);
    window.history.replaceState(null, '', url);
    

    const Link = ({url, action, ...props}) => {
      const onClick = (event: MouseEvent) => {
        event.preventDefault();
        window.history[`${action}State`](null, '', url);
      }
      return <a onClick={onClick} {...props} />;
    }
    

ç›‘å¬è·¯ç”±å˜åŒ–
------

ç›‘å¬`popstate`äº‹ä»¶å°±è¡Œäº†ï¼š

    window.addEventListener('popstate',() => {
      //è§£æUrlå¹¶æ›´æ–°Store
      //...
    });
    

æ‰‹æ’¸çš„å¥½å¤„
-----

*   UIæ¸²æŸ“æ›´çº¯ç²¹ï¼Œå°†UIçš„ç”Ÿæ€å¤§æƒç‰¢ç‰¢æŒæ¡åœ¨Stateæ‰‹ä¸­ï¼Œ`UI = render(state)`ï¼Œè·¯ç”±å’Œå…¶å®ƒå› å­éƒ½è¢«æŒ¡åœ¨å¤–å›´ï¼Œå½“ä½œä¸€ç§å½±å“Stateçš„å‰¯ä½œç”¨ä¹‹ä¸€ã€‚

![111.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae2c5a37f37549d79f971ea89b534a38~tplv-k3u1fbpfcp-watermark.image?)

*   çµæ´»æ€§æ›´é«˜ï¼Œä½ å¯ä»¥æŠŠURLæ˜ å°„æˆä¸ºä»»ä½•Stateï¼Œä»è€Œæ§åˆ¶ä»»ä½•Stateèƒ½æ§åˆ¶çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ç”¨Urlæ¥æ§åˆ¶ä¸€ä¸ªæŒ‰é’®çš„å¯ç”¨ä¸ç¦ç”¨ï¼Œå¼¹çª—çš„å¼¹å‡ºä¸å…³é—­ç­‰ç­‰ã€‚
*   ä¸ä¾èµ–å„ç§ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œä¸ç”¨å­¦ä¹ å®ƒä»¬ï¼Œä¹Ÿä¸å—å®ƒä»¬çš„çº¦æŸã€‚
*   UIå’ŒRouterä¹‹é—´æ²¡æœ‰ç›´æ¥ç»‘å®šï¼Œè€Œæ˜¯é€šè¿‡Stateæ˜ å°„ï¼Œè¿™æ„å‘³ç€å¦‚æœäº§å“ä¼˜åŒ–ã€è·¯ç”±æ ¼å¼å˜åŠ¨ï¼Œæ”¹åŠ¨çš„åªæ˜¯æ˜ å°„ï¼Œè€Œä¸ç”¨åŠ¨åˆ°Viewå’ŒStateï¼Œè¿™æ ·æ›´æ¾æ•£ã€‚

å®é™…æ¡ˆä¾‹
----

ä»¥ä¸Šæ‰€è¯´åªæ˜¯ä¸€ä¸ªå¤§ä½“æ€è·¯ï¼ŒçœŸæ­£è¦ç”¨å¾—æ–¹ä¾¿ï¼Œè¿˜å¾—åšä¸€äº›ç»†èŠ‚çš„å°è£…å’Œæ”¹åŠ¨ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªè‡ªå·±çš„å¼€æºé¡¹ç›®ä¾›å¤§å®¶å‚è€ƒï¼Œåœ¨çº¿é¢„è§ˆï¼š[http://admin-react-antd.eluxjs.com/](http://admin-react-antd.eluxjs.com/)

è¯¥é¡¹ç›®ä¸­ï¼Œæ²¡æœ‰ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹Routeræ¡†æ¶ï¼Œå…¨å‡­è‡ªå·±æ’¸ï¼Œé‚£æ„Ÿè§‰ä¹ŸæŒºå¥½çš„...ğŸ˜‚ğŸ˜‚ğŸ˜‚

*   Reactç‰ˆæœ¬
    *   github: [https://github.com/hiisea/elux-react-antd-admin](https://github.com/hiisea/elux-react-antd-admin)
    *   gitee: [https://gitee.com/hiisea/elux-react-antd-admin-fork](https://gitee.com/hiisea/elux-react-antd-admin-fork)
*   Vueç‰ˆæœ¬
    *   github: [https://github.com/hiisea/elux-vue-antd-admin](https://github.com/hiisea/elux-vue-antd-admin)
    *   gitee: [https://gitee.com/hiisea/elux-vue-antd-admin-fork](https://gitee.com/hiisea/elux-vue-antd-admin-fork)