---
layout: post
title: "Selenium4.0+Python3ç³»åˆ—ï¼ˆå››ï¼‰ - å¸¸è§å…ƒç´ æ“ä½œï¼ˆå«é¼ æ ‡é”®ç›˜äº‹ä»¶ï¼‰"
date: "2022-10-25T16:41:38.969Z"
---
Selenium4.0+Python3ç³»åˆ—ï¼ˆå››ï¼‰ - å¸¸è§å…ƒç´ æ“ä½œï¼ˆå«é¼ æ ‡é”®ç›˜äº‹ä»¶ï¼‰
==========================================

ä¸€ã€å†™åœ¨å‰é¢
------

ä¸Šç¯‡æ–‡ç« ä»‹ç»çš„æ˜¯å…³äºæµè§ˆå™¨çš„å¸¸è§æ“ä½œï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­åˆ†äº«å…³äºå…ƒç´ çš„å¸¸è§æ“ä½œï¼Œå»ºè®®**æ”¶è—ã€è½¬å‘ï¼**

äºŒã€å…ƒç´ çš„çŠ¶æ€
-------

åœ¨æ“ä½œå…ƒç´ ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å…ƒç´ çš„å¸¸è§çŠ¶æ€ã€‚

### 1ã€å¸¸è§å…ƒç´ çŠ¶æ€åˆ¤æ–­ï¼Œå‚»å‚»åˆ†ä¸æ¸…

*   `is_displayed()`
*   `is_enabled()`
*   `is_selected()`

### 2ã€is\_displayed()

åˆ¤æ–­å…ƒç´ æ˜¯å¦æ˜¾ç¤º

    element.is_displayed()
    

**æ³¨æ„ï¼š**

åˆ¤æ–­`button`æ˜¯å¦æ˜¾ç¤ºï¼Œå’Œ`is_displayed()`å®¹æ˜“æ··æ·†çš„æ˜¯`is_enabled()`ã€‚

åŒºåˆ«åœ¨äºï¼Œç›´æ¥ç”¨`element.is_enabled()`æ–¹æ³•åˆ¤æ–­`button`æ˜¯å¦æ˜¾ç¤ºï¼Œè¿”å›å€¼ä¸º`true`ï¼Œå› ä¸º`button`æ˜¯ä½¿ç”¨`CSS`æ–¹æ³•åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆï¼Œè¿™å¹¶ä¸æ˜¯çœŸæ­£çš„æ–¹æ³•ï¼Œéœ€è¦åˆ¤æ–­å…¶`class`ä¸­æ˜¯å¦æœ‰å€¼ä¸º`disabled`æ¥åˆ¤æ–­æ˜¯å¦çœŸæ­£å¤„äº`disabled`çš„çŠ¶æ€.

### 3ã€is\_enabled()

åˆ¤æ–­å…ƒç´ æ˜¯å¦æœ‰æ•ˆï¼Œå³æ˜¯å¦ä¸ºç°åŒ–çŠ¶æ€

    element.is_enabled()  
    

### 4ã€is\_selected()

ä¸€èˆ¬åˆ¤æ–­è¡¨å•å…ƒç´ ï¼Œå¦‚radioæˆ–checkboxæ˜¯å¦è¢«é€‰ä¸­ã€‚

    element.is_selected() 
    

ä¸‰ã€å¸¸è§å…ƒç´ çš„æ“ä½œ
---------

è¿™éƒ¨åˆ†ä¸»è¦æ¼”ç¤ºçš„å¸¸è§ç‚¹å‡»æ“ä½œï¼Œä¾‹å¦‚ï¼šæ–‡æœ¬è¾“å…¥ã€å¤é€‰æ¡†ã€å•é€‰æŒ‰é’®ã€é€‰æ‹©é€‰é¡¹ã€é¼ æ ‡ç‚¹å‡»äº‹ä»¶ç­‰ç­‰ã€‚

### 1ã€å…ƒç´ ç‚¹å‡»æ“ä½œ

**æ¼”ç¤ºæ¡ˆä¾‹ï¼š**

![](https://img2022.cnblogs.com/blog/718867/202210/718867-20221025200840512-25077284.png)

**ç‚¹å‡»ï¼ˆé¼ æ ‡å·¦é”®ï¼‰é¡µé¢æŒ‰é’®**ï¼š`click()`

**ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š**

    driver.get("http://localhost:8080/click.html")
    button1 = driver.find_element(By.ID, "button1")
    is_displayed = button1.is_enabled()
    if is_displayed:
        button1.click()
    

### 2ã€Submitæ“ä½œ

**æ¼”ç¤ºæ¡ˆä¾‹ï¼š**

![](https://img2022.cnblogs.com/blog/718867/202210/718867-20221025201017955-127333561.png)

**ç‚¹å‡»ï¼ˆé¼ æ ‡å·¦é”®ï¼‰é¡µé¢æŒ‰é’®**ï¼š`submit()`

**ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š**

    driver.get("http://localhost:8080/submit.html")
    login = driver.find_element(By.ID, "login")
    is_displayed = login.is_enabled()
    if is_displayed:
        login.submit()
        # login.click()
    

**å°è´´å£«ï¼š**

æ”¯æŒ`submit`çš„è‚¯å®šæ”¯æŒ`click`,ä½†æ˜¯æ”¯æŒ`click`çš„ï¼Œä¸ä¸€å®šæ”¯æŒ`submit`ï¼Œå¯èƒ½ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š

### 3ã€è¾“å…¥ã€æ¸…ç©ºè¾“å…¥æ“ä½œ

**æ¼”ç¤ºæ¡ˆä¾‹ï¼š**

![](https://img2022.cnblogs.com/blog/718867/202210/718867-20221025201118558-718204950.png)

**è¾“å…¥ã€æ¸…ç©ºè¾“å…¥æ“ä½œ**ï¼š`clear(), send_keys()`

**ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š**

    username = driver.find_element(By.CSS_SELECTOR, "input[type='text']")
    username.clear()
    username.send_keys(u"å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›")
    # è¾“å‡º:å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›
    print('è¾“å…¥å€¼ï¼š{0}'.format(username.get_attribute("value")))
    time.sleep(1)
    

å››ã€é¼ æ ‡é”®ç›˜äº‹ä»¶æ“ä½œ
----------

### 1ã€æ¨¡æ‹Ÿå›è½¦æ“ä½œ

æ¨¡æ‹Ÿæ‰“å¼€ç™¾åº¦æœç´¢è¾“å…¥åšå®¢å›­ï¼Œå›è½¦æ“ä½œï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    driver.get("https://www.baidu.com/")
    driver.find_element(By.ID, "kw").send_keys("ä¹…æ›²å¥ åšå®¢å›­", Keys.ENTER)
    

### 2ã€å¸¸è§é¼ æ ‡æ“ä½œ

**æ¼”ç¤ºæ¡ˆä¾‹ï¼š**

![](https://img2022.cnblogs.com/blog/718867/202210/718867-20221025201242949-1716208780.png)

å¸¸è§é¼ æ ‡æ“ä½œå¾ˆå¤šï¼Œå¦‚å·¦é”®ç‚¹å‡»ã€æ‚¬æµ®ã€ç§»åŠ¨ã€åŒå‡»ã€å³é”®ç­‰ç­‰ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    driver.get("http://localhost:8080/mouse.html")
    # é¼ æ ‡å·¦é”®ç‚¹å‡»
    ActionChains(driver).click(driver.find_element(By.ID, "mouse2")).perform()
    time.sleep(1)
    driver.switch_to.alert.accept()
    time.sleep(1)
    # é¼ æ ‡æ‚¬æµ®å¹¶ç§»åŠ¨æ“ä½œ
    ActionChains(driver).move_to_element(driver.find_element(By.ID, "mouse1")).pause(1).move_to_element(
        driver.find_element(By.ID, "mouse6")).perform()
    time.sleep(1)
    driver.switch_to.alert.accept()
    # é¼ æ ‡åŒå‡»æ“ä½œ
    ActionChains(driver).double_click(driver.find_element(By.ID, "mouse3")).perform()
    time.sleep(1)
    driver.switch_to.alert.accept()
    # é¼ æ ‡å³é”®
    ActionChains(driver).context_click(driver.find_element(By.ID, "mouse5")).perform()
    

### 3ã€å¸¸è§çš„é”®ç›˜æ“ä½œ

é”®ç›˜æ“ä½œ

å¯¹åº”ä»£ç 

é”®ç›˜F1åˆ°F12

send\_keys(Keys.F1) æŠŠF1æ”¹æˆå¯¹åº”çš„å¿«æ·é”®

å¤åˆ¶Ctrl+C

send\_keys(Keys.CONTROL,'c')

ç²˜è´´Ctrl+V

send\_keys(Keys.CONTROL,'v')

å…¨é€‰Ctrl+A

send\_keys(Keys.CONTROL,'a')

å‰ªåˆ‡Ctrl+X

send\_keys(Keys.CONTROL,'x')

åˆ¶è¡¨é”®Tab

send\_keys(Keys.TAB)

äº”ã€æ¼”ç¤ºæ¡ˆä¾‹æºç 
--------

**ç¤ºä¾‹ä»£ç ï¼š**

    # -*- coding: utf-8 -*-
    """
    @Time ï¼š 2022/10/25 21:39
    @Auth ï¼š è½¯ä»¶æµ‹è¯•å›
    @File ï¼šelement_actions.py
    @IDE ï¼šPyCharm
    @Mottoï¼šABC(Always Be Coding)
    
    """
    import time
    
    from selenium.webdriver import Keys, ActionChains
    from selenium.webdriver.common.by import By
    from selenium import webdriver
    from selenium.webdriver.chrome.service import Service
    from webdriver_manager.chrome import ChromeDriverManager
    
    '''
    åˆå§‹åŒ–æ“ä½œ
    '''
    driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))
    
    
    def init():
        # æœ€å¤§åŒ–æ“ä½œ
        driver.maximize_window()
        driver.set_script_timeout(60)
        # æ™ºèƒ½ç­‰å¾…æ‰¾åˆ°å…ƒç´ åç«‹å³ç»§ç»­æ‰§è¡Œï¼Œå…¨å±€ç”Ÿæ•ˆ
        driver.implicitly_wait(60)
        driver.set_page_load_timeout(60)
    
    
    init()
    
    '''
    å…ƒç´ ç‚¹å‡»æ“ä½œ
    '''
    
    
    def clickDemo():
        # ç‚¹å‡»ï¼ˆé¼ æ ‡å·¦é”®ï¼‰é¡µé¢æŒ‰é’®ï¼šclick()
        driver.get("http://localhost:8080/click.html")
        button1 = driver.find_element(By.ID, "button1")
        is_displayed = button1.is_enabled()
        if is_displayed:
            button1.click()
    
        # å…³é—­å¼¹çª—
        driver.switch_to.alert.accept()
    
    
    ### å…ƒç´ åŸºæœ¬æ“ä½œ
    clickDemo()
    time.sleep(1)
    
    '''
    submitæ“ä½œ
    '''
    
    
    def submitDemo():
        # ç‚¹å‡»ï¼ˆé¼ æ ‡å·¦é”®ï¼‰é¡µé¢æŒ‰é’®ï¼šsubmit()
        driver.get("http://localhost:8080/submit.html")
        login = driver.find_element(By.ID, "login")
        is_displayed = login.is_enabled()
        if is_displayed:
            login.submit()
            # login.click()
        # å°è´´å£«ï¼šæ”¯æŒsubmitçš„è‚¯å®šæ”¯æŒclick,ä½†æ˜¯æ”¯æŒclickçš„ï¼Œä¸ä¸€å®šæ”¯æŒsubmitï¼Œå¯èƒ½ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š
    
    
    submitDemo()
    
    '''
    è¾“å…¥ã€æ¸…ç©ºè¾“å…¥æ“ä½œ
    '''
    
    
    def clearInputDemo():
        # è¾“å…¥ã€æ¸…ç©ºè¾“å…¥æ“ä½œï¼šclear() send_keys()
        username = driver.find_element(By.CSS_SELECTOR, "input[type='text']")
        username.clear()
        username.send_keys(u"å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›")
        # è¾“å‡º:å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›
        print('è¾“å…¥å€¼ï¼š{0}'.format(username.get_attribute("value")))
        time.sleep(1)
    
    
    clearInputDemo()
    
    '''
    æ¨¡æ‹Ÿæ‰“å¼€ç™¾åº¦æœç´¢è¾“å…¥åšå®¢å›­ï¼Œå›è½¦æ“ä½œ
    '''
    
    
    def mockEnterDemo():
        # æ¨¡æ‹Ÿæ‰“å¼€ç™¾åº¦æœç´¢è¾“å…¥åšå®¢å›­ï¼Œå›è½¦æ“ä½œ ç¤ºä¾‹ä»£ç 
        driver.get("https://www.baidu.com/")
        driver.find_element(By.ID, "kw").send_keys("ä¹…æ›²å¥ åšå®¢å›­", Keys.ENTER)
    
    
    ### é”®ç›˜æ“ä½œ
    mockEnterDemo()
    def mouseDemo():
        driver.get("http://localhost:8080/mouse.html")
        # é¼ æ ‡å·¦é”®ç‚¹å‡»
        ActionChains(driver).click(driver.find_element(By.ID, "mouse2")).perform()
        time.sleep(1)
        driver.switch_to.alert.accept()
        time.sleep(1)
        # é¼ æ ‡æ‚¬æµ®å¹¶ç§»åŠ¨æ“ä½œ
        ActionChains(driver).move_to_element(driver.find_element(By.ID, "mouse1")).pause(1).move_to_element(
            driver.find_element(By.ID, "mouse6")).perform()
        time.sleep(1)
        driver.switch_to.alert.accept()
        # é¼ æ ‡åŒå‡»æ“ä½œ
        ActionChains(driver).double_click(driver.find_element(By.ID, "mouse3")).perform()
        time.sleep(1)
        driver.switch_to.alert.accept()
        # é¼ æ ‡å³é”®
        ActionChains(driver).context_click(driver.find_element(By.ID, "mouse5")).perform()
    
    
    ###  å¸¸è§é”®ç›˜äº‹ä»¶æ“ä½œ
    mouseDemo()
    
    time.sleep(3)
    driver.quit()
    

å…­ã€æœ€å
----

åˆ°æ­¤ï¼Œå¸¸è§å…ƒç´ æ“ä½œæ¼”ç¤ºç»“æŸï¼Œè¿™é‡Œåªæ˜¯åˆ—ä¸¾äº†ä¸€äº›å¸¸ç”¨çš„æ“ä½œï¼Œå…³äºå…¶ä»–æ“ä½œï¼Œæ„Ÿå…´è¶£çš„åŒå­¦è¯·å·¦é”®æŸ¥çœ‹æºä»£ç  ï¼

æˆ‘æ˜¯å…­å“¥ï¼Œå¦‚æœè§‰å¾—æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå»ºè®®æ”¶è—ã€è½¬å‘ï¼

è¯·ç»§ç»­å…³æ³¨æˆ‘ï¼Œæˆ‘çš„å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›ï¼Œå¹¶å¸®å¿™è½¬å‘æ–‡ç« åˆ°æœ‹å‹åœˆã€‚

ä½ çš„æ¯ä¸€æ¬¡è½¬å‘ï¼Œæˆ‘éƒ½å½“åšäº†å–œæ¬¢ï¼ğŸ™

**ä¼˜ç§€ä¸å¤Ÿï¼Œä½ æ˜¯å¦æ— å¯æ›¿ä»£**

**è½¯ä»¶æµ‹è¯•äº¤æµQQç¾¤ï¼š721256703ï¼ŒæœŸå¾…ä½ çš„åŠ å…¥ï¼ï¼**

**æ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼šè½¯ä»¶æµ‹è¯•å›**

![](https://www.cnblogs.com/images/cnblogs_com/longronglang/1061549/o_QQ%E6%88%AA%E5%9B%BE20190728134401.jpg)