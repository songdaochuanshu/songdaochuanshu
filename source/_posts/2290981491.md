---
layout: post
title: "组合数学笔记-特殊计数数列"
date: "2023-03-02T01:19:12.185Z"
---
组合数学笔记-特殊计数数列
=============

目录

*   [特殊计数数列](#特殊计数数列)
    *   [斐波那契数列](#斐波那契数列)
        *   [斐波那契数列的定义与基本性质](#斐波那契数列的定义与基本性质)
    *   [卡特兰数](#卡特兰数)
        *   [卡特兰数的定义与基本性质](#卡特兰数的定义与基本性质)
        *   [卡特兰数的应用](#卡特兰数的应用)
            *   [满足通项关系的情况](#满足通项关系的情况)
            *   [满足递推关系的情况](#满足递推关系的情况)
    *   [斯特林数](#斯特林数)
    *   [贝尔数](#贝尔数)
    *   [分拆数](#分拆数)
    *   [伯努利数](#伯努利数)

特殊计数数列
======

斐波那契数列
------

### 斐波那契数列的定义与基本性质

**历史背景** 斐波那契数列（Fibonacci sequence），又称黄金分割数列，因数学家莱昂纳多·斐波那契（Leonardo Fibonacci）以兔子繁殖为例子而引入，故又称为“兔子数列”。

**定义** 斐波那契数列 \\(F\_n\\) 有递推定义

\\\[F\_n = \\left\\{ \\begin{array}{l} 0 &,n = 0\\\\ 1 &,n = 1\\\\ F\_{n-1}+F\_{n-2} &,n \\geq 2 \\end{array} \\right . \\\]

**列举参照**

\\\[\\begin{array}{l} &0, &1, &1, &2, &3, \\\\ &5, &8, &13,&21, &34, \\\\ &55, &89, &144, &233, &377, \\\\ &610, &987, &1597, &2584, &4181, \\\\ &6765, &10946, &17711, &28657, &46368, \\\\ &75025, &121393, &196418, &317811, &514229, \\\\ &832040, &1346269, &2178309, &3524578, &5702887, \\\\ &9227465, &14930352, &24157817, &39088169, &63245986, \\\\ &102334155, &\\cdots \\end{array} \\\]

**性质1** \\(\\displaystyle \\sum\_{i=1}^n F\_i = F\_{n+2} -1\\) 。

**性质2** \\(\\displaystyle \\sum\_{i=1}^n F\_{2i-1} = F\_{2n}\\) 。

**性质3** \\(\\displaystyle\\sum\_{i=1}^n F\_{2i} = F\_{2n+1}-1\\) 。

**性质4** \\(\\displaystyle \\sum\_{i=1}^n F\_{i}^2 = F\_{n}F\_{n+1}\\) 。

**性质5** \\(\\displaystyle F\_{n+m} = F\_{n-1}F\_{m-1}+F\_nF\_m\\) 。

**性质6** \\(F\_n^2 = (-1)^{n-1} + F\_{n-1}F\_{n+1}\\) 。

**性质7** \\(F\_{2n-1} = F\_n^2 - F\_{n-2}^2\\) 。

**性质8** \\(F\_n = \\dfrac{F\_{n-2}+F\_{n+2}}{3}\\) 。

**性质9** \\(\\lim\\limits\_{n\\to\\infty} \\dfrac{F\_{n+1}}{F\_n} = \\dfrac{\\sqrt{5}-1}{2}\\) 。

**性质10** \\(F\_n = \\dfrac{\\left(\\dfrac{1+\\sqrt5}{2} \\right)^n - \\left(\\dfrac{1-\\sqrt5}{2} \\right)^n}{\\sqrt 5}\\) 。

卡特兰数
----

### 卡特兰数的定义与基本性质

**历史背景** 卡特兰数（Catalan number），又称卡塔兰数、明安图数，是组合数学中一种常出现于各种计数问题中的数列。以比利时的数学家欧仁·查理·卡特兰的名字来命名。1730年左右被蒙古族数学家明安图使用于对三角函数幂级数的推导而首次发现，1774年被发表在《割圜密率捷法》。

**定义** 卡特兰数 \\(H\_n\\) 有递推定义

\\\[H\_n = \\begin{cases} 1 &, n = 0 \\text{ or } 1\\\\ \\displaystyle \\sum\_{i=0}^{n-1} H\_iH\_{n-i-1} &, n \\geq 2 \\\\ \\end{cases} \\\]

**列举参照**

\\\[\\begin{array}{l} &1, &1, &2, &5, &14, \\\\ &42, &132, &429, &1430, &4862, \\\\ &16796, &58786, &208012, &742900, &2674440, \\\\ &9694845, &35357670, &129644790, &477638700, &1767263190, \\\\ &6564120420, &\\cdots \\end{array} \\\]

**性质1** \\(H\_n = \\dfrac{1}{n+1} \\dbinom{2n}{n}\\) 。

**性质2** \\(H\_n = \\dbinom{2n}{n} - \\dbinom{2n}{n-1}\\) 。

**性质3** \\(H\_n = \\dfrac{4n-2}{n+1}H\_{n-1}\\) 。

> 性质1的证明：
> 
> 我们设卡特兰数的生成函数为 \\(\\displaystyle G(x) = \\sum\_{i=0}^\\infty H\_ix^i\\) ，可得
> 
> \\\[\\begin{aligned} G^2(x) &= H\_0^2 + (H\_0H\_1+H\_1H\_0)x + (H\_0H\_2 + H\_1^2 + H\_2H\_0)x^2 + \\cdots \\\\ &= H\_1 + H\_2x + H\_3x^2 + \\cdots \\\\ \\end{aligned} \\\]
> 
> 于是有 \\(xG^2(x) - G(x) + 1 = 0\\) ，解得 \\(G(x) = \\dfrac{1-\\sqrt{1-4x}}{2x}\\) 并且 \\(G(0) = 1,\\lim\_\\limits{x\\to 0} G(x) = 1\\) 。
> 
> 我们对 \\(G(x)\\) 在 \\(x = 0\\) 处泰勒展开 \\(\\displaystyle (1+x)^\\alpha = \\sum\_{i=0}^\\infty \\binom{\\alpha}{i}x^i\\) ，有
> 
> \\\[\\begin{aligned} G(x) &= \\frac{1}{2x} \\sum\_{i=1}^\\infty (-1)\\binom{1/2}{i}(-4x)^i \\\\ &= \\frac{1}{2x} \\sum\_{i=1}^\\infty (-1)\\frac{(1/2)(1/2-1)\\cdots(1/2-i+1)}{i!} (-4x)^i \\\\ &= \\frac{1}{2x} \\left( 1+\\sum\_{i=2}^\\infty \\frac{(2i-3)!!}{i!} (2x)^i \\right) \\\\ &= \\frac{1}{2x} \\left( 1+\\sum\_{i=2}^\\infty \\frac{(2i-2)!}{i! \\cdot 2 \\cdots (2i-2)} (2x)^i \\right) \\\\ &= \\frac{1}{2x} \\sum\_{i=1}^\\infty \\frac{(2i-2)!}{i! \\cdot (i-1)!} x^i \\\\ &= \\frac{1}{2x} \\sum\_{i=0}^\\infty \\frac{(2i)!}{(i+1)! \\cdot i!} x^{i+1} \\\\ &= \\sum\_{i=0}^\\infty \\frac{1}{i+1} \\frac{(2i)!}{i! \\cdot i!} x^{i} \\\\ &= \\sum\_{i=0}^\\infty \\frac{1}{i+1} \\binom{2i}{i} x^{i} \\\\ \\end{aligned} \\\]
> 
> 综上，根据 \\(G(x)\\) 的 \\(x^n\\) 系数可得 \\(H\_n = \\dfrac{1}{n+1} \\dbinom{2n}{n}\\) 。

> 性质2的证明：
> 
> 由性质1可得，\\(H\_n = \\dfrac{1}{n+1} \\dbinom{2n}{n} = \\dbinom{2n}{n} - \\dfrac{n}{n+1} \\dbinom{2n}{n} = \\dbinom{2n}{n} - \\dbinom{2n}{n-1}\\) 。

> 性质3的证明：
> 
> 由性质1可得， \\(H\_n = \\dfrac{1}{n+1} \\dbinom{2n}{n} = \\dfrac{1}{n+1} \\dfrac{(2n)!}{n!n!} = \\dfrac{4n-2}{n+1} \\dfrac{1}{n} \\dfrac{(2n-2)!}{(n-1)!(n-1)!} = \\dfrac{4n-2}{n+1} H\_{n-1}\\) 。

### 卡特兰数的应用

这里只列举了几个经典的情况，还有许多就不一一列举了，解释都是大同的。

这些问题的共同点就是，有具有前缀限制的两种操作，或可以划分为多个子问题的和。

#### 满足通项关系的情况

1.  网格图路径
    
    在 \\(n \\times n\\) 的网格图中，从 \\((0,0)\\) 走到 \\((n,n)\\) ，满足每次可以向上或向右走一格，且任意时刻向右次数不少于向上次数的路径方案数。
    
    > 方法：
    > 
    > 限制可理解为不能越过（可以碰到）直线 \\(y=x\\) 的方案数。
    > 
    > 不考虑 \\(y=x\\) 的限制，共有 \\(\\dbinom{2n}{n}\\) 种方案。
    > 
    > 考虑不合法的方案，即越过 \\(y=x\\) 的方案，等价于碰到 \\(y = x+1\\) 的方案。每个不合法的方案，找到其碰到 \\(y = x+1\\) 的第一个交点，将此之后的路径沿 \\(y=x+1\\) 对称翻折，会得到唯一对应的一条 \\((0,0)\\) 到 \\((n-1,n+1)\\) 的路径。同时对于 \\((0,0)\\) 到 \\((n-1,n+1)\\) 的每条路径，也可以找到第一个与 \\(y=x+1\\) 的交点，将此之后的路径沿 \\(y=x+1\\) 对称翻折，也会得到唯一对应的一条 \\((0,0)\\) 到 \\((n,n)\\) 的不合法的路径。
    > 
    > 综上， \\((0,0)\\) 到 \\((n,n)\\) 的不合法路径和 \\((0,0)\\) 到 \\((n-1,n+1)\\) 的路径是一一对应的，因此 \\((0,0)\\) 到 \\((n,n)\\) 的合法路径方案数为 \\(H\_n = \\dbinom{2n}{n} - \\dbinom{2n}{n-1}\\) 。
    > 
    > 当 \\(y = x + k\\) 时，可以同样分析。
    
2.  括号匹配
    
    有 \\(n\\) 个左括号和 \\(n\\) 个右括号，求长度为 \\(2n\\) 的合法括号序列个数。
    
    > 方法：
    > 
    > 限制是任意前缀序列中，左括号个数不少于右括号个数。
    > 
    > 可以同网格图路径中的方法类似，翻折操作变成左右括号互换。
    
3.  不相交弦问题
    
    一个圆周上有 \\(2n\\) 个点，两两配对并在两点间连一条弦，要求所连的 \\(n\\) 条弦没有交点，求有多少种配对数。
    
    > 方法：
    > 
    > 我们规定逆时针方向为正，从其中一个点开始，限制是任意前缀序列中，左端点个数不少于右端点个数。
    > 
    > 可以同网格图路径中的方法类似，翻折操作变成左右端点互换。
    
4.  出栈序列
    
    一个栈（无穷大）的进栈序列为 \\(1,2,\\cdots ,n\\) 有多少个不同的出栈序列？
    
    > 方法：
    > 
    > 同括号匹配。
    

#### 满足递推关系的情况

1.  阶梯矩形的矩形划分数
    
    求 \\(n\\) 层矩形阶梯分为 \\(n\\) 个矩形的方案数。
    
2.  凸多边形的三角划分
    
    一个凸的 \\(n+2\\) 边形，用 \\(n-1\\) 条直线连接它的两个顶点使之分成 \\(n\\) 个三角形，每条直线不能相交，求划分方案数。
    
3.  二叉树计数
    
    二叉树有 \\(n\\) 个节点，求不同的二叉树的个数。
    

斯特林数
----

贝尔数
---

分拆数
---

伯努利数
----

本文来自博客园，作者：[空白菌](https://www.cnblogs.com/BlankYang/)，转载请注明原文链接：[https://www.cnblogs.com/BlankYang/p/17170201.html](https://www.cnblogs.com/BlankYang/p/17170201.html)