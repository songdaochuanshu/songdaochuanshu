---
layout: post
title: "nmapè„šæœ¬è¯¦è§£"
date: "2023-01-14T21:13:08.307Z"
---
nmapè„šæœ¬è¯¦è§£
========

> nmap --script

å‰è¨€
--

æˆ‘ä»¬é€šè¿‡`nmap script`æ¥å¤§å¹…æ‰©å±•nmapçš„åŠŸèƒ½ï¼Œnmapå…·æœ‰å¼ºå¤§çš„è„šæœ¬å¼•æ“NSEï¼ˆNmap Scripting Engineï¼‰ï¼Œå®ƒå…è®¸ç”¨æˆ·ç¼–å†™ï¼ˆå’Œå…±äº«ï¼‰ç®€å•çš„è„šæœ¬ï¼ˆä½¿ç”¨luaç¼–ç¨‹è¯­è¨€ï¼‰è‡ªåŠ¨åŒ–å„ç§ç½‘ç»œä»»åŠ¡

å®˜æ–¹æ–‡æ¡£

[NSEDoc Reference Portal â€” Nmap Scripting Engine documentation](https://nmap.org/nsedoc/)

![](https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20230114222548.png)

ç›®å‰nmapå®˜æ–¹æœ‰604ä¸ªNSEè„šæœ¬ï¼Œå®‰è£…nmapåå­˜å‚¨åœ¨scriptæ–‡ä»¶å¤¹ä¸‹ï¼Œè¿™äº›éƒ½æ˜¯Nmapç‰¹æœ‰çš„ï¼Œæ˜¯åŸºäºluaè¯­è¨€ç¼–å†™çš„

### nmapè„šæœ¬åˆ†ç±»

nmapè„šæœ¬ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼Œåœ¨æ‰«ææ—¶å¯æ ¹æ®éœ€è¦è®¾ç½®--script=ç±»åˆ«è¿™ç§æ–¹å¼è¿›è¡Œæ¯”è¾ƒç¬¼ç»Ÿçš„æ‰«æï¼š

    auth: è´Ÿè´£å¤„ç†é‰´æƒè¯ä¹¦ï¼ˆç»•å¼€é‰´æƒï¼‰çš„è„šæœ¬  
    broadcast: åœ¨å±€åŸŸç½‘å†…æ¢æŸ¥æ›´å¤šæœåŠ¡å¼€å¯çŠ¶å†µï¼Œå¦‚dhcp/dns/sqlserverç­‰æœåŠ¡  
    brute: æä¾›æš´åŠ›ç ´è§£æ–¹å¼ï¼Œé’ˆå¯¹å¸¸è§çš„åº”ç”¨å¦‚http/snmpç­‰  
    default: ä½¿ç”¨-sCæˆ–-Aé€‰é¡¹æ‰«ææ—¶å€™é»˜è®¤çš„è„šæœ¬ï¼Œæä¾›åŸºæœ¬è„šæœ¬æ‰«æèƒ½åŠ›  
    discovery: å¯¹ç½‘ç»œè¿›è¡Œæ›´å¤šçš„ä¿¡æ¯ï¼Œå¦‚SMBæšä¸¾ã€SNMPæŸ¥è¯¢ç­‰  
    dos: ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»  
    exploit: åˆ©ç”¨å·²çŸ¥çš„æ¼æ´å…¥ä¾µç³»ç»Ÿ  
    external: åˆ©ç”¨ç¬¬ä¸‰æ–¹çš„æ•°æ®åº“æˆ–èµ„æºï¼Œä¾‹å¦‚è¿›è¡Œwhoisè§£æ  
    fuzzer: æ¨¡ç³Šæµ‹è¯•çš„è„šæœ¬ï¼Œå‘é€å¼‚å¸¸çš„åŒ…åˆ°ç›®æ ‡æœºï¼Œæ¢æµ‹å‡ºæ½œåœ¨æ¼æ´ intrusive: å…¥ä¾µæ€§çš„è„šæœ¬ï¼Œæ­¤ç±»è„šæœ¬å¯èƒ½å¼•å‘å¯¹æ–¹çš„IDS/IPSçš„è®°å½•æˆ–å±è”½  
    malware: æ¢æµ‹ç›®æ ‡æœºæ˜¯å¦æ„ŸæŸ“äº†ç—…æ¯’ã€å¼€å¯äº†åé—¨ç­‰ä¿¡æ¯  
    safe: æ­¤ç±»ä¸intrusiveç›¸åï¼Œå±äºå®‰å…¨æ€§è„šæœ¬  
    version: è´Ÿè´£å¢å¼ºæœåŠ¡ä¸ç‰ˆæœ¬æ‰«æï¼ˆVersion Detectionï¼‰åŠŸèƒ½çš„è„šæœ¬  
    vuln: è´Ÿè´£æ£€æŸ¥ç›®æ ‡æœºæ˜¯å¦æœ‰å¸¸è§çš„æ¼æ´ï¼ˆVulnerabilityï¼‰ï¼Œå¦‚æ˜¯å¦æœ‰MS08_067
    

ä½¿ç”¨æ–¹å¼
----

*   æŒ‡å®šè¿è¡Œè„šæœ¬

å½“æˆ‘ä»¬ä½¿ç”¨Nmapå¹¶æ·»åŠ å‚æ•°`-sC`æˆ–è€…`--script`æ—¶ï¼ŒNmapä¼šæ‰§è¡ŒNSEè„šæœ¬

ä¾‹å¦‚ï¼Œåœ¨scriptç›®å½•ä¸‹æœ‰`http-title.nse`ã€`http-trace.nse`è„šæœ¬ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

    nmap --script http-title scanme.nmap.org
    

*   ä¼ é€’å‚æ•°

    --script-args=key1=value1,key2=value2... 
    

*   ä»æ–‡ä»¶ä¸­è¯»å–å‚æ•°

    â€“script-args-file=filename
    

*   æ˜¾ç¤ºå…¨éƒ¨å‘é€å’Œæ”¶åˆ°çš„æ•°æ®

    --script-trace
    

*   æ›´æ–°æ•°æ®åº“

åœ¨Nmapçš„scriptsç›®å½•é‡Œæœ‰ä¸€ä¸ª`script.db`ï¼Œè¯¥æ–‡ä»¶ä¸­ä¿å­˜äº†å½“å‰Nmapå¯ç”¨çš„è„šæœ¬ï¼Œç±»ä¼¼äºä¸€ä¸ªå°å‹æ•°æ®åº“ï¼Œå¦‚æœæˆ‘ä»¬å¼€å¯nmapå¹¶ä¸”è°ƒç”¨äº†æ­¤å‚æ•°ï¼Œåˆ™nmapä¼šè‡ªè¡Œæ‰«æscriptsç›®å½•ä¸­çš„æ‰©å±•è„šæœ¬ï¼Œè¿›è¡Œæ•°æ®åº“æ›´æ–°

    --script-updatedb
    

*   è„šæœ¬å¸®åŠ©

æŒ‡å®šå¯¹åº”çš„è„šæœ¬ä¿¡æ¯ï¼ŒNmapä¼šè¾“å‡ºè¯¥è„šæœ¬åç§°å¯¹åº”çš„è„šæœ¬ä½¿ç”¨å‚æ•°ï¼Œä»¥åŠè¯¦ç»†ä»‹ç»ä¿¡æ¯ã€‚

    --script-help=è„šæœ¬åç§°
    

nmapè„šæœ¬ç®€ä»‹
--------

ä¸€ä¸ªNSEè„šæœ¬çš„ä¹¦å†™ä¸€èˆ¬åˆ†ä¸ºå››æ­¥ï¼š

*   å¯¼å…¥è„šæœ¬ç¼–å†™æ‰€éœ€åº“
*   ç¼–å†™è„šæœ¬æè¿°ä¿¡æ¯
*   ç¡®å®šRuleç±»å‹
*   ç¼–å†™Action

Nmap nseè„šæœ¬æ¨¡æ¿ç»“æ„å›¾

![](https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20230114222617.png)

å…¶ä¸­Ruleå­˜åœ¨å››ç§ç±»å‹ï¼š

*   Prerule åœ¨Nmapæ²¡æœ‰æ‰«æä¹‹å‰è¿›è¡Œè§¦å‘
*   Hostrule åœ¨Nmapæ‰§è¡Œä¸»æœºå‘ç°æˆ–æ¢æµ‹æ—¶è¿›è¡Œè§¦å‘
*   Protrule åœ¨Nmapæ‰§è¡Œç«¯å£æ‰«æçš„æ—¶å€™è§¦å‘
*   Postrule åœ¨Nmapç»“æŸçš„æ—¶å€™è§¦å‘è„šæœ¬ï¼Œé€šå¸¸ç”¨äºæ‰«æç»“æœçš„æ•°æ®æå–å’Œæ•´ç†

ç”¨äºæè¿°è„šæœ¬çš„è§¦å‘è§„åˆ™ï¼Œè¿”å›å€¼åªæœ‰trueå’Œfalseä¸¤ç§ã€‚è¿”å›å€¼å†³å®šäº†åé¢çš„actionå¯¹åº”çš„å‡½æ•°æ˜¯å¦æ‰§è¡Œ

*   true - æ‰§è¡Œ
*   false - ä¸æ‰§è¡Œ

åœ¨æˆ‘çœ‹æ¥

Ruleæè¿°è„šæœ¬çš„è§¦å‘è§„åˆ™ï¼Œå®šä¹‰äº†è„šæœ¬åœ¨nmapç”Ÿå‘½å‘¨æœŸçš„å•¥æ—¶å€™æ¥æ‰§è¡Œ

æˆ‘ä»¬é€‰æ‹© `http-php-version.nse`è„šæœ¬æ¥è·Ÿè¿›åˆ†æä¸€ä¸‹ï¼Œè¿™ä¸ªè„šæœ¬çš„ä¸»è¦ä½œç”¨æ˜¯æ£€æµ‹PHPæœåŠ¡å™¨çš„ç‰ˆæœ¬

æŸ¥çœ‹APIæ‰‹å†Œ [https://nmap.org/nsedoc/lib/](https://nmap.org/nsedoc/lib/) æ¥å¯¼å…¥ä½ è¦å¯¼å…¥çš„luaè„šæœ¬ - nmapå†…ç½®æ¨¡å—

    local http = require "http"
    local nmap = require "nmap"
    local shortport = require "shortport"
    local stdnse = require "stdnse"
    local string = require "string"
    local table = require "table"
    
    local openssl = stdnse.silent_require "openssl"
    

`description`å¯¹è„šæœ¬è¿›è¡Œæ¦‚è¿°

    description = [[
    Attempts to retrieve the PHP version from a web server. PHP has a number
    of magic queries that return images or text that can vary with the PHP
    version. This script uses the following queries:
    * <code>/?=PHPE9568F36-D428-11d2-A769-00AA001ACF42</code>: gets a GIF logo, which changes on April Fool's Day.
    * <code>/?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000</code>: gets an HTML credits page.
    
    A list of magic queries is at http://www.0php.com/php_easter_egg.php.
    The script also checks if any header field value starts with
    <code>"PHP"</code> and reports that value if found.
    
    PHP versions after 5.5.0 do not respond to these queries.
    
    Link:
    * http://phpsadness.com/sad/11
    ]]
    

ä½œè€…å’Œè„šæœ¬åˆ†ç±»

    author = {"Ange Gutek", "Rob Nicholls"}
    license = "Same as Nmap--See https://nmap.org/book/man-legal.html"
    categories = {"discovery", "safe"}
    

åœ¨ç«¯å£æ‰«æçš„æ—¶å€™è¿è¡Œåˆ¤æ–­å‡½æ•°ï¼Œè¿™é‡Œç›´æ¥è°ƒç”¨äº†`shortport`æä¾›çš„åˆ¤æ–­

    portrule = shortport.http
    

ç„¶åå®šä¹‰äº†è®¿é—®çš„æ¥å£å’ŒPHPå¯¹åº”å…³ç³»

    -- These are the magic queries that return fingerprintable data.
    local LOGO_QUERY = "/?=PHPE9568F36-D428-11d2-A769-00AA001ACF42"
    local CREDITS_QUERY = "/?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000"
    
    -- For PHP 5.x hashes up to 5.2.14 and 5.3.3 see:
    -- http://seclists.org/nmap-dev/2010/q4/518
    
    local LOGO_HASHES = {
      -- Bunny (Carmella)
      ["37e194b799d4aaff10e39c4e3b2679a2"] = {"5.0.0 - 5.0.3"},
      -- Black Scottish Terrier (Scotch)
      ["4b2c92409cf0bcf465d199e93a15ac3f"] = {"4.3.11", "4.4.0 - 4.4.9", "5.0.4 - 5.0.5", "5.1.0 - 5.1.2"},
      -- Colored
      ["50caaf268b4f3d260d720a1a29c5fe21"] = {"5.1.3 - 5.1.6", "5.2.0 - 5.2.17"},
      -- PHP Code Guy With Breadsticks (Thies C. Arntzen)
      ["85be3b4be7bfe839cbb3b4f2d30ff983"] = {"4.0.0 - 4.2.3"},
      -- Brown Dog In Grass (Nadia)
      ["a57bd73e27be03a62dd6b3e1b537a72c"] = {"4.3.0 - 4.3.11"},
      -- Elephant
      ["fb3bbd9ccc4b3d9e0b3be89c5ff98a14"] = {"5.3.0 - 5.3.29", "5.4.0 - 5.4.45"},
    }
    
    local CREDITS_HASHES = {
      ["744aecef04f9ed1bc39ae773c40017d1"] = {"4.0.1pl2", "4.1.0 - 4.1.2", "4.2.2"},
      ["4ba58b973ecde12dafbbd40b54afac43"] = {"4.1.1 OpenVMS"},
      ["8bc001f58bf6c17a67e1ca288cb459cc"] = {"4.2.0 - 4.2.2"},
      ["3422eded2fcceb3c89cabb5156b5d4e2"] = {"4.2.3"},
      ["1e04761e912831dd29b7a98785e7ac61"] = {"4.3.0"},
      ["1e04761e912831dd29b7a98785e7ac61"] = {"4.3.1"},
      ["65eaaaa6c5fdc950e820f9addd514b8b"] = {"4.3.1 Mandrake Linux"},
      ["8a8b4a419103078d82707cf68226a482"] = {"4.3.2"},
      ["22d03c3c0a9cff6d760a4ba63909faea"] = {"4.3.2"}, -- entity encoded "'"
      ["8a4a61f60025b43f11a7c998f02b1902"] = {"4.3.3 - 4.3.5"},
      ["39eda6dfead77a33cc6c63b5eaeda244"] = {"4.3.3 - 4.3.5"}, -- entity encoded "'"
      ["913ec921cf487109084a518f91e70859"] = {"4.3.6 - 4.3.8"},
      ["884ba1f11e0e956c7c3ba64e5e33ee9f"] = {"4.3.6 - 4.3.8"}, -- entity encoded
      ["c5fa6aec2cf0172a5a1df7082335cf9e"] = {"4.3.8 Mandrake Linux"},
      ["8fbf48d5a2a64065fc26db3e890b9871"] = {"4.3.9 - 4.3.11"},
      ["f9b56b361fafd28b668cc3498425a23b"] = {"4.3.9 - 4.3.11"}, -- entity encoded "'"
      ["ddf16ec67e070ec6247ec1908c52377e"] = {"4.4.0"},
      ["3d7612c9927b4c5cfff43efd27b44124"] = {"4.4.0"}, -- entity encoded "'"
      ["55bc081f2d460b8e6eb326a953c0e71e"] = {"4.4.1"},
      ["bed7ceff09e9666d96fdf3518af78e0e"] = {"4.4.2 - 4.4.4"},
      ["692a87ca2c51523c17f597253653c777"] = {"4.4.5 - 4.4.7"},
      ["50ac182f03fc56a719a41fc1786d937d"] = {"4.4.8 - 4.4.9"},
      ["3c31e4674f42a49108b5300f8e73be26"] = {"5.0.0 - 5.0.5"},
      ["e54dbf41d985bfbfa316dba207ad6bce"] = {"5.0.0"},
      ["6be3565cdd38e717e4eb96868d9be141"] = {"5.0.5"},
      ["b7cf53972b35b5d57f12c9d857b6b507"] = {"5.0.5 ActiveScript"},
      ["5518a02af41478cfc492c930ace45ae5"] = {"5.1.0 - 5.1.1"},
      ["6cb0a5ba2d88f9d6c5c9e144dd5941a6"] = {"5.1.2"},
      ["82fa2d6aa15f971f7dadefe4f2ac20e3"] = {"5.1.3 - 5.1.6"},
      ["6a1c211f27330f1ab602c7c574f3a279"] = {"5.2.0"},
      ["d3894e19233d979db07d623f608b6ece"] = {"5.2.1"},
      ["56f9383587ebcc94558e11ec08584f05"] = {"5.2.2"},
      ["c37c96e8728dc959c55219d47f2d543f"] = {"5.2.3 - 5.2.5", "5.2.6RC3"},
      ["1776a7c1b3255b07c6b9f43b9f50f05e"] = {"5.2.6"},
      ["1ffc970c5eae684bebc0e0133c4e1f01"] = {"5.2.7 - 5.2.8"},
      ["54f426521bf61f2d95c8bfaa13857c51"] = {"5.2.9 - 5.2.14"},
      ["adb361b9255c1e5275e5bd6e2907c5fb"] = {"5.2.15 - 5.2.17"},
      ["db23b07a9b426d0d033565b878b1e384"] = {"5.3.0"},
      ["a4c057b11fa0fba98c8e26cd7bb762a8"] = {"5.3.1 - 5.3.2"},
      ["b34501471d51cebafacdd45bf2cd545d"] = {"5.3.3"},
      ["e3b18899d0ffdf8322ed18d7bce3c9a0"] = {"5.3.4 - 5.3.5"},
      ["2e7f5372931a7f6f86786e95871ac947"] = {"5.3.6"},
      ["f1f1f60ac0dcd700a1ad30aa81175d34"] = {"5.3.7 - 5.3.8"},
      ["23f183b78eb4e3ba8b3df13f0a15e5de"] = {"5.3.9 - 5.3.29"},
      ["85da0a620fabe694dab1d55cbf1e24c3"] = {"5.4.0 - 5.4.14"},
      ["ebf6d0333d67af5f80077438c45c8eaa"] = {"5.4.15 - 5.4.45"},
    }
    

æœ€åå°±æ˜¯åˆ¤å®šçš„ä¸»è¦é€»è¾‘äº†ï¼Œè™½ç„¶æˆ‘ä»¬ä¸æ‡‚Luaï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯èƒ½å¤§æ¦‚çœ‹æ‡‚è¿™é‡Œåšçš„äº‹æƒ…

    action = function(host, port)
      local response
      local logo_versions, credits_versions
      local logo_hash, credits_hash
      local header_name, header_value
      local lines
    
      -- 1st pass : the "special" PHP-logo test
      response = http.get(host, port, LOGO_QUERY)
      if response.body and response.status == 200 then
        logo_hash = stdnse.tohex(openssl.md5(response.body))
        logo_versions = LOGO_HASHES[logo_hash]
      end
    
      -- 2nd pass : the PHP-credits test
      response = http.get(host, port, CREDITS_QUERY)
      if response.body and response.status == 200 then
        credits_hash = stdnse.tohex(openssl.md5(response.body))
        credits_versions = CREDITS_HASHES[credits_hash]
      end
    
      for name, value in pairs(response.header) do
        if string.match(value, "^PHP/") then
          header_name = name
          header_value = value
          break
        end
      end
    
      lines = {}
      if logo_versions then
        lines[#lines + 1] = "Versions from logo query (less accurate): " .. table.concat(logo_versions, ", ")
      elseif logo_hash and nmap.verbosity() >= 2 then
        lines[#lines + 1] = "Logo query returned unknown hash " .. logo_hash
      end
      if credits_versions then
        lines[#lines + 1] = "Versions from credits query (more accurate): " .. table.concat(credits_versions, ", ")
      elseif credits_hash and nmap.verbosity() >= 2 then
        lines[#lines + 1] = "Credits query returned unknown hash " .. credits_hash
      end
      if header_name and header_value then
        lines[#lines + 1] = "Version from header " .. header_name .. ": " .. header_value
      end
    
      if #lines > 0 then
        return table.concat(lines, "\n")
      end
    end
    

è®¿é—®å¯èƒ½å­˜åœ¨æ³„éœ²PHPç‰ˆæœ¬çš„æ¥å£ï¼Œå¹¶å°†è¿”å›å€¼è¿›è¡Œmd5è®¡ç®—ï¼Œæ£€æŸ¥å­—å…¸é‡Œæ˜¯å¦æœ‰å¯¹åº”å€¼ï¼Œå¦‚æœæœ‰çš„è¯å°±è¯´æ˜å­˜åœ¨PHPçš„ç‰ˆæœ¬æ³„éœ²ï¼Œæœ€åè¿”å›ç»“æœã€‚

äº‹å®ä¸Šåªæ˜¯å®ç°çš„è¯­è¨€ä¸ä¸€æ ·ï¼Œæ ¸å¿ƒçš„æ£€æµ‹åŸç†éƒ½æ˜¯ä¸€è‡´çš„

æŒ‰ç…§åº”ç”¨æœåŠ¡æ‰«æ
--------

nmapè„šæœ¬çš„å®Œæ•´æ–‡æ¡£å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ [https://nmap.org/nsedoc/scripts/](https://nmap.org/nsedoc/scripts/)

ä¸‹é¢æ˜¯å¸¸ç”¨çš„ä¸€äº›åº”ç”¨æ‰«æ

### VNCæ‰«æ

VNC (Virtual Network Console)æ˜¯[è™šæ‹Ÿç½‘ç»œ](https://baike.baidu.com/item/%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C)æ§åˆ¶å°çš„ç¼©å†™ã€‚å®ƒ æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„[è¿œç¨‹æ§åˆ¶](https://baike.baidu.com/item/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/934368)å·¥å…·è½¯ä»¶

*   æ£€æŸ¥vnc bypass

    nmap  --script=realvnc-auth-bypass 192.168.137.4
    

*   æ£€æŸ¥vncè®¤è¯æ–¹å¼

    nmap  --script=vnc-auth  192.168.137.4  
    

*   è·å–vncä¿¡æ¯

    nmap  --script=vnc-info  192.168.137.4  
    

### smbæ‰«æ

SMB(å…¨ç§°æ˜¯Server Message Block)æ˜¯ä¸€ä¸ªç½‘ç»œ[åè®®](https://baike.baidu.com/item/%E5%8D%8F%E8%AE%AE/13020269)åï¼Œå®ƒèƒ½è¢«ç”¨äº[Web](https://baike.baidu.com/item/Web/150564)è¿æ¥å’Œ[å®¢æˆ·ç«¯](https://baike.baidu.com/item/%E5%AE%A2%E6%88%B7%E7%AB%AF/101081)ä¸æœåŠ¡å™¨ä¹‹é—´çš„[ä¿¡æ¯æ²Ÿé€š](https://baike.baidu.com/item/%E4%BF%A1%E6%81%AF%E6%B2%9F%E9%80%9A/1053012)

*   smbç ´è§£

    nmap  --script=smb-brute.nse 192.168.137.4  
    

*   smbå­—å…¸ç ´è§£

    nmap --script=smb-brute.nse --script-args=userdb=/var/passwd,passdb=/var/passwd 192.168.137.4
    

*   smbæ¼æ´æ£€æµ‹

    nmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4
    

### Mssqlæ‰«æ

*   æš´åŠ›ç ´è§£ç”¨æˆ·åå¯†ç 

    nmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd 192.168.137.4 
    

*   æœ‰å¯†ç å`xp_cmdshell`æ‰§è¡Œå‘½ä»¤

    nmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd="net user" 192.168.137.4  
    

*   æœ‰å¯†ç ådymphash

    nmap -p 1433 --script ms-sql-dump-hashes.nse --script-args mssql.username=sa,mssql.password=sa  192.168.137.4  
    

### Mysqlæ‰«æ

*   æ‰«ærootç©ºå£ä»¤

    nmap -p3306 --script=mysql-empty-password.nse 192.168.137.4   
    

*   åˆ—ä¸¾æ‰€æœ‰mysqlç”¨æˆ·

    nmap -p3306 --script=mysql-users.nse --script-args=mysqluser=root 192.168.137.4 
    

*   æ‰«æmysqlç›¸å…³çš„è„šæœ¬

    nmap --script=mysql-* 192.168.137.4  
    

### Oracleæ‰«æ

*   oracle sid æ‰«æ

    nmap --script=oracle-sid-brute -p 1521-1560 192.168.137.5 
    

*   oracleå¼±å£ä»¤ç ´è§£

    nmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL,userdb=/var/passwd,passdb=/var/passwd 192.168.137.5 
    

å¦‚æœæƒ³è¦äº†è§£æ›´å¤šçš„è„šæœ¬å†…å®¹ï¼Œç§»æ­¥å®˜æ–¹æ–‡æ¡£ -> [https://nmap.org/nsedoc/scripts/](https://nmap.org/nsedoc/scripts/)

å‚è€ƒé“¾æ¥
----

*   [Nmapè„šæœ¬ä½¿ç”¨æŒ‡å—](https://zhuanlan.zhihu.com/p/26618074)
*   [Introduction Â· ç²¾é€šNmapè„šæœ¬å¼•æ“](https://t0data.gitbooks.io/nmap-nse/content/)
*   [Nmap ä¸è€çš„ç¥å™¨](https://www.sqlsec.com/2017/07/nmap.html)
*   [Writing](https://422926799.github.io/posts/81575c3f.html)
*   [Nmapè„šæœ¬å¼•æ“åŸç† - éšé£æµªå­çš„åšå®¢ - åšå®¢å›­](https://www.cnblogs.com/liun1994/p/7041373.html)
*   [HrPapers|Nmapæ¸—é€æµ‹è¯•æŒ‡å— - å…ˆçŸ¥ç¤¾åŒº](https://xz.aliyun.com/t/2283)
*   [nmapè„šæœ¬ä½¿ç”¨æ€»ç»“ - clzzy](https://wooyun.js.org/drops/nmap%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93.html)

END
---

å»ºäº†ä¸€ä¸ªå¾®ä¿¡çš„å®‰å…¨äº¤æµç¾¤ï¼Œæ¬¢è¿æ·»åŠ æˆ‘å¾®ä¿¡å¤‡æ³¨`è¿›ç¾¤`ï¼Œä¸€èµ·æ¥èŠå¤©å¹æ°´å“‡ï¼Œä»¥åŠä¸€ä¸ªä¼šå‘å¸ƒå®‰å…¨ç›¸å…³å†…å®¹çš„å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨ ğŸ˜ƒ

![GIF](https://springbird.oss-cn-beijing.aliyuncs.com/img/mmqrcode1632325540724.png) ![GIF](https://springbird.oss-cn-beijing.aliyuncs.com/img/qrcode_for_gh_cead8e1080d6_344.jpg)