---
layout: post
title: "Svelte3.xç½‘é¡µèŠå¤©å®ä¾‹|svelte.jsä»¿å¾®ä¿¡PCç‰ˆèŠå¤©svelte-webchat"
date: "2022-05-14T19:15:45.277Z"
---
Svelte3.xç½‘é¡µèŠå¤©å®ä¾‹|svelte.jsä»¿å¾®ä¿¡PCç‰ˆèŠå¤©svelte-webchat
===============================================

åŸºäºSvelte3+SvelteKit+Sassä»¿å¾®ä¿¡Macç•Œé¢èŠå¤©å®æˆ˜é¡¹ç›®_SvelteWebChat_ã€‚

åŸºäºsvelte3+svelteKit+sass+mescroll.js+svelte-layer+svelte-scrollbarç­‰æŠ€æœ¯æ­å»ºä»¿å¾®ä¿¡ç½‘é¡µç‰ˆèŠå¤©æ¡ˆä¾‹**Svelte-Webchat**ã€‚å…¨æ–°çš„Dockèœå•(å¯æ‹–æ‹½æ’åº/é¼ æ ‡æ»šè½®å·¦å³æ»šåŠ¨)ï¼Œæ•´ä½“MacOsé£æ ¼æ¯›ç»ç’ƒèƒŒæ™¯è™šåŒ–æ•ˆæœã€‚

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514213740353-126402051.png)

### ä¸€ã€ä½¿ç”¨æŠ€æœ¯

*   ç¼–è¾‘å™¨ï¼šVscode
*   æ¡†æ¶æŠ€æœ¯ï¼šSvelte^3.46.5+SvelteKit
*   çŠ¶æ€ç®¡ç†ï¼šsvelte/store
*   ä¸‹æ‹‰åˆ·æ–°ï¼šmescroll.js
*   æ»šåŠ¨æ¡ç»„ä»¶ï¼šsvelte-scrollbar
*   å¯¹è¯æ¡†ç»„ä»¶ï¼šsvelte-layer
*   sassé¢„å¤„ç†ï¼šsass^1.50.1+svelte-preprocess
*   iconfontå›¾æ ‡ï¼šé˜¿é‡Œå·´å·´å­—ä½“å›¾æ ‡åº“

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514233938796-511388657.gif)

_svelte-webchat_ï¼šæ”¯æŒå‘é€æ¶ˆæ¯+emojè¡¨æƒ…ã€å›¾ç‰‡/è§†é¢‘æŸ¥çœ‹ã€é“¾æ¥é¢„è§ˆã€ç²˜è´´æˆªå›¾å‘é€å›¾ç‰‡ã€çº¢åŒ…/æœ‹å‹åœˆã€å…¨å±/ä¸»é¢˜æ¢è‚¤ç­‰åŠŸèƒ½ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514234315527-1897561427.gif)

### äºŒã€é¡¹ç›®å±‚çº§ç»“æ„

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514234829198-142985597.png)

### **â—† æ•ˆæœé¢„è§ˆ**

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235008567-813596431.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235047316-107371973.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235101979-1094290568.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235115928-898798970.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235140147-929692192.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235151338-200034483.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235223517-1179564896.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235235625-1165033153.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235305361-2038296288.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235323511-1171661476.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235501110-1282982751.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235531169-754743490.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235552375-1499675966.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235622513-1125187507.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235653480-53343552.png)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220514235731054-1777683395.png)

### **â—† svelte.config.jsé…ç½®æ–‡ä»¶**

svelteé¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œå¯é…ç½®aliasåˆ«åè·¯å¾„ã€sassé¢„ç¼–è¯‘ç­‰åŠŸèƒ½ã€‚

import adapter from '@sveltejs/adapter-auto'
import path from 'path'
import SvelteProcess from 'svelte-preprocess'

/\*\* @type {import('@sveltejs/kit').Config} \*/
const config \= {
    kit: {
        adapter: adapter(),
        vite: {
            resolve: {
                alias: {
                    '@': path.resolve('./src'),
                    '@assets': path.resolve('./src/assets'),
                    '@utils': path.resolve('./src/utils')
                }
            }
        }
    },
    // ç¦ç”¨ Svelte è­¦å‘Š æœªä½¿ç”¨çš„ CSS é€‰æ‹©å™¨(css-unused-selector)
    onwarn: (warning, handler) => {
        const { code, frame } \= warning
        if (code === "css-unused-selector")
            return
        handler(warning)
    },
    preprocess: SvelteProcess()
};

export default config;

### **â—† svelteå…¬å…±æ¨¡æ¿åŠé”™è¯¯é¡µ**

vue.jsä¸­æœ‰router-viewè·¯ç”±ç®¡ç†é¡µé¢ã€‚svelteKitæä¾›äº†Â \_\_layout.svelteÂ å¸ƒå±€æ¨¡æ¿å’ŒÂ \_\_error.svelteÂ é”™è¯¯å¤„ç†æ¨¡æ¿ã€‚

<div class\="sv\_\_container flexbox flex-alignc flex-justifyc" style\="--themeSkin: {$skin}"\>
    <div class\="sv\_\_wrapper" class:maximize\={$isWinMaximize}\>
        {#if $userinfo}
        <div class\="sv\_\_board flexbox flex-col"\>
            <!-- <div class="sv\_\_topbar">é¡¶éƒ¨æ¨¡å—</div> \-->
            <div class\="sv\_\_mainwrap flex1 flexbox"\>
                <!-- <div class="sv\_\_sidebar">ä¾§è¾¹æ </div> \-->
                <Middle />
                <div class\="sv\_\_mainbx flex1 flexbox flex-col"\>
                    <Winbar />
                    <slot />
                </div\>
            </div\>
            <Dock />
        </div\>
        {:else}
        <div class\="sv\_\_board flexbox flex-col"\>
            <div class\="sv\_\_mainwrap flex1 flexbox"\>
                <slot />
            </div\>
        </div\>
        {/if}
    </div\>
</div\>

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515001006028-1340953060.gif)

<script context\="module"\>
    export function load({ error, status }) {
        return {
            props: { error, status }
        }
    }
</script\>

<script\>
    import { goto } from '$app/navigation'
    export let status
    export let error

    function goBack() {
        // history.go(-1)
        goto('/')
    }
</script\>

<svelte:head\>
    <title\>{status} Error!</title\>
</svelte:head\>

<div class\="sv\_\_scrollview flex1"\>
    <div class\="sv\_\_page-error flexbox flex-col flex-alignc flex-justifyc"\>
        <div class\="sv\_\_page-error-img"\>
            <img src\="404.png" alt\="" />
        </div\>
        <div class\="sv\_\_page-error-content"\>
            <div class\="c-red fs-18"\>â”—| {status} |â”›  Page Error~~</div\>
            <div class\="c-999 mt-10"\>{error.message}</div\>
            <div class\="sv\_\_btn sv\_\_btn-default" on:click\={goBack}\><i class\="iconfont icon-arrL"\></i\> è¿”å›é¦–é¡µ</div\>
        </div\>
    </div\>
</div\>

### **â—† svelte3.xè‡ªå®šä¹‰PCå¼¹çª—ç»„ä»¶**

ä¸ºäº†é¡¹ç›®UIæ•ˆæœæ•´ä½“ä¸€è‡´æ€§ï¼Œæ‰€æœ‰å¼¹çª—åŠŸèƒ½å‡æ˜¯åŸºäºsvelte.jsè‡ªå®šä¹‰_svelte-layer_å¯¹è¯æ¡†ç»„ä»¶å®ç°æ•ˆæœã€‚

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515001728068-1129759154.gif)

å¯¹äºsvelteLayerç»„ä»¶ï¼Œä¹‹å‰æœ‰è¿‡ä¸€ç¯‡åˆ†äº«æ–‡ç« ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹ä¸‹ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/16158044.html](https://www.cnblogs.com/xiaoyan2017/p/16158044.html)

### **â—† svelte3.xè‡ªå®šä¹‰è™šæ‹Ÿç¾åŒ–æ»šåŠ¨æ¡ç»„ä»¶**

ä¸ºäº†æ›¿ä»£ç³»ç»ŸåŸç”Ÿæ»šåŠ¨æ¡ï¼Œäºæ˜¯åŸºäºsvelte.jså¼€å‘äº†ä¸€æ¬¾ç½‘é¡µæ¨¡æ‹Ÿç³»ç»Ÿç¾åŒ–æ»šåŠ¨æ¡svelte-scrollbarç»„ä»¶ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515002156167-1324811897.gif)

_svelteScrollBar_ æ”¯æŒè‡ªå®šä¹‰æ»šåŠ¨æ¡å°ºå¯¸/é¢œè‰²/é—´è·ã€å‚ç›´/æ°´å¹³æ»šåŠ¨ã€è‡ªåŠ¨éšè—ã€åŠ¨æ€DOMç›‘æµ‹ç­‰åŠŸèƒ½ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/16240547.html](https://www.cnblogs.com/xiaoyan2017/p/16240547.html)

### **â—† svelteè‡ªå®šä¹‰Dockèœå•**

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515002558906-764033330.gif)

å¦‚ä¸Šå›¾ï¼šåº•éƒ¨dockèœå•ç»“åˆSvelte-Scrollbarç»„ä»¶å®ç°å·¦å³æ»šåŠ¨(æ”¯æŒé¼ æ ‡mousewheelæ»šè½®æ»‘åŠ¨)

<div class\="sv\_\_dockbar flexbox flex-justifyc"\>
    <div class\="sv\_\_dock-scroll" style\="background: {bgcolor};"\>
        <Scrollbar autohide size\={2} mousewheel\>
            <div class\="sv\_\_dock-wrap" bind:this\={dockEl}\>
                <!-- dockèœå•é¡¹ \-->
                {#each menu as item,index}
                    {#if item.type == 'divider'}
                        <div class\="sv\_\_dock-divider"\></div\>
                    {:else}
                        <div class\="sv\_\_dock-item flexbox" class:cur\={currentTabIndex == index} on:click\={changeTab(index, item)}\>
                            {#if item.icon}<span class\="iconfont {item.icon}" style\="color: {item.color}; font-size: {item.iconSize}"\></span\>{/if}
                            {#if item.img}<img class\="iconimg" src\={item.img} alt\="" style\="font-size: {item.iconSize};" />{/if}
                            {#if item.badge}<span class\="sv\_\_badge sv\_\_dock-badge"\>{item.badge}</span\>{/if}
                            {#if item.dot}<span class\="sv\_\_badge-dot sv\_\_dock-badgeDot"\></span\>{/if}
                        </div\>
                    {/if}
                {/each}
            </div\>
        </Scrollbar\>
    </div\>
</div\>

### **â—† svelte.jsè¡¨å•éªŒè¯**

svelte3ä¸­å®ç°ç™»å½•è¡¨å•åŠè·å–éªŒè¯ç 60så€’è®¡æ—¶åŠŸèƒ½ã€‚

<script>
    import { onMount } from 'svelte'
    import { goto } from '$app/navigation'
    import Layer, { svLayer } from '$lib/Layer'
    import { userinfo } from '@/store'
    import util from '@/utils'

    let formObj \= {}
    let vcodeText \= 'è·å–éªŒè¯ç '
    let disabled \= false
    let time \= 0

    let agree \= false
    let vcodeLG \= true

    let telEl
    onMount(() \=> {
        userinfo.useStorage()
        telEl.focus()
    })

    function Message(content) {
        svLayer.message({content, icon: 'warning', time: 0, xclose: true, shade: true})
    }

    // 60så€’è®¡æ—¶
    function getVcode() {
        let { tel } \= formObj
        if(!tel) {
            Message('æ‰‹æœºå·ä¸èƒ½ä¸ºç©º')
        }else if(!util.checkTel(tel)) {
            Message('æ‰‹æœºå·ä¸æ­£ç¡®')
        }else {
            time \= 60
            disabled \= true
            countDown()
        }
    }
    function countDown() {
        if(time > 0) {
            vcodeText \= 'è·å–éªŒè¯ç ('+ time +')'
            time\--
            setTimeout(countDown, 1000)
        }else {
            vcodeText \= 'è·å–éªŒè¯ç '
            time \= 0
            disabled \= false
        }
    }
    
    function handleSubmit() {
        console.log('â€”â€”+â€”â€”+â€”â€”è¡¨å•æ•°æ®ï¼š', formObj)

        let { tel, vcode, pwd } \= formObj
        if(!tel) {
            Message('æ‰‹æœºå·ä¸èƒ½ä¸ºç©º')
        }else if(!util.checkTel(tel)) {
            Message('æ‰‹æœºå·ä¸æ­£ç¡®')
        }else if(vcodeLG && !vcode) {
            Message('éªŒè¯ç ä¸èƒ½ä¸ºç©º')
        }else if(!vcodeLG && !pwd) {
            Message('å¯†ç ä¸èƒ½ä¸ºç©º')
        }else {
            svLayer({
                type: 'toast',
                icon: 'success',
                content: 'ç™»å½•æˆåŠŸ',
                shadeClose: false,
                time: 2,
                onClose: () \=> {
                    userinfo.set({
                        user: tel,
                        token: util.setToken()
                    })
                    goto('/')
                }
            })
        }
    }
</script>

### **â—† svelteèŠå¤©åŠŸèƒ½æ¨¡å—**

èŠå¤©ç¼–è¾‘æ¡†é™åˆ¶æœ€å¤§é«˜åº¦ã€æ”¯æŒå¤šè¡Œæ–‡æœ¬+emojæ··æ’ã€å…‰æ ‡å¤„æ’å…¥å†…å®¹ã€ç²˜è´´/æ‹–æ‹½å‘é€å›¾ç‰‡ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515004316979-1329537581.gif)

å…¶ä¸­è¡¨æƒ…å¼¹çª—æ˜¯åŸºäºsvelte-layerå®ç°æ•ˆæœã€‚

<!-- è¡¨æƒ…å¼¹çª— \-->
<Layer 
    bind:open\={isVisibleOpenFace}
    anim\="fadeIn"
    type\="popover"
    follow\="#popover\_face"
    placement\="top"
    shade\="false"
    area\="475px"
\>
    <!-- è¡¨æƒ… \-->
    <div class\="vui\_\_emotion" on:click|stopPropagation\={()=\>null}>
        <div class\="vui\_\_emotion-tabs flexbox"\>
            {#each emojList as item,index}
            <div class\="item" class:on\={item.selected} on:click\={()=\>handleEmojTab(index)}><img src\={item.pathLabel} alt\="" /></div\>
            {/each}
            <div class\="more flex1"\></div\>
        </div\>
        <div class\="vui\_\_emotion-wrap"\>
            <Scrollbar gap\={2} size\={2}\>
                {#each emojList as item,index}
                <div class\="vui\_\_emotion-cells" class:cur\={item.selected}\>
                    <div class\="{item.type == 'emoj' ? 'face\_\_sm\_list' : 'face\_\_lg\_list'}"\>
                        {#each item.nodes as item2}
                        <div class\="item"\>
                            {#if item.type=='emoj'}
                            <img src\={item2} class\="emoj" on:click\={handleEmojClicked} alt\="" />
                            {:else}
                            <img src\={item2} on:click\={()=\>handleGifClicked(item2)} alt="" />
                            {/if}
                        </div\>
                        {/each}
                    </div\>
                </div\>
                {/each}
            </Scrollbar\>
        </div\>
    </div\>
</Layer\>

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515004709688-79821657.gif)

<!-- è§†é¢‘é¢„è§ˆæ¨¡æ¿ \-->
<Layer bind:open\={isVisibleVideoPopup}
    title\="<span style='color:#aaa;'>è§†é¢‘é¢„è§ˆ<span>"
    opacity\=".9"
    area\={\['360px', '450px'\]}
    xclose
    xcolor\="#aaa"
    maximize
    resize
    layerStyle\="background: #333;"
\>
    <div class\="flex-c" style\="background:#333;height: 100%;"\>
        <!-- //è§†é¢‘video \-->
        {#if isVisibleVideoPopup}
        <video 
            bind:this\={videoEl}
            src\={videoData.videosrc} 
            autoplay 
            controls
            x5-video-player-fullscreen\="true"
            webkit-playsinline\="true"
            x-webkit-airplay\="true"
            playsinline\="true"
            x5-playsinline 
            style\="height:100%;width:100%;object-fit:contain;outline:none;"
        />
        {/if}
    </div\>
</Layer\>

Okayï¼Œä»¥ä¸Šå°±æ˜¯svelte.jså¼€å‘ç½‘é¡µç‰ˆèŠå¤©å®ä¾‹çš„ä¸€äº›åˆ†äº«ã€‚å¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©å“ˆ~âœğŸ»

**æœ€åé™„ä¸Šä¸€ä¸ªuniapp+uviewæ‰‹æœºç«¯åå°ç®¡ç†ç³»ç»Ÿ**

[https://www.cnblogs.com/xiaoyan2017/p/15836112.html](https://www.cnblogs.com/xiaoyan2017/p/15836112.html)

![](https://img2022.cnblogs.com/blog/1289798/202205/1289798-20220515005711211-1743086506.png)

æœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œæœªç»åšä¸»å…è®¸ä¸å¾—è½¬è½½ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµ QQï¼ˆ282310962ï¼‰ wxï¼ˆxy190310ï¼‰