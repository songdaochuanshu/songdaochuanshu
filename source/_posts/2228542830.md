---
layout: post
title: "çº¿æ€§å›å½’å¤§ç»“å±€(å²­(Ridge)ã€ Lassoå›å½’åŸç†ã€å…¬å¼æ¨å¯¼)ï¼Œä½ æƒ³è¦çš„è¿™é‡Œéƒ½æœ‰"
date: "2022-09-26T23:26:17.790Z"
---
çº¿æ€§å›å½’å¤§ç»“å±€(å²­(Ridge)ã€ Lassoå›å½’åŸç†ã€å…¬å¼æ¨å¯¼)ï¼Œä½ æƒ³è¦çš„è¿™é‡Œéƒ½æœ‰
==========================================

![çº¿æ€§å›å½’å¤§ç»“å±€(å²­(Ridge)ã€ Lassoå›å½’åŸç†ã€å…¬å¼æ¨å¯¼)ï¼Œä½ æƒ³è¦çš„è¿™é‡Œéƒ½æœ‰](https://img2022.cnblogs.com/blog/2519003/202209/2519003-20220926210958688-1646152080.png) åœ¨æœ¬ç¯‡æ–‡ç« å½“ä¸­ä¸»è¦ç»™å¤§å®¶æ·±å…¥ä»‹ç»çº¿æ€§å›å½’ç®—æ³•ä»¥åŠæ‰©å±•çš„Lassoå’ŒRidgeå›å½’ï¼Œä»¥åŠä»–ä»¬èƒ½å¤Ÿæœ‰æ•ˆçš„åŸå› ï¼ï¼

æœ¬æ–‡å·²å‚ä¸ã€Œæ–°äººåˆ›ä½œç¤¼ã€æ´»åŠ¨ï¼Œä¸€èµ·å¼€å¯æ˜é‡‘åˆ›ä½œä¹‹è·¯ã€‚

çº¿æ€§æ¨¡å‹ç®€ä»‹
------

æ‰€è°“çº¿æ€§æ¨¡å‹å°±æ˜¯é€šè¿‡æ•°æ®çš„çº¿æ€§ç»„åˆæ¥æ‹Ÿåˆä¸€ä¸ªæ•°æ®ï¼Œæ¯”å¦‚å¯¹äºä¸€ä¸ªæ•°æ® \\(X\\)

\\\[X = (x\_1, x\_2, x\_3, ...,x\_n) \\tag{1} \\\]

\\\[Y = f(X) = a\_1x\_1 + a\_2x\_2 + ... a\_nx\_n + b \\tag{2} \\\]

æ¥é¢„æµ‹ \\(Y\\)çš„æ•°å€¼ã€‚ä¾‹å¦‚å¯¹äºäººçš„ä¸¤ä¸ªå±æ€§ (é‹ç ï¼Œä½“é‡) æ¥é¢„æµ‹ èº«é«˜ ã€‚ä»ä¸Šé¢æ¥çœ‹çº¿æ€§æ¨¡å‹çš„è¡¨è¾¾å¼ç®€å•ã€æ¯”è¾ƒå®¹æ˜“å»ºæ¨¡ï¼Œä½†æ˜¯å´æœ‰å¾ˆå¥½çš„è§£é‡Šæ€§ã€‚æ¯”å¦‚ èº«é«˜\\((H)\\)å’Œé‹ç \\((S)\\)ã€ä½“é‡\\((W)\\)çš„å…³ç³»ï¼š

\\\[H=0.3\*S + 0.7\*W + 20 \\tag{3} \\\]

æ‰€è°“è§£é‡Šæ€§ç®€å•ä¸€ç‚¹æ¥è¯´å°±æ˜¯çŸ¥é“æ¨¡å‹å“ªä¸ªå±æ€§æ›´åŠ é‡è¦ï¼Œæ¯”å¦‚è¯´å¯¹äºä¸Šè¿°è¡¨è¾¾å¼æ¥è¯´ï¼Œå°±æ„å‘³ç€å¯¹äºèº«é«˜æ¥è¯´ä½“é‡çš„å› ç´ æ¯”è¾ƒå¤§ï¼Œä½“é‡æ›´åŠ é‡è¦ï¼Œè¿™ä¸ªä¾‹å­çº¯ä¸ºäº†è§£é‡Šä¸ºä»€ä¹ˆçº¿æ€§æ¨¡å‹æœ‰å¾ˆå¥½çš„è§£é‡Šæ€§ï¼Œå¯èƒ½ä¸å¤Ÿä¸¥è°¨ã€‚å¯¹äºçº¿æ€§æ¨¡å‹æ¥è¯´ï¼Œæ—¨åœ¨å­¦ä¹ åˆ°æ‰€æœ‰çš„ \\(a\_i, b\\)ï¼Œå³æ¨¡å‹çš„å‚æ•°ã€‚

æ™®é€šçº¿æ€§å›å½’
------

å¯¹äºä¸€ä¸ªæ•°æ®é›†

\\\[Dataset = \\{ (x\_1, y\_1), (x\_2, y\_2), (x\_3, y\_3), ..., (x\_n, y\_n) \\} \\ \\ , \\ y\_i \\in R \\tag{4} \\\]

å…¶ä¸­ \\(x\_i\\), å¯èƒ½å«æœ‰å¤šä¸ªå±æ€§ï¼Œå¦‚ \\(x\_i\\) æœ‰\\(m\\)ä¸ªå±æ€§æ—¶, å³ \\(x\_i = (x\_{i1}, x\_{i2}, ..., x\_{im})\\)ï¼Œ\\(y\_i\\) æ˜¯ä¸€ä¸ªå®æ•°å€¼ã€‚çº¿æ€§å›å½’éœ€è¦åšçš„äº‹å°±æ˜¯éœ€è¦æ‰¾åˆ°ä¸€å¥—å‚æ•°å°½å¯èƒ½çš„ä½¿å¾—æ¨¡å‹çš„è¾“å‡ºè·Ÿ \\(y\_i\\)æ¥è¿‘ã€‚

ä¸å¦¨è®¾å¦‚ä¸‹è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è®© \\(f(x\_i)\\) è¶Šé è¿‘çœŸå®çš„ $y\_i $è¶Šå¥½ã€‚

\\\[f(x\_i) = a\_1x\_{i1} + a\_2x\_{i2} + ... + a\_mx\_{im} + b \\tag{5} \\\]

å³ :

\\\[f(x\_i) = b + \\sum\_{j = 1}^{m}a\_jx\_{ij} \\tag{6} \\\]

ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ä¸€ä¸ªå¼å­è¡¨ç¤ºæ•´ä¸ªè¡¨è¾¾å¼ï¼Œä¸å¦¨ä»¤ :

\\\[x\_i = (x\_{i1}, x\_{i2}, ..., x\_{im}, 1) \\tag{7} \\\]

\\\[\\hat{w} = (a\_1, a\_2, ..., a\_m, b)^T \\tag{8} \\\]

ä¸Šè¿°è¡¨è¾¾å¼ç”¨çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸º ï¼š

\\\[\\left\[ \\begin{matrix} x\_{i1} & x\_{i2} & x\_{i3} & ... & x\_{i(m - 1)} & x\_{im} & 1\\end{matrix} \\right\] \\cdot \\left\[\\begin{matrix} a\_1 \\\\ a\_2 \\\\ a\_3 \\\\ .\\\\.\\\\. \\\\ a\_{m-1} \\\\ a\_m \\\\ b\\end{matrix} \\right\] = f(x\_i) \\tag{9} \\\]

ç®€å†™ä¸º :

\\\[f(x\_i) = x\_i\\cdot \\hat{w} \\tag{10} \\\]

ç°åœ¨éœ€è¦æ¥è¡¡é‡æ¨¡å‹çš„è¾“å‡ºå’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å‡æ–¹è¯¯å·®\\(MSE(Mean\\ Squared\\ Error)\\)æ¥è¡¡é‡ï¼Œå³å¯¹äº \\(y\_i\\)æ¥è¯´è¯¯å·®ä¸º:

\\\[\\mathcal{l\_i} = (f(x\_i) - y\_i)^2 \\tag{11} \\\]

åƒè¿™ç§åŸºäºæœ€å°åŒ– \\(MSE\\) æ¥æ±‚è§£æ¨¡å‹å‚æ•°çš„æ–¹æ³•å«åšæœ€å°äºŒä¹˜æ³•ã€‚å¯¹äºæ•´ä¸ªæ•°æ®é›†æ¥è¯´ä»–çš„è¯¯å·®ä¸º \\(\\mathcal{L}\\) ï¼š

\\\[\\mathcal{L} = \\sum\_{i = 1}^{n}(f(x\_i) - y\_i)^2\\ \\tag{12} \\\]

ç°åœ¨æˆ‘ä»¬å°†ä»–ä»¬ç”¨çŸ©é˜µæ¥è¡¨ç¤º å…¶ä¸­ ï¼š

\\\[Y = (y\_1, y\_2, y\_3, ..., y\_{n - 2}, y\_{n - 1}, y\_{n})^T = \\left\[\\begin{matrix}y\_1 \\\\ y\_2 \\\\ y\_3 \\\\ . \\\\. \\\\. \\\\ y\_{n - 2} \\\\ y\_{n - 1}\\\\ y\_{n}\\end{matrix}\\right\] \\tag{13} \\\]

\\\[X = (x\_1; ...; x\_n)= (x\_1, ..., x\_n)^T = \\left\[\\begin{matrix}x\_1 \\\\ x\_2 \\\\ . \\\\. \\\\. \\\\ x\_{n-1}\\\\ x\_{n}\\end{matrix}\\right\]= \\left\[\\begin{matrix}x\_{11} & x\_{12} & x\_{13} & . .. & x\_{1m} &1& \\\\ x\_{21} & x\_{22} & x\_{23} & ... & x\_{2m} &1& \\\\ . & . & . & . & . &.\\\\. & . & . & . & . &. \\\\ . & . & . & . & . &. \\\\ x\_{(n - 1)1} & x\_{(n - 1)2} & x\_{(n - 1)3} & ... & x\_{(n - 1)m} &1\\\\ x\_{n1} & x\_{n2} & x\_{n3} & ... & x\_{nm} & 1\\end{matrix}\\right\] \\tag{14} \\\]

\\\[f(X) = \\left\[\\begin{matrix}x\_{11} & x\_{12} & x\_{13} & . .. & x\_{1m} &1& \\\\ x\_{21} & x\_{22} & x\_{23} & ... & x\_{2m} &1& \\\\ . & . & . & . & . &.\\\\. & . & . & . & . &. \\\\ . & . & . & . & . &. \\\\ x\_{(n - 1)1} & x\_{(n - 1)2} & x\_{(n - 1)3} & ... & x\_{(n - 1)m} &1\\\\ x\_{n1} & x\_{n2} & x\_{n3} & ... & x\_{nm} & 1\\end{matrix}\\right\] \\cdot \\left\[\\begin{matrix} a\_1 \\\\ a\_2 \\\\ a\_3 \\\\ .\\\\.\\\\. \\\\ a\_{m-1} \\\\ a\_m \\\\ b\\end{matrix} \\right\] = \\left\[\\begin{matrix} x\_1\\hat{w} \\\\ x\_2\\hat{w} \\\\ x\_3\\hat{w} \\\\ .\\\\.\\\\. \\\\ x\_{n-2}\\hat{w} \\\\ x\_{n - 1}\\hat{w} \\\\ x\_{n}\\hat{w}\\end{matrix} \\right\] = \\left\[\\begin{matrix}\\hat{y}\_1\\\\ \\hat{y}\_2\\\\ \\hat{y}\_3\\\\ \\\\.\\\\.\\\\.\\\\\\hat{y}\_{n-2}\\\\\\hat{y}\_{n-1}\\\\\\hat{y}\_n\\\\ \\end{matrix}\\right\] \\tag{15} \\\]

å…¶ä¸­ \\(\\hat{y}\_i\\) æ˜¯æ¨¡å‹çš„é¢„æµ‹å€¼ \\(y\_i\\) æ˜¯æ•°æ®çš„çœŸå®å€¼ï¼Œ\\(m\\) æ˜¯ä¸€æ¡æ•°æ® \\(x\_i\\)çš„å±æ€§çš„ä¸ªæ•°ã€‚ç°åœ¨æ¥æ¢³ç†ä¸€ä¸‹æ•°æ®çš„ç»´åº¦ï¼š

\\\[X : n\\times (m+1) \\\\ \\hat{w} : (m+1)\\times 1\\\\ Y : n\\times 1 \\\\ f(X) : n\\times 1 \\\]

é‚£å®¹æ˜“å¾—å‡ºï¼Œå¯¹äºæ•´ä¸ªæ•°æ®é›†çš„è¯¯å·®ä¸º \\(\\mathcal{L}(w, b)\\) ï¼š

\\\[\\mathcal{L}(w, b) = \\mathcal{L}({\\hat{w}}) = \\sum\_{i=1}^{n}( \\hat{y} - y\_i)^2 = \\sum\_{i=1}^{n}(x\_i\\hat{w}-y\_i)^2 = ||X\\hat{w}-Y||\_2^2 = (X\\hat{w}-Y)^T(X\\hat{w}-Y) \\tag{16} \\\]

\\\[x\_i = (x\_{i1}, x\_{i2}, ..., x\_{im}, 1)\\\\ \\hat{w} = (a\_1, a\_2, ..., a\_m, b)^T \\\]

ç°åœ¨æ¥ä»”ç»†åˆ†æä¸€ä¸‹å…¬å¼\\((16)\\)ï¼Œé¦–å…ˆå¯¹äºä¸€ä¸ª\\(1\\times n\\)æˆ–è€…\\(n \\times 1\\)å‘é‡æ¥è¯´ï¼Œå®ƒçš„äºŒèŒƒæ•°ä¸ºï¼š

\\\[||x||\_2 = \\sqrt{\\sum\_{i=1}^{n}x\_i^2} \\\]

äºŒèŒƒæ•°å¹³æ–¹ä¸ºï¼š

\\\[||x||\_2^2 = \\sum\_{i=1}^{n}x\_i^2 \\\]

æ‰€ä»¥å°±æœ‰äº† \\(\\sum\_{i=1}^{n}(X\\hat{w}-Y)^2 = ||Y-X\\hat{w}||\_2^2\\)ï¼Œ é‚£ä¹ˆå¯¹äºå…¬å¼\\((16)\\)æ¥è¯´ \\(X\\hat{w}-Y\\) æ˜¯ä¸€ä¸ª \\(n\\times 1\\)çš„å‘é‡ï¼š

\\\[X\\hat{w}-Y = \\left\[\\begin{matrix}\\hat{y}\_1 - y\_1 \\\\ \\hat{y}\_2 - y\_2 \\\\.\\\\.\\\\.\\\\\\hat{y}\_{n-1} - y\_{n-1} \\\\\\hat{y}\_{n}- y\_{n} \\end{matrix}\\right\] \\\]

æ‰€ä»¥æ ¹æ®çŸ©é˜µä¹˜æ³•å°±æœ‰ï¼š

\\\[(X\\hat{w} - Y)^T(X\\hat{w} - Y)=\\left\[\\begin{matrix} \\hat{y}\_1 - y\_1 ,&..., &\\hat{y}\_{n} - y\_{n} \\end{matrix}\\right\]\\cdot \\left\[\\begin{matrix}\\hat{y}\_1 - y\_1 \\\\\\hat{y}\_2 - y\_2 \\\\.\\\\.\\\\.\\\\\\hat{y}\_{n-1} - y\_{n-1} \\\\\\hat{y}\_{n} - y\_{n} \\end{matrix}\\right\] = \\sum\_{i=1}^{n}(\\hat{y}- y\_i )^2 \\tag{17} \\\]

æ ¹æ®ä¸Šé¢çš„åˆ†ææœ€ç»ˆå°±å¾—åˆ°äº†æ¨¡å‹çš„è¯¯å·®ï¼š

\\\[\\mathcal{L}(w, b) = \\mathcal{L(\\hat{w})} = ||X\\hat{w} - Y||\_2^2 = (X\\hat{w} - Y)^T(X\\hat{w} - Y) \\tag{18} \\\]

ç°åœ¨å°±éœ€è¦æœ€å°åŒ–æ¨¡å‹çš„è¯¯å·®ï¼Œå³ä¼˜åŒ–é—®é¢˜ï¼Œæ˜“çŸ¥\\(\\mathcal{L(w, b)}\\)æ˜¯ä¸€ä¸ªå…³äº \\(\\hat{w}\\) çš„å‡¸å‡½æ•°ï¼Œåˆ™å½“å®ƒå…³äº\\(\\hat{w}\\)å¯¼æ•°ä¸º0æ—¶æ±‚å‡ºçš„\\(\\hat{w}\\)æ˜¯\\(\\hat{w}\\)çš„æœ€ä¼˜è§£ã€‚è¿™é‡Œä¸å¯¹å…¶æ˜¯å‡¸å‡½æ•°è¿›è¡Œè§£é‡Šï¼Œå¦‚æœæœ‰æ—¶é—´ä»¥åä¸“é—¨å†™ä¸€ç¯‡æ–‡ç« æ¥è§£è¯»ã€‚ç°åœ¨å°±éœ€è¦å¯¹\\(\\hat{w}\\)è¿›è¡Œæ±‚å¯¼ã€‚

\\\[\\mathcal{L(\\hat{w})} = ||X\\hat{w} - Y||\_2^2 = (X\\hat{w} - Y)^T(X\\hat{w} - Y) \\\]

\\\[= ((X\\hat{w})^T - Y^T)(X\\hat{w} - Y) = (\\hat{w}^TX^T - Y^T)(X\\hat{w} - Y) \\\]

\\\[=\\hat{w}^TX^TX\\hat{w} - \\hat{w}^TX^TY - Y^TX\\hat{w} + Y^TY \\\]

æˆ‘ä»¬ç°åœ¨è¦å¯¹ä¸Šè¿°å…¬å¼è¿›è¡Œæ±‚å¯¼ï¼Œæˆ‘ä»¬å…ˆæ¥æ¨å¯¼ä¸€ä¸‹çŸ©é˜µæ±‚å¯¼æ³•åˆ™ï¼Œè¯·å¤§å®¶æ‰¶ç¨³åå¥½ğŸ˜ğŸ˜ï¼š

å…¬æ±‚å¯¼å¼æ³•åˆ™ä¸€:

\\(\\forall\\) å‘é‡ \\(A:1 \\times n\\) , \\(X: n \\times 1, Y=A\\cdot X\\)ï¼Œåˆ™ \\(\\frac{\\partial Y}{\\partial X} = A^T\\)ï¼Œå…¶ä¸­\\(Y\\)æ˜¯ä¸€ä¸ªå®æ•°å€¼ã€‚

è¯æ˜:

ä¸å¦¨è®¾ï¼š

\\\[A = (a\_1, a\_2, a\_3, ..., a\_n) \\\]

\\\[X = (x\_1, x\_2, x\_3, ..., x\_n)^T \\\]

\\\[\\therefore Y = (a\_1, a\_2, a\_3, ..., a\_n)\\cdot \\left\[\\begin{matrix} x\_1\\\\x\_2\\\\x\_3\\\\.\\\\.\\\\.\\\\x\_n\\end{matrix}\\right\] = \\sum\_{i = 1}^{n}a\_ix\_i \\\]

å½“æˆ‘ä»¬åœ¨å¯¹\\(x\_i\\)ï¼Œæ±‚å¯¼çš„æ—¶å€™å…¶ä½™\\(x\_j, j \\neq i\\)ï¼Œå‡å¯ä»¥çœ‹åšå¸¸æ•°ï¼Œåˆ™ï¼š

\\\[\\frac{\\partial Y}{\\partial x\_i} = 0 + ...+0 + a\_i + 0 +... + 0 \\\]

\\\[\\therefore \\frac{\\partial Y}{\\partial X} = \\left\[\\begin{matrix}\\frac{\\partial Y}{\\partial x\_1}\\\\ \\frac{\\partial Y}{\\partial x\_2}\\\\.\\\\.\\\\.\\\\ \\frac{\\partial Y}{\\partial x\_{n-1}}\\\\\\frac{\\partial Y}{\\partial x\_n}\\\\\\end{matrix}\\right\] = \\left\[\\begin{matrix}a\_1\\\\ a\_2\\\\.\\\\.\\\\.\\\\a\_{n-1}\\\\ a\_n\\end{matrix}\\right\] = (a\_1, a\_2, a\_3, ..., a\_n)^T = A^T \\\]

ç”±ä¸Šè¿°åˆ†æå¯çŸ¥ï¼š

\\\[\\frac{\\partial Y}{\\partial X} = A^T \\\]

å…¬æ±‚å¯¼å¼æ³•åˆ™äºŒ:

å½“\\(Y = X^TA\\)ï¼Œå…¶ä¸­ \\(X:n\\times 1, A:n\\times 1\\)ï¼Œåˆ™\\(\\frac{\\partial Y}{\\partial X} = A\\)

å…¬æ±‚å¯¼å¼æ³•åˆ™ä¸‰:

å½“\\(Y = X^TAX\\)ï¼Œå…¶ä¸­ \\(X:1\\times n, A : n\\times n\\)ï¼Œåˆ™\\(\\frac{\\partial Y}{\\partial X} = (A^T + A)X\\)

ä¸Šé¢å…¬å¼åŒç†å¯ä»¥è¯æ˜ï¼Œåœ¨è¿™é‡Œä¸è¿›è¡Œèµ˜è¿°äº†ã€‚

\\\[\\mathcal{L(\\hat{w})} =\\hat{w}^TX^TX\\hat{w} - \\hat{w}^TX^TY - Y^TX\\hat{w} + Y^TY \\tag{19} \\\]

æœ‰å…¬å¼\\((19)\\)å’Œä¸Šé¢æ±‚å¯¼æ³•åˆ™å¯çŸ¥ï¼š

\\\[\\frac{\\partial \\mathcal{L(\\hat{w})}}{\\partial \\hat{w}} = ((X^TX)^T + X^TX)\\hat{w} - X^TY - (Y^TX)^T\\\\ = 2X^TX\\hat{w} - 2X^TY = 2X^T(X\\hat{w} - Y) = 0 \\\]

\\\[X^TX\\hat{w} = X^TY \\tag{20} \\\]

\\\[\\therefore \\hat{w}^\* = (X^TX)^{-1}X^TY \\tag{21} \\\]

å³ \\(\\hat{w}^\* = (X^TX)^{-1}X^TY\\) ä¸ºæˆ‘ä»¬è¦æ±‚çš„å‚æ•°ã€‚

Ridge(å²­)å›å½’
----------

å†™åœ¨å‰é¢ï¼šå¯¹äºä¸€ä¸ªçŸ©é˜µ \\(A\_{n\\times n}\\) æ¥è¯´å¦‚æœæƒ³å®ƒçš„é€†çŸ©é˜µé‚£ä¹ˆ \\(A\\) çš„è¡Œåˆ—å¼å¿…ç„¶ä¸ä¸º0ï¼Œä¸”çŸ©é˜µ \\(A\\) æ˜¯ä¸€ä¸ªæ»¡ç§©çŸ©é˜µï¼Œå³\\(r(A)=n\\)ã€‚

æ ¹æ®ä¸Šé¢çš„æ¨å¯¼ï¼Œåœ¨ç”±å…¬å¼\\((20)\\) åˆ° \\((21)\\) æ˜¯ç­‰å¼ä¸¤éåŒæ—¶ä¹˜äº† \\(X^TX\\) çš„é€†çŸ©é˜µï¼Œä½†æ˜¯å®é™…æƒ…å†µä¸­ï¼ŒçŸ©é˜µçš„é€†å¯èƒ½æ˜¯ä¸å­˜åœ¨çš„ï¼Œå½“çŸ©é˜µ \\(X^TX : n\\times n\\) ä¸æ˜¯æ»¡ç§©çŸ©é˜µçš„æ—¶å€™ï¼Œå³ \\(r(X^TX) < n\\)å³ \\(X^TX\\) è¡Œåˆ—å¼ä¸º 0æ—¶ï¼Œ \\((X^TX)^{-1}\\) ä¸å­˜åœ¨ã€‚ä¸€ç§å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œå½“ \\(x\\) çš„çš„æ ·æœ¬æ•°æ®å°äºä»–çš„ç»´æ•°çš„æ—¶å€™ï¼Œå³å¯¹äº \\(X\\) æ¥è¯´ \\(n<m\\)ï¼Œé‚£ä¹ˆ\\(r(X) < m\\) ï¼Œåˆæ ¹æ®çŸ©é˜µæ€§è´¨ \\(r(X) = r(X^T) = r(X^TX)\\)ï¼Œå¯ä»¥å¾—åˆ° \\(r(X^TX) < m\\)ï¼Œé‚£ä¹ˆ \\(X^TX\\) ä¸æ»¡ç§©ï¼Œåˆ™ \\((X^TX)^{-1}\\) ä¸å­˜åœ¨ã€‚

å¯¹äºä¸Šè¿° \\((X^TX)^{-1}\\) ä¸å­˜åœ¨çš„æƒ…å†µä¸€ç§å¸¸è§çš„è§£å†³åŠæ³•å°±æ˜¯åœ¨æŸå¤±å‡½æ•° \\(\\mathcal{L(\\hat{w})}\\) åé¢åŠ ä¸€ä¸ª\\(L\_2\\)æ­£åˆ™åŒ–æƒ©ç½šé¡¹ï¼š

\\\[\\mathcal{L(\\hat{w})} = ||X\\hat{w} - Y||\_2^2 + \\lambda||\\hat{w}||\_2^2 = (X\\hat{w} - Y)^T(X\\hat{w} - Y) + \\lambda\\hat{w}^T\\hat{w} \\tag{22} \\\]

åˆ™å¯¹ \\(\\hat{w}\\) æ±‚å¯¼æœ‰ï¼š

\\\[\\frac{\\partial \\mathcal{L(\\hat{w})}}{\\partial \\hat{w}} = 2X^TX\\hat{w} - 2X^TY + 2\\lambda\\hat{w} = 0 \\tag{23} \\\]

\\\[(X^TX+\\lambda E)\\hat{w} = X^TY \\\]

å½“ \\(X^TX\\) ä¸æ»¡ç§©çš„æ—¶å€™ï¼Œå…¶è¡Œåˆ—å¼ä¸º0ï¼ŒåŠ ä¸Š \\(\\lambda E\\)ä¹‹åå¯ä»¥ä½¿å¾— \\(X^TX+\\lambda E\\) è¡Œåˆ—æ˜¯ä¸ä¸º0ï¼Œæ‰€ä»¥ \\((X^TX+\\lambda E)^{-1}\\)å­˜åœ¨åˆ™ï¼š

\\\[\\hat{w} = (X^TX+\\lambda E)^{-1}X^TY \\tag{24} \\\]

é™¤äº†ä¸Šé¢æåˆ°çš„\\(X^TX\\)ä¸æ»¡ç§©çš„æƒ…å†µï¼Œè¿˜æœ‰ä¸€ç§å¸¸è§çš„å°±æ˜¯æ•°æ®ä¹‹é—´çš„å…±çº¿æ€§çš„é—®é¢˜ï¼Œå®ƒä¹Ÿä¼šå¯¼è‡´\\(X^TX\\)çš„è¡Œåˆ—å¼ä¸º0ï¼Œå³\\(X^TX\\)ä¸æ»¡ç§©ã€‚ç®€å•æ¥è¯´å°±æ˜¯æ•°æ®çš„å…¶ä¸­çš„ä¸€ä¸ªå±æ€§å’Œå¦å¤–ä¸€ä¸ªå±æ€§æœ‰æŸç§çº¿æ€§å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸¤ä¸ªå±æ€§å°±ç›¸å½“äºä¸€ä¸ªå±æ€§ï¼Œå› ä¸ºå…¶ä¸­ä¸€ä¸ªå±æ€§å¯ä»¥ç”¨å¦å¤–ä¸€ä¸ªå±æ€§çº¿æ€§è¡¨ç¤ºã€‚è¿™ä¼šè®©æ¨¡å‹å†è®­ç»ƒçš„æ—¶å€™å¯¼è‡´è¿‡æ‹Ÿåˆï¼Œå› ä¸ºæ¨¡å‹å†è®­ç»ƒçš„æ—¶å€™ä¸ä¼šå»å…³å¿ƒå±æ€§ä¹‹é—´æ˜¯å¦å…·æœ‰çº¿æ€§å…³ç³»ï¼Œæ¨¡å‹åªä¼šä¸åŠ æ€è€ƒçš„å»é™ä½æ•´ä¸ªæ¨¡å‹çš„æŸå¤±ï¼Œå³\\(MSE\\)ï¼Œè¿™ä¼šè®©æ¨¡å‹æ•æ‰ä¸åˆ°æ•°æ®ä¹‹é—´çš„å…³ç³»ï¼Œè€Œåªæ˜¯å•çº¯çš„å»é™ä½è®­ç»ƒé›†çš„\\(MSE\\)ã€‚è€Œä½ å¦‚æœåªæ˜¯å•çº¯çš„å»é™ä½ä½ è®­ç»ƒé›†çš„\\(MSE\\)çš„æ—¶å€™ï¼Œæ²¡æœ‰æ•æ‰åˆ°æ•°æ®çš„è§„å¾‹ï¼Œé‚£ä¹ˆæ¨¡å‹å†æµ‹è¯•é›†ä¸Šä¼šå‡ºç°æ¯”è¾ƒå·®çš„æƒ…å†µï¼Œå³æ¨¡å‹ä¼šå‡ºç°è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚

ä¸ºä»€ä¹ˆæ­£åˆ™åŒ–æƒ©ç½šé¡¹Work?
--------------

ä¸Šé¢è°ˆåˆ°æ¨¡å‹å‡ºç°è¿‡æ‹Ÿåˆçš„ç°è±¡ï¼Œè€ŒåŠ ä¸Š\\(L\_2\\)æŸå¤±å¯ä»¥ä¸€ç›´è¿‡æ‹Ÿåˆç°è±¡ï¼Œæˆ‘åœ¨è¿™é‡Œç®€å•ç»™å¤§å®¶è¯´è¯´æˆ‘å¾—è§‚ç‚¹ï¼Œä¸ä¸€å®šæ­£ç¡®ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©å¤§å®¶ç†è§£ä¸ºä»€ä¹ˆ\\(L\_2\\)æƒ©ç½šé¡¹å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸ŠæŠ‘åˆ¶è¿‡æ‹Ÿåˆç°è±¡ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹çœŸå®æ•°æ®ï¼š

![image-20210415000700716](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eccac3e4175a4a62be4a9b3c4ddce289~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚æœéœ€è¦æ‹Ÿåˆçš„è¯ï¼Œä¸‹é¢çš„ç»“æœåº”è¯¥æ˜¯æœ€å¥½çš„ï¼Œå³ä¸€ä¸ªæ­£å¼¦å‡½æ•°ï¼š

![image-20210415000643812](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f1dacb1727e642cdbc9a5984893cca4e~tplv-k3u1fbpfcp-zoom-1.image)

ä¸‹å›¾æ˜¯ä¸€ä¸ªè¿‡æ‹Ÿåˆçš„æƒ…å†µï¼š

![image-20210415000734593](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70f154eeced24fcdbfb9aea981e97118~tplv-k3u1fbpfcp-zoom-1.image)

æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸€ä¸‹å®ƒçœŸå®è§„å¾‹æ­£å¼¦æ›²çº¿çš„ä¹‹é—´çš„å·®å¼‚ï¼šè¿‡æ‹Ÿåˆçš„æ›²çº¿å°†æ¯ä¸ªç‚¹éƒ½è€ƒè™‘åˆ°äº†ï¼Œå› æ­¤ä»–ä¼šæœ‰ä¸€ä¸ªéå¸¸å¤§çš„ç¼ºç‚¹å°±æ˜¯â€çªå˜â€œï¼Œå³æ›²çº¿çš„æ–œç‡çš„ç»å¯¹å€¼éå¸¸å¤§ï¼Œå¦‚ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7bd6210e17e04970a5df3553f7e50623~tplv-k3u1fbpfcp-zoom-1.image)

å¯¹äºä¸€èˆ¬çš„ä¸€æ¬¡å‡½æ•° \\(y = ax + b\\) æ¥è¯´ï¼Œå½“ \\(a\\) å¾ˆå¤§çš„æ—¶å€™ï¼Œæ–œç‡ä¼šå¾ˆå¤§ï¼Œæ¨å¹¿åˆ°å¤æ‚æ¨¡å‹ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå½“æ¨¡å‹å‚æ•°å¾ˆå¤§çš„æ—¶å€™æ¨¡å‹å¯èƒ½ä¼šå‘ç”Ÿå‰§çƒˆçš„å˜åŒ–ï¼Œå³å¯èƒ½å‘ç”Ÿè¿‡æ‹Ÿåˆç°è±¡ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸ºä»€ä¹ˆåœ¨çº¿æ€§å›å½’ä¸­åŠ å…¥äº†ä¸€ä¸ª \\(L\_2\\) æƒ©ç½šé¡¹ä¼šå‡å°‘è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚å› ä¸ºåœ¨æŸå¤±å‡½æ•°ä¸­æœ‰æƒé‡çš„äºŒèŒƒæ•°çš„å¹³æ–¹ï¼Œå½“æƒé‡è¿‡å¤§çš„æ—¶å€™æ¨¡å‹çš„æŸå¤±å°±ä¼šè¶Šå¤§ï¼Œä½†æ˜¯æ¨¡å‹éœ€è¦é™ä½æŸå¤±ï¼Œé‚£ä¹ˆå°±éœ€è¦é™ä½æƒé‡çš„å€¼ï¼Œæƒé‡çš„å€¼ä¸€æ—¦ä½ä¸‹æ¥ï¼Œçªå˜çš„å¯èƒ½æ€§å°±ä¼šå˜å°ï¼Œå› æ­¤åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆç°è±¡ã€‚è€Œå‚æ•° \\(\\alpha\\) å°±æ˜¯æ¥è°ƒæ§æƒé‡åœ¨æŸå¤±ä¸­çš„æ¯”ä¾‹ï¼Œå½“ \\(\\lambda\\) è¶Šå¤§çš„æ—¶å€™å¯¹æƒé‡æƒ©ç½šçš„è¶Šç‹ ï¼Œè¿™åœ¨å®é™…è°ƒå‚çš„è¿‡ç¨‹ä¸­éœ€è¦äº†è§£ã€‚åé¢çš„ \\(Lasso\\) å›å½’å‚æ•° \\(\\alpha\\) çš„æ„ä¹‰ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚

Lassoå›å½’
-------

å²­å›å½’æ˜¯åœ¨æŸå¤±å‡½æ•°ä¸­åŠ ä¸€ä¸ª\\(L\_2\\)æŸå¤±ï¼Œè€Œ\\(Lasso\\)å›å½’æ˜¯åœ¨æŸå¤±å‡½æ•°\\(\\mathcal{L(\\hat{w})}\\)åé¢åŠ ä¸€ä¸ª\\(L\_1\\)çš„æŸå¤±ï¼Œå³ï¼š

\\\[\\mathcal{L(\\hat{w})} = ||X\\hat{w} - Y||\_2^2 + \\alpha\\sum\_{j=0}^{m}|{\\hat{w}}\_j| \\tag{25} \\\]

å¯¹å…¬å¼\\((25)\\)æ±‚å¯¼ï¼š

\\\[\\frac{\\partial \\mathcal{L(\\hat{w})}}{\\partial \\hat{w}} = 2X^TX\\hat{w} - 2X^TY + \\alpha C = 0 \\tag{26}\\\\ \\\]

\\\[\\left\\{\\begin{matrix}c\_i = -1\\ ,\\ if\\ \\hat{w}\_i < 0;\\\\ c\_i = 1\\ ,\\ if\\ \\hat{w}\_i \\ge 0;\\\\\\end{matrix}\\right. \\\]

å…¶ä¸­\\(C\\)æ˜¯å’Œ\\(\\hat{w}\\)åŒç»´åº¦çš„å‘é‡ã€‚åˆ™å¯ä»¥å¾—åˆ°ï¼š

\\\[\\hat{w} = (X^TX)^{-1}(X^TY-\\frac{\\alpha}{2} C)\\tag{27} \\\]

çº¿æ€§å›å½’å®ç°è¿‡ç¨‹
--------

ä¸Šé¢æåˆ°\\(\\mathcal{L(w, b)}\\)æ˜¯ä¸€ä¸ªå…³äº \\(\\hat{w}\\) çš„å‡¸å‡½æ•°ï¼Œåˆ™å½“å®ƒå…³äº\\(\\hat{w}\\)å¯¼æ•°ä¸º0æ—¶æ±‚å‡ºçš„\\(\\hat{w}\\)æ˜¯\\(\\hat{w}\\)çš„æœ€ä¼˜è§£ï¼Œå› æ­¤åœ¨ç¼–ç å®ç°çº¿æ€§å›å½’çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®é›†æ¯”è¾ƒå°å¯ä»¥ç›´æ¥å°†æ‰€æœ‰çš„æ•°æ®åŒæ—¶è¿›è¡Œè®¡ç®—ï¼ŒèŠ‚çœè®¡ç®—èµ„æºï¼Œå› ä¸ºåªéœ€è¦è®¡ç®—ä¸€æ¬¡ \\(\\hat{w}\\) çš„å¯¼æ•°ã€‚ä½†æ˜¯å¦‚æœæ•°æ®é‡è¿‡å¤§çš„è¯ï¼Œè®¡ç®—æ— æ³•ä¸€æ¬¡æ€§å®Œæˆï¼Œå¯ä»¥ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæˆ–è€…å…¶ä»–çš„ä¼˜åŒ–ç®—æ³•ï¼Œè¿›è¡Œå¤šæ¬¡è¿­ä»£å­¦ä¹ ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚

Ridgeå›å½’å’ŒLassoå›å½’åŒºåˆ«
-----------------

ä¸Šé¢è°ˆåˆ°äº† \\(Ridge\\) å’Œ \\(Lasso\\) çš„å…·ä½“çš„å®ç°æ–¹æ³•ï¼Œè¿˜ç®€è¦è°ˆåˆ°äº† \\(Ridge\\) å¯ä»¥æœ‰æ•ˆé˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆï¼Œå’Œä»–åœ¨æ•°æ®ä¸ªæ•°å°äºæ•°æ®ç»´åº¦çš„æ—¶å€™çš„ä½¿ç”¨ã€‚é‚£ä¹ˆéƒ½æ˜¯å¢åŠ ä¸€ä¸ªæƒ©ç½šé¡¹ï¼Œé‚£ä¹ˆ \\(Ridge\\) å’Œ \\(Lasso\\) æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ

*   \\(Ridge\\) å’Œ \\(Lasso\\) éƒ½å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆ
*   \\(Ridge\\) åœ¨æ•°æ®ä¸ªæ•°å°äºæ•°æ®ç»´åº¦çš„æ—¶å€™æ¯”è¾ƒé€‚åˆ
*   \\(Lasso\\) çš„æ•°æ®çš„å±æ€§ä¹‹é—´æœ‰å…±çº¿æ€§çš„æ—¶å€™æ¯”è¾ƒé€‚åˆ
*   \\(Ridge\\) ä¼šé™åˆ¶å‚æ•°çš„å¤§å°ï¼Œä½¿ä»–é€¼è¿‘äº0
*   \\(Lasso\\) æ˜¯ä¸€ç§ç¨€ç–æ¨¡å‹ï¼Œå¯ä»¥åšç‰¹å¾é€‰æ‹©

ä¸ºä»€ä¹ˆ \\(Lasso\\) æ˜¯ä¸€ç§ç¨€ç–æ¨¡å‹ï¼Œå› ä¸ºå®ƒåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­å¯ä»¥ä½¿å¾—æƒé‡ \\(\\hat{w}\\) ä¸­çš„æŸäº›å€¼å˜æˆ0ï¼ˆç¨€ç–æƒé‡ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå±æ€§å¯¹åº”çš„æƒé‡ä¸º0ï¼Œé‚£ä¹ˆè¯¥å±æ€§åœ¨æœ€ç»ˆçš„é¢„æµ‹å½“ä¸­å¹¶æ²¡æœ‰å‘æŒ¥ä½œç”¨ï¼Œè¿™å°±ç›¸å½“ä¸æ¨¡å‹é€‰æ‹©äº†éƒ¨åˆ†å±æ€§(ä»–ä»¬ä½ çš„æƒé‡ä¸ä¸º0)ã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“çŸ¥é“æ—¢ç„¶è¿™äº›å±æ€§å¯¹åº”çš„æƒå€¼ä¸º0ï¼Œå³ä»–å¯¹äºæ¨¡å‹æ¥è¯´å¹¶ä¸é‡è¦ï¼Œæ¨¡å‹åªé€‰æ‹©äº†äº›æƒé‡ä¸ä¸º0çš„å±æ€§ï¼Œæ‰€ä»¥è¯´ \\(Lasso\\) å¯ä»¥åšç‰¹å¾é€‰æ‹©ã€‚è€Œ\\(Ridge\\) ä¹Ÿä¼šä¸æ–­é™ä½æƒå€¼çš„å¤§å°ï¼Œä½†æ˜¯ä»–ä¸ä¼šè®©æƒå€¼å˜æˆ0ï¼Œåªä¼šä¸æ–­çš„ç¼©å°æƒå€¼ï¼Œä½¿å…¶é€¼è¿‘äº0ã€‚

Ridgeå’ŒLassoå¯¹æƒå€¼çš„å½±å“
-----------------

åœ¨æ­£å¼è®¨è®ºè¿™ä¸ªé—®é¢˜ä¹‹é—´æˆ‘ä»¬é¦–å…ˆå…ˆæ¥åˆ†æä¸åŒçš„æƒå€¼æ‰€å¯¹åº”çš„\\(RSS\\)ï¼ˆæ®‹å·®å¹³æ–¹å’Œï¼‰å€¼æ˜¯å¤šå°‘ã€‚\\(RSS\\)çš„å®šä¹‰å¦‚ä¸‹ï¼š

\\\[RSS = \\sum\_{i=0}^{n}(x\_i\\hat{w} - y\_i)^2 \\\]

å¯¹äºä¸€ä¸ªåªæœ‰ä¸¤ä¸ªå±æ€§çš„æ•°æ®ï¼Œå¯¹ä¸åŒçš„æƒå€¼è®¡ç®—æ•´ä¸ªæ•°æ®é›†åœ¨ç›¸åº”æƒå€¼ä¸‹çš„ \\(RSS\\) ã€‚ç„¶åå°† \\(RSS\\) å€¼ç›¸ç­‰çš„ç‚¹è¿æ¥èµ·æ¥åšæˆä¸€ä¸ªç­‰é«˜çº¿å›¾ï¼Œçœ‹çœ‹ç›¸åŒçš„\\(RSS\\) å€¼ä¸‹æƒå€¼å›´æˆäº†ä¸€ä¸ªä»€ä¹ˆå›¾å½¢ã€‚

å¯¹äºä¸€ä¸ªåªæœ‰ä¸¤ä¸ªå±æ€§çš„æ•°æ®ï¼Œä»–çš„å‚æ•°ä¸º \\(\\hat{w} = (\\hat{w\_1}, \\hat{w\_2})\\)ï¼Œç„¶åè®¡ç®—åœ¨å‚æ•°\\(\\hat{w}\\) çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—æ•´ä¸ªæ•°æ®é›†çš„ \\(RSS\\) ï¼šæ•°æ®ç‚¹çš„åæ ‡å°±æ˜¯ \\((\\hat{w}\_1, \\hat{w}\_2)\\)ï¼Œç­‰é«˜çº¿çš„é«˜åº¦å°±æ˜¯ \\(RSS\\)ã€‚

æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸¤ä¸ªå±æ€§ \\(x\_1, x\_2\\) å®ƒä»¬æœ‰ä¸€ä¸ªçº¿æ€§ç»„åˆ \\(y = 0.2 \* x1 + 0.1 \* x2\\) å¾ˆå®¹æ˜“ç›´åˆ° \\(y\\) å’Œ \\(x\_1, x\_2\\) ä¹‹é—´æ˜¯ä¸€ä¸ªçº¿æ€§ç»„åˆå…³ç³»ï¼š

\\\[y = \\left\[\\begin{matrix} x\_1, x\_2\\end{matrix}\\right\] \\cdot \\left\[\\begin{matrix} 0.2 \\\\ 0.1\\end{matrix}\\right\] \\\]

å³æˆ‘ä»¬è¦æ±‚çš„æƒå€¼ \\(\\hat{w} = \\left\[\\begin{matrix} 0.2 \\\\ 0.1\\end{matrix}\\right\]\\) å› ä¸ºå’ŒçœŸå®å€¼ä¸€æ ·ï¼Œæ‰€ä»¥å®ƒå¯¹åº”çš„ \\(RSS\\) ä¸º0ã€‚æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯é’ˆå¯¹ä¸åŒçš„ \\(\\hat{w}\\) çš„å–å€¼å»è®¡ç®—å…¶æ‰€å¯¹åº”çš„ \\(RSS\\) å€¼ã€‚æ¯”å¦‚è¯´ \\(\\hat{w}\\) å–åˆ°ä¸‹é¢å›¾ä¸­çš„æ‰€æœ‰çš„ç‚¹ã€‚ç„¶åå»è®¡ç®—è¿™äº›ç‚¹å¯¹åº”çš„ \\(RSS\\) ï¼Œç„¶åå°† \\(RSS\\) å€¼ä½œä¸ºç­‰é«˜çº¿å›¾ä¸­ç‚¹å¯¹åº”çš„é«˜ï¼Œå†å°† \\(RSS\\) ç›¸åŒçš„ç‚¹è¿æ¥èµ·æ¥å°±æ„æˆäº†ç­‰é«˜çº¿å›¾ã€‚

![.\docs\image\03.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/38f522a96cef42539e041a81fcbb69b1~tplv-k3u1fbpfcp-zoom-1.image)

ä¸‹é¢å°±æ˜¯å…·ä½“çš„ç”Ÿæˆè¿‡ç¨‹ï¼š

*   é¦–å…ˆå…ˆç”Ÿæˆä¸€ä¸ªéšæœºæ•°æ®é›†

    import numpy as np
    from matplotlib import pyplot as plt
    import matplotlib as mpl
    plt.style.use("ggplot")
    
    x1 = np.linspace(0, 20, 20)
    x2 = np.linspace(-10, 10, 20)
    y = .2 * x1 + .1 * x2
    # y æ˜¯ x1 å’Œ x2çš„çº¿æ€§ç»„åˆ æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçº¿æ€§å›å½’è¦æ±‚çš„å‚æ•°ä¸º [0.2, 0.1]
    

    x1:
    array([ 0.        ,  1.05263158,  2.10526316,  3.15789474,  4.21052632,
            5.26315789,  6.31578947,  7.36842105,  8.42105263,  9.47368421,
           10.52631579, 11.57894737, 12.63157895, 13.68421053, 14.73684211,
           15.78947368, 16.84210526, 17.89473684, 18.94736842, 20.        ])
    x2:
    array([-10.        ,  -8.94736842,  -7.89473684,  -6.84210526,
            -5.78947368,  -4.73684211,  -3.68421053,  -2.63157895,
            -1.57894737,  -0.52631579,   0.52631579,   1.57894737,
             2.63157895,   3.68421053,   4.73684211,   5.78947368,
             6.84210526,   7.89473684,   8.94736842,  10.        ])
    

    # å…ˆå°† x1 x2 è¿›è¡Œæ‹¼æ¥
    data = np.vstack((x1, x2)).T
    

    data:
    array([[  0.        , -10.        ],
           [  1.05263158,  -8.94736842],
           [  2.10526316,  -7.89473684],
           [  3.15789474,  -6.84210526],
           [  4.21052632,  -5.78947368],
           [  5.26315789,  -4.73684211],
           [  6.31578947,  -3.68421053],
           [  7.36842105,  -2.63157895],
           [  8.42105263,  -1.57894737],
           [  9.47368421,  -0.52631579],
           [ 10.52631579,   0.52631579],
           [ 11.57894737,   1.57894737],
           [ 12.63157895,   2.63157895],
           [ 13.68421053,   3.68421053],
           [ 14.73684211,   4.73684211],
           [ 15.78947368,   5.78947368],
           [ 16.84210526,   6.84210526],
           [ 17.89473684,   7.89473684],
           [ 18.94736842,   8.94736842],
           [ 20.        ,  10.        ]])
    

    x_max = 0.5
    points = 5000
    xx, yy = np.meshgrid(np.linspace(-x_max, x_max, points), np.linspace(-x_max, x_max, points))
    zz = np.zeros_like(xx)
    for i in range(points):
        for j in range(points):
            beta = np.array([xx[i][j], yy[i][j]]).T
            rss = ((data@beta - y) ** 2).sum()
            zz[i][j] = rss
    plt.contour(xx, yy, zz, levels=30, cmap=plt.cm.Accent, linewidths=1)
    sns.scatterplot(x=[0, 0.2], y=[0, 0.1], s=10)
    plt.text(x=0.2, y=0.1, s=r"$\hat{w}(0.2, 0.1)$", fontdict={"size":8})
    plt.text(x=0, y=0, s=r"$O(0, 0)$", fontdict={"size":8})
    plt.xlim(-.2,.5)
    plt.xlabel(r"$\hat{w}_1$")
    plt.ylabel(r"$\hat{w}_2$")
    plt.show()
    

![.\docs\image\01.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68a1a5959d60407b9da60479f0ec217f~tplv-k3u1fbpfcp-zoom-1.image)

æˆ‘ä»¬æœ€ç»ˆéœ€è¦æ±‚çš„ \\(\\hat{w}\\) æ˜¯ \\((0.2, 0.1)\\) åŒæ—¶æˆ‘ä»¬ä¹Ÿè®¡ç®—äº†å…¶ä»–ä½ç½®å¯¹åº”æ•´ä¸ªæ•°æ®é›†çš„ \\(RSS\\)ã€‚æˆ‘ä¹ˆå®¹æ˜“çœ‹å‡ºç­‰é«˜çº¿éƒ½æ˜¯ä»¥ \\(\\hat{w}(0.2, 0.1)\\) ä¸ºåœ†å¿ƒçš„æ¤­åœ†ï¼Œå¦‚æœéœ€è¦è¯æ˜éœ€è¦ä½¿ç”¨æ•°å­¦è¿›è¡Œä¸¥æ ¼æ¨åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç›´åˆ°å®ƒçš„è½¨è¿¹æ˜¯ä¸€ä¸ªæ¤­åœ†å³å¯ï¼Œè€Œæˆ‘ä»¬çŸ¥é“

\\\[{\\hat{w}\_1^2} +{\\hat{w}\_1^2}\\le C \\\]

\\(||\\hat{w}||\_2^2\\) çš„å–å€¼èŒƒå›´æ˜¯ä¸€ä¸ªåœ†ï¼Œå› ä¸ºåœ¨å²­å›å½’æŸå¤±å‡½æ•°çš„å¼å­ä¸­æœ‰ç€ä¸¤éƒ¨åˆ†ï¼Œå®ƒè¦åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆä»–ä»¬ä¸¤ä¸ªæ›²çº¿çš„äº¤ç‚¹å°±æ˜¯ \\(Ridge\\) çš„æƒé‡çš„å–å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20210415153050039](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6b2ed7d6cba64f33a31591fdde6c2388~tplv-k3u1fbpfcp-zoom-1.image)

æˆ‘ä»¬ä»ä¸Šé¢çš„å›¾å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæœ€ç»ˆä¸¤ä¸ªæƒå€¼çš„å–å€¼ä¸ä¼šä¸º0ï¼ˆå¦‚æœä¸º0ä»–ä»¬çš„äº¤ç‚¹ä¼šåœ¨xæˆ–è€…yè½´ä¸Šï¼‰ï¼Œè€Œæ˜¯ä¼šéšç€æƒå€¼çš„ç¼©å°è€Œä¸æ–­å˜å°ï¼Œå³å›¾ä¸­è“è‰²éƒ¨åˆ†å˜å°ã€‚åŒç†æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ \\(Lasso\\) å›å½’æœ€åŒæ ·çš„äº‹å„¿ï¼š

![image-20210415153435298](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/192fdb63706d422ab4a7e483fc0aab63~tplv-k3u1fbpfcp-zoom-1.image)

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡º \\(Lasso\\) çš„æƒå€¼æ˜¯å¯ä»¥å–åˆ°0çš„ï¼Œæ³¨æ„æ˜¯å¯ä»¥å–åˆ°è€Œä¸æ˜¯ä¸€å®šå–åˆ°ï¼Œå¯ä»¥å–åˆ°å°±è¯´æ˜ï¼Œ\\(Lasso\\) å›å½’å¯ä»¥åœ¨æ•°æ®é›†æœ‰å…±çº¿æ€§çš„æ—¶å€™ï¼Œå¯¹å±æ€§è¿›è¡Œé€‰æ‹©ï¼Œå³è®©æŸäº›å±æ€§å¯¹åº”çš„æƒå€¼ä¸º0ã€‚ä¸Šé¢çš„ç»“è®ºéƒ½æ˜¯åœ¨äºŒç»´æƒ…å†µä¸‹äº§ç”Ÿçš„ï¼Œå¯ä»¥æ¨å¹¿åˆ°é«˜ç»´æ•°æ®ã€‚ä»¥ä¸Šå°±è¯´æ˜äº†åœ¨çº¿æ€§å›å½’ä¸­ \\(Ridge\\) å’Œ \\(Lasso\\) å¯¹æƒå€¼çš„å½±å“ã€‚

ä»¥ä¸Šå°±æ˜¯æœ¬ç¯‡æ–‡ç« çš„æ‰€æœ‰å†…å®¹äº†ï¼Œæˆ‘æ˜¯**LeHung**ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ï¼ï¼ï¼æ›´å¤šç²¾å½©å†…å®¹åˆé›†å¯è®¿é—®é¡¹ç›®ï¼š[https://github.com/Chang-LeHung/CSCore](https://github.com/Chang-LeHung/CSCore)

å…³æ³¨å…¬ä¼—å·ï¼š**ä¸€æ— æ˜¯å¤„çš„ç ”ç©¶åƒ§**ï¼Œäº†è§£æ›´å¤šè®¡ç®—æœºï¼ˆJavaã€Pythonã€è®¡ç®—æœºç³»ç»ŸåŸºç¡€ã€ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼‰çŸ¥è¯†ã€‚