---
layout: post
title: "AndroidæŒæ§WiFiä¸å®Œå…¨æŒ‡å—"
date: "2022-10-22T21:20:04.438Z"
---
AndroidæŒæ§WiFiä¸å®Œå…¨æŒ‡å—
==================

å‰è¨€
--

å¦‚æœæƒ³è¦å¯¹é’ˆå¯¹WiFiçš„æ”»å‡»è¿›è¡Œç›‘æµ‹ï¼Œå°±éœ€è¦å®šæœŸè·å–WiFiçš„è¿è¡ŒçŠ¶æ€ï¼Œä¾‹å¦‚WiFiçš„SSIDï¼ŒWiFiå¼ºåº¦ï¼Œæ˜¯å¦å¼€æ”¾ï¼ŒåŠ å¯†æ–¹å¼ç­‰ä¿¡æ¯ï¼Œåœ¨Androidä¸­é€šè¿‡WiFiManageræ¥å®ç°

WiFiManagerç®€ä»‹
-------------

WiFiManagerè¿™ä¸ªç±»æ˜¯Androidæš´éœ²ç»™å¼€å‘è€…ä½¿ç”¨çš„ä¸€ä¸ªç³»ç»ŸæœåŠ¡ç®¡ç†ç±»ï¼Œå…¶ä¸­åŒ…å«å¯¹WiFiå“åº”çš„æ“ä½œå‡½æ•°ï¼›å…¶éšè—æ‰çš„ç³»ç»ŸæœåŠ¡ç±»ä¸ºIWifiServiceï¼Œè¿™ä¸ªç±»æ˜¯googleç§æœ‰çš„ï¼Œå±äºç³»ç»Ÿå®‰å…¨çº§åˆ«çš„APIç±»  
æˆ‘ä»¬éœ€è¦é€šè¿‡WifiManagerè¿›è¡Œå‡½æ•°æ“ä½œå®ŒæˆUIï¼Œç›‘å¬å¯¹åº”çš„å¹¿æ’­æ¶ˆæ¯ï¼Œä»è€Œå®ç°è·å–WiFiä¿¡æ¯çš„åŠŸèƒ½

### å†…ç½®æ–¹æ³•

æ–¹æ³•

å«ä¹‰

addNetwork(WifiConfiguration config)

é€šè¿‡è·å–åˆ°çš„ç½‘ç»œçš„é“¾æ¥çŠ¶æ€ä¿¡æ¯ï¼Œæ¥åŠ å…¥ç½‘ç»œ

calculateSignalLevel(int rssi , int numLevels)

è®¡ç®—ä¿¡å·çš„ç­‰çº§

compareSignalLevel(int rssiA, int rssiB)

å¯¹ç…§è¿æ¥A å’Œè¿æ¥B

createWifiLock(int lockType, String tag)

åˆ›å»ºä¸€ä¸ªwifi é”ï¼Œé”å®šå½“å‰çš„wifi è¿æ¥

disableNetwork(int netId)

è®©ä¸€ä¸ªç½‘ç»œè¿æ¥å¤±æ•ˆ

disconnect()

æ–­å¼€è¿æ¥

enableNetwork(int netId, Boolean disableOthers)

è¿æ¥ä¸€ä¸ªè¿æ¥

getConfiguredNetworks()

è·å–ç½‘ç»œè¿æ¥çš„çŠ¶æ€

getConnectionInfo()

è·å–å½“å‰è¿æ¥çš„ä¿¡æ¯

getDhcpInfo()

è·å–DHCP çš„ä¿¡æ¯

getScanResulats()

è·å–æ‰«ææ¸¬è¯•çš„ç»“æœ

getWifiState()

è·å–ä¸€ä¸ªwifi æ¥å…¥ç‚¹æ˜¯å¦æœ‰æ•ˆ

isWifiEnabled()

æ¨æ–­ä¸€ä¸ªwifi è¿æ¥æ˜¯å¦æœ‰æ•ˆ

pingSupplicant()

ping ä¸€ä¸ªè¿æ¥ã€‚æ¨æ–­èƒ½å¦è¿é€š

ressociate()

å³ä¾¿è¿æ¥æ²¡æœ‰å‡†å¤‡å¥½ï¼Œä¹Ÿè¦è¿é€š

reconnect()

å‡è®¾è¿æ¥å‡†å¤‡å¥½äº†ï¼Œè¿é€š

removeNetwork()

ç§»é™¤æŸä¸€ä¸ªç½‘ç»œ

saveConfiguration()

ä¿ç•™ä¸€ä¸ªé…ç½®ä¿¡æ¯

setWifiEnabled()

è®©ä¸€ä¸ªè¿æ¥æœ‰æ•ˆ

startScan()

å¼€å§‹æ‰«æ

updateNetwork(WifiConfiguration config)

æ›´æ–°ä¸€ä¸ªç½‘ç»œè¿æ¥çš„ä¿¡æ¯

å…¶ä»–å¸¸ç”¨åŸºç±»
------

### ScanResult

é€šè¿‡wifi ç¡¬ä»¶çš„æ‰«ææ¥è·å–ä¸€äº›å‘¨è¾¹çš„wifi çƒ­ç‚¹çš„ä¿¡æ¯

å­—æ®µ

å«ä¹‰

BSSID

æ¥å…¥ç‚¹çš„åœ°å€ï¼Œè¿™é‡Œä¸»è¦æ˜¯æŒ‡å°èŒƒå›´å‡ ä¸ªæ— çº¿è®¾å¤‡ç›¸è¿æ¥æ‰€è·å–çš„åœ°å€ï¼Œæ¯”å¦‚è¯´ä¸¤å°ç¬”è®°æœ¬é€šè¿‡æ— çº¿ç½‘å¡è¿›è¡Œè¿æ¥ï¼ŒåŒæ–¹çš„æ— çº¿ç½‘å¡åˆ†é…çš„åœ°å€

SSID

ç½‘ç»œçš„åå­—ï¼Œå½“æˆ‘ä»¬æœç´¢ä¸€ä¸ªç½‘ç»œæ—¶ï¼Œå°±æ˜¯é è¿™ä¸ªæ¥åŒºåˆ†æ¯ä¸ªä¸åŒçš„ç½‘ç»œæ¥å…¥ç‚¹

Capabilities

ç½‘ç»œæ¥å…¥çš„æ€§èƒ½ï¼Œè¿™é‡Œä¸»è¦æ˜¯æ¥åˆ¤æ–­ç½‘ç»œçš„åŠ å¯†æ–¹å¼ç­‰

Frequency

é¢‘ç‡ï¼Œæ¯ä¸€ä¸ªé¢‘é“äº¤äº’çš„MHz æ•°

Level

ç­‰çº§ï¼Œä¸»è¦æ¥åˆ¤æ–­ç½‘ç»œè¿æ¥çš„ä¼˜å…ˆæ•°ã€‚

### WifiInfo

WiFiè¿æ¥æˆåŠŸåï¼Œå¯é€šè¿‡WifiInfoç±»è·å–WiFiçš„ä¸€äº›å…·ä½“ä¿¡æ¯

æ–¹æ³•

å«ä¹‰

getBSSID()

è·å–BSSID

getDetailedStateOf()

è·å–clientçš„è¿é€šæ€§

getHiddenSSID()

è·å¾—SSID æ˜¯å¦è¢«éšè—

getIpAddress()

è·å–IP åœ°å€

getLinkSpeed()

è·å¾—è¿æ¥çš„é€Ÿåº¦

getMacAddress()

è·å¾—Mac åœ°å€

getRssi()

è·å¾—802.11n ç½‘ç»œçš„ä¿¡å·

getSSID()

è·å¾—SSID

getSupplicanState() è¿”å›è¯¦ç»†clientçŠ¶æ€çš„ä¿¡æ¯

### wifiConfiguration

WiFiçš„é…ç½®ä¿¡æ¯

ç±»å

å«ä¹‰

WifiConfiguration.AuthAlgorthm

ç”¨æ¥åˆ¤æ–­åŠ å¯†æ–¹æ³•

WifiConfiguration.GroupCipher

è·å–ä½¿ç”¨GroupCipher çš„æ–¹æ³•æ¥è¿›è¡ŒåŠ å¯†

WifiConfiguration.KeyMgmt

è·å–ä½¿ç”¨KeyMgmt è¿›è¡Œ

WifiConfiguration.PairwiseCipher

è·å–ä½¿ç”¨WPA æ–¹å¼çš„åŠ å¯†

WifiConfiguration.Protocol

è·å–ä½¿ç”¨å“ªä¸€ç§åè®®è¿›è¡ŒåŠ å¯†

wifiConfiguration.Status

è·å–å½“å‰ç½‘ç»œçš„çŠ¶æ€

æƒé™
--

app `AndroidManifest.xml` ç”³è¯·æƒé™

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE"/>
    

> Android 6.0ç‰ˆæœ¬ä¸­å¦‚æœæœªå¼€å¯GPSæ˜¯æ— æ³•è·å–åˆ°æ‰«æåˆ—è¡¨çš„ï¼Œéœ€è¦åŠ¨æ€ç”³è¯·ACCESS\_COARSE\_LOCATION

    // æ£€æµ‹é¡¹ç›®æ˜¯å¦è¢«èµ‹äºˆå®šä½æƒé™
        public void checkPermissions(Context context){
            if(ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_FINE_LOCATION)
                    != PackageManager.PERMISSION_GRANTED){//æœªå¼€å¯å®šä½æƒé™
                //å¼€å¯å®šä½æƒé™,200æ˜¯æ ‡è¯†ç 
                ActivityCompat.requestPermissions((Activity) context,new String[]{Manifest.permission.ACCESS_FINE_LOCATION},200);
            }
        }
    

åœ¨è¿è¡Œä¹‹å‰è°ƒç”¨è¯¥å‡½æ•°è¿›è¡Œç”³è¯·å³å¯

ç‰›åˆ€å°è¯•
----

### WiFiçŠ¶æ€åˆ†ç±»

*   ç½‘å¡æ­£åœ¨å…³é—­ WIFI\_STATE\_DISABLING WIFI ( çŠ¶æ€ç ï¼š0 )
*   ç½‘å¡ä¸å¯ç”¨ WIFI\_STATE\_DISABLED WIFI ( çŠ¶æ€ç ï¼š1 )
*   ç½‘å¡æ­£åœ¨æ‰“å¼€ WIFI\_STATE\_ENABLING WIFI ( çŠ¶æ€ç ï¼š2 )
*   ç½‘å¡å¯ç”¨ WIFI\_STATE\_ENABLED WIFI ( çŠ¶æ€ç ï¼š3 )
*   ç½‘å¡çŠ¶æ€ä¸å¯çŸ¥ WIFI\_STATE\_UNKNOWN WIFI ( çŠ¶æ€ç ï¼š4 )

ä»£ç ä¸­è·å–WIFIçš„çŠ¶æ€

    // è·å– WIFI çš„çŠ¶æ€.
    public static int getWifiState(WifiManager manager) {
        return manager == null ? WifiManager.WIFI_STATE_UNKNOWN : manager.getWifiState();
    }
    

### è·å–WiFiManagerå®ä¾‹

    // è·å– WifiManager å®ä¾‹. 
    public static WifiManager getWifiManager(Context context) {
        return context == null ? null : (WifiManager) context.getApplicationContext().getSystemService(Context.WIFI_SERVICE);
    }
    

### å¼€å¯ã€å…³é—­WIFI

    // å¼€å¯/å…³é—­ WIFI.
    public static boolean setWifiEnabled(WifiManager manager, boolean enabled) {
        return manager != null && manager.setWifiEnabled(enabled);
    }
    

### æ‰«æå‘¨å›´çš„WiFi

    // å¼€å§‹æ‰«æ WIFI. 
    public static void startScanWifi(WifiManager manager) {
        if (manager != null) {
            manager.startScan();
        }
    }
    

### è·å–æ‰«æç»“æœ

    // è·å–æ‰«æ WIFI çš„çƒ­ç‚¹: 
    public static List<ScanResult> getScanResult(WifiManager manager) {
        return manager == null ? null : manager.getScanResult();
    }
    

### è·å–å†å²WiFié…ç½®ä¿¡æ¯

    // è·å–å·²ç»ä¿å­˜è¿‡çš„/é…ç½®å¥½çš„ WIFI çƒ­ç‚¹. 
    public static List<WifiConfiguration> getConfiguredNetworks(WifiManager manager) {
        return manager == null ? null : manager.WifiConfiguration();
    }
    

### è·å–å¯¹åº”scanResultçš„é…ç½®ä¿¡æ¯

        List<WifiConfiguration> configs = wifiManager.getMatchingWifiConfig(scanResult);
    
        // å¯ä»¥æ‰“å°ä¸€ä¸‹çœ‹å…·ä½“çš„æƒ…å†µ:
        if (configs == null || configs.isEmpty()) return;
        for (WifiConfiguration config : configs) {
            Log.v(TAG, "config = " + config);
        }
    

### è·å–WIFI MACåœ°å€

    public String getWifiBSSID() {
        return mWifiInfo.getBSSID();
    }
    

### è·å–æœ¬æœºMACåœ°å€

Android Mç‰ˆæœ¬ä¹‹åï¼Œé€šè¿‡`wifiInfo.getMacAddress()`è·å–çš„MACåœ°å€æ˜¯ä¸€ä¸ªå›ºå®šçš„å‡åœ°å€ï¼Œå€¼ä¸º`02:00:00:00:00:00`ï¼Œåœ¨è¿™é‡Œé€šè¿‡`getMacAddress`å‡½æ•°è·å–çœŸå®MAC

    // è·å–æœ¬æœºMACåœ°å€
    // Android Mç‰ˆæœ¬ä¹‹åï¼Œé€šè¿‡wifiInfo.getMacAddress()è·å–çš„MACåœ°å€æ˜¯ä¸€ä¸ªå›ºå®šçš„å‡åœ°å€ï¼Œå€¼ä¸º02:00:00:00:00:00
    public String getSelfMac(){
        String mac=mWifiInfo==null?"null":mWifiInfo.getMacAddress();
        if(TextUtils.equals(mac, "02:00:00:00:00:00")) {
            String temp = getMacAddress();
            if (!TextUtils.isEmpty(temp)) {
                mac = temp;
            }
        }
        return mac;
    }
    
    private static String getMacAddress(){
        String macAddress = "";
        try {
            Enumeration<NetworkInterface> interfaces = NetworkInterface.getNetworkInterfaces();
            while (interfaces.hasMoreElements()) {
                NetworkInterface iF = interfaces.nextElement();
    
                byte[] addr = iF.getHardwareAddress();
                if (addr == null || addr.length == 0) {
                    continue;
                }
    
                StringBuilder buf = new StringBuilder();
                for (byte b : addr) {
                    buf.append(String.format("%02X:", b));
                }
                if (buf.length() > 0) {
                    buf.deleteCharAt(buf.length() - 1);
                }
                String mac = buf.toString();
                //                WifiMonitorLogger.i("mac", "interfaceName="+iF.getName()+", mac="+mac);
                if(TextUtils.equals(iF.getName(), "wlan0")){
                    return mac;
                }
            }
        } catch (SocketException e) {
            e.printStackTrace();
            return macAddress;
        }
    
        return macAddress;
    }
    

### è·å–WIFIçš„ç½‘ç»œé€Ÿåº¦å’Œé€Ÿåº¦å•ä½

    // è·å–å½“å‰è¿æ¥wifiçš„é€Ÿåº¦
    public int getConnWifiSpeed(){
        return mWifiInfo.getLinkSpeed();
    }
    
    // è·å–å½“å‰è¿æ¥wifiçš„é€Ÿåº¦å•ä½
    public String getConnWifiSpeedUnit(){
        return WifiInfo.LINK_SPEED_UNITS;
    }
    

### è·å–å½“å‰è¿æ¥WIFIçš„ä¿¡å·å¼ºåº¦

    // è·å–å½“å‰è¿æ¥wifiçš„ä¿¡å·å¼ºåº¦
    public int getConnWifiLevel(){
        return mWifiManager.calculateSignalLevel(mWifiInfo.getRssi(),5);
    }
    

### è·å–å½“å‰è¿æ¥çš„WIFIçš„åŠ å¯†æ–¹å¼

æœ¬æ¥æˆ‘ä»¥ä¸ºwifiinfoé‡Œé¢åº”è¯¥ä¼šæœ‰è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æœç´¢äº†ä¸€ä¸‹ä¹‹åå‘ç° [å¦‚ä½•åœ¨ä¸æ‰«ææ‰€æœ‰wifiç½‘ç»œçš„æƒ…å†µä¸‹è·å–å½“å‰wifiè¿æ¥çš„åŠ å¯†ç±»å‹ï¼Ÿ](https://mlog.club/article/1722867)  
çœ‹æ¥è¿˜æ˜¯éœ€è¦éå†scanresultsï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶SSIDå®¹æ˜“é‡å¤ï¼Œæ‰€ä»¥ç”¨WIFI BSSIDæ¥å”¯ä¸€ç¡®å®š

    // è·å–å½“å‰WIFIè¿æ¥çš„åŠ å¯†æ–¹å¼
    // capabilitiesçš„æ ¼å¼æ˜¯ [è®¤è¯æ ‡å‡†+ç§˜é’¥ç®¡ç†+åŠ å¯†æ–¹æ¡ˆ]
    public String getConnCap(){
        String currentBSSID=mWifiInfo.getBSSID();
        for(ScanResult result:scanResultList){
            //            WifiMonitorLogger.i(currentBSSID+":"+result.BSSID);
            if(currentBSSID.equals(result.BSSID)){
                return result.capabilities;
            }
        }
        return "null";
    }
    

å¦å¤–è¿”å›çš„capabilitiesæ ¼å¼ä¸€èˆ¬ä¸º`[è®¤è¯æ ‡å‡†+ç§˜é’¥ç®¡ç†+åŠ å¯†æ–¹æ¡ˆ]`ï¼Œæ‰€ä»¥çœ‹åˆ°çš„æ—¶å€™ä¸ç”¨å¤ªæ…Œå¼   
å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥åˆ¤å®šåŠ å¯†

    static final int SECURITY_NONE = 0;
    static final int SECURITY_WEP = 1;
    static final int SECURITY_PSK = 2;
    static final int SECURITY_EAP = 3;
    
    private int getType(ScanResult result) {
        if (result == null) {
            return SECURITY_NONE;
        }
        String capbility = result.capabilities;
        if (capbility == null || capbility.isEmpty()) {
            return SECURITY_NONE;
        }
        // å¦‚æœåŒ…å«WAP-PSKçš„è¯ï¼Œåˆ™ä¸ºWAPåŠ å¯†æ–¹å¼
        if (capbility.contains("WPA-PSK") || capbility.contains("WPA2-PSK")) {
            return SECURITY_PSK;
        } else if (capbility.contains("WPA2-EAP")) {
            return SECURITY_EAP;
        } else if (capbility.contains("WEP")) {
            return SECURITY_WEP;
        } else if (capbility.contains("ESS")) {
            // å¦‚æœæ˜¯ESSåˆ™æ²¡æœ‰å¯†ç 
            return SECURITY_NONE;
        }
        return SECURITY_NONE;
    }
    

### JAVAä»£ç è¿æ¥WiFi

Androidæä¾›äº†ä¸¤ç§æ–¹å¼è¿æ¥WiFiï¼š

*   é€šè¿‡é…ç½®è¿æ¥
*   é€šè¿‡networkIdè¿æ¥

å°è£…åçš„å‡½æ•°å¦‚ä¸‹

    // ä½¿ç”¨ WifiConfiguration è¿æ¥. 
    public static void connectByConfig(WifiManager manager, WifiConfiguration config) {
        if (manager == null) {
            return;
        }
        try {
            Method connect = manager.getClass().getDeclaredMethod("connect", WifiConfiguration.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
            if (connect != null) {
                connect.setAccessible(true);
                connect.invoke(manager, config, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
        
    // ä½¿ç”¨ networkId è¿æ¥. 
    public static void connectByNetworkId(WifiManager manager, int networkId) {
        if (manager == null) {
            return;
        }
        try {
            Method connect = manager.getClass().getDeclaredMethod("connect", int.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
            if (connect != null) {
                connect.setAccessible(true);
                connect.invoke(manager, networkId, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    

### ä¿å­˜ç½‘ç»œ

    // ä¿å­˜ç½‘ç»œ. 
    public static void saveNetworkByConfig(WifiManager manager, WifiConfiguration config) {
        if (manager == null) {
            return;
        }
        try {
            Method save = manager.getClass().getDeclaredMethod("save", WifiConfiguration.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
            if (save != null) {
                save.setAccessible(true);
                save.invoke(manager, config, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    

### æ·»åŠ ç½‘ç»œ

    // æ·»åŠ ç½‘ç»œ. 
    public static int addNetwork(WifiManager manager, WifiConfiguration config) {
        if (manager != null) {
            manager.addNetwork(config);
        }
    }
    

### å¿˜è®°ç½‘ç»œ

    // å¿˜è®°ç½‘ç»œ.
    public static void forgetNetwork(WifiManager manager, int networkId) {
        if (manager == null) {
            return;
        }
        try {
            Method forget = manager.getClass().getDeclaredMethod("forget", int.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
            if (forget != null) {
                forget.setAccessible(true);
                forget.invoke(manager, networkId, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    

### ç¦ç”¨ç½‘ç»œ

    // ç¦ç”¨ç½‘ç»œ. 
    public static void disableNetwork(WifiManager manager, int netId) {
        if (manager == null) {
            return;
        }
        try {
            Method disable = manager.getClass().getDeclaredMethod("disable", int.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
            if (disable != null) {
                disable.setAccessible(true);
                disable.invoke(manager, networkId, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    

### æ–­å¼€è¿æ¥

    // æ–­å¼€è¿æ¥. 
    public static boolean disconnectNetwork(WifiManager manager) {
        return manager != null && manager.disconnect();
    }
    

### çŸ­æš‚ç¦ç”¨ç½‘ç»œ

    // ç¦ç”¨çŸ­æš‚ç½‘ç»œ.
    public static void disableEphemeralNetwork(WifiManager manager, String SSID) {
        if (manager == null || TextUtils.isEmpty(SSID)) 
            return;
            try {
            Method disableEphemeralNetwork = manager.getClass().getDeclaredMethod("disableEphemeralNetwork", String.class);
            if (disableEphemeralNetwork != null) {
                disableEphemeralNetwork.setAccessible(true);
                disableEphemeralNetwork.invoke(manager, SSID);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    

ç›‘æ§WIFIå˜åŒ–
--------

æˆ‘ä»¬å¾ˆæœ‰å¯èƒ½ä¼šæœ‰è¿™æ ·çš„éœ€æ±‚ï¼š`åœ¨WIFIæ–­å¼€æˆ–è€…è¿æ¥çš„æ—¶å€™ï¼Œå°†å½“å‰çš„WIFIæ•°æ®ä¿å­˜ä¸‹æ¥`  
äº‹å®ä¸ŠAndroidä¸­WIFIå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¼šå‘é€å¹¿æ’­ï¼Œæˆ‘ä»¬åªéœ€è¦ç›‘å¬ç³»ç»Ÿä¸­å‘é€çš„WIFIå˜åŒ–çš„å¹¿æ’­å°±å¯ä»¥å®ç°ç›¸å…³çš„åŠŸèƒ½äº†

### å¼€å¯æƒé™

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    

### æ³¨å†Œç›‘å¬å¹¿æ’­

æˆ‘ä»¬å…ˆä½¿ç”¨åŠ¨æ€æ³¨å†Œç½‘ç»œçŠ¶æ€çš„ç›‘å¬å¹¿æ’­

> PSï¼šæ³¨å†Œç›‘å¬æœ‰ä¸¤ç§æ–¹å¼ï¼Œæ— è®ºä½¿ç”¨å“ªç§æ³¨å†Œæ–¹å¼å‡éœ€è¦åœ¨AndroidMainestæ¸…å•æ–‡ä»¶é‡Œé¢è¿›è¡Œæ³¨å†Œ

*   é™æ€æ³¨å†Œ

> ä¹Ÿå°±æ˜¯è¯´åœ¨AndroidManifestæ–‡ä»¶ä¸­å¯¹BroadcastReceiverè¿›è¡Œæ³¨å†Œï¼Œé€šå¸¸è¿˜ä¼šåŠ ä¸Šactionç”¨æ¥è¿‡æ»¤ï¼›æ­¤æ³¨å†Œæ–¹å¼å³ä½¿é€€å‡ºåº”ç”¨åï¼Œä»ç„¶èƒ½å¤Ÿæ”¶åˆ°ç›¸åº”çš„å¹¿æ’­

*   åŠ¨æ€æ³¨å†Œ

> è°ƒç”¨Contextä¸­çš„registerReceiverå¯¹å¹¿æ’­è¿›è¡ŒåŠ¨æ€æ³¨å†Œï¼Œä½¿ç”¨unRegisterReceiveræ–¹æ³•å¯¹å¹¿æ’­è¿›è¡Œå–æ¶ˆæ³¨å†Œçš„æ“ä½œï¼›æ•…æ­¤æ³¨å†Œæ–¹å¼ä¸€èˆ¬éƒ½æ˜¯éšç€æ‰€åœ¨çš„Activityæˆ–è€…åº”ç”¨é”€æ¯ä»¥åï¼Œä¸ä¼šå†æ”¶åˆ°è¯¥å¹¿æ’­

åŠ¨æ€æ³¨å†Œçš„ä»£ç å¦‚ä¸‹

    @Override
    protected void onStart() {
        super.onStart();
        IntentFilter filter = new IntentFilter();
        filter.addAction(WifiManager.WIFI_STATE_CHANGED_ACTION);
    
        registerReceiver(NetworkReceiver.getInstance(),filter);
    }
    

ç„¶åå†™å…·ä½“çš„`NetworkReceiver`

    import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.Intent;
    import android.net.ConnectivityManager;
    import android.net.NetworkCapabilities;
    import android.net.NetworkInfo;
    import android.net.wifi.WifiManager;
    import android.os.Build;
    import android.widget.Toast;
    
    import static android.net.wifi.WifiManager.WIFI_STATE_DISABLED;
    import static android.net.wifi.WifiManager.WIFI_STATE_ENABLED;
    import static android.net.wifi.WifiManager.WIFI_STATE_UNKNOWN;
    
    /**
     * @author panyi
     * @date 2022/8/23
     * å¹¿æ’­æ¥æ”¶å™¨ ç”¨æ¥ç›‘å¬WIFIçš„å˜åŒ–
     */
    public class NetworkReceiver extends BroadcastReceiver {
    
        private volatile static NetworkReceiver sInstance;
    
    
        public NetworkReceiver(){}
    
        public static NetworkReceiver getInstance(){
            if (sInstance == null) {
                synchronized (NetworkReceiver.class) {
                    if (sInstance == null) {
                        sInstance = new NetworkReceiver();
                    }
                }
            }
            return sInstance;
        }
    
    
        // WIFIè¿æ¥çŠ¶æ€æ”¹å˜çš„ç›‘å¬
        @Override
        public void onReceive(Context context, Intent intent) {
            String action=intent.getAction();
            if(action==WifiManager.WIFI_STATE_CHANGED_ACTION){
                switch(intent.getIntExtra(WifiManager.EXTRA_WIFI_STATE, WIFI_STATE_UNKNOWN)){
                    case WIFI_STATE_ENABLED :// WIFIè¿æ¥
                        Toast.makeText(context, "WiFi enabled", Toast.LENGTH_SHORT).show();
                        break;
                    case WIFI_STATE_DISABLED:// WIFIæ–­å¼€
                        Toast.makeText(context, "WiFi disabled", Toast.LENGTH_SHORT).show();
                        break;
                }
            }
        }
    }
    

ç»§æ‰¿`BroadcastReceiver`å¹¿æ’­ç›‘å¬ç±»ä¹‹åé‡å†™`onReceive`æ–¹æ³•ï¼Œæ ¹æ®ç›‘å¬åˆ°çš„ä¸åŒå†…å®¹è¿›è¡Œå…·ä½“éœ€æ±‚çš„ä¿®æ”¹å³å¯

æœ€åï¼Œéšç€Androidç‰ˆæœ¬çš„ä¸æ–­è¿­ä»£ï¼Œä¸Šè¿°çš„æ–¹æ³•ä¹Ÿè®¸åœ¨ä»Šåçš„æŸä¸ªæ—¶å€™å°±ä¸é€‚ç”¨äº†ï¼Œå¦‚æœåˆ°äº†è¿™ä¸ªæ—¶å€™ï¼Œå°±å»å®˜æ–¹æ–‡æ¡£é‡Œé¢å»å¯»æ‰¾ç­”æ¡ˆå§ ğŸ˜„  
[https://developer.android.com/docs?hl=zh-cn](https://developer.android.com/docs?hl=zh-cn)

å‚è€ƒé“¾æ¥
----

*   [Android wifi è®¾ç½®ç›¸å…³](https://coderminer.github.io/2016/11/21/wifi/)
*   [Android WIFI æ¨¡å—è§£æ(1) - æ˜é‡‘](https://juejin.cn/post/7070434132731363365)
*   [Androidè¿›é˜¶ä¹‹è·¯ - WiFiçš„å…¨é¢ä½¿ç”¨ - æ˜é‡‘](https://juejin.cn/post/7011004958514511879)
*   [Androidå¼€å‘--WIFIå®ç°\_ä¸€å¶é£˜èˆŸçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/jdsjlzx/article/details/40740543)
*   [WifiManager - Androidä¸­æ–‡ç‰ˆ - APIå‚è€ƒæ–‡æ¡£](https://www.apiref.com/android-zh/android/net/wifi/WifiManager.html)
*   [Android WiFiå¼€å‘ ï¼ˆä¸€ï¼‰æ‰«æã€è¿æ¥ã€ä¿¡æ¯\_VNanyesheshouçš„åšå®¢-CSDNåšå®¢\_android wifiæ‰«æè¿æ¥](https://blog.csdn.net/VNanyesheshou/article/details/50771698)
*   [Androidä¸­wifiç®¡ç†å™¨WifiManagerä½¿ç”¨æ–¹æ³•\_æ·¼æ£®007çš„åšå®¢-CSDNåšå®¢\_android wifimanager](https://blog.csdn.net/weixin_38322371/article/details/119761029)
*   [Android-WiFiå¼€å‘ä¹‹ WifiManager](https://www.jianshu.com/p/67aaf1fdb921)
*   [Androidè·å–æœ¬æœºWiFi MAC Addressä¹‹å‘](http://ysuiboli.github.io/android/wifi/mac/2017/05/05/Android%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAWiFi-MAC-Address%E4%B9%8B%E5%9D%91.html)
*   [Android WIFIè®¤è¯æ–¹å¼\_æŸšå­å›ä¸‹çš„åšå®¢-CSDNåšå®¢\_android wifi è®¤è¯](https://blog.csdn.net/weixin_43662090/article/details/122776234)
*   [Android WIFIåŠŸèƒ½â€”â€”WifiManager](http://haichenyi.com/2018/03/05/Android-WIFI%E5%8A%9F%E8%83%BD%E2%80%94%E2%80%94WifiManager/)
*   [Androidè¿›é˜¶ä¹‹è·¯ - å®æ—¶ç›‘å¬ç½‘ç»œçŠ¶æ€ - æ˜é‡‘](https://juejin.cn/post/7011004836590288933)
*   [Android â€”â€” WIFIçŠ¶æ€ç›¸å…³çš„ç³»ç»Ÿå¹¿æ’­\_æ²ƒå…‹å“ˆå¾·ä¸¶çš„åšå®¢-CSDNåšå®¢\_android wifiç›¸å…³çš„å¹¿æ’­](https://blog.csdn.net/zhang5690800/article/details/54629544)
*   [WiFiå¼€å‘ï¼ˆä¸€ï¼‰--WiFiå¼€å…³ä¸çŠ¶æ€ç›‘å¬](https://biloba123.github.io/2017/10/22/WiFi%E5%BC%80%E5%8F%91%EF%BC%88%E4%B8%80%EF%BC%89--WiFi%E5%BC%80%E5%85%B3%E4%B8%8E%E7%8A%B6%E6%80%81%E7%9B%91%E5%90%AC/)
*   [https://www.jianshu.com/p/16d4ff4c4cbe](https://www.jianshu.com/p/16d4ff4c4cbe)

END
---

å»ºäº†ä¸€ä¸ªå¾®ä¿¡çš„å®‰å…¨äº¤æµç¾¤ï¼Œæ¬¢è¿æ·»åŠ æˆ‘å¾®ä¿¡å¤‡æ³¨`è¿›ç¾¤`ï¼Œä¸€èµ·æ¥èŠå¤©å¹æ°´å“‡ï¼Œä»¥åŠä¸€ä¸ªä¼šå‘å¸ƒå®‰å…¨ç›¸å…³å†…å®¹çš„å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨ ğŸ˜ƒ

![GIF](https://springbird.oss-cn-beijing.aliyuncs.com/img/mmqrcode1632325540724.png) ![GIF](https://springbird.oss-cn-beijing.aliyuncs.com/img/qrcode_for_gh_cead8e1080d6_344.jpg)