---
layout: post
title: "【Java面试】TCP协议为什么要设计三次握手？"
date: "2022-06-16T03:25:13.886Z"
---
【Java面试】TCP协议为什么要设计三次握手？
========================

> 一个工作5年的粉丝，最近去面试了很多公司，每次都被各种技术原理题问得语无伦次。
> 
> 由于找了快1个月时间的工作，有点焦虑，来向我求助。
> 
> 我能做的只是保证每天更新一个面试题，然后问他印象最深刻的一个面试题是什么，他说。
> 
> “TCP协议为什么要设计三次握手”。
> 
> 好的，关于这个问题，我们来看看普通人和高手的回答。

普通人：
----

我认为就是因为TCP它是一个双工协议，双工协议就是意味着它可以双向去进行数据传输。

那么既然是数据双向传输的话，那么意味着我两端都是建立一个通信连接。两端都是彼此之间双向建立连接。所有相当于说A要像B建立连接，B要像A建立连接，这两个之间就是两次。

在加上在这个建立连接过程中我还需要确认这个连接是不是建立成功。所以在客户端发送给服务端建立连接的时候需要给个回应。

高手：
---

关于这个问题，我会从下面3个方面来回答。

1.  TCP协议，是一种可靠的，基于字节流的，面向连接的传输层协议。
    
    *   可靠性体现在TCP协议通信双方的数据传输是稳定的，即便是在网络不好的情况下，TCP都能够保证数据传输到目标端，而这个可靠性是基于数据包确认机制来实现的。
        
    *   TCP通信双方的数据传输是通过字节流来实现传输的
        
    *   面向连接，是说数据传输之前，必须要建立一个连接，然后基于这个连接进行数据传输
        
2.  因为TCP是面向连接的协议，所以在进行数据通信之前，需要建立一个可靠的连接，TCP采用了三次握手的方式来实现连接的建立。
    
    所谓的三次握手，就是通信双方一共需要发送三次请求，才能确保这个连接的建立。
    
    *   客户端向服务端发送连接请求并携带同步序列号SYN。
    *   服务端收到请求后，发送SYN和ACK， 这里的SYN表示服务端的同步序列号，ACK表示对前面收到请求的一个确认，表示告诉客户端，我收到了你的请求。
    *   客户端收到服务端的请求后，再次发送ACK，这个ACK是针对服务端连接的一个确认，表示告诉服务端，我收到了你的请求。
    
    ![image-20220429145741731](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220616110532471-1918768407.png)
    
3.  之所以TCP要设计三次握手，我认为有三个方面的原因：
    
    *   TCP是可靠性通信协议，所以TCP协议的通信双方都必须要维护一个序列号，去标记已经发送出去的数据包，哪些是已经被对方签收的。而三次握手就是通信双方相互告知序列号的起始值，为了确保这个序列号被收到，所以双方都需要有一个确认的操作。
    *   TCP协议需要在一个不可靠的网络环境下实现可靠的数据传输，意味着通信双方必须要通过某种手段来实现一个可靠的数据传输通道，而三次通信是建立这样一个通道的最小值。当然还可以四次、五次，只是没必要浪费这个资源。
    *   防止历史的重复连接初始化造成的混乱问题，比如说在网络比较差的情况下，客户端连续多次发送建立连接的请求，假设只有两次握手，那么服务端只能选择接受或者拒绝这个连接请求，但是服务端不知道这次请求是不是之前因为网络堵塞而过期的请求，也就是说服务端不知道当前客户端的连接是有效还是无效。

以上就是我对这个问题的理解。

总结
--

网络通信这块内容还是比较重要的，面对一些线上网络故障排查的时候，

可以快速的去帮助我们定位问题，并找到解决办法。

如果有任何面试问题、职业发展问题、学习问题，都可以私信我，另还有Java面试资料和简历模板可以免费领取。

![file](http://mic-blob-bucket.oss-cn-beijing.aliyuncs.com/27872_8367351C101A4644AD2C12220AB44A34)

> 版权声明：本博客所有文章除特别声明外，均采用 CC BY-NC-SA 4.0 许可协议。转载请注明来自 `Mic带你学架构`！  
> 如果本篇文章对您有帮助，还请帮忙点个关注和赞，您的坚持是我不断创作的动力。欢迎关注「跟着Mic学架构」公众号公众号获取更多技术干货！

![](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220616110533213-2085608617.png)