---
layout: post
title: "C#.NET ORM å¦‚ä½•è®¿é—® Access æ•°æ®åº“ [FreeSql]"
date: "2022-09-27T02:07:09.522Z"
---
C#.NET ORM å¦‚ä½•è®¿é—® Access æ•°æ®åº“ \[FreeSql\]
======================================

* * *

æœ€è¿‘å¾ˆå¤š .net QQ ç¾¤æ— æ•…è¢«å°åœï¼Œç‰¹åˆ«æ˜¯ wpf ç¾¤å‡ ä¹å…¨å†›è¦†æ²¡ã€‚ä¾ä¹ç¥çš„ .net6äº¤æµç¾¤ï¼Œæ™“æ™¨çš„ .netè·¨å¹³å°äº¤æµç¾¤ï¼Œå¯¼è‡´å¾ˆå¤šç å‹æµç¦»å¤±æ‰€æ— å®¶å¯å½’ï¼Œå€Ÿæ­¤æœºä¼šä½¿ç”¨ä¸€æ¬¡å¬å”¤æœ¯ï¼Œæœ‰éœ€è¦çš„è¯·åŠ ç¾¤ï¼š560611514ã€.NET C#çˆ±å¥½è€…ã€‘ï¼Œ6406277ã€C#/.Net Coreç¤¾åŒºã€‘ï¼Œ822074314ã€DotNetå¼€å‘äº¤æµç¾¤ã€‘

ğŸ’» å‰è¨€
=====

çœ‹åˆ°æ ‡é¢˜ç‚¹è¿›æ¥ï¼Œä¹Ÿè®¸æœ‰äººé—®ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ mysqlï¼Œä¸ºä»€ä¹ˆä¸ç”¨ sqliteï¼Œä¸ºä»€ä¹ˆä¸è¿™æ ·é‚£æ ·ã€‚

å…¶å®æœ‰æ—¶å€™æƒ…éå¾—å·²ï¼Œè¢«è¿«ä½¿ç”¨ä¸ç”±å¾—è‡ªå·±é€‰æ‹©ï¼Œæ²¡æœ‰è°å¤©å¤©åšæ–°é¡¹ç›®ï¼Œæ–°é¡¹ç›®å½“ç„¶ä¸ä¼šé€‰ Access æ•°æ®åº“ï¼Œå¤æ‚çš„ä¸šåŠ¡ç¾¤ä½“å¯¹æ–¹å‘é€è¿‡æ¥çš„æ–‡ä»¶æ˜¯ Access ä¹Ÿæ²¡å¾—é€‰ï¼Œéš¾é“å¯ä»¥è¦æ±‚å¯¹æ–¹å…¬å¸æ¢æ•°æ®åº“ï¼Ÿ

Microsoft Office Accessæ˜¯ç”±å¾®è½¯å‘å¸ƒçš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å®ƒç»“åˆäº† MicrosoftJet Database Engine å’Œ å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸¤é¡¹ç‰¹ç‚¹ï¼Œæ˜¯ Microsoft Office çš„ç³»ç»Ÿç¨‹åºä¹‹ä¸€ã€‚

Microsoft Office Accessæ˜¯å¾®è½¯æŠŠæ•°æ®åº“å¼•æ“çš„å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œè½¯ä»¶å¼€å‘å·¥å…·ç»“åˆåœ¨ä¸€èµ·çš„ä¸€ä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å®ƒæ˜¯å¾®è½¯OFFICEçš„ä¸€ä¸ªæˆå‘˜, åœ¨åŒ…æ‹¬ä¸“ä¸šç‰ˆå’Œæ›´é«˜ç‰ˆæœ¬çš„officeç‰ˆæœ¬é‡Œé¢è¢«å•ç‹¬å‡ºå”®ã€‚2018å¹´9æœˆ25æ—¥,æœ€æ–°çš„å¾®è½¯Office Access 2019åœ¨å¾®è½¯Office 2019é‡Œå‘å¸ƒã€‚

MS ACCESSä»¥å®ƒè‡ªå·±çš„æ ¼å¼å°†æ•°æ®å­˜å‚¨åœ¨åŸºäºAccess Jetçš„æ•°æ®åº“å¼•æ“é‡Œã€‚å®ƒè¿˜å¯ä»¥ç›´æ¥å¯¼å…¥æˆ–è€…é“¾æ¥æ•°æ®(è¿™äº›æ•°æ®å­˜å‚¨åœ¨å…¶ä»–åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“)ã€‚

* * *

ğŸŒ³ C#.NET è®¿é—® Access æ•°æ®åº“
=======================

ä» .NETframework 1.0 åˆ°ç°ä»Šçš„ dotnet-7.0ï¼Œè®¿é—® Access æ•°æ®åº“éƒ½åªèƒ½ç”¨ oledb æ–¹å¼ï¼Œå¾®è½¯å†å²è®¿é—®æ•°æ®åº“çš„æ–¹å¼æœ‰è®¸å¤šç§(adoã€odbcã€oledbã€ado.net)ï¼Œoledb æ˜¯å…¶ä¸­çš„ä¸€ç§ã€‚

è¿æ¥å­—ç¬¦ä¸²å¸¸è§çš„æœ‰ä¸¤ç§ï¼š

*   Provider=Microsoft.Jet.OleDb.4.0;Data Source=d:/accdb/2003.mdb
    
*   Provider=Microsoft.ACE.OLEDB.12.0;Data Source=d:/accdb/2007.accdb
    

Access æ”¯æŒ SQL è¯­å¥ï¼Œä½¿ç”¨èµ·æ¥å’Œæ™®é€šå…³ç³»å‹æ•°æ®åº“å·®ä¸å¤šï¼Œç”±äºä¸æƒ³åœ¨ä»£ç ä¸­å†™ SQLï¼Œä¸ºäº†è®© crud æ“ä½œèµ·æ¥æ›´åŠ ä¾¿åˆ©ï¼Œå†³å®šå¼•å…¥ C#.NET ORM Freesqlï¼Œå› ä¸ºä»–æ”¯æŒ .NETFramework 4.0 åŠä»¥åçš„æ‰€æœ‰ dotnet ç‰ˆæœ¬ï¼Œé€‚åº”èŒƒå›´æ›´å¹¿ã€‚

* * *

ğŸ¦„ FreeSql ä»‹ç»
=============

.NET ORM Object Relational Mapping æ˜¯ä¸€ç§ä¸ºäº†è§£å†³é¢å‘å¯¹è±¡ä¸å…³ç³»æ•°æ®åº“å­˜åœ¨çš„äº’ä¸åŒ¹é…çš„ç°è±¡çš„æŠ€æœ¯ã€‚

FreeSql .NET ORM æ”¯æŒ .NetFramework4.0+ã€.NetCoreã€Xamarinã€MAUIã€Blazorã€ä»¥åŠè¿˜æœ‰è¯´ä¸å‡ºæ¥çš„è¿è¡Œå¹³å°ï¼Œå› ä¸ºä»£ç **ç»¿è‰²æ— ä¾èµ–**ï¼Œæ”¯æŒæ–°å¹³å°éå¸¸ç®€å•ã€‚ç›®å‰å•å…ƒæµ‹è¯•æ•°é‡ï¼š8500+ï¼ŒNugetä¸‹è½½æ•°é‡ï¼š1M+ã€‚ä½¿ç”¨æœ€å®½æ¾çš„å¼€æºåè®® MIT [https://github.com/dotnetcore/FreeSql](https://github.com/dotnetcore/FreeSql) ï¼Œå¯ä»¥å•†ç”¨ï¼Œæ–‡æ¡£é½å…¨ï¼Œç”šè‡³æ‹¿å»å–é’±ä¹Ÿå¯ä»¥ã€‚

FreeSql ä¸»è¦ä¼˜åŠ¿åœ¨äºæ˜“ç”¨æ€§ä¸Šï¼ŒåŸºæœ¬æ˜¯å¼€ç®±å³ç”¨ï¼Œåœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´åˆ‡æ¢å…¼å®¹æ€§æ¯”è¾ƒå¥½ï¼Œæ•´ä½“çš„åŠŸèƒ½ç‰¹æ€§å¦‚ä¸‹ï¼š

*   æ”¯æŒ CodeFirst å¯¹æ¯”ç»“æ„å˜åŒ–è¿ç§»ã€DbFirst ä»æ•°æ®åº“ç”Ÿæˆå®ä½“ç±»ï¼›
*   æ”¯æŒ ä¸°å¯Œçš„è¡¨è¾¾å¼å‡½æ•°ï¼Œç‹¬ç‰¹çš„è‡ªå®šä¹‰è§£æï¼›
*   æ”¯æŒ æ‰¹é‡æ·»åŠ ã€æ‰¹é‡æ›´æ–°ã€BulkCopyã€å¯¼èˆªå±æ€§ï¼Œè´ªå©ªåŠ è½½ã€å»¶æ—¶åŠ è½½ã€çº§è”ä¿å­˜ã€çº§è”åˆ é™¤ï¼›
*   æ”¯æŒ è¯»å†™åˆ†ç¦»ã€åˆ†è¡¨åˆ†åº“ï¼Œç§Ÿæˆ·è®¾è®¡ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ï¼›
*   æ”¯æŒ MySql/SqlServer/PostgreSQL/Oracle/Sqlite/Firebird/è¾¾æ¢¦/ç¥é€š/äººå¤§é‡‘ä»“/ç¿°é«˜/Clickhouse/MsAccess Ado.net å®ç°åŒ…ï¼Œä»¥åŠ Odbc çš„ä¸“é—¨å®ç°åŒ…ï¼›

8000+ä¸ªå•å…ƒæµ‹è¯•ä½œä¸ºåŸºè°ƒï¼Œæ”¯æŒ10å¤šæ•°æ•°æ®åº“ï¼Œæˆ‘ä»¬æä¾›äº†é€šç”¨Odbcç†è®ºä¸Šæ”¯æŒæ‰€æœ‰æ•°æ®åº“ï¼Œç›®å‰å·²çŸ¥æœ‰ç¾¤å‹ä½¿ç”¨ FreeSql æ“ä½œåä¸ºé«˜æ–¯ã€mycatã€tidb ç­‰æ•°æ®åº“ã€‚å®‰è£…æ—¶åªéœ€è¦é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“å®ç°åŒ…ï¼š

> dotnet add packages FreeSql.Provider.MsAccess

    public class DB
    {
        static Lazy<IFreeSql> accessLazy = new Lazy<IFreeSql>(() => new FreeSql.FreeSqlBuilder()
            .UseConnectionString(FreeSql.DataType.MsAccess, "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=d:/accdb/2007.accdb")
            //.UseAutoSyncStructure(true) è‡ªåŠ¨å»ºè¡¨ï¼Œé€‚åˆæ–°é¡¹ç›®
            .UseNoneCommandParameter(true)
            .UseMonitorCommand(cmd => Trace.WriteLine(cmd.CommandText))
            .Build());
        public static IFreeSql access => accessLazy.Value;
    }
    

å®šä¹‰ DB.cs ç±»ä¹‹åå°±å¯ä»¥å¿«ä¹çš„ CRUD äº†ã€‚FreeSql æä¾›å¤šç§ CRUD ä½¿ç”¨ä¹ æƒ¯ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å›¢é˜Ÿåˆé€‚çš„ä¸€ç§ï¼š

*   è¦ä¹ˆ FreeSqlï¼ŒåŸå§‹ç”¨æ³•ï¼›
*   è¦ä¹ˆ FreeSql.Repositoryï¼Œä»“å‚¨ + å·¥ä½œå•å…ƒä¹ æƒ¯ï¼›
*   è¦ä¹ˆ FreeSql.DbContextï¼Œå¾ˆåƒ EFCore çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œå…¼å®¹ EFCore 99% çš„å®ä½“æ³¨è§£ï¼›
*   è¦ä¹ˆ FreeSql.BaseEntityï¼Œå……è¡€æ¨¡å¼ï¼›
*   è¦ä¹ˆ ç›´æ¥åƒ dapper é‚£æ ·ä½¿ç”¨ SqlConnection æ‰©å±•æ–¹æ³•ï¼›

* * *

âš¡ CRUD æ¨¡å¼ä¸€ï¼šåŸå§‹ç”¨æ³• API
-------------------

    DB.access.Select<T>(); //æŸ¥è¯¢
    DB.access.Insert<T>(); //æ’å…¥
    DB.access.Update<T>(); //æ›´æ–°
    DB.access.Delete<T>(); //åˆ é™¤
    DB.access.InsertOrUpdate<T>()// æ’å…¥æˆ–æ›´æ–°
    DB.access.Transaction(..); //äº‹åŠ¡
    
    DB.access.CodeFirst; //CodeFirst å¯¹è±¡
    DB.access.DbFirst; //DbFirst å¯¹è±¡
    DB.access.Ado; //Ado å¯¹è±¡
    DB.access.Aop; //Aop å¯¹è±¡
    DB.access.GlobalFilter; //å…¨å±€è¿‡æ»¤å™¨å¯¹è±¡
    
    
    var blogs = DB.access.Select<Blog>()
        .Where(b => b.Rating > 3)
        .OrderBy(b => b.Url)
        .Page(2, 10)
        .ToList();
    
    var blog = new Blog { Url = "http://sample.com" };
    blog.BlogId = (int)DB.access.Insert(blog).ExecuteIdentity();
    
    DB.access.Update<Blog>()
        .Set(b => b.Url, "http://sample2222.com")
        .Where(b => b.Url == "http://sample.com")
        .ExecuteAffrows();
    
    DB.access.Delete<Blog>()
        .Where(b => b.Url == "http://sample.com")
        .ExecuteAffrows();
    
    // ç­‰ç­‰ç­‰ã€‚ã€‚çº§è”ä¿å­˜ã€çº§è”æŸ¥è¯¢ã€å¯¼èˆªå±æ€§ã€‚ã€‚ã€‚
    

* * *

â›³ CRUD æ¨¡å¼äºŒï¼šä»“å‚¨ + å·¥ä½œå•å…ƒ
--------------------

FreeSql.Repository ä½œä¸ºæ‰©å±•ï¼Œå®ç°äº†é€šç”¨ä»“å‚¨å±‚åŠŸèƒ½ã€‚ä¸å…¶ä»–è§„èŒƒæ ‡å‡†ä¸€æ ·ï¼Œä»“å‚¨å±‚ä¹Ÿæœ‰ç›¸åº”çš„è§„èŒƒå®šä¹‰ã€‚FreeSql.Repository å‚è€ƒ abp vnext æ¥å£ï¼Œå®šä¹‰å’Œå®ç°åŸºç¡€çš„ä»“å‚¨å±‚ï¼ˆCURDï¼‰ï¼Œç®—æ¯”è¾ƒé€šç”¨çš„æ–¹æ³•ã€‚

*   Select/Attach å¿«ç…§å¯¹è±¡ï¼ŒUpdate åªæ›´æ–°å˜åŒ–çš„å­—æ®µï¼›
*   Insert æ’å…¥æ•°æ®ï¼Œé€‚é…å„æ•°æ®åº“ä¼˜åŒ–æ‰§è¡Œ ExecuteAffrows/ExecuteIdentity/ExecuteInsertedï¼›
*   InsertOrUpdate æ’å…¥æˆ–æ›´æ–°ï¼›
*   SaveMany æ–¹æ³•å¿«é€Ÿä¿å­˜å¯¼èˆªå¯¹è±¡ï¼ˆä¸€å¯¹å¤šã€å¤šå¯¹å¤šï¼‰ï¼›
*   å·¥ä½œå•å…ƒç®¡ç†äº‹åŠ¡

    //Startup.cs
    public void ConfigureServices(IServiceCollection services)
    {
        services.AddSingleton<IFreeSql>(DB.access);
        services.AddScoped<UnitOfWorkManager>();
        services.AddFreeRepository(null, typeof(Startup).Assembly);
       //æ‰¹é‡æ³¨å…¥ Service
    }
    
    
    public class SongService
    {
        readonly IBaseRepository<Song> _repoSong;
        readonly IBaseRepository<Detail> _repoDetail;
    
        public SongService(IBaseRepository<Song> repoSong, IBaseRepository<Detail> repoDetail)
        {
            _repoSong = repoSong;
            _repoDetail = repoDetail;
        }
    
        [Transactional]
        public virtual void Test1()
        {
            //è¿™é‡Œ _repoSongã€_repoDetail æ‰€æœ‰æ“ä½œéƒ½æ˜¯ä¸€ä¸ªå·¥ä½œå•å…ƒ
            this.Test2();
        }
    
        [Transactional(Propagation = Propagation.Nested)]
        public virtual void Test2() //åµŒå¥—äº‹åŠ¡
        {
            //è¿™é‡Œ _repoSongã€_repoDetail æ‰€æœ‰æ“ä½œéƒ½æ˜¯ä¸€ä¸ªå·¥ä½œå•å…ƒ
        }
    }
    

å±æ€§

è¿”å›å€¼

è¯´æ˜

EntityType

Type

ä»“å‚¨æ­£åœ¨æ“ä½œçš„å®ä½“ç±»å‹ï¼Œæ³¨æ„å®ƒä¸ä¸€å®šæ˜¯ TEntity

UnitOfWork

IUnitOfWork

æ­£åœ¨ä½¿ç”¨çš„å·¥ä½œå•å…ƒ

Orm

IFreeSql

æ­£åœ¨ä½¿ç”¨çš„ Orm

DbContextOptions

DbContextOptions

æ­£åœ¨ä½¿ç”¨çš„ DbContext è®¾ç½®ï¼Œä¿®æ”¹è®¾ç½®ä¸å½±å“å…¶ä»–

DataFilter

IDataFilter<TEntity>

ä»“å‚¨è¿‡æ»¤å™¨ï¼Œæœ¬å¯¹è±¡å†…ç”Ÿæ•ˆ

UpdateDiy

IUpdate<TEntity>

å‡†å¤‡æ›´æ–°æ•°æ®ï¼Œä¸ä»“å‚¨åŒäº‹åŠ¡

Select

ISelect<TEntity>

å‡†å¤‡æŸ¥è¯¢æ•°æ®

æ–¹æ³•

è¿”å›å€¼

å‚æ•°

è¯´æ˜

AsType

void

Type

æ”¹å˜ä»“å‚¨æ­£åœ¨æ“ä½œçš„å®ä½“ç±»å‹

Get

TEntity

TKey

æ ¹æ®ä¸»é”®ï¼ŒæŸ¥è¯¢æ•°æ®

Find

TEntity

TKey

æ ¹æ®ä¸»é”®ï¼ŒæŸ¥è¯¢æ•°æ®

Delete

int

TKey

æ ¹æ®ä¸»é”®åˆ é™¤æ•°æ®

Delete

int

Lambda

æ ¹æ® lambda æ¡ä»¶åˆ é™¤æ•°æ®

Delete

int

TEntity

åˆ é™¤æ•°æ®

Delete

int

IEnumerable<TEntity>

æ‰¹é‡åˆ é™¤æ•°æ®

DeleteCascadeByDatabase

List<object>

Lambda

æ ¹æ®å¯¼èˆªå±æ€§é€’å½’æ•°æ®åº“åˆ é™¤æ•°æ®

Insert

\-

TEntity

æ’å…¥æ•°æ®ï¼Œè‹¥å®ä½“æœ‰è‡ªå¢åˆ—ï¼Œæ’å…¥åçš„è‡ªå¢å€¼ä¼šå¡«å……åˆ°å®ä½“ä¸­

Insert

\-

IEnumerable<TEntity>

æ‰¹é‡æ’å…¥æ•°æ®

Update

\-

TEntity

æ›´æ–°æ•°æ®

Update

\-

IEnumerable<TEntity>

æ‰¹é‡æ›´æ–°æ•°æ®

InsertOrUpdate

\-

TEntity

æ’å…¥æˆ–æ›´æ–°æ•°æ®

FlushState

\-

æ— 

æ¸…é™¤çŠ¶æ€ç®¡ç†æ•°æ®

Attach

\-

TEntity

é™„åŠ å®ä½“åˆ°çŠ¶æ€ç®¡ç†ï¼Œå¯ç”¨äºä¸æŸ¥è¯¢å°±æ›´æ–°æˆ–åˆ é™¤

Attach

\-

IEnumerable<TEntity>

æ‰¹é‡é™„åŠ å®ä½“åˆ°çŠ¶æ€ç®¡ç†

AttachOnlyPrimary

\-

TEntity

åªé™„åŠ å®ä½“çš„ä¸»é”®æ•°æ®åˆ°çŠ¶æ€ç®¡ç†

[SaveMany](%E8%81%94%E7%BA%A7%E4%BF%9D%E5%AD%98#savemany)

\-

TEntity, string

ä¿å­˜å®ä½“çš„æŒ‡å®š ManyToMany/OneToMany å¯¼èˆªå±æ€§ï¼ˆå®Œæ•´å¯¹æ¯”ï¼‰

[BeginEdit](%E6%B7%BB%E5%8A%A0%E6%88%96%E4%BF%AE%E6%94%B9#3beginedit-%E6%89%B9%E9%87%8F%E7%BC%96%E8%BE%91)

\-

List<TEntity>

å‡†å¤‡ç¼–è¾‘ä¸€ä¸ª List å®ä½“

EndEdit

int

æ— 

å®Œæˆç¼–è¾‘æ•°æ®ï¼Œè¿›è¡Œä¿å­˜åŠ¨ä½œ

> çŠ¶æ€ç®¡ç†ï¼Œå¯å®ç° Update åªæ›´æ–°å˜åŒ–çš„å­—æ®µï¼ˆä¸æ›´æ–°æ‰€æœ‰å­—æ®µï¼‰ï¼Œçµæ´»ä½¿ç”¨ Attach å’Œ Update ç”¨èµ·æ¥éå¸¸èˆ’æœã€‚

* * *

âš¡ CRUD æ¨¡å¼ä¸‰ï¼šDbContext
--------------------

FreeSql.DbContext å®ç°ç±»ä¼¼ EFCore ä½¿ç”¨ä¹ æƒ¯ï¼Œè·Ÿè¸ªå¯¹è±¡çŠ¶æ€ï¼Œæœ€ç»ˆé€šè¿‡ SaveChanges æ–¹æ³•æäº¤äº‹åŠ¡ã€‚

FreeSql å¯è‡ªåŠ¨è¯†åˆ« EFCore å®ä½“ç‰¹æ€§ Key/Required/NotMapped/MaxLength/StringLength/DatabaseGenerated/Table/Columnã€‚

*   Select/Attach å¿«ç…§å¯¹è±¡ï¼ŒUpdate åªæ›´æ–°å˜åŒ–çš„å­—æ®µï¼›
*   Add/AddRange æ’å…¥æ•°æ®ï¼Œé€‚é…å„æ•°æ®åº“ä¼˜åŒ–æ‰§è¡Œ ExecuteAffrows/ExecuteIdentity/ExecuteInsertedï¼›
*   AddOrUpdate æ’å…¥æˆ–æ›´æ–°ï¼›
*   SaveMany æ–¹æ³•å¿«é€Ÿä¿å­˜å¯¼èˆªå¯¹è±¡ï¼ˆä¸€å¯¹å¤šã€å¤šå¯¹å¤šï¼‰ï¼›

    using (var ctx = DB.oracle.CreateDbContext()) {
      //var db1 = ctx.Set<Song>();
      //var db2 = ctx.Set<Tag>();
    
      var item = new Song { };
      ctx.Add(item);
      ctx.SaveChanges();
    }
    
    // æˆ–è€…
    
    ```csharp
    public class SongContext : DbContext {
    
      public DbSet<Song> Songs { get; set; }
      public DbSet<Tag> Tags { get; set; }
    
      protected override void OnConfiguring(DbContextOptionsBuilder builder) {
        builder.UseFreeSql(DB.oracle);
      }
      
      //æ¯ä¸ª DbContext åªè§¦å‘ä¸€æ¬¡
      protected override void OnModelCreating(ICodeFirst codefirst)
      {
        codefirst.Entity<Song>(eb =>
        {
          eb.ToTable("tb_song");
          eb.Ignore(a => a.Field1);
          eb.Property(a => a.Title).HasColumnType("varchar(50)").IsRequired();
          eb.Property(a => a.Url).HasMaxLength(100);
        }
      }
    }
    

æç¤ºï¼šFreeSql å…¼å®¹ EFCore 99% çš„å®ä½“ç‰¹æ€§

* * *

ğŸŒ´ CRUD æ¨¡å¼å››ï¼šBaseEntity
----------------------

BaseEntity æ˜¯ä¸€ç§æç®€å•çš„ CodeFirst å¼€å‘æ–¹å¼ï¼Œç‰¹åˆ«å¯¹å•è¡¨æˆ–å¤šè¡¨CRUDï¼Œåˆ©ç”¨ç»§æ‰¿èŠ‚çœäº†æ¯ä¸ªå®ä½“ç±»çš„é‡å¤å±æ€§ï¼ˆåˆ›å»ºæ—¶é—´ã€IDç­‰å­—æ®µï¼‰ï¼Œè½¯ä»¶åˆ é™¤ç­‰åŠŸèƒ½ï¼Œè¿›è¡Œ crud æ“ä½œæ—¶ä¸å¿…æ—¶å¸¸è€ƒè™‘ä»“å‚¨çš„ä½¿ç”¨ï¼›

> dotnet add package FreeSql.Extensions.BaseEntity

    public class UserGroup : BaseEntity<UserGroup, int>
    {
        public string GroupName { get; set; }
    }
    
    //æ·»åŠ 
    var item = new UserGroup { GroupName = "ç»„ä¸€" };
    item.Insert();
    
    //æ›´æ–°
    item.GroupName = "ç»„äºŒ";
    item.Update();
    
    //æ·»åŠ æˆ–æ›´æ–°
    item.Save();
    
    //è½¯åˆ é™¤
    item.Delete();
    
    //æ¢å¤è½¯åˆ é™¤
    item.Restore();
    
    //æ ¹æ®ä¸»é”®è·å–å¯¹è±¡
    var item = UserGroup.Find(1);
    
    //æŸ¥è¯¢æ•°æ®
    var items = UserGroup.Where(a => a.Id > 10).ToList();
    

* * *

ğŸ“ƒ CRUD æ¨¡å¼äº”ï¼šSqlConnection æ‰©å±•æ–¹æ³•ï¼ˆç±»ä¼¼ Dapperï¼‰
-----------------------------------------

æä¾›äº†ç±»ä¼¼ Dapper çš„ä½¿ç”¨æ–¹æ³•ï¼ŒFreeSql å¢åŠ äº† IDbConnection/IDbTransaction å¯¹è±¡çš„æ‰©å±•æ–¹æ³• Select/Insert/Update/Delete å®ç° CRUDã€‚

    using FreeSql;
    
    using (var conn = new SqlConnection(...))
    {
      conn.Select<T>().Where(...).ToList();
    
      conn.Insert(new T {}).ExecuteAffrows();
      conn.Update().SetSource(new T {}).ExecuteAffrows();
      conn.InsertOrUpdate().SetSource(new T {}).ExecuteAffrows();
    
      conn.Delete<T>().Where(...).ExecuteAffrows();
    }
    

*   æ¯ä¸ª SqlConnection GetFreeSql() è¿”å›çš„ IFreeSql å®ä¾‹ç›¸åŒï¼›
*   å¯ä»¥å¯¹ fsql è®¾ç½® Aop äº‹ä»¶ï¼Œæ¯”å¦‚ç›‘è§† SQLï¼›
*   IFreeSql è‡ªèº«çš„æˆå‘˜ IDbFirstã€Transaction ä¸å¯ç”¨ï¼›

åˆ©ç”¨æœ¬åŠŸèƒ½å¯ä»¥å¿«é€Ÿå°† FreeSql ä½¿ç”¨åˆ°é¡¹ç›®ä¸­ï¼Œåªéœ€è¦å¤„ç†å¥½å®ä½“ç±»çš„ç‰¹æ€§ã€‚

* * *

ğŸŒˆ ç»“æŸè¯­
------

ä½œè€…æ˜¯ä»€ä¹ˆäººï¼Ÿ

ä½œè€…æ˜¯ä¸€ä¸ªå…¥è¡Œ 18å¹´çš„è€æ‰¹ï¼Œä»–ç›®å‰å†™çš„.net å¼€æºé¡¹ç›®æœ‰ï¼š

å¼€æºé¡¹ç›®

æè¿°

å¼€æºåœ°å€

å¼€æºåè®®

FreeIM

èŠå¤©ç³»ç»Ÿæ¶æ„

[https://github.com/2881099/FreeIM](https://github.com/2881099/FreeIM)

MIT

FreeRedis

Redis SDK

[https://github.com/2881099/FreeRedis](https://github.com/2881099/FreeRedis)

MIT

csredis

[https://github.com/2881099/csredis](https://github.com/2881099/csredis)

MIT

FightLandlord

æ–—DIä¸»ç½‘ç»œç‰ˆ

[https://github.com/2881099/FightLandlord](https://github.com/2881099/FightLandlord)

å­¦ä¹ ç”¨é€”

FreeScheduler

å®šæ—¶ä»»åŠ¡

[https://github.com/2881099/FreeScheduler](https://github.com/2881099/FreeScheduler)

MIT

IdleBus

ç©ºé—²å®¹å™¨

[https://github.com/2881099/IdleBus](https://github.com/2881099/IdleBus)

MIT

FreeSql

ORM

[https://github.com/dotnetcore/FreeSql](https://github.com/dotnetcore/FreeSql)

MIT

FreeSql.Cloud

åˆ†å¸ƒå¼tcc/saga

[https://github.com/2881099/FreeSql.Cloud](https://github.com/2881099/FreeSql.Cloud)

MIT

FreeSql.AdminLTE

ä½ä»£ç åå°ç”Ÿæˆ

[https://github.com/2881099/FreeSql.AdminLTE](https://github.com/2881099/FreeSql.AdminLTE)

MIT

FreeSql.DynamicProxy

åŠ¨æ€ä»£ç†

[https://github.com/2881099/FreeSql.DynamicProxy](https://github.com/2881099/FreeSql.DynamicProxy)

å­¦ä¹ ç”¨é€”

éœ€è¦çš„è¯·æ‹¿èµ°ï¼Œè¿™äº›éƒ½æ˜¯æœ€è¿‘å‡ å¹´çš„å¼€æºä½œå“ï¼Œä»¥å‰æ›´æ—©å†™çš„å°±ä¸å‘äº†ã€‚

FreeSql .NET ORM æ”¯æŒ .NetFramework4.0+ã€.NetCoreã€Xamarinã€MAUIã€Blazorã€ä»¥åŠè¿˜æœ‰è¯´ä¸å‡ºæ¥çš„è¿è¡Œå¹³å°ï¼Œå› ä¸ºä»£ç **ç»¿è‰²æ— ä¾èµ–**ï¼Œæ”¯æŒæ–°å¹³å°éå¸¸ç®€å•ã€‚ç›®å‰å•å…ƒæµ‹è¯•æ•°é‡ï¼š8500+ï¼ŒNugetä¸‹è½½æ•°é‡ï¼š1M+ã€‚QQç¾¤ï¼š4336577(å·²æ»¡)ã€8578575(åœ¨çº¿)ã€52508226(åœ¨çº¿)

*   æ”¯æŒ CodeFirst æ¨¡å¼ï¼›
*   æ”¯æŒ DbFirst æ¨¡å¼ï¼Œæ”¯æŒä»æ•°æ®åº“å¯¼å…¥å®ä½“ç±»ï¼Œæˆ–ä½¿ç”¨[å®ä½“ç±»ç”Ÿæˆå·¥å…·](https://freesql.net/guide/db-first.html)ç”Ÿæˆå®ä½“ç±»ï¼›
*   æ”¯æŒ ä¸°å¯Œçš„è¡¨è¾¾å¼å‡½æ•°ï¼Œä»¥åŠçµæ´»çš„è‡ªå®šä¹‰è§£æï¼›
*   æ”¯æŒ å¯¼èˆªå±æ€§ä¸€å¯¹å¤šã€å¤šå¯¹å¤šè´ªå©ªåŠ è½½ï¼Œå»¶æ—¶åŠ è½½ï¼Œçº§è”ä¿å­˜ï¼Œçº§è”åˆ é™¤ï¼›
*   æ”¯æŒ è¯»å†™åˆ†ç¦»ã€åˆ†è¡¨åˆ†åº“ã€è¿‡æ»¤å™¨ã€ä¹è§‚é”ã€æ‚²è§‚é”ã€åˆ†å¸ƒå¼äº‹åŠ¡ã€å¤šç§Ÿæˆ·ï¼ˆæŒ‰å­—æ®µ/è¡¨/åº“ï¼‰ï¼›
*   æ”¯æŒ MySql/SqlServer/PostgreSQL/Oracle/Sqlite/Firebird/è¾¾æ¢¦/äººå¤§é‡‘ä»“/ç¥èˆŸé€šç”¨/å—å¤§é€šç”¨/ç¿°é«˜/åä¸ºé«˜æ–¯/ClickHouse/Access ç­‰æ•°æ®åº“ï¼›

FreeSql ä½¿ç”¨æœ€å®½æ¾çš„å¼€æºåè®® MIT [https://github.com/dotnetcore/FreeSql](https://github.com/dotnetcore/FreeSql) ï¼Œå¯ä»¥å•†ç”¨ï¼Œæ–‡æ¡£é½å…¨ï¼Œç”šè‡³æ‹¿å»å–é’±ä¹Ÿå¯ä»¥ã€‚

8500+ä¸ªå•å…ƒæµ‹è¯•ä½œä¸ºåŸºè°ƒï¼Œæ”¯æŒ10å¤šæ•°æ•°æ®åº“ï¼Œæˆ‘ä»¬æä¾›äº†é€šç”¨Odbcç†è®ºä¸Šæ”¯æŒæ‰€æœ‰æ•°æ®åº“ï¼Œç›®å‰å·²çŸ¥æœ‰ç¾¤å‹ä½¿ç”¨ FreeSql æ“ä½œåä¸ºé«˜æ–¯ã€mycatã€tidb ç­‰æ•°æ®åº“ã€‚å®‰è£…æ—¶åªéœ€è¦é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“å®ç°åŒ…ã€‚

è½»é‡åŒ–è§£é‡Šï¼šäº†è§£ FreeRedisã€FreeSqlã€csredis çš„äººéƒ½çŸ¥é“ï¼Œæˆ‘ä»¬å‘å¸ƒçš„å¼€æºé¡¹ç›®æ˜¯ç»¿è‰²è‘—ç§°ï¼Œé›¶ä¾èµ–å‘å¸ƒååªæœ‰ä¸€ä¸ªDLLï¼Œä¸ä¼šé€ æˆä½¿ç”¨è€…é¡¹ç›®ä¾èµ–å†²çªï¼Œæ”¯æŒ .NET 4.0 å ªç§°å±å±±é¡¹ç›®çš„æ•‘æ˜Ÿã€‚ç°åœ¨è¿˜æœ‰å¾ˆå¤š.NET FX4.0 çš„é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®å› å†å²é—ç•™åŸå› æˆ–ç¡¬ä»¶é™åˆ¶ï¼Œä¸èƒ½æ›´æ¢ .NET Core ç‰ˆæœ¬ã€‚å› æ­¤è¿™äº›é¡¹ç›®å¾ˆéš¾ä½¿ç”¨åˆ°ç°æœ‰çš„å¼€æºåº“ï¼Œä¸èƒ½ä½¿ç”¨å¯é çš„å¼€æºåº“ï¼Œé‚£ä¹ˆå¾ˆå¤šæ—¶å€™éƒ½è¦è‡ªè¡Œå®ç°ï¼Œåœ¨å †ç§¯ä»£ç çš„åŒæ—¶ï¼Œé¡¹ç›®ä¹Ÿæœ‰å¯èƒ½è¶Šæ¥è¶Šä¹±ï¼Œä»£ç è¶Šæ¥è¶Šæ¸£ï¼Œé¡¹ç›®é€æ¸å˜å¾—ä¸ç¨³å®šã€‚