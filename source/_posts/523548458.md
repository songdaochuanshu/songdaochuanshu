---
layout: post
title: "数据库基础知识详解五：MySQL中的索引和其两种引擎、主从复制以及关系型/非关系型数据库"
date: "2022-04-21T09:19:17.895Z"
---
数据库基础知识详解五：MySQL中的索引和其两种引擎、主从复制以及关系型/非关系型数据库
============================================

1、MySQL中的索引
-----------

在MySQL，索引是由B+树实现的，B+是一种与B树十分类似的数据结构。

形如下面这种：  
![](https://img2022.cnblogs.com/blog/2668784/202204/2668784-20220421145625220-1376581381.png)

**其结构特点**：

（1）有n课子树的结点中含有n个关键码。

（2）非根节点子节点数： **ceil(m/2)<= k <= m**（ceil是天花板函数的意思，也就是向上取整，比如**ceil(1.2)=2** ），m为该B+树的阶数。根节点最少有两个子节点，最多同样为m个。

（2）叶子节点包含了全部关键码的信息，及指向含有这些关键码记录的指针。并且叶子节点根据关键码的大小自小至大的顺序链接，叶子节点有相邻结点的指针。

（3）所有的非叶子节点（B+树中也称内部结点，索引节点）可以看成索引部分，都不存储数据，只存储索引，结点中仅含有其子树根节点中最大（或者最小）的关键码，数据都存储在叶子节点中。

> **问题：为什么索引不适用B树而是B+树实现？**

B+树比B树的优点：

*   **IO次数少**：B+树的中间节点只存放索引，数据都存在叶子节点中，所以结点中存取的数据更多，使得B+树更加矮胖，因此可以减少I/O次数。（这里IO指的是磁盘I/O，每一次查询，需要把某结点读到内存，然后把目标数和结点中的比较，不一样则继续I/O）
    
*   **范围查询效率更高**：B树需要中序遍历整个树，B+树只需要遍历叶子结点中的链表。
    
*   **查询效率更加稳定**：B树查询某个数据最好情况只需到根节点，而最坏情况需要遍历整个二叉树。
    
    B+树每次查询都需要从根节点到叶子结点，路径长度相同，每次查询效率接近。
    

> **问题：为什么不采用效率更高的哈希查找？**

采用B+树索引与哈希索引的比较：

哈希索引能以 O(1) 时间进行查找，但是只支持精确查找，无法用于部分查找和范围查找，无法用于排序与分组。B+树索引支持大于小于等于查找，范围查找。哈希索引遇到大量哈希值相等的情况后查找效率会降低。哈希索引不支持数据的排序。

2、MySQL的两种数据库引擎
---------------

（1）**InnoDB（in-no-db）**

*   支持事务，可以进行Commit和Rollback。
*   支持表级锁和行级锁，增强了并发性。
*   支持外键。
*   支持在线热备份。

（2）**MyISAM（mai-ai-zem）**

*   不支持事务
*   只支持表级锁，不支持行级锁
*   不支持外键
*   MyISAM 崩溃后发生损坏的概率比 InnoDB 高很多，而且恢复的速度也更慢MyISAM 支持压缩表和空间数据索引，比InnoDB需要的内存和存储更少MyISAM 管理非事务表。

它提供高速存储和检索（MyISAM强调的是性能，每次查询具有原子性，其执行速度比InnoDB更快），以及全文搜索能力。如果表比较小，或者是只读数据（有大量的SELECT），还是可以使用MyISAM。InnoDB 支持事务，并发情况下有很好的性能，基本可以替代MyISAM。

> **热备份和冷备份**

**热备份**：在数据库运行的情况下备份的方法。

优点：可按表或用户备份，备份时数据库仍可使用，可恢复至任一时间点。但是不能出错。

**冷备份**：数据库正常关闭后，将关键性文件复制到另一位置的备份方式。

优点：操作简单快速，恢复简单。

3、主从复制
------

主从复制（Replication）是指数据可以从一个MySQL数据库主服务器复制到一个或多个从服务器，从服务器可以复制主服务器中的所有数据库或者特定的数据库，或者特定的表。默认采用异步模式。

实现原理：

*   主服务器 binary log dump 线程：将主服务器中的数据更改（增删改）日志写入 Binary log 中。
*   从服务器 I/O 线程：负责从主服务器读取binary log，并写入本地的 Relay log。
*   从服务器 SQL 线程：负责读取 Relay log，解析出主服务器已经执行的数据更改，并在从服务器中重新执行（Replay），保证主从数据的一致性。

4、关系型数据库和非关系型数据库
----------------

**关系型数据库（如Oracle，MySQL）**：  
表和表、表和字段、数据和数据存在着关系，它通过数据、关系和对数据的约束三者组成的数据模型来存放和管理数据。  
**优点**:

*   数据之间存在关系，进行数据的增删改查的时候较为方便。
*   关系型数据库是有事务操作的，便于保证数据的完整性和一致性。
*   可以通用SQL语言，便于操作者学习使用。

**缺点**：

*   因为数据和数据是有关系的，底层会运行相关的算法，大量算法会降低系统的效率，会降低性能。
*   面对海量数据的增删改查和维护的时候会显的无能为力。
*   因为是固定的表结构类型，所以灵活度较低。

**非关系数据库（如redis和MangDB）**  
非关系型数据库严格上不是一种数据库，而是一种数据结构化存储方法的集合，可以是文档或者键值对等。  
为了处理大量数据，非关系数据库设计之初就是为了去替代关系型数据库。  
**优点**：

*   存储格式较为灵活，存储数据的格式可以是key-value，文档，图片形式等等，应用成精更加的广泛。
*   速度更快，不仅支持硬盘这样的载体，还支持另外的存储器来存储数据，如Redis就支持内存来存储数据。
*   能支持对大量数据的查找和读写。

**缺点**：

*   不支持SQL语言的通用，需要单独去学习其操作使用。
*   非关系数据库一般没有事务处理，较难保证数据的完整性和安全性。
*   数据结构较复杂，如果要进行复杂的查询会加大难度。