---
layout: post
title: "docker引起服务器磁盘爆满"
date: "2022-06-10T03:21:42.334Z"
---
docker引起服务器磁盘爆满
===============

服务器异常
=====

又是开开心心打开我心爱的服务器一天；  
吔！这是嘛啊？我的服务器域名访问不了了，一直转圈圈超时了，好，打开ssh远程看看，吔！！！还是访问不了，宕机了？怀着一颗憋大便的心情打开了阿里云控制面板。

检查服务器
=====

打开阿里云控制面板的监控，发现不同寻常的两个数据  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609231044592-1508905356.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609231141464-138222156.png)

我就挂两个网站，一个青龙面板，不应该这么占资源啊？想起来前两天打开青龙面板的时候有点卡，留了个心眼，等等，，，cpu运算高没事，磁盘。。。（第一张图片，下面深蓝色的是读取，最上面曲线是写。。）磁盘一直写这么久，它该累了吧？我一共就60个G的磁盘，现在恐怕磁盘已经炸了，哪个杀千刀的这么狗？

发现异常
====

根据以上信息判断，应该是磁盘爆满，导致服务器的宕机，那我就只能在控制面板中重启一下服务器，然后使用ssh登录，使用`df`命令查看一下磁盘的信息。  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609232221022-1749947395.png)

我看见它了，我看见它了，Use内存占比，占最多的是我系统盘的/目录（根目录），娴熟的拿出了祖传rm -rf /\*，不不不，使不得，这是自个服务器，不能这么使，算了，一步一步来吧，先进去看看根目录它怎么了，`cd /`,让我使用`du -sh *`康康它发育的怎么样了，看，有一个叫var的文件夹发育的还挺大，54G，应该就是他了，里面应该有哪个程序出问题了，我们进一步看看里面有什么。  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609233431756-819470605.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609233947287-12591497.png)

避免尿素过多，我直接截图到问题文件，但是每一级目录都是可以用`du -sh *`给他检查，  
**注意：**du命令就是检查文件或目录大小的，具体参数可以查看：[du命令介绍](https://www.linuxcool.com/du "du命令介绍")

解决问题
====

我来到了问题的根源处，发现这个目录下面的数据很大。

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220609235652622-431930806.png)

来看一下这个路径是啥吧

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610000227451-1483703387.png)

看一下内容是什么，不建议用cat哈，不然服务器可能会很卡，我就用tail看一下最后几行`tail core.8252`

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610000455682-463740719.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610001433626-1555383390.png)

全是这种东西；看了=没看；那我再打开一下小一点的文件，一个叫core.26822的文件，使用`cat core.26822`查看到以下内容

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610002200037-1347335905.png)

之前看到的路径是在docker的ql里面ql是我的青龙面板，emmm就是代挂的一个东西，然后里面有一些报错就是有这个关键字，应该是我有一个脚本在一直跑，但是又报错，再加上我没在意，导致了它今天的宕机，抱歉是为父没照顾好你，然后我去访问一下青龙面板，已经jer了，好吧，那我就大手一挥，再次打出了`rm -rf core.*`，就是用于删除带有core.字符，以任意结尾的文件，这是关于Linux正则匹配的知识，想研究Linux正则匹配的崽儿，访问：[Linux正则匹配知识](https://www.baidu.com/s?wd=Linux%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D&rsv_spt=1&rsv_iqid=0xf285f9760015e80f&issp=1&f=8&rsv_bp=1&rsv_idx=2&ie=utf-8&tn=baiduhome_pg&rsv_enter=0&rsv_dl=tb&rsv_sug3=33&rsv_sug1=28&rsv_sug7=101&rsv_btype=i&prefixsug=Linux%25E6%25AD%25A3%25E5%2588%2599%25E5%258C%25B9%25E9%2585%258D&rsp=1&inputT=11810&rsv_sug4=13241 "Linux正则匹配知识")

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610003412256-1817930492.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610003437063-212305254.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610011102848-1020897649.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610011149614-1361438320.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610011214186-1655289677.png)

好，现在我的崽儿它很健康了，待我启动青龙面板看看咋回事。

![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610004213064-1365167509.png)  
![image](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610004033239-1711744357.png)

好吧，看起来也不是那么健康，明天重新给他装个docker。

![我对这大千世界一无所知](https://img2022.cnblogs.com/blog/2221291/202206/2221291-20220610004411858-508510003.jpg)

结尾：写作不易，行行好给口饭吃吧，实在不行关注一下也行啊，再不济点个赞也行啊

本文来自博客园，作者：[狐小妖](https://www.cnblogs.com/huxiaoyao/)，转载请注明原文链接：[https://www.cnblogs.com/huxiaoyao/p/16361749.html](https://www.cnblogs.com/huxiaoyao/p/16361749.html)