---
layout: post
title: "èŠèŠ C++ å¤§ä¸€ç»Ÿçš„åˆå§‹åŒ–è¿ç®—ç¬¦ {}"
date: "2022-07-11T01:52:56.528Z"
---
èŠèŠ C++ å¤§ä¸€ç»Ÿçš„åˆå§‹åŒ–è¿ç®—ç¬¦ {}
====================

ä¸€ï¼šèƒŒæ™¯
----

æœ€è¿‘å‘ç° C++ ä¸­çš„ç±»å‹åˆå§‹åŒ–æ“ä½œï¼Œæ²¡æœ‰ `{}` è¿ç®—ç¬¦æä¸å®šçš„ï¼Œè›®æœ‰æ„æ€ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥é€ä¸€åˆ—ä¸€ä¸‹å„è‡ªçš„ç”¨æ³•ä»¥åŠæ±‡ç¼–å±•ç°ï¼Œæœ¬æ¥æƒ³åˆ†ä¸º `å€¼ç±»å‹` å’Œ `å¼•ç”¨ç±»å‹` ä¸¤å¤§å—ï¼Œä½†å‘ç°åœ¨ C++ ä¸­æ²¡è¿™ç§è¯´æ³•ï¼Œé»˜è®¤éƒ½æ˜¯ `å€¼ç±»å‹` ğŸ˜‚ğŸ˜‚ğŸ˜‚

äºŒï¼šå„ç§ç©æ³•ä¸€è§ˆ
--------

### 1\. int ä¸Šçš„åˆå§‹åŒ–

é¦–å…ˆçœ‹ä¸€ä¸‹ä»£ç ï¼š

    
    int main()
    {
    	int i = { 10 };
    	int j{ 10 };
    
    	printf("i=%d, j=%d", i, j);
    }
    
    

ç›¸æ¯”C#æ¥è¯´ï¼Œä¸å¸¦ `=` çš„å†™æ³•æ„Ÿè§‰è¿˜æ˜¯æ€ªæ€ªçš„ã€‚ã€‚ã€‚ æ¥ä¸‹æ¥çœ‹ä¸‹å¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚

    
    	int i = { 10 };
    00021825  mov         dword ptr [ebp-8],0Ah  
    	int j{ 10 };
    0002182C  mov         dword ptr [ebp-14h],0Ah 
    
    

ä»æ±‡ç¼–ä»£ç çœ‹ï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„ `æ ˆèµ‹å€¼` ï¼Œæ‰€ä»¥åœ¨ int ä¸Šç”¨ `{}` å®Œå…¨æ²¡å¿…è¦ï¼Œå¤ªä¼¤é”®ç›˜äº†ã€‚

### 2\. æ•°ç»„çš„åˆå§‹åŒ–

ç»§ç»­çœ‹ä¾‹å­ã€‚

    
    int main()
    {
    	int num[] = { 10,11,12 };
    }
    
    

è¿™ç§å†™æ³•ä¸­è§„ä¸­çŸ©ï¼ŒåŸºæœ¬ä¸Š C ç³»åˆ—çš„è¯­è¨€éƒ½è¿™æ ·ï¼Œå¯¹äºç© C# çš„æˆ‘æ¥è¯´ï¼Œä¸é™Œç”Ÿã€‚ã€‚ã€‚ ä¸è¿‡äººå®¶é»˜è®¤æ˜¯å€¼ç±»å‹ï¼ŒC# æ˜¯å¼•ç”¨ç±»å‹ï¼Œä»æ±‡ç¼–ä»£ç ä¸­ä¹Ÿèƒ½çœ‹çš„å‡ºæ¥ã€‚

    
    	int num[] = { 10,11,12 };
    009C1E95  mov         dword ptr [ebp-10h],0Ah  
    009C1E9C  mov         dword ptr [ebp-0Ch],0Bh  
    009C1EA3  mov         dword ptr [ebp-8],0Ch  
    
    

### 3\. ç»“æ„ä½“çš„åˆå§‹åŒ–

ç»“æ„ä½“å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œç›´æ¥ä¸Šä»£ç äº†ã€‚

    
    typedef struct _Point
    {
    	int x;
    	int y;
    } Point;
    
    int main()
    {
    	Point point = { 10,20 };
    }
    
    

æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹æ±‡ç¼–ä»£ç ã€‚

    
    	Point point = { 10,20 };
    00481825  mov         dword ptr [ebp-0Ch],0Ah  
    0048182C  mov         dword ptr [ebp-8],14h  
    
    

å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ç»„ç®€å•çš„èµ‹å€¼æ“ä½œï¼Œå¾ˆæ–¹ä¾¿ã€‚

### 4\. ç±»çš„åˆå§‹åŒ–

æ–¹ä¾¿è®²è¿°ï¼Œå…ˆä¸Šä»£ç ï¼š

    
    class Location {
    private:
    	int x;
    	int y;
    	int z;
    public:
    	Location(int x, int y, int z) :x(x), y(y), z(z) {
    	}
    };
    
    int main()
    {
    	Location location = { 10,11,12 };
    }
    
    

æ¥ä¸‹æ¥çœ‹ä¸‹æ±‡ç¼–ä»£ç ï¼Œæ˜¯ä¸æ˜¯è°ƒç”¨äº† Location çš„æ„é€ å‡½æ•°ã€‚

    
    	Location location = { 10,11,12 };
    008D183F  push        0Ch  
    008D1841  push        0Bh  
    008D1843  push        0Ah  
    008D1845  lea         ecx,[ebp-14h]  
    008D1848  call        Location::Location (08D13A7h) 
    
    

å¯ä»¥çœ‹åˆ°ç¡®å®è°ƒç”¨äº† æ„é€ å‡½æ•°ï¼Œé‚£ä¸ª ecx å°±æ˜¯ location çš„ this æŒ‡é’ˆã€‚

### 5\. initializer\_list æ¨¡æ¿ç±»

C++ ä¸­çš„ initializer\_list ç±»å¯ä»¥æ¥æ”¶ `{}` åˆå§‹åŒ–è¯­æ³•ä½œä¸ºåˆå§‹åŒ–æ“ä½œï¼Œè¿™ä¸ªæœ‰ä¸€ç‚¹åƒ C# çš„ `param` å¯é€‰å‚æ•°ï¼Œæ¥ä¸‹æ¥æŠŠä¸Šä¾‹çš„ä¸­æ„é€ å‡½æ•°æ”¹æˆ `initializer_list` æ¥æ¥æ”¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

    
    class Location {
    public:
    	int x;
    	int y;
    	int z;
    public:
    	Location(initializer_list<int> list) {
    
    		x = *(const_cast<int*>(list.begin()));
    		y = *(const_cast<int*>(list.begin() + 1));
    		z = *(const_cast<int*>(list.begin() + 2));
    	}
    };
    
    int main()
    {
    	Location loc = { 10,11,12 };
    	printf("loc.x=%d,loc.y=%d,loc.z=%d", loc.x, loc.y, loc.z);
    }
    
    

æ¥ä¸‹æ¥çœ‹ä¸‹æ±‡ç¼–ä»£ç ã€‚

    
    	Location loc = { 10,11,12 };
    00B9518F  mov         dword ptr [ebp-0F8h],0Ah  
    00B95199  mov         dword ptr [ebp-0F4h],0Bh  
    00B951A3  mov         dword ptr [ebp-0F0h],0Ch  
    00B951AD  lea         eax,[ebp-0ECh]  
    00B951B3  push        eax  
    00B951B4  lea         ecx,[ebp-0F8h]  
    00B951BA  push        ecx  
    00B951BB  lea         ecx,[ebp-0E4h]  
    00B951C1  call        std::initializer_list<int>::initializer_list<int> (0B913C5h)  
    00B951C6  mov         edx,dword ptr [eax+4]  
    00B951C9  push        edx  
    00B951CA  mov         eax,dword ptr [eax]  
    00B951CC  push        eax  
    00B951CD  lea         ecx,[loc]  
    00B951D0  call        Location::Location (0B913ACh) 
    
    

ä»æ±‡ç¼–ä»£ç çœ‹ï¼Œå®ƒé¦–å…ˆåšäº† `initializer_list` çš„åˆå§‹åŒ–æ“ä½œï¼Œç„¶åå°†å¼„å¥½çš„é›†åˆä¸¢åˆ° `Location` æ„é€ å‡½æ•°ä¸­ï¼Œåè½¬è¿‡æ¥å¤§æ¦‚å°±æ˜¯è¿™æ ·ã€‚

    
    int main()
    {
    	initializer_list<int> list = { 10,11,12 };
    
    	Location loc = { list };
    
    	printf("output: loc.x=%d,loc.y=%d,loc.z=%d", loc.x, loc.y, loc.z);
    }
    
    

å“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ `{}` åœ¨åˆå§‹åŒ–æ–¹é¢æ— æ‰€ä¸èƒ½ï¼Œå¥½äº†ï¼Œæœ¬ç¯‡å°±èŠåˆ°è¿™é‡Œäº†ã€‚

![å›¾ç‰‡åç§°](https://images.cnblogs.com/cnblogs_com/huangxincheng/345039/o_210929020104æœ€æ–°æ¶ˆæ¯ä¼˜æƒ ä¿ƒé”€å…¬ä¼—å·å…³æ³¨äºŒç»´ç .jpg)