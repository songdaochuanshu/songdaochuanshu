---
layout: post
title: "å…¨éƒ½ä¼šï¼é¢„æµ‹è›‹ç™½è´¨æ ‡æ³¨ï¼åˆ›å»ºè®²ä¹‰ï¼è§£é‡Šæ•°å­¦å…¬å¼ï¼æœ€æ‡‚ç§‘å­¦çš„æ™ºèƒ½NLPæ¨¡å‹Galacticaå°é²œ â›µ"
date: "2022-12-07T05:15:13.035Z"
---
å…¨éƒ½ä¼šï¼é¢„æµ‹è›‹ç™½è´¨æ ‡æ³¨ï¼åˆ›å»ºè®²ä¹‰ï¼è§£é‡Šæ•°å­¦å…¬å¼ï¼æœ€æ‡‚ç§‘å­¦çš„æ™ºèƒ½NLPæ¨¡å‹Galacticaå°é²œ â›µ
=================================================

![å…¨éƒ½ä¼šï¼é¢„æµ‹è›‹ç™½è´¨æ ‡æ³¨ï¼åˆ›å»ºè®²ä¹‰ï¼è§£é‡Šæ•°å­¦å…¬å¼ï¼æœ€æ‡‚ç§‘å­¦çš„æ™ºèƒ½NLPæ¨¡å‹Galacticaå°é²œ â›µ](https://img2023.cnblogs.com/blog/2637458/202212/2637458-20221207101726296-1436336158.png) æœ¬æ–‡æµ…è¯•Metaå¼€æºçš„å¤§å‹AIè¯­è¨€æ¨¡å‹ã€Galacticaã€ï¼Œå¸¦å¤§å®¶ä½“éªŒå®‰è£…ä¸å¤šåœºæ™¯ä½¿ç”¨ã€‚Galacticaè¢«ç§°ä¸ºâ€œæœ€æ‡‚ç§‘å­¦çš„æ™ºèƒ½NLPæ¨¡å‹â€ï¼Œèƒ½å¤Ÿé¢„æµ‹è›‹ç™½è´¨æ ‡æ³¨ï¼åˆ›å»ºè®²ä¹‰ï¼è§£é‡Šæ•°å­¦å…¬å¼ï¼å…¨éƒ½ä¼šï¼

![](https://img-blog.csdnimg.cn/img_convert/13148ffb8637100498a6d39ae48c91a7.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [æœºå™¨å­¦ä¹ å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/41)ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)  
> ğŸ“˜ [æ·±åº¦å­¦ä¹ å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/42)ï¼š[https://www.showmeai.tech/tutorials/42](https://www.showmeai.tech/tutorials/42)  
> ğŸ“˜ [è‡ªç„¶è¯­è¨€å¤„ç†å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/45)ï¼š[https://www.showmeai.tech/tutorials/45](https://www.showmeai.tech/tutorials/45)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/405)ï¼š[https://www.showmeai.tech/article-detail/405](https://www.showmeai.tech/article-detail/405)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

ğŸ’¡ å¼•è¨€
=====

![](https://img-blog.csdnimg.cn/img_convert/2bfdaac3e5ac8cc76953fb5e8f7727cc.png)

![](https://img-blog.csdnimg.cn/img_convert/6a6d14cfe1c8ecc41b3dabd890ce3c27.png)

ğŸ“˜[**Galactica**](https://www.galactica.org/) æ˜¯ Meta AI å¼€æºçš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ŒåŸºäº Transformer æ¶æ„æ„å»ºï¼Œä¸»è¦ä½¿ç”¨ç§‘å­¦æ–‡ç« å’Œç ”ç©¶è®ºæ–‡ä½œä¸ºæ•°æ®ï¼Œå¹¶ä½¿ç”¨ ğŸ“˜[**GROBID**](https://grobid.readthedocs.io/en/latest/Introduction/) åº“å°†æ–‡æ¡£ä» pdf è½¬æ¢ä¸ºæ–‡æœ¬ä½œä¸ºè¯­æ–™è¿›è¡Œå­¦ä¹ ã€‚

![](https://img-blog.csdnimg.cn/img_convert/6915cb37d2110aac468fd88d7a8eea00.png)

![](https://img-blog.csdnimg.cn/img_convert/c9821b5dfd29c962270b0da3b717a790.png)

Galactica æ¨¡å‹ä½¿ç”¨å•ä¸ªæ¨¡å‹ç®¡ç†å¤šä¸ªç§‘å­¦ä»»åŠ¡ã€‚å¯ä»¥å®Œæˆæ¨ç†ã€åˆ›å»ºè®²ä¹‰ã€é¢„æµ‹èµ„æ–™å¼•ç”¨ç­‰ï¼Œæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

*   æ¨¡å‹åŒ…æ‹¬125M-120Bå‚æ•°ä¹‹é—´çš„5ç§ä¸åŒå°ºå¯¸ã€‚
*   è¯¥æ¨¡å‹ä½¿ç”¨ 2048 é•¿åº¦çš„ä¸Šä¸‹æ–‡çª—å£ã€‚
*   ç”¨äºç®¡ç†ç‰¹å®šæ•°æ®ç±»å‹çš„â€œä¸“ä¸šâ€æ ‡è®°åŒ–æ–¹æ³•ã€‚

![](https://img-blog.csdnimg.cn/img_convert/3f012a9ed1d008bcc9b072ce0913d3e4.png)

Galactica æ¨¡å‹åœ¨é¢å‘ç§‘å­¦çš„æ•°æ®é›†ä¸Šåšåˆ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚ä¸å‡çº§åçš„ GPT-3 æˆ– OPT ç›¸æ¯”ï¼Œå®ƒåœ¨ TruthfulQA æ•°æ®é›†ä¸­é—®é¢˜ç»“æœæ›´å°‘ï¼Œå¯ä½œä¸ºå¼€æºé¡¹ç›®ä½¿ç”¨ï¼Œåœ¨æœ¬ç¯‡å†…å®¹ä¸­ï¼Œ[ShowMeAI](https://www.showmeai.tech/)å°±å¸¦å¤§å®¶ä¸€èµ·ä½“éªŒä¸€ä¸‹è¿™ä¸ªç§‘å­¦ç•Œçš„å·¨å‹è¯­è¨€æ¨¡å‹ã€‚

ğŸ’¡ å®è·µ
=====

ğŸ’¦ å®‰è£…ä¸åŠ è½½
--------

æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…Galacticaæ¨¡å‹ï¼š

    pip install git+https://github.com/paperswithcode/galai
    

> æ³¨æ„ï¼šGalactica æ¨¡å‹é€‚ç”¨äº Python ç‰ˆæœ¬ 3.8 å’Œ 3.9ã€‚ç›®å‰Python 3.10 åŠæ›´é«˜ç‰ˆæœ¬æ—¶æ¨¡å‹å®‰è£…å¤±è´¥ã€‚ä¸»è¦æ˜¯ç”±äº promptsource-library ä¾èµ–è¦æ±‚ã€‚

ä½¿ç”¨ä¸‹è¿°å‘½ä»¤å¯¼å…¥æ¨¡å‹ï¼š

    import galai as gal
    

é€šè¿‡load\_modelå‡½æ•°åŠ è½½æ¨¡å‹ã€‚

    model = gal.load_model("base", num_gpus = 1)
    

åŠ è½½æ¨¡å‹æ—¶å¯ä»¥æŒ‡å®šåŠ è½½çš„é¢„è®­ç»ƒæ¨¡å‹ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨â€œbaseâ€ç‰ˆæœ¬ï¼Œæ¨¡å‹åŒ…æ‹¬ 1.3Bï¼ˆ13äº¿ï¼‰å‚æ•°ã€‚å¯é€‰çš„ç‰ˆæœ¬åŒ…æ‹¬â€œminiâ€ï¼Œâ€œbaseâ€ï¼Œâ€œstandardâ€ï¼Œâ€œlargeâ€ å’Œ â€œhugeâ€ï¼Œå‚æ•°é‡ä» 125m åˆ° 120bã€‚

> æ›´å¤§çš„æ¨¡å‹éœ€è¦æ›´å¤šå†…å­˜ä¸è®¡ç®—èµ„æºï¼Œæˆ‘ä»¬åœ¨è¿™é‡ŒåŸºäºå†…å­˜æƒ…å†µé€‰æ‹©â€œbaseâ€ç‰ˆæœ¬ï¼Œå®ƒæ¶ˆè€—å¤§çº¦ 11GB çš„å†…å­˜ã€‚

*   `load_model`çš„ç¬¬2ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå®ƒæŒ‡å®šGPUçš„æ•°é‡ã€‚

ğŸ’¦ æ¨¡å‹ä½¿ç”¨ç¤ºä¾‹
---------

ä¸‹é¢æˆ‘ä»¬å¼€å§‹ä½¿ç”¨å’Œä½“éªŒæ¨¡å‹ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç™¾ç§‘è§£é‡Šç±»çš„ç¤ºä¾‹ï¼š

    model.generate("We can explain Brain as", new_doc=True, top_p=0.7, max_length=200)
    

æ¨¡å‹åŒ…æ‹¬å…¶ä»–å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‚æ•°è®¾ç½®ä¸­é™åˆ¶è¾“å‡ºæ–‡æœ¬é•¿åº¦ï¼Œè¿™äº›å‚æ•°ç±»ä¼¼äº GPT-3 æ¨¡å‹ã€‚

æ¨¡å‹è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š

> We can explain Brain as a computer program that takes in data from the external world, and produces an output as a result. The Brain is the machine that makes decisions about what to do. The Brain is the part of the brain that is made up of neurons, the basic building blocks of the brain. Neurons are the smallest units of the brain. Each neuron contains a membrane and a set of synapses that allow it to communicate with other neurons.\\n\\n\[IMAGE\]\\n\\nFigure Caption: Figure 10.2.110.2.1: Neurons are the smallest units of the brain.\\n\\n# What are the Functions of Neurons?\\n\\nNeurons are the basic building blocks of the brain. The brain is the part of the body that is made up of neurons. Neurons communicate with each other using chemical signals called neurotransmitters. The brain has many different types of neurons. The different types of neurons in the brain are called neurons of the different types. Neurons of different types'

ğŸ’¦ HuggingFace+Galactica
------------------------

Galactica æ¨¡å‹ä¹Ÿå¯ä»¥ä½¿ç”¨ HuggingFace åŠ è½½å’Œä½¿ç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªè¿‡ç¨‹ï¼Œé¦–å…ˆæˆ‘ä»¬å¯¼å…¥å·¥å…·åº“ï¼š

    !pip install accelerate #to run with the gpu
    from transformers import AutoTokenizer, OPTForCausalLM
    

> æ³¨æ„ï¼šä½¿ç”¨ GPU è¿è¡Œæ¨¡å‹æ—¶éœ€è¦accelerateåº“ã€‚å½“ä»…ä½¿ç”¨ CPU è¿è¡Œæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡å®‰è£…â€œaccelerateâ€åº“ã€‚å½“ä»…ä½¿ç”¨ CPU è¿è¡Œæ—¶ï¼Œè¯¥æ¨¡å‹å¾ˆæ…¢ã€‚å› æ­¤ï¼Œå¦‚æœå¤§å®¶æœ‰ GPU èµ„æºï¼Œæˆ‘ä»¬å°½é‡ä½¿ç”¨GPUè¿è¡Œå®ƒã€‚

æˆ‘ä»¬æ¥ä¸‹æ¥é€‰æ‹©æ¨¡å‹ç‰ˆæœ¬ï¼Œä¸åŒå¤§å°çš„æ¨¡å‹åˆ†åˆ«ä¸ºâ€œ125mâ€ã€â€œ1.3bâ€ã€â€œ6.7bâ€ã€â€œ30bâ€å’Œâ€œ120bâ€ã€‚æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿è¡Œ 1.25 äº¿ä¸ªå‚æ•°çš„æœ€å°ç‰ˆæœ¬ï¼š

    tokenizer = AutoTokenizer.from_pretrained("facebook/galactica-125m")
    model = OPTForCausalLM.from_pretrained("facebook/galactica-125m", device_map="auto")
    

> å¦‚æœè¦ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬ï¼Œå¤§å®¶åªéœ€å°†125mæ¢æˆå…¶ä»–çš„ç‰ˆæœ¬ï¼ˆâ€œ1.3bâ€ã€â€œ6.7bâ€ã€â€œ30bâ€å’Œâ€œ120bâ€ï¼‰å³å¯ã€‚

åŠ è½½å®Œæ¨¡å‹ä¹‹åæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ¨¡å‹çš„æ¨ç†æ¨æ–­èƒ½åŠ›ã€‚æˆ‘ä»¬ä»¥æ–‡æœ¬å½¢å¼æä¾›è¾“å…¥ï¼š

    input_text = "Car 1 speed is 30km/h and Car 2 speed is 50km/h. Which car travels faster and how much? <work>"
    input_ids = tokenizer(input_text, return_tensors="pt").input_ids.to("cuda") #when running with gpu is required to add the ".to("cuda")"
    

æˆ‘ä»¬ä½¿ç”¨æœ€å°ç‰ˆæœ¬çš„Galactica æ¨¡å‹ï¼Œå°±å‡†ç¡®è¿”å›æ­¤æ¨ç†ä»»åŠ¡çš„æ­£ç¡®ç­”æ¡ˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

> Car 1 travels faster than Car 2 (30km/h vs. 50km/h). calc\_1.py `result = 30/50 with open(â€œoutput.txtâ€, â€œwâ€) as file: file.write(str(round(result)))`<<run: â€œcalc\_1.pyâ€>> <<read: â€œoutput.txtâ€>> 10 So 10 km. Car 1 travels faster than Car 2 (50km/h vs. 30km/h). calc\_2.py \`\`\`result = 50/30 â€¦ Answer: 20

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ [**Galactica å®˜æ–¹ç½‘ç«™**](https://www.galactica.org/)ï¼š[https://www.galactica.org/](https://www.galactica.org/)
*   ğŸ“˜ [**GROBID å®˜æ–¹ç½‘ç«™**](https://grobid.readthedocs.io/en/latest/Introduction/)ï¼š[https://grobid.readthedocs.io/en/latest/Introduction/](https://grobid.readthedocs.io/en/latest/Introduction/)
*   ğŸ“˜ [**Galactica: A Large Language Model for Science**](https://galactica.org/static/paper.pdf)ï¼š[https://galactica.org/static/paper.pdf](https://galactica.org/static/paper.pdf)

æ¨èé˜…è¯»
====

*   ğŸŒ [**æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/40) ï¼š[https://www.showmeai.tech/tutorials/40](https://www.showmeai.tech/tutorials/40)
*   ğŸŒ [**æœºå™¨å­¦ä¹ æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/41)ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)
*   ğŸŒ [**æ·±åº¦å­¦ä¹ æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/42)ï¼š[https://www.showmeai.tech/tutorials/42](https://www.showmeai.tech/tutorials/42)
*   ğŸŒ [**TensorFlowæ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/43)ï¼š[https://www.showmeai.tech/tutorials/43](https://www.showmeai.tech/tutorials/43)
*   ğŸŒ [**PyTorchæ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/44)ï¼š[https://www.showmeai.tech/tutorials/44](https://www.showmeai.tech/tutorials/44)
*   ğŸŒ [**NLPå®æˆ˜æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/45)ï¼š[https://www.showmeai.tech/tutorials/45](https://www.showmeai.tech/tutorials/45)
*   ğŸŒ [**CVå®æˆ˜æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/46)ï¼š[https://www.showmeai.tech/tutorials/46](https://www.showmeai.tech/tutorials/46)
*   ğŸŒ [**AI é¢è¯•é¢˜åº“ç³»åˆ—**](https://www.showmeai.tech/tutorials/48)ï¼š[https://www.showmeai.tech/tutorials/48](https://www.showmeai.tech/tutorials/48)

[![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)](https://www.showmeai.tech/)