---
layout: post
title: "ç°ä»£ CSS é«˜é˜¶æŠ€å·§ï¼Œå®Œç¾çš„æ³¢æµªè¿›åº¦æ¡æ•ˆæœï¼"
date: "2022-12-14T19:13:24.808Z"
---
ç°ä»£ CSS é«˜é˜¶æŠ€å·§ï¼Œå®Œç¾çš„æ³¢æµªè¿›åº¦æ¡æ•ˆæœï¼
=======================

æœ¬æ–‡æ˜¯ CSS Houdini ä¹‹ CSS Painting API ç³»åˆ—ç¬¬ä¸‰ç¯‡ã€‚

*   [ç°ä»£ CSS ä¹‹é«˜é˜¶å›¾ç‰‡æ¸éšæ¶ˆå¤±æœ¯](https://juejin.cn/post/7167160342101884935)
*   [ç°ä»£ CSS é«˜é˜¶æŠ€å·§ï¼Œåƒ Canvas ä¸€æ ·è‡ªç”±ç»˜å›¾æ„å»ºæ ·å¼ï¼](https://juejin.cn/post/7168984450230353950)

åœ¨ä¸Šä¸¤ç¯‡ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº† CSS Painting API æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥ï¼Œå®ç°è‡ªå®šä¹‰å›¾æ¡ˆç”šè‡³å®ç°åŠ¨ç”»æ•ˆæœçš„ï¼

åœ¨è¿™ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢ï¼Œå°è¯•ä½¿ç”¨ CSS Painting APIï¼Œå»å®ç°ä¸€äº›è¿‡å¾€çº¯ CSS æ— æ³•å®ç°çš„æ•ˆæœã€‚

CSS Painting API
----------------

å†ç®€å•å¿«é€Ÿçš„è¿‡ä¸€ä¸‹ï¼Œä»€ä¹ˆæ˜¯ CSS Painting APIã€‚

CSS Painting API æ˜¯ CSS Houdini çš„ä¸€éƒ¨åˆ†ã€‚è€Œ Houdini æ˜¯ä¸€ç»„åº•å±‚ APIï¼Œå®ƒä»¬å…¬å¼€äº† CSS å¼•æ“çš„å„ä¸ªéƒ¨åˆ†ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿé€šè¿‡åŠ å…¥æµè§ˆå™¨æ¸²æŸ“å¼•æ“çš„æ ·å¼å’Œå¸ƒå±€è¿‡ç¨‹æ¥æ‰©å±• CSSã€‚Houdini æ˜¯ä¸€ç»„ APIï¼Œå®ƒä»¬ä½¿å¼€å‘äººå‘˜å¯ä»¥ç›´æ¥è®¿é—® [CSS å¯¹è±¡æ¨¡å‹](https://developer.mozilla.org/zh-CN/docs/Web/API/CSS_Object_Model) ï¼ˆCSSOMï¼‰ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™æµè§ˆå™¨å¯ä»¥è§£æä¸º CSS çš„ä»£ç ï¼Œä»è€Œåˆ›å»ºæ–°çš„ CSS åŠŸèƒ½ï¼Œè€Œæ— éœ€ç­‰å¾…å®ƒä»¬åœ¨æµè§ˆå™¨ä¸­æœ¬åœ°å®ç°ã€‚

CSS Paint API ç›®å‰çš„ç‰ˆæœ¬æ˜¯ [CSS Painting API Level 1](https://drafts.css-houdini.org/css-paint-api/#paintworkletglobalscope)ã€‚å®ƒä¹Ÿè¢«ç§°ä¸º CSS Custom Paint æˆ–è€… Houdini's Paint Workletã€‚

æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸º JS In CSSï¼Œåˆ©ç”¨ JavaScript Canvas ç”»å¸ƒçš„å¼ºå¤§èƒ½åŠ›ï¼Œå®ç°è¿‡å¾€ CSS æ— æ³•å®ç°çš„åŠŸèƒ½ã€‚

åˆ©ç”¨ CSS Painting API å®ç°æ³¢æµªæ•ˆæœ
--------------------------

CSS å®ç°æ³¢æµªæ•ˆæœï¼Œä¸€ç›´æ˜¯ CSS çš„ä¸€ä¸ªéš¾ç‚¹ä¹‹ä¸€ã€‚åœ¨è¿‡å¾€ï¼Œè™½ç„¶æˆ‘ä»¬æœ‰å¾ˆå¤šæ–¹å¼åˆ©ç”¨ Hack å‡ºä¸€äº›æ³¢æµªæ•ˆæœï¼Œæˆ‘åœ¨ä¹‹å‰çš„å¤šç¯‡æ–‡ç« ä¸­æœ‰åå¤æåŠè¿‡ï¼š

*   [çº¯ CSS å®ç°æ³¢æµªæ•ˆæœ!](https://github.com/chokcoco/iCSS/issues/22)
*   [ä¸€ç§å·§å¦™çš„ä½¿ç”¨ CSS åˆ¶ä½œæ³¢æµªæ•ˆæœçš„æ€è·¯](https://github.com/chokcoco/iCSS/issues/112)
*   [åœ†è§’å¤§æ€å™¨ï¼Œä½¿ç”¨æ»¤é•œæ„å»ºåœ†è§’åŠæ³¢æµªæ•ˆæœï¼](https://github.com/chokcoco/iCSS/issues/192)

æ˜¯çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯åˆ©ç”¨ä¸€äº›å¥‡æŠ€æ·«å·§å®ç°æ³¢æµªæ•ˆæœï¼Œåƒæ˜¯è¿™æ ·ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13016c2f8a9541a5b0bdba3763b4af94~tplv-k3u1fbpfcp-watermark.image?)

å¦‚ä»Šï¼Œæœ‰äº† CSS Painting APIï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥ç»˜åˆ¶çœŸå®çš„æ³¢æµªæ•ˆæœäº†ã€‚çœ‹çœ‹ä»£ç ï¼š

    <div></div>
    
    <script>
    if (CSS.paintWorklet) {              
        CSS.paintWorklet.addModule('/CSSHoudini.js');
    }
    </script>
    

    div {
        position: relative;
        width: 300px;
        height: 300px;
        background: paint(waveDraw);
        border-radius: 50%;
        border: 2px solid rgba(255, 0, 0, 0.5);
    }
    

æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª `waveDraw` æ–¹æ³•ï¼Œæ¥ä¸‹æ¥ï¼Œå°±é€šè¿‡åˆ©ç”¨ registerPaint æ¥å®ç°è¿™ä¸ªæ–¹æ³•å³å¯ã€‚

    // æ–‡ä»¶åä¸º CSSHoudini.js
    registerPaint(
        "waveDraw",
        class {
            static get inputProperties() {
                return [];
            }
            paint(ctx, size, properties) {
                const { width, height } = size;
                const initY = height * 0.5;
                ctx.beginPath();
                for (let i = 0; i <= width; i++) {
                    ctx.lineTo(i, initY + Math.sin((i) / 20) * 10);
                }
                ctx.lineTo(width, height);
                ctx.lineTo(0, height);
                ctx.lineTo(0, initY);
                ctx.closePath();
    
                ctx.fillStyle = 'rgba(255, 0, 0, 0.9)';
                ctx.fill();
            }
        }
    );
    

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†è¿™æ ·ä¸€ä¸ªæ³¢æµªæ•ˆæœï¼š

![image](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfb49f5673eb465491807639747e73f9~tplv-k3u1fbpfcp-zoom-1.image)

ä¸Šé¢çš„ä»£ç å…¶å®å¾ˆå¥½ç†è§£ï¼Œç®€å•è§£é‡Šä¸€ä¸‹ï¼Œæˆ‘ä»¬æ ¸å¿ƒå°±æ˜¯åˆ©ç”¨è·¯å¾„ç»˜åˆ¶ï¼ŒåŸºäº `Math.sin()` ä¸‰è§’å‡½æ•°ï¼Œç»˜åˆ¶äº†ä¸€æ®µ sin(x) ä¸‰è§’å‡½æ•°çš„å›¾å½¢ã€‚

1.  æ•´ä¸ªå›¾å½¢ä» `ctx.beginPath()` å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªç‚¹æ˜¯ `ctx.lineTo(0, initY + Math.sin((i) / 20) * 10)`ï¼Œä¸è¿‡ `Math.sin(0) = 0`ï¼Œæ‰€ä»¥ç­‰äº `ctx.lineTo(0, initY)`
2.  `initY` åœ¨è¿™çš„ä½œç”¨æ˜¯æ§åˆ¶ä»ä»€ä¹ˆé«˜åº¦å¼€å§‹ç»˜åˆ¶æ³¢æµªå›¾å½¢ï¼Œæˆ‘ä»¬è¿™é‡Œçš„å–å€¼æ˜¯ `initY = height * 0.5`ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰æˆäº†å›¾å½¢çš„ä¸­é—´ä½ç½®
3.  åˆ©ç”¨ `for (let i = 0; i <= width; i++)` å¾ªç¯ï¼Œé…åˆ `ctx.lineTo(i, initY + Math.sin((i) / 20) * 10)`ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¯ä¸€ä¸ª x è½´ä¸Šçš„ç‚¹ï¼Œéƒ½ç»˜åˆ¶ä¸€ä¸ªç‚¹
4.  éšåä¸‰ä¸ªåœ¨å¾ªç¯ä½“å¤–çš„ `ctx.lineTo` çš„ä½œç”¨æ˜¯è®©æ•´ä¸ªå›¾å½¢å½¢æˆä¸€ä¸ªé—­ç¯
5.  æœ€å `ctx.closePath()` å®Œæˆæ•´ä¸ªè·¯å¾„ï¼Œ`ctx.fill()` è¿›è¡Œä¸Šè‰²

å¦‚æœä¸ `ctx.fill()` ä¸Šè‰²ï¼Œåˆ©ç”¨ `ctx.stroke()` ç»˜åˆ¶è¾¹æ¡†ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå…¶å®æˆ‘ä»¬å¾—åˆ°æ˜¯è¿™æ ·ä¸€ä¸ªå›¾å½¢ï¼š

![image](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8a24838650e43d5a44f039c18f8bb6b~tplv-k3u1fbpfcp-zoom-1.image)

ä¸Šå›¾æ˜¯åŒæ—¶å»æ‰äº† CSS ä»£ç é‡Œé¢çš„ `border-radius: 50%`ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ã€‚

å½“ç„¶ï¼Œä¸Šé¢çš„å›¾å½¢ï¼Œæœ‰ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œæ²¡æ³•åŠ¨èµ·æ¥ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€ä¸ª CSS @Property è‡ªå®šä¹‰å˜é‡ï¼Œè®©å®ƒæ‹¥æœ‰ä¸€äº›åŠ¨ç”»æ•ˆæœã€‚

æˆ‘ä»¬éœ€è¦æ”¹é€ ä¸€ä¸‹ä»£ç ï¼Œé¦–å…ˆï¼Œæ·»åŠ ä¸€ä¸ª CSS @Property è‡ªå®šä¹‰å˜é‡ï¼š

    @property --animation-tick {
      syntax: '<number>';
      inherits: false;
      initial-value: 1000;
    }
    div {
      // ... ä»£ç ä¸ä¸Šè¿°ä¿æŒä¸€è‡´
      animation: move 20s infinite linear;
      --animation-tick: 1000;
    }
    @keyframes move {
        100% {
            --animation-tick: 0;
        }
    }
    

æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª `--animation-tick` å˜é‡ï¼Œå¹¶ä¸”åˆ©ç”¨ CSS åŠ¨ç”»ï¼Œè®©å®ƒä» 1000 å‡è‡³ 0ã€‚

ä¸‹ä¸€æ­¥ï¼Œåˆ©ç”¨è¿™ä¸ªä¸æ–­åœ¨å˜åŒ–çš„ CSS è‡ªå®šä¹‰å˜é‡ï¼Œæˆ‘ä»¬åœ¨ `waveDraw` æ–¹æ³•ä¸­ï¼ŒæŠŠå®ƒåˆ©ç”¨ä¸Šï¼š

    // æ–‡ä»¶åä¸º CSSHoudini.js
    registerPaint(
        "waveDraw",
        class {
            static get inputProperties() {
                return ["--animation-tick"];
            }
            paint(ctx, size, properties) {
                let tick = Number(properties.get("--animation-tick"));
                const { width, height } = size;
                const initY = height * 0.5;
                ctx.beginPath();
                for (let i = 0; i <= width; i++) {
                    ctx.lineTo(i, initY + Math.sin((i + tick) / 20) * 10);
                }
                ctx.lineTo(width, height);
                ctx.lineTo(0, height);
                ctx.lineTo(0, initY);
                ctx.closePath();
    
                ctx.fillStyle = 'rgba(255, 0, 0, 0.9)';
                ctx.fill();
            }
        }
    );
    

ä»”ç»†çœ‹ï¼Œå’Œä¸Šè¿°çš„ä»£ç å˜åŒ–ä¸å¤§ï¼Œæ ¸å¿ƒåœ¨äºï¼Œåˆ©ç”¨ä¸‰è§’å‡½æ•°ç»˜åˆ¶å›¾å½¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå˜é‡åŠ å…¥è¿›å»ã€‚

ä»åŸæ¥çš„ `ctx.lineTo(i, initY + Math.sin((i) / 20) * 10)`ï¼Œå˜æˆäº† `ctx.lineTo(i, initY + Math.sin((i + tick) / 20) * 10)`ã€‚

è¿™æ ·ï¼Œåœ¨è¿™ä¸ªä¸æ–­å˜åŒ–çš„å˜é‡çš„ä½œç”¨ä¸‹ï¼Œæˆ‘ä»¬çš„æ³¢æµªå›¾å½¢å°±èƒ½è¿åŠ¨èµ·æ¥äº†ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e42fcf5eaff84f91845e4d8413a2d251~tplv-k3u1fbpfcp-zoom-1.image)

[CodePen Demo -- CSS Houdini Wave](https://codepen.io/Chokcoco/pen/ZERxmGW)

è™½ç„¶èƒ½åŠ¨äº†ï¼Œä½†æ˜¯æ€»æ˜¯æ„Ÿè§‰è¿˜å°‘äº†äº›ä»€ä¹ˆã€‚å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªæ³¢æµªæ•ˆæœåº”ç”¨ä¸è¿›åº¦æ¡ä¹‹ç±»çš„æ•ˆæœä¸Šï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦å¯ä»¥å¿«é€Ÿå®šä¹‰æ³¢æµªçš„æŒ¯å¹…ã€æ¯ä¸ªæ³¢å³°ä¹‹é—´çš„é—´è·ã€æ•ˆæœçš„é¢œè‰²ã€ç™¾åˆ†æ¯”ç­‰ç­‰ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å†é€šè¿‡ä¸€ä¸ª CSS å˜é‡ï¼Œè®©å®ƒæˆä¸ºä¸€ä¸ªå®é™…å¯ç”¨çš„å°è£…è‰¯å¥½çš„æ³¢æµªè¿›åº¦æ¡ã€‚æˆ‘ä»¬å†ç®€å•æ”¹é€ ä¸€ä¸‹ï¼š

    @property --animation-tick {
      syntax: '<number>';
      inherits: false;
      initial-value: 1000;
    }
    @property --height {
      syntax: '<number>';
      inherits: false;
      initial-value: .7;
    }
    div {
        position: relative;
        width: 300px;
        height: 300px;
        background: paint(waveDraw);
        animation: move 20s infinite linear;
        border-radius: 50%;
        border: 2px solid var(--color1);
        --amplitude: 15;
        --gap: 28;
        --animation-tick: 700;
        --height: 0.7;
        --color1: rgba(255, 0, 0, 0.5);
        --color2: rgba(255, 0, 0, 0.4);
        --color3: rgba(255, 0, 0, 0.3);
        
        transition: --height 8s;
    }
    

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®šä¹‰äº†éå¸¸å¤šä¸ª CSS å˜é‡ï¼Œæ¯æ¬¡ï¼Œå®ƒä»¬éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼š

*   `--animation-tick` è¡¨ç¤ºæ³¢æµªè¿åŠ¨çš„é€Ÿç‡
*   `--amplitude` æ³¢æµªçš„æŒ¯å¹…
*   `--gap` æ³¢å³°é—´è·
*   `--initHeight` åˆå§‹é«˜åº¦
*   `--color1`ã€`--color2`ã€`--color3` æˆ‘ä»¬ä¼šå åŠ  3 å±‚æ³¢æµªæ•ˆæœï¼Œæ˜¾å¾—æ›´çœŸå®ä¸€ç‚¹ï¼Œè¿™é‡Œ 3 ä¸ªé¢œè‰²è¡¨ç¤º 3 å±‚æ³¢æµªçš„é¢œè‰²

å®šä¹‰å¥½è¿™äº› CSS å˜é‡åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒä»¬è¿ç”¨åœ¨å®é™…çš„`waveDraw` æ–¹æ³•ä¸­ã€‚çœ‹çœ‹ä»£ç ï¼š

    registerPaint(
        "waveDraw",
        class {
            static get inputProperties() {
                return [
                    "--animation-tick", 
                    "--height", 
                    "--gap",
                    "--amplitude",
                    "--color1",
                    "--color2",
                    "--color3"
                ];
            }
            
            paint(ctx, size, properties) {
                let tick = Number(properties.get("--animation-tick"));
                let initHeight = Number(properties.get("--height"));
                let gap = Number(properties.get("--gap"));
                let amplitude = Number(properties.get("--amplitude"));
                let color1 = properties.get("--color1");
                let color2 = properties.get("--color2");
                let color3 = properties.get("--color3");
                
                this.drawWave(ctx, size, tick, amplitude, gap, initHeight, color1);
                this.drawWave(ctx, size, tick * 1.21, amplitude / 0.82, gap + 2, initHeight + 0.02, color2);
                this.drawWave(ctx, size, tick * 0.79, amplitude / 1.19, gap - 2, initHeight - 0.02, color3);
            }
            
            /**
             * ctx
             * size
             * tick é€Ÿç‡
             * amplitude æŒ¯å¹…
             * gap æ³¢å³°é—´è·
             * initHeight åˆå§‹é«˜åº¦
             * color é¢œè‰²
             */
            drawWave(ctx, size, tick, amplitude, gap, initHeight, color) {
                const { width, height } = size;
                const initY = height * initHeight;
                tick = tick * 2;
                
                ctx.beginPath();
                for (let i = 0; i <= width; i++) {
                    ctx.lineTo(i, initY + Math.sin((i + tick) / gap) * amplitude);
                }
                ctx.lineTo(width, height);
                ctx.lineTo(0, height);
                ctx.lineTo(0, initY);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
            }
        }
    );
    

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ `paint()` æ–¹æ³•ä¸­ï¼Œè°ƒç”¨äº† `this.drawWave()`ã€‚æ¯æ¬¡è°ƒç”¨ `this.drawWave()` éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ³¢æµªå›¾å½¢ï¼Œé€šè¿‡ 3 å±‚çš„å åŠ æ•ˆæœï¼Œç”Ÿæˆ 3 å±‚æ³¢æµªã€‚å¹¶ä¸”ï¼ŒæŠŠæˆ‘ä»¬åœ¨ CSS ä¸­å®šä¹‰çš„å˜é‡å…¨éƒ¨çš„åº”ç”¨äº†èµ·æ¥ï¼Œåˆ†åˆ«æ§åˆ¶æ³¢æµªæ•ˆæœçš„ä¸åŒå‚æ•°ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†è¿™æ ·ä¸€ä¸ªæ³¢æµªæ•ˆæœï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bb5076476fc452d99926dc37c596904~tplv-k3u1fbpfcp-zoom-1.image)

é€šè¿‡æ§åˆ¶ CSS ä¸­çš„ `--height` å˜é‡ï¼Œè¿˜å¯ä»¥å®ç°é«˜åº¦çš„å˜åŒ–ï¼Œä»è€Œå®ŒæˆçœŸå®çš„ç™¾åˆ†æ¯”ï¼Œå®ç°ä¸€ç§è¿›åº¦æ¡æ•ˆæœã€‚

    div:hover {
        --height: 0;
    }
    

æ•ˆæœå¦‚ä¸‹ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04445327c5b3424a9252ebcd7fc90552~tplv-k3u1fbpfcp-watermark.image?)

å¾ˆå¥½ï¼Œéå¸¸ä¸é”™çš„æ•ˆæœã€‚æœ‰äº†ä¸Šè¿°ä¸€äº› CSS è‡ªå®šä¹‰å˜é‡çš„å¸®åŠ©ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å°è£…å¥½çš„ `waveDraw` æ–¹æ³•ï¼Œå®ç°ä¸åŒé¢œè‰²ï¼Œä¸åŒå¤§å°ï¼Œä¸åŒé€Ÿç‡çš„æ³¢æµªè¿›åº¦æ¡æ•ˆæœäº†ã€‚

æˆ‘ä»¬åªéœ€è¦ç®€å•çš„æ”¹å˜ä¸€ä¸‹ä¼ å…¥çš„ CSS å˜é‡å‚æ•°å³å¯ï¼š

    <div></div>
    <div></div>
    <div></div>
    

    
    div {
        position: relative;
        width: 300px;
        height: 300px;
        background: paint(waveDraw);
        animation: move 20s infinite linear;
        border-radius: 50%;
        border: 2px solid var(--color1);
        --amplitude: 15;
        --gap: 28;
        --animation-tick: 700;
        --height: 0.7;
        --color1: rgba(255, 0, 0, 0.5);
        --color2: rgba(255, 0, 0, 0.4);
        --color3: rgba(255, 0, 0, 0.3);
        
        transition: --height 8s;
    }
    div:nth-child(2) {
        --amplitude: 6;
        --gap: 25;
        --animation-tick: 300;
        --height: 0.5;
        --color1: rgba(28, 90, 199, 0.5);
        --color2: rgba(28, 90, 199, 0.4);
        --color3: rgba(28, 90, 199, 0.3);
    }
    div:nth-child(3) {
        --amplitude: 3;
        --gap: 30;
        --animation-tick: 1200;
        --height: 0.3;
        --color1: rgba(178, 120, 33, 0.5);
        --color2: rgba(178, 120, 33, 0.4);
        --color3: rgba(178, 120, 33, 0.3);
    }
    

çœ‹çœ‹æ•ˆæœå¦‚ä½•ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44916cfc442d4f8eb5a55ec8fc9a8746~tplv-k3u1fbpfcp-watermark.image?)

[CodePen Demo -- CSS Hudini Custom Wave Effects !](https://codepen.io/Chokcoco/pen/XWYEGyz)

è¿™æ ·ï¼Œå€ŸåŠ© CSS Painting APIï¼Œæˆ‘ä»¬å®Œç¾çš„å®ç°äº†æ³¢æµªå›¾å½¢ï¼Œå¹¶ä¸”å€ŸåŠ©å®ƒï¼Œå®ç°äº†æ³¢æµªè¿›åº¦æ¡æ•ˆæœã€‚é€šè¿‡ä¼ å…¥ä¸åŒçš„ CSS å˜é‡ï¼Œæˆ‘ä»¬æœ‰äº†å¿«é€Ÿæ‰¹é‡ç”Ÿæˆä¸åŒæ•ˆæœçš„èƒ½åŠ›ã€‚å¼¥è¡¥äº†è¿‡å¾€ CSS åœ¨æ³¢æµªæ•ˆæœä¸Šçš„ç¼ºé™·ï¼

å½“ç„¶ï¼Œå°±åŸºäºä¸Šè¿°çš„ä»£ç ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„ç©ºé—´çš„ï¼š

1.  åœ¨ä¸Šè¿°çš„ CSS ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ˜¯ä¼ å…¥äº† 3 ä¸ªå…³äºé¢œè‰²çš„ CSS å˜é‡ï¼Œ`--color1`ã€`--color2`ã€`--color3`ï¼Œæ­£å¸¸è€Œè¨€ï¼Œè¿™é‡Œä¼ å…¥ 1 ä¸ªé¢œè‰²å³å¯ï¼Œé€šè¿‡è½¬æ¢æˆ HSL é¢œè‰²è¡¨ç¤ºæ³•ï¼Œæ›¿æ¢ L è‰²å€¼ï¼Œå¾—åˆ°è¿‘ä¼¼çš„å¦å¤–ä¸¤ä¸ªè‰²å€¼å³å¯ã€‚å½“ç„¶ï¼Œè¿™æ ·åšçš„è¯ä¼šå¢æ·»éå¸¸å¤šçš„ JavaScript ä»£ç ï¼Œæ‰€ä»¥ï¼Œæœ¬æ–‡ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œå·æ‡’ç›´æ¥ä¼ å…¥äº† 3 ä¸ª CSS é¢œè‰²å˜é‡å€¼ï¼›
2.  æ•´ä¸ªæ³¢æµªæ•ˆæœå•è½®çš„åŠ¨ç”»æŒç»­æ—¶é—´æˆ‘è®¾ç½®ä¸ºäº† 20sï¼Œä½†æ˜¯åœ¨æœ¬æ–‡ä¸­ï¼Œæ²¡æœ‰å»é€‚é…åŠ¨ç”»çš„æ‰‹å°¾è¡”æ¥ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¼šå‡ºç°æ¯ 20sï¼Œæ³¢æµªæ•ˆæœæœ‰ä¸€ä¸ªæ˜æ˜¾çš„è·³åŠ¨çš„æ„Ÿè§‰ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ä¸ªæ€è·¯
    *   é€šè¿‡ç²¾ç¡®çš„è®¡ç®—ï¼Œè®©åŠ¨ç”»çš„æœ€åä¸€å¸§å’ŒåŠ¨ç”»çš„ç¬¬ä¸€å¸§è¡”æ¥ä¸Š
    *   æŠŠ `--animation-tick` çš„å€¼è®¾ç½®çš„éå¸¸çš„å¤§ï¼Œç„¶åæŠŠç›¸åº”çš„å•è½®åŠ¨ç”»æ—¶é—´è®¾ç½®çš„éå¸¸é•¿ï¼Œè¿™æ ·ï¼ŒåŸºæœ¬ä¹Ÿæ„Ÿå—ä¸åˆ°åŠ¨ç”»çš„è·³å¸§
3.  ç¬¬ä¸‰ä¸ªé—®é¢˜å¯èƒ½å°±åœ¨äº**å…¼å®¹æ€§**äº†

å…¼å®¹æ€§ï¼Ÿ
----

å¥½å§ï¼Œå…¶å®ä¸Šä¸€ç¯‡æ–‡ç« ä¹Ÿè°ˆåˆ°äº†å…¼å®¹é—®é¢˜ï¼Œå› ä¸ºå¯èƒ½æœ‰å¾ˆå¤šçœ‹åˆ°æœ¬ç¯‡æ–‡ç« å¹¶æ²¡æœ‰å»ç¿»çœ‹å‰ä¸¤ç¯‡æ–‡ç« çš„åŒå­¦ã€‚é‚£ä¹ˆï¼ŒCSS Painting API çš„å…¼å®¹æ€§åˆ°åº•å¦‚ä½•å‘¢ï¼Ÿ

[CanIUse - registerPaint](https://caniuse.com/?search=registerPaint) æ•°æ®å¦‚ä¸‹ï¼ˆæˆªæ­¢è‡³ 2022-11-23ï¼‰ï¼š

![image](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/46e27f937f874bf49d1d54bd83f44aeb~tplv-k3u1fbpfcp-zoom-1.image)

Chrome å’Œ Edge åŸºäº [Chromium](https://www.google.com.hk/search?newwindow=1&rlz=1C5GCEM_enCN988CN988&q=Chromium&spell=1&sa=X&ved=2ahUKEwi3he2ensL7AhVaSmwGHdnzBxgQkeECKAB6BAgoEAE) å†…æ ¸çš„æµè§ˆå™¨å¾ˆæ—©å°±å·²ç»æ”¯æŒï¼Œè€Œä¸»æµæµè§ˆå™¨ä¸­ï¼ŒFirefox å’Œ Safari ç›®å‰è¿˜ä¸æ”¯æŒã€‚

CSS Houdini è™½ç„¶å¼ºå¤§ï¼Œç›®å‰çœ‹æ¥è¦æƒ³å¤§è§„æ¨¡ä¸Šç”Ÿäº§ç¯å¢ƒï¼Œä»éœ€ä¸€æ®µæ—¶é—´çš„ç­‰å¾…ã€‚è®©æˆ‘ä»¬ç»™æ—¶é—´ä¸€ç‚¹æ—¶é—´ï¼

æœ€å
--

å¥½äº†ï¼Œæœ¬æ–‡åˆ°æ­¤ç»“æŸï¼Œå¸Œæœ›æœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ© ğŸ˜ƒ

å¦‚æœè¿˜æœ‰ä»€ä¹ˆç–‘é—®æˆ–è€…å»ºè®®ï¼Œå¯ä»¥å¤šå¤šäº¤æµï¼ŒåŸåˆ›æ–‡ç« ï¼Œæ–‡ç¬”æœ‰é™ï¼Œæ‰ç–å­¦æµ…ï¼Œæ–‡ä¸­è‹¥æœ‰ä¸æ­£ä¹‹å¤„ï¼Œä¸‡æœ›å‘ŠçŸ¥ã€‚