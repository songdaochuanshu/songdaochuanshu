---
layout: post
title: "Ventoy制作启动盘和使用VMware测试启动盘（论文版）"
date: "2023-01-05T15:18:31.200Z"
---
Ventoy制作启动盘和使用VMware测试启动盘（论文版）
==============================

Ventoy是可用于制作启动U盘的开源工具，在占用少量引导分区容量后，其他空间依旧可以正常当一般的U盘读写文件。它的最大特点是只要将iso、win、img、efi等之类的镜像文件和引导文件移动到U盘中。比如导出微PE、杏雨梨云的可启动iso镜像文件，移动到U盘中，在启动时选择微PE、杏雨梨云任意一个作为的启动盘，在如今各种PE启动盘都各有优点的时代，可以实现一盘携带大量PE。同时也不只可以安装Windows系统，也可以安装Linux系统，甚至可以实现Windows to go兼容、Linux数据持久化等较高端操作、功能。

\-

1 Ventoy
========

1.1  Ventoy是什么
--------------

Ventoy是可用于制作启动U盘的开源工具，在占用少量引导分区容量后，其他空间依旧可以正常当一般的U盘读写文件。它的最大特点是只要将iso、win、img、efi等之类的镜像文件和引导文件移动到U盘中。比如导出微PE、杏雨梨云的可启动iso镜像文件，移动到U盘中，在启动时选择微PE、杏雨梨云任意一个作为的启动盘，在如今各种PE启动盘都各有优点的时代，可以实现一盘携带大量PE。同时也不只可以安装Windows系统，也可以安装Linux系统，甚至可以实现Windows to go兼容、Linux数据持久化等较高端操作、功能。

![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105190509217-538034801.png)

图表 1 Ventoy启动界面

1.2  Ventoy启动盘制作
----------------

### 1.2.1 准备工具

需要准备的工具有：

1、电脑，Ventoy提供在Windows和Linux平台下的制作程序。

2、U盘或者移动硬盘，后续统称为“设备”，注意第一次安装Ventoy需要格式化，重要文件务必备份。

### 1.2.2 具体操作步骤

1、电脑下载Ventoy可执行文件。https://www.ventoy.net/cn/download.html。本文以Windows环境下为例。

![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105190509117-296932490.png)

图表 2 Download Ventoy

默认是使用Github作为下载源，国内下载速度较慢，同页往下翻可以看到国内站点的镜像下载源。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105190509137-1974288052.png)

图表 3 Ventoy镜像下载源

下载后将文件解压，可见图表 3 Ventoy Win版本内部文件图表 3，主要涉及到三个可执行文件：Ventoy2Disk、VentoyPlugson、VentoyVLink，三者具有不同的功能：Ventoy2Disk用于制作启动盘、VentoyPlugson用于便捷的配置Ventoy配置、VentoyVLink用于创建和本地硬盘的虚拟链接。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001731-1671616196.png)

图表 4 Ventoy Win版本内部文件

Ventoy2Disk用于制作启动盘。选择设备（U盘），可以进行安装或升级的操作。

1、安装：主要在首次安装Ventoy引导到设备（U盘）上，点击安装会**格式化U盘**，所以安装**务必备份数据**，安装操作只需要第一次进行即可，后续使用只需要升级功能。

2、升级：新版本往往会提供更多功能、更好硬件兼容性。在安装完成后，后续新版本只要点升级即可，数据和配置不受影响。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001792-1489503222.png)

图表 5 Ventoy2Disk

VentoyPlugson主要用于便捷的编辑Ventoy配置文件。VentoyPlugson提供WEB图形化编辑的功能，选择需要修改配置设备（U盘）后，再点击启动会自动打开浏览器。默认监听端口为tcp监听端口为24681。

![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001522-1302116329.png)

图表 6 VentoyPlugson

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001614-889721431.png)

图表 7 VentoyPlugson提供的WEB界面

建议修改以下配置：

1、VTOY\_DEFAULT\_SEARCH\_ROOT —— 指定搜索目录：

默认情况下Ventoy在启动后会扫描整个设备（U盘）的文件，如果设备中还存放了其他文件，会导致启动时候加载很慢。修改位置在**全局操作插件-> VTOY\_DEFAULT\_SEARCH\_ROOT**，限制搜索的目录，默认根目录，建议写到具体的文件夹，比如我使用的设备路径为E:/images/。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001797-1869324292.png)

图表 8 修改指定搜索目录

2、VTOY\_MAX\_SEARCH\_LEVEL —— 最大搜索目录深度：

默认情况下Ventoy会扫描全部深度的文件，倘若只是存放镜像文件，完全可以限制扫描深度。修改位置在**全局操作插件->VTOY\_MAX\_SEARCH\_LEVEL**， 这样可以限制搜索目录内向下搜索子目录的层次，默认搜索目录即我们上一项修改的VTOY\_DEFAULT\_SEARCH\_ROOT。基本上设置为2即可。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191002055-1013660136.png)

图表 9 修改最大搜索目录深度

其他的设置诸如主题、插件等相关依据自己需求修改即可，详细介绍可见官网。

修改配置的对应在设备（U盘）中Ventoy目录中ventoy.json文件，路径为\\ventoy\\ventoy.json，使用JSON作为语法，若修改错配置导致无法使用也可以手动修改这里的文件。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001809-1750088382.png)

图表 10 Ventoy存在设备中的配置文件

VentoyVLink用于创建和本地硬盘的虚拟链接，类似于快捷方式或者Linux的软链接。即将电脑本地硬盘已经有的镜像文件，通过此方法可以创建vlnk快捷方式，此快捷方式可以移动到搜索目录中，在选择镜像时可以选择vlnk文件。不过限制较多，应用场景较少，因为需要使用VentoyVlink的电脑要先拷贝镜像文件到本地硬盘，还需要使用VentoyVlink工具创建链接，主要在电脑可以开机使用软件、U盘内存不足情况下使用。故此不做过多讨论，详情请见https://www.ventoy.net/cn/doc\_vlnk.html。

2  获取PE系统镜像文件
=============

安装Ventoy的设备（U盘）如同“托盘”，不同的镜像文件如同托盘上的“水果”，打破先前传统的一个托盘只能盛放一个水果的尴尬场景。

2.1 启动盘制作软件导出
-------------

如今市面上纯在的大量不同的PE工具，如微PE、杏雨梨云、大白菜、老毛桃等各式各样的PE工具，均有不同的特色。导出ISO镜像复制到先前设置的搜索目录中，即可在Ventoy中选择。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191002068-453401394.png)

图表 11 将ISO等引导文件移动至搜索路径中

### 2.1.1 微PE导出ISO

点击右下角其他安装方式的光盘图标即可导出ISO镜像文件。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105202722014-1278691372.gif)

图表 12 微PE工具箱导出ISO

### 2.1.2  杏雨梨云导出ISO

在安装方式中选择生成ISO镜像文件即可。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105202832380-357698272.gif)

图表 13 杏雨梨云导出ISO

### 2.1.3 Linux的Live版本

Linux系统的一些发行版提供Live版本的下载，可以在不安装的情况下启动到Linux系统中，比如Kali Live版本在官网可下载（网址https://www.kali.org/get-kali/），配合配合数据永久化插件Plugin.persistence（网址https://www.ventoy.net/cn/plugin\_persistence.html），可以实现数据的保存在设备上。

3  VMware虚拟机模拟启动
================

当我们配置好Ventoy启动盘后，需要测试或者体验Ventoy的功能，可以直接使用物理机直接测试，也可使用VMware Workstation虚拟机来测试。本文使用VMware Workstation虚拟机在无实体机的情况下做测试。

3.1 虚拟机测试准备工作
-------------

插入设备（U盘），后再启动虚拟机（先启动虚拟机再插入设备可能会寻找不到设备）。

创建新的虚拟机，主要在添加虚拟机硬盘的设备（U盘）的映射。添加硬件-硬盘。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001787-1394752241.png)

图表 14 添加硬件-磁盘

虚拟机磁盘类型在此不重要，可以任意选择即可，建议选择不同类型的，后续在修改启动项时用于区分。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001724-927620596.png)

图表 15 选择磁盘类型

选择磁盘时务必选择“使用物理磁盘”，可以直接将插入的设备（U盘）直接直通到虚拟机中。虚拟机启动之前务必不要占用设备（U盘），当虚拟机启动后，设备（U盘）将被虚拟机独占，物理机也无法对设备（U盘）进行读写等操作。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001827-1057064431.png)

图表 16 选择磁盘-使用物理磁盘

在此选择物理磁盘设备PhysicalDrive，对应的序号为识别到硬盘的顺序，比如PhysicalDrive0为当前系统所在的磁盘，PhysicalDrive1为拓展的第二块磁盘或者设备（U盘），以此类推，倘若不清楚顺序，在添加虚拟机硬盘后可以在虚拟机硬件查看硬盘容量。使用情况选择“使用整个磁盘”。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001835-1502399139.png)

图表 17 选择物理磁盘

最后确认一下，容量是否和安装Ventoy的设备（U盘）匹配，若容量不匹配再重复操作添加硬盘的操作选择PhysicalDrive。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001782-1809517546.png)

图表 18 确认硬盘容量

3.2 虚拟机启动
---------

若虚拟机中有多块硬盘，可以删除掉其他空硬盘避免干扰只保留添加的Ventoy设备（U盘），也可在虚拟机开机时按ESC选择启动硬盘。使用Ctrl+Alt快捷键可以让鼠标焦点在虚拟机和物理机切换，后续操作将不做过多赘述。

本文使用修改虚拟机vbios的通用的方式来修改启动项。

![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191001946-296446007.png) 

图表 19 虚拟机进入vbios

在vbios中，按“→”到“Boot项”，按“↓”选中“Hard Drive”按Enter（回车）展开硬盘列表，按“↓”目标选中需要操作的硬盘，按“+”向上提，将之前的NVME虚拟硬盘添加到顶部。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105191002086-1761259064.png)

图表 20 修改启动项示意图

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105202938249-341152399.gif)

图表 21 完整的进入vbios修改操作

修改启动项只需要首次操作，后续直接启动即可。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105203012441-960243351.gif)

图表 22 正常启动的Ventoy

3.3 Ventoy功能测试
--------------

通过以上的操作后，模拟Ventoy启动盘的使用，使用↑↓键选择目标镜像，回车后即可启动。不仅可以启动PE镜像做系统维护，也可以直接安装系统镜像。

### 3.3.1 Ventoy启动微PE

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105203053584-84068285.gif)

图表 23 Ventoy启动微PE

### 3.3.2 Ventoy直接安装ESXI

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105203131082-1788125391.gif)

图表 24 Ventoy直接安装ESXI

4 Ventoy常见故障
============

4.1 镜像列表为空
----------

一般情况如果选择镜像的列表为空，可能是修改搜索路径、搜索深度上的修改导致无法找到文件，可以按F2进入全文件模式，手动打开镜像的路径，后续修改正确的配置文件即可。

4.2 花屏故障
--------

因为Ventoy默认会使用尽适应当前显示器的分辨率大小，在Legacy BIOS 模式下，启动 Windows/WinPE 的ISO文件时，也可能会与部分较老的主板不兼容产生花屏，可以按F7进入全文本DOS界面。与默认的模式功能完全一致，但是无法支持中文显示。

 ![](https://img2023.cnblogs.com/blog/2928139/202301/2928139-20230105203256441-1728724357.png)

图表 25 DOS界面风格的Ventoy

如果经常接触老主板和电脑，可以在配置文件中修改主题为CLI以一劳永逸，或再配置文件中添加以下JSON数据。

"theme": {
        "display\_mode": "CLI"
    }

>  其他
> ===
> 
> *   本文基于我之前的文章[https://www.cnblogs.com/alittlemc/p/16779280.html](https://www.cnblogs.com/alittlemc/p/16779280.html)修改，优化了文字排版、表达逻辑和图片，不然我的目录都是乱的，抓狂。
>     *   更新时间:2023年1月5日20:37:54