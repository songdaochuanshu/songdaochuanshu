---
layout: post
title: "ElasticSearchä¹‹Quick.ElasticSearch.Furionç»„ä»¶çš„ä½¿ç”¨"
date: "2022-11-03T01:50:22.370Z"
---
ElasticSearchä¹‹Quick.ElasticSearch.Furionç»„ä»¶çš„ä½¿ç”¨
=============================================

> ElasticSearch ä½¿ç”¨è¯´æ˜  
> æœ¬ç« ï¼Œæˆ‘ä»¬ä¸»è¦è®²è§£åœ¨.Net ä¸­å¯¹**Quick.ElasticSearch.Furion**çš„ä½¿ç”¨è¿›è¡Œä»‹ç»ï¼

ElasticSearch çš„å®˜æ–¹å®¢æˆ·ç«¯ API æ–‡æ¡£åœ°å€ï¼š[https://www.elastic.co/guide/en/elasticsearch/client/index.html](https://www.elastic.co/guide/en/elasticsearch/client/index.html)

ElasticSearch çš„å®˜æ–¹å®¢æˆ·ç«¯ API æ–‡æ¡£åœ°å€ï¼ˆ.Netï¼ŒElasticSearch8.xï¼‰ï¼š[https://www.elastic.co/guide/en/elasticsearch/client/net-api/current/index.html](https://www.elastic.co/guide/en/elasticsearch/client/net-api/current/index.html)

ElasticSearch çš„å®˜æ–¹å®¢æˆ·ç«¯ API æ–‡æ¡£åœ°å€ï¼ˆ.Netï¼ŒElasticSearch7.xï¼‰ï¼š[https://www.elastic.co/guide/en/elasticsearch/client/net-api/7.17/index.html](https://www.elastic.co/guide/en/elasticsearch/client/net-api/7.17/index.html)

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨.Net ä¸­æœ‰[Elasticsearch.Net](https://www.nuget.org/packages/Elasticsearch.Net)å’Œ[NEST](https://www.nuget.org/packages/NEST)ç­‰ç»„ä»¶å¯ä»¥å¯¹ ElasticSearch æœåŠ¡ç«¯è¿›è¡Œå„ç§æ“ä½œã€‚

**`ä½†æ˜¯`**ï¼Œ**`ä½†æ˜¯`**ï¼Œ**`ä½†æ˜¯`**ï¼Œç”±äº ElasticSearch æä¾›çš„æ˜¯å„ç±» API æ¥å£ï¼Œå¹¶ä¸”æŸ¥è¯¢å‚æ•°ï¼ˆJSONï¼‰æ¡ä»¶ä¼šæœ‰å¾ˆæ·±çš„åµŒå¥—ï¼Œè¿™å°±å¯¼è‡´äº†[Elasticsearch.Net](https://www.nuget.org/packages/Elasticsearch.Net)å’Œ[NEST](https://www.nuget.org/packages/NEST)ç­‰ç»„ä»¶åœ¨ä½¿ç”¨çš„æ—¶å€™ä¹Ÿæœ‰å¾ˆæ·±çš„å†…åµŒæ¡ä»¶ï¼ŒåŒ…æ‹¬å„ç§é“¾å¼æ“ä½œç­‰ï¼Œå¦‚æœä¸æ˜¯`è€æ‰‹`ä½¿ç”¨éš¾åº¦éå¸¸å¤§ï¼Œä¸ºäº†é™ä½ä½¿ç”¨éš¾åº¦ï¼Œ**[Quick.ElasticSearch.Furion](https://www.nuget.org/packages/Quick.ElasticSearch.Furion)**ç»„ä»¶ç”±æ­¤è¯ç”Ÿäº†ã€‚

ä¸ºäº†æ›´å¥½æ›´ç®€å•çš„åœ¨.Net Core ä¸­ä½¿ç”¨ ElasticSearchï¼Œç‰¹æ­¤åŸºäº**NEST**å°è£…äº†**Quick.ElasticSearch.Furion**ç»„ä»¶ã€‚

*   **Quick.ElasticSearch.Furion**ï¼šä¾èµ–äº.Net6+ã€Furion

Quick.ElasticSearch.Furion åŒ…åœ°å€ä¸ºï¼š[https://www.nuget.org/packages/Quick.ElasticSearch.Furion](https://www.nuget.org/packages/Quick.ElasticSearch.Furion)

å…³äº Quick.ElasticSearch.Furion çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

1ã€ğŸ¹ æ›´æ–°æ—¥å¿—
---------

*   1.0.3
    
    *   è°ƒæ•´ï¼ˆç®€åŒ–ï¼‰äº†æ–¹æ³•`GetModelsAll`ã€`GetModelsAllAsync`ã€`GetModels`ã€`GetModelsAsync`ã€`GetModelsFields`å’Œ`GetModelsFieldsAsync`çš„æ’åºå‚æ•°ä¼ å…¥æ–¹å¼ï¼›
        
    *   è°ƒæ•´äº†`InsertModels`å’Œ`InsertModelsAsync`æ–¹æ³•çš„å†…éƒ¨å®ç°ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ·»åŠ å¤±è´¥é‡‡ç”¨äº†`Errors`å±æ€§ä»¥åŠ`ItemsWithErrors`é”™è¯¯å¯¹è±¡é›†åˆï¼›
        
    *   å¢åŠ äº†`InsertModelsBatch`æ–¹æ³•ï¼Œåˆ†æ‰¹æ·»åŠ æ•°æ®ï¼Œé€‚ç”¨äºå¤§æ‰¹é‡æ·»åŠ æ•°æ®çš„æƒ…å†µï¼›
        
    *   è°ƒæ•´äº†`GetGroupValues`ã€`GetGroupValuesAsync`ã€`GetGroupCount`ã€`GetGroupCountAsync`ã€`GetGroupCountSmma`ã€`GetGroupCountSmmaAsync`ã€`GetGroupsCount`ã€`GetGroupsCountAsync`ã€`GetGroupsDate`ã€`GetGroupsDateAsync`ã€`GetGroupsDateSmma`ã€`GetGroupsDateSmmaAsync`ã€`GetGroupsDateSub`ã€`GetGroupsDateSubAsync`ã€`GetStatiCount`ã€`GetStatiCountAsync`ã€`GetStatiSumMulti`å’Œ`GetStatiSumMultiAsync`æ–¹æ³•çš„å†…éƒ¨å®ç°ï¼›
        
    *   è°ƒæ•´äº†`AddLike`æ‰©å±•æ–¹å¼çš„å®ç°æ–¹å¼ä¸º Wildcardï¼›
        
    *   å¢åŠ äº†`AddIn`æ¡ä»¶æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼Œç±»ä¼¼ SQL çš„ IN æ¡ä»¶ï¼›
        
    *   å¯¹`GetStatiSumMulti`å’Œ`GetStatiSumMultiAsync`æ–¹æ³•è¿›è¡Œäº†æ€§èƒ½ä¼˜åŒ–ï¼Œå‡å°‘äº† Http è¯·æ±‚æ¬¡æ•°ã€‚
        
*   1.0.2
    
    *   æ–¹æ³•`GetGroupsCount`å’Œ`GetGroupsCountAsync`å¢åŠ äº†ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä»¥ä¾¿äºç”¨æˆ·è‡ªå®šä¹‰è¿”å›ç»Ÿè®¡æ•°é‡çš„ Key åç§°ï¼Œé»˜è®¤ä¸ºï¼šGroupCountï¼›
        
    *   å¢åŠ äº†è·å–`ElasticClient`å®¢æˆ·ç«¯å¯¹è±¡æ–¹æ³•ï¼š`GetClient`;
        
    *   å¢åŠ è·å–æ‰€æœ‰ç´¢å¼•çš„æ–¹æ³•`GetIndexs`å’Œ`GetIndexsAsync`ï¼›
        
    *   å¢åŠ äº†æ ¹æ®ä¸»é”® Id ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µå€¼çš„æ–¹æ³•`UpdateModelFieldsById`å’Œ`UpdateModelFieldsByIdAsync`ï¼›
        
    *   å¢åŠ äº†æ ¹æ®æŸ¥è¯¢æ¡ä»¶ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µå€¼çš„æ–¹æ³•`UpdateModelFieldsByCon`å’Œ`UpdateModelFieldsByConAsync`ï¼›
        
    *   å¢åŠ äº†æ ¹æ® Id å­—æ®µè·å–ä¸€æ¡æ•°æ®çš„æ–¹æ³•`GetModel`å’Œ`GetModelAsync`ï¼›
        
    *   è°ƒæ•´äº†`InsertModels`å’Œ`InsertModelsAsync`æ–¹æ³•çš„å®ç°ï¼Œç”±åŸæ¥çš„`Bulkï¼ˆBulkAsyncï¼‰`è°ƒæ•´ä¸ºäº†`IndexManyï¼ˆIndexManyAsyncï¼‰`æ–¹å¼ã€‚
        
*   1.0.1
    
    *   å¢åŠ äº†æ‰©å±•æ–¹æ³• CreateEsQueryModel å’Œ AddEsQueryModelï¼›
        
    *   é‡å†™äº†æŸ¥è¯¢æ¡ä»¶çš„ä½¿ç”¨æ–¹å¼ï¼›
        
    *   å°†æ‰€æœ‰æ¶‰åŠåˆ°æŸ¥è¯¢æ¡ä»¶çš„æ–¹æ³•éƒ½è¿›è¡Œäº†è°ƒæ•´ï¼›
        
    *   ç®€åŒ–äº†`GetStatiSumMulti`å’Œ`GetStatiSumMultiAsync`æ–¹æ³•æ‰€éœ€å‚æ•°çš„ä¼ å…¥æ–¹å¼;
        
    *   æ–¹æ³•`GetStatiSumMulti`å’Œ`GetStatiSumMultiAsync`å¢åŠ äº†ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œé”™è¯¯å›è°ƒæ–¹æ³•ã€‚
        
*   1.0.0
    
    *   å…¨æ–°ç»„ä»¶é‡ç£…å‘å¸ƒï¼›
        
    *   æ”¯æŒåˆ‡æ¢è¿æ¥åŠŸèƒ½;
        
    *   æ”¯æŒæ£€æŸ¥åˆ›å»ºåˆ é™¤ç´¢å¼•ï¼›
        
    *   æ”¯æŒè·å–ç´¢å¼•å¥åº·çŠ¶æ€ï¼›
        
    *   æ”¯æŒæ·»åŠ æ•°æ®ï¼›
        
    *   æ”¯æŒä¿®æ”¹æ•°æ®ï¼›
        
    *   æ”¯æŒåˆ é™¤æ•°æ®ï¼›
        
    *   æ”¯æŒè·å–æ•°æ®ï¼›
        
    *   æ”¯æŒåˆ†ç»„ç»Ÿè®¡æŸ¥è¯¢ï¼›
        
    *   æ”¯æŒè·å–æ€»æ¡æ•°ã€æœ€å¤§ã€æœ€å°ã€æ±‚å’Œæˆ–å¹³å‡å€¼ç­‰ã€‚
        

* * *

2ã€ğŸŸ Quick.ElasticSearch.Furion ä½¿ç”¨è¯´æ˜
------------------------------------

è¯¥ç»„ä»¶æ˜¯åŸºäº`NEST`å’Œ`Furion`ç»„ä»¶è¿›è¡Œå°è£…ä½¿ç”¨çš„ï¼Œç›®çš„åœ¨äºç»“åˆ.Net Core æ›´å¿«ã€æ›´ç®€å•å’Œæ›´çµæ´»çš„ä½¿ç”¨ ElasticSearchï¼ï¼ï¼

**ç»„ä»¶ä½¿ç”¨å¯¹æ¯”ï¼š**

å‡è®¾æˆ‘ä»¬è¦å®ç°å¦‚ä¸‹æ•°æ®æ ¼å¼çš„ç»Ÿè®¡ï¼š

    [
        {
            "Name": "2021-01",
            "Count": 100,
            "Group": [
                {
                    "Name": "ç¢çŸ³",
                    "Count": 3,
                    "Sum": 1000,
                    "Max": 100,
                    "Min": 10,
                    "Avg": 50
                }
            ]
        }
    ]
    

**ä½¿ç”¨ Quick.ElasticSearch.Furion ç»„ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š**

    //è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰
    //ç»Ÿè®¡çš„æ—¶é—´é—´éš”ç»´åº¦æ”¯æŒçš„è¡¨è¾¾å¼æœ‰ï¼ˆ1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateSub = _quickElasticSearch.GetGroupsDateSub<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, "1h", "yyyy-MM-dd HH:mm", queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateSubAsync = await _quickElasticSearch.GetGroupsDateSubAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, "1h", "yyyy-MM-dd HH:mm", queryCon);
    

**ä½¿ç”¨ NEST ç»„ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š**

    /// <summary>
    /// è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="field">è¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime</param>
    /// <param name="fieldGroup">å¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName</param>
    /// <param name="fieldGroupStati">è¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price</param>
    /// <param name="dateInterval">ç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰</param>
    /// <param name="dateFormat">ç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸ºyyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸ºyyyy-MM-dd HH:mm:ssï¼‰</param>
    /// <param name="esQueryList">åŠ¨æ€æŸ¥è¯¢æ¡ä»¶</param>
    /// <returns>è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å«3ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º<![CDATA[List<Dictionary<string, object>>]]>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š[{"Name":"2021-01","Count":100,"Group":[{"Name":"ç¢çŸ³","Count":3,"Sum":1000,"Max":100,"Min":10,"Avg":50}]}]</returns>
    public (bool IsSucc, string ErrMsg, List<Dictionary<string, object>>? Data) GetGroupsDateSub<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null) where T : class, new()
    {
        try
        {
            //æŸ¥è¯¢æ¡ä»¶
            Func<QueryContainerDescriptor<T>, QueryContainer> query = q =>
            {
                QueryContainer ret = q;
    
                if (esQueryList != null && esQueryList.Count > 0)
                {
                    //ç»„è£…æ¡ä»¶ä¸º&&æˆ–||å…³ç³»
                    for (int i = 0; i < esQueryList.Count; i++)
                    {
                        if (esQueryList[i].QueryCon.Count > 0)
                        {
                            if (i == 0)
                            {
                                ret = esQueryList[i].QueryType == EsQueryType.And ? q.Bool(b => b.Must(esQueryList[i].QueryCon)) : q.Bool(b => b.Should(esQueryList[i].QueryCon));
                            }
                            else
                            {
                                ret = esQueryList[i].PrevConType == EsQueryType.And ?
                                    ret && (esQueryList[i].QueryType == EsQueryType.And ? q.Bool(b => b.Must(esQueryList[i].QueryCon)) : q.Bool(b => b.Should(esQueryList[i].QueryCon))) ://æ·»åŠ &&å¹¶ä¸”å…³ç³»
                                    ret || (esQueryList[i].QueryType == EsQueryType.And ? q.Bool(b => b.Must(esQueryList[i].QueryCon)) : q.Bool(b => b.Should(esQueryList[i].QueryCon))); //æ·»åŠ ||æˆ–å…³ç³»
                            }
                        }
                    }
                }
    
                return ret;
            };
    
            var ret = new List<Dictionary<string, object>>();
    
            var response = _client.Search<T>(s => s
                .Index(GetIndexName<T>())
                .Query(query)
                .Aggregations(ag => ag
                    .DateHistogram("StatiGroup", dh => dh
                        .Field(field)                       //éœ€è¦èšåˆåˆ†ç»„çš„å­—æ®µåç§°, ç±»å‹éœ€è¦ä¸ºdate, æ ¼å¼æ²¡æœ‰è¦æ±‚
                        .CalendarInterval(dateInterval)     //æ—¶é—´é—´éš”ï¼Œæ­¤å¤„è®¾ç½®ä¸º1ä¸ªæœˆï¼ˆ1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰
                        .TimeZone("+08:00")                 //è®¾ç½®æ—¶åŒº, è¿™æ ·å°±ç›¸å½“äºä¸œå…«åŒºçš„æ—¶é—´
                        .Format(dateFormat)                 //è¿”å›å€¼æ ¼å¼åŒ–ï¼ŒHHå¤§å†™ï¼Œä¸ç„¶ä¸èƒ½åŒºåˆ†ä¸Šåˆã€ä¸‹åˆ
                        .MinimumDocumentCount(0)            //ä¸ºç©ºçš„è¯åˆ™å¡«å……0
                        .Order(HistogramOrder.KeyAscending) //æ ¹æ®æ—¥æœŸå­—æ®µå‡åºæ’åˆ—
    
                        .Aggregations(ag => ag
                            .Terms("StatiGroup-1", t => t
                                .Field(fieldGroup)
                                .Size(_allConfig.MaxQueryCount)
                                .Order(o => o
                                    .KeyAscending()  //æŒ‰ç…§åˆ†ç»„å­—æ®µå‡åºæ’åº
                                    .CountAscending()//æŒ‰ç…§ç»Ÿè®¡æ•°é‡å‡åºæ’åº
                                )
    
                                //ç»Ÿè®¡fieldStatiå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼
                                .Aggregations(ags => ags
                                    .Sum("StatiSum", m => m.Field(fieldGroupStati))         //æ±‚å’Œ
                                    .Max("StatiMax", m => m.Field(fieldGroupStati))         //æœ€å¤§å€¼
                                    .Min("StatiMin", m => m.Field(fieldGroupStati))         //æœ€å°å€¼
                                    .Average("StatiAvg", m => m.Field(fieldGroupStati))     //å¹³å‡å€¼
                                )
                            )
                        )
                    )
                )
                .TrackTotalHits(true)//TrackTotalHitså¿…é¡»è®¾ç½®ä¸ºtrueï¼Œå¦åˆ™è¿”å›totalæ€»æ¡æ•°è¶…è¿‡10000æ¡æ—¶æ€»æ˜¯è¿”å›10000
            );
    
            if (response.IsValid)
            {
                //è·å–åˆ†ç»„æ ‡è¯†
                var stati = response.Aggregations["StatiGroup"];
                //è·å–åˆ†ç»„åçš„é›†åˆ
                var statiItems = ((BucketAggregate)stati).Items;
    
                foreach (var bucketMain in statiItems)
                {
                    var item = (DateHistogramBucket)bucketMain;
                    var retGroup = new List<Dictionary<string, object>>();
    
                    foreach (var bucket in ((Nest.BucketAggregate)(item.Values.ToList()[0])).Items)
                    {
                        var obj = (KeyedBucket<Object>)bucket;
    
                        retGroup.Add(new Dictionary<string, object> {
                            { "Name",obj.Key.ToString()!},
                            { "Count",obj.DocCount??0},
                            { "Sum",IsNotNull(obj.AverageBucket("StatiSum").Value)? ToDouble2Dec(obj.AverageBucket("StatiSum").Value!):0},
                            { "Max",IsNotNull(obj.AverageBucket("StatiMax").Value)? ToDouble2Dec(obj.AverageBucket("StatiMax").Value!):0},
                            { "Min",IsNotNull(obj.AverageBucket("StatiMin").Value)? ToDouble2Dec(obj.AverageBucket("StatiMin").Value!):0},
                            { "Avg",IsNotNull(obj.AverageBucket("StatiAvg").Value)? ToDouble2Dec(obj.AverageBucket("StatiAvg").Value!):0},
                        });
                    }
    
                    ret.Add(new Dictionary<string, object>
                    {
                        { "Name",item.KeyAsString},
                        { "Count",item.DocCount??0},
                        { "Group",retGroup}
                    });
                }
            }
    
            return (response.IsValid, !response.IsValid ? response.DebugInformation : string.Empty, ret);
        }
        catch (Exception ex)
        {
            return (false, ex.Message, null);
        }
    }
    

ç”±æ­¤å¯è§ï¼ŒNEST ä½¿ç”¨çš„å¤æ‚ç¨‹åº¦ï¼Œæ›´ä¸ç”¨è¯´ ElasticSearch.Net äº†ã€‚

**åŠŸèƒ½è¯´æ˜ï¼š**

*   æ ¹æ®é…ç½®æ–‡ä»¶è¯»å– ElasticSearch è¿æ¥çš„å„ä¸ªé…ç½®ï¼ˆå¦‚ï¼šElasticSearch æœåŠ¡åœ°å€ã€è´¦å·å’Œå¯†ç ç­‰ï¼‰ï¼›
    
*   æ”¯æŒé…ç½®å¤šä¸ª ElasticSearch çš„è¿æ¥é…ç½®ï¼›
    
*   æ”¯æŒåŠ¨æ€åˆ‡æ¢ ElasticSearch çš„è¿æ¥é…ç½®ï¼›
    
*   æ”¯æŒæ£€æŸ¥åˆ›å»ºåˆ é™¤ç´¢å¼•ï¼›
    
*   æ”¯æŒè·å–ç´¢å¼•å¥åº·çŠ¶æ€ï¼›
    
*   æ”¯æŒæ·»åŠ æ•°æ®ï¼ˆå•æ¡ã€å¤šæ¡ï¼‰ï¼›
    
*   æ”¯æŒä¿®æ”¹æ•°æ®ï¼ˆå•æ¡ã€å¤šæ¡ï¼‰ï¼›
    
*   æ”¯æŒåˆ é™¤æ•°æ®ï¼ˆæ ¹æ® Id åˆ é™¤ã€æ ¹æ®æ¡ä»¶åˆ é™¤ï¼‰ï¼›
    
*   æ”¯æŒè·å–æ•°æ®ï¼ˆè·å–æ‰€æœ‰æ•°æ®ã€è·å–æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ã€è·å–æ‰€æœ‰æ»¡è¶³æ¡ä»¶å¹¶è¿”å›æŒ‡å®šå­—æ®µçš„æ•°æ®ã€æ ¹æ® Id è·å–ä¸€æ¡æ•°æ®ã€è·å–åˆ†é¡µçš„æ•°æ®ã€è·å–åˆ†é¡µå¹¶è¿”å›æŒ‡å®šå­—æ®µçš„æ•°æ®ï¼‰ï¼›
    
*   æ”¯æŒåˆ†ç»„ç»Ÿè®¡æŸ¥è¯¢ï¼ˆç»Ÿè®¡å•å­—æ®µå¹¶è¿”å›è¯¥å­—æ®µæ‰€æœ‰ç»Ÿè®¡å€¼ã€ç»Ÿè®¡å•å­—æ®µå¹¶è¿”å›è¯¥å­—æ®µæ‰€æœ‰ç»Ÿè®¡å€¼åŠå¯¹åº”çš„æ•°é‡ã€ç»Ÿè®¡å•æ®µå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œæœ€å¤§å€¼æœ€å°å€¼å’Œå¹³å‡å€¼ã€ç»Ÿè®¡å¤šä¸ªå­—æ®µå¹¶è¿”å›å¤šä¸ªå­—æ®µå¯¹åº”çš„å€¼ä»¥åŠå¯¹åº”åˆ†ç»„çš„æ•°æ®æ•°é‡ã€æŒ‰æœˆç»Ÿè®¡å¹¶è¿”å›æ¯ä¸ªæœˆåŠå…¶æ•°é‡ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œæ”¯æŒæŒ‰å¹´ã€å­£åº¦ã€æœˆä»½ã€æ˜ŸæœŸã€å¤©ã€å°æ—¶ã€åˆ†ã€ç§’ç­‰ç»´åº¦è¿›è¡Œç»Ÿè®¡ã€‘ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ã€‘ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ã€‘ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æŸå¹´ 1~12 æœˆç»Ÿè®¡æ¯ä¸ªæœˆçš„æŸä¸ªå­—æ®µæ¯ä¸ªæœˆçš„æ€»å’Œä»¥åŠè¿™ä¸€å¹´çš„æ€»å’Œã€‘ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ã€‘ã€è·å–åˆ†ç»„ç»Ÿè®¡æ•°æ®ã€æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ã€‘ï¼‰ï¼›
    
*   æ”¯æŒè·å–æ€»æ¡æ•°ã€æœ€å¤§ã€æœ€å°ã€æ±‚å’Œæˆ–å¹³å‡å€¼ç­‰ï¼ˆè·å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ€»æ¡æ•°ã€è·å–æŸå­—æ®µçš„æœ€å¤§å€¼æœ€å°å€¼æ±‚å’Œå¹³å‡å€¼å’Œæ€»æ•°ç­‰ã€è·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œï¼‰ã€‚
    

* * *

3ã€ğŸ– å®‰è£…
-------

å®‰è£…å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š

    Install-Package Quick.ElasticSearch.Furion
    

è¯¥ç»„ä»¶çš„å‘½åç©ºé—´ä¸ºï¼š`Quick.ElasticSearch`ã€‚

![Quick.ElasticSearch.Furion](https://img2022.cnblogs.com/blog/346453/202210/346453-20221023184839365-1934268018.png)

![Quick.ElasticSearch.Furion](https://img2022.cnblogs.com/blog/346453/202210/346453-20221023184850592-682059658.png)

* * *

4ã€ğŸ§€ é…ç½®
-------

### 4.1ã€ğŸ¥ é…ç½®`appsettings.json`

åœ¨`appsettings.json`é…ç½®æ–‡ä»¶ä¸­åˆ›å»ºèŠ‚ç‚¹`QuickElasticSearch`\>`MaxQueryCount`å’Œ`QuickElasticSearchConfigs`ï¼ŒMaxQueryCount ä¸º ElasticSearch ç´¢å¼•æŸ¥è¯¢çš„æœ€å¤§æ¡æ•°ï¼ˆElasticSearch å†…éƒ¨é»˜è®¤ä¸º 10000ï¼‰ï¼ŒQuickElasticSearchConfigs ä¸ºæ•°ç»„ç±»å‹ï¼ˆå³å¯é…ç½®å¤šä¸ª ElasticSearch æœåŠ¡åœ°å€ï¼‰ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š

    {
        "QuickElasticSearch": {
            "MaxQueryCount": 2000000000,
            "QuickElasticSearchConfigs": [
                {
                    "Default": true,
                    "ConnId": 1,
                    "DefaultIndex": "",
                    "UserName": "elastic",
                    "Password": "123456",
                    "Uri": ["http://192.168.3.200:9200/"]
                }
            ]
        }
    }
    

**é…ç½®è¯´æ˜ï¼š**

å±æ€§åç§°

å±æ€§è¯´æ˜

æ˜¯å¦å¿…å¡«

å¤‡æ³¨

MaxQueryCount

å…¨å±€è®¾ç½® ElasticSearch ç´¢å¼•æŸ¥è¯¢çš„æœ€å¤§æ¡æ•°ï¼ŒElasticSearch é»˜è®¤ä¸º 10000

**æ³¨æ„ï¼šæ­¤å¤„æˆ‘ä»¬æœ€å¥½è®¾ç½®ä¸º 2000000000ï¼ŒåŸå› æ˜¯ ElasticSearch å†…éƒ¨é»˜è®¤ä¸€æ¬¡æ€§æœ€å¤šè¿”å› 10000 æ¡æ•°æ®**

Default

æ˜¯å¦ä¸ºé»˜è®¤è¿æ¥

é»˜è®¤ä¸º false

ConnId

è¿æ¥ Idï¼ˆè¯·ç¡®ä¿è¯¥ Id çš„å”¯ä¸€æ€§ï¼‰

âˆš

å¦‚æœè¦åŠ¨æ€åˆ‡æ¢è¿æ¥é…ç½®ï¼Œè¯·ç¡®ä¿è¯¥ Id æœ‰å€¼å¹¶ä¸”å”¯ä¸€

DefaultIndex

é»˜è®¤ç´¢å¼•

UserName

è¿æ¥è´¦æˆ·

âˆš

Password

è¿æ¥å¯†ç 

âˆš

Uri

è¿æ¥åœ°å€é›†åˆï¼Œæ•°æ®ç±»å‹ä¸º List<string>

âˆš

### 4.2ã€ğŸ å®ä½“ç‰¹æ€§

æˆ‘ä»¬ä¸ºå®ä½“æä¾›äº†`QuickElasticSearchConfig`ç‰¹æ€§ï¼Œèµ·ä½œç”¨æ˜¯è®¾ç½®è¯¥å®ä½“çš„`ç´¢å¼•åç§°`å’Œ`ä¸»é”®å­—æ®µ`ï¼Œå¦‚ä¸‹æ‰€ç¤ºå°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„ä¸€ä¸ªå®ä½“å¯¹è±¡ï¼š

    using Nest;
    
    namespace Quick.ElasticSearch.TestFurion
    {
        [QuickElasticSearchConfig(indexName: "test_index", primaryKey: "Id")]
        public class TestElasticSearchModel
        {
            public long Id { get; set; }
    
            [Keyword]
            public string UserType { get; set; }
    
            public int UserId { get; set; }
    
            [Keyword]
            public string UserName { get; set; }
    
            public int UserAge { get; set; }
    
            public float Money { get; set; }
    
            public float MoneyOth { get; set; }
    
            public DateTime CreateTime { get; set; }
        }
    }

**è¯´æ˜ï¼š**

*   indexNameï¼šç´¢å¼•åç§°ï¼›
    
*   primaryKeyï¼šä¸»é”®åç§°ã€‚
    

### 4.3ã€ğŸ¥ é…ç½® Program.cs

ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯**Furion**ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯åœ¨ç¨‹åºå¯åŠ¨æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ä»£ç ï¼ˆå…·ä½“å¯å‚è€ƒ[Furion å…¥é—¨æŒ‡å—](https://dotnetchina.gitee.io/furion/docs/serverun/)ï¼‰ï¼Œç›®çš„æ˜¯æ³¨å†Œ**ElasticSearch æœåŠ¡**ã€‚

    [STAThread]
    static void Main()
    {
        ApplicationConfiguration.Initialize();
    
        //åˆå§‹åŒ–Furion
        Serve.Run(GenericRunOptions.DefaultSilence);
    }

    public void ConfigureServices(IServiceCollection services)
    {
        //æ³¨å†ŒFrmMainçª—ä½“ç±»
        services.AddScoped<FrmMain>();
    
        //æ³¨å…¥IQuickElasticSearchçš„æ–¹å¼
        //é€šè¿‡AddElasticSearchæ·»åŠ ä¾èµ–æ³¨å…¥
        services.AddElasticSearch();
    
        ////ä½¿ç”¨æ„é€ å‡½æ•°è·å–å®ä¾‹çš„æ–¹å¼ï¼š
        ////é€šè¿‡AddElasticSearchæ·»åŠ ä¾èµ–æ³¨å…¥ï¼Œå¹¶æ³¨å†ŒTestConsumerClassForDIç±»
        //services.AddElasticSearch<TestConsumerClassForDI>()
    
        //DIå®¹å™¨ç”ŸæˆserviceProvider
        var serviceProvider = services.BuildServiceProvider();
    
        //é€šè¿‡serviceProviderè·å–MainFormçš„æ³¨å†Œå®ä¾‹
        var frmMain = serviceProvider.GetRequiredService<FrmMain>();
        //var frmMain = (FrmMain)serviceProvider.GetService(typeof(FrmMain));
    
        Application.Run(frmMain);
    }

**è¯´æ˜ï¼š**ä¸Šè¿°çš„å…³é”®ç‚¹å°±åœ¨äºè°ƒç”¨**.AddElasticSearch()**æˆ–è€…**.AddElasticSearch<T>()**æ–¹æ³•å¯¹æœåŠ¡è¿›è¡Œæ³¨å†Œã€‚

### 4.4ã€ğŸ è·å–ä¾èµ–æ³¨å…¥å¯¹è±¡

**å®šä¹‰`IQuickElasticSearch`å¯¹è±¡ï¼ˆä¾èµ–æ³¨å…¥æ–¹å¼ï¼‰ï¼š**

    public partial class FrmMain : Form
    {
        //å®šä¹‰IQuickElasticSearchå¯¹è±¡
    	private readonly IQuickElasticSearch _quickElasticSearch;
    
    	public FrmMain(IQuickElasticSearch quickElasticSearch)
    	{
    		InitializeComponent();
    
    		//è®¾ç½®IQuickElasticSearchå¯¹è±¡
    		_quickElasticSearch = quickElasticSearch;
    	}
    }

* * *

5ã€ğŸ¥ª å…·ä½“ä½¿ç”¨
---------

### 5.1ã€ğŸ“® è·å– ElasticSearch å®¢æˆ·ç«¯

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

    _quickElasticSearch.GetClient();
    

### 5.2ã€ğŸŒ® åˆ‡æ¢è¿æ¥

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

    _quickElasticSearch.ChangeConn(2);
    

### 5.3ã€ğŸŒ¯ è·å–æ£€æŸ¥åˆ›å»ºåˆ é™¤ç´¢å¼•

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–æ‰€æœ‰ç´¢å¼•ï¼‰ï¼š**

    //åŒæ­¥
    var retGetIndexs = _quickElasticSearch.GetIndexs();
    
    //å¼‚æ­¥
    var retGetIndexsAsync = await _quickElasticSearch.GetIndexsAsync();
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨ï¼‰ï¼š**

    //åŒæ­¥
    var retIndexIsExist = _quickElasticSearch.IndexIsExist();
    
    //å¼‚æ­¥
    var retIndexIsExistAsync = await _quickElasticSearch.IndexIsExistAsync();
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆåˆ›å»ºç´¢å¼•ï¼‰ï¼š**

    //åŒæ­¥
    var retCreateIndex = _quickElasticSearch.CreateIndex<TestElasticSearchModel>();
    
    //å¼‚æ­¥
    var retCreateIndexAsync = await _quickElasticSearch.CreateIndexAsync<TestElasticSearchModel>();
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆåˆ é™¤ç´¢å¼•ï¼‰ï¼š**

    //åŒæ­¥
    var retDeleteIndex = _quickElasticSearch.DeleteIndex();
    
    //å¼‚æ­¥
    var retDeleteIndexAsync = await _quickElasticSearch.DeleteIndexAsync();
    

### 5.4ã€ğŸ¥™ è·å–ç´¢å¼•å¥åº·çŠ¶æ€

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–ç´¢å¼•å¥åº·çŠ¶æ€ï¼‰ï¼š**

    //åŒæ­¥
    var retGetHealthStatus = _quickElasticSearch.GetHealthStatus();
    
    //å¼‚æ­¥
    var retGetHealthStatusAsyncc = await _quickElasticSearch.GetHealthStatusAsync();
    

### 5.5ã€ğŸ§† æ·»åŠ æ•°æ®

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ·»åŠ æ•°æ®-å•æ¡ï¼‰ï¼š**

    var rand = new Random(Guid.NewGuid().GetHashCode());
    var testData = new TestElasticSearchModel
    {
        Id = YitIdHelper.NextId(),
        UserId = rand.Next(1, 9999),
        UserName = "Quber",
        UserAge = rand.Next(20, 80),
        Money = (float)1.429,
        MoneyOth = (float)2.556,
        CreateTime = DateTime.Now
    };
    var testDataAsync = new TestElasticSearchModel
    {
        Id = YitIdHelper.NextId(),
        UserId = rand.Next(1, 9999),
        UserName = "Jack",
        UserAge = rand.Next(20, 80),
        Money = (float)1.429,
        MoneyOth = (float)2.556,
        CreateTime = DateTime.Now
    };
    
    //åŒæ­¥
    var retInsertModel = _quickElasticSearch.InsertModel(testData);
    
    //å¼‚æ­¥
    var retInsertModelAsync = await _quickElasticSearch.InsertModelAsync(testDataAsync);

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ·»åŠ æ•°æ®-å¤šæ¡ï¼‰ï¼š**

    var testDatas = new List<TestElasticSearchModel>
    {
        new TestElasticSearchModel(),
        new TestElasticSearchModel()
    };
    
    //åŒæ­¥
    var retInsertModels = _quickElasticSearch.InsertModels(testDatas, (errList, errMsg, allList) =>
    {
        var thisErrList = errList;
        var thisErrMsg = errMsg;
    });
    
    //å¼‚æ­¥
    var retInsertModelsAsync = await _quickElasticSearch.InsertModelsAsync(testDatas, async (errList, errMsg, allList) =>
    {
        var thisErrList = errList;
        var thisErrMsg = errMsg;
    
        await Task.CompletedTask;
    });

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ·»åŠ æ•°æ®-å¤šæ¡ï¼Œåˆ†æ‰¹æ¬¡ï¼‰ï¼š**

    var testDatas = new List<TestElasticSearchModel>
    {
        new TestElasticSearchModel(),
        new TestElasticSearchModel()
    };
    
    var retInsertModelsBatch = _quickElasticSearch.InsertModelsBatch(testDatas, (errList, errMsg, allList) =>
    {
        var thisErrList = errList;
        var thisErrMsg = errMsg;
    },
    
    //æ¯æ‰¹æ¬¡æ·»åŠ çš„æ•°æ®æ¡æ•°
    1000,
    
    //é›†ç¾¤ç¹å¿™ï¼ŒæŠ¥429é”™è¯¯ç çš„æ—¶å€™ï¼Œç­‰å¾…å¤šä¹…è¿›è¡Œé‡è¯•
    "5s",
    
    //é‡è¯•æ¬¡æ•°
    2);

### 5.6ã€ğŸ¥— ä¿®æ”¹æ•°æ®

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¿®æ”¹æ•°æ®-æ ¹æ®ä¸»é”® Id ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼ï¼‰ï¼š**

    //ç±»ä¼¼SQLï¼šUPDATE A SET col1=123,col2=456 WHERE Id=1
    
    //åŒæ­¥
    var retUpdateModelFieldById = _quickElasticSearch.UpdateModelFieldsById<TestElasticSearchModel>(342235158519882, new { UserAge = 32, Money = 66.66 });
    
    //å¼‚æ­¥
    var retUpdateModelFieldByIdAsync = await _quickElasticSearch.UpdateModelFieldsByIdAsync<TestElasticSearchModel>(342235158519882, new { UserAge = 32, Money = 66.66 });
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¿®æ”¹æ•°æ®-æ ¹æ®æŸ¥è¯¢æ¡ä»¶ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼ï¼‰ï¼š**

    //ç±»ä¼¼SQLï¼šUPDATE A SET col1=123,col2=456 WHERE (Id=1 OR Id=2)
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id = 342235158519882 OR Id = 342235158519883)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,
            EsQueryType.Or,
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id = 342235158519882 OR Id = 342235158519883)
                queryCon
                    .AddEqu(m => m.Id, 342235158519882)
                    .AddEqu(m => m.Id, 342235158519883);
            });
    
    //å¼‚æ­¥
    var retUpdateModelFieldsByCon = _quickElasticSearch.UpdateModelFieldsByCon<TestElasticSearchModel>(queryCon, new { UserAge = 13, Money = 996.33 });
    
    //åŒæ­¥
    var retUpdateModelFieldsByConAsync = await _quickElasticSearch.UpdateModelFieldsByConAsync<TestElasticSearchModel>(queryCon, new { UserAge = 14, Money = 997.44 });
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¿®æ”¹æ•°æ®-å•æ¡ï¼‰ï¼š**

    var rand = new Random(Guid.NewGuid().GetHashCode());
    var testData = new TestElasticSearchModel
    {
        Id = 1,
        UserId = rand.Next(1, 9999),
        UserName = "Quber1",
        UserAge = rand.Next(20, 80),
        Money = (float)2.429,
        MoneyOth = (float)3.556,
        CreateTime = DateTime.Now
    };
    var testDataAsync = new TestElasticSearchModel
    {
        Id = 3,
        UserId = rand.Next(1, 9999),
        UserName = "Jack1",
        UserAge = rand.Next(20, 80),
        Money = (float)2.429,
        MoneyOth = (float)3.556,
        CreateTime = DateTime.Now
    };
    
    //åŒæ­¥
    var retUpdateModel = _quickElasticSearch.UpdateModel(testData);
    
    //å¼‚æ­¥
    var retUpdateModelAsync = await _quickElasticSearch.UpdateModelAsync(testDataAsync);

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¿®æ”¹æ•°æ®-å¤šæ¡ï¼‰ï¼š**

    var rand = new Random(Guid.NewGuid().GetHashCode());
    var testDatas = new List<TestElasticSearchModel>
    {
        new TestElasticSearchModel
        {
            Id = 1,
            UserId = rand.Next(1, 9999),
            UserName = "Quber1",
            UserAge = rand.Next(20, 80),
            Money = (float)2.429,
            MoneyOth = (float)3.556,
            CreateTime = DateTime.Now
        },
        new TestElasticSearchModel
        {
            Id = 3,
            UserId = rand.Next(1, 9999),
            UserName = "Jack1",
            UserAge = rand.Next(20, 80),
            Money = (float)2.429,
            MoneyOth = (float)3.556,
            CreateTime = DateTime.Now
        },
        new TestElasticSearchModel
        {
            Id = 4,
            UserId = rand.Next(1, 9999),
            UserName = "Jack1",
            UserAge = rand.Next(20, 80),
            Money = (float)2.429,
            MoneyOth = (float)3.556,
            CreateTime = DateTime.Now
        }
    };
    
    //åŒæ­¥
    var retUpdateModels = _quickElasticSearch.UpdateModels(testDatas, (errList, errMsg, allList) =>
    {
        var thisErrList = errList;
        var thisErrMsg = errMsg;
    });
    
    //å¼‚æ­¥
    var retUpdateModelsAsync = await _quickElasticSearch.UpdateModelsAsync(testDatas, async (errList, errMsg, allList) =>
    {
        var thisErrList = errList;
        var thisErrMsg = errMsg;
    
        await Task.CompletedTask;
    });

### 5.7ã€ğŸ¥˜ åˆ é™¤æ•°æ®

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆåˆ é™¤æ•°æ®-æ ¹æ® Idï¼‰ï¼š**

    //åŒæ­¥
    var retDeleteModel = _quickElasticSearch.DeleteModel<TestElasticSearchModel>(340504986927178);
    
    //å¼‚æ­¥
    var retDeleteModelAsync = await _quickElasticSearch.DeleteModelAsync<TestElasticSearchModel>(340504986927176);
    

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆåˆ é™¤æ•°æ®-æ ¹æ®æ¡ä»¶ï¼‰ï¼š**

    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462542 AND UserAge <= 60) OR (Id = 340506710462539 OR Id = 340506710462538)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462542 AND UserAge <= 60)
                queryCon
                    .AddGte(m => m.Id, 340506710462542)
                    .AddLte(m => m.UserAge, 60);
            })
        //æ·»åŠ å¦ä¸€ä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(
            EsQueryType.Or,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.Or,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id = 340506710462539 OR Id = 340506710462538)
                queryCon
                    .AddEqu(m => m.Id, 340506710462539)
                    .AddEqu(m => m.Id, 340506710462538);
            });
    
    //åŒæ­¥
    var retDeleteModelBy = _quickElasticSearch.DeleteModelBy<TestElasticSearchModel>(queryCon);
    
    //å¼‚æ­¥
    var retDeleteModelByAsync = await _quickElasticSearch.DeleteModelByAsync<TestElasticSearchModel>(queryCon);
    

### 5.8ã€ğŸ² è·å–æ•°æ®

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–æ‰€æœ‰æ•°æ®ï¼‰ï¼š**

//æ’åºæ¡ä»¶ï¼šORDER BY Id DESC
    
    //åŒæ­¥
    var retGetModelsAll = _quickElasticSearch.GetModelsAll<TestElasticSearchModel>(m => m.Id, true);
    
    //å¼‚æ­¥
    var retGetModelsAllAsync = await _quickElasticSearch.GetModelsAllAsync<TestElasticSearchModel>(m => m.CreateTime, false);
# è·å–æ‰€æœ‰æ•°æ®
    # ç±»ä¼¼SQLï¼šSELECT TOP 2000000000 * FROM A ORDER BY CreateTime DESC
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "from":0,
        "query":{
            "match_all":{
    
            }
        },
        "size":2000000000,
        "sort":[
            {
                "CreateTime":{
                    "order":"asc"
                }
            }
        ]
    }
{
        "took": 8,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362545766476",
                    "_score": null,
                    "_source": {
                        "Id": 343362545766476,
                        "UserType": "é«˜çº§ç”¨æˆ·",
                        "UserId": 5133,
                        "UserName": "Quber9",
                        "UserAge": 63,
                        "Money": 9.429,
                        "MoneyOth": 10.556,
                        "CreateTime": "2022-10-17T16:05:48.5451264+08:00"
                    },
                    "sort": [1665993948545]
                },
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362545766473",
                    "_score": null,
                    "_source": {
                        "Id": 343362545766473,
                        "UserType": "ç³»ç»Ÿç”¨æˆ·",
                        "UserId": 7360,
                        "UserName": "Quber6",
                        "UserAge": 57,
                        "Money": 6.429,
                        "MoneyOth": 7.5559998,
                        "CreateTime": "2022-10-17T16:05:48.5451259+08:00"
                    },
                    "sort": [1665993948545]
                }
                â€¦â€¦
            ]
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼‰ï¼š**

//æ’åºæ¡ä»¶ï¼šORDER BY Id DESC
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462535 AND UserAge <= 70)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462535 AND UserAge <= 70)
                queryCon
                    .AddGte(m => m.Id, 340506710462535)
                    .AddLte(m => m.UserAge, 70);
            });
    
    //åŒæ­¥
    var retGetModels = _quickElasticSearch.GetModels<TestElasticSearchModel>(m => m.Id, true, queryCon);
    
    //å¼‚æ­¥
    var retGetModelsAsync = await _quickElasticSearch.GetModelsAsync<TestElasticSearchModel>(m => m.Id, true, queryCon);
# è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®
    # ç±»ä¼¼SQLï¼šSELECT TOP 2000000000 * FROM A WHERE Id >= 340506710462535 AND UserAge <= 70 ORDER BY Id DESC
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "from":0,
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":340506710462535
                            }
                        }
                    },
                    {
                        "range":{
                            "UserAge":{
                                "lte":70
                            }
                        }
                    }
                ]
            }
        },
        "size":2000000000,
        "sort":[
            {
                "Id":{
                    "order":"desc"
                }
            }
        ]
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 65,
                "relation": "eq"
            },
            "max_score": null,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188366",
                    "_score": null,
                    "_source": {
                        "Id": 343362866188366,
                        "UserType": "ä¼šå‘˜ç”¨æˆ·",
                        "UserId": 2106,
                        "UserName": "Quber10",
                        "UserAge": 30,
                        "Money": 10.429,
                        "MoneyOth": 11.556,
                        "CreateTime": "2022-10-17T16:07:06.7733297+08:00"
                    },
                    "sort": [343362866188366]
                },
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188365",
                    "_score": null,
                    "_source": {
                        "Id": 343362866188365,
                        "UserType": "ç³»ç»Ÿç”¨æˆ·",
                        "UserId": 829,
                        "UserName": "Quber9",
                        "UserAge": 39,
                        "Money": 9.429,
                        "MoneyOth": 10.556,
                        "CreateTime": "2022-10-17T16:07:06.7733294+08:00"
                    },
                    "sort": [343362866188365]
                },
                â€¦â€¦
            ]
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰ï¼‰ï¼š**

//æ’åºæ¡ä»¶ï¼šORDER BY Id DESC
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462535 AND UserAge <= 70)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462535 AND UserAge <= 70)
                queryCon
                    .AddGte(m => m.Id, 340506710462535)
                    .AddLte(m => m.UserAge, 70);
            });
    
    //åŒæ­¥
    var retGetModelsFields = _quickElasticSearch.GetModelsFields<TestElasticSearchModel>(new List<string> { "UserId", "UserName", "UserAge" }, m => m.Id, true, queryCon);
    
    //å¼‚æ­¥
    var retGetModelsFieldsAsync = await _quickElasticSearch.GetModelsFieldsAsync<TestElasticSearchModel>(new List<string> { "UserId", "UserName", "UserAge" }, m => m.Id, true, queryCon);
# è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰
    # ç±»ä¼¼SQLï¼šSELECT TOP 2000000000 'UserId','UserName','UserAge' FROM A WHERE Id >= 340506710462535 AND UserAge <= 70 ORDER BY Id DESC
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "from":0,
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":340506710462535
                            }
                        }
                    },
                    {
                        "range":{
                            "UserAge":{
                                "lte":70
                            }
                        }
                    }
                ]
            }
        },
        "size":2000000000,
        "sort":[
            {
                "Id":{
                    "order":"desc"
                }
            }
        ],
        "_source":{
            "includes":[
                "UserId",
                "UserName",
                "UserAge"
            ]
        }
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 65,
                "relation": "eq"
            },
            "max_score": null,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188366",
                    "_score": null,
                    "_source": {
                        "UserName": "Quber10",
                        "UserId": 2106,
                        "UserAge": 30
                    },
                    "sort": [343362866188366]
                },
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188365",
                    "_score": null,
                    "_source": {
                        "UserName": "Quber9",
                        "UserId": 829,
                        "UserAge": 39
                    },
                    "sort": [343362866188365]
                }
                â€¦â€¦
            ]
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–ä¸€æ¡æ•°æ®-æ ¹æ®ä¸»é”® Id æŸ¥è¯¢ï¼‰ï¼š**

//åŒæ­¥
    var retGetModel = _quickElasticSearch.GetModel<TestElasticSearchModel>(342235158519882);
    
    //å¼‚æ­¥
    var retGetModelAsync = await _quickElasticSearch.GetModelAsync<TestElasticSearchModel>(342235158519883);
# è·å–ä¸€æ¡æ•°æ®ï¼ˆæ ¹æ®ä¸»é”®IdæŸ¥è¯¢ï¼‰
    # ç±»ä¼¼SQLï¼šSELECT * FROM A WHERE Id = 343362866188364
    GET /test_index/_doc/343362866188364
{
        "_index": "test_index",
        "_type": "_doc",
        "_id": "343362866188364",
        "_version": 1,
        "_seq_no": 14,
        "_primary_term": 1,
        "found": true,
        "_source": {
            "Id": 343362866188364,
            "UserType": "é«˜çº§ç”¨æˆ·",
            "UserId": 7438,
            "UserName": "Quber8",
            "UserAge": 53,
            "Money": 8.429,
            "MoneyOth": 9.556,
            "CreateTime": "2022-10-17T16:07:06.7733293+08:00"
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–ä¸€æ¡æ•°æ®-æ ¹æ®æŸå­—æ®µæŸ¥è¯¢ï¼‰ï¼š**

//åŒæ­¥
    var retGetModel = _quickElasticSearch.GetModel<TestElasticSearchModel>(m => m.UserId, 340506710462542);
    
    //å¼‚æ­¥
    var retGetModelAsync = await _quickElasticSearch.GetModelAsync<TestElasticSearchModel>(m => m.UserId, 340506710462537);
# è·å–ä¸€æ¡æ•°æ®ï¼ˆæ ¹æ®æŸå­—æ®µæŸ¥è¯¢ï¼‰
    # ç±»ä¼¼SQLï¼šSELECT * FROM A WHERE UserId = 7438
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "query":{
            "term":{
                "UserId":{
                    "value":7438
                }
            }
        }
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 1,
                "relation": "eq"
            },
            "max_score": 1.0,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188364",
                    "_score": 1.0,
                    "_source": {
                        "Id": 343362866188364,
                        "UserType": "é«˜çº§ç”¨æˆ·",
                        "UserId": 7438,
                        "UserName": "Quber8",
                        "UserAge": 53,
                        "Money": 8.429,
                        "MoneyOth": 9.556,
                        "CreateTime": "2022-10-17T16:07:06.7733293+08:00"
                    }
                }
            ]
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–åˆ†é¡µæ•°æ®ï¼‰ï¼š**

//åˆ†é¡µæ¡ä»¶
    var pagerCon = new EsPagerConModel
    {
        PageIndex = 1,
        PageSize = 15,
        OrderField = "Id",
        OrderType = "desc"
    };
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetPager = _quickElasticSearch.GetPager<TestElasticSearchModel>(pagerCon, queryCon);
    
    //å¼‚æ­¥
    var retGetPagerAsync = await _quickElasticSearch.GetPagerAsync<TestElasticSearchModel>(pagerCon, queryCon);
# è·å–åˆ†é¡µæ•°æ®
    # ç±»ä¼¼SQLï¼šSELECT * FROM A WHERE Id >= 1 LIMIT 0,15 ORDER BY Id DESC
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "from":0,
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":15,
        "sort":[
            {
                "Id":{
                    "order":"desc"
                }
            }
        ]
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188366",
                    "_score": null,
                    "_source": {
                        "Id": 343362866188366,
                        "UserType": "ä¼šå‘˜ç”¨æˆ·",
                        "UserId": 2106,
                        "UserName": "Quber10",
                        "UserAge": 30,
                        "Money": 10.429,
                        "MoneyOth": 11.556,
                        "CreateTime": "2022-10-17T16:07:06.7733297+08:00"
                    },
                    "sort": [343362866188366]
                },
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188365",
                    "_score": null,
                    "_source": {
                        "Id": 343362866188365,
                        "UserType": "ç³»ç»Ÿç”¨æˆ·",
                        "UserId": 829,
                        "UserName": "Quber9",
                        "UserAge": 39,
                        "Money": 9.429,
                        "MoneyOth": 10.556,
                        "CreateTime": "2022-10-17T16:07:06.7733294+08:00"
                    },
                    "sort": [343362866188365]
                }
                â€¦â€¦
            ]
        }
    }

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–åˆ†é¡µæ•°æ®-è¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰ï¼š**

//åˆ†é¡µæ¡ä»¶
    var pagerCon = new EsPagerConModel
    {
        PageIndex = 1,
        PageSize = 15,
        OrderField = "Id",
        OrderType = "desc"
    };
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetPagerFields = _quickElasticSearch.GetPagerFields<TestElasticSearchModel>(pagerCon, new List<string> { "UserId", "UserName", "UserAge" }, queryCon);
    
    //å¼‚æ­¥
    var retGetPagerFieldsAsync = await _quickElasticSearch.GetPagerFieldsAsync<TestElasticSearchModel>(pagerCon, new List<string> { "UserId", "UserName", "UserAge" }, queryCon);
# è·å–åˆ†é¡µæ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰
    # ç±»ä¼¼SQLï¼šSELECT 'UserId','UserName','UserAge' FROM A WHERE Id >= 1 LIMIT 0,15 ORDER BY Id DESC
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "from":0,
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":15,
        "sort":[
            {
                "Id":{
                    "order":"desc"
                }
            }
        ],
        "_source":{
            "includes":[
                "UserId",
                "UserName",
                "UserAge"
            ]
        }
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": [
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188366",
                    "_score": null,
                    "_source": {
                        "UserName": "Quber10",
                        "UserId": 2106,
                        "UserAge": 30
                    },
                    "sort": [343362866188366]
                },
                {
                    "_index": "test_index",
                    "_type": "_doc",
                    "_id": "343362866188365",
                    "_score": null,
                    "_source": {
                        "UserName": "Quber9",
                        "UserId": 829,
                        "UserAge": 39
                    },
                    "sort": [343362866188365]
                }
                â€¦â€¦
            ]
        }
    }

### 5.9ã€ğŸ¥£ åˆ†ç»„ç»Ÿè®¡æŸ¥è¯¢

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆå•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼é›†åˆï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT col1 FROM A GROUP BY col1
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupValues = _quickElasticSearch.GetGroupValues<TestElasticSearchModel>(m => m.UserName, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupValuesAsync = await _quickElasticSearch.GetGroupValuesAsync<TestElasticSearchModel>(m => m.UserName, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": ["Jack1", "Jack2", "Jack3"]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "terms":{
                    "field":"UserName",
                    "order":[
                        {
                            "_key":"asc"
                        }
                    ],
                    "size":2000000000
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 2,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "sterms#StatiGroup": {
                "doc_count_error_upper_bound": 0,
                "sum_other_doc_count": 0,
                "buckets": [
                    {
                        "key": "Jack1",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack10",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack2",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack3",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack4",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack5",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack6",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack7",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack8",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack9",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber1",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber10",
                        "doc_count": 3
                    },
                    {
                        "key": "Quber11",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber12",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber2",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber3",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber4",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber5",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber6",
                        "doc_count": 6
                    },
                    {
                        "key": "Quber7",
                        "doc_count": 5
                    },
                    {
                        "key": "Quber8",
                        "doc_count": 5
                    },
                    {
                        "key": "Quber9",
                        "doc_count": 4
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆå•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼å’Œæ•°é‡é›†åˆï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT col1,COUNT(1) FROM A GROUP BY col1
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupCount = _quickElasticSearch.GetGroupCount<TestElasticSearchModel>(m => m.UserName, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupCountAsync = await _quickElasticSearch.GetGroupCountAsync<TestElasticSearchModel>(m => m.UserName, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "Jack1",
                "Count": 2
            },
            {
                "Name": "Jack2",
                "Count": 2
            },
            {
                "Name": "Jack3",
                "Count": 2
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "terms":{
                    "field":"UserName",
                    "order":[
                        {
                            "_key":"asc"
                        },
                        {
                            "_count":"asc"
                        }
                    ],
                    "size":2000000000
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "sterms#StatiGroup": {
                "doc_count_error_upper_bound": 0,
                "sum_other_doc_count": 0,
                "buckets": [
                    {
                        "key": "Jack1",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack10",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack2",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack3",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack4",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack5",
                        "doc_count": 2
                    },
                    {
                        "key": "Jack6",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack7",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack8",
                        "doc_count": 1
                    },
                    {
                        "key": "Jack9",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber1",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber10",
                        "doc_count": 3
                    },
                    {
                        "key": "Quber11",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber12",
                        "doc_count": 1
                    },
                    {
                        "key": "Quber2",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber3",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber4",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber5",
                        "doc_count": 7
                    },
                    {
                        "key": "Quber6",
                        "doc_count": 6
                    },
                    {
                        "key": "Quber7",
                        "doc_count": 5
                    },
                    {
                        "key": "Quber8",
                        "doc_count": 5
                    },
                    {
                        "key": "Quber9",
                        "doc_count": 4
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆå•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT col1,COUNT(1),SUM(col2),MAX(col2),MIN(col2),AVG(col2) FROM A GROUP BY col1
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupCountSmma = _quickElasticSearch.GetGroupCountSmma<TestElasticSearchModel>(m => m.UserName, m => m.UserAge, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupCountSmmaAsync = await _quickElasticSearch.GetGroupCountSmmaAsync<TestElasticSearchModel>(m => m.UserName, m => m.UserAge, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "Jack1",
                "Count": 2,
                "Sum": 54,
                "Max": 31,
                "Min": 23,
                "Avg": 27
            },
            {
                "Name": "Jack2",
                "Count": 2,
                "Sum": 98,
                "Max": 77,
                "Min": 21,
                "Avg": 49
            },
            {
                "Name": "Jack3",
                "Count": 2,
                "Sum": 126,
                "Max": 67,
                "Min": 59,
                "Avg": 63
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiSum":{
                        "sum":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMax":{
                        "max":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMin":{
                        "min":{
                            "field":"UserAge"
                        }
                    },
                    "StatiAvg":{
                        "avg":{
                            "field":"UserAge"
                        }
                    }
                },
                "terms":{
                    "field":"UserName",
                    "order":[
                        {
                            "_key":"asc"
                        },
                        {
                            "_count":"asc"
                        }
                    ],
                    "size":2000000000
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "sterms#StatiGroup": {
                "doc_count_error_upper_bound": 0,
                "sum_other_doc_count": 0,
                "buckets": [
                    {
                        "key": "Jack1",
                        "doc_count": 2,
                        "avg#StatiAvg": {
                            "value": 34.0
                        },
                        "max#StatiMax": {
                            "value": 39.0
                        },
                        "min#StatiMin": {
                            "value": 29.0
                        },
                        "sum#StatiSum": {
                            "value": 68.0
                        }
                    },
                    {
                        "key": "Jack10",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 60.0
                        },
                        "max#StatiMax": {
                            "value": 60.0
                        },
                        "min#StatiMin": {
                            "value": 60.0
                        },
                        "sum#StatiSum": {
                            "value": 60.0
                        }
                    },
                    {
                        "key": "Jack2",
                        "doc_count": 2,
                        "avg#StatiAvg": {
                            "value": 40.0
                        },
                        "max#StatiMax": {
                            "value": 48.0
                        },
                        "min#StatiMin": {
                            "value": 32.0
                        },
                        "sum#StatiSum": {
                            "value": 80.0
                        }
                    },
                    {
                        "key": "Jack3",
                        "doc_count": 2,
                        "avg#StatiAvg": {
                            "value": 39.5
                        },
                        "max#StatiMax": {
                            "value": 53.0
                        },
                        "min#StatiMin": {
                            "value": 26.0
                        },
                        "sum#StatiSum": {
                            "value": 79.0
                        }
                    },
                    {
                        "key": "Jack4",
                        "doc_count": 2,
                        "avg#StatiAvg": {
                            "value": 48.0
                        },
                        "max#StatiMax": {
                            "value": 65.0
                        },
                        "min#StatiMin": {
                            "value": 31.0
                        },
                        "sum#StatiSum": {
                            "value": 96.0
                        }
                    },
                    {
                        "key": "Jack5",
                        "doc_count": 2,
                        "avg#StatiAvg": {
                            "value": 54.0
                        },
                        "max#StatiMax": {
                            "value": 78.0
                        },
                        "min#StatiMin": {
                            "value": 30.0
                        },
                        "sum#StatiSum": {
                            "value": 108.0
                        }
                    },
                    {
                        "key": "Jack6",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 57.0
                        },
                        "max#StatiMax": {
                            "value": 57.0
                        },
                        "min#StatiMin": {
                            "value": 57.0
                        },
                        "sum#StatiSum": {
                            "value": 57.0
                        }
                    },
                    {
                        "key": "Jack7",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 40.0
                        },
                        "max#StatiMax": {
                            "value": 40.0
                        },
                        "min#StatiMin": {
                            "value": 40.0
                        },
                        "sum#StatiSum": {
                            "value": 40.0
                        }
                    },
                    {
                        "key": "Jack8",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 29.0
                        },
                        "max#StatiMax": {
                            "value": 29.0
                        },
                        "min#StatiMin": {
                            "value": 29.0
                        },
                        "sum#StatiSum": {
                            "value": 29.0
                        }
                    },
                    {
                        "key": "Jack9",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 72.0
                        },
                        "max#StatiMax": {
                            "value": 72.0
                        },
                        "min#StatiMin": {
                            "value": 72.0
                        },
                        "sum#StatiSum": {
                            "value": 72.0
                        }
                    },
                    {
                        "key": "Quber1",
                        "doc_count": 7,
                        "avg#StatiAvg": {
                            "value": 48.857142857142854
                        },
                        "max#StatiMax": {
                            "value": 79.0
                        },
                        "min#StatiMin": {
                            "value": 21.0
                        },
                        "sum#StatiSum": {
                            "value": 342.0
                        }
                    },
                    {
                        "key": "Quber10",
                        "doc_count": 3,
                        "avg#StatiAvg": {
                            "value": 31.0
                        },
                        "max#StatiMax": {
                            "value": 43.0
                        },
                        "min#StatiMin": {
                            "value": 20.0
                        },
                        "sum#StatiSum": {
                            "value": 93.0
                        }
                    },
                    {
                        "key": "Quber11",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 29.0
                        },
                        "max#StatiMax": {
                            "value": 29.0
                        },
                        "min#StatiMin": {
                            "value": 29.0
                        },
                        "sum#StatiSum": {
                            "value": 29.0
                        }
                    },
                    {
                        "key": "Quber12",
                        "doc_count": 1,
                        "avg#StatiAvg": {
                            "value": 74.0
                        },
                        "max#StatiMax": {
                            "value": 74.0
                        },
                        "min#StatiMin": {
                            "value": 74.0
                        },
                        "sum#StatiSum": {
                            "value": 74.0
                        }
                    },
                    {
                        "key": "Quber2",
                        "doc_count": 7,
                        "avg#StatiAvg": {
                            "value": 51.0
                        },
                        "max#StatiMax": {
                            "value": 78.0
                        },
                        "min#StatiMin": {
                            "value": 25.0
                        },
                        "sum#StatiSum": {
                            "value": 357.0
                        }
                    },
                    {
                        "key": "Quber3",
                        "doc_count": 7,
                        "avg#StatiAvg": {
                            "value": 48.142857142857146
                        },
                        "max#StatiMax": {
                            "value": 74.0
                        },
                        "min#StatiMin": {
                            "value": 28.0
                        },
                        "sum#StatiSum": {
                            "value": 337.0
                        }
                    },
                    {
                        "key": "Quber4",
                        "doc_count": 7,
                        "avg#StatiAvg": {
                            "value": 53.285714285714285
                        },
                        "max#StatiMax": {
                            "value": 76.0
                        },
                        "min#StatiMin": {
                            "value": 25.0
                        },
                        "sum#StatiSum": {
                            "value": 373.0
                        }
                    },
                    {
                        "key": "Quber5",
                        "doc_count": 7,
                        "avg#StatiAvg": {
                            "value": 47.285714285714285
                        },
                        "max#StatiMax": {
                            "value": 70.0
                        },
                        "min#StatiMin": {
                            "value": 25.0
                        },
                        "sum#StatiSum": {
                            "value": 331.0
                        }
                    },
                    {
                        "key": "Quber6",
                        "doc_count": 6,
                        "avg#StatiAvg": {
                            "value": 41.5
                        },
                        "max#StatiMax": {
                            "value": 78.0
                        },
                        "min#StatiMin": {
                            "value": 20.0
                        },
                        "sum#StatiSum": {
                            "value": 249.0
                        }
                    },
                    {
                        "key": "Quber7",
                        "doc_count": 5,
                        "avg#StatiAvg": {
                            "value": 43.0
                        },
                        "max#StatiMax": {
                            "value": 61.0
                        },
                        "min#StatiMin": {
                            "value": 21.0
                        },
                        "sum#StatiSum": {
                            "value": 215.0
                        }
                    },
                    {
                        "key": "Quber8",
                        "doc_count": 5,
                        "avg#StatiAvg": {
                            "value": 42.2
                        },
                        "max#StatiMax": {
                            "value": 61.0
                        },
                        "min#StatiMin": {
                            "value": 22.0
                        },
                        "sum#StatiSum": {
                            "value": 211.0
                        }
                    },
                    {
                        "key": "Quber9",
                        "doc_count": 4,
                        "avg#StatiAvg": {
                            "value": 54.75
                        },
                        "max#StatiMax": {
                            "value": 65.0
                        },
                        "min#StatiMin": {
                            "value": 39.0
                        },
                        "sum#StatiSum": {
                            "value": 219.0
                        }
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆå¤šä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¤šä¸ªå­—æ®µå¯¹åº”çš„å€¼ä»¥åŠå¯¹åº”åˆ†ç»„çš„æ•°æ®æ•°é‡ï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT col1,col2,COUNT(1) FROM A GROUP BY col1,col2
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsCount = _quickElasticSearch.GetGroupsCount<TestElasticSearchModel>(new List<string> { "UserName", "UserAge" }, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsCountAsync = await _quickElasticSearch.GetGroupsCountAsync<TestElasticSearchModel>(new List<string> { "UserName", "UserAge" }, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "UserName": "Jack1",
                "UserAge": 23,
                "GroupCount": 1
            },
            {
                "UserName": "Jack1",
                "UserAge": 31,
                "GroupCount": 1
            },
            {
                "UserName": "Jack2",
                "UserAge": 21,
                "GroupCount": 1
            },
            {
                "UserName": "Jack2",
                "UserAge": 77,
                "GroupCount": 1
            },
            {
                "UserName": "Jack3",
                "UserAge": 59,
                "GroupCount": 1
            },
            {
                "UserName": "Jack3",
                "UserAge": 67,
                "GroupCount": 1
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "multi_terms":{
                    "order":[
                        {
                            "_key":"asc"
                        },
                        {
                            "_count":"asc"
                        }
                    ],
                    "size":2000000000,
                    "terms":[
                        {
                            "field":"UserType"
                        },
                        {
                            "field":"UserName"
                        }
                    ]
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 2,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "multi_terms#StatiGroup": {
                "doc_count_error_upper_bound": 0,
                "sum_other_doc_count": 0,
                "buckets": [
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Jack1"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Jack1",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Jack6"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Jack6",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Jack9"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Jack9",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber1"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber1",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber10"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber10",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber11"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber11",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber2"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber2",
                        "doc_count": 2
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber3"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber3",
                        "doc_count": 2
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber4"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber4",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber5"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber5",
                        "doc_count": 3
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber6"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber6",
                        "doc_count": 2
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber7"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber7",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber8"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber8",
                        "doc_count": 1
                    },
                    {
                        "key": ["ä¼šå‘˜ç”¨æˆ·", "Quber9"],
                        "key_as_string": "ä¼šå‘˜ç”¨æˆ·|Quber9",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack1"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack1",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack10"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack10",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack2"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack2",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack4"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack4",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack7"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack7",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Jack8"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Jack8",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber1"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber1",
                        "doc_count": 3
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber12"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber12",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber3"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber3",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber4"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber4",
                        "doc_count": 2
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber6"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber6",
                        "doc_count": 1
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber7"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber7",
                        "doc_count": 2
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber8"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber8",
                        "doc_count": 2
                    },
                    {
                        "key": ["æ™®é€šç”¨æˆ·", "Quber9"],
                        "key_as_string": "æ™®é€šç”¨æˆ·|Quber9",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Jack2"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Jack2",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Jack3"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Jack3",
                        "doc_count": 2
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Jack5"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Jack5",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber1"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber1",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber10"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber10",
                        "doc_count": 2
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber2"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber2",
                        "doc_count": 3
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber3"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber3",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber4"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber4",
                        "doc_count": 2
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber5"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber5",
                        "doc_count": 3
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber6"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber6",
                        "doc_count": 3
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber7"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber7",
                        "doc_count": 1
                    },
                    {
                        "key": ["ç³»ç»Ÿç”¨æˆ·", "Quber9"],
                        "key_as_string": "ç³»ç»Ÿç”¨æˆ·|Quber9",
                        "doc_count": 1
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Jack4"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Jack4",
                        "doc_count": 1
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Jack5"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Jack5",
                        "doc_count": 1
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber1"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber1",
                        "doc_count": 2
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber2"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber2",
                        "doc_count": 2
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber3"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber3",
                        "doc_count": 3
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber4"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber4",
                        "doc_count": 2
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber5"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber5",
                        "doc_count": 1
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber7"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber7",
                        "doc_count": 1
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber8"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber8",
                        "doc_count": 2
                    },
                    {
                        "key": ["é«˜çº§ç”¨æˆ·", "Quber9"],
                        "key_as_string": "é«˜çº§ç”¨æˆ·|Quber9",
                        "doc_count": 1
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼‰ï¼š**

//å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateMonth = _quickElasticSearch.GetGroupsDateMonth<TestElasticSearchModel>(m => m.CreateTime, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateMonthAsync = await _quickElasticSearch.GetGroupsDateMonthAsync<TestElasticSearchModel>(m => m.CreateTime, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-08",
                "Count": 110
            },
            {
                "Name": "2022-09",
                "Count": 132
            },
            {
                "Name": "2022-10",
                "Count": 166
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM",
                    "calendar_interval":"1M",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 2,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10",
                        "key": 1664553600000,
                        "doc_count": 75
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œæ”¯æŒæŒ‰å¹´ã€å­£åº¦ã€æœˆä»½ã€æ˜ŸæœŸã€å¤©ã€å°æ—¶ã€åˆ†ã€ç§’ç­‰ç»´åº¦è¿›è¡Œç»Ÿè®¡ï¼‰ï¼š**

//ç»Ÿè®¡çš„æ—¶é—´é—´éš”ç»´åº¦æ”¯æŒçš„è¡¨è¾¾å¼æœ‰ï¼ˆ1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDate = _quickElasticSearch.GetGroupsDate<TestElasticSearchModel>(m => m.CreateTime, "1m", "yyyy-MM-dd HH:mm", queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateAsync = await _quickElasticSearch.GetGroupsDateAsync<TestElasticSearchModel>(m => m.CreateTime, "1m", "yyyy-MM-dd HH:mm", queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-10-12 09:24",
                "Count": 10
            },
            {
                "Name": "2022-10-12 09:25",
                "Count": 50
            },
            {
                "Name": "2022-10-12 09:26",
                "Count": 10
            },
            {
                "Name": "2022-10-12 09:27",
                "Count": 10
            },
            {
                "Name": "2022-10-12 09:28",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:29",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:30",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:31",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:32",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:33",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:34",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:35",
                "Count": 0
            },
            {
                "Name": "2022-10-12 09:36",
                "Count": 11
            },
            {
                "Name": "2022-10-12 09:37",
                "Count": 41
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM-dd HH:mm",
                    "calendar_interval":"1m",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10-17 16:05",
                        "key": 1665993900000,
                        "doc_count": 15
                    },
                    {
                        "key_as_string": "2022-10-17 16:06",
                        "key": 1665993960000,
                        "doc_count": 50
                    },
                    {
                        "key_as_string": "2022-10-17 16:07",
                        "key": 1665994020000,
                        "doc_count": 10
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰ï¼š**

//å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateMonthSmma = _quickElasticSearch.GetGroupsDateMonthSmma<TestElasticSearchModel>(m => m.CreateTime, m => m.UserAge, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateMonthSmmaAsync = await _quickElasticSearch.GetGroupsDateMonthSmmaAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserAge, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-10",
                "Count": 132,
                "Sum": 6842,
                "Max": 79,
                "Min": 21,
                "Avg": 51.83
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiSum":{
                        "sum":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMax":{
                        "max":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMin":{
                        "min":{
                            "field":"UserAge"
                        }
                    },
                    "StatiAvg":{
                        "avg":{
                            "field":"UserAge"
                        }
                    }
                },
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM",
                    "calendar_interval":"1M",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10",
                        "key": 1664553600000,
                        "doc_count": 75,
                        "avg#StatiAvg": {
                            "value": 46.92
                        },
                        "max#StatiMax": {
                            "value": 79.0
                        },
                        "min#StatiMin": {
                            "value": 20.0
                        },
                        "sum#StatiSum": {
                            "value": 3519.0
                        }
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰ï¼š**

//ç»Ÿè®¡çš„æ—¶é—´é—´éš”ç»´åº¦æ”¯æŒçš„è¡¨è¾¾å¼æœ‰ï¼ˆ1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateSmma = _quickElasticSearch.GetGroupsDateSmma<TestElasticSearchModel>(m => m.CreateTime, m => m.UserAge, "1m", "yyyy-MM-dd HH:mm", queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateSmmaAsync = await _quickElasticSearch.GetGroupsDateSmmaAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserAge, "1m", "yyyy-MM-dd HH:mm", queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-10-12 09:24",
                "Count": 10,
                "Sum": 588,
                "Max": 76,
                "Min": 31,
                "Avg": 58.8
            },
            {
                "Name": "2022-10-12 09:25",
                "Count": 50,
                "Sum": 2432,
                "Max": 79,
                "Min": 21,
                "Avg": 48.64
            },
            {
                "Name": "2022-10-12 09:26",
                "Count": 10,
                "Sum": 512,
                "Max": 79,
                "Min": 27,
                "Avg": 51.2
            },
            {
                "Name": "2022-10-12 09:27",
                "Count": 10,
                "Sum": 616,
                "Max": 76,
                "Min": 34,
                "Avg": 61.6
            },
            {
                "Name": "2022-10-12 09:28",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:29",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:30",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:31",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:32",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:33",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:34",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:35",
                "Count": 0,
                "Sum": 0,
                "Max": 0,
                "Min": 0,
                "Avg": 0
            },
            {
                "Name": "2022-10-12 09:36",
                "Count": 11,
                "Sum": 527,
                "Max": 74,
                "Min": 21,
                "Avg": 47.91
            },
            {
                "Name": "2022-10-12 09:37",
                "Count": 41,
                "Sum": 2167,
                "Max": 78,
                "Min": 25,
                "Avg": 52.85
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiSum":{
                        "sum":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMax":{
                        "max":{
                            "field":"UserAge"
                        }
                    },
                    "StatiMin":{
                        "min":{
                            "field":"UserAge"
                        }
                    },
                    "StatiAvg":{
                        "avg":{
                            "field":"UserAge"
                        }
                    }
                },
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM-dd HH:mm",
                    "calendar_interval":"1m",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10-17 16:05",
                        "key": 1665993900000,
                        "doc_count": 15,
                        "avg#StatiAvg": {
                            "value": 44.06666666666667
                        },
                        "max#StatiMax": {
                            "value": 76.0
                        },
                        "min#StatiMin": {
                            "value": 21.0
                        },
                        "sum#StatiSum": {
                            "value": 661.0
                        }
                    },
                    {
                        "key_as_string": "2022-10-17 16:06",
                        "key": 1665993960000,
                        "doc_count": 50,
                        "avg#StatiAvg": {
                            "value": 46.2
                        },
                        "max#StatiMax": {
                            "value": 79.0
                        },
                        "min#StatiMin": {
                            "value": 20.0
                        },
                        "sum#StatiSum": {
                            "value": 2310.0
                        }
                    },
                    {
                        "key_as_string": "2022-10-17 16:07",
                        "key": 1665994020000,
                        "doc_count": 10,
                        "avg#StatiAvg": {
                            "value": 54.8
                        },
                        "max#StatiMax": {
                            "value": 78.0
                        },
                        "min#StatiMin": {
                            "value": 30.0
                        },
                        "sum#StatiSum": {
                            "value": 548.0
                        }
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æŸå¹´ 1~12 æœˆç»Ÿè®¡æ¯ä¸ªæœˆçš„æŸä¸ªå­—æ®µæ¯ä¸ªæœˆçš„æ€»å’Œä»¥åŠè¿™ä¸€å¹´çš„æ€»å’Œï¼‰ï¼š**

//å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateMonthOneYear = _quickElasticSearch.GetGroupsDateMonthOneYear<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, 2022, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateMonthOneYearAsync = await _quickElasticSearch.GetGroupsDateMonthOneYearAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, 2022, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            ["Jack1", 0, 0, 0, 0, 0, 0, 0, 0, 0, 54, 0, 0, 54],
            ["Jack2", 0, 0, 0, 0, 0, 0, 0, 0, 0, 98, 0, 0, 98],
            ["Jack3", 0, 0, 0, 0, 0, 0, 0, 0, 0, 126, 0, 0, 126]
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiGroup-1":{
                        "aggs":{
                            "StatiSum":{
                                "sum":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMax":{
                                "max":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMin":{
                                "min":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiAvg":{
                                "avg":{
                                    "field":"UserAge"
                                }
                            }
                        },
                        "terms":{
                            "field":"UserName",
                            "order":[
                                {
                                    "_key":"asc"
                                },
                                {
                                    "_count":"asc"
                                }
                            ],
                            "size":2000000000
                        }
                    }
                },
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM",
                    "calendar_interval":"1M",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 1,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10",
                        "key": 1664553600000,
                        "doc_count": 75,
                        "sterms#StatiGroup-1": {
                            "doc_count_error_upper_bound": 0,
                            "sum_other_doc_count": 0,
                            "buckets": [
                                {
                                    "key": "Jack1",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 34.0
                                    },
                                    "max#StatiMax": {
                                        "value": 39.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 68.0
                                    }
                                },
                                {
                                    "key": "Jack10",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 60.0
                                    },
                                    "max#StatiMax": {
                                        "value": 60.0
                                    },
                                    "min#StatiMin": {
                                        "value": 60.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 60.0
                                    }
                                },
                                {
                                    "key": "Jack2",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 48.0
                                    },
                                    "min#StatiMin": {
                                        "value": 32.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 80.0
                                    }
                                },
                                {
                                    "key": "Jack3",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 39.5
                                    },
                                    "max#StatiMax": {
                                        "value": 53.0
                                    },
                                    "min#StatiMin": {
                                        "value": 26.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 79.0
                                    }
                                },
                                {
                                    "key": "Jack4",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 48.0
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 31.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 96.0
                                    }
                                },
                                {
                                    "key": "Jack5",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 54.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 30.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 108.0
                                    }
                                },
                                {
                                    "key": "Jack6",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 57.0
                                    },
                                    "max#StatiMax": {
                                        "value": 57.0
                                    },
                                    "min#StatiMin": {
                                        "value": 57.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 57.0
                                    }
                                },
                                {
                                    "key": "Jack7",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 40.0
                                    },
                                    "min#StatiMin": {
                                        "value": 40.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 40.0
                                    }
                                },
                                {
                                    "key": "Jack8",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Jack9",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 72.0
                                    },
                                    "max#StatiMax": {
                                        "value": 72.0
                                    },
                                    "min#StatiMin": {
                                        "value": 72.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 72.0
                                    }
                                },
                                {
                                    "key": "Quber1",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.857142857142854
                                    },
                                    "max#StatiMax": {
                                        "value": 79.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 342.0
                                    }
                                },
                                {
                                    "key": "Quber10",
                                    "doc_count": 3,
                                    "avg#StatiAvg": {
                                        "value": 31.0
                                    },
                                    "max#StatiMax": {
                                        "value": 43.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 93.0
                                    }
                                },
                                {
                                    "key": "Quber11",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Quber12",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 74.0
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 74.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 74.0
                                    }
                                },
                                {
                                    "key": "Quber2",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 51.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 357.0
                                    }
                                },
                                {
                                    "key": "Quber3",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.142857142857146
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 28.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 337.0
                                    }
                                },
                                {
                                    "key": "Quber4",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 53.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 76.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 373.0
                                    }
                                },
                                {
                                    "key": "Quber5",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 47.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 70.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 331.0
                                    }
                                },
                                {
                                    "key": "Quber6",
                                    "doc_count": 6,
                                    "avg#StatiAvg": {
                                        "value": 41.5
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 249.0
                                    }
                                },
                                {
                                    "key": "Quber7",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 43.0
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 215.0
                                    }
                                },
                                {
                                    "key": "Quber8",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 42.2
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 22.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 211.0
                                    }
                                },
                                {
                                    "key": "Quber9",
                                    "doc_count": 4,
                                    "avg#StatiAvg": {
                                        "value": 54.75
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 39.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 219.0
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰ï¼š**

//å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateMonth = _quickElasticSearch.GetGroupsDateMonth<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateMonthAsync = await _quickElasticSearch.GetGroupsDateMonthAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-10",
                "Count": 132,
                "Group": [
                    {
                        "Name": "Jack1",
                        "Count": 2,
                        "Sum": 54,
                        "Max": 31,
                        "Min": 23,
                        "Avg": 27
                    },
                    {
                        "Name": "Jack2",
                        "Count": 2,
                        "Sum": 98,
                        "Max": 77,
                        "Min": 21,
                        "Avg": 49
                    },
                    {
                        "Name": "Jack3",
                        "Count": 2,
                        "Sum": 126,
                        "Max": 67,
                        "Min": 59,
                        "Avg": 63
                    }
                ]
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiGroup-1":{
                        "aggs":{
                            "StatiSum":{
                                "sum":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMax":{
                                "max":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMin":{
                                "min":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiAvg":{
                                "avg":{
                                    "field":"UserAge"
                                }
                            }
                        },
                        "terms":{
                            "field":"UserName",
                            "order":[
                                {
                                    "_key":"asc"
                                },
                                {
                                    "_count":"asc"
                                }
                            ],
                            "size":2000000000
                        }
                    }
                },
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM",
                    "calendar_interval":"1M",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 2,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10",
                        "key": 1664553600000,
                        "doc_count": 75,
                        "sterms#StatiGroup-1": {
                            "doc_count_error_upper_bound": 0,
                            "sum_other_doc_count": 0,
                            "buckets": [
                                {
                                    "key": "Jack1",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 34.0
                                    },
                                    "max#StatiMax": {
                                        "value": 39.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 68.0
                                    }
                                },
                                {
                                    "key": "Jack10",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 60.0
                                    },
                                    "max#StatiMax": {
                                        "value": 60.0
                                    },
                                    "min#StatiMin": {
                                        "value": 60.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 60.0
                                    }
                                },
                                {
                                    "key": "Jack2",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 48.0
                                    },
                                    "min#StatiMin": {
                                        "value": 32.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 80.0
                                    }
                                },
                                {
                                    "key": "Jack3",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 39.5
                                    },
                                    "max#StatiMax": {
                                        "value": 53.0
                                    },
                                    "min#StatiMin": {
                                        "value": 26.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 79.0
                                    }
                                },
                                {
                                    "key": "Jack4",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 48.0
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 31.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 96.0
                                    }
                                },
                                {
                                    "key": "Jack5",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 54.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 30.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 108.0
                                    }
                                },
                                {
                                    "key": "Jack6",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 57.0
                                    },
                                    "max#StatiMax": {
                                        "value": 57.0
                                    },
                                    "min#StatiMin": {
                                        "value": 57.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 57.0
                                    }
                                },
                                {
                                    "key": "Jack7",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 40.0
                                    },
                                    "min#StatiMin": {
                                        "value": 40.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 40.0
                                    }
                                },
                                {
                                    "key": "Jack8",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Jack9",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 72.0
                                    },
                                    "max#StatiMax": {
                                        "value": 72.0
                                    },
                                    "min#StatiMin": {
                                        "value": 72.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 72.0
                                    }
                                },
                                {
                                    "key": "Quber1",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.857142857142854
                                    },
                                    "max#StatiMax": {
                                        "value": 79.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 342.0
                                    }
                                },
                                {
                                    "key": "Quber10",
                                    "doc_count": 3,
                                    "avg#StatiAvg": {
                                        "value": 31.0
                                    },
                                    "max#StatiMax": {
                                        "value": 43.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 93.0
                                    }
                                },
                                {
                                    "key": "Quber11",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Quber12",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 74.0
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 74.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 74.0
                                    }
                                },
                                {
                                    "key": "Quber2",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 51.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 357.0
                                    }
                                },
                                {
                                    "key": "Quber3",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.142857142857146
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 28.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 337.0
                                    }
                                },
                                {
                                    "key": "Quber4",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 53.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 76.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 373.0
                                    }
                                },
                                {
                                    "key": "Quber5",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 47.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 70.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 331.0
                                    }
                                },
                                {
                                    "key": "Quber6",
                                    "doc_count": 6,
                                    "avg#StatiAvg": {
                                        "value": 41.5
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 249.0
                                    }
                                },
                                {
                                    "key": "Quber7",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 43.0
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 215.0
                                    }
                                },
                                {
                                    "key": "Quber8",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 42.2
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 22.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 211.0
                                    }
                                },
                                {
                                    "key": "Quber9",
                                    "doc_count": 4,
                                    "avg#StatiAvg": {
                                        "value": 54.75
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 39.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 219.0
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼‰ï¼š**

//ç»Ÿè®¡çš„æ—¶é—´é—´éš”ç»´åº¦æ”¯æŒçš„è¡¨è¾¾å¼æœ‰ï¼ˆ1yï¼š1å¹´ã€1qï¼š1å­£åº¦ã€1Mï¼š1ä¸ªæœˆã€1wï¼š1æ˜ŸæœŸã€1dï¼š1å¤©ã€1hï¼š1å°æ—¶ã€1mï¼š1åˆ†é’Ÿã€1sï¼š1ç§’é’Ÿï¼‰
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetGroupsDateSub = _quickElasticSearch.GetGroupsDateSub<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, "1h", "yyyy-MM-dd HH:mm", queryCon);
    
    //å¼‚æ­¥
    var retGetGroupsDateSubAsync = await _quickElasticSearch.GetGroupsDateSubAsync<TestElasticSearchModel>(m => m.CreateTime, m => m.UserName, m => m.UserAge, "1h", "yyyy-MM-dd HH:mm", queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": [
            {
                "Name": "2022-10-12 09:00",
                "Count": 132,
                "Group": [
                    {
                        "Name": "Jack1",
                        "Count": 2,
                        "Sum": 54,
                        "Max": 31,
                        "Min": 23,
                        "Avg": 27
                    },
                    {
                        "Name": "Jack2",
                        "Count": 2,
                        "Sum": 98,
                        "Max": 77,
                        "Min": 21,
                        "Avg": 49
                    },
                    {
                        "Name": "Jack3",
                        "Count": 2,
                        "Sum": 126,
                        "Max": 67,
                        "Min": 59,
                        "Avg": 63
                    }
                ]
            }
        ]
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiGroup":{
                "aggs":{
                    "StatiGroup-1":{
                        "aggs":{
                            "StatiSum":{
                                "sum":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMax":{
                                "max":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiMin":{
                                "min":{
                                    "field":"UserAge"
                                }
                            },
                            "StatiAvg":{
                                "avg":{
                                    "field":"UserAge"
                                }
                            }
                        },
                        "terms":{
                            "field":"UserName",
                            "order":[
                                {
                                    "_key":"asc"
                                },
                                {
                                    "_count":"asc"
                                }
                            ],
                            "size":2000000000
                        }
                    }
                },
                "date_histogram":{
                    "field":"CreateTime",
                    "format":"yyyy-MM-dd HH:mm",
                    "calendar_interval":"1h",
                    "min_doc_count":0,
                    "order":{
                        "_key":"asc"
                    },
                    "time_zone":"+08:00"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "date_histogram#StatiGroup": {
                "buckets": [
                    {
                        "key_as_string": "2022-10-17 16:00",
                        "key": 1665993600000,
                        "doc_count": 75,
                        "sterms#StatiGroup-1": {
                            "doc_count_error_upper_bound": 0,
                            "sum_other_doc_count": 0,
                            "buckets": [
                                {
                                    "key": "Jack1",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 34.0
                                    },
                                    "max#StatiMax": {
                                        "value": 39.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 68.0
                                    }
                                },
                                {
                                    "key": "Jack10",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 60.0
                                    },
                                    "max#StatiMax": {
                                        "value": 60.0
                                    },
                                    "min#StatiMin": {
                                        "value": 60.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 60.0
                                    }
                                },
                                {
                                    "key": "Jack2",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 48.0
                                    },
                                    "min#StatiMin": {
                                        "value": 32.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 80.0
                                    }
                                },
                                {
                                    "key": "Jack3",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 39.5
                                    },
                                    "max#StatiMax": {
                                        "value": 53.0
                                    },
                                    "min#StatiMin": {
                                        "value": 26.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 79.0
                                    }
                                },
                                {
                                    "key": "Jack4",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 48.0
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 31.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 96.0
                                    }
                                },
                                {
                                    "key": "Jack5",
                                    "doc_count": 2,
                                    "avg#StatiAvg": {
                                        "value": 54.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 30.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 108.0
                                    }
                                },
                                {
                                    "key": "Jack6",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 57.0
                                    },
                                    "max#StatiMax": {
                                        "value": 57.0
                                    },
                                    "min#StatiMin": {
                                        "value": 57.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 57.0
                                    }
                                },
                                {
                                    "key": "Jack7",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 40.0
                                    },
                                    "max#StatiMax": {
                                        "value": 40.0
                                    },
                                    "min#StatiMin": {
                                        "value": 40.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 40.0
                                    }
                                },
                                {
                                    "key": "Jack8",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Jack9",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 72.0
                                    },
                                    "max#StatiMax": {
                                        "value": 72.0
                                    },
                                    "min#StatiMin": {
                                        "value": 72.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 72.0
                                    }
                                },
                                {
                                    "key": "Quber1",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.857142857142854
                                    },
                                    "max#StatiMax": {
                                        "value": 79.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 342.0
                                    }
                                },
                                {
                                    "key": "Quber10",
                                    "doc_count": 3,
                                    "avg#StatiAvg": {
                                        "value": 31.0
                                    },
                                    "max#StatiMax": {
                                        "value": 43.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 93.0
                                    }
                                },
                                {
                                    "key": "Quber11",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 29.0
                                    },
                                    "max#StatiMax": {
                                        "value": 29.0
                                    },
                                    "min#StatiMin": {
                                        "value": 29.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 29.0
                                    }
                                },
                                {
                                    "key": "Quber12",
                                    "doc_count": 1,
                                    "avg#StatiAvg": {
                                        "value": 74.0
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 74.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 74.0
                                    }
                                },
                                {
                                    "key": "Quber2",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 51.0
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 357.0
                                    }
                                },
                                {
                                    "key": "Quber3",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 48.142857142857146
                                    },
                                    "max#StatiMax": {
                                        "value": 74.0
                                    },
                                    "min#StatiMin": {
                                        "value": 28.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 337.0
                                    }
                                },
                                {
                                    "key": "Quber4",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 53.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 76.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 373.0
                                    }
                                },
                                {
                                    "key": "Quber5",
                                    "doc_count": 7,
                                    "avg#StatiAvg": {
                                        "value": 47.285714285714285
                                    },
                                    "max#StatiMax": {
                                        "value": 70.0
                                    },
                                    "min#StatiMin": {
                                        "value": 25.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 331.0
                                    }
                                },
                                {
                                    "key": "Quber6",
                                    "doc_count": 6,
                                    "avg#StatiAvg": {
                                        "value": 41.5
                                    },
                                    "max#StatiMax": {
                                        "value": 78.0
                                    },
                                    "min#StatiMin": {
                                        "value": 20.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 249.0
                                    }
                                },
                                {
                                    "key": "Quber7",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 43.0
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 21.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 215.0
                                    }
                                },
                                {
                                    "key": "Quber8",
                                    "doc_count": 5,
                                    "avg#StatiAvg": {
                                        "value": 42.2
                                    },
                                    "max#StatiMax": {
                                        "value": 61.0
                                    },
                                    "min#StatiMin": {
                                        "value": 22.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 211.0
                                    }
                                },
                                {
                                    "key": "Quber9",
                                    "doc_count": 4,
                                    "avg#StatiAvg": {
                                        "value": 54.75
                                    },
                                    "max#StatiMax": {
                                        "value": 65.0
                                    },
                                    "min#StatiMin": {
                                        "value": 39.0
                                    },
                                    "sum#StatiSum": {
                                        "value": 219.0
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        }
    }

### 5.10ã€ğŸ è·å–æ€»æ¡æ•°ã€æœ€å¤§ã€æœ€å°ã€æ±‚å’Œæˆ–å¹³å‡å€¼ç­‰

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ€»æ¡æ•°ï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT COUNT(1) FROM A
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetCount = _quickElasticSearch.GetCount<TestElasticSearchModel>(queryCon);
    
    //å¼‚æ­¥
    var retGetCountAsync = await _quickElasticSearch.GetCountAsync<TestElasticSearchModel>(queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": 132
    }
POST /test_index/_count
    {
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        }
    }
{
        "count": 75,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–æŸå­—æ®µçš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ±‚å’Œã€å¹³å‡å€¼å’Œæ€»æ•°ç­‰ï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT COUNT(1),SUM(col1),MAX(col1),MIN(col1),AVG(col1) FROM A
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetStatiCount = _quickElasticSearch.GetStatiCount<TestElasticSearchModel>(m => m.UserAge, queryCon);
    
    //å¼‚æ­¥
    var retGetStatiCountAsync = await _quickElasticSearch.GetStatiCountAsync<TestElasticSearchModel>(m => m.UserAge, queryCon);
{
        "Item1": true,
        "Item2": "",
        "Item3": {
            "Count": 132,
            "Sum": 6842,
            "Max": 79,
            "Min": 21,
            "Avg": 51.83
        }
    }
POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiCount":{
                "value_count":{
                    "field":"UserAge"
                }
            },
            "StatiSum":{
                "sum":{
                    "field":"UserAge"
                }
            },
            "StatiMax":{
                "max":{
                    "field":"UserAge"
                }
            },
            "StatiMin":{
                "min":{
                    "field":"UserAge"
                }
            },
            "StatiAvg":{
                "avg":{
                    "field":"UserAge"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "avg#StatiAvg": {
                "value": 46.92
            },
            "max#StatiMax": {
                "value": 79.0
            },
            "value_count#StatiCount": {
                "value": 75
            },
            "min#StatiMin": {
                "value": 20.0
            },
            "sum#StatiSum": {
                "value": 3519.0
            }
        }
    }

* * *

**ä½¿ç”¨ç¤ºä¾‹ï¼ˆè·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œï¼‰ï¼š**

//ç±»ä¼¼SQLï¼šSELECT SUM(col1)åˆ†ç±»1,SUM(col2+col3+col4)åˆ†ç±»2 FROM A
    //ç»Ÿè®¡çš„å­—æ®µæ¡ä»¶
    var fieldCons = new List<EsStatisticalSumMultiModel>()
    {
        new() { AsName="åˆ†ç±»1",Fields=new List<string>{ "Money" } },
        new() { AsName="åˆ†ç±»2",Fields=new List<string>{ "Money", "MoneyOth" } }
    };
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetStatiSumMulti = _quickElasticSearch.GetStatiSumMulti<TestElasticSearchModel>(fieldCons, true, queryCon,
        (errMsg) =>
        {
            var thisErrMsg = errMsg;
        });
    
    //å¼‚æ­¥
    var retGetStatiSumMultiAsync = await _quickElasticSearch.GetStatiSumMultiAsync<TestElasticSearchModel>(fieldCons, true, queryCon,
        async (errMsg) =>
        {
            var thisErrMsg = errMsg;
    
            await Task.CompletedTask;
        });
{
        "Item1": true,
        "Item2": "",
        "Item3": {
            "åˆ†ç±»1": 754.63,
            "åˆ†ç±»2": 1658.02
        }
    }
# è·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œ
    # ç±»ä¼¼SQLï¼šSELECT SUM(Money)åˆ†ç±»1,SUM(Money+MoneyOth)åˆ†ç±»2 FROM A WHERE Id >= 1
    # æ­¤å¤„åªæ˜¯åšäº†ä¸€ä¸ªæ¼”ç¤ºï¼ŒçœŸæ­£åšåˆ°ä¸Šè¿°SQLçš„ç»Ÿè®¡æ•ˆæœï¼Œéœ€è¦åœ¨åå°ç¨‹åºå¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´â€œåˆ†ç±»1â€å’Œâ€œåˆ†ç±»2â€æ˜¯2æ¬¡è¯·æ±‚ï¼Œåˆ†ç±»2è¿™æ¬¡çš„è¯·æ±‚éœ€è¦å°†StatiSumMoneyå’ŒStatiSumMoneyOthç»Ÿè®¡çš„ç»“æœç›¸åŠ æ‰èƒ½å¾—åˆ°æœ€æ€»çš„æ€»å’Œ
    POST /test_index/_search?typed_keys=true
    {
        "track_total_hits":true,
        "aggs":{
            "StatiSumMoney":{
                "sum":{
                    "field":"Money"
                }
            },
            "StatiSumMoneyOth":{
                "sum":{
                    "field":"MoneyOth"
                }
            }
        },
        "query":{
            "bool":{
                "must":[
                    {
                        "range":{
                            "Id":{
                                "gte":1
                            }
                        }
                    }
                ]
            }
        },
        "size":0
    }
{
        "took": 0,
        "timed_out": false,
        "_shards": {
            "total": 5,
            "successful": 5,
            "skipped": 0,
            "failed": 0
        },
        "hits": {
            "total": {
                "value": 75,
                "relation": "eq"
            },
            "max_score": null,
            "hits": []
        },
        "aggregations": {
            "sum#StatiSumMoneyOth": {
                "value": 491.69998598098755
            },
            "sum#StatiSumMoney": {
                "value": 407.17499363422394
            }
        }
    }

* * *

6ã€ğŸ’ Quick.ElasticSearch.Furion æ–¹æ³•
----------------------------------

é¦–å…ˆé€šè¿‡**ä¾èµ–æ³¨å…¥**åœ¨æ„é€ å‡½æ•°ä¸­å¾—åˆ°`IQuickElasticSearch`çš„å®ä¾‹ï¼Œå…·ä½“å¯å‚ç…§ä¸Šè¿°æ–‡æ¡£ä¸­çš„ç›¸å…³ç¤ºä¾‹ã€‚

### 6.1ã€ğŸ“” ä¾èµ–æ³¨å…¥æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

å¤‡æ³¨

AddElasticSearch

æ·»åŠ ä¾èµ–æ³¨å…¥æœåŠ¡

é‡è½½ 1ï¼š()  
é‡è½½ 2ï¼š<T>()

è¯¥æ–¹æ³•ä¸º**IServiceCollection**çš„æ‰©å±•æ–¹æ³•ï¼Œç›®çš„æ˜¯å®ç°`IQuickElasticSearch`æ¥å£çš„æ³¨å†Œã€‚  
é‡è½½ 1 ä»£è¡¨æ³¨å†Œçš„æ˜¯**IQuickElasticSearch**æœåŠ¡ï¼›  
é‡è½½ 2 ä¼ å…¥äº†**æ³›å‹ T**ï¼Œä»£è¡¨çš„æ˜¯æ³¨å†Œäº†**IQuickElasticSearch**æœåŠ¡çš„åŒæ—¶ï¼Œä¹Ÿæ³¨å†Œäº† T è¿™ä¸ªæœåŠ¡ï¼ˆ**T**è¿™ä¸ªæ³›å‹ç±»ä¸­ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­å®ç°äº†**IQuickElasticSearch**æ¥å£æœåŠ¡ï¼Œè¯¥æ–¹æ³•å¯èƒ½åœ¨æ§åˆ¶å°ç¨‹åºä½¿ç”¨çš„æƒ…å†µè¾ƒå¤šï¼‰ã€‚

GetInstance

è·å–æŸæ¥å£æœåŠ¡çš„å®ä¾‹

é‡è½½ 1ï¼š()  
é‡è½½ 2ï¼š()

è¯¥æ–¹æ³•ä¸º**IServiceProvider**æˆ–**IHost**çš„æ‰©å±•æ–¹æ³•ï¼Œç›®çš„æ˜¯è·å–æŸæ¥å£æˆ–ç±»çš„å®ä¾‹ã€‚  
é‡è½½ 1 æ˜¯åŸºäº**IServiceProvider**çš„æ‰©å±•ï¼›  
é‡è½½ 2 æ˜¯åŸºäº**IHost**çš„æ‰©å±•ã€‚

### 6.2ã€ğŸ’¸ è·å– ElasticSearch å®¢æˆ·ç«¯

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetClient

è·å– ElasticSearch å®¢æˆ·ç«¯

()

è¿”å› ElasticClient å¯¹è±¡

### 6.3ã€ğŸ“• åˆ‡æ¢è¿æ¥æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

ChangeConn

åˆ‡æ¢è¿æ¥

(int connId)

æ— 

åˆ‡æ¢é…ç½®æ–‡ä»¶ä¸­æŸä¸ªè¿æ¥é…ç½®ï¼ŒconnId ä¸ºè¿æ¥ Id

### 6.4ã€ğŸ“— è·å–æ£€æŸ¥åˆ›å»ºåˆ é™¤ç´¢å¼•æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetIndexs

è·å–æ‰€æœ‰ç´¢å¼•

(bool isIncludeSystemIndex = false)

List<CatIndicesRecord>

isIncludeSystemIndexï¼šæ˜¯å¦åŒ…å«ç³»ç»Ÿç´¢å¼•

GetIndexsAsync

è·å–æ‰€æœ‰ç´¢å¼•ï¼ˆå¼‚æ­¥ï¼‰

(bool isIncludeSystemIndex = false)

List<CatIndicesRecord>

isIncludeSystemIndexï¼šæ˜¯å¦åŒ…å«ç³»ç»Ÿç´¢å¼•

IndexIsExist

æ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨

(string indexName)

è¿”å› bool ç±»å‹

indexNameï¼šç´¢å¼•åç§°

IndexIsExistAsync

æ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨ï¼ˆå¼‚æ­¥ï¼‰

(string indexName)

è¿”å› bool ç±»å‹

indexNameï¼šç´¢å¼•åç§°

CreateIndex

å¦‚æœåŒåç´¢å¼•ä¸å­˜åœ¨åˆ™åˆ›å»ºç´¢å¼•

<T>(int numberOfReplicas = 0, int numberOfShards = 5)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

numberOfReplicasï¼šé»˜è®¤å‰¯æœ¬æ•°é‡ï¼Œå¦‚æœæ˜¯å•å®ä¾‹ï¼Œæ³¨æ„æ”¹æˆ 0  
numberOfShardsï¼šé»˜è®¤åˆ†ç‰‡æ•°é‡

CreateIndexAsync

å¦‚æœåŒåç´¢å¼•ä¸å­˜åœ¨åˆ™åˆ›å»ºç´¢å¼•ï¼ˆå¼‚æ­¥ï¼‰

<T>(int numberOfReplicas = 0, int numberOfShards = 5)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

DeleteIndex

åˆ é™¤ç´¢å¼•

(string indexName)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

indexNameï¼šç´¢å¼•åç§°

DeleteIndexAsync

åˆ é™¤ç´¢å¼•ï¼ˆå¼‚æ­¥ï¼‰

(string indexName)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

indexNameï¼šç´¢å¼•åç§°

### 6.5ã€ğŸ“˜ è·å–ç´¢å¼•å¥åº·çŠ¶æ€æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetHealthStatus

è·å–ç´¢å¼•å¥åº·çŠ¶æ€

(string indexName)

è¿”å› Health æšä¸¾å¯¹è±¡ï¼ˆGreenï¼š0ã€Yellowï¼š1ã€Redï¼š2ï¼‰

indexNameï¼šç´¢å¼•åç§°

GetHealthStatusAsync

è·å–ç´¢å¼•å¥åº·çŠ¶æ€

(string indexName)

è¿”å› Health æšä¸¾å¯¹è±¡ï¼ˆGreenï¼š0ã€Yellowï¼š1ã€Redï¼š2ï¼‰

indexNameï¼šç´¢å¼•åç§°

### 6.6ã€ğŸ“™ æ·»åŠ æ•°æ®æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

InsertModel

æ·»åŠ ä¸€æ¡æ•°æ®

<T>(T docData)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDataï¼šæ•°æ®  

InsertModelAsync

æ·»åŠ ä¸€æ¡æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(T docData)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDataï¼šæ•°æ®  

InsertModels

æ·»åŠ å¤šæ¡æ•°æ®

<T>(List<T> docDatas, Action<List<T>, string, List<T>>? insertError = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDatasï¼šæ•°æ®  
insertErrorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æ•°æ®é›†åˆï¼Œå‚æ•° 2 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼Œå‚æ•° 3 ä¸ºä¿®æ”¹çš„æ‰€æœ‰æ•°æ®é›†åˆï¼‰

InsertModelsAsync

æ·»åŠ å¤šæ¡æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(List<T> docDatas, Action<List<T>, string, List<T>>? insertError = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDatasï¼šæ•°æ®  
insertErrorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æ•°æ®é›†åˆï¼Œå‚æ•° 2 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼Œå‚æ•° 3 ä¸ºä¿®æ”¹çš„æ‰€æœ‰æ•°æ®é›†åˆï¼‰

InsertModelsBatch

æ·»åŠ å¤šæ¡æ•°æ®ï¼ˆåˆ†æ‰¹æ¬¡ï¼‰

<T>(List<T> docDatas, Action<List<T>, string, List<T>>? insertError = null, int? batchCount = 1000, string backOffTime = "30s", int? backOffRetries = 5)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDatasï¼šæ•°æ®  
insertErrorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æ•°æ®é›†åˆï¼Œå‚æ•° 2 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼Œå‚æ•° 3 ä¸ºä¿®æ”¹çš„æ‰€æœ‰æ•°æ®é›†åˆï¼‰  
batchCountï¼šæ¯æ‰¹æ¬¡æ·»åŠ çš„æ•°æ®æ¡æ•°  
backOffTimeï¼šé›†ç¾¤ç¹å¿™ï¼ŒæŠ¥ 429 é”™è¯¯ç çš„æ—¶å€™ï¼Œç­‰å¾…å¤šä¹…è¿›è¡Œé‡è¯•ï¼Œé»˜è®¤ä¸ºï¼š30s  
backOffRetriesï¼šé‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤ä¸ºï¼š5 æ¬¡

### 6.7ã€ğŸ“š ä¿®æ”¹æ•°æ®æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

UpdateModelFieldsById

æ ¹æ®ä¸»é”® Id ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼

<T>(object id, object updateObj)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
idï¼šä¸»é”® Id å€¼  
updateObjï¼šä¿®æ”¹çš„åŠ¨æ€å¯¹è±¡ï¼Œæ ¼å¼å¦‚ï¼šnew { col1 = 123, col2 = 456}ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¡«å†™çš„å­—æ®µä¸€å®šè¦å’Œå®ä½“ä¸€è‡´ï¼Œå¦‚æœä¿®æ”¹çš„å­—æ®µåœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å¢åŠ è¿™ä¸ªå­—æ®µçš„

UpdateModelFieldsByIdAsync

æ ¹æ®ä¸»é”® Id ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼ï¼ˆå¼‚æ­¥ï¼‰

<T>(object id, object updateObj)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
idï¼šä¸»é”® Id å€¼  
updateObjï¼šä¿®æ”¹çš„åŠ¨æ€å¯¹è±¡ï¼Œæ ¼å¼å¦‚ï¼šnew { col1 = 123, col2 = 456}ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¡«å†™çš„å­—æ®µä¸€å®šè¦å’Œå®ä½“ä¸€è‡´ï¼Œå¦‚æœä¿®æ”¹çš„å­—æ®µåœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å¢åŠ è¿™ä¸ªå­—æ®µçš„

UpdateModelFieldsByCon

æ ¹æ®æŸ¥è¯¢æ¡ä»¶ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼

<T>(List<EsQueryModel<T>> esQueryList, object updateObj)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶  
updateObjï¼šä¿®æ”¹çš„åŠ¨æ€å¯¹è±¡ï¼Œæ ¼å¼å¦‚ï¼šnew { col1 = 123, col2 = 456}ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¡«å†™çš„å­—æ®µä¸€å®šè¦å’Œå®ä½“ä¸€è‡´ï¼Œå¦‚æœä¿®æ”¹çš„å­—æ®µåœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å¢åŠ è¿™ä¸ªå­—æ®µçš„

UpdateModelFieldsByConAsync

æ ¹æ®æŸ¥è¯¢æ¡ä»¶ä¿®æ”¹ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼ï¼ˆå¼‚æ­¥ï¼‰

<T>(List<EsQueryModel<T>> esQueryList, object updateObj)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶  
updateObjï¼šä¿®æ”¹çš„åŠ¨æ€å¯¹è±¡ï¼Œæ ¼å¼å¦‚ï¼šnew { col1 = 123, col2 = 456}ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¡«å†™çš„å­—æ®µä¸€å®šè¦å’Œå®ä½“ä¸€è‡´ï¼Œå¦‚æœä¿®æ”¹çš„å­—æ®µåœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å¢åŠ è¿™ä¸ªå­—æ®µçš„

UpdateModel

ä¿®æ”¹ä¸€æ¡æ•°æ®

<T>(T docData)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDataï¼šæ•°æ®  

UpdateModelAsync

ä¿®æ”¹ä¸€æ¡æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(T docData)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDataï¼šæ•°æ®  

UpdateModels

ä¿®æ”¹å¤šæ¡æ•°æ®

<T>(List<T> docDatas, Action<List<T>, string, List<T>>? updateError = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDatasï¼šæ•°æ®  
updateErrorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æ•°æ®é›†åˆï¼Œå‚æ•° 2 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼Œå‚æ•° 3 ä¸ºä¿®æ”¹çš„æ‰€æœ‰æ•°æ®é›†åˆï¼‰

UpdateModelsAsync

ä¿®æ”¹å¤šæ¡æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(List<T> docDatas, Action<List<T>, string, List<T>>? updateError = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
docDatasï¼šæ•°æ®  
updateErrorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æ•°æ®é›†åˆï¼Œå‚æ•° 2 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼Œå‚æ•° 3 ä¸ºä¿®æ”¹çš„æ‰€æœ‰æ•°æ®é›†åˆï¼‰

### 6.8ã€ğŸ““ åˆ é™¤æ•°æ®æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

DeleteModel

åˆ é™¤æ•°æ®ï¼ˆæ ¹æ® Id å­—æ®µï¼‰

<T>(object dataId)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
dataIdï¼šè¦åˆ é™¤çš„æ•°æ® ID  

DeleteModelAsync

åˆ é™¤æ•°æ®ï¼ˆæ ¹æ® Id å­—æ®µï¼Œå¼‚æ­¥ï¼‰

<T>(object dataId)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

Tï¼šæ³›å‹å¯¹è±¡  
dataIdï¼šè¦åˆ é™¤çš„æ•°æ® ID  

DeleteModelBy

åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®

<T>(List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

paramsï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

DeleteModelByAsync

åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯

paramsï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

### 6.9ã€ğŸ“’ è·å–æ•°æ®æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetModelsAll

è·å–æ‰€æœ‰æ•°æ®

<T>(Expression<Func<T, object>>? field = null, bool isDesc = true)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<T>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰

GetModelsAllAsync

è·å–æ‰€æœ‰æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(Expression<Func<T, object>>? field = null, bool isDesc = true)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<T>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰

GetModels

è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®

<T>(Expression<Func<T, object>>? field = null, bool isDesc = true, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<T>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetModelsAsync

è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(Expression<Func<T, object>>? field = null, bool isDesc = true, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<T>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetModelsFields

è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰

<T>(List<string> speFields, Expression<Func<T, object>>? field = null, bool isDesc = true, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
speFieldsï¼šåªè¿”å›è®¾ç½®å­—æ®µçš„å€¼ï¼Œå¦‚ï¼šnew List<string> { "SampleId", "SampleName" }  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetModelsFieldsAsync

è·å–åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼Œå¼‚æ­¥ï¼‰

<T>(List<string> speFields, Expression<Func<T, object>>? field = null, bool isDesc = true, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆ

Tï¼šæ³›å‹å¯¹è±¡  
speFieldsï¼šåªè¿”å›è®¾ç½®å­—æ®µçš„å€¼ï¼Œå¦‚ï¼šnew List<string> { "SampleId", "SampleName" }  
fieldï¼šæ’åºå­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm => m.OptTime  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetModel

è·å–ä¸€æ¡æ•°æ®ï¼ˆæ ¹æ®æŸå­—æ®µæ‰§è¡Œç­‰äºæŸ¥è¯¢ï¼‰

<T>(Expression<Func<T, object>> field, object fieldVal)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º T çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæŸ¥è¯¢çš„å­—æ®µ  
fieldValï¼šæŸ¥è¯¢çš„å­—æ®µå¯¹åº”çš„å€¼

GetModelAsync

è·å–ä¸€æ¡æ•°æ®ï¼ˆæ ¹æ®æŸå­—æ®µæ‰§è¡Œç­‰äºæŸ¥è¯¢ï¼Œå¼‚æ­¥ï¼‰

<T>(Expression<Func<T, object>> field, object fieldVal)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º T çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæŸ¥è¯¢çš„å­—æ®µ  
fieldValï¼šæŸ¥è¯¢çš„å­—æ®µå¯¹åº”çš„å€¼

GetPagerAsync

è·å–åˆ†é¡µæ•°æ®

<T>(EsPagerConModel esPagerCon, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º EsPagerModel<T>çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
esPagerConï¼šåˆ†é¡µæ¡ä»¶  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetPagerAsync

è·å–åˆ†é¡µæ•°æ®ï¼ˆå¼‚æ­¥ï¼‰

<T>(EsPagerConModel esPagerCon, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º EsPagerModel<T>çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
esPagerConï¼šåˆ†é¡µæ¡ä»¶  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetPagerFields

è·å–åˆ†é¡µæ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼‰

<T>(EsPagerConModel esPagerCon, List<string> speFields, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º EsPagerDicModel çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
esPagerConï¼šåˆ†é¡µæ¡ä»¶  
speFieldsï¼šåªè¿”å›è®¾ç½®å­—æ®µçš„å€¼ï¼Œå¦‚ï¼šnew List<string> { "SampleId", "SampleName" }  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetPagerFieldsAsync

è·å–åˆ†é¡µæ•°æ®ï¼ˆè¿”å›æŒ‡å®šå­—æ®µçš„å€¼ï¼Œå¼‚æ­¥ï¼‰

<T>(EsPagerConModel esPagerCon, List<string> speFields, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º EsPagerDicModel çš„æ•°æ®å¯¹è±¡

Tï¼šæ³›å‹å¯¹è±¡  
esPagerConï¼šåˆ†é¡µæ¡ä»¶  
speFieldsï¼šåªè¿”å›è®¾ç½®å­—æ®µçš„å€¼ï¼Œå¦‚ï¼šnew List<string> { "SampleId", "SampleName" }  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

### 6.10ã€ğŸ“‹ åˆ†ç»„ç»Ÿè®¡æŸ¥è¯¢æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetGroupValues

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼é›†åˆ

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<string>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\["åˆ†ç±» 1","åˆ†ç±» 2"\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupValuesAsync

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼é›†åˆï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<string>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\["åˆ†ç±» 1","åˆ†ç±» 2"\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupCount

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼å’Œæ•°é‡é›†åˆ

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"åˆ†ç±» 1","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupCountAsync

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›è¯¥å­—æ®µçš„æ‰€æœ‰å€¼å’Œæ•°é‡é›†åˆï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"åˆ†ç±» 1","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupCountSmma

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"åˆ†ç±» 1","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
fieldStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col2  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupCountSmmaAsync

å•ä¸ªå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"åˆ†ç±» 1","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
fieldStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.col2  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsCount

å¤šä¸ªå­—æ®µåˆ†ç»„

<T>(List<string> groupFields, List<EsQueryModel<T>>? esQueryList = null, string countKeyName = "GroupCount")

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"col1":"val1","col2":"val2","GroupCount":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
groupFieldsï¼šè¦åˆ†ç»„çš„å­—æ®µé›†åˆï¼Œå¦‚ï¼šnew List<string> { "col1", "col2" }  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡  
countKeyNameï¼šè¿”å›ç»Ÿè®¡æ•°é‡çš„ Key åç§°ï¼Œé»˜è®¤ä¸ºï¼šGroupCount ä»¶

GetGroupsCountAsync

å¤šä¸ªå­—æ®µåˆ†ç»„ï¼Œå¼‚æ­¥

<T>(List<string> groupFields, List<EsQueryModel<T>>? esQueryList = null, string countKeyName = "GroupCount")

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"col1":"val1","col2":"val2","GroupCount":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
groupFieldsï¼šè¦åˆ†ç»„çš„å­—æ®µé›†åˆï¼Œå¦‚ï¼šnew List<string> { "col1", "col2" }  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡  
countKeyNameï¼šè¿”å›ç»Ÿè®¡æ•°é‡çš„ Key åç§°ï¼Œé»˜è®¤ä¸ºï¼šGroupCount ä»¶

GetGroupsDateMonth

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDate

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œæ”¯æŒæŒ‰å¹´ã€å­£åº¦ã€æœˆä»½ã€æ˜ŸæœŸã€å¤©ã€å°æ—¶ã€åˆ†ã€ç§’ç­‰ç»´åº¦è¿›è¡Œç»Ÿè®¡

<T>(Expression<Func<T, object>> field, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œæ”¯æŒæŒ‰å¹´ã€å­£åº¦ã€æœˆä»½ã€æ˜ŸæœŸã€å¤©ã€å°æ—¶ã€åˆ†ã€ç§’ç­‰ç»´åº¦è¿›è¡Œç»Ÿè®¡ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthSmma

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroupStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthSmmaAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroupStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateSmma

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroupStati, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateSmmaAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå­—æ®µçš„æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroupStati, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Sum":999,"Max":200,"Min":10,"Avg":105}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthOneYear

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æŸå¹´ 1~12 æœˆç»Ÿè®¡æ¯ä¸ªæœˆçš„æŸä¸ªå­—æ®µæ¯ä¸ªæœˆçš„æ€»å’Œä»¥åŠè¿™ä¸€å¹´çš„æ€»å’Œ

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, int year, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºåˆ†ç»„ç»Ÿè®¡æ•°ç»„ï¼Œæ ¼å¼å¦‚ï¼š\[\["å°ç±³",3006,0,0,0,1100,0,0,0,1200,0,0,0,5306\]\]ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸º fieldGroup çš„åˆ†ç»„åç§°ï¼›åé¢ç¬¬äºŒä¸ªåˆ°ç¬¬åä¸‰ä¸ªå€¼ä¸º 1~12 æœˆä»½çš„æ€»å’Œï¼›ç¬¬åå››ä¸ªå€¼ä¸º 1~12 æœˆä»½çš„æ€»å’Œ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
yearï¼šç»Ÿè®¡çš„å¹´ä»½ï¼Œå¦‚ 2021  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthOneYearAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æŸå¹´ 1~12 æœˆç»Ÿè®¡æ¯ä¸ªæœˆçš„æŸä¸ªå­—æ®µæ¯ä¸ªæœˆçš„æ€»å’Œä»¥åŠè¿™ä¸€å¹´çš„æ€»å’Œï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, int year, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºåˆ†ç»„ç»Ÿè®¡æ•°ç»„ï¼Œæ ¼å¼å¦‚ï¼š\[\["å°ç±³",3006,0,0,0,1100,0,0,0,1200,0,0,0,5306\]\]ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸º fieldGroup çš„åˆ†ç»„åç§°ï¼›åé¢ç¬¬äºŒä¸ªåˆ°ç¬¬åä¸‰ä¸ªå€¼ä¸º 1~12 æœˆä»½çš„æ€»å’Œï¼›ç¬¬åå››ä¸ªå€¼ä¸º 1~12 æœˆä»½çš„æ€»å’Œ

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
yearï¼šç»Ÿè®¡çš„å¹´ä»½ï¼Œå¦‚ 2021  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonth

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Group":\[{"Name":"ç¢çŸ³","Count":3,"Sum":1000,"Max":100,"Min":10,"Avg":50}\]}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateMonthAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼ŒæŒ‰æœˆç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Group":\[{"Name":"ç¢çŸ³","Count":3,"Sum":1000,"Max":100,"Min":10,"Avg":50}\]}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateSub

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Group":\[{"Name":"ç¢çŸ³","Count":3,"Sum":1000,"Max":100,"Min":10,"Avg":50}\]}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetGroupsDateSubAsync

æ—¥æœŸå­—æ®µåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§å¦ä¸€ä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œç»Ÿè®¡å…¶æ¡æ•°ã€æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼ï¼Œå¼‚æ­¥

<T>(Expression<Func<T, object>> field, Expression<Func<T, object>> fieldGroup, Expression<Func<T, object>> fieldGroupStati, string dateInterval = "1M", string dateFormat = "yyyy-MM", List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸º List<Dictionary<string, object>>çš„é›†åˆï¼Œæ ¼å¼å¦‚ï¼š\[{"Name":"2021-01","Count":100,"Group":\[{"Name":"ç¢çŸ³","Count":3,"Sum":1000,"Max":100,"Min":10,"Avg":50}\]}\]

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦åˆ†ç»„çš„å­—æ®µï¼ˆæ—¥æœŸå­—æ®µï¼‰ï¼Œæ ¼å¼å¦‚ï¼šm=>m.CreateTime  
fieldGroupï¼šå¦ä¸€ä¸ªè¦åˆ†ç»„çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.TypeName  
fieldGroupStatiï¼šè¦ç»Ÿè®¡æ€»å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µï¼Œæ ¼å¼å¦‚ï¼šm=>m.Price  
dateIntervalï¼šç»Ÿè®¡çš„æ—¥æœŸé—´éš”ï¼Œé»˜è®¤ä¸º 1Mï¼ˆæ”¯æŒçš„è¡¨è¾¾å¼æœ‰ 1yï¼š1 å¹´ã€1qï¼š1 å­£åº¦ã€1Mï¼š1 ä¸ªæœˆã€1wï¼š1 æ˜ŸæœŸã€1dï¼š1 å¤©ã€1hï¼š1 å°æ—¶ã€1mï¼š1 åˆ†é’Ÿã€1sï¼š1 ç§’é’Ÿï¼‰  
dateFormatï¼šç»Ÿè®¡çš„æ—¥æœŸæ ¼å¼åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸º yyyy-MMï¼ˆæ³¨æ„å¤§å°å†™ï¼Œå®Œæ•´çš„æ ¼å¼åŒ–æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ssï¼‰  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

### 6.11ã€ğŸ“œ è·å–æ€»æ¡æ•°ã€æœ€å¤§ã€æœ€å°ã€æ±‚å’Œæˆ–å¹³å‡å€¼ç­‰æ–¹æ³•

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

GetCount

è·å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ€»æ¡æ•°

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºæ€»æ¡æ•°

Tï¼šæ³›å‹å¯¹è±¡  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetCountAsync

è·å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ€»æ¡æ•°ï¼ˆå¼‚æ­¥ï¼‰

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºæ€»æ¡æ•°

Tï¼šæ³›å‹å¯¹è±¡  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetStatiCount

è·å–æŸå­—æ®µçš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ±‚å’Œã€å¹³å‡å€¼å’Œæ€»æ•°ç­‰

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºç»Ÿè®¡æ•°æ®ï¼Œæ ¼å¼ä¸º{"Count":100,"Sum":999,"Max":150,"Min":10,"Avg":200}

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦æ±‚å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µ Bï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetStatiCountAsync

è·å–æŸå­—æ®µçš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ±‚å’Œã€å¹³å‡å€¼å’Œæ€»æ•°ç­‰ï¼ˆå¼‚æ­¥ï¼‰

<T>(Expression<Func<T, object>> field, List<EsQueryModel<T>>? esQueryList = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºç»Ÿè®¡æ•°æ®ï¼Œæ ¼å¼ä¸º{"Count":100,"Sum":999,"Max":150,"Min":10,"Avg":200}

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šè¦æ±‚å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼å’Œå¹³å‡å€¼çš„å­—æ®µ Bï¼Œæ ¼å¼å¦‚ï¼šm=>m.col1  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶

GetStatiSumMulti

è·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œ

<T>(List<EsStatisticalSumMultiModel> fieldCons, bool is2Dec, List<EsQueryModel<T>>? esQueryList = null, Action<string>? error = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºç»Ÿè®¡æ•°æ®ï¼Œæ ¼å¼ä¸º{"åˆ†ç±» 1":100,"åˆ†ç±» 2":200}

Tï¼šæ³›å‹å¯¹è±¡  
fieldConsï¼šç»Ÿè®¡çš„æŸäº›å­—æ®µå¤šä¸ªæ€»å’Œçš„æ¡ä»¶é›†åˆ  
is2Decï¼šæ˜¯å¦å°†æ€»å’Œç»“æœä¿ç•™ 2 ä¸ºå°æ•°ï¼Œfalse åˆ™å°†ä¿æŒåŸå°æ•°è¿”å›  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶  
errorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼‰

GetStatiSumMultiAsync

è·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œï¼ˆå¼‚æ­¥ï¼‰

<T>(List<EsStatisticalSumMultiModel> fieldCons, bool is2Dec, List<EsQueryModel<T>>? esQueryList = null, Func<string, Task>? error = null)

è¿”å›å…ƒç»„å¯¹è±¡ï¼ŒåŒ…å« 3 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¸ºæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„æç¤ºä¿¡æ¯ï¼Œç¬¬ä¸‰ä¸ªä¸ºç»Ÿè®¡æ•°æ®ï¼Œæ ¼å¼ä¸º{"åˆ†ç±» 1":100,"åˆ†ç±» 2":200}

Tï¼šæ³›å‹å¯¹è±¡  
fieldConsï¼šç»Ÿè®¡çš„æŸäº›å­—æ®µå¤šä¸ªæ€»å’Œçš„æ¡ä»¶é›†åˆ  
is2Decï¼šæ˜¯å¦å°†æ€»å’Œç»“æœä¿ç•™ 2 ä¸ºå°æ•°ï¼Œfalse åˆ™å°†ä¿æŒåŸå°æ•°è¿”å›  
esQueryListï¼šåŠ¨æ€æŸ¥è¯¢æ¡ä»¶  
errorï¼šé”™è¯¯å›è°ƒæ–¹æ³•ï¼ˆå‚æ•° 1 ä¸ºå‡ºé”™çš„æç¤ºä¿¡æ¯ï¼‰

### 6.12ã€ğŸ’° æŸ¥è¯¢æ¡ä»¶

åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­ï¼ŒåŸºæœ¬éƒ½æ¶‰åŠåˆ°äº†å…³äºæŸ¥è¯¢æ¡ä»¶ï¼ˆList<EsQueryModel<T>>? esQueryList = nullï¼‰çš„å‚æ•°ï¼Œåœ¨æ­¤ä¸“é—¨å¯¹æŸ¥è¯¢æ¡ä»¶çš„ä½¿ç”¨è¿›è¡Œè¯´æ˜ã€‚

**åˆ›å»ºæŸ¥è¯¢æ¡ä»¶ï¼š**

æˆ‘ä»¬ä½¿ç”¨`QuickElasticSearchExtension.CreateEsQueryModel<T>`é™æ€æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶é›†åˆå¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    //åˆ›å»ºæŸ¥è¯¢æ¡ä»¶é›†åˆå¯¹è±¡
    //CreateEsQueryModelæ–¹æ³•éœ€è¦ä¼ å…¥æ³›å‹Tï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰ã€ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰ã€ç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶çš„å›è°ƒå‡½æ•°ï¼Œç”¨äºæ·»åŠ å…·ä½“æ¡ä»¶
    //ä¸‹è¿°ä»£è¡¨çš„æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶é›†åˆå¯¹è±¡queryConï¼Œå¹¶ä¸”è®¾ç½®äº†è¯¥å¯¹è±¡ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„2ä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œç±»ä¼¼SQLï¼š(Id >= 340506710462542 AND UserAge <= 60)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462542 AND UserAge <= 60)
                queryCon
                    .AddGte(m => m.Id, 340506710462542)
                    .AddLte(m => m.UserAge, 60);
            });

**ç»„åˆæ¡ä»¶ï¼š**

ä¸Šè¿°çš„ä¾‹å­ï¼Œæˆ‘ä»¬åªå£°æ˜äº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼Œå¦‚æœéœ€è¦å¤šä¸ªç»„åˆæ¡ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™ç›´æ¥è°ƒç”¨`AddEsQueryModel`æ–¹æ³•ç»§ç»­æ·»åŠ ç»„åˆæ¡ä»¶å³å¯ï¼ˆè¯¥æ–¹æ³•ä¸ºä¸Šè¿°åˆ›å»ºçš„æ¡ä»¶é›†åˆå¯¹è±¡`queryCon`çš„æ‰©å±•æ–¹æ³•ã€é“¾å¼æ“ä½œã€‘ï¼‰ï¼Œè¯¥æ–¹æ³•çš„å‚æ•°å’Œ`CreateEsQueryModel`ä¸€æ¨¡ä¸€æ ·ï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ä»£è¡¨`(Id å¤§äºæˆ–ç­‰äº 340506710462542 å¹¶ä¸” UserAge å°äºæˆ–ç­‰äº 60) æˆ–è€…(Id ç­‰äº 340506710462539 æˆ–è€… Id ç­‰äº 340506710462538)`ï¼š

    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 340506710462542 AND UserAge <= 60)
                queryCon
                    .AddGte(m => m.Id, 340506710462542)
                    .AddLte(m => m.UserAge, 60);
            })
        //æ·»åŠ å¦ä¸€ä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(
            EsQueryType.Or,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.Or,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id = 340506710462539 OR Id = 340506710462538)
                queryCon
                    .AddEqu(m => m.Id, 340506710462539)
                    .AddEqu(m => m.Id, 340506710462538);
            });
    
    //åŒæ­¥
    var retDeleteModelBy = _quickElasticSearch.DeleteModelBy<TestElasticSearchModel>(queryCon);
    
    //å¼‚æ­¥
    var retDeleteModelByAsync = await _quickElasticSearch.DeleteModelByAsync<TestElasticSearchModel>(queryCon);

**æ›´å¤šæ¡ä»¶ï¼š**

å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ æ›´å¤šæ¡ä»¶ï¼Œç›´æ¥ä½¿ç”¨æ–¹æ³•`AddEsQueryModel`è¿½åŠ å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(â€¦â€¦,â€¦â€¦,â€¦â€¦)
    
        //ç¬¬äºŒä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(â€¦â€¦,â€¦â€¦,â€¦â€¦)
    
        //ç¬¬ä¸‰ä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(â€¦â€¦,â€¦â€¦,â€¦â€¦)
    
        //ç¬¬å››ä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(â€¦â€¦,â€¦â€¦,â€¦â€¦)
    
        //ç¬¬äº”ä¸ªç»„åˆæ¡ä»¶
        .AddEsQueryModel(â€¦â€¦,â€¦â€¦,â€¦â€¦)
    
        //ç¬¬nä¸ªç»„åˆæ¡ä»¶
        .â€¦â€¦;
    

**EsQueryModel è¯´æ˜ï¼š**

*   PrevConTypeï¼šå’Œä¸Šä¸€ä¸ª EsQueryModel ä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰ï¼›
*   QueryTypeï¼šæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹ QueryCon è€Œè¨€ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰ï¼›
*   QueryConï¼šæŸ¥è¯¢æ¡ä»¶é›†åˆã€‚

**æŸ¥è¯¢æ¡ä»¶æ‰©å±•æ–¹æ³•ï¼š**

æ–¹æ³•åç§°

æ–¹æ³•è¯´æ˜

æ–¹æ³•å‚æ•°

è¿”å›å€¼

å¤‡æ³¨

CreateEsQueryModel

åˆ›å»ºæŸ¥è¯¢æ¡ä»¶é›†åˆå¯¹è±¡

(EsQueryType prevConType = EsQueryType.And, EsQueryType queryType = EsQueryType.And, Action<List<Func<QueryContainerDescriptor<T>, QueryContainer>>>? queryConAction = null)

List<EsQueryModel<T>>

Tï¼šæ³›å‹å¯¹è±¡  
prevConTypeï¼šå’Œä¸Šä¸€ä¸ª EsQueryModel ä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰  
queryTypeï¼šå½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹ QueryCon è€Œè¨€ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰  
queryConActionï¼šå½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶çš„å›è°ƒå‡½æ•°ï¼Œç”¨äºæ·»åŠ å…·ä½“æ¡ä»¶

AddEsQueryModel

æ·»åŠ æŸ¥è¯¢æ¡ä»¶

<T>(this List<EsQueryModel<T>> queryModels, EsQueryType prevConType = EsQueryType.And, EsQueryType queryType = EsQueryType.And, Action<List<Func<QueryContainerDescriptor<T>, QueryContainer>>>? queryConAction = null)

List<EsQueryModel<T>>

Tï¼šæ³›å‹å¯¹è±¡  
prevConTypeï¼šå’Œä¸Šä¸€ä¸ª EsQueryModel ä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰  
queryTypeï¼šå½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹ QueryCon è€Œè¨€ï¼ˆAND æˆ– OR æ“ä½œï¼Œé»˜è®¤ä¸º AND æ“ä½œï¼‰  
queryConActionï¼šå½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶çš„å›è°ƒå‡½æ•°ï¼Œç”¨äºæ·»åŠ å…·ä½“æ¡ä»¶

GetSort

è·å–æ’åºæ¡ä»¶

<T>(string field, bool isDesc = true)

Func<SortDescriptor<T>, SortDescriptor<T>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µ  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰

GetSort

è·å–æ’åºæ¡ä»¶

<T>(string field, bool isDesc = true)

Func<SortDescriptor<T>, SortDescriptor<T>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šæ’åºå­—æ®µ  
isDescï¼šæ˜¯å¦ä¸ºé™åºï¼ˆé»˜è®¤ä¸ºé™åºï¼‰

CreateAndOrs

åˆ›å»º AND æˆ– OR æ¡ä»¶é›†åˆ

<T>()

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
  
ä½¿ç”¨ç¤ºä¾‹ï¼švar queryCon = QuickElasticSearchExtension.CreateAndOrs<T>();

AddEqu

æ·»åŠ ç­‰äºæŸ¥è¯¢æ¡ä»¶=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, object value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddEqu(m => m.Id, "7");

AddIn

æ·»åŠ  IN æŸ¥è¯¢æ¡ä»¶

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, List<object> values)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valuesï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddNotEqu(m => m.Id, new List<object>{"7","21","28"});

AddNotEqu

æ·»åŠ ä¸ç­‰äºæŸ¥è¯¢æ¡ä»¶=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, object value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddNotEqu(m => m.Id, "7");

AddNotEqu

æ·»åŠ ä¸ç­‰äºæŸ¥è¯¢æ¡ä»¶=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, List<object> values)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valuesï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddNotEqu(m => m.Id, new List<object>{"7","21","28"});

AddLike

æ·»åŠ æ¨¡ç³ŠæŸ¥è¯¢æ¡ä»¶ LIKE

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> fields, string value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldsï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id æˆ– m=>new \[\] {m.EngPart, m.TestType}  
valueï¼šæŸ¥è¯¢çš„å…³é”®å­—  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddLike(m => m.EngPart, "æµ‹è¯•çš„å…³é”®å­—");

AddGt

æ·»åŠ å¤§äºæŸ¥è¯¢æ¡ä»¶>

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, double value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddGt(m => m.Id, 28);

AddGt

æ·»åŠ å¤§äºæŸ¥è¯¢æ¡ä»¶>

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, DateTime value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.CreateTime  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddGt(m => m.CreateTime, "2022-10-12 14:10:26");

AddGte

æ·»åŠ å¤§äºæˆ–ç­‰äºæŸ¥è¯¢æ¡ä»¶>=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, double value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddGte(m => m.Id, 28);

AddGte

æ·»åŠ å¤§äºæˆ–ç­‰äºæŸ¥è¯¢æ¡ä»¶>=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, DateTime value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.CreateTime  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddGte(m => m.CreateTime, "2022-10-12 14:10:26");

AddLt

æ·»åŠ å°äºæŸ¥è¯¢æ¡ä»¶<

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, double value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddLt(m => m.Id, 28);

AddLt

æ·»åŠ å°äºæŸ¥è¯¢æ¡ä»¶<

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, DateTime value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.CreateTime  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddLt(m => m.CreateTime, "2022-10-12 14:10:26");

AddLte

æ·»åŠ å°äºæˆ–ç­‰äºæŸ¥è¯¢æ¡ä»¶<=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, double value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.Id  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddLte(m => m.Id, 28);

AddLte

æ·»åŠ å°äºæˆ–ç­‰äºæŸ¥è¯¢æ¡ä»¶<=

<T>(this List<Func<QueryContainerDescriptor<T>, QueryContainer>> andOrCons, Expression<Func<T, object>> field, DateTime value)

List<Func<QueryContainerDescriptor<T>, QueryContainer>>

Tï¼šæ³›å‹å¯¹è±¡  
fieldï¼šå­—æ®µè¡¨è¾¾å¼ï¼Œå¦‚ï¼šm => m.CreateTime  
valueï¼šæŸ¥è¯¢çš„å…·ä½“å€¼  
  
ä½¿ç”¨ç¤ºä¾‹ï¼šqueryCon.AddLte(m => m.CreateTime, "2022-10-12 14:10:26");

**åˆ†é¡µæŸ¥è¯¢æ¡ä»¶ï¼š**

æˆ‘ä»¬åœ¨ä½¿ç”¨åˆ†é¡µæ–¹æ³•çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦ä¼ å…¥åˆ†é¡µæŸ¥è¯¢å‚æ•°`EsPagerConModel`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    //åˆ†é¡µæ¡ä»¶
    var pagerCon = new EsPagerConModel
    {
        PageIndex = 1,
        PageSize = 15,
        OrderField = "Id",
        OrderType = "desc"
    };
    
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetPager = _quickElasticSearch.GetPager<TestElasticSearchModel>(pagerCon, queryCon);
    
    //å¼‚æ­¥
    var retGetPagerAsync = await _quickElasticSearch.GetPagerAsync<TestElasticSearchModel>(pagerCon, queryCon);

**EsPagerConModel è¯´æ˜ï¼š**

*   PageIndexï¼šå½“å‰é¡µç ï¼ˆé»˜è®¤ä¸º 1ï¼‰ï¼›
*   PageSizeï¼šå½“å‰é¡µæ•°é‡ï¼ˆé»˜è®¤ä¸º 15ï¼‰ï¼›
*   OrderFieldï¼šæ’åºå­—æ®µï¼›
*   OrderTypeï¼šæ’åºæ–¹å¼ï¼ˆé»˜è®¤ä¸º descï¼‰ã€‚

**ç»Ÿè®¡æŸ¥è¯¢æ¡ä»¶ï¼š**

æˆ‘ä»¬åœ¨ä½¿ç”¨`GetStatiSumMulti`æˆ–`GetStatiSumMultiAsync`æ–¹æ³•è·å–æŸäº›å­—æ®µç›¸åŠ çš„å¤šä¸ªæ€»å’Œçš„ç»Ÿè®¡çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦ä¼ å…¥`EsStatisticalSumMultiModel`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    //ç±»ä¼¼SQLï¼šSELECT SUM(col1)åˆ†ç±»1,SUM(col2+col3+col4)åˆ†ç±»2 FROM A
    
    //ç»Ÿè®¡çš„å­—æ®µæ¡ä»¶
    var fieldCons = new List<EsStatisticalSumMultiModel>()
    {
        new() { AsName="åˆ†ç±»1",Fields=new List<string>{ "Money" } },
        new() { AsName="åˆ†ç±»2",Fields=new List<string>{ "Money", "MoneyOth" } }
    };
    
    //å®šä¹‰æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
    var queryCon = QuickElasticSearchExtension
        //åˆ›å»ºæ¡ä»¶ï¼ˆé»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªç»„åˆæ¡ä»¶ï¼‰
        .CreateEsQueryModel<TestElasticSearchModel>(
            EsQueryType.And,//å’Œä¸Šä¸€ä¸ªEsQueryModelä¹‹é—´çš„è¿æ¥ç±»å‹ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            EsQueryType.And,//å½“å‰ç»„åˆæŸ¥è¯¢æ¡ä»¶é›†åˆçš„è¿æ¥ç±»å‹ï¼Œé’ˆå¯¹QueryConè€Œè¨€ï¼ˆANDæˆ–ORæ“ä½œï¼Œé»˜è®¤ä¸ºANDæ“ä½œï¼‰
            (queryCon) =>
            {
                //æŸ¥è¯¢æ¡ä»¶ï¼š(Id >= 1)
                queryCon.AddGte(m => m.Id, 1);
            });
    
    //åŒæ­¥
    var retGetStatiSumMulti = _quickElasticSearch.GetStatiSumMulti<TestElasticSearchModel>(fieldCons, true, queryCon,
        (errMsg) =>
        {
            var thisErrMsg = errMsg;
        });
    
    //å¼‚æ­¥
    var retGetStatiSumMultiAsync = await _quickElasticSearch.GetStatiSumMultiAsync<TestElasticSearchModel>(fieldCons, true, queryCon,
        async (errMsg) =>
        {
            var thisErrMsg = errMsg;
    
            await Task.CompletedTask;
        });
    

**EsStatisticalSumMultiModel è¯´æ˜ï¼š**

*   AsNameï¼ˆstringï¼‰ï¼šæŸå‡ ä¸ªå­—æ®µç›¸åŠ æ€»å’Œæœ€åè¿”å›çš„ Key åç§°ï¼›
*   Fieldsï¼ˆList<string>ï¼‰ï¼šæŸå‡ ä¸ªå­—æ®µç›¸åŠ çš„å­—æ®µé›†åˆã€‚