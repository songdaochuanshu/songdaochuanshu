---
layout: post
title: "BootstrapBlazorå®æˆ˜ Chart å›¾è¡¨ä½¿ç”¨(1)"
date: "2022-04-03T02:52:58.631Z"
---
BootstrapBlazorå®æˆ˜ Chart å›¾è¡¨ä½¿ç”¨(1)
===============================

BootstrapBlazorç»„ä»¶ Chart å›¾è¡¨ä»‹ç»
----------------------------

**é€šè¿‡ç»™å®šæ•°æ®ï¼Œç»˜ç”»å„ç§å›¾è¡¨çš„ç»„ä»¶**

æœ¬æ–‡ä¸»è¦ä»‹ç»ä¸‰ç§å›¾è¡¨ä½¿ç”¨:æŠ˜çº¿å›¾,æŸ±çŠ¶å›¾,é¥¼å›¾

![161407646-caa3a8d4-c13c-4a91-91f8-b6ea48e7aed0](https://user-images.githubusercontent.com/8428709/161407726-a53e25b9-02f1-45ed-bf7a-a1d683990209.png)  
![161407637-ed3ca1cc-a243-432a-89b2-7ee041832ab4](https://user-images.githubusercontent.com/8428709/161407727-a97697b0-1bbf-4c50-82c9-dd1fc6d53782.png)  
![161407656-9bd4cb1d-49bb-490d-8b94-57af641c1a72](https://user-images.githubusercontent.com/8428709/161407725-f60ab05b-7ee5-45f4-87fb-03640569ccc8.png)

1.æ–°å»ºå·¥ç¨‹
------

æ–°å»ºå·¥ç¨‹b06chart,ä½¿ç”¨ nuget.org è¿›è¡Œ BootstrapBlazor ç»„ä»¶å®‰è£…, Chart åº“,å­—ä½“. å°†é¡¹ç›®æ·»åŠ åˆ°è§£å†³æ–¹æ¡ˆä¸­

    dotnet new blazorserver -o b06chart
    dotnet add b06chart package BootstrapBlazor
    dotnet add b06chart package BootstrapBlazor.FontAwesome
    dotnet add b06chart package BootstrapBlazor.Chart
    dotnet sln add b06chart/b06chart.csproj
    

2.æ ·å¼è¡¨å’ŒJavascript å¼•ç”¨
-------------------

å¢åŠ ä¸»é¢˜æ ·å¼è¡¨åˆ° `Pages/_Layout.cshtml` æ–‡ä»¶ä¸­

åˆ é™¤ `<link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />`

å¹¶åœ¨ä¸‹é¢æ·»åŠ ä¸‰è¡Œ

    <link href="_content/BootstrapBlazor.FontAwesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="_content/BootstrapBlazor/css/bootstrap.blazor.bundle.min.css" rel="stylesheet" />
    <link href="_content/BootstrapBlazor.Chart/css/bootstrap.blazor.chart.bundle.min.css" rel="stylesheet" />
    

æ·»åŠ  Javascript å¼•ç”¨åˆ° `Pages/_Layout.cshtml` æ–‡ä»¶ä¸­

åœ¨ `<script src="_framework/blazor.server.js"></script>` ä¹‹å‰æ·»åŠ 

    <script src="_content/BootstrapBlazor/js/bootstrap.blazor.bundle.min.js" asp-append-version="true"></script>
    <script src="_content/BootstrapBlazor.Chart/js/bootstrap.blazor.chart.bundle.min.js" asp-append-version="true"></script>
    

3.æ·»åŠ å¢åŠ å‘½åç©ºé—´å¼•ç”¨åˆ° `_Imports.razor` æ–‡ä»¶ä¸­
----------------------------------

    @using BootstrapBlazor.Components
    

4.å¢åŠ  BootstrapBlazorRoot ç»„ä»¶åˆ° App.razor æ–‡ä»¶ä¸­
------------------------------------------

    <BootstrapBlazorRoot>
        <Router AppAssembly="@typeof(App).Assembly">
            ...
        </Router>
    </BootstrapBlazorRoot>
    

5.æ·»åŠ BootstrapBlazoræœåŠ¡åˆ° `Program.cs` æ–‡ä»¶ä¸­
---------------------------------------

åœ¨ `builder.Services.AddSingleton<WeatherForecastService>();` ååŠ å…¥

    builder.Services.AddBootstrapBlazor();
    

6.ç»„ä»¶å‚æ•°
------

å‚æ•°

è¯´æ˜

å¯é€‰å€¼

é»˜è®¤å€¼

Width

ç»„ä»¶å®½åº¦æ”¯æŒå•ä½ å¦‚: 100px 75%

ChartType

å›¾è¡¨ç±»å‹

Line/Bar/Pie/Doughnut/Bubble

Line

7.äº‹ä»¶
----

å‚æ•°

è¯´æ˜

ç±»å‹

OnInitAsync

ç»„ä»¶æ•°æ®åˆå§‹åŒ–å§”æ‰˜æ–¹æ³•

Func<Task\>

OnAfterInitAsync

å®¢æˆ·ç«¯ç»˜åˆ¶å›¾è¡¨å®Œæ¯•åå›è°ƒæ­¤å§”æ‰˜æ–¹æ³•

Func

OnAfterUpdateAsync

å®¢æˆ·ç«¯æ›´æ–°å›¾è¡¨å®Œæ¯•åå›è°ƒæ­¤å§”æ‰˜æ–¹æ³•

Func<ChartAction, Task>

8.ä¸ºäº†å¿«é€Ÿå»ºç«‹éšæœºæ•°æ®,æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå·¥å…·ç±» `UtilityChart.cs`
----------------------------------------

ä»£ç æ¥æºäºbbæ¼”ç¤ºå·¥ç¨‹

    using BootstrapBlazor.Components;
    
    namespace b06chart;
    
    /// <summary>
    /// Chart å·¥å…·ç±»
    /// </summary>
    internal static class UtilityChart
    {
        public static IEnumerable<string> Colors { get; } = new List<string>() { "Red", "Blue", "Green", "Orange", "Yellow", "Tomato", "Pink", "Violet" };
    
        /// <summary>
        /// 
        /// </summary>
        /// <param name="chart"></param>
        public static Task RandomData(Chart chart) => chart.Update(ChartAction.Update);
    
        /// <summary>
        /// 
        /// </summary>
        /// <param name="chart"></param>
        /// <param name="dsCount"></param>
        public static void AddDataSet(Chart chart, ref int dsCount)
        {
            if (dsCount < Colors.Count())
            {
                dsCount++;
                _ = chart.Update(ChartAction.AddDataset);
            }
        }
    
        /// <summary>
        /// 
        /// </summary>
        /// <param name="chart"></param>
        /// <param name="dsCount"></param>
        public static void RemoveDataSet(Chart chart, ref int dsCount)
        {
            if (dsCount > 1)
            {
                dsCount--;
                _ = chart.Update(ChartAction.RemoveDataset);
            }
        }
    
        /// <summary>
        /// 
        /// </summary>
        /// <param name="chart"></param>
        /// <param name="daCount"></param>
        public static void AddData(Chart chart, ref int daCount)
        {
            var limit = chart.ChartType switch
            {
                ChartType.Line => 14,
                ChartType.Bar => 14,
                ChartType.Bubble => 14,
                _ => Colors.Count()
            };
    
            if (daCount < limit)
            {
                daCount++;
                _ = chart.Update(ChartAction.AddData);
            }
        }
    
        /// <summary>
        /// 
        /// </summary>
        /// <param name="chart"></param>
        /// <param name="daCount"></param>
        public static void RemoveData(Chart chart, ref int daCount)
        {
            var limit = chart.ChartType switch
            {
                ChartType.Line => 7,
                ChartType.Bar => 7,
                ChartType.Bubble => 4,
                _ => 2
            };
            if (daCount > limit)
            {
                daCount--;
                _ = chart.Update(ChartAction.RemoveData);
            }
        }
    }
    

9.æŠ˜çº¿å›¾
-----

    <p>æŠ˜çº¿å›¾</p>
    
    <Chart @ref="LineChart" OnInitAsync="() => OnInit(0.4f, false)" Width="50%" />
    
    <button class="btn btn-primary" @onclick="e => UtilityChart.RandomData(LineChart)"><i class="fa fa-line-chart"></i><span>éšæœºæ•°æ®</span></button>
    
    @code{
        private Random Randomer { get; } = new Random();
        private int LineDatasetCount = 2;
        private int LineDataCount = 7;
    
        private Chart? LineChart { get; set; }
    
        private Task<ChartDataSource> OnInit(float tension, bool hasNull)
        {
            var ds = new ChartDataSource();
            ds.Options.Title = "Line æŠ˜çº¿å›¾";
            ds.Options.X.Title = "å¤©æ•°";
            ds.Options.Y.Title = "æ•°å€¼";
            ds.Labels = Enumerable.Range(1, LineDataCount).Select(i => i.ToString());
            for (var index = 0; index < LineDatasetCount; index++)
            {
                ds.Data.Add(new ChartDataset()
                {
                    Tension = tension,
                    Label = $"æ•°æ®é›† {index}",
                    Data = Enumerable.Range(1, LineDataCount).Select((i, index) => (index == 2 && hasNull) ? null! : (object)Randomer.Next(20, 37))
                });
            }
            return Task.FromResult(ds);
        }
    }
    

10.æŸ±çŠ¶å›¾
------

    <p>æŸ±çŠ¶å›¾</p>
    
    <Chart ChartType="ChartType.Bar" OnInitAsync="() => OnInit(false)" @ref="BarChart" Width="50%" />
    
    <button class="btn btn-primary" @onclick="e => UtilityChart.RandomData(BarChart)"><i class="fa fa-bar-chart"></i><span>éšæœºæ•°æ®</span></button>
    
    @code{
        private int BarDatasetCount = 2;
        private int BarDataCount = 7; 
     
        private Chart? BarChart { get; set; }
    
        private Task<ChartDataSource> OnInit(bool stacked)
        {
            var ds = new ChartDataSource();
            ds.Options.Title = "Bar æŸ±çŠ¶å›¾";
            ds.Options.X.Title = "å¤©æ•°";
            ds.Options.Y.Title = "æ•°å€¼";
            ds.Options.X.Stacked = stacked;
            ds.Options.Y.Stacked = stacked;
            ds.Labels = Enumerable.Range(1, BarDataCount).Select(i => i.ToString());
            for (var index = 0; index < BarDatasetCount; index++)
            {
                ds.Data.Add(new ChartDataset()
                {
                    Label = $"æ•°æ®é›† {index}",
                    Data = Enumerable.Range(1, BarDataCount).Select(i => Randomer.Next(20, 37)).Cast<object>()
                });
            }
            return Task.FromResult(ds);
        }
    }
    

11.é¥¼å›¾
-----

    <p>é¥¼å›¾</p>
    
    <Chart ChartType="ChartType.Pie" OnInitAsync="@OnInit" @ref="PieChart" Width="50%" />
    
    <button class="btn btn-primary" @onclick="e => UtilityChart.RandomData(PieChart)"><i class="fa fa-pie-chart"></i><span>éšæœºæ•°æ®</span></button>
    
    @code{
        private int PieDatasetCount = 1;
        private int PieDataCount = 5;
    
        private Chart? PieChart { get; set; }
    
        private Task<ChartDataSource> OnInit()
        {
            var ds = new ChartDataSource();
            ds.Options.Title = "Pie é¥¼å›¾";
            ds.Labels = UtilityChart.Colors.Take(PieDataCount);
            for (var index = 0; index < PieDatasetCount; index++)
            {
                ds.Data.Add(new ChartDataset()
                {
                    Label = $"æ•°æ®é›† {index}",
                    Data = Enumerable.Range(1, PieDataCount).Select(i => Randomer.Next(20, 37)).Cast<object>()
                });
            }
            return Task.FromResult(ds);
        }
    }
    

12.æœªå®Œå¾…ç»­ ğŸ˜ƒ
----------

é€šè¿‡ç®€å•çš„æ­¥éª¤,å·²ç»å¯ä»¥åˆæ­¥ä½“éªŒå›¾è¡¨ç»„ä»¶,ç”±äºè¿‘æ—¥äº‹åŠ¡è¾ƒå¤š,è¿™ç¯‡åªæ˜¯åˆç•¥çš„å¸¦å¤§å®¶å¿«é€Ÿå…¥é—¨,ä½“éªŒä¸€ä¸‹BootstrapBlazorçš„Chart å›¾è¡¨ä½¿ç”¨. ä¸‹ä¸€ç¯‡ç« æˆ‘ä»¬å°†ä¼šå¯¹ç»„ä»¶è¿›è¡Œä¸€äº›è°ƒæ•´,ä¾‹å¦‚æ·»åŠ ç§»é™¤æ•°æ®é›†,æ·»åŠ ç§»é™¤æ•°æ®,Xè½´Yè½´æ•°æ®æ”¹å˜åå¦‚ä½•åˆ·æ–°ç»„ä»¶,ä»¥åŠè·Ÿæ•°æ®åº“ç»“åˆæŸ¥è¯¢ç”Ÿæˆå›¾è¡¨.

#### é¡¹ç›®æºç 

[Github](https://github.com/densen2014/Blazor100) | [Gitee](https://gitee.com/densen2014/Blazor100)

#### å…³è”é¡¹ç›®

FreeSql QQç¾¤ï¼š4336577(å·²æ»¡)ã€8578575(å·²æ»¡)ã€52508226(åœ¨çº¿)

BA & Blazor QQç¾¤ï¼š795206915ã€675147445

#### çŸ¥è¯†å…±äº«è®¸å¯åè®®

æœ¬ä½œå“é‡‡ç”¨ [çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®](https://creativecommons.org/licenses/by-nc-sa/4.0/) è¿›è¡Œè®¸å¯ã€‚æ¬¢è¿è½¬è½½ã€ä½¿ç”¨ã€é‡æ–°å‘å¸ƒï¼Œä½†åŠ¡å¿…ä¿ç•™æ–‡ç« ç½²åAlexChowï¼ˆåŒ…å«é“¾æ¥ï¼š [https://github.com/densen2014](https://github.com/densen2014) ï¼‰ï¼Œä¸å¾—ç”¨äºå•†ä¸šç›®çš„ï¼ŒåŸºäºæœ¬æ–‡ä¿®æ”¹åçš„ä½œå“åŠ¡å¿…ä»¥ç›¸åŒçš„è®¸å¯å‘å¸ƒã€‚å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·[ä¸æˆ‘è”ç³»](zhouchuanglin@gmail.com) ã€‚

#### AlexChow

[ä»Šæ—¥å¤´æ¡](https://www.toutiao.com/c/user/token/MS4wLjABAAAAGMBzlmgJx0rytwH08AEEY8F0wIVXB2soJXXdUP3ohAE/?) | [åšå®¢å›­](https://www.cnblogs.com/densen2014) | [çŸ¥ä¹](https://www.zhihu.com/people/alex-chow-54) | [Gitee](https://gitee.com/densen2014) | [GitHub](https://github.com/densen2014)