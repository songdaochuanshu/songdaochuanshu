---
layout: post
title: "ã€è®ºæ–‡é˜…è¯»ã€‘ICLR 2022: Scene Transformer: A unified architecture for predicting future trajectories of multiple agents"
date: "2022-04-05T17:20:24.327Z"
---
ã€è®ºæ–‡é˜…è¯»ã€‘ICLR 2022: Scene Transformer: A unified architecture for predicting future trajectories of multiple agents
================================================================================================================

ICLR 2022: Scene Transformer: A unified architecture for predicting future trajectories of multiple agents

Type: ICLR  
Year: 2022  
ç»„ç»‡: waymo

*   å‚è€ƒä¸å‰è¨€
    
    *   openreivew
    
    [https://openreview.net/forum?id=Wm3EA5OlHsG](https://openreview.net/forum?id=Wm3EA5OlHsG)
    
    *   pdf
    
    [Scene Transformer: A unified architecture for predicting multiple agent trajectories](https://arxiv.org/abs/2106.08417)
    

1\. Motivation
==============

ä¸»è¦å—è¯­è¨€æ¨¡å‹æ–¹æ³• language modeling approach å¯å‘è€Œæ¥

é—®é¢˜åœºæ™¯
----

ä»»åŠ¡ï¼šå¤šagentçš„è½¨è¿¹é¢„æµ‹é—®é¢˜

éš¾ç‚¹ï¼šå› ä¸ºagentæœ¬èº«è¡Œä¸ºçš„å¤šæ ·æ€§ ï¼ˆdiverseï¼‰ï¼ŒåŠ ä¹‹å¯¹å½¼æ­¤è½¨è¿¹çš„å½±å“ï¼ˆinfluenceï¼‰

ä¹‹å‰å·¥ä½œä¸»è¦èšç„¦åœ¨æ ¹æ®è¿‡å»åŠ¨ä½œé¢„æµ‹ å•ç‹¬ agentçš„æœªæ¥è½¨è¿¹ï¼Œç„¶åæ ¹æ®å„è‡ªçš„é¢„æµ‹æ¥è¿›è¡Œè§„åˆ’ï¼›ä½†æ˜¯å‘¢ independent predictions å¹¶ä¸åˆ©äºè¡¨ç¤ºæœªæ¥çŠ¶æ€ä¸‹ ä¸åŒagentä¹‹é—´çš„äº¤äº’é—®é¢˜ï¼Œä»è€Œå¼•ç”³è§„åˆ’æ—¶ä¹Ÿæ˜¯sub-optimalçš„è½¨è¿¹

*   marginal predictionï¼šæœªæ¥æ—¶åˆ» ä¸åŒagenté¢„æµ‹çš„è½¨è¿¹å¯èƒ½ä¼šæœ‰å†²çªéƒ¨åˆ†ï¼Œå³ä¸¤è€…ç›¸äº¤
*   joint predictionï¼šåœ¨åŒä¸€æœªæ¥æ—¶åˆ»ï¼Œä¸åŒagentçš„é¢„æµ‹è½¨è¿¹ä¸ä¼šå†²çªï¼Œ respect each othersâ€™ prediction

![](https://img-blog.csdnimg.cn/56a802fff24141b293f3e5125a3b366c.png)

Contribution
------------

formulate a model å»åŒæ—¶(jointly)é¢„æµ‹æ‰€æœ‰çš„agentè¡Œä¸ºï¼Œproducing consistent future æ¥è§£é‡Šagentä¹‹é—´çš„è¡Œä¸º

ä»¥ä¸‹ä¸ºåŸæ–‡ï¼Œè¿™ä¸ªè´¡çŒ®çš„æ ¼å¼å’Œjjhè¯´çš„TROæ ¼å¼å¥½åƒï¼Œåè¯æ–¹æ³•ä¸ºä¸»è¯­

1.  A novel, scene-centric approach that allows us to gracefully **switch** training the model to produce either **marginal (independent) and joint** agent predictions in a single feed-forward pass.
    
    ä»…åœ¨å•ä¸ªfeed-forwardä¸­è¿›è¡Œmarginalå’Œjoint predictionä¹‹é—´çš„åˆ‡æ¢
    
2.  A permutation equivariant Transformer-based architecture **factored over agents, time, and road graph elements** that exploits the inherent symmetries of the problem.
    
    ä½¿ç”¨ä¸ transformer ç›¸åŒ(ç­‰ä»·)çš„permutation æ¥å°†agents, timeå’Œroad graphéƒ½è€ƒè™‘åœ¨ç³»ç»Ÿå†…
    
3.  A masked sequence modeling approach that enables us to **condition on hypothetical** agent futures at inference time, enabling conditional motion prediction or goal conditioned prediction.
    
    masked sequence modeling èƒ½ä½¿æˆ‘ä»¬å°†æœªæ¥è€ƒè™‘åœ¨å†…ï¼Œæ—¶é—´æ„ä¹‰ä¸Š
    

* * *

é—®é¢˜åŒºï¼š

*    æ‘˜è¦çš„æ–¹æ³•æ²¡çœ‹æ‡‚ï¼Œä¸‰ä¸ªä¸€ä¸ªéƒ½æ²¡çœ‹æ‡‚.... TBDé˜…è¯»åˆ°åé¢åœ¨å›ç­”è¿™ä¸ªé—®é¢˜å§
    
    Through combining a scene-centric approach, agent permutation equivariant model, and a sequence masking strategy
    
    *    ä»‹ç»ä¸­å¼•å…¥scene-centricè¯´çš„æ˜¯ä¸ºäº†scaling to large numbers of agentsï¼Œä½†æ˜¯åœ¨è´¡çŒ®ä¸­å´è¯´çš„æ˜¯åˆ‡æ¢ï¼Ÿemmm æ˜¯æ•°é‡å¤§äº†å°±åˆ‡æ¢ï¼Ÿå°äº†å°±jointï¼Ÿ
*    è¯„ä¼°æ—¶ä¸ºä»€ä¹ˆæ˜¯marginal and joint motion predictionsï¼Œåè€…å¯ä»¥ç†è§£ï¼Œå‰è€…çš„marginalæ˜¯ä»€ä¹ˆé¢„æµ‹ï¼Ÿå•ç‹¬agentçš„é¢„æµ‹ä¸çœŸå€¼å¯¹æ¯”å˜›ï¼Ÿ
    
    åé¢ä»‹ç»éƒ¨åˆ†è§£é‡Šäº†ï¼Œè§å‰é¢è§£é‡Š
    
*    ä¸ºä»€ä¹ˆ[è¦åˆ‡æ¢](https://www.notion.so/ICLR-2022-Scene-Transformer-A-unified-architecture-for-predicting-future-trajectories-of-multiple--37a700f54efb4e4f87eee9f682c6a0d5) ä¸ºä»€ä¹ˆ\[è¦åˆ‡æ¢\](https://www.notion.so/ICLR-2022-Scene-Transformer-A-unified-architecture-for-predicting-future-trajectories-of-multiple--37a700f54efb4e4f87eee9f682c6a0d5)ï¼Ÿç›´æ¥æ•´ä½“è¿›è¡Œjoint predictionä¸æ˜¯æ›´å¥½å—ï¼Ÿ
    
    æ–¹æ³•å¤„è¯´æ˜äº† æ˜¯ä¸åŒçš„ä»»åŠ¡ä¹‹é—´éƒ½å¯ä»¥ç”¨è¿™ä¸€ä¸ªç½‘ç»œè¿›è¡Œï¼Œä¸»è¦ä»»åŠ¡æ˜¯ï¼šmotion predictionã€conditional motion predictionã€goal-conditioned prediction
    
*    transformerï¼Ÿattention æœºåˆ¶ï¼Ÿè€ƒè™‘æ—¶å½¢å¼ä»¥vectorå½¢å¼å—ï¼Ÿ
    
    æ–¹æ³•ä¸­æœ‰å…·ä½“ä»‹ç»ï¼Œé™æ­¢çš„road graphç”¨feature vectorå½¢å¼ï¼ŒåŠ¨æ€çš„æ¯”å¦‚çº¢ç»¿ç¯æ˜¯one feature vector per objectå½¢å¼
    
*    æ²¡çœ‹æ‡‚æœ€åä¸€æ¡è´¡çŒ®ï¼Œå› ä¸ºåœ¨ç¬¬äºŒæ¡é‡Œå·²ç»è¯´æ˜äº†ä½¿ç”¨transformç±»ä¼¼æœºåˆ¶å°†timeè€ƒè™‘è¿›å†…ï¼Œmask squence å»ºæ¨¡åŸå› æœ‰é‡å¤ï¼Ÿ
    
    *    æ˜¯ç›´æ¥å¯¹æœªæ¥çš„agentè¿›è¡Œå‡è®¾å˜›ï¼Ÿå¯èƒ½æ˜¯å‰æƒ…æè¦çŸ¥è¯†ç¼ºçš„æœ‰ç‚¹å¤šï¼Œå¯èƒ½å¾—å¥—å¨ƒæ¯”è¾ƒå¤š
    
    maskçš„åŸå› å…¶å®æ˜¯åˆ‡æ¢... The approach is flexible, enabling us to simultaneously train a single model for MP, CMP, GCP.
    
*    å¦‚æœæœ‰æ¦œçš„è¯ ä¸æ˜¯ç¬¬ä¸€ï¼Œä¹Ÿå¯ä»¥ç§°è‡ªå·±ä¸ºstate-of-artå˜›ï¼Ÿæ¯•ç«Ÿè¿™ç¯‡åœ¨waymo online æ’è¡Œæ¦œä¸­ï¼Œæ’åæŒºåçš„
    

2\. Method
==========

ç›¸å…³å·¥ä½œä¸»è¦æ˜¯å›´ç»•ï¼Œæ­¤å¤„ä»…åšç®€å•æ€»ç»“ï¼Œä¸»è¦æ˜¯å‰æƒ…æè¦çŸ¥è¯†è¡¥å…… å¯èƒ½èƒ½è§£ç­”ä¸Šé¢çš„é—®é¢˜

*   motion predictionæ¡†æ¶ï¼šè¯´æ˜æˆåŠŸçš„æ¨¡å‹å¤§å¤šéƒ½ä¼šè€ƒè™‘agent motion historyå’Œé“è·¯ç»“æ„ï¼ˆåŒ…æ‹¬lane, stop line, çº¢ç»¿ç¯ç­‰ç­‰ï¼‰ï¼›
    
    ç›¸å…³æ–¹å¼ï¼š
    
    *   ç›´æ¥å°†è¾“å…¥æ¸²æŸ“ä¸ºå¤šé€šé“çš„é¸Ÿç°å›¾ top-down imageï¼Œç„¶åä½¿ç”¨å·ç§¯ï¼Œä½†æ˜¯receptive fieldå¹¶ä¸åˆ©äºcapturing spatially-distant intersection
    *   entity-centric approachï¼šå¯ä»¥å°†agentçš„å†å²çŠ¶æ€ä½¿ç”¨sequence modelingæ–¹å¼ä¾‹å¦‚ RNNï¼Œè¿›è¡Œç¼–ç ï¼Œå…¶ä¸­å°†é“è·¯ç»“æ„ä¸­ pose ä¿¡æ¯å’Œ semantic type éƒ½ç¼–ç ï¼ˆæ¯”å¦‚ä»¥piecewise-linear segmentsï¼‰è¿›å…¥ç³»ç»Ÿï¼›ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•å°†ä¿¡æ¯è¿›è¡Œèšåˆï¼šemploy pooling, soft-attention, graph neural networks
*   scene-centric å’Œ agent-centric representationï¼šä¸»è¦æ˜¯è®¨è®º representation encodingæ‰€ç”¨çš„æ¡†æ¶
    
    *   ä»¥scene-level ä½œä¸ºåæ ‡ç³»ï¼Œrasterized top-down imageï¼Œè™½ç„¶èƒ½æœ‰æ•ˆçš„è¡¨ç¤ºworldçŠ¶æ€åœ¨commonçš„åæ ‡ç³»ä¸‹ï¼Œä½†æ˜¯ä¸§å¤±äº†ä¸€äº›æ½œåœ¨çš„poseä¿¡æ¯
    *   ä»¥agent-coordinate ä¸ºåæ ‡ç³»ï¼Œä½†æ˜¯éšç€agentæ•°é‡ä¸Šå‡ åŒæ—¶ äº¤äº’çš„æ•°é‡ä¹Ÿä¼šäºŒæ¬¡æ–¹ä¸Šå‡ã€‚
    
    åç»­è¯´æ˜ waymoçš„å¦ä¸€ç¯‡å·¥ä½œLaneGCNå°±æ˜¯ä»¥agentä¸ºä¸­å¿ƒ ä½†æ˜¯å®åœ¨global frameä¸‹åšçš„ã€‚åŒæ—¶ä¹Ÿä¸éœ€è¦å°†åœºæ™¯è¡¨ç¤ºæˆä¸ºå›¾åƒçš„å½¢å¼
    
*   Representing multi-agent futuresï¼šä¸»è¦æ˜¯å¦‚ä½•è¡¨ç¤ºå¤šagentçš„æœªæ¥çŠ¶æ€ï¼Œå¸¸ç”¨çš„æœ‰ç›´æ¥å¯¹æ¯ä¸ªagentçš„è½¨è¿¹ä½¿ç”¨æƒé‡
    

* * *

é—®é¢˜åŒºï¼š

*    ç¬¬äºŒç‚¹æåˆ°çš„representationä¸å°±æ˜¯ç¬¬ä¸€ç‚¹é‡Œé¢çš„ç›¸å…³æ–¹å¼å˜›ï¼Ÿæ„Ÿè§‰è¿™ç¯‡æ–‡ç« å¥½å¤šåœ°æ–¹æœ‰è€¦åˆ æ–¹æ³•å’Œæ–¹æ³•ä¹‹é—´çš„åŸå› å¾ˆåƒï¼Œä¸ºä½•ä¸ç›´æ¥æ€»ç»“æˆä¸€ä¸ªï¼Ÿ
    
    ä¸€ä¸ªæ˜¯representationï¼Œä¸€ä¸ªæ˜¯ä»¥ä»€ä¹ˆä¸ºä¸­å¿ƒè¿›è¡Œ
    

2.1 è¾“å…¥ä¸è¾“å‡º
---------

**è¾“å…¥**

a feature for every agent at every time step

åœ¨æ¨¡å‹ä¸­ æ˜¯ä¸€ä¸ª3d tensorï¼ŒA ä¸ª agentsï¼Œæ¯ä¸ªé‡Œé¢æœ‰Dä¸ªç‰¹å¾ç»´åº¦ï¼Œåœ¨æ—¶é—´T stepsï¼ŒåŒæ—¶åœ¨æ¯å±‚layersä¸­æˆ‘ä»¬éƒ½æƒ³ä¿æŒä½è¿™æ ·çš„sizeï¼š\\(\[A,T,D\]\\)

æ³¨æ„åœ¨decoderä¸­æœ‰å¤šçš„ä¸€ä¸ªç»´åº¦ï¼šF potential futures

**è¾“å‡º**

an output for every agent at every time step

2.2 æ¡†æ¶
------

æ•´ä½“æ¨¡å‹åç§°ï¼šscene transformerï¼Œä¸€å…±æœ‰ä¸‰ä¸ªé˜¶æ®µï¼š

1.  å°†agentså’Œroad graph embedåˆ°ä¸€ä¸ªé«˜ç»´ç©ºé—´
2.  employ attention-based network å» encode agentså’Œroad graphä¹‹é—´çš„äº¤äº’
3.  ä½¿ç”¨attention-based network å» decode multiple future

![](https://img-blog.csdnimg.cn/3709f58b2e314b2f9155de8a5d4adc82.png)

**mask**

å¯¹äºå¤šä»»åŠ¡çš„åˆ‡æ¢ä¸»è¦ç”¨maskæ¥å®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨åšMPçš„æ—¶å€™æ—¶é—´ç»´åº¦ä¸Šæœ‰maskè¢«é®æŒ¡ï¼Œä½†æ˜¯å¦‚æœæ˜¯CMPåˆ™è‡ªèº«çš„motionæä¾›æœªæ¥æ—¶é—´å†…motionï¼ŒGCPçš„è¯å°±æ˜¯æä¾›æœ€è¿œæ—¶é—´Tçš„AV motion

![](https://img-blog.csdnimg.cn/b9d13e4b8a5e4b2b8e0960a46a24371b.png)

### A. Scene-Centric Representation

æ­¤ç‚¹ä¸»è¦æ˜¯ä»¥ä»€ä¹ˆä¸ºä¸­å¿ƒè¿›è¡Œåœºæ™¯å‘¨å›´ä¿¡æ¯çš„è·å–ï¼Œæ­£å¦‚å‰é¢ç›¸å…³å·¥ä½œä¸­æåˆ°çš„ï¼Œæ­¤å¤„ä»¥åœºæ™¯ä¸ºä¸­å¿ƒ ä¹Ÿå°±æ˜¯ä½¿ç”¨ an agent of interestâ€™s position ä½œä¸ºåŸç‚¹ï¼Œå¯¹æ‰€æœ‰çš„road graphå’Œagentsè¿›è¡Œç¼–ç ï¼›ä»¥agentä¸ºä¸­å¿ƒçš„è¯ï¼Œå°±æ˜¯å¯¹æ¯ä¸ªagentåˆ†åˆ«è¿›è¡Œä»¥å…¶ä¸ºåŸç‚¹çš„è®¡ç®—

æ­¤æ­¥ä¸­ç»†èŠ‚æ­¥éª¤ä¸ºï¼š

1.  ä¸ºæ¯ä¸ªagentç”Ÿæˆ time stepå†…çš„featureï¼Œif time step is visible
2.  ä½¿ç”¨ PointNet ä¸ºstatic road graphå’Œå…¶ä½™çš„å…ƒç´  learning **one feature vecctor** per polylineï¼Œå…¶ä¸­äº¤é€šæ ‡å¿— signä¸ºé•¿åº¦ä¸º1çš„polylines
3.  ä¸ºdynamics road graph æ¯”å¦‚åœ¨ç©ºé—´ä¸Šæ˜¯é™æ­¢çš„åœ¨æ—¶é—´ä¸Šæ˜¯å˜æ¢çš„çº¢ç»¿ç¯ï¼Œç”Ÿæˆä¸º one feature vector per object

æ‰€æœ‰çš„ä»¥ä¸Šç±»åˆ«éƒ½å…·æœ‰xyzä½ç½®ä¿¡æ¯ï¼Œä»¥å…¶é€‰å®šå¥½çš„agentä½œä¸ºå±…ä¸­ï¼Œå¯¹å‰©ä½™ç±»åˆ«è¿›è¡Œå±…ä¸­ æ—‹è½¬ç­‰å¤„ç†ï¼Œå†ä½¿ç”¨sinusoidal position embeddings

### B. Encoding Ttansformer

å’ŒåŸºæœ¬çš„attentionå¹¶æ— å¤ªå¤§åŒºåˆ«ï¼Œquery, key, valueä¸ºéœ€è¦å­¦ä¹ çš„çº¿æ€§å±‚ï¼Œæ¯ä¸ªéƒ½ä¹˜ä¸€ä¸‹è¾“å…¥ xï¼Œæ¯”å¦‚ï¼š\\(Q=W\_qx\\)ï¼Œå¦‚ä¸Šå›¾çš„encoderå’Œdecoderæ¡†å›¾ï¼Œå…¶ä¸­decoderæœ€åæ¥äº†ä¸¤å±‚MLPç„¶å predict 7 outputsï¼Œå…¶ä¸­å‰å…­ä¸ªå¯¹åº”çš„æ˜¯ï¼šä¸‰ä¸ªæ˜¯åœ¨ç»™å®šæ—¶é—´ä¸‹çš„agentçš„ä¸‰ç»´ä¸the agent of interestä¹‹é—´çš„ç»å¯¹åæ ‡ï¼Œand ä¸‰ä¸ªæ˜¯ä¸ç¡®å®šæ€§ éµå¾ªLaplace åˆ†å¸ƒçš„å‚æ•°ã€‚åä¸€ä¸ªæ˜¯heading

ä¸ºäº†å¯»æ±‚æ›´é«˜æ•ˆçš„self-attentionï¼Œä»…åœ¨æ—¶é—´å±‚ä¸Šä½¿æ¨¡å‹ç‹¬ç«‹äºagentè¿›è¡Œå¹³æ»‘è½¨è¿¹çš„å­¦ä¹ ï¼ŒåŒæ ·çš„ä»…åœ¨agentå±‚ä¸Šä½¿æ¨¡å‹ç‹¬ç«‹äºtimeè¿›è¡Œinteractionçš„ä¹‹é—´çš„å­¦ä¹ ï¼Œç±»ä¼¼äºè§£è€¦ï¼Œå¦‚ä¸Šå›¾decoderéƒ¨åˆ†ä¸‹é¢ï¼Œäº¤æ›¿è¿›è¡Œä¸¤æ¬¡

ä¸road graphä¹‹é—´æ˜¯cross attention

### C. Predicting Probabilities for each Futures

é¢„æµ‹çš„æ˜¯æ¦‚ç‡åˆ†æ•°ï¼Œä¸è®ºæ˜¯jointé‡Œçš„æ¯ä¸ªæœªæ¥çš„æƒ…å†µæ‰“åˆ†è¿˜æ˜¯marginal modelé‡Œå¯¹è½¨è¿¹çš„æ‰“åˆ†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªfeature representationå»æ€»ç»“ sceneå’Œeach agent.

æ ¹æ®agentå’Œtimeä¸‹ å¯¹agent feature tensorè¿›è¡Œåˆ†åˆ«æ±‚å’Œï¼Œç„¶ååŠ åˆ°additional artificial agent and timeï¼Œæ‰€ä»¥internal representationå°±ä¼šå˜æˆ \\(\[A+1,T+1,D\]\\)

ç„¶åä½œä¸ºdecoderçš„è¾“å…¥ï¼Œç»è¿‡ä¸¤å±‚ MLP+softmax å¾—åˆ°ç­‰ä»·çš„probabilities for each features

### D. Joint and Marginal Loss Formulation

é¦–å…ˆå¯¹äºæ‰€æœ‰çš„agentéƒ½æœ‰ä¸€ä¸ªdisplacement loss and time step to build a loss tensor of shape \\(\[F\]\\)ï¼Œä½†æ˜¯æˆ‘ä»¬ä»…å°†æœ€æ¥è¿‘äºçœŸå€¼çš„è¿›è¡Œback-propagateåå‘ä¼ æ’­ï¼›å¯¹äºmarginalçš„é¢„æµ‹å‘¢ åˆ™æ˜¯æ¯ä¸ªagentéƒ½æ˜¯å•ç‹¬çš„å¯¹å¾…ï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°äº†displacement lossæ˜¯ \\(\[F,A\]\\)ï¼Œä½†æ˜¯å¹¶ä¸aggregate across agentsè€Œæ˜¯ä¸ºæ¯ä¸ªagenté€‰å–æœ€å°çš„lossç„¶ååå‘

* * *

é—®é¢˜åŒºï¼š

*    encodeå’Œdecodeéƒ½æ˜¯ä¸€ä¸ªattention-based network... é‚£
    
    æœ‰æ¡†å›¾è§£é‡Šäº†ä¸¤è€…çš„è®¾è®¡æ–¹å¼
    
*    è¿™é‡Œçš„é¢„è®¡motion æ˜¯æ ¹æ®è§„åˆ’å¾—åˆ°çš„å—ï¼Ÿè§„åˆ’æ˜¯deterministicçš„å—ï¼Ÿè¿˜æ˜¯ç›´æ¥é’ˆå¯¹çš„æ˜¯æ•°æ®é›†
    
    åº”è¯¥æ˜¯æ•°æ®é›†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è·å–æœªæ¥æ•°æ®é›†å†…çš„motionè¿›è¡Œæ­¤ä»»åŠ¡
    
*    an agent of interestâ€™s position æ˜¯æ„Ÿå…´è¶£çš„agentçš„ä½ç½®å§... ä¸ºå•¥å†™çš„è¿™ä¹ˆç»•.. select an interest agentâ€™s positionä¸å¥½å—...
    
    *    é€‰æ‹©æŒ‡æ ‡æ˜¯ï¼Ÿ
        
        è„šæ³¨å’Œopen reivewä¸­ä¹Ÿæœ‰å®¡ç¨¿äººé—®äº† hhhï¼Œè„šæ³¨è¯´æ˜äº† å¯¹äºwaymoæ˜¯ è‡ªèº«è½¦è¾†ï¼Œå¯¹äºArgoverseæ˜¯éœ€è¦é¢„æµ‹çš„è½¦è¾†
        
*    è¿™é‡Œçš„[æ‰€æœ‰æ˜¯æŒ‡ï¼Ÿ](https://www.notion.so/ICLR-2022-Scene-Transformer-A-unified-architecture-for-predicting-future-trajectories-of-multiple--37a700f54efb4e4f87eee9f682c6a0d5) è¿™é‡Œçš„\[æ‰€æœ‰æ˜¯æŒ‡ï¼Ÿ\](https://www.notion.so/ICLR-2022-Scene-Transformer-A-unified-architecture-for-predicting-future-trajectories-of-multiple--37a700f54efb4e4f87eee9f682c6a0d5)æ‰€æœ‰ï¼Ÿæ•´å¼ åœ°å›¾çš„é“è·¯ç»“æ„ï¼Ÿè¿˜æ˜¯é€‰å–äº†ä»¥é€‰æ‹©å®šçš„agent ç”»äº†æ¡†ï¼Ÿ
    

3\. å®éªŒ
======

æŒ‡æ ‡ä¸ºé¢„æµ‹ä¸­åœºæ™¯çš„minADE, minFDE, miss rateå’ŒmAPï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨æ¥æµ‹é‡ how close the top k trajectories are to ground truth observationï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹çš„è½¨è¿¹ç¦»çœŸå€¼æœ‰å¤šè¿‘

*   L2: A simple and common distance-based metric is to measure the L2 norm between a given trajectory and the ground truth
*   minADE: reports the L2 norm of the trajectory **with the minimal distance**
*   minFDE: reports the L2 norm of the trajectory with the smallest distance only evaluated at the **final location of the trajectory**.

æœ¬æ–‡æ‰€æœ‰çš„æ˜¯MR, mAPï¼Œå¯¹äºjoint futureåˆ™æ˜¯scene-levelä¸‹çš„minSADE, minSFDE, SMR

*   miss rate (MR) and mean average precision (mAP) to capture how well a model predicts all of the future trajectories of agents probabilistically

ä¸»è¦å°±è´´ä¸€ä¸‹å®éªŒè¡¨æ ¼ç­‰

![](https://img-blog.csdnimg.cn/1d334c782e9e45158ec91da1785c5fe0.png)

![](https://img-blog.csdnimg.cn/9ee93751ea384bfb8ae7768df3cddd45.png)

åœºæ™¯åˆ†æå›¾ï¼š

![](https://img-blog.csdnimg.cn/6948959b9b3242e98a7aadcb761cfa4d.png)

æŒ‡æ˜ä¸åŒçš„ç›®æ ‡ç‚¹ï¼Œé¢„æµ‹ä¹Ÿä¼šéšä¹‹å˜æ¢ï¼Œå“åº”å‰æ–‡æå‡ºçš„switch task GCP

4\. Conclusion
==============

![](https://img-blog.csdnimg.cn/9001ee98c69542399e9d0983c4e4f755.png)

ç¢ç¢å¿µ
===

æ­£å¦‚CJå“¥æ‰€è¨€ï¼šwaymoå¿…ç„¶ä¸å¼€æºï¼›ä½†æ˜¯å§ æ¯ä¸ªè®ºæ–‡çš„é™„å½•éƒ½ç‰¹åˆ«ä»”ç»†åˆ° è®©æˆ‘è¿™ç§å°ç™½èœè§‰å¾— å“‡ emm ä¼¼ä¹å¯ä»¥å¤ç°å‘¢ï¼Œä½†æ˜¯è¿™ç¯‡å¯èƒ½æ²¡ç»†çœ‹é™„å½•çš„åŸå›  æœ‰å¥½å‡ ä¸ªåœ°æ–¹è¿˜æ˜¯æœ‰ç‚¹å­˜ç–‘çš„ï¼Œhhhhã€‚æ‰€ä»¥ä¸»è¦é‡ç‚¹çœ‹çœ‹ä»–ä»¬çš„æ¡†æ¶æ˜¯æ€ä¹ˆæ­çš„ æ›´ä¸ºé‡è¦ï¼Œwaymoä¸‰ç¯‡åŸºæœ¬éƒ½æ˜¯è‡ªå·±è®¾è®¡çš„ç½‘ç»œä¸èµ°resnetæˆ–è€…regnet æœ‰é¢„è®­ç»ƒçš„å‚æ•°ã€‚æ›´å¤šç»†èŠ‚ è¦æ˜¯æ„Ÿå…´è¶£çš„è¯ å»ºè®®è¯»ä¸€ä¸‹åŸæ–‡çš„é™„å½•éƒ¨åˆ†ï¼Œç½‘ç»œå‚æ•°ç­‰éƒ½ä»‹ç»çš„è¾ƒä¸ºè¯¦ç»†

è¿™ä¸€ç¯‡è™½ä¸åŠMP3æƒŠè‰³ï¼Œä½†ä¼¼ä¹å¥ å®šäº†åº”è¯¥ç”¨vectorçš„å½¢å¼å»åšé¢„æµ‹ ç±»ä¼¼äºCJå“¥åœ¨multipath++ç¬”è®°ä¸­æåˆ°ï¼Œvectornetæœ‰ä¸€ç»Ÿçš„è¶‹åŠ¿ã€‚å…¶å®pointnetä¹‹ç±»çš„åœ¨17å¹´çš„å°±æå‡ºäº† è¿›æ¥ä»¥pointnet â†’ vectornet â†’ å†åˆ°ç°åœ¨çš„ä¸€ç³»åˆ—åŸºæœ¬éƒ½æ˜¯attentionä¸‹çš„å„ç§ç©æ³•

open reviewå€¼å¾—ä¸€çœ‹ è¿˜æ˜¯è¿™ç§å¼€æ”¾å®¡ç¨¿çš„æœ‰æ„æ€å•Šï¼Œå› ä¸ºæœ‰å®¡ç¨¿äººå¯¹GCPçš„ç»“æœè¯´æ˜äº§ç”Ÿäº†é—®é¢˜ï¼Œç±»ä¼¼äºå»ºè®®ä½œè€…åœ¨CARLAåš å°±æ˜¯ä»¥ç›®æ ‡ç‚¹çš„condition predictionå…¶å®å·²ç»å¾ˆåƒplanningäº†ï¼ŒåŸºæœ¬å°±æ˜¯ åŠ ä¸€ä¸‹æ§åˆ¶å™¨ï¼Œç„¶åä½œè€…è°¢è°¢æé†’ï¼Œæˆ‘çŸ¥é“ï¼ˆå†…å¿ƒOS:ä½†æ˜¯æˆ‘ä¸åšhhhhï¼‰

å¦å¤–è´´ä¸€ä¸‹ æˆ‘åœ¨å‰é¢è¯´çš„ [online leaderboard](https://waymo.com/open/challenges/2021/motion-prediction/) ä¸‹ ç¡®å®æ’åä¸é«˜ï¼Œä¸è¿‡æŒ‰æäº¤æ—¶é—´çš„è¯ å°±å¦è¯´äº†

![](https://img-blog.csdnimg.cn/457523dc33e748fd867a93340b18b157.png)

* * *

èµ äººç‚¹èµ æ‰‹æœ‰ä½™é¦™ ğŸ˜†ï¼›æ­£å‘å›é¦ˆ æ‰èƒ½æ›´å¥½å¼€æ”¾è®°å½• hhh