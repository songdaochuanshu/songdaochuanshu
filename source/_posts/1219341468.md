---
layout: post
title: "æœ€æ–°æ¼æ´ï¼šSpring Frameworkè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"
date: "2022-03-31T18:22:07.155Z"
---
æœ€æ–°æ¼æ´ï¼šSpring Frameworkè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´
=============================

Spring Frameworkè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´

*   å‘å¸ƒæ—¶é—´ 2022-03-31
    
*   æ¼æ´ç­‰çº§ **High**
    
*   CVEç¼–å· CVE-2022-22965
    
*   å½±å“èŒƒå›´ï¼šåŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶å¯ç¡®å®šå—æ­¤æ¼æ´å½±å“ï¼š
    
    > JDK ç‰ˆæœ¬ >= 9
    > 
    > ä½¿ç”¨äº† Spring æ¡†æ¶æˆ–è¡ç”Ÿæ¡†æ¶
    > 
    > é¡¹ç›®ä¸­ Controller å‚æ•°æ¥æ”¶å®ä½“ç±»å¯¹è±¡å¹¶å­˜åœ¨ä»£ç è°ƒç”¨
    

1.æ¼æ´æè¿°
------

Spring Framework æ˜¯ä¸€ä¸ªå¼€æºåº”ç”¨æ¡†æ¶ï¼Œæ—¨åœ¨é™ä½åº”ç”¨ç¨‹åºå¼€å‘çš„å¤æ‚åº¦ã€‚å®ƒæ˜¯è½»é‡çº§ã€æ¾æ•£è€¦åˆçš„ã€‚å®ƒå…·æœ‰åˆ†å±‚ä½“ç³»ç»“æ„ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ç»„ä»¶ï¼ŒåŒæ—¶è¿˜ä¸º J2EE åº”ç”¨ç¨‹åºå¼€å‘æä¾›äº†ä¸€ä¸ªæœ‰å‡èšåŠ›çš„æ¡†æ¶ã€‚ä½†æ˜¯åœ¨**JDK9åŠä»¥ä¸Šç‰ˆæœ¬ç¯å¢ƒä¸­ï¼Œä¸€äº›æ–°çš„ç‰ˆæœ¬ç‰¹æ€§ï¼Œå¯ä»¥ä½¿æ”»å‡»è€…ç»•è¿‡ä¸€äº›å®‰å…¨ç‰¹æ€§ï¼Œå€ŸåŠ©æŸäº›ä¸­é—´ä»¶æ„é€ æ•°æ®åŒ…ä¿®æ”¹æ•æ„Ÿæ–‡ä»¶ï¼Œè¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œç›®çš„**ã€‚

2.æ¼æ´å½±å“æ’æŸ¥æ–¹æ³•
----------

### 2.1.JDK ç‰ˆæœ¬å·æ’æŸ¥

åœ¨ä¸šåŠ¡ç³»ç»Ÿçš„è¿è¡ŒæœåŠ¡å™¨ä¸Šï¼Œæ‰§è¡Œâ€œjava -version"å‘½ä»¤æŸ¥çœ‹è¿è¡Œçš„ JDK ç‰ˆæœ¬ã€‚

å¦‚æœç‰ˆæœ¬å·å°äºç­‰äº 8ï¼Œåˆ™ä¸å—æ­¤æ¼æ´å½±å“ã€‚

ï¼ˆä¸å—å½±å“çš„ç‰ˆæœ¬ï¼‰ğŸ‘‡

![image](https://img2022.cnblogs.com/blog/1209017/202203/1209017-20220331223750427-450845924.png)

### 2.2.Spring æ¡†æ¶ä½¿ç”¨æƒ…å†µæ’æŸ»

å¦‚æœä¸šåŠ¡ç³»ç»Ÿé¡¹ç›®ä»¥ war(jar) åŒ…å½¢å¼éƒ¨ç½²ï¼ŒæŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤è¿›è¡Œåˆ¤æ–­ï¼š

1.  è§£å‹ war(jar) åŒ…ï¼šå°†war(jar)æ–‡ä»¶çš„åç¼€ä¿®æ”¹æˆ .zip ï¼Œè§£å‹ zip æ–‡ä»¶ã€‚
    
2.  åœ¨è§£å‹ç¼©ç›®å½•ä¸‹æœç´¢æ˜¯å¦å­˜åœ¨ spring-beans-\*.jar æ ¼å¼çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚spring-beans-5.3.16.jarï¼‰ï¼Œå¦‚å­˜åœ¨åˆ™è¯´æ˜ä¸šåŠ¡ç³»ç»Ÿä½¿ç”¨äº†Springæ¡†æ¶è¿›è¡Œå¼€å‘ã€‚
    
3.  å¦‚æœspring-beans-\*.jaræ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åœ¨è§£å‹ç¼©ç›®å½•ä¸‹æœç´¢CachedlntrospectionResults.classæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚å­˜åœ¨åˆ™è¯´æ˜ä¸šåŠ¡ç³»ç»Ÿä½¿ç”¨äº†Springæ¡†æ¶è¿›è¡Œå¼€å‘ã€‚
    

3.è§£å†³æ–¹æ¡ˆ
------

### 3.1.ç‰ˆæœ¬å‡çº§

ç›®å‰ï¼ŒSpringå®˜æ–¹å·²å‘å¸ƒæ¼æ´ä¿®å¤ç‰ˆæœ¬ï¼Œè¯·ç”¨æˆ·åŠæ—¶æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ï¼š

https://github.com/spring-projects/spring-framework/tags

å®‰å…¨ç‰ˆæœ¬ï¼š

> Spring Framework == 5.3.18
> 
> Spring Framework == 5.2.20

### 3.2.ç¼“è§£æªæ–½

æ— æ³•å‡çº§ç‰ˆæœ¬çš„ç”¨æˆ·ï¼Œå»ºè®®é‡‡ç”¨ä»¥ä¸‹ä¸¤ä¸ªä¸´æ—¶æ–¹æ¡ˆè¿›è¡Œé˜²æŠ¤ã€‚

**UWAF é˜²æŠ¤**

åœ¨UWAFé…ç½®ä¸­ï¼Œæ ¹æ®å®é™…ä¸šåŠ¡éƒ¨ç½²çš„æƒ…å†µï¼Œé…ç½®æ­£åˆ™è§„åˆ™ï¼Œå¯¹ "class.module.\*" å­—ç¬¦ä¸²æ·»åŠ è¿‡æ»¤è§„åˆ™ï¼Œåœ¨éƒ¨ç½²è¿‡æ»¤è§„åˆ™åï¼Œå¯¹ä¸šåŠ¡è¿è¡Œæƒ…å†µè¿›è¡Œæµ‹è¯•ï¼Œé¿å…äº§ç”Ÿé¢å¤–å½±å“ã€‚

æ³¨æ„ï¼šå…¶ä¸­æµé‡ç‰¹å¾ "class.module.\*" å¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚

**ä¸´æ—¶ä¿®å¤æªæ–½**

éœ€åŒæ—¶æŒ‰ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤è¿›è¡Œæ¼æ´çš„ä¸´æ—¶ä¿®å¤ï¼š

1.  åœ¨åº”ç”¨ä¸­å…¨å±€æœç´¢****@InitBinder æ³¨è§£ï¼Œçœ‹æ–¹æ³•ä½“å†…æ˜¯å¦è°ƒç”¨****dataBinder.setDisallowedFieldsæ–¹æ³•ã€‚å¦‚æœå‘ç°æ­¤ä»£ç ç‰‡æ®µçš„å¼•å…¥ï¼Œåˆ™åœ¨åŸæ¥çš„é»‘åå•ä¸­æ·»åŠ  { " class.module.\*"}ã€‚æ³¨æ„ï¼šå¦‚æœæ­¤ä»£ç ç‰‡æ®µä½¿ç”¨è¾ƒå¤šï¼Œéœ€è¦æ¯ä¸ªåœ°æ–¹éƒ½è¿½åŠ ã€‚
    
2.  åœ¨åº”ç”¨ç³»ç»Ÿçš„é¡¹ç›®åŒ…ä¸‹æ–°å»ºä»¥ä¸‹å…¨å±€ç±»ï¼Œå¹¶ä¿è¯è¿™ä¸ªç±»è¢«SpringåŠ è½½åˆ°ï¼ˆæ¨èåœ¨ Controlleræ‰€åœ¨çš„åŒ…ä¸­æ·»åŠ ï¼‰ã€‚å®Œæˆç±»æ·»åŠ åï¼Œéœ€å¯¹é¡¹ç›®è¿›è¡Œé‡æ–°ç¼–è¯‘æ‰“åŒ…å’ŒåŠŸèƒ½éªŒè¯æµ‹è¯•ï¼Œå¹¶é‡æ–°å‘å¸ƒé¡¹ç›®ã€‚
    

    import org.springframework.core.annotation.Order;
    import org.springframework.web.bind.WebDataBinder;
    import org.springframework.web.bind.annotation.ControllerAdvice;
    import org.springframework.web.bind.annotation.InitBinder;
    
    @ControllerAdvice@Order(10000)
    public class GlobalControllerAdvice{
    
       @InitBinder
       public void setAllowedFields(webdataBinder dataBinder){
       String[]abd=new string[]{"class.*","Class.*","*.class.*","*.Class.*"};
       dataBinder.setDisallowedFields(abd);
       }
    
    }
    

![image](https://img2022.cnblogs.com/blog/1209017/202203/1209017-20220331223554129-1680099955.gif)

[Javaå¾€æœŸæ–‡ç« ](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5NDM5NDM1NA==&action=getalbum&album_id=2209403024081485826#wechat_redirect)

[Javaå…¨æ ˆå­¦ä¹ è·¯çº¿ã€å­¦ä¹ èµ„æºå’Œé¢è¯•é¢˜ä¸€æ¡é¾™](http://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&mid=2247485015&idx=1&sn=862bc2b379726b89cdb396ec0d325cc0&chksm=ec62c6cadb154fdc533111a253d72001534ab92de317cbde5c1c9f575548500bc734c3028484&scene=21#wechat_redirect)

[æˆ‘å¿ƒé‡Œä¼˜ç§€æ¶æ„å¸ˆæ˜¯æ€æ ·çš„ï¼Ÿ](http://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&mid=2247484980&idx=1&sn=cae79359673b411222f6108e8104e37a&chksm=ec62c6a9db154fbf1a7660547631dbc1ea3c764e1ccf30d223dab897dd7397aa730f3db56bf4&scene=21#wechat_redirect)

[å…è´¹ä¸‹è½½ç»å…¸ç¼–ç¨‹ä¹¦ç±](http://mp.weixin.qq.com/s?__biz=MzI5NDM5NDM1NA==&mid=2247485128&idx=1&sn=7ede1feed6c28f3b598095fe2e076a8b&chksm=ec62c655db154f43baea9eb87c9f1b8993adee277eb9e499036795411f788c75f87f8d8b6070&scene=21#wechat_redirect)

![image](https://img2022.cnblogs.com/blog/1209017/202203/1209017-20220331223627102-110548417.jpg)