---
layout: post
title: "【Java面试】介绍下Spring IoC的工作流程"
date: "2022-06-20T20:20:55.299Z"
---
【Java面试】介绍下Spring IoC的工作流程
==========================

> Hi，我是Mic
> 
> 一个工作了4年的粉丝，在面试的时候遇到一个这样的问题。
> 
> “介绍一下Spring IOC的工作流程”
> 
> 他说回答得不是很好，希望我能帮他梳理一下。
> 
> 关于这个问题，我们来看看普通人和高手的回答。

普通人：
----

嗯。。。。。。。。

高手：
---

好的，这个问题我会从几个方面来回答。

*   IOC是什么
*   Bean的声明方式
*   IOC的工作流程

IOC的全称是Inversion Of Control, 也就是控制反转，它的核心思想是把对象的管理权限交给容器。

应用程序如果需要使用到某个对象实例，直接从IOC容器中去获取就行，这样设计的好处是降低了程序里面对象与对象之间的耦合性。

使得程序的整个体系结构变得更加灵活。

![image-20220510095942810](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162056575-1450545482.png)

![image-20220510100014497](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162057009-1732688264.png)

Spring里面很多方式去定义Bean，比如XML里面的标签、@Service、@Component、@Repository、@Configuration配置类中的@Bean注解等等。

Spring在启动的时候，会去解析这些Bean然后保存到IOC容器里面。

![image-20220510101204396](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162057455-777575183.png)

Spring IOC的工作流程大致可以分为两个阶段。

**第一个阶段，就是IOC容器的初始化**

这个阶段主要是根据程序中定义的XML或者注解等Bean的声明方式

通过解析和加载后生成BeanDefinition，然后把BeanDefinition注册到IOC容器。

![image-20220510121115810](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162057865-874731546.png)

通过注解或者xml声明的bean都会解析得到一个BeanDefinition实体，实体中包含这个bean中定义的基本属性。

最后把这个BeanDefinition保存到一个Map集合里面，从而完成了IOC的初始化。

IoC容器的作用就是对这些注册的Bean的定义信息进行处理和维护，它IoC容器控制反转的核心。

**第二个阶段，完成Bean初始化及依赖注入**

然后进入到第二个阶段，这个阶段会做两个事情

1.  通过反射针对没有设置lazy-init属性的单例bean进行初始化。
2.  完成Bean的依赖注入。

![image-20220510115646893](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162058184-822098276.png)

**第三个阶段，Bean的使用**

通常我们会通过@Autowired或者BeanFactory.getBean()从IOC容器中获取指定的bean实例。

另外，针对设置layy-init属性以及非单例bean的实例化，是在每次获取bean对象的时候，调用bean的初始化方法来完成实例化的，并且Spring IOC容器不会去管理这些Bean。

![image-20220511103240376](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162058452-1528559543.png)

以上就是我对这个问题的理解。

总结
--

对于工作原理或者工作流程性的问题，大家一定要注意回答的结构和节奏。

否则面试官会觉得很混乱，无法理解，导致面试的效果大打折扣。

高手的回答逻辑非常清晰，大家可以参考。

喜欢我的作品的小伙伴记得点赞和收藏加关注。

![file](http://mic-blob-bucket.oss-cn-beijing.aliyuncs.com/27872_BCA4A110845B4BD4B98AC9E262995386)

> 版权声明：本博客所有文章除特别声明外，均采用 CC BY-NC-SA 4.0 许可协议。转载请注明来自 `Mic带你学架构`！  
> 如果本篇文章对您有帮助，还请帮忙点个关注和赞，您的坚持是我不断创作的动力。欢迎关注「跟着Mic学架构」公众号公众号获取更多技术干货！

![](https://img2022.cnblogs.com/other/1666682/202206/1666682-20220620162059017-431253625.png)