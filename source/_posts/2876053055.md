---
layout: post
title: "Multipassï¼Œå¤šå¹³å°æœ¬åœ°è½»é‡çº§Linuxä½“éªŒï¼"
date: "2022-11-26T14:14:29.606Z"
---
Multipassï¼Œå¤šå¹³å°æœ¬åœ°è½»é‡çº§Linuxä½“éªŒï¼
==========================

![Multipassï¼Œå¤šå¹³å°æœ¬åœ°è½»é‡çº§Linuxä½“éªŒï¼](https://img2022.cnblogs.com/blog/2056368/202211/2056368-20221126182948752-1842684253.png) Multipass æ˜¯ç”±Ubuntuå®˜æ–¹æä¾›ï¼Œåœ¨Linuxï¼ŒMacOSå’ŒWindowsä¸Šå¿«é€Ÿç”ŸæˆUbuntuè™šæ‹Ÿæœºçš„å·¥å…·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„CLIï¼Œå¯è®©æˆ‘ä»¬åœ¨æœ¬åœ°å¿«é€Ÿè¿›å…¥Ubuntuç³»ç»Ÿç¯å¢ƒå¹¶ä½¿ç”¨Linuxå‘½ä»¤ï¼Œäº¦å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºåˆ›å»ºè‡ªå·±çš„è¿·ä½ å‹äº‘æœåŠ¡å™¨ã€‚æ€»çš„æ¥è¯´å°±æ˜¯åœ¨æœ¬åœ°åˆ›å»ºUbuntuè™šæ‹Ÿæœºï¼Œå¯ä»¥è·å¾—äº‘ç«¯UbuntuæœåŠ¡å™¨èˆ¬çš„ä½“éªŒã€‚

Multipassä»‹ç» ğŸ†
==============

Multipass æ˜¯ç”±Ubuntuå®˜æ–¹æä¾›ï¼Œåœ¨Linuxï¼ŒMacOSå’ŒWindowsä¸Šå¿«é€Ÿç”Ÿæˆ **_Ubuntuè™šæ‹Ÿæœº_** çš„å·¥å…·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„CLIï¼Œå¯è®©æˆ‘ä»¬åœ¨æœ¬åœ°å¿«é€Ÿè¿›å…¥Ubuntuç³»ç»Ÿç¯å¢ƒå¹¶ä½¿ç”¨Linuxå‘½ä»¤ï¼Œäº¦å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºåˆ›å»ºè‡ªå·±çš„è¿·ä½ å‹äº‘æœåŠ¡å™¨ã€‚æ€»çš„æ¥è¯´å°±æ˜¯åœ¨æœ¬åœ°åˆ›å»ºUbuntuè™šæ‹Ÿæœºï¼Œå¯ä»¥è·å¾—äº‘ç«¯UbuntuæœåŠ¡å™¨èˆ¬çš„ä½“éªŒã€‚

> Multipassåœ¨Windowsä¸Šä½¿ç”¨Hyper-Vï¼Œåœ¨MacOSä¸Šä½¿ç”¨Hyperkitï¼Œåœ¨Linuxä¸Šä½¿ç”¨LXDï¼Œä»¥è¾¾åˆ°ç”¨æœ€å°çš„å¼€é”€å’Œæœ€å¿«çš„å¯åŠ¨æ—¶é—´æ¥è¿›è¡Œè™šæ‹Ÿæœºçš„åˆ›å»ºï¼Œè¿›è€Œåœ¨ä¸åŒå¹³å°æä¾›ç»Ÿä¸€çš„ Linux å¼€å‘ç¯å¢ƒä½“éªŒã€‚

Multipass æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢æ¥å¯åŠ¨å’Œç®¡ç† Linux å®ä¾‹ï¼Œæ ¹æ®é•œåƒåˆ›å»ºå®ä¾‹ï¼Œåœ¨æœ¬åœ°å·²æœ‰å®ä¾‹çš„æƒ…å†µä¸‹ï¼Œå®ä¾‹çš„å¯åŠ¨ä»…éœ€è¦æ•°åç§’çš„æ—¶é—´ã€‚

> æ— è®ºæ˜¯Windowsï¼Œè¿˜æ˜¯MacOSã€Linuxï¼Œéƒ½å¯ä»¥åœ¨æœ¬åœ°é€šè¿‡Multipassåˆ›å»ºä¸€ä¸ªç±»æœåŠ¡å™¨èˆ¬ä½“éªŒçš„Linuxç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Ubuntuå®ä¾‹ç³»ç»Ÿä¸­å®‰è£…nginxã€redisã€kafkaã€k8sç­‰è½¯ä»¶ï¼Œè¿›è€Œåœ¨æœ¬åœ°ä½“éªŒã€å­¦ä¹ ã€å¼€å‘ã€éªŒè¯LinuxæœåŠ¡å™¨çš„ç›¸å…³å†…å®¹ã€‚  
> Multipasså®˜ç½‘ï¼š[https://multipass.run/](https://multipass.run/)

  

ä½¿ç”¨æŒ‡å— ğŸ§­
=======

ä»¥ä¸‹å†…å®¹åœ¨ä¸¤å°Macä¸Šå®è·µï¼Œå„ä¾‹ä¸­çš„VMå®ä¾‹å‚æ•°ç•¥æœ‰ä¸åŒã€‚

### å®‰è£…&å¸è½½multipass

    # å®‰è£…
    $ brew install --cask multipass
    
    # å¸è½½
    $ brew uninstall multipass
    
    # å¸è½½å¹¶åˆ é™¤æ•°æ®
    $ brew uninstall --zap multipass
    

  

### æŸ¥çœ‹multipassç‰ˆæœ¬

    (base) âœ  ~ multipass version
    multipass   1.10.1+mac
    multipassd  1.10.1+mac
    

  

### æŸ¥æ‰¾å¯ç”¨é•œåƒ

    (base) âœ  ~ multipass find   
    Image                       Aliases           Version          Description
    snapcraft:core18            18.04             20201111         Snapcraft builder for Core 18
    snapcraft:core20            20.04             20210921         Snapcraft builder for Core 20
    snapcraft:core22            22.04             20220426         Snapcraft builder for Core 22
    18.04                       bionic            20221014         Ubuntu 18.04 LTS
    ... ... ...
    

  

### åˆ›å»ºå®ä¾‹

âš ï¸ å¯ä»¥æŒ‡å®šé•œåƒåˆ«å å’Œ å®ä¾‹åˆ«å

æ ¹æ®ä¸Šä¸€æ­¥`multipass find`çš„ç»“æœï¼Œæˆ‘ä»¬ä½¿ç”¨18.04ç‰ˆæœ¬çš„é•œåƒï¼Œå…¶åˆ«åä¸ºbionicï¼Œåˆ›å»ºåçš„å®ä¾‹æˆ‘ä»¬å‘½åä¸º`d1804`

    (base) âœ  ~ multipass launch bionic --name d1804
    Launched: d1804  
    

ä¸æŒ‡å®šé•œåƒä¼šéšæœºé€‰æ‹©é•œåƒåˆ›å»ºã€‚åŒæ ·ï¼Œä¸æŒ‡å®šå®ä¾‹åˆ«åä¹Ÿä¼šéšæœºå‘½åã€‚

å®ä¾‹åˆ›å»ºåé»˜è®¤å¯åŠ¨ï¼Œå³runningçŠ¶æ€ã€‚

åˆ›å»ºå®ä¾‹æ—¶å¯ä»¥é™„åŠ çš„å‚æ•°å¦‚ä¸‹ï¼š

    (base) âœ  ~ multipass launch bionic --name d1804 --cpus 4 --disk 20G --mem 8G
    

*   \-n, --nameï¼šåç§°
*   \-c, --cpusï¼šcpuæ ¸å¿ƒæ•°, é»˜è®¤: 1
*   \-m, --memï¼šå†…å­˜å¤§å°, é»˜è®¤: 1G
*   \-d, --disk:ï¼šç¡¬ç›˜å¤§å°, é»˜è®¤: 5G  
      
    

### æŸ¥çœ‹å®ä¾‹åˆ—è¡¨

    (base) âœ  ~ multipass list                      
    Name                    State             IPv4             Image
    d1804                   Running           192.168.64.3     Ubuntu 18.04 LTS
    

åˆ—è¡¨ä¸­ä¼šå±•ç¤ºå„å®ä¾‹çš„æœ¬åœ°å±€åŸŸç½‘IPåœ°å€ï¼Œå¯ä»¥æŠŠè¯¥åœ°å€å½“ä½œè¿œç¨‹æœåŠ¡å™¨çš„åœ°å€ï¼Œè¿›è€Œå®ç°æœ¬åœ°VMå®ä¾‹æ¨¡æ‹Ÿè¿œç¨‹æœåŠ¡å™¨çš„ç»“æœï¼ŒåŒæ—¶å¯ä»¥åœ¨VMå®ä¾‹ä¸­å®‰è£…MySQLã€Redisç­‰è½¯ä»¶ï¼Œå½“ä½œæœ¬åœ°å¼€å‘çš„äº‘ç«¯æœåŠ¡ã€‚  
  

### æŸ¥çœ‹å…·ä½“å®ä¾‹ä¿¡æ¯

    (base) âœ  ~ multipass info d1804
    Name:           d1804
    State:          Running
    IPv4:           192.168.64.3
    Release:        Ubuntu 18.04.6 LTS
    Image hash:     5269cad5bc26 (Ubuntu 18.04 LTS)
    Load:           0.00 0.06 0.06
    Disk usage:     1.1G out of 4.7G
    Memory usage:   73.5M out of 985.6M
    Mounts:         --
    

  

### å…³é—­&å¯åŠ¨å®ä¾‹

å…³é—­

    (base) âœ  ~ multipass stop d1804 
    (base) âœ  ~ multipass list      
    Name                    State             IPv4             Image
    d1804                   Stopped           --               Ubuntu 18.04 LTS
    

å¯åŠ¨

    (base) âœ  ~ multipass start d1804  
    (base) âœ  ~ multipass list       
    Name                    State             IPv4             Image
    d1804                   Running           192.168.64.3     Ubuntu 18.04 LTS
    

é‡å¯

    (base) âœ  ~ multipass restart d1804
    Restarting d1804 ...
    

è¡¥å……ï¼š`--all`å‚æ•°

    (base) âœ  ~ multipass start --all  # å¯åŠ¨æ‰€æœ‰å®ä¾‹
    (base) âœ  ~ multipass stop --all	# å…³é—­æ‰€æœ‰å®ä¾‹
    

  

### ä½¿ç”¨å®ä¾‹ - è¿›å…¥shelläº¤äº’

    (base) âœ  ~ multipass shell d1804
    Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-194-generic x86_64)
    
     * Documentation:  https://help.ubuntu.com
     * Management:     https://landscape.canonical.com
     * Support:        https://ubuntu.com/advantage
    
      System information as of Sat Nov  5 18:56:38 CST 2022
    ... ...
    ... ...
    

  

### åˆ é™¤å®ä¾‹ - å¯æ¢å¤

æ­¤æ—¶åˆ—è¡¨è¿˜æ˜¾ç¤ºè¢«åˆ é™¤çš„å®ä¾‹

    (base) âœ  ~ multipass delete foo           
    (base) âœ  ~ multipass list      
    Name                    State             IPv4             Image
    d1804                   Running           192.168.64.3     Ubuntu 18.04 LTS
    foo                     Deleted           --               Not Available
    

æ¢å¤è¢«åˆ é™¤çš„å®ä¾‹ï¼š

    $ multipass recover foo
    

  

### åˆ é™¤å®ä¾‹ - æ°¸ä¹…åˆ é™¤

å…³é”®å‘½ä»¤ï¼š`multipass purge [instances...]`ï¼Œé‡‡ç”¨çº¯å‡€æ¨¡å¼åˆ é™¤çš„å®ä¾‹ä¸å¯æ¢å¤ã€‚

    (base) âœ  ~ multipass delete foo
    (base) âœ  ~ multipass purge        
    (base) âœ  ~ multipass list 
    Name                    State             IPv4             Image
    d1804                   Running           192.168.64.3     Ubuntu 18.04 LTS
    

æˆ–è€…ï¼Œä¸€æ­¥åˆ°ä½

    (base) âœ  ~ multipass delete --purge foo
    

  

### å¤–è½½å‘½ä»¤æ¨¡å¼

ä¸éœ€è¦è¿›å…¥å®ä¾‹çš„shelläº¤äº’ç¯å¢ƒå°±å¯ä»¥æ‰§è¡Œå®ä¾‹å†…éƒ¨å‘½ä»¤ï¼Œä½†éœ€è¦ç›®æ ‡å®ä¾‹å¤„äºrunningçŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰å¤„äºrunningçŠ¶æ€ï¼Œä¼šå…ˆå¯åŠ¨å†æ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚

    (base) âœ  ~ multipass exec d1804 -- pwd
    /home/ubuntu
    

âš ï¸ å®ä¾‹åˆ«ååçš„ -- åé¢è¦è·Ÿç©ºæ ¼ï¼Œä¹‹åå†è¾“å…¥å‘½ä»¤  
  

### æŒ‚è½½æ•°æ® using mount

mountå‘½ä»¤æ˜¯å®˜æ–¹æ¨èçš„æ–‡ä»¶å…±äº«æ–¹å¼ã€‚

    âœ  ls
    Photos Library.photoslibrary                 ishot                                        u=60941161,499456713&fm=26&fmt=auto&gp=0.png
    bizhi                                        mail_img
    img                                          pokerking-full-logo.png
    
    âœ  multipass mount bizhi d1804
    
    âœ  multipass info d1804       
    Name:           d1804
    State:          Running
    IPv4:           192.168.64.2
    Release:        Ubuntu 18.04.6 LTS
    Image hash:     5269cad5bc26 (Ubuntu 18.04 LTS)
    Load:           0.06 0.09 0.03
    Disk usage:     1.2G out of 9.5G
    Memory usage:   119.4M out of 985.6M
    Mounts:         /Users/admin/Pictures/bizhi => /Users/admin/Pictures/bizhi
                        UID map: 501:default
                        GID map: 20:default
    

å¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®æœ¬åœ°`bizhi`æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œmultipassåœ¨å®ä¾‹é‡Œé¢å»ºç«‹äº†åŒåè·¯å¾„çš„æ˜ å°„ï¼Œ**æ­¤ååŒæ–¹ä»»æ„æ–¹å¯¹è¯¥æ–‡ä»¶å¤¹è¿›è¡Œå˜åŠ¨ï¼Œéƒ½ä¼šåŒæ­¥è‡³å¦ä¸€æ–¹ã€‚**

å–æ¶ˆå…±äº«ï¼š

    $ multipass umount d1804
    

  

### ä¼ è¾“æ–‡ä»¶ using transfer

`transfer`çš„ä½œç”¨å°±æ˜¯ä»ä¸€ç«¯å¤åˆ¶æ–‡ä»¶åˆ°å¦ä¸€ç«¯ï¼Œå¯ä»¥æ˜¯æœ¬åœ°å¤åˆ¶åˆ°ä¸€ä¸ªå®ä¾‹é‡Œï¼Œä¹Ÿå¯ä»¥æ˜¯ä»ä¸€ä¸ªå®ä¾‹å¤åˆ¶åˆ°å¦ä¸€ä¸ªå®ä¾‹é‡Œï¼Œä¹Ÿå¯ä»¥æ˜¯ä»å®ä¾‹å¤åˆ¶åˆ°æœ¬åœ°ã€‚

âš ï¸ åŒæ­¥çš„æ•°æ®ï¼Œåç»­å˜åŠ¨åŒæ–¹äº’ä¸å½±å“ã€‚

ä»å®¿ä¸»æœºä¼ é€åˆ°Multipasså®ä¾‹ä¸­ï¼š

    # macæœ¬åœ°é”®å…¥
    âœ  ls
    pokerking-full-logo.png
    
    âœ  multipass transfer pokerking-full-logo.png d1804:/tmp
    
    âœ  multipass shell d1804
    
    # multipasså®ä¾‹ä¸­é”®å…¥
    ubuntu@d1804:~$ ls /tmp/
    

![image (1)](https://img2022.cnblogs.com/blog/2056368/202211/2056368-20221126181801828-383864633.png)  
  

ä»Multipasså®ä¾‹ä¼ é€åˆ°å®¿ä¸»æœºä¸­ï¼š

    # macæœ¬åœ°é”®å…¥
    âœ  ~ ls Public 
    Drop Box
    
    âœ  ~ multipass shell d1804
    
    # å®ä¾‹é”®å…¥
    ubuntu@d1804:~$ pwd
    /home/ubuntu
    
    ubuntu@d1804:~$ touch test.txt
    
    ubuntu@d1804:~$ ls
    snap  test.txt
    
    # å†åˆ‡æ¢åˆ°macæœ¬åœ°shell
    âœ  ~ multipass transfer d1804:/home/ubuntu/test.txt /Users/admin/Public
    
    âœ  ~ ls Public
    Drop Box test.txt
    

ä»¥ä¸Šå‘½ä»¤å¹¶ä¸æ˜¯Multipassæ”¯æŒçš„æ‰€æœ‰å‘½ä»¤ï¼Œä½†è¶³å¤Ÿè¦†ç›–æ—¥å¸¸ä½¿ç”¨çš„80%ï¼Œæ›´å¤šå†…å®¹å¯ä»¥å»æ–‡ç« é¡¶éƒ¨çš„Multipasså®˜ç½‘è‡ªè¡Œæµè§ˆï¼  
  

æ€»ç»“ ğŸ’¡
=====

å†™åˆ°è¿™é‡Œï¼Œç›¸ä¿¡æœ‰éƒ¨åˆ†äººè§‰å¾—Multipassçš„ç”¨æ³•å’ŒDockeréå¸¸ç›¸ä¼¼ï¼Œä¹Ÿæœ‰éƒ¨åˆ†Windowsç”¨æˆ·è®¤ä¸ºè¿™å’Œå½“å‰å¾®è½¯åŠ›æ¨çš„WSL (Windows Subsystem for Linux) çš„åŠŸèƒ½é«˜åº¦é‡å ã€‚å…·ä½“è¯·çœ‹ä»¥ä¸‹å¯¹æ¯”ã€‚

**å¯¹æ¯”**

**Multipass**

**Docker**

**WSL & WSL2**

**æŠ€æœ¯é¢†åŸŸ**

è™šæ‹Ÿæœº

å®¹å™¨æŠ€æœ¯

è™šæ‹Ÿæœº

**èƒŒä¹¦å‚å•†**

Canonical (Ubuntuå®˜æ–¹)

Dockerå®˜æ–¹

å¾®è½¯

**å¼€å‘è¯­è¨€**

C++

Go

C

**å¼€æºåŠ  
æ‰˜ç®¡çŠ¶æ€**

å¼€æºï¼Œæ‰˜ç®¡äºGitHub  
ğŸ‘‰ [ç‚¹å‡»ç›´è¾¾canonical/multipass](https://github.com/canonical/multipass)

å¼€æºï¼Œæ‰˜ç®¡äºGitHub  
ğŸ‘‰ [ç‚¹å‡»ç›´è¾¾Docker](https://github.com/docker)

å¼€æºï¼Œæ‰˜ç®¡äºGitHub  
ğŸ‘‰ [ç‚¹å‡»ç›´è¾¾microsoft/WSL2](https://github.com/microsoft/WSL2-Linux-Kernel)

**é€‚é…å¹³å°**

Linux & MacOS & Windowsï¼Œè·¨å¹³å°èƒ½åŠ›å¥½

Linuxé€‚é…è¾ƒå¥½ï¼ŒMacOS & Windowsé€‚é…è¾ƒå¼±

Windowsæ— ç¼é›†æˆ

**å¯é€‰ç¯å¢ƒ**

ä»…Ubuntuå®˜æ–¹é•œåƒ

å„ç§Linuxç‰ˆæœ¬ï¼Œ  
é€‰æ‹©çµæ´»æ€§ç¨‹åº¦é«˜

Linux kernelç¨³å®šç‰ˆ + éƒ¨åˆ†å‘è¡Œç‰ˆ

**é€‚ç”¨åœºæ™¯**

æœ¬åœ°å¼€å‘&éªŒè¯&å­¦ä¹ ç©è€

å¯åœ¨å·¥ä¸šçº§ç”Ÿäº§åœºæ™¯ä¸­  
å®é™…åº”ç”¨

æœ¬åœ°å¼€å‘&éªŒè¯&å­¦ä¹ ç©è€

  

è¡¥å……ğŸ’¡
====

1.  å¯ä»¥åœ¨MacOSå’ŒWindowsä¸Šå®‰è£…Multipassï¼Œç„¶ååœ¨Multipassçš„VMå®ä¾‹ä¸­å®‰è£…Dockerï¼Œä½¿å¾—éLinuxç³»ç»Ÿçš„å®¿ä¸»æœºä½¿ç”¨ç¨³å®šçš„å®¹å™¨æŠ€æœ¯ã€‚ï¼ˆé€‚ç”¨äºä¸ªäººå­¦ä¹ ç©è€ï¼Œç”Ÿäº§ç¯å¢ƒè«å¼€ç©ç¬‘ï¼ï¼‰
2.  Multipassçš„å‡ºç°æ›´åƒæ˜¯Ubuntuä¸ºäº†å’Œå¾®è½¯çš„WSLä¸€äº‰é«˜ä¸‹ï¼ˆä¸ªäººçŒœæµ‹ï¼‰ï¼Œå¯ä»¥å°†Multipasså’ŒWSLæ”¾åœ¨åŒç­‰åœ°ä½ï¼ŒDockeråˆ™æ˜¯åœ¨Linuxçš„åŸºç¡€ä¸Šï¼Œå…·å¤‡å‰ä¸¤è€…æ‰€æ²¡æœ‰çš„ç‰¹æ€§ï¼Œé‡ç‚¹æä¾›ä¸åŒäºMultipass/WSLçš„æœåŠ¡ã€‚
3.  é’ˆå¯¹è½¯ä»¶å¼€å‘äººå‘˜ï¼ŒWindowsçš„ç¯å¢ƒé…ç½®ä¸€å‘æ‚ä¹±æ— ç« ï¼Œæœ‰äº†Multipassï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Multipassç”Ÿæˆçš„Linuxå®ä¾‹ç¯å¢ƒä¸­é…ç½®å„ç§æœåŠ¡ï¼Œå¦‚MySQLã€Redisç­‰ï¼Œå®¿ä¸»æœºå¼€å‘ç¯å¢ƒé€šè¿‡ç›´è¿Multipasså®ä¾‹ä½¿ç”¨å…¶æä¾›çš„æœåŠ¡ã€‚