---
layout: post
title: "获取图片中的图表数据并拟合函数"
date: "2022-10-10T15:27:26.644Z"
---
获取图片中的图表数据并拟合函数
===============

获取数据
====

在看论文或说明手册遇到图表时，常遇到无法获取源数据或曲线的情况。以下使用[WebPlotDigitizer在线工具](https://apps.automeris.io/wpd/index.zh_CN.html)通过像素级坐标标定并取点取数。

> [WebPlotDigitizer在线工具](https://apps.automeris.io/wpd/index.zh_CN.html)  
> 该工具开源，并提供在线版和离线版，[GitHub地址](https://github.com/ankitrohatgi/WebPlotDigitizer)

以下图为例，本次使用WPS工具优化并获取一张相对清晰且像素较大（无损放大6倍）的图片。

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010212817884-482216551.png)

*   打开 [WebPlotDigitizer在线工具](https://apps.automeris.io/wpd/index.zh_CN.html) ，导入图片

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010213200049-1177896998.png)

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010213232227-155733847.png)

*   选取相应图表类型，通过在坐标轴上分别标记4个点来标定坐标系，标记好后可点击每一个点通过方向键微调，记下所标点对应的图上坐标，点击完成

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010213633234-1363879852.png)

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010213848079-1802231019.png)

*   在弹出标定框内填入所对应的4点坐标，点击`确定`
    
*   使用增加点工具在坐标轴上拾取多个点进行测试，点击左侧查看数据，如果相差较多，可通过左侧菜单重新标定坐标系  
    ![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010214635229-106606625.png)
    
*   使用画笔工具快速取点：更改前景色为曲线颜色，更改背景色为图表背景，选中画笔工具在图上画出所需快速取点坐标的曲线  
    ![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010214335745-2015255847.png)
    
*   点击运行，可通过调整算法框内的数值改变取点的密度  
    ![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010215033614-1035826831.png)
    
*   通过右侧`手动提取`区域的菜单`删除点`，将鼠标靠近不需要的点附近点击，即可删除多余点  
    ![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010215419401-1888972828.png)
    
*   坐标点编辑完成后，点击`查看数据`，在弹出窗口内复制或下载数据。
    

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010215544324-854954428.png)

数据曲线拟合
======

*   将上一步复制或下载的数据使用`Excel`打开，如果是复制的，需要使用`分列`将原始数据进行分割为两列

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010220000597-1785188466.png)

*   将每一列添加标题，按图标特点选择排序数据 ；选中数据，插入图标

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010220332622-1837253995.png)

*   插入带`平滑线的散点图` , 选中图表中的数据，右键`添加趋势线`

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010220443304-1980733999.png)

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010220618865-896861433.png)

*   双击图表中的趋势线，右侧弹出趋势线编辑框，修改参数使趋势线尽量拟合至数据点，其中R的平方值越趋近于1，说明拟合效果就越好，拟合的函数愈逼真。

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010221154330-1233102406.png)

*   测试：给定X值，使用拟合的函数给出预测的Y值，同时可以再添加一列为使用Excel自带的`VLOOKUP函数`匹配返回的最近上一个值（当点的个数越多时建议直接使用此方法匹配）

![](https://img2022.cnblogs.com/blog/2027065/202210/2027065-20221010222204476-1499562126.png)

[**我的小站:** dapenson](http://z-cy.cn/)  
[**cnblogs:** www.cnblogs.com/dapenson](https://www.cnblogs.com/dapenson/)