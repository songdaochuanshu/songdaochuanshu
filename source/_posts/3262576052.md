---
layout: post
title: "github ations å…¥é—¨ä½¿ç”¨"
date: "2022-04-15T16:28:48.894Z"
---
github ations å…¥é—¨ä½¿ç”¨
==================

åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Github Actionsã€‚

> åœ¨ GitHub Actions çš„ä»“åº“ä¸­è‡ªåŠ¨åŒ–ã€è‡ªå®šä¹‰å’Œæ‰§è¡Œè½¯ä»¶å¼€å‘å·¥ä½œæµç¨‹ã€‚ æ‚¨å¯ä»¥å‘ç°ã€åˆ›å»ºå’Œå…±äº«æ“ä½œä»¥æ‰§è¡Œæ‚¨å–œæ¬¢çš„ä»»ä½•ä½œä¸šï¼ˆåŒ…æ‹¬ CI/CDï¼‰ï¼Œå¹¶å°†æ“ä½œåˆå¹¶åˆ°å®Œå…¨è‡ªå®šä¹‰çš„å·¥ä½œæµç¨‹ä¸­ã€‚

[ç‚¹å‡»å¼€å§‹å…¥é—¨](https://docs.github.com/cn/actions/quickstart)å¦‚æœæ‰“ä¸å¼€çš„å°ä¼™ä¼´æŒ‰ç…§ä¸€ä¸‹æ­¥éª¤ä¸€èµ·æ¥å¼€å§‹ä½¿ç”¨ç®€å•çš„ã€‚

1.  å¦‚æœ .github/workflows ç›®å½•ä¸å­˜åœ¨ï¼Œè¯·åœ¨ GitHub çš„ä»“åº“é¡¹ç›®ä¸­åˆ›å»ºæ­¤ç›®å½•ã€‚
2.  åœ¨ .github/workflow ç›®å½•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º github-actions-demo.yml çš„æ–‡ä»¶ã€‚(æ–‡ä»¶å‘½åéšä¾¿ï¼Œåç¼€å¿…é¡»ä¸º`.yml`)
3.  å°†ä»¥ä¸‹ YAML å†…å®¹å¤åˆ¶åˆ° github-actions-demo.yml æ–‡ä»¶ä¸­ï¼š

    name: GitHub Actions Demo
    on: [push]
    jobs:
      Explore-GitHub-Actions:
        runs-on: ubuntu-latest
        steps:
          - run: echo "ğŸ‰ The job was automatically triggered by a ${{ github.event_name }} event."
          - run: echo "ğŸ§ This job is now running on a ${{ runner.os }} server hosted by GitHub!"
          - run: echo "ğŸ” The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
          - name: Check out repository code
            uses: actions/checkout@v3
          - run: echo "ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
          - run: echo "ğŸ–¥ï¸ The workflow is now ready to test your code on the runner."
          - name: List files in the repository
            run: |
              ls ${{ github.workspace }}
          - run: echo "ğŸ This job's status is ${{ job.status }}."
    
    

4.  æäº¤è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ¨é€åˆ°è¿œç¨‹ä»“åº“å»ã€‚
    
5.  ä½ å°†ä¼šåœ¨è¿œç¨‹ä»“åº“çš„`Actions`ä¸­çœ‹åˆ°è¿è¡Œçš„æ—¥å¿—ã€‚  
    ![è¿è¡Œæ—¥å¿—](https://docs.github.com/assets/cb-102539/images/help/repository/actions-quickstart-logs.png)
    
6.  ç°åœ¨ä½ å·²ç»æŒæ¡äº†ä¸€ä¸ªç®€å•çš„`è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹`ã€‚
    

react,vue é¡¹ç›®æäº¤ä»£ç è‡ªåŠ¨æ›´æ–° GitHub Pages
---------------------------------

è‹¥ä½ æ˜¯ä¸€ä¸ª`å‰ç«¯å¼€å‘`æˆ–è€…å–œæ¬¢è‡ªå·±å¼€å‘ç½‘ç«™ï¼Œä½ è‚¯å®šæƒ³æ‹¥æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„ç½‘ç«™ã€‚æŠŠè‡ªå·±çš„é¡¹ç›®æˆ–è€…åšå®¢ï¼Œæ”¾åœ¨ç½‘ç»œä¸Šï¼Œä»»ä½•äººéƒ½å¯ä»¥çœ‹è§ã€‚æ¥ä¸‹æ¥ï¼Œæ˜¯ä½¿ç”¨ `å‰ç«¯æ¡†æ¶` é¡¹ç›®æäº¤ä»£ç è‡ªåŠ¨æ›´æ–°`pages`ã€‚

### åœ¨ä½¿ç”¨ä¹‹å‰

è¯·æ£€æŸ¥ä¸€ä¸‹ä¿¡æ¯:

1.  ç¡®ä¿æœ‰ä¸€ä¸ªæ–°çš„åˆ†æ”¯ä¸“é—¨ç”¨æ¥å­˜æ”¾`Pages`é¡¹ç›®çš„ä»£ç ã€‚

    git checkout -b gh-pages #åˆ›å»º gh-pagesåˆ†æ”¯ å¹¶åˆ‡æ¢åˆ° gh-pages
    git push origin gh-pages:gh-pages #æŠŠæœ¬åœ°åˆ†æ”¯æ¨é€åˆ° è¿œç¨‹ä»“åº“
    

2.  Github ä»“åº“æ˜¯å¦å¼€å¯ `GitHub Pages`

åœ¨æµè§ˆå™¨æ‰“å¼€ä½ çš„ Github ä»“åº“, æ‰¾åˆ° Settings é€‰é¡¹ ç‚¹å‡»è¿›å…¥ï¼Œåœ¨å·¦ä¾§å¯»æ‰¾åˆ° Pages æ ç›®ï¼Œç‚¹å‡»ä¹‹åï¼Œå‡ºç°ä¸€ä¸ª Source æ ‡é¢˜ï¼Œä¸‹é¢æœ‰ä¸ª é€‰æ‹©æ¡†ï¼Œå½“å‰æ˜¯ Noneï¼Œè¡¨ç¤ºä½ è¿˜æœªå¼€å¯`Pages`åŠŸèƒ½ã€‚ç‚¹å‡» None é€‰æ‹©æ¡† é€‰æ‹©ä½  åˆ›å»ºçš„åˆ†æ”¯ï¼Œè¿™é‡Œé€‰æ‹© åˆšåˆšåˆ›å»ºçš„`gh-pages`ï¼Œé€‰æ‹©å®Œä¹‹å è¿˜æœ‰ä¸ªæ–‡ä»¶å¤¹é€‰æ‹©ï¼Œæ„æ€æ˜¯è¿™ä¸ªåˆ†æ”¯çš„æ–‡ä»¶å¤¹ä½œä¸ºå…¥å£æ¥æ˜¾ç¤ºä½ çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å°±æŒ‰ç…§é»˜è®¤çš„`root/`ç›®å½•å°±è¡Œäº†ï¼Œç‚¹å‡» save å³å¯ã€‚ç‚¹å‡»å®Œæˆä¹‹åä¼šæœ‰ä¸ªæç¤ºï¼š

> Your site is ready to be published at `https://{username}.github.io/{store_name}/`

è¯´æ˜ä½ çš„`pages`å¼€å¯æˆåŠŸï¼Œä¸è¿‡ç‚¹å‡»è¿›å»æ˜¯ 404 ï¼Œå› ä¸ºä½ `gh-pages`åˆ†æ”¯è¿˜æ²¡èµ„æºæ‰€ä»¥æ‰¾ä¸åˆ°è®¿é—®ä¿¡æ¯ã€‚

### å¼€å§‹éƒ¨ç½²å‰ç«¯æ¡†æ¶(react)é¡¹ç›®

åœ¨å®Œæˆäº†ä¸Šé¢çš„æ­¥éª¤ä¹‹åï¼Œå¼€å§‹ç¼–å†™`Actions`ã€‚ä½ å¯ä»¥é˜…è¯»ä»¥ä¸‹æ–‡æ¡£ï¼š[è§¦å‘å·¥ä½œæµç¨‹  
](https://docs.github.com/cn/actions/using-workflows/triggering-a-workflow)

1.  åœ¨å½“å‰é¡¹ç›®ä»£ç è¿è¡Œæ‰€åœ¨çš„åˆ†æ”¯ï¼Œåˆ›å»º`.github`æ–‡ä»¶å¤¹ï¼Œå†åœ¨`.github`æ–‡ä»¶å¤¹ä¸‹åˆ›å»º`workflows`æ–‡ä»¶å¤¹ï¼Œåœ¨æ­¤ç›®å½•ä¸‹æ–°å»º`.yml`æ ¼å¼æ–‡ä»¶ã€‚

    â”œâ”€ .github        #æ–‡ä»¶å¤¹
        â””â”€ workflows  #æ–‡ä»¶å¤¹
            â””â”€ autoUpdatePages.yml # actionsæ–‡ä»¶ åç¼€.yml
    

2.  ç¼–å†™`autoUpdatePages.yml`æ–‡ä»¶  
    ä»£ç å¦‚ä¸‹ï¼š

    name: update pages #åç§° éšæ„
    
    on: # è§¦å‘æ¡ä»¶
      push: # å½“æ¨é€çš„æ—¶å€™
        branches: [master] # åˆ†æ”¯ å¯ä»¥æœ‰å¤šä¸ª ä¸”ä¸º master è§¦å‘
        paths: ["src/**"] # ä¸” æ¨é€çš„æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸‹ è§¦å‘
    
    jobs: #è¦è¿è¡Œçš„ä»»åŠ¡
      build: #ä»»åŠ¡å éšæ„
        runs-on: ubuntu-latest # è¿è¡Œçš„æœºå™¨ç¯å¢ƒ å¯ä»¥æ˜¯ linux ç­‰ç­‰ å…·ä½“è¯·æŸ¥é˜…æ–‡æ¡£
        # ç”¨åˆ°çš„ node ç‰ˆæœ¬
        strategy:
          matrix:
            node-version: [12]
        # è¿è¡Œæ­¥éª¤
        steps:
          # ä¸€äº›æ£€æŸ¥ è¾“å‡º
          - uses: actions/checkout@v3
    
          - name: Use Node.js ${{ matrix.node-version }}
            uses: actions/setup-node@v3
            with:
              node-version: ${{ matrix.node-version }}
          # å¼€å§‹ æ‰“åŒ…
          - name: Build
          # run ä¸‹é¢ æ˜¯éœ€è¦è¿è¡Œçš„å‘½ä»¤è¡Œ æŒ‰ç…§å‘½ä»¤è¡Œæ­¥éª¤æ‰§è¡Œ å…ˆå®‰è£…ä¾èµ– å† æ‰“åŒ… ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰
            run: |
              npm install
              npm build
          # å®Œæˆæ‰“åŒ…ä¹‹å ä½¿ç”¨ github-pages-deploy-action å»è‡ªå·±æŠŠæ‰“åŒ…åçš„äº§ç‰©å‘å¸ƒä¸Šå»
          - name: Deploy ğŸš€
            uses: JamesIves/github-pages-deploy-action@v4.3.0
            with:
              branch: gh-pages # å‘å¸ƒåˆ°å“ªä¸ªåˆ†æ”¯ï¼Ÿ
              folder: build # æ‰“åŒ…çš„æ–‡ä»¶ç›®å½•
              clean-exclude: | # å¿½ç•¥æ¸…é™¤çš„æ–‡ä»¶ å¯ä»¥æ˜¯æ–‡ä»¶åè·¯å¾„ç­‰ æ¯æ¬¡å‘å¸ƒå‰éƒ½ä¼šæ¸…é™¤æ‰€æœ‰æ–‡ä»¶æ‰€ä»¥éœ€è¦ å±è”½ä¸€äº›æ–‡ä»¶æˆ–è€…ç›®å½•ä¸è¦æ¸…é™¤ã€‚ 
                .gitignore
    

3.  å®Œæˆä»¥ä¸Šæ–‡ä»¶ä¹‹åï¼Œæ¨é€åˆ°è¿œç¨‹ä»“åº“å³å¯ã€‚
    
4.  æ³¨æ„è§¦å‘æ¡ä»¶ã€‚