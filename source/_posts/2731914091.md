---
layout: post
title: "7 什么是dubbo"
date: "2022-07-18T13:45:34.458Z"
---
7 什么是dubbo
==========

什么是dubbo
--------

快速入门dubbo

了解什么是dubbo之前，我们得先了解什么是分布式系统？

*   《分布式系统原理与范型》定义：
    *   `分布式系统是若干独立计算机的集合`，这些计算机对于用户来说就像单个相关系统
    *   分布式系统（distributed system）是`建立在网络之上`的软件系统。
    *   简单来说：`多个（不同职责）人共同来完成一件事`！
    *   任何一台服务器都无法满足淘宝的双十一的数据吞吐量，一定是很多台服务器公共来完成  
        的。(服务器比做人)
*   歇后语：“三个臭皮匠赛过诸葛亮”，就是`分布式系统的真实写照`

系统架构的演变
-------

### 1 单一应用架构

*   当网站流量很小时，只需要一个应用，将所有的功能部署到一起（所有业务都放在一个tomcat  
    里），从而减少部署节点和成本；
*   此时，用于简化 增删改查 工作量的数据访问框架 （ORM）是关键；mybatis就是orm框架。**ORM：**对象关系映射（Object Relational Mapping）
*   例如：某个超市的收银系统，某个公司的员工管理系统
*   ![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718172518566-1804412086.png)

**优点：**

*   小项目开发快 成本低
*   架构简单
*   易于测试
*   易于部署

**缺点**

*   大项目模块耦合严重 不易开发 维护 沟通成本高
*   新增业务困难
*   核心业务与边缘业务混合在一块，出现问题互相影响

### 2 垂直应用架构

*   当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，将应用拆成几个互不相干的几个应  
    用,以提高效率；
*   大模块按照mvc分层模式，进行拆分成多个互不相关的小模块，并且每个小模块都有独立的服务器
*   此时，用于加速前端页面开发的web框架（MVC）是关键；因为每个小应用都有独立的页面  
    ![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718172806485-1450770617.png)

MVC：模型视图控制器 （Model View Controller）

*   缺点：
    *   模块之间不可能完全没有交集，公用模块无法重复利用，开发性的浪费

### 3 分布式服务架构

*   当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的业务，逐渐形成  
    稳健的服务中心，使前端应用能更快速的响应多变的市场需求；
*   此时，用户提高业务复用及整合的分布式服务框架[（RPC）远程调用](#rpc)是关键；  
    ![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718172947468-919594104.png)

RPC：`独立的应用服务器之间，要依靠RPC（Romote Procedure Call）才能调用`

*   这也会出现一个问题：当物流服务不忙，有100台服务器； 商品服务特别忙，也是100台服务器；
*   如何做到`资源优化调配`？↓下面的流动计算架构能帮我们解决实际问题。

### 4 流动计算架构

*   当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐呈现，此时需增加一个调度中心基于  
    访问压力实时管理集群容量，提高集群利用率；
*   此时，用于提高机器利用率的资源调度和治理中心（SOA）是关键；  
    ![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718173547768-517374460.png)

> SOA：面向服务架构（Service-Oriented Architecture），简单理解就是“服务治理”，例如：公交车站  
> 的“调度员”

Dubbo简介
-------

*   Dubbo是分布式服务框架，是阿里巴巴的开源项目，现交给apache进行维护
*   Dubbo致力于提高性能和透明化的RPC远程服务调用方案，以及SOA服务治理方案
*   简单来说，dubbo是个服务框架，如果没有分布式的需求，是不需要用的

### 1 RPC

*   RPC【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式
    
*   RPC基本的通信原理
    
    1.  在客户端将对象进行序列化
    2.  底层通信框架使用netty（基于tcp协议的socket），将序列化的对象发给服务方提供方
    3.  服务提供方通过socket得到数据文件之后，进行反序列化，获得要操作的对象
    4.  对象数据操作完毕，将新的对象序列化，再通过服务提供方的socket返回给客户端
    5.  客户端获得序列化数据，再反序列化，得到最新的数据对象，至此，完成一次请求
*   `RPC两个核心模块：通讯（socket），序列化。`
    
    ![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718173931062-1224487456.png)
    

### 2 节点角色关系

节点

角色说明

Provider

服务的提供方（类似于洗浴中心）

Consumer

服务的消费方（客人）

Registry

服务注册与发现的注册中心（便民服务中心，所有的饭店娱乐场所都在已在本中心  
注册）

Monitor

监控服务的统计中心（统计服务被调用的次数）

Container

服务运行容器（烧烤一条街，洗浴一条街）

![img](https://img2022.cnblogs.com/blog/2233272/202207/2233272-20220718174131867-993549619.png)

### 3 调用关系

1.服务容器负责启动，加载，运行服务提供者；  
2.服务提供者在启动时，向注册中心注册自己提供的服务；  
3.服务消费者在启动时，向注册中心订阅自己所需的服务；  
4.在注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给  
消费者；  
5.服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，  
再选另一台调用；  
6.服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中  
心；