---
layout: post
title: "ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·"
date: "2023-02-24T01:14:14.969Z"
---
ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·
========================

åœ¨ .net 7 ä»¥å‰ï¼Œé¡¹ç›®å¯¹äº nuget ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¾èµ–æ•£è½ä¸è§£å†³æ–¹æ¡ˆçš„å„ä¸ªè§’è½ã€‚è¿™å¯¼è‡´å‡çº§ç»´æŠ¤å’ŒæŸ¥çœ‹çš„æ—¶å€™éƒ½æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨ .net 7 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·ã€‚æœ¬ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚

åœ¨ .net 7 ä»¥å‰ï¼Œé¡¹ç›®å¯¹äº nuget ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¾èµ–æ•£è½ä¸è§£å†³æ–¹æ¡ˆçš„å„ä¸ªè§’è½ã€‚è¿™å¯¼è‡´å‡çº§ç»´æŠ¤å’ŒæŸ¥çœ‹çš„æ—¶å€™éƒ½æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨ .net 7 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·ã€‚æœ¬ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚

ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½
---------

é€šè¿‡å•æ–‡ä»¶æ§åˆ¶ Nuget ä¾èµ–ç‰ˆæœ¬å·ã€‚é‚£ä¹ˆä½ å°±å¯ä»¥ï¼š

1.  ç»Ÿä¸€æŸ¥çœ‹
2.  å‡çº§çš„æ—¶å€™åªè¦è¯¥è¿™ä¸€ä¸ªåœ°æ–¹
3.  ç»Ÿä¸€ç‰ˆæœ¬å·ï¼Œè‡³å°‘ä¸ä¼šå¿˜è®°å‡çº§æŸä¸ªé¡¹ç›®

æ€ä¹ˆæ“ä½œå‘¢
-----

### ä¿®æ”¹ Directory.Build.props

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `Directory.Build.props` æ–‡ä»¶ï¼Œç„¶åæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

    <Project>
        <PropertyGroup>
            <ManagePackageVersionsCentrally>true</ManagePackageVersionsCentrally>
        </PropertyGroup>
    </Project>
    

è¿™æ ·å°±å¯ç”¨äº†è¿™ä¸ªåŠŸèƒ½ã€‚

### åˆ›å»ºä¸€ä¸ª Directory.Packages.props æ–‡ä»¶

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `Directory.Packages.props` æ–‡ä»¶ï¼Œç„¶åæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

    <Project>
        <ItemGroup>
            <PackageVersion Include="xunit" Version="2.4.2"/>
            <PackageVersion Include="xunit.runner.visualstudio" Version="2.4.5">
                <PrivateAssets>all</PrivateAssets>
                <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
            </PackageVersion>
            <PackageVersion Include="coverlet.collector" Version="3.2.0">
                <PrivateAssets>all</PrivateAssets>
                <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
            </PackageVersion>
        </ItemGroup>
    </Project>
    

è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·çš„é›†ä¸­ç®¡ç†æ–‡ä»¶ã€‚å…¶ä¸­çš„å†™æ³•é™¤äº† `PackageVersion` å…ƒç´ å¤–ï¼Œå…¶ä»–çš„éƒ½æ˜¯ Nuget çš„å†™æ³•ã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·ã€‚

å†æ¬¡æ³¨æ„ï¼Œè¿™é‡Œæ˜¯ `PackageVersion` è€Œä¸æ˜¯ `PackageReference`ã€‚

### ä¿®æ”¹ä½ çš„é¡¹ç›®æ–‡ä»¶

åœ¨ä½ çš„é¡¹ç›®æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥å¼•ç”¨ Nuget ä¾èµ–ï¼š

    <Project>
        <ItemGroup>
            <PackageReference Include="xunit" />
            <PackageReference Include="unit.runner.visualstudio" />
        </ItemGroup>
    </Project>
    

è¯¥æ–‡ä»¶å’Œä»¥å‰çš„å†™æ³•æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ä½ ä¸éœ€è¦å†æŒ‡å®šç‰ˆæœ¬å·äº†ã€‚

è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ `Directory.Packages.props` æ¥é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·äº†ã€‚

å¦‚æœæˆ‘æ˜¯ .net 7 ä»¥å‰çš„ç‰ˆæœ¬é‚£æ€ä¹ˆåŠ
---------------------

å®é™…ä¸Šåœ¨ .net 7 ä¹‹å‰ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å› ä¸ºé¢å¤–çš„ Sdk æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚

[Microsoft.Build.CentralPackageVersions](https://github.com/microsoft/MSBuildSdks/tree/main/src/CentralPackageVersions)1

æ€»ç»“
--

é€šè¿‡è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å¯ä»¥é›†ä¸­ç®¡ç†ä½ çš„ Nuget ä¾èµ–ç‰ˆæœ¬å·ã€‚è¿™æ ·ä½ å°±å¯ä»¥ç»Ÿä¸€æŸ¥çœ‹ï¼Œå‡çº§çš„æ—¶å€™åªè¦è¯¥è¿™ä¸€ä¸ªåœ°æ–¹ï¼Œç»Ÿä¸€ç‰ˆæœ¬å·ï¼Œè‡³å°‘ä¸ä¼šå¿˜è®°å‡çº§æŸä¸ªé¡¹ç›®ã€‚

å‚è€ƒ
--

*   [Central Package Management (CPM)](https://learn.microsoft.com/nuget/consume-packages/central-package-management?WT.mc_id=DX-MVP-5003606)2
*   [Directory.Build.props](https://learn.microsoft.com/visualstudio/msbuild/customize-your-build?view=vs-2022&WT.mc_id=DX-MVP-5003606#directorybuildprops-and-directorybuildtargets)3

æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœè§‰å¾—æœ¬æ–‡æœ‰ç”¨ï¼Œä¸å¦¨ç‚¹å‡»æ¨èğŸ‘æˆ–è€…åœ¨è¯„è®ºåŒºç•™ä¸‹ Markï¼Œè®©æ›´å¤šçš„äººå¯ä»¥çœ‹åˆ°ã€‚

> æ¬¢è¿å…³æ³¨ä½œè€…çš„å¾®ä¿¡å…¬ä¼—å·â€œnewbeæŠ€æœ¯ä¸“æ â€ï¼Œè·å–æ›´å¤šæŠ€æœ¯å†…å®¹ã€‚ ![å…³æ³¨å¾®ä¿¡å…¬ä¼—å·â€œnewbeæŠ€æœ¯ä¸“æ â€](https://www.newbe.pro/images/weixin_public_qrcode.png)

*   æœ¬æ–‡ä½œè€…ï¼š [newbe36524](https://www.newbe.pro/)
*   æœ¬æ–‡é“¾æ¥ï¼š [https://www.newbe.pro/Others/0x025-Use-one-file-to-centrally-manage-your-Nuget-dependency-version-numbers/](https://www.newbe.pro/Others/0x025-Use-one-file-to-centrally-manage-your-Nuget-dependency-version-numbers/)
*   ç‰ˆæƒå£°æ˜ï¼š æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼

* * *

1.  https://github.com/microsoft/MSBuildSdks/tree/main/src/CentralPackageVersionsâ†©
    
2.  https://learn.microsoft.com/nuget/consume-packages/central-package-management?WT.mc\_id=DX-MVP-5003606â†©
    
3.  https://learn.microsoft.com/visualstudio/msbuild/customize-your-build?view=vs-2022&WT.mc\_id=DX-MVP-5003606#directorybuildprops-and-directorybuildtargetsâ†©