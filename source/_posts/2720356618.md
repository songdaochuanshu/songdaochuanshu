---
layout: post
title: "v87.01 é¸¿è’™å†…æ ¸æºç åˆ†æ (å†…æ ¸å¯åŠ¨ç¯‡) | ä»æ±‡ç¼–åˆ° main () | ç™¾ç¯‡åšå®¢åˆ†æ OpenHarmony æºç "
date: "2022-05-26T05:22:06.933Z"
---
v87.01 é¸¿è’™å†…æ ¸æºç åˆ†æ (å†…æ ¸å¯åŠ¨ç¯‡) | ä»æ±‡ç¼–åˆ° main () | ç™¾ç¯‡åšå®¢åˆ†æ OpenHarmony æºç 
==============================================================

æœ¬ç¯‡å…³é”®è¯ï¼šå†…æ ¸é‡å®šä½ã€MMUã€SVCæ ˆã€çƒ­å¯åŠ¨ã€å†…æ ¸æ˜ å°„è¡¨

å†…æ ¸æ±‡ç¼–ç›¸å…³ç¯‡ä¸º:

*   [v74.01 é¸¿è’™å†…æ ¸æºç åˆ†æ(ç¼–ç æ–¹å¼) | æœºå™¨æŒ‡ä»¤æ˜¯å¦‚ä½•ç¼–ç çš„](https://www.cnblogs.com/weharmony/p/16252817.html)
*   [v75.03 é¸¿è’™å†…æ ¸æºç åˆ†æ(æ±‡ç¼–åŸºç¡€) | CPUä¸Šç­ä¹Ÿè¦æ‰“å¡](https://www.cnblogs.com/weharmony/p/15253668.html)
*   [v76.04 é¸¿è’™å†…æ ¸æºç åˆ†æ(æ±‡ç¼–ä¼ å‚) | å¦‚ä½•ä¼ é€’å¤æ‚çš„å‚æ•°](https://www.cnblogs.com/weharmony/p/15253667.html)
*   [v77.01 é¸¿è’™å†…æ ¸æºç åˆ†æ(é“¾æ¥è„šæœ¬) | æ­£åœ¨åˆ¶ä½œä¸­ ...](https://www.cnblogs.com/weharmony/p/15253620.html)
*   [v78.01 é¸¿è’™å†…æ ¸æºç åˆ†æ(å†…æ ¸å¯åŠ¨) | ä»æ±‡ç¼–åˆ°main()](https://www.cnblogs.com/weharmony/p/15253620.html)
*   [v79.01 é¸¿è’™å†…æ ¸æºç åˆ†æ(è¿›ç¨‹åˆ‡æ¢) | æ­£åœ¨åˆ¶ä½œä¸­ ...](https://www.cnblogs.com/weharmony/p/15253620.html)
*   [v80.03 é¸¿è’™å†…æ ¸æºç åˆ†æ(ä»»åŠ¡åˆ‡æ¢) | çœ‹æ±‡ç¼–å¦‚ä½•åˆ‡æ¢ä»»åŠ¡](https://www.cnblogs.com/weharmony/p/15253649.html)
*   [v81.05 é¸¿è’™å†…æ ¸æºç åˆ†æ(ä¸­æ–­åˆ‡æ¢) | ç³»ç»Ÿå› ä¸­æ–­æ´»åŠ›å››å°„](https://www.cnblogs.com/weharmony/p/15253648.html)
*   [v82.06 é¸¿è’™å†…æ ¸æºç åˆ†æ(å¼‚å¸¸æ¥ç®¡) | ç¤¾ä¼šå¾ˆå•çº¯ å¤æ‚çš„æ˜¯äºº](https://www.cnblogs.com/weharmony/p/15253651.html)
*   [v83.01 é¸¿è’™å†…æ ¸æºç åˆ†æ(ç¼ºé¡µä¸­æ–­) | æ­£åœ¨åˆ¶ä½œä¸­ ...](https://www.cnblogs.com/weharmony/p/15253620.html)

è¿™åº”è¯¥æ˜¯ç³»åˆ—ç¯‡æœ€éš¾å†™çš„ä¸€ç¯‡ï¼Œå…¨æ˜¯æ±‡ç¼–ä»£ç ï¼Œéœ€å¤§é‡çš„åº•å±‚çŸ¥è¯†ï¼Œæ¶‰åŠåå¤„ç†å™¨ï¼Œå†…æ ¸é•œåƒé‡å®šä½ï¼Œåˆ›å»ºå†…æ ¸æ˜ å°„è¡¨ï¼Œåˆå§‹åŒ– **CPU** æ¨¡å¼æ ˆï¼Œçƒ­å¯åŠ¨ï¼Œåˆ°æœ€åç†Ÿæ‚‰çš„ **main()** ã€‚

### å†…æ ¸å…¥å£

åœ¨é“¾æ¥æ–‡ä»¶ **liteos.ld** ä¸­å¯çŸ¥å†…æ ¸çš„å…¥å£åœ°å€ä¸º `ENTRY(reset_vector)` ï¼Œ åˆ†åˆ«å‡ºç°åœ¨reset\_vector\_mp.S (å¤šæ ¸å¯åŠ¨) å’Œ reset\_vector\_up.S(å•æ ¸å¯åŠ¨)ï¼Œç³»åˆ—ç¯‡ç ”ç©¶å¤šæ ¸å¯åŠ¨çš„æƒ…å†µã€‚ä»£ç å¯ç»“åˆ **(åå¤„ç†å™¨ç¯‡)** çœ‹æ›´å®¹æ˜“æ‡‚ã€‚

    reset_vector: //é¸¿è’™å¼€æœºä»£ç 
        /* clear register TPIDRPRW */
        mov     r0, #0					//r0 = 0
        mcr     p15, 0, r0, c13, c0, 4	//å¤ä½çº¿ç¨‹æ ‡è¯†ç¬¦å¯„å­˜å™¨TPIDRPRW , ä¸å¤ä½å°†å¯¼è‡´ç³»ç»Ÿä¸èƒ½å¯åŠ¨
        /* do some early cpu setup: i/d cache disable, mmu disabled */
        mrc     p15, 0, r0, c1, c0, 0	//System Control Register-SCTLR | è¯»å–ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨å†…å®¹
        bic     r0, #(1<<12)			//ç¦ç”¨æŒ‡ä»¤ç¼“å­˜åŠŸèƒ½
        bic     r0, #(1<<2 | 1<<0)		//ç¦ç”¨æ•°æ®å’ŒTLBçš„ç¼“å­˜åŠŸèƒ½(bit2) | mmuåŠŸèƒ½(bit0)
        mcr     p15, 0, r0, c1, c0, 0	//å†™ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨
    
        /* enable fpu+neon ä¸€äº›ç³»ç»Ÿå¯„å­˜å™¨çš„æ“ä½œ
        | ä½¿èƒ½æµ®ç‚¹è¿ç®—(floating point unit)å’Œ NEONå°±æ˜¯ä¸€ç§åŸºäºSIMDæ€æƒ³çš„ARMæŠ€æœ¯ï¼Œç›¸æ¯”äºARMv6æˆ–ä¹‹å‰çš„æ¶æ„ï¼Œ
        NEONç»“åˆäº†64-bitå’Œ128-bitçš„SIMDæŒ‡ä»¤é›†ï¼Œæä¾›128-bitå®½çš„å‘é‡è¿ç®—(vector operations)*/
    #ifndef LOSCFG_TEE_ENABLE        //Trusted Execution Environment   å¯ä¿¡æ‰§è¡Œç¯å¢ƒ
        MRC    p15, 0, r0, c1, c1, 2 //éå®‰å…¨æ¨¡å¼è®¿é—®å¯„å­˜å™¨ (Non-Secure Access Control Register - NSACR)
        ORR    r0, r0, #0xC00        //ä½¿èƒ½å®‰å…¨å’Œéå®‰å…¨è®¿é—®åå¤„ç†å™¨10å’Œ11(Coprocessor 10å’Œ11)
        BIC    r0, r0, #0xC000       //è®¾ç½®bit15ä¸º0ï¼Œä¸ä¼šå½±å“ä¿®æ”¹CPACR.ASEDISå¯„å­˜å™¨ä½ï¼ˆæ§åˆ¶Advanced SIMDåŠŸèƒ½ï¼‰| bit14 reserved
        MCR    p15, 0, r0, c1, c1, 2
    
        LDR    r0, =(0xF << 20)      //å…è®¸åœ¨EL0å’ŒEL1ä¸‹ï¼Œè®¿é—®åå¤„ç†å™¨10å’Œ11(æ§åˆ¶Floating-pointå’ŒAdvanced SIMDç‰¹æ€§)
        MCR    p15, 0, r0, c1, c0, 2
        ISB
    #endif
        MOV    r3, #0x40000000	    //EN, bit[30] è®¾ç½®FPEXCçš„ENä½æ¥ä½¿èƒ½FPU
        VMSR   FPEXC, r3			//æµ®ç‚¹å¼‚å¸¸æ§åˆ¶å¯„å­˜å™¨ (Floating-Point Exception Control register | B4.1.57) 
    
        /* r11: delta of physical address and virtual address | è®¡ç®—è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€ä¹‹é—´çš„å·®å€¼,ç›®çš„æ˜¯ä¸ºäº†å»ºç«‹æ˜ å°„å…³ç³»è¡¨ */
        adr     r11, pa_va_offset //è·å–pa_va_offsetå˜é‡ç‰©ç†åœ°å€ï¼Œç”±äºè¿™æ—¶å€™mmuå·²ç»è¢«å…³é—­ï¼Œæ‰€ä»¥è¿™ä¸ªå€¼å°±è¡¨ç¤ºpa_va_offsetå˜é‡çš„ç‰©ç†åœ°å€ã€‚
                                  /*adr æ˜¯ä¸€æ¡å°èŒƒå›´çš„åœ°å€è¯»å–ä¼ªæŒ‡ä»¤,å®ƒå°†åŸºäºPCçš„ç›¸å¯¹åç§»çš„åœ°å€å€¼è¯»åˆ°ç›®æ ‡å¯„å­˜å™¨ä¸­ã€‚
                                   *ç¼–è¯‘æºç¨‹åºæ—¶ï¼Œæ±‡ç¼–å™¨é¦–å…ˆè®¡ç®—å½“å‰PCå€¼ï¼ˆå½“å‰æŒ‡ä»¤ä½ç½®ï¼‰åˆ°experçš„è·ç¦»,ç„¶åç”¨ä¸€æ¡ADDæˆ–è€…SUBæŒ‡ä»¤æ›¿æ¢è¿™æ¡ä¼ªæŒ‡ä»¤ï¼Œ
                                   *ä¾‹å¦‚:ADD register,PC,#offset_to_exper æ³¨æ„ï¼Œæ ‡å·experä¸æŒ‡ä»¤å¿…é¡»åœ¨åŒä¸€ä»£ç æ®µ
                                   */
        ldr     r0, [r11]		  //r0 = *r11 è·å–pa_va_offsetå˜é‡è™šæ‹Ÿåœ°å€
        sub     r11, r11, r0	  //ç‰©ç†åœ°å€-è™šæ‹Ÿåœ°å€ = æ˜ å°„åç§»é‡ æ”¾å…¥r11
    
        mrc     p15, 0, r12, c0, c0, 5      /* Multiprocessor Affinity Register-MPIDR */
        and     r12, r12, #MPIDR_CPUID_MASK //æ©ç è¿‡æ»¤
        cmp     r12, #0	                    //ä¸»æ§æ ¸0åˆ¤æ–­
        bne     secondary_cpu_init	        //åˆå§‹åŒ–CPUæ¬¡æ ¸
    	/*
    	 * adræ˜¯å°èŒƒå›´çš„åœ°å€è¯»å–ä¼ªæŒ‡ä»¤,å®ƒå°†åŸºäºPCå¯„å­˜å™¨ç›¸å¯¹åç§»çš„åœ°å€å€¼è¯»å–åˆ°å¯„å­˜å™¨ä¸­ï¼Œ
    	 * ä¾‹å¦‚: 0x00000004 	 : adr     r4, __exception_handlers
    	 * åˆ™æ­¤æ—¶PCå¯„å­˜å™¨çš„å€¼ä¸º: 0x00000004 + 8(åœ¨ä¸‰çº§æµæ°´çº¿æ—¶,PCå’Œæ‰§è¡Œåœ°å€ç›¸å·®8)ï¼Œ
         * adræŒ‡ä»¤å’Œæ ‡è¯†__exception_handlersçš„åœ°å€ç›¸å¯¹å›ºå®šï¼ŒäºŒè€…åç§»é‡è‹¥ä¸ºoffset,
    	 * æœ€år4 = (0x00000004 + 8) + offset
    	*/
    
        /* if we need to relocate to proper location or not | å¦‚æœéœ€è¦é‡æ–°å®‰è£…åˆ°åˆé€‚çš„ä½ç½®*/
        adr     r4, __exception_handlers            /* r4: base of load address | åŠ è½½åŸºå€*/
        ldr     r5, =SYS_MEM_BASE                   /* r5: base of physical address | ç‰©ç†åŸºå€*/
        subs    r12, r4, r5                         /* r12: delta of load address and physical address | äºŒè€…åç§»é‡*/
        beq     reloc_img_to_bottom_done            /* if we load image at the bottom of physical address | ä¸ç›¸ç­‰å°±éœ€è¦é‡å®šä½ */
    	
        /* we need to relocate image at the bottom of physical address | éœ€è¦çŸ¥é“æ‹·è´çš„å¤§å°*/
        ldr     r7, =__exception_handlers           /* r7: base of linked address (or vm address) | é“¾æ¥åœ°å€åŸºåœ°å€*/
        ldr     r6, =__bss_start                    /* r6: end of linked address (or vm address)ï¼Œç”±äºç›®å‰é˜¶æ®µæœ‰ç”¨çš„æ•°æ®æ˜¯ä¸­æ–­å‘é‡è¡¨+ä»£ç æ®µ+åªè¯»æ•°æ®æ®µ+æ•°æ®æ®µï¼Œ
    											       æ‰€ä»¥åªéœ€å¤åˆ¶[__exception_handlers,__bss_start]è¿™æ®µæ•°æ®åˆ°å†…å­˜åŸºå€å¤„ */
        sub     r6, r7                              /* r6: delta of linked address (or vm address) | å†…æ ¸é•œåƒå¤§å° */
        add     r6, r4                              /* r6: end of load address | è¯´æ˜éœ€æ‹·è´[ r4,r4+r6 ] åŒºé—´å†…å®¹åˆ° [ r5,r5+r6 ]*/
    
    reloc_img_to_bottom_loop://é‡å®šä½é•œåƒåˆ°å†…æ ¸ç‰©ç†å†…å­˜åŸºåœ°å€,å°†å†…æ ¸ä»åŠ è½½åœ°å€æ‹·è´åˆ°å†…å­˜åŸºå€å¤„
        ldr     r7, [r4], #4	// ç±»ä¼¼Cè¯­è¨€ *r5 = *r4 , r4++ , r5++ 
        str     r7, [r5], #4	// #4 ä»£è¡¨32ä½çš„æŒ‡ä»¤é•¿åº¦,æ­¤æ—¶åœ¨æ‹·è´å†…æ ¸ä»£ç åŒºå†…å®¹
        cmp     r4, r6          /* æ‹·è´å®Œæˆæ¡ä»¶. r4++ ç›´åˆ°ç­‰äºr6 (åŠ è½½ç»“æŸåœ°å€) å®Œæˆæ‹·è´åŠ¨ä½œ */
        bne     reloc_img_to_bottom_loop
        sub     pc, r12                             /* é‡æ–°æ ¡å‡†pcå¯„å­˜å™¨, æ— ç¼è·³åˆ°äº†æ‹·è´åçš„æŒ‡ä»¤åœ°å€å¤„æ‰§è¡Œ r12æ˜¯é‡å®šä½é•œåƒå‰å†…æ ¸åŠ è½½åŸºåœ°å€å’Œå†…æ ¸ç‰©ç†å†…å­˜åŸºåœ°å€çš„å·®å€¼ */
        nop		// æ³¨æ„æ‰§è¡Œå®Œæˆsub       pc, r12å,æ–°çš„PCå¯„å­˜å™¨ä¹ŸæŒ‡å‘äº† 	nop ,nopæ˜¯ä¼ªæ±‡ç¼–æŒ‡ä»¤,ç­‰åŒäº mov r0 r0 é€šå¸¸ç”¨äºæ§åˆ¶æ—¶åºçš„ç›®çš„ï¼Œå¼ºåˆ¶å†…å­˜å¯¹é½ï¼Œé˜²æ­¢æµæ°´çº¿ç¾éš¾ï¼Œå æ®åˆ†æ”¯æŒ‡ä»¤å»¶è¿Ÿ						
        sub     r11, r11, r12                       /* r11: eventual address offset | æœ€ç»ˆåœ°å€æ˜ å°„åç§»é‡, ç”¨äºæ„å»ºMMUé¡µè¡¨ */
    //å†…æ ¸æ€»å¤§å° __bss_start - __exception_handlers
    reloc_img_to_bottom_done:
    #ifdef LOSCFG_KERNEL_MMU 
        ldr     r4, =g_firstPageTable               /* r4: physical address of translation table and clear it
    												   å†…æ ¸é¡µè¡¨æ˜¯ç”¨æ•°ç»„g_firstPageTableå­˜å‚¨ è§äºlos_arch_mmu.c */
        add     r4, r4, r11                         //è®¡ç®—g_firstPageTableé¡µè¡¨ç‰©ç†åœ°å€
        mov     r0, r4								//å› ä¸ºé»˜è®¤r0 å°†ä½œä¸ºmemset_optimizedçš„ç¬¬ä¸€ä¸ªå‚æ•°
        mov     r1, #0								//ç¬¬äºŒä¸ªå‚æ•°,æ¸…0
        mov     r2, #MMU_DESCRIPTOR_L1_SMALL_ENTRY_NUMBERS //ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯L1è¡¨çš„é•¿åº¦
        bl      memset_optimized                    /* optimized memset since r0 is 64-byte aligned | å°†å†…æ ¸é¡µè¡¨ç©ºé—´æ¸…é›¶*/
    
        ldr     r5, =g_archMmuInitMapping	        //è®°å½•æ˜ å°„å…³ç³»è¡¨
        add     r5, r5, r11                         //è·å–g_archMmuInitMappingçš„ç‰©ç†åœ°å€
    init_mmu_loop:	                                //åˆå§‹åŒ–å†…æ ¸é¡µè¡¨
        ldmia   r5!, {r6-r10}                       /* r6 = phys, r7 = virt, r8 = size, r9 = mmu_flags, r10 = name | ä¼ å‚: ç‰©ç†åœ°å€ã€è™šæ‹Ÿåœ°å€ã€æ˜ å°„å¤§å°ã€æ˜ å°„å±æ€§ã€åç§°*/
        cmp     r8, 0                               /* if size = 0, the mmu init done | å®Œæˆæ¡ä»¶ */
        beq     init_mmu_done		                //æ ‡å¿—å¯„å­˜å™¨ä¸­Zæ ‡å¿—ä½ç­‰äºé›¶æ—¶è·³è½¬åˆ° 	init_mmu_doneå¤„æ‰§è¡Œ
        bl      page_table_build	                //åˆ›å»ºé¡µè¡¨
        b       init_mmu_loop						//å¾ªç¯ç»§ç»­
    init_mmu_done:
        orr     r8, r4, #MMU_TTBRx_FLAGS            /* r8 = r4 and set cacheable attributes on translation walk | è®¾ç½®ç¼“å­˜*/
        ldr     r4, =g_mmuJumpPageTable             /* r4: jump pagetable vaddr | é¡µè¡¨è™šæ‹Ÿåœ°å€*/
        add     r4, r4, r11				
        ldr     r4, [r4]
        add     r4, r4, r11                         /* r4: jump pagetable paddr | é¡µè¡¨ç‰©ç†åœ°å€*/
    
        /* build 1M section mapping, in order to jump va during turing on mmu:pa == pa, va == pa */
        /* ä»å½“å‰PCå¼€å§‹å»ºç«‹1MBç©ºé—´çš„æ®µæ˜ å°„ï¼Œåˆ†åˆ«å»ºç«‹ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€æ–¹å¼çš„æ®µæ˜ å°„é¡µè¡¨é¡¹
         * å†…æ ¸ä¸´æ—¶é¡µè¡¨åœ¨ç³»ç»Ÿ ä½¿èƒ½mmu -> åˆ‡æ¢åˆ°è™šæ‹Ÿåœ°å€è¿è¡Œ è¿™æ®µæ—¶é—´ä½¿ç”¨
         */
        mov     r6, pc
        mov     r7, r6                              /* r7: pa (MB aligned)*/
        lsr     r6, r6, #20                         /* r6: pa l1 index */
        ldr     r10, =MMU_DESCRIPTOR_KERNEL_L1_PTE_FLAGS
        add     r12, r10, r6, lsl #20               /* r12: pa |flags */
        str     r12, [r4, r7, lsr #(20 - 2)]        /* jumpTable[paIndex] = pt entry */
        rsb     r7, r11, r6, lsl #20                /* r7: va */
        str     r12, [r4, r7, lsr #(20 - 2)]        /* jumpTable[vaIndex] = pt entry */
    
        bl      mmu_setup                           /* set up the mmu | å†…æ ¸æ˜ å°„è¡¨å·²ç»åˆ›å»ºå¥½äº†,æ­¤æ—¶å¯ä»¥å¯åŠ¨MMUå·¥ä½œäº†*/
    #endif
        /* clear out the interrupt and exception stack and set magic num to check the overflow 
        |exc_stack|åœ°å€é«˜ä½
        |svc_stack|åœ°å€ä½ä½
    	æ¸…é™¤ä¸­æ–­å’Œå¼‚å¸¸å †æ ˆå¹¶è®¾ç½®magic numæ£€æŸ¥æº¢å‡º */
        ldr     r0, =__svc_stack	    //stack_initçš„ç¬¬ä¸€ä¸ªå‚æ•° __svc_stackè¡¨ç¤ºæ ˆé¡¶
        ldr     r1, =__exc_stack_top	//stack_initçš„ç¬¬äºŒä¸ªå‚æ•° __exc_stack_topè¡¨ç¤ºæ ˆåº•, è¿™é‡Œä¼šæœ‰ç‚¹ç»•, topè¡¨é«˜åœ°å€ä½
        bl      stack_init              //åˆå§‹åŒ–å„ä¸ªcpuä¸åŒæ¨¡å¼ä¸‹çš„æ ˆç©ºé—´
    	//è®¾ç½®å„ä¸ªæ ˆé¡¶é­”æ³•æ•°å­—
        STACK_MAGIC_SET __svc_stack, #OS_EXC_SVC_STACK_SIZE, OS_STACK_MAGIC_WORD //ä¸­æ–­æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
        STACK_MAGIC_SET __exc_stack, #OS_EXC_STACK_SIZE, OS_STACK_MAGIC_WORD     //å¼‚å¸¸æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
    
    warm_reset: //çƒ­å¯åŠ¨ Warm Reset, warm reboot, soft reboot, åœ¨ä¸å…³é—­ç”µæºçš„æƒ…å†µï¼Œç”±è½¯ä»¶æ§åˆ¶é‡å¯è®¡ç®—æœº
        /* initialize CPSR (machine state register) */
        mov    r0, #(CPSR_IRQ_DISABLE|CPSR_FIQ_DISABLE|CPSR_SVC_MODE) /* ç¦æ­¢IRQä¸­æ–­ | ç¦æ­¢FIQä¸­æ–­ | ç®¡ç†æ¨¡å¼-æ“ä½œç³»ç»Ÿä½¿ç”¨çš„ä¿æŠ¤æ¨¡å¼ */
        msr    cpsr, r0	//è®¾ç½®CPSRå¯„å­˜å™¨
    
        /* Note: some functions in LIBGCC1 will cause a "restore from SPSR"!! */
        msr    spsr, r0 //è®¾ç½®SPSRå¯„å­˜å™¨
    
        /* get cpuid and keep it in r12 */
        mrc     p15, 0, r12, c0, c0, 5		//R12ä¿å­˜CPUID 
        and     r12, r12, #MPIDR_CPUID_MASK //æ©ç æ“ä½œè·å–å½“å‰cpu id
    
        /* set svc stack, every cpu has OS_EXC_SVC_STACK_SIZE stack | è®¾ç½® SVCæ ˆ */
        ldr    r0, =__svc_stack_top //æ³¨æ„è¿™æ˜¯æ ˆåº•,é«˜åœ°å€ä½
        mov    r2, #OS_EXC_SVC_STACK_SIZE //æ ˆå¤§å°
        mul    r2, r2, r12 
        sub    r0, r0, r2                   /* ç®—å‡ºå½“å‰coreçš„ä¸­æ–­æ ˆæ ˆé¡¶ä½ç½®ï¼Œå†™å…¥æ‰€å±coreçš„sp */
        mov    sp, r0
    
        LDR    r0, =__exception_handlers    
        MCR    p15, 0, r0, c12, c0, 0       /* Vector Base Address Register - VBAR */
    
        cmp    r12, #0						//CPUæ˜¯å¦ä¸ºä¸»æ ¸
        bne    cpu_start                    //ä¸ç›¸ç­‰å°±è·³åˆ°ä»æ ¸å¤„ç†åˆ†æ”¯
    
    clear_bss:	                            //ä¸»æ ¸å¤„ç†.bssæ®µæ¸…é›¶
        ldr    r0, =__bss_start
        ldr    r2, =__bss_end
        mov    r1, #0
        sub    r2, r2, r0
        bl     memset
    #if defined(LOSCFG_CC_STACKPROTECTOR_ALL) || \
        defined(LOSCFG_CC_STACKPROTECTOR_STRONG) || \
        defined(LOSCFG_CC_STACKPROTECTOR)
        bl     __stack_chk_guard_setup
    #endif
    
    #ifdef LOSCFG_GDB_DEBUG
        /* GDB_START - generate a compiled_breadk,This function will get GDB stubs started, with a proper environment */
        bl     GDB_START
        .word  0xe7ffdeff
    #endif
    
        bl     main                //å¸¦LRçš„å­ç¨‹åºè·³è½¬, LR = pc - 4, æ‰§è¡ŒCå±‚mainå‡½æ•°    
    

**è§£è¯»**

*   **ç¬¬ä¸€æ­¥ï¼š** æ“ä½œ **CP15** åå¤„ç†å™¨ **TPIDRPRW** å¯„å­˜å™¨ï¼Œå®ƒè¢« **ARM** è®¾è®¡ä¿å­˜å½“å‰è¿è¡Œçº¿ç¨‹çš„ **ID**å€¼ï¼Œåœ¨**ARMv7** æ¶æ„ä¸­æ‰æ–°å‡ºç°ï¼Œéœ€**PL1**æƒé™ä»¥ä¸Šæ‰èƒ½è®¿é—®ï¼Œè€Œç¡¬ä»¶ä¸ä¼šä»å†…éƒ¨å»æ”¹å˜å®ƒçš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªç›´æ¥æš´éœ²ç»™å·¥ç¨‹å¸ˆæ“ä½œç»´æŠ¤çš„ä¸€ä¸ªå¯„å­˜å™¨ï¼Œåœ¨é¸¿è’™å†…æ ¸ä¸­è¢«ç”¨äºè®°å½•çº¿ç¨‹ç»“æ„ä½“çš„å¼€å§‹åœ°å€ï¼Œå¯ä»¥æœç´¢ **OsCurrTaskSet** æ¥è·Ÿè¸ªå“ªäº›åœ°æ–¹ä¼šåˆ‡æ¢å½“å‰ä»»åŠ¡ä»¥ä¾¿æ›´å¥½çš„ç†è§£å†…æ ¸ã€‚
    
*   **ç¬¬äºŒæ­¥ï¼š** ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ï¼ˆ**SCTLR**ï¼‰ï¼Œ**B4.1.130 SCTLR, System Control Register** å®ƒæä¾›äº†ç³»ç»Ÿçš„æœ€é«˜çº§åˆ«æ§åˆ¶ï¼Œé«˜åˆ°äº†ç‰çš‡å¤§å¸çº§åˆ«ï¼Œä»£ç ä¸­å°† `0`ã€`2`ã€`12`ä½å†™ `0`ã€‚å¯¹åº”å…³é—­ **MMU** ã€**æ•°æ®ç¼“å­˜** ã€**æŒ‡ä»¤ç¼“å­˜** åŠŸèƒ½ã€‚
    
*   **ç¬¬ä¸‰æ­¥ï¼š** å¯¹æµ®ç‚¹è¿ç®—`FPU`çš„è®¾ç½®ï¼Œåœ¨å®‰å…¨æ¨¡å¼ä¸‹ä½¿ç”¨`FPU`ï¼Œé¡»å®šä¹‰`NSACR`ã€`CPACR`ã€`FPEXC` ä¸‰ä¸ªå¯„å­˜å™¨
    
*   **ç¬¬å››æ­¥ï¼š** è®¡ç®—è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€çš„åç§»é‡ï¼Œä¸ºä½•è¦è®¡ç®—å®ƒå‘¢ ? ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å»ºç«‹è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»ï¼Œå› ä¸ºåœ¨ MMUå¯åŠ¨ä¹‹åï¼Œè¿è¡Œåœ°å€(PCå¯„å­˜å™¨æŒ‡å‘çš„åœ°å€)å°†å˜æˆè™šæ‹Ÿåœ°å€ï¼Œä½¿ç”¨è™šæ‹Ÿåœ°å€å°±ç¦»ä¸å¼€æ˜ å°„è¡¨ï¼Œæ‰€ä»¥ä¸¤ä¸ªåœ°å€çš„æ˜ å°„å…³ç³»éœ€è¦åœ¨MMUå¯åŠ¨å‰å°±åˆ›å»ºå¥½ï¼Œè€Œæœ‰äº†åç§»é‡å°±å¯ä»¥åˆ›å»ºæ˜ å°„è¡¨ã€‚ä½†éœ€å…ˆææ¸…æ¥š **é“¾æ¥åœ°å€** å’Œ **è¿è¡Œåœ°å€** ä¸¤ä¸ªæ¦‚å¿µã€‚
    
    *   **é“¾æ¥åœ°å€** ç”±é“¾æ¥å™¨ç¡®å®šï¼Œé“¾æ¥å™¨ä¼šå°†æ‰€æœ‰è¾“å…¥çš„ **.o** æ–‡ä»¶é“¾æ¥æˆä¸€ä¸ªæ ¼å¼çš„ **.bin** æ–‡ä»¶ï¼Œå®ƒä»¬éƒ½æ˜¯**ELF**æ ¼å¼, é“¾æ¥å™¨ç»™æ¯æ¡æŒ‡ä»¤/æ•°æ®éƒ½èµ‹ä¸ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å«**é“¾æ¥åœ°å€**ï¼Œå®ƒå¯ä»¥æ˜¯ç›¸å¯¹çš„ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹çš„ã€‚ä½†å®ƒä»¬ä¹‹é—´çš„å†…éƒ¨è·ç¦»æ˜¯å›ºå®šçš„ï¼Œé“¾æ¥å…·ä½“è¿‡ç¨‹å¯ç¿»çœ‹ **(é‡å®šä½ç¯‡)** å’Œ **(é“¾æ¥è„šæœ¬ç¯‡)**
    *   **è¿è¡Œåœ°å€** ç”±åŠ è½½å™¨ç¡®å®šï¼Œå†…æ ¸é•œåƒé¦–å…ˆé€šè¿‡çƒ§å½•å·¥å…·å°†å†…æ ¸çƒ§å½•åˆ° **flash** æŒ‡å®šçš„ä½ç½®ï¼Œå¼€æœºåç”±**boot loader**å·¥å…·ï¼Œä¾‹å¦‚**uboot**ï¼Œå°†å†…æ ¸é•œåƒåŠ è½½åˆ°æŒ‡å®šåœ°å€åå¼€å§‹æ‰§è¡ŒçœŸæ­£çš„å†…æ ¸ä»£ç ï¼Œè¿™ä¸ªåœ°å€å«**è¿è¡Œåœ°å€**ã€‚
    
    ä¸¤ä¸ªåœ°å€å¾€å¾€ä¸ä¸€æ ·ï¼Œè€Œå†…æ ¸è®¾è®¡è€…å¸Œæœ›å®ƒä»¬æ˜¯ä¸€æ ·çš„ï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•æ£€æµ‹äºŒè€…æ˜¯å¦ä¸€æ ·å‘¢? ç­”æ¡ˆæ˜¯ : **å½“ç„¶æœ‰çš„** ï¼Œé€šè¿‡ä¸€ä¸ªå˜é‡åœ¨é“¾æ¥æ—¶å°†å…¶é“¾æ¥åœ°å€å˜æˆå˜é‡çš„å†…å®¹ ï¼Œæ— è®ºä¸­é—´æ€ä¹ˆåŠ è½½å˜é‡çš„å†…å®¹æ˜¯ä¸ä¼šå˜çš„ï¼Œè€Œè·å–è¿è¡Œåœ°å€æ˜¯å¾ˆå®¹æ˜“è·å–çš„ï¼Œå…¶å®å°±æ˜¯PCå¯„å­˜å™¨çš„åœ°å€ï¼ŒäºŒè€…ä¸€å‡ï¼ŒåŠ è½½åäº†å¤šå°‘ä¸å°±å‡ºæ¥äº†
    
        pa_va_offset:	
          .word   . //å®šä¹‰ä¸€ä¸ª4å­—èŠ‚çš„pa_va_offset å˜é‡ï¼Œ é“¾æ¥å™¨ç”Ÿæˆä¸€ä¸ªé“¾æ¥åœ°å€ï¼Œ . è¡¨ç¤º pa_va_offset = é“¾æ¥åœ°å€ ä¸¾ä¾‹: åœ¨åœ°å€ 0x17321796 ä¸­ä¿å­˜äº† 0x17321796 å€¼
        
        adr     r11, pa_va_offset //ä»£ç å·²æ‰§è¡Œè‡³æ­¤ï¼ŒæŒ‡ä»¤å°†è·å– pa_va_offset çš„è¿è¡Œåœ°å€(å¯èƒ½ä¸æ˜¯`0x17321796`) ç»™r11
        ldr     r0, [r11] // [r11]ä¸­å­˜çš„æ˜¯é“¾æ¥åœ°å€ `0x17321796`, å®ƒä¸ä¼šéšåŠ è½½å™¨å˜åŒ–çš„
        sub     r11, r11, r0 // äºŒè€…ç›¸å‡å¾—åˆ°äº†åç§»åœ°å€
        
    
*   **ç¬¬äº”æ­¥ï¼š** å°†å†…æ ¸ä»£ç ä» **\_\_exception\_handlers** å¤„ç§»åˆ° **SYS\_MEM\_BASE**å¤„,é•¿åº¦æ˜¯ **\_\_bss\_start - \_\_exception\_handlers** , **\_\_exception\_handlers**æ˜¯åŠ è½½åçš„å¼€å§‹åœ°å€, ç”±åŠ è½½å™¨å†³å®š, è€Œ**SYS\_MEM\_BASE** æ˜¯ç³»ç»Ÿå®šä¹‰çš„å†…å­˜åœ°å€, å¯ç”±ç³»ç»Ÿé›†æˆå•†æŒ‡å®šé…ç½®, ä»–ä»¬å¸Œæœ›å†…æ ¸ä»è¿™é‡Œè¿è¡Œã€‚ ä¸‹å›¾ä¸ºå†…æ ¸é•œåƒå¸ƒå±€  
    ![](https://weharmonyos.oss-cn-hangzhou.aliyuncs.com/resources/78/bbs.png)  
    å…·ä½“ä»£ç å¦‚ä¸‹:
    
            /* if we need to relocate to proper location or not | å¦‚æœéœ€è¦é‡æ–°å®‰è£…åˆ°åˆé€‚çš„ä½ç½®*/
          adr     r4, __exception_handlers            /* r4: base of load address | åŠ è½½åŸºå€*/
          ldr     r5, =SYS_MEM_BASE                   /* r5: base of physical address | ç‰©ç†åŸºå€*/
          subs    r12, r4, r5                         /* r12: delta of load address and physical address | äºŒè€…åç§»é‡*/
          beq     reloc_img_to_bottom_done            /* if we load image at the bottom of physical address | ä¸ç›¸ç­‰å°±éœ€è¦é‡å®šä½ */
          
          /* we need to relocate image at the bottom of physical address | éœ€è¦çŸ¥é“æ‹·è´çš„å¤§å°*/
          ldr     r7, =__exception_handlers           /* r7: base of linked address (or vm address) | é“¾æ¥åœ°å€åŸºåœ°å€*/
          ldr     r6, =__bss_start                    /* r6: end of linked address (or vm address)ï¼Œç”±äºç›®å‰é˜¶æ®µæœ‰ç”¨çš„æ•°æ®æ˜¯ä¸­æ–­å‘é‡è¡¨+ä»£ç æ®µ+åªè¯»æ•°æ®æ®µ+æ•°æ®æ®µï¼Œ
          										       æ‰€ä»¥åªéœ€å¤åˆ¶[__exception_handlers,__bss_start]è¿™æ®µæ•°æ®åˆ°å†…å­˜åŸºå€å¤„ */
          sub     r6, r7                              /* r6: delta of linked address (or vm address) | å†…æ ¸é•œåƒå¤§å° */
          add     r6, r4                              /* r6: end of load address | è¯´æ˜éœ€æ‹·è´[ r4,r4+r6 ] åŒºé—´å†…å®¹åˆ° [ r5,r5+r6 ]*/
        
          reloc_img_to_bottom_loop://é‡å®šä½é•œåƒåˆ°å†…æ ¸ç‰©ç†å†…å­˜åŸºåœ°å€,å°†å†…æ ¸ä»åŠ è½½åœ°å€æ‹·è´åˆ°å†…å­˜åŸºå€å¤„
              ldr     r7, [r4], #4	// ç±»ä¼¼Cè¯­è¨€ *r5 = *r4 , r4++ , r5++ 
              str     r7, [r5], #4	// #4 ä»£è¡¨32ä½çš„æŒ‡ä»¤é•¿åº¦,æ­¤æ—¶åœ¨æ‹·è´å†…æ ¸ä»£ç åŒºå†…å®¹
              cmp     r4, r6          /* æ‹·è´å®Œæˆæ¡ä»¶. r4++ ç›´åˆ°ç­‰äºr6 (åŠ è½½ç»“æŸåœ°å€) å®Œæˆæ‹·è´åŠ¨ä½œ */
              bne     reloc_img_to_bottom_loop
              sub     pc, r12                             /* é‡æ–°æ ¡å‡†pcå¯„å­˜å™¨, æ— ç¼è·³åˆ°äº†æ‹·è´åçš„æŒ‡ä»¤åœ°å€å¤„æ‰§è¡Œ r12æ˜¯é‡å®šä½é•œåƒå‰å†…æ ¸åŠ è½½åŸºåœ°å€å’Œå†…æ ¸ç‰©ç†å†…å­˜åŸºåœ°å€çš„å·®å€¼ */
              nop		// æ³¨æ„æ‰§è¡Œå®Œæˆsub       pc, r12å,æ–°çš„PCå¯„å­˜å™¨ä¹ŸæŒ‡å‘äº† 	nop ,nopæ˜¯ä¼ªæ±‡ç¼–æŒ‡ä»¤,ç­‰åŒäº mov r0 r0 é€šå¸¸ç”¨äºæ§åˆ¶æ—¶åºçš„ç›®çš„ï¼Œå¼ºåˆ¶å†…å­˜å¯¹é½ï¼Œé˜²æ­¢æµæ°´çº¿ç¾éš¾ï¼Œå æ®åˆ†æ”¯æŒ‡ä»¤å»¶è¿Ÿ						
              sub     r11, r11, r12                       /* r11: eventual address offset | æœ€ç»ˆåœ°å€åç§»é‡ */
        
    
*   **ç¬¬å…­æ­¥ï¼š** åœ¨æ‰“å¼€MMUå¿…é¡»è¦åšå¥½è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³» , éœ€æ„å»ºé¡µè¡¨ , å…³äºé¡µè¡¨å¯ç¿»çœ‹ **è™šå®æ˜ å°„ç¯‡**, å…·ä½“ä»£ç å¦‚ä¸‹
    
        #ifdef LOSCFG_KERNEL_MMU 
        ldr     r4, =g_firstPageTable               /* r4: physical address of translation table and clear it
        											   å†…æ ¸é¡µè¡¨æ˜¯ç”¨æ•°ç»„g_firstPageTableå­˜å‚¨ è§äºlos_arch_mmu.c */
        add     r4, r4, r11                         //è®¡ç®—g_firstPageTableé¡µè¡¨ç‰©ç†åœ°å€
        mov     r0, r4								//å› ä¸ºé»˜è®¤r0 å°†ä½œä¸ºmemset_optimizedçš„ç¬¬ä¸€ä¸ªå‚æ•°
        mov     r1, #0								//ç¬¬äºŒä¸ªå‚æ•°,æ¸…0
        mov     r2, #MMU_DESCRIPTOR_L1_SMALL_ENTRY_NUMBERS //ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯L1è¡¨çš„é•¿åº¦
        bl      memset_optimized                    /* optimized memset since r0 is 64-byte aligned | å°†å†…æ ¸é¡µè¡¨ç©ºé—´æ¸…é›¶*/
        
        ldr     r5, =g_archMmuInitMapping	        //è®°å½•æ˜ å°„å…³ç³»è¡¨
        add     r5, r5, r11                         //è·å–g_archMmuInitMappingçš„ç‰©ç†åœ°å€
        init_mmu_loop:	                                //åˆå§‹åŒ–å†…æ ¸é¡µè¡¨
            ldmia   r5!, {r6-r10}                       /* r6 = phys, r7 = virt, r8 = size, r9 = mmu_flags, r10 = name | ç‰©ç†åœ°å€ã€è™šæ‹Ÿåœ°å€ã€æ˜ å°„å¤§å°ã€æ˜ å°„å±æ€§ã€åç§°*/
            cmp     r8, 0                               /* if size = 0, the mmu init done */
            beq     init_mmu_done		                //æ ‡å¿—å¯„å­˜å™¨ä¸­Zæ ‡å¿—ä½ç­‰äºé›¶æ—¶è·³è½¬åˆ° 	init_mmu_doneå¤„æ‰§è¡Œ
            bl      page_table_build	                //åˆ›å»ºé¡µè¡¨
            b       init_mmu_loop						//å¾ªç¯ç»§ç»­
        init_mmu_done:
            orr     r8, r4, #MMU_TTBRx_FLAGS            /* r8 = r4 and set cacheable attributes on translation walk | è®¾ç½®ç¼“å­˜*/
            ldr     r4, =g_mmuJumpPageTable             /* r4: jump pagetable vaddr | é¡µè¡¨è™šæ‹Ÿåœ°å€*/
            add     r4, r4, r11				
            ldr     r4, [r4]
            add     r4, r4, r11                         /* r4: jump pagetable paddr | é¡µè¡¨ç‰©ç†åœ°å€*/
        
            /* build 1M section mapping, in order to jump va during turing on mmu:pa == pa, va == pa */
            /* ä»å½“å‰PCå¼€å§‹å»ºç«‹1MBç©ºé—´çš„æ®µæ˜ å°„ï¼Œåˆ†åˆ«å»ºç«‹ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€æ–¹å¼çš„æ®µæ˜ å°„é¡µè¡¨é¡¹
            * å†…æ ¸ä¸´æ—¶é¡µè¡¨åœ¨ç³»ç»Ÿ ä½¿èƒ½mmu -> åˆ‡æ¢åˆ°è™šæ‹Ÿåœ°å€è¿è¡Œ è¿™æ®µæ—¶é—´ä½¿ç”¨
            */
            mov     r6, pc
            mov     r7, r6                              /* r7: pa (MB aligned)*/
            lsr     r6, r6, #20                         /* r6: pa l1 index */
            ldr     r10, =MMU_DESCRIPTOR_KERNEL_L1_PTE_FLAGS
            add     r12, r10, r6, lsl #20               /* r12: pa |flags */
            str     r12, [r4, r7, lsr #(20 - 2)]        /* jumpTable[paIndex] = pt entry */
            rsb     r7, r11, r6, lsl #20                /* r7: va */
            str     r12, [r4, r7, lsr #(20 - 2)]        /* jumpTable[vaIndex] = pt entry */
        
            bl      mmu_setup                           /* set up the mmu | å†…æ ¸æ˜ å°„è¡¨å·²ç»åˆ›å»ºå¥½äº†,æ­¤æ—¶å¯ä»¥å¯åŠ¨MMUå·¥ä½œäº†*/
        #endif
        
    
*   **ç¬¬ä¸ƒæ­¥ï¼š** ä½¿èƒ½MMU, æœ‰äº†é¡µè¡¨å°±å¯ä»¥ä½¿ç”¨è™šæ‹Ÿåœ°å€äº†
    
        mmu_setup:	//å¯åŠ¨MMUå·¥ä½œ
            mov     r12, #0                             /* TLB Invalidate All entries - TLBIALL */
            mcr     p15, 0, r12, c8, c7, 0              /* Set c8 to control the TLB and set the mapping to invalid */
            isb
            mcr     p15, 0, r12, c2, c0, 2              /* Translation Table Base Control Register(TTBCR) = 0x0
                                                        [31] :0 - Use the 32-bit translation system(è™šæ‹Ÿåœ°å€æ˜¯32ä½)
                                                        [5:4]:0 - use TTBR0å’ŒTTBR1
                                                        [2:0]:0 - TTBCR.Nä¸º0ï¼›
                                                        ä¾‹å¦‚ï¼šTTBCR.Nä¸º0ï¼ŒTTBR0[31:14-0] | VA[31-0:20] | descriptor-type[1:0]ç»„æˆ32ä½é¡µè¡¨æè¿°ç¬¦çš„åœ°å€,
                                                                VA[31:20]å¯ä»¥è¦†ç›–4GBçš„åœ°å€ç©ºé—´ï¼Œæ‰€ä»¥TTBR0é¡µè¡¨æ˜¯16KBï¼Œä¸ä½¿ç”¨TTBR1;
                                                        ä¾‹å¦‚ï¼šTTBCR.Nä¸º1ï¼ŒTTBR0[31:14-1] | VA[31-1:20] | descriptor-type[1:0]ç»„æˆ32ä½é¡µè¡¨æè¿°ç¬¦çš„åœ°å€,
                                                                VA[30:20]å¯ä»¥è¦†ç›–2GBçš„åœ°å€ç©ºé—´ï¼Œæ‰€ä»¥TTBR0é¡µè¡¨æ˜¯8KBï¼ŒTTBR1é¡µè¡¨æ˜¯8KB(é¡µè¡¨åœ°å€å¿…é¡»16KBå¯¹é½);
                                                        */
            isb
            orr     r12, r4, #MMU_TTBRx_FLAGS			//å°†ä¸´æ—¶é¡µè¡¨å±æ€§[6:0]å’ŒåŸºåœ°å€[31:14]æ”¾åˆ°r12
            mcr     p15, 0, r12, c2, c0, 0              /* Set attributes and set temp page table */
            isb
            mov     r12, #0x7                           /* 0b0111 */
            mcr     p15, 0, r12, c3, c0, 0              /* Set DACR with 0b0111, client and manager domian */
            isb
            mrc    p15, 0, r12, c1, c0, 1               /* ACTLR, Auxlliary Control Register */
            orr    r12, r12, #(1 << 6)                  /* SMP, Enables coherent requests to the processor. */
            orr    r12, r12, #(1 << 2)                  /* Enable D-side prefetch */
            orr    r12, r12, #(1 << 11)                 /* Global BP Enable bit */
            mcr    p15, 0, r12, c1, c0, 1               /* ACTLR, Auxlliary Control Register */
            dsb
            /*
            * å¼€å§‹ä½¿èƒ½MMUï¼Œä½¿ç”¨çš„æ˜¯å†…æ ¸ä¸´æ—¶é¡µè¡¨ï¼Œè¿™æ—¶cpuè®¿é—®å†…å­˜ä¸ç®¡æ˜¯å–æŒ‡ä»¤è¿˜æ˜¯è®¿é—®æ•°æ®éƒ½æ˜¯éœ€è¦ç»è¿‡mmuæ¥ç¿»è¯‘ï¼Œ
            * ä½†æ˜¯åœ¨mmuä½¿èƒ½ä¹‹å‰cpuä½¿ç”¨çš„éƒ½æ˜¯å†…æ ¸çš„ç‰©ç†åœ°å€ï¼Œå³ä½¿ç°åœ¨ä½¿èƒ½äº†mmuï¼Œcpuè®¿é—®çš„åœ°å€å€¼è¿˜æ˜¯å†…æ ¸çš„ç‰©ç†åœ°å€å€¼(è¿™é‡Œä»…ä»…ä»æ•°å€¼ä¸Šæ¥çœ‹)ï¼Œ
            * è€Œåˆç”±äºmmuä½¿èƒ½äº†ï¼Œæ‰€ä»¥cpuä¼šæŠŠè¿™ä¸ªå€¼å½“åšè™šæ‹Ÿåœ°å€çš„å€¼åˆ°é¡µè¡¨ä¸­å»æ‰¾å…¶å¯¹åº”çš„ç‰©ç†åœ°å€æ¥è®¿é—®ã€‚
            * æ‰€ä»¥ç°åœ¨æ˜ç™½äº†ä¸ºä»€ä¹ˆè¦åœ¨å†…æ ¸ä¸´æ—¶é¡µè¡¨é‡Œå»ºç«‹ä¸€ä¸ªå†…æ ¸ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€ä¸€ä¸€æ˜ å°„çš„é¡µè¡¨é¡¹äº†å§ï¼Œå› ä¸ºå»ºç«‹äº†ä¸€ä¸€æ˜ å°„ï¼Œ
            * cpuè®¿é—®çš„åœ°å€ç»è¿‡mmuç¿»è¯‘å¾—åˆ°çš„è¿˜æ˜¯å’ŒåŸæ¥ä¸€æ ·çš„å€¼ï¼Œè¿™æ ·åœ¨cpuçœŸæ­£ä½¿ç”¨è™šæ‹Ÿåœ°å€ä¹‹å‰ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚
            */
            mrc     p15, 0, r12, c1, c0, 0
            bic     r12, #(1 << 29 | 1 << 28)           /* disable access flag[bit29]ï¼Œap[0]æ˜¯è®¿é—®æƒé™ä½ï¼Œæ”¯æŒå…¨éƒ¨çš„è®¿é—®æƒé™ç±»å‹
                                                        disable TEX remap[bit28]ï¼Œä½¿ç”¨TEX[2:0]ä¸C Bbitæ§åˆ¶memory regionå±æ€§ */
            orr     r12, #(1 << 0)                      /* mmu enable */
            bic     r12, #(1 << 1)
            orr     r12, #(1 << 2)                     /* D cache enable */
            orr     r12, #(1 << 12)                    /* I cache enable */
            mcr     p15, 0, r12, c1, c0, 0              /* Set SCTLR with r12: Turn on the MMU, I/D cache Disable TRE/AFE */
            isb
            ldr     pc,  =1f                            /* Convert to VA | 1è¡¨ç¤ºæ ‡å·ï¼Œfè¡¨ç¤ºforward(å¾€ä¸‹) - pcå€¼å–å¾€ä¸‹æ ‡è¯†ç¬¦â€œ1â€çš„è™šæ‹Ÿåœ°å€(è·³è½¬åˆ°æ ‡è¯†ç¬¦â€œ1â€å¤„)
                                                        å› ä¸ºä¹‹å‰å·²ç»åœ¨å†…æ ¸ä¸´æ—¶é¡µè¡¨ä¸­å»ºç«‹äº†å†…æ ¸è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥cpuåˆ‡æ¢åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´ */
            1:
                mcr     p15, 0, r8, c2, c0, 0               /* Go to the base address saved in C2: Jump to the page table */
                isb                                         //r8ä¸­ä¿å­˜çš„æ˜¯å†…æ ¸L1é¡µè¡¨åŸºåœ°å€å’Œflagsï¼Œr8å†™å…¥åˆ°TTBR0å®ç°ä¸´æ—¶é¡µè¡¨å’Œå†…æ ¸é¡µè¡¨çš„åˆ‡æ¢
                mov     r12, #0
                mcr     p15, 0, r12, c8, c7, 0              /* TLB Invalidate All entries - TLBIALL(Invalidate all EL1&0 regime stage 1 and 2 TLB entries) */
                isb
                sub     lr,  r11                            /* adjust lr with delta of physical address and virtual address | 
                                                            lrä¸­ä¿å­˜çš„æ˜¯mmuä½¿èƒ½ä¹‹å‰è¿”å›åœ°å€çš„ç‰©ç†åœ°å€å€¼ï¼Œè¿™æ—¶éœ€è¦è½¬æ¢ä¸ºè™šæ‹Ÿåœ°å€ï¼Œè½¬æ¢ç®—æ³•ä¹Ÿå¾ˆç®€å•ï¼Œè™šæ‹Ÿåœ°å€ = ç‰©ç†åœ°å€ - r11 */
                bx      lr                                  //è¿”å›
        
    
*   **ç¬¬å…«æ­¥ï¼š** è®¾ç½®å¼‚å¸¸å’Œä¸­æ–­æ ˆ ï¼Œåˆå§‹åŒ–æ ˆå†…å€¼å’Œæ ˆé¡¶å€¼
    
        //åˆå§‹åŒ–æ ˆå†…å€¼
            ldr     r0, =__svc_stack	    //stack_initçš„ç¬¬ä¸€ä¸ªå‚æ•° __svc_stackè¡¨ç¤ºæ ˆé¡¶
            ldr     r1, =__exc_stack_top	//stack_initçš„ç¬¬äºŒä¸ªå‚æ•° __exc_stack_topè¡¨ç¤ºæ ˆåº•, è¿™é‡Œä¼šæœ‰ç‚¹ç»•, topè¡¨é«˜åœ°å€ä½
            bl      stack_init              //åˆå§‹åŒ–å„ä¸ªcpuä¸åŒæ¨¡å¼ä¸‹çš„æ ˆç©ºé—´
            //è®¾ç½®å„ä¸ªæ ˆé¡¶é­”æ³•æ•°å­—
            STACK_MAGIC_SET __svc_stack, #OS_EXC_SVC_STACK_SIZE, OS_STACK_MAGIC_WORD //ä¸­æ–­æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
            STACK_MAGIC_SET __exc_stack, #OS_EXC_STACK_SIZE, OS_STACK_MAGIC_WORD     //å¼‚å¸¸æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
        stack_init:
            ldr     r2, =OS_STACK_INIT	//0xCACACACA
            ldr     r3, =OS_STACK_INIT
            /* Main loop sets 32 bytes at a time. | ä¸»å¾ªç¯ä¸€æ¬¡è®¾ç½® 32 ä¸ªå­—èŠ‚*/
        stack_init_loop:
            .irp    offset, #0, #8, #16, #24
            strd    r2, r3, [r0, \offset]    /* ç­‰ä»·äºstrd r2, r3, [r0, 0], strd r2, r3, [r0, 8], ... , strd r2, r3, [r0, 24] */
            .endr
            add     r0, #32			//åŠ è·³32ä¸ªå­—èŠ‚,è¯´æ˜åœ¨åœ°å€èŒƒå›´ä¸Š r1 > r0 ==> __exc_stack_top > __svc_stack
            cmp     r0, r1			//æ˜¯å¦åˆ°æ ˆåº•
            blt     stack_init_loop
            bx      lr
        
        
    
        //åˆå§‹åŒ–æ ˆé¡¶å€¼
        excstack_magic:
            mov     r3, #0 //r3 = 0
        excstack_magic_loop:
            str     r2, [r0]   //æ ˆé¡¶è®¾ç½®é­”æ³•æ•°å­—
            add     r0, r0, r1 //å®šä½åˆ°æ ˆåº•
            add     r3, r3, #1 //r3++
            cmp     r3, #CORE_NUM //æ ˆç©ºé—´ç­‰åˆ†æˆcore_numä¸ªç©ºé—´ï¼Œæ‰€ä»¥æ¯ä¸ªcoreçš„æ ˆé¡¶éœ€è¦magic num
            blt     excstack_magic_loop
            bx      lr
        /* param0 is stack top, param1 is stack size, param2 is magic num */
        .macro STACK_MAGIC_SET param0, param1, param2
            ldr     r0, =\param0
            mov     r1, \param1
            ldr     r2, =\param2
            bl      excstack_magic
        .endm
        STACK_MAGIC_SET __svc_stack, #OS_EXC_SVC_STACK_SIZE, OS_STACK_MAGIC_WORD //ä¸­æ–­æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
        STACK_MAGIC_SET __exc_stack, #OS_EXC_STACK_SIZE, OS_STACK_MAGIC_WORD     //å¼‚å¸¸æ ˆåº•è®¾æˆ"çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«"
        
    
*   **ç¬¬ä¹æ­¥ï¼š** çƒ­å¯åŠ¨
    
        warm_reset: //çƒ­å¯åŠ¨ Warm Reset, warm reboot, soft reboot, åœ¨ä¸å…³é—­ç”µæºçš„æƒ…å†µï¼Œç”±è½¯ä»¶æ§åˆ¶é‡å¯è®¡ç®—æœº
          /* initialize CPSR (machine state register) */
          mov    r0, #(CPSR_IRQ_DISABLE|CPSR_FIQ_DISABLE|CPSR_SVC_MODE) /* ç¦æ­¢IRQä¸­æ–­ | ç¦æ­¢FIQä¸­æ–­ | ç®¡ç†æ¨¡å¼-æ“ä½œç³»ç»Ÿä½¿ç”¨çš„ä¿æŠ¤æ¨¡å¼ */
          msr    cpsr, r0
        
          /* Note: some functions in LIBGCC1 will cause a "restore from SPSR"!! */
          msr    spsr, r0
        
          /* get cpuid and keep it in r12 */
          mrc     p15, 0, r12, c0, c0, 5		//R12ä¿å­˜CPUID 
          and     r12, r12, #MPIDR_CPUID_MASK //æ©ç æ“ä½œè·å–å½“å‰cpu id
        
          /* set svc stack, every cpu has OS_EXC_SVC_STACK_SIZE stack */
          ldr    r0, =__svc_stack_top
          mov    r2, #OS_EXC_SVC_STACK_SIZE
          mul    r2, r2, r12
          sub    r0, r0, r2                   /* ç®—å‡ºå½“å‰coreçš„ä¸­æ–­æ ˆæ ˆé¡¶ä½ç½®ï¼Œå†™å…¥æ‰€å±coreçš„sp */
          mov    sp, r0
        
          LDR    r0, =__exception_handlers
          MCR    p15, 0, r0, c12, c0, 0       /* Vector Base Address Register - VBAR */
        
          cmp    r12, #0
          bne    cpu_start                    //ä»æ ¸å¤„ç†åˆ†æ”¯
        
    
*   **ç¬¬åæ­¥ï¼š** è¿›å…¥ C è¯­è¨€çš„ **main()**
    
        bl     main                //å¸¦LRçš„å­ç¨‹åºè·³è½¬, LR = pc - 4, æ‰§è¡ŒCå±‚mainå‡½æ•°
        
        LITE_OS_SEC_TEXT_INIT INT32 main(VOID)//ç”±ä¸»CPUæ‰§è¡Œ,é»˜è®¤0å·CPU ä¸ºä¸»CPU 
          {
              UINT32 ret = OsMain();
              if (ret != LOS_OK) {
                  return (INT32)LOS_NOK;
              }
        
              CPU_MAP_SET(0, OsHwIDGet());//è®¾ç½®CPUæ˜ å°„,å‚æ•°0 ä»£è¡¨0å·CPU
        
              OsSchedStart();//è°ƒåº¦å¼€å§‹
        
              while (1) {
                  __asm volatile("wfi");//WFI: wait for Interrupt ç­‰å¾…ä¸­æ–­ï¼Œå³ä¸‹ä¸€æ¬¡ä¸­æ–­å‘ç”Ÿå‰éƒ½åœ¨æ­¤holdä½ä¸å¹²æ´»
              }
          }
        
    

### ç™¾æ–‡è¯´å†…æ ¸ | æŠ“ä½ä¸»è„‰ç»œ

*   ç™¾æ–‡ç›¸å½“äºæ‘¸å‡ºå†…æ ¸çš„è‚Œè‚‰å’Œå™¨å®˜ç³»ç»Ÿï¼Œè®©äººå¼€å§‹ä¸°æ»¡æœ‰ç«‹ä½“æ„Ÿï¼Œå› æ˜¯ç›´æ¥ä»æ³¨é‡Šæºç èµ·æ­¥ï¼Œåœ¨åŠ æ³¨é‡Šè¿‡ç¨‹ä¸­ï¼Œæ¯æ¯æœ‰å¿ƒå¾—å¤„å°±æ•´ç†,æ…¢æ…¢å½¢æˆäº†ä»¥ä¸‹æ–‡ç« ã€‚å†…å®¹ç«‹è¶³æºç ï¼Œå¸¸ä»¥ç”Ÿæ´»åœºæ™¯æ‰“æ¯”æ–¹å°½å¯èƒ½å¤šçš„å°†å†…æ ¸çŸ¥è¯†ç‚¹ç½®å…¥æŸç§åœºæ™¯ï¼Œå…·æœ‰ç”»é¢æ„Ÿï¼Œå®¹æ˜“ç†è§£è®°å¿†ã€‚è¯´åˆ«äººèƒ½å¬å¾—æ‡‚çš„è¯å¾ˆé‡è¦! ç™¾ç¯‡åšå®¢ç»ä¸æ˜¯ç™¾åº¦æ•™æ¡å¼çš„åœ¨è¯´ä¸€å †è¯˜å±ˆè±ç‰™çš„æ¦‚å¿µï¼Œé‚£æ²¡ä»€ä¹ˆæ„æ€ã€‚æ›´å¸Œæœ›è®©å†…æ ¸å˜å¾—æ ©æ ©å¦‚ç”Ÿï¼Œå€æ„Ÿäº²åˆ‡ã€‚
*   ä¸ä»£ç éœ€ä¸æ–­`debug`ä¸€æ ·ï¼Œæ–‡ç« å†…å®¹ä¼šå­˜åœ¨ä¸å°‘é”™æ¼ä¹‹å¤„ï¼Œè¯·å¤šåŒ…æ¶µï¼Œä½†ä¼šåå¤ä¿®æ­£ï¼ŒæŒç»­æ›´æ–°ï¼Œ`v**.xx` ä»£è¡¨æ–‡ç« åºå·å’Œä¿®æ”¹çš„æ¬¡æ•°ï¼Œç²¾é›•ç»†ç¢ï¼Œè¨€ç®€æ„èµ…ï¼ŒåŠ›æ±‚æ‰“é€ ç²¾å“å†…å®¹ã€‚
*   ç™¾æ–‡åœ¨ < é¸¿è’™ç ”ç©¶ç«™ | å¼€æºä¸­å›½ | åšå®¢å›­ | 51cto | csdn | çŸ¥ä¹ | æ˜é‡‘ > ç«™ç‚¹å‘å¸ƒï¼Œ**é¸¿è’™ç ”ç©¶ç«™ | weharmonyos** ä¸­å›å¤ **ç™¾æ–‡** å¯æ–¹ä¾¿é˜…è¯»ã€‚
*   ![](https://weharmonyos.oss-cn-hangzhou.aliyuncs.com/resources/common/cate.png)

æŒ‰åŠŸèƒ½æ¨¡å—:

åŸºç¡€çŸ¥è¯†

è¿›ç¨‹ç®¡ç†

ä»»åŠ¡ç®¡ç†

å†…å­˜ç®¡ç†

[åŒå‘é“¾è¡¨](https://www.cnblogs.com/weharmony/p/15253688.html)  
[å†…æ ¸æ¦‚å¿µ](https://www.cnblogs.com/weharmony/p/15253620.html)  
[æºç ç»“æ„](https://www.cnblogs.com/weharmony/p/15253672.html)  
[åœ°å€ç©ºé—´](https://www.cnblogs.com/weharmony/p/15253620.html)  
[è®¡æ—¶å•ä½](https://www.cnblogs.com/weharmony/p/15253655.html)  
[ä¼˜é›…çš„å®](https://www.cnblogs.com/weharmony/p/15253620.html)  
[é’©å­æ¡†æ¶](https://www.cnblogs.com/weharmony/p/15253620.html)  
[ä½å›¾ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253671.html)  
[POSIX](https://www.cnblogs.com/weharmony/p/15253620.html)  
[mainå‡½æ•°](https://www.cnblogs.com/weharmony/p/15253620.html)  

[è°ƒåº¦æ•…äº‹](https://www.cnblogs.com/weharmony/p/15253681.html)  
[è¿›ç¨‹æ§åˆ¶å—](https://www.cnblogs.com/weharmony/p/15253666.html)  
[è¿›ç¨‹ç©ºé—´](https://www.cnblogs.com/weharmony/p/15253620.html)  
[çº¿æ€§åŒº](https://www.cnblogs.com/weharmony/p/15253620.html)  
[çº¢é»‘æ ‘](https://www.cnblogs.com/weharmony/p/15253620.html)  
[è¿›ç¨‹ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253687.html)  
[Forkè¿›ç¨‹](https://www.cnblogs.com/weharmony/p/15253645.html)  
[è¿›ç¨‹å›æ”¶](https://www.cnblogs.com/weharmony/p/15253643.html)  
[Shellç¼–è¾‘](https://www.cnblogs.com/weharmony/p/15342483.html)  
[Shellè§£æ](https://www.cnblogs.com/weharmony/p/15423406.html)  

[ä»»åŠ¡æ§åˆ¶å—](https://www.cnblogs.com/weharmony/p/15253669.html)  
[å¹¶å‘å¹¶è¡Œ](https://www.cnblogs.com/weharmony/p/15253665.html)  
[å°±ç»ªé˜Ÿåˆ—](https://www.cnblogs.com/weharmony/p/15253683.html)  
[è°ƒåº¦æœºåˆ¶](https://www.cnblogs.com/weharmony/p/15253682.html)  
[ä»»åŠ¡ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253684.html)  
[ç”¨æ ˆæ–¹å¼](https://www.cnblogs.com/weharmony/p/15253670.html)  
[è½¯ä»¶å®šæ—¶å™¨](https://www.cnblogs.com/weharmony/p/15253659.html)  
[æ§åˆ¶å°](https://www.cnblogs.com/weharmony/p/15253620.html)  
[è¿œç¨‹ç™»å½•](https://www.cnblogs.com/weharmony/p/15253620.html)  
[åè®®æ ˆ](https://www.cnblogs.com/weharmony/p/15253620.html)  

[å†…å­˜è§„åˆ™](https://www.cnblogs.com/weharmony/p/15253674.html)  
[ç‰©ç†å†…å­˜](https://www.cnblogs.com/weharmony/p/15253673.html)  
[å†…å­˜æ¦‚å¿µ](https://www.cnblogs.com/weharmony/p/15253678.html)  
[è™šå®æ˜ å°„](https://www.cnblogs.com/weharmony/p/15253675.html)  
[é¡µè¡¨ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253676.html)  
[é™æ€åˆ†é…](https://www.cnblogs.com/weharmony/p/15253679.html)  
[TLFSç®—æ³•](https://www.cnblogs.com/weharmony/p/16252827.html)  
[å†…å­˜æ± ç®¡ç†](https://www.cnblogs.com/weharmony/p/16252831.html)  
[åŸå­æ“ä½œ](https://www.cnblogs.com/weharmony/p/15253656.html)  
[åœ†æ•´å¯¹é½](https://www.cnblogs.com/weharmony/p/15253620.html)  

é€šè®¯æœºåˆ¶

æ–‡ä»¶ç³»ç»Ÿ

ç¡¬ä»¶æ¶æ„

å†…æ ¸æ±‡ç¼–

[é€šè®¯æ€»è§ˆ](https://www.cnblogs.com/weharmony/p/15253662.html)  
[è‡ªæ—‹é”](https://www.cnblogs.com/weharmony/p/15253664.html)  
[äº’æ–¥é”](https://www.cnblogs.com/weharmony/p/15253663.html)  
[å¿«é”ä½¿ç”¨](https://www.cnblogs.com/weharmony/p/15909247.html)  
[å¿«é”å®ç°](https://www.cnblogs.com/weharmony/p/15909257.html)  
[è¯»å†™é”](https://www.cnblogs.com/weharmony/p/15909257.html)  
[ä¿¡å·é‡](https://www.cnblogs.com/weharmony/p/15253661.html)  
[äº‹ä»¶æœºåˆ¶](https://www.cnblogs.com/weharmony/p/15253660.html)  
[ä¿¡å·ç”Ÿäº§](https://www.cnblogs.com/weharmony/p/15253642.html)  
[ä¿¡å·æ¶ˆè´¹](https://www.cnblogs.com/weharmony/p/15253641.html)  
[æ¶ˆæ¯é˜Ÿåˆ—](https://www.cnblogs.com/weharmony/p/15253657.html)  
[æ¶ˆæ¯å°è£…](https://www.cnblogs.com/weharmony/p/15870230.html)  
[æ¶ˆæ¯æ˜ å°„](https://www.cnblogs.com/weharmony/p/15876648.html)  
[å…±äº«å†…å­˜](https://www.cnblogs.com/weharmony/p/15870218.html)  

[æ–‡ä»¶æ¦‚å¿µ](https://www.cnblogs.com/weharmony/p/15253628.html)  
[æ–‡ä»¶æ•…äº‹](https://www.cnblogs.com/weharmony/p/15253627.html)  
[ç´¢å¼•èŠ‚ç‚¹](https://www.cnblogs.com/weharmony/p/15253626.html)  
[VFS](https://www.cnblogs.com/weharmony/p/15253622.html)  
[æ–‡ä»¶å¥æŸ„](https://www.cnblogs.com/weharmony/p/15253621.html)  
[æ ¹æ–‡ä»¶ç³»ç»Ÿ](https://www.cnblogs.com/weharmony/p/15253624.html)  
[æŒ‚è½½æœºåˆ¶](https://www.cnblogs.com/weharmony/p/15253625.html)  
[ç®¡é“æ–‡ä»¶](https://www.cnblogs.com/weharmony/p/15253620.html)  
[æ–‡ä»¶æ˜ å°„](https://www.cnblogs.com/weharmony/p/15253623.html)  
[å†™æ—¶æ‹·è´](https://www.cnblogs.com/weharmony/p/15253620.html)  

[èŠ¯ç‰‡æ¨¡å¼](https://www.cnblogs.com/weharmony/p/15253620.html)  
[ARMæ¶æ„](https://www.cnblogs.com/weharmony/p/15253658.html)  
[æŒ‡ä»¤é›†](https://www.cnblogs.com/weharmony/p/15253658.html)  
[åå¤„ç†å™¨](https://www.cnblogs.com/weharmony/p/16252761.html)  
[å·¥ä½œæ¨¡å¼](https://www.cnblogs.com/weharmony/p/15253654.html)  
[å¯„å­˜å™¨](https://www.cnblogs.com/weharmony/p/15253652.html)  
[å¤šæ ¸ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253658.html)  
[ä¸­æ–­æ¦‚å¿µ](https://www.cnblogs.com/weharmony/p/15253647.html)  
[ä¸­æ–­ç®¡ç†](https://www.cnblogs.com/weharmony/p/15253646.html)  

[ç¼–ç æ–¹å¼](https://www.cnblogs.com/weharmony/p/16252817.html)  
[æ±‡ç¼–åŸºç¡€](https://www.cnblogs.com/weharmony/p/15253668.html)  
[æ±‡ç¼–ä¼ å‚](https://www.cnblogs.com/weharmony/p/15253667.html)  
[é“¾æ¥è„šæœ¬](https://www.cnblogs.com/weharmony/p/15253620.html)  
[å†…æ ¸å¯åŠ¨](https://www.cnblogs.com/weharmony/p/15253620.html)  
[è¿›ç¨‹åˆ‡æ¢](https://www.cnblogs.com/weharmony/p/15253620.html)  
[ä»»åŠ¡åˆ‡æ¢](https://www.cnblogs.com/weharmony/p/15253649.html)  
[ä¸­æ–­åˆ‡æ¢](https://www.cnblogs.com/weharmony/p/15253648.html)  
[å¼‚å¸¸æ¥ç®¡](https://www.cnblogs.com/weharmony/p/15253651.html)  
[ç¼ºé¡µä¸­æ–­](https://www.cnblogs.com/weharmony/p/15253620.html)  

ç¼–è¯‘è¿è¡Œ

è°ƒæµ‹å·¥å…·

[ç¼–è¯‘è¿‡ç¨‹](https://www.cnblogs.com/weharmony/p/15253633.html)  
[ç¼–è¯‘æ„å»º](https://www.cnblogs.com/weharmony/p/15253631.html)  
[GNè¯­æ³•](https://www.cnblogs.com/weharmony/p/15253630.html)  
[å¿è€…æ— æ•Œ](https://www.cnblogs.com/weharmony/p/15253629.html)  
[ELFæ ¼å¼](https://www.cnblogs.com/weharmony/p/15253639.html)  
[ELFè§£æ](https://www.cnblogs.com/weharmony/p/15253637.html)  
[é™æ€é“¾æ¥](https://www.cnblogs.com/weharmony/p/15253636.html)  
[é‡å®šä½](https://www.cnblogs.com/weharmony/p/15253635.html)  
[åŠ¨æ€é“¾æ¥](https://www.cnblogs.com/weharmony/p/15253620.html)  
[è¿›ç¨‹æ˜ åƒ](https://www.cnblogs.com/weharmony/p/15253634.html)  
[åº”ç”¨å¯åŠ¨](https://www.cnblogs.com/weharmony/p/15253620.html)  
[ç³»ç»Ÿè°ƒç”¨](https://www.cnblogs.com/weharmony/p/15253653.html)  
[VDSO](https://www.cnblogs.com/weharmony/p/15253620.html)  

[æ¨¡å—ç›‘æ§](https://www.cnblogs.com/weharmony/p/15253620.html)  
[æ—¥å¿—è·Ÿè¸ª](https://www.cnblogs.com/weharmony/p/15253620.html)  
[ç³»ç»Ÿå®‰å…¨](https://www.cnblogs.com/weharmony/p/15253620.html)  
[æµ‹è¯•ç”¨ä¾‹](https://www.cnblogs.com/weharmony/p/15253620.html)  

### ç™¾ä¸‡æ³¨æºç  | å¤„å¤„æ‰£ç»†èŠ‚

*   ç™¾ä¸‡æ±‰å­—æ³¨è§£å†…æ ¸ç›®çš„æ˜¯è¦çœ‹æ¸…æ¥šå…¶æ¯›ç»†è¡€ç®¡ï¼Œç»†èƒç»“æ„ï¼Œç­‰äºåœ¨æ‹¿æ”¾å¤§é•œçœ‹å†…æ ¸ã€‚å†…æ ¸å¹¶ä¸ç¥ç§˜ï¼Œå¸¦ç€é—®é¢˜å»æºç ä¸­æ‰¾ç­”æ¡ˆæ˜¯å¾ˆå®¹æ˜“ä¸Šç˜¾çš„ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šæ–‡ç« å¯¹ä¸€äº›é—®é¢˜çš„è§£è¯»æ˜¯é”™è¯¯çš„ï¼Œæˆ–è€…è¯´ä¸æ·±åˆ»éš¾ä»¥è‡ªåœ†å…¶è¯´ï¼Œä½ ä¼šæ…¢æ…¢å½¢æˆè‡ªå·±æ–°çš„è§£è¯»ï¼Œè€Œæ–°çš„è§£è¯»åˆä¼šç¢°åˆ°æ–°çš„é—®é¢˜ï¼Œå¦‚æ­¤å±‚å±‚é€’è¿›ï¼Œæ»šæ»šå‘å‰ï¼Œæ‹¿ç€æ”¾å¤§é•œæ ¹æœ¬ä¸æ„¿æ„æ”¾æ‰‹ã€‚
    
*   [< gitee](https://gitee.com/weharmony/kernel_liteos_a_note) | [github](https://github.com/kuangyufei/kernel_liteos_a_note) | [coding](https://weharmony.coding.net/public/harmony/kernel_liteos_a_note/git/files) | [gitcode >](https://gitcode.net/kuangyufei/kernel_liteos_a_note) å››å¤§ç ä»“æ¨é€ | åŒæ­¥å®˜æ–¹æºç ï¼Œ**é¸¿è’™ç ”ç©¶ç«™ | weharmonyos** ä¸­å›å¤ **ç™¾ä¸‡** å¯æ–¹ä¾¿é˜…è¯»ã€‚
    
    [![](https://gitee.com/weharmony/kernel_liteos_a_note/widgets/widget_card.svg?colors=393222,ebdfc1,fffae5,d8ca9f,393222,a28b40)](https://gitee.com/weharmony/kernel_liteos_a_note)
    

æ®è¯´å–œæ¬¢ç‚¹èµåˆ†äº«çš„,åæ¥éƒ½æˆäº†å¤§ç¥ã€‚ğŸ˜ƒ