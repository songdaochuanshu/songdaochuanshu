---
layout: post
title: "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ åˆ†ç±»ç®—æ³•ï¼Ÿã€K-è¿‘é‚»ç®—æ³•(KNN)ã€äº¤å‰éªŒè¯ã€æœ´ç´ è´å¶æ–¯ç®—æ³•ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ã€‘"
date: "2022-04-05T06:22:52.695Z"
---
ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ åˆ†ç±»ç®—æ³•ï¼Ÿã€K-è¿‘é‚»ç®—æ³•(KNN)ã€äº¤å‰éªŒè¯ã€æœ´ç´ è´å¶æ–¯ç®—æ³•ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ã€‘
===============================================

1ã€K-è¿‘é‚»ç®—æ³•(KNN)
=============

1.1 å®šä¹‰
------

**ï¼ˆKNNï¼ŒK-NearestNeighborï¼‰**

å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„**kä¸ªæœ€ç›¸ä¼¼(å³ç‰¹å¾ç©ºé—´ä¸­æœ€é‚»è¿‘)çš„æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸€ä¸ªç±»åˆ«**ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«ã€‚

1.2 è·ç¦»å…¬å¼
--------

ä¸¤ä¸ªæ ·æœ¬çš„è·ç¦»å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼Œåˆå«æ¬§å¼è·ç¦»ã€‚

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404215105557-1079516154.png)

ç®€å•ç†è§£è¿™ä¸ªç®—æ³•ï¼š

è¿™ä¸ªç®—æ³•æ˜¯ç”¨æ¥ç»™ç‰¹å¾å€¼åˆ†ç±»çš„ï¼Œæ˜¯å±äºæœ‰ç›‘ç£å­¦ä¹ çš„é¢†åŸŸï¼Œæ ¹æ®ä¸æ–­è®¡ç®—ç‰¹å¾å€¼å’Œæœ‰ç›®æ ‡å€¼çš„ç‰¹å¾å€¼çš„è·ç¦»æ¥åˆ¤æ–­æŸä¸ªæ ·æœ¬æ˜¯å¦å±äºæŸä¸ªç›®æ ‡å€¼ã€‚

å¯ä»¥ç†è§£ä¸º**æ ¹æ®ä½ çš„é‚»å±…æ¥åˆ¤æ–­ä½ å±äºå“ªä¸ªç±»åˆ«**ã€‚

1.3 API
-------

*   sklearn.neighbors.KNeighborsClassifier(n\_neighbors=5,algorithm='auto')
    *   n\_neighborsï¼šint,å¯é€‰ï¼ˆé»˜è®¤= 5ï¼‰ï¼Œ**k\_neighborsæŸ¥è¯¢é»˜è®¤ä½¿ç”¨çš„é‚»å±…æ•°**
    *   algorithmï¼š{â€˜autoâ€™ï¼Œâ€˜ball\_treeâ€™ï¼Œâ€˜kd\_treeâ€™ï¼Œâ€˜bruteâ€™}ï¼Œå¯é€‰ç”¨äºè®¡ç®—æœ€è¿‘é‚»å±…çš„ç®—æ³•ï¼šâ€˜ball\_treeâ€™å°†ä¼šä½¿ç”¨ BallTreeï¼Œâ€˜kd\_treeâ€™å°†ä½¿ç”¨ KDTreeã€‚â€˜autoâ€™å°†å°è¯•æ ¹æ®ä¼ é€’ç»™fitæ–¹æ³•çš„å€¼æ¥å†³å®šæœ€åˆé€‚çš„ç®—æ³•ã€‚ (ä¸åŒå®ç°æ–¹å¼å½±å“æ•ˆç‡)
*   å…¶ä¸­çš„ä½ æŒ‡å®šçš„é‚»å±…ä¸ªæ•°å®é™…ä¸Šæ˜¯æŒ‡çš„å½“ç®—æ³•è®¡ç®—å®Œä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å€¼è·ç¦»æ‰€æœ‰å…¶ä»–æ ·æœ¬çš„ç›®æ ‡å€¼çš„è·ç¦»ä¹‹åï¼Œä¼šæ ¹æ®è·ç¦»çš„å¤§å°æ’åºï¼Œè€Œä½ çš„æŒ‡å®šçš„è¿™ä¸ªå‚æ•°å°±æ˜¯å–å‰å¤šå°‘ä¸ªå€¼ä½œä¸ºåˆ¤å®šä¾æ®ã€‚
    *   æ¯”å¦‚è¯´ä½ æŒ‡å®šé‚»å±…æ˜¯5é‚£ä¹ˆå¦‚æœ5ä¸ªé‚»å±…é‡Œ3ä¸ªæ˜¯çˆ±æƒ…ç‰‡ï¼Œé‚£ä¹ˆå¯ä»¥è¯´è¿™ä¸ªæ ·æœ¬å±äºçˆ±æƒ…ç‰‡ã€‚

1.4 æ¡ˆä¾‹ï¼ˆé¢„æµ‹ç­¾åˆ°ä½ç½®ï¼‰
--------------

    from sklearn.model_selection import train_test_split
    from sklearn.neighbors import KNeighborsClassifier
    from sklearn.preprocessing import StandardScaler
    import pandas as pd
    
    def knncls():
        """
        Kè¿‘é‚»ç®—æ³•é¢„æµ‹å…¥ä½ä½ç½®ç±»åˆ«
        row_id,x,y,accuracy,time,place_id
        ç”¨æˆ·ID,åæ ‡x,åæ ‡y,å‡†ç¡®åº¦,æ—¶é—´,ä½ç½®ID
        :return:
        """
        # ä¸€ã€å¤„ç†æ•°æ®ä»¥åŠç‰¹å¾å·¥ç¨‹
        # 1ã€è¯»å–æ”¶ï¼Œç¼©å°æ•°æ®çš„èŒƒå›´
    
        data = pd.read_csv("./train.csv")
    
        # æ•°æ®é€»è¾‘ç­›é€‰æ“ä½œ df.query()
        data = data.query("x > 1.0 & x < 1.25 & y > 2.5 & y < 2.75")
    
        # åˆ é™¤timeè¿™ä¸€åˆ—ç‰¹å¾
        data = data.drop(['time'], axis=1)
    
        print(data)
    
        # åˆ é™¤å…¥ä½æ¬¡æ•°å°‘äºä¸‰æ¬¡ä½ç½®
        place_count = data.groupby('place_id').count()
    
        tf = place_count[place_count.row_id > 3].reset_index()
    
        data = data[data['place_id'].isin(tf.place_id)]
    
        # 3ã€å–å‡ºç‰¹å¾å€¼å’Œç›®æ ‡å€¼
        y = data['place_id']
        # y = data[['place_id']]
    
        x = data.drop(['place_id', 'row_id'], axis=1)
    
        # 4ã€æ•°æ®åˆ†å‰²ä¸ç‰¹å¾å·¥ç¨‹?
    
        # ï¼ˆ1ï¼‰ã€æ•°æ®åˆ†å‰²
        x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3)
    
        # (2)ã€æ ‡å‡†åŒ–
        std = StandardScaler()
    
        # é˜Ÿè®­ç»ƒé›†è¿›è¡Œæ ‡å‡†åŒ–æ“ä½œ
        x_train = std.fit_transform(x_train)
        print(x_train)
    
        # è¿›è¡Œæµ‹è¯•é›†çš„æ ‡å‡†åŒ–æ“ä½œ
        x_test = std.fit_transform(x_test)
    
        # äºŒã€ç®—æ³•çš„è¾“å…¥è®­ç»ƒé¢„æµ‹
        # Kå€¼ï¼šç®—æ³•ä¼ å…¥å‚æ•°ä¸å®šçš„å€¼    ç†è®ºä¸Šï¼šk = æ ¹å·(æ ·æœ¬æ•°)
        # Kå€¼ï¼šåé¢ä¼šä½¿ç”¨å‚æ•°è°ƒä¼˜æ–¹æ³•ï¼Œå»è½®æµè¯•å‡ºæœ€å¥½çš„å‚æ•°[1,3,5,10,20,100,200]
        knn = KNeighborsClassifier(n_neighbors=1)
    
        # è°ƒç”¨fit()
        knn.fit(x_train, y_train)
    
        # é¢„æµ‹æµ‹è¯•æ•°æ®é›†ï¼Œå¾—å‡ºå‡†ç¡®ç‡
        y_predict = knn.predict(x_test)
    
        print("é¢„æµ‹æµ‹è¯•é›†ç±»åˆ«ï¼š", y_predict)
    
        print("å‡†ç¡®ç‡ä¸ºï¼š", knn.score(x_test, y_test))
    
        return None
    
    if __name__ == '__main__':
        print()
    

è¿”å›ç»“æœï¼š

                row_id       x       y  accuracy    place_id
    600            600  1.2214  2.7023        17  6683426742
    957            957  1.1832  2.6891        58  6683426742
    4345          4345  1.1935  2.6550        11  6889790653
    4735          4735  1.1452  2.6074        49  6822359752
    5580          5580  1.0089  2.7287        19  1527921905
    ...            ...     ...     ...       ...         ...
    29100203  29100203  1.0129  2.6775        12  3312463746
    29108443  29108443  1.1474  2.6840        36  3533177779
    29109993  29109993  1.0240  2.7238        62  6424972551
    29111539  29111539  1.2032  2.6796        87  3533177779
    29112154  29112154  1.1070  2.5419       178  4932578245
    
    [17710 rows x 5 columns]
    [[-0.39289714 -1.20169649  0.03123826]
     [-0.52988735  0.71519711 -0.08049297]
     [ 0.84001481  0.82113447 -0.73225846]
     ...
     [-0.64878452 -0.59040929 -0.20153513]
     [-1.37250642 -1.33053923 -0.44361946]
     [-0.11503962 -1.30477068 -0.22946794]]
    é¢„æµ‹æµ‹è¯•é›†ç±»åˆ«ï¼š [4932578245 3312463746 8048985799 ... 1285051622 2199223958 6780386626]
    å‡†ç¡®ç‡ä¸ºï¼š 0.4034672970843184
    
    Process finished with exit code 0
    
    

    knn.fit(x_train, y_train)
    ç”¨x_train, y_trainè®­ç»ƒæ¨¡å‹
    æ¨¡å‹è®­ç»ƒå¥½ä¹‹å
    y_predict = knn.predict(x_test)
    è°ƒç”¨é¢„æµ‹æ–¹æ³•é¢„æµ‹x_testçš„ç»“æœ
    è®¡ç®—å‡†ç¡®ç‡
    print("å‡†ç¡®ç‡ä¸ºï¼š", knn.score(x_test, y_test))
    

è¡¥å……ä¼°è®¡å™¨estimatorå·¥ä½œæµç¨‹

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404215053650-259422854.png)

### å‡†ç¡®ç‡ï¼š åˆ†ç±»ç®—æ³•çš„è¯„ä¼°ä¹‹ä¸€

*   1ã€kå€¼å–å¤šå¤§ï¼Ÿæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ

kå€¼å–å¾ˆå°ï¼šå®¹æ˜“å—åˆ°å¼‚å¸¸ç‚¹çš„å½±å“ï¼Œæ¯”å¦‚è¯´æœ‰å¼‚å¸¸çš„é‚»å±…å‡ºç°åœ¨ä½ æ—è¾¹ï¼Œé‚£ä¹ˆä½ çš„è®¡ç®—ç»“æœå°±ä¼šå¾ˆå¤§ç¨‹åº¦åœ°å—å…¶å½±å“ã€‚

kå€¼å–å¾ˆå¤§ï¼šå—åˆ°æ ·æœ¬å‡è¡¡çš„é—®é¢˜ï¼Œkå€¼è¿‡å¤§ç›¸å½“äºé€‰çš„å‚è€ƒé‚»å±…å¤ªå¤šäº†ï¼Œä»¥è‡³äºä¸çŸ¥é“é€‰å“ªä¸€ä¸ªä½œä¸ºæ ‡å‡†æ‰å¥½ã€‚

*   2ã€æ€§èƒ½é—®é¢˜ï¼Ÿ

è·ç¦»è®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦é«˜

### å°ç»“ï¼š

*   ä¼˜ç‚¹ï¼š
    *   ç®€å•ï¼Œæ˜“äºç†è§£ï¼Œæ˜“äºå®ç°ï¼Œæ— éœ€è®­ç»ƒ
*   ç¼ºç‚¹ï¼š
    *   æ‡’æƒ°ç®—æ³•ï¼Œå¯¹æµ‹è¯•æ ·æœ¬åˆ†ç±»æ—¶çš„è®¡ç®—é‡å¤§ï¼Œå†…å­˜å¼€é”€å¤§
    *   å¿…é¡»æŒ‡å®šKå€¼ï¼ŒKå€¼é€‰æ‹©ä¸å½“åˆ™åˆ†ç±»ç²¾åº¦ä¸èƒ½ä¿è¯
*   ä½¿ç”¨åœºæ™¯ï¼šå°æ•°æ®åœºæ™¯ï¼Œå‡ åƒï½å‡ ä¸‡æ ·æœ¬ï¼Œå…·ä½“åœºæ™¯å…·ä½“ä¸šåŠ¡å»æµ‹è¯•

* * *

2ã€äº¤å‰éªŒè¯(cross validation)
========================

äº¤å‰éªŒè¯ï¼šå°†æ‹¿åˆ°çš„è®­ç»ƒæ•°æ®ï¼Œåˆ†ä¸ºè®­ç»ƒå’ŒéªŒè¯é›†ã€‚ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼šå°†æ•°æ®åˆ†æˆ4ä»½ï¼Œå…¶ä¸­ä¸€ä»½ä½œä¸ºéªŒè¯é›†ã€‚ç„¶åç»è¿‡4æ¬¡(ç»„)çš„æµ‹è¯•ï¼Œæ¯æ¬¡éƒ½æ›´æ¢ä¸åŒçš„éªŒè¯é›†ã€‚å³å¾—åˆ°4ç»„æ¨¡å‹çš„ç»“æœï¼Œå–å¹³å‡å€¼ä½œä¸ºæœ€ç»ˆç»“æœã€‚åˆç§°4æŠ˜äº¤å‰éªŒè¯ã€‚

### 2.1 åˆ†æ

æˆ‘ä»¬ä¹‹å‰çŸ¥é“æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œä½†æ˜¯**ä¸ºäº†è®©ä»è®­ç»ƒå¾—åˆ°æ¨¡å‹ç»“æœæ›´åŠ å‡†ç¡®ã€‚**åšä»¥ä¸‹å¤„ç†

*   è®­ç»ƒé›†ï¼šè®­ç»ƒé›†+éªŒè¯é›†
*   æµ‹è¯•é›†ï¼šæµ‹è¯•é›†

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404215033837-334411583.png)

### 2.2 è¶…å‚æ•°æœç´¢-ç½‘æ ¼æœç´¢(Grid Search)

é€šå¸¸æƒ…å†µä¸‹ï¼Œ**æœ‰å¾ˆå¤šå‚æ•°æ˜¯éœ€è¦æ‰‹åŠ¨æŒ‡å®šçš„ï¼ˆå¦‚k-è¿‘é‚»ç®—æ³•ä¸­çš„Kå€¼ï¼‰ï¼Œè¿™ç§å«è¶…å‚æ•°**ã€‚ä½†æ˜¯æ‰‹åŠ¨è¿‡ç¨‹ç¹æ‚ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ¨¡å‹é¢„è®¾å‡ ç§è¶…å‚æ•°ç»„åˆã€‚**æ¯ç»„è¶…å‚æ•°éƒ½é‡‡ç”¨äº¤å‰éªŒè¯æ¥è¿›è¡Œè¯„ä¼°ã€‚æœ€åé€‰å‡ºæœ€ä¼˜å‚æ•°ç»„åˆå»ºç«‹æ¨¡å‹ã€‚**

*   sklearn.model\_selection.GridSearchCV(estimator, param\_grid=None,cv=None)
    *   å¯¹ä¼°è®¡å™¨çš„æŒ‡å®šå‚æ•°å€¼è¿›è¡Œè¯¦å°½æœç´¢
    *   estimatorï¼šä¼°è®¡å™¨å¯¹è±¡
    *   param\_gridï¼šä¼°è®¡å™¨å‚æ•°(dict){â€œn\_neighborsâ€:\[1,3,5\]}
    *   cvï¼šæŒ‡å®šå‡ æŠ˜äº¤å‰éªŒè¯
    *   fitï¼šè¾“å…¥è®­ç»ƒæ•°æ®
    *   scoreï¼šå‡†ç¡®ç‡
    *   ç»“æœåˆ†æï¼š
        *   best_score_:åœ¨äº¤å‰éªŒè¯ä¸­éªŒè¯çš„æœ€å¥½ç»“æœ\_
        *   best_estimator_ï¼šæœ€å¥½çš„å‚æ•°æ¨¡å‹
        *   cv_results_:æ¯æ¬¡äº¤å‰éªŒè¯åçš„éªŒè¯é›†å‡†ç¡®ç‡ç»“æœå’Œè®­ç»ƒé›†å‡†ç¡®ç‡ç»“æœ

**ç®€å•ç†è§£ï¼š**å°±æ˜¯åœ¨è®­ç»ƒçš„æ—¶å€™éšæœºé€‰ä¸€ç»„æ•°æ®åšè‡ªèº«éªŒè¯ï¼Œç„¶åå»æ¯”è¾ƒå“ªæ¬¡çš„ç»“æœå¥½ä¸€äº›ï¼Œå°±é€‰è¿™ä¸ªè®­ç»ƒçš„æ¨¡å‹ä½œä¸ºç»“æœï¼

### 2.3 æ¡ˆä¾‹ï¼ˆKNNç®—æ³•---é¸¢å°¾èŠ±åˆ†ç±»ï¼‰

    def knn_iris_gscv():
        """
        ç”¨KNNç®—æ³•å¯¹é¸¢å°¾èŠ±è¿›è¡Œåˆ†ç±»ï¼Œæ·»åŠ ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯
        :return:
        """
        # 1ï¼‰è·å–æ•°æ®
        iris = load_iris()
    
        # 2ï¼‰åˆ’åˆ†æ•°æ®é›†
        x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, random_state=22)
    
        # 3ï¼‰ç‰¹å¾å·¥ç¨‹ï¼šæ ‡å‡†åŒ–
        transfer = StandardScaler()
        x_train = transfer.fit_transform(x_train)
        x_test = transfer.transform(x_test)
    
        # 4ï¼‰KNNç®—æ³•é¢„ä¼°å™¨
        estimator = KNeighborsClassifier()
    
        # åŠ å…¥ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯
        # å‚æ•°å‡†å¤‡ nå¯èƒ½çš„å–å€¼ ç”¨å­—å…¸è¡¨ç¤º   cv = ? è¡¨ç¤ºå‡ æŠ˜äº¤å‰éªŒè¯
        param_dict = {"n_neighbors": [1, 3, 5, 7, 9, 11]}
        estimator = GridSearchCV(estimator, param_grid=param_dict, cv=10)
        estimator.fit(x_train, y_train)
    
        # 5ï¼‰æ¨¡å‹è¯„ä¼°
        # æ–¹æ³•1ï¼šç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼
        y_predict = estimator.predict(x_test)
        print("y_predict:\n", y_predict)
        print("ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n", y_test == y_predict)
    
        # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
        score = estimator.score(x_test, y_test)
        print("å‡†ç¡®ç‡ä¸ºï¼š\n", score)
    
        # æœ€ä½³å‚æ•°ï¼šbest_params_
        print("æœ€ä½³å‚æ•°ï¼š\n", estimator.best_params_)
        # æœ€ä½³ç»“æœï¼šbest_score_
        print("æœ€ä½³ç»“æœï¼š\n", estimator.best_score_)
        # æœ€ä½³ä¼°è®¡å™¨ï¼šbest_estimator_
        print("æœ€ä½³ä¼°è®¡å™¨:\n", estimator.best_estimator_)
        # äº¤å‰éªŒè¯ç»“æœï¼šcv_results_
        print("äº¤å‰éªŒè¯ç»“æœ:\n", estimator.cv_results_)
    
        return None
    

è¿”å›ç»“æœï¼š

    y_predict:
     [0 2 1 2 1 1 1 2 1 0 2 1 2 2 0 2 1 1 1 1 0 2 0 1 2 0 2 2 2 2 0 0 1 1 1 0 0
     0]
    ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:
     [ True  True  True  True  True  True  True  True  True  True  True  True
      True  True  True  True  True  True False  True  True  True  True  True
      True  True  True  True  True  True  True  True  True  True  True  True
      True  True]
    å‡†ç¡®ç‡ä¸ºï¼š
     0.9736842105263158
    æœ€ä½³å‚æ•°ï¼š
     {'n_neighbors': 3}
    æœ€ä½³ç»“æœï¼š
     0.9553030303030303
    æœ€ä½³ä¼°è®¡å™¨:
     KNeighborsClassifier(n_neighbors=3)
    äº¤å‰éªŒè¯ç»“æœ:
     {'mean_fit_time': array([0.00059769, 0.0005955 , 0.00069804, 0.00039876, 0.00049932,
           0.00039904]), 'std_fit_time': array([0.00048802, 0.00048625, 0.00063848, 0.00048837, 0.00049932,
           0.00048872]), 'mean_score_time': array([0.00144098, 0.00109758, 0.00109758, 0.00089834, 0.00109644,
           0.00089748]), 'std_score_time': array([0.00047056, 0.00030139, 0.00029901, 0.0005389 , 0.00029947,
           0.00029916]), 'param_n_neighbors': masked_array(data=[1, 3, 5, 7, 9, 11],
                 mask=[False, False, False, False, False, False],
           fill_value='?',
                dtype=object), 'params': [{'n_neighbors': 1}, {'n_neighbors': 3}, {'n_neighbors': 5}, {'n_neighbors': 7}, {'n_neighbors': 9}, {'n_neighbors': 11}], 'split0_test_score': array([0.91666667, 0.91666667, 1.        , 1.        , 0.91666667,
           0.91666667]), 'split1_test_score': array([1., 1., 1., 1., 1., 1.]), 'split2_test_score': array([0.90909091, 0.90909091, 0.90909091, 0.90909091, 0.90909091,
           0.90909091]), 'split3_test_score': array([0.90909091, 1.        , 0.90909091, 0.90909091, 0.90909091,
           1.        ]), 'split4_test_score': array([1., 1., 1., 1., 1., 1.]), 'split5_test_score': array([0.90909091, 0.90909091, 0.90909091, 0.90909091, 0.90909091,
           0.90909091]), 'split6_test_score': array([0.90909091, 0.90909091, 0.90909091, 1.        , 1.        ,
           1.        ]), 'split7_test_score': array([0.90909091, 0.90909091, 0.81818182, 0.81818182, 0.81818182,
           0.81818182]), 'split8_test_score': array([1., 1., 1., 1., 1., 1.]), 'split9_test_score': array([1., 1., 1., 1., 1., 1.]), 'mean_test_score': array([0.94621212, 0.95530303, 0.94545455, 0.95454545, 0.94621212,
           0.95530303]), 'std_test_score': array([0.04397204, 0.0447483 , 0.06030227, 0.06098367, 0.05988683,
           0.0604591 ]), 'rank_test_score': array([4, 1, 6, 3, 4, 1])}
    
    

3ã€æœ´ç´ è´å¶æ–¯ç®—æ³•
=========

åƒåœ¾é‚®ä»¶åˆ†ç±»ï¼š

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404215018093-131432044.png)

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214956151-2128524073.png)

3.1 è´å¶æ–¯å…¬å¼
---------

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214944362-1342794189.png)

å…¬å¼åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

*   P(C)ï¼šæ¯ä¸ªæ–‡æ¡£ç±»åˆ«çš„æ¦‚ç‡(æŸæ–‡æ¡£ç±»åˆ«æ•°ï¼æ€»æ–‡æ¡£æ•°é‡)
*   P(Wâ”‚C)ï¼š**ç»™å®šç±»åˆ«ä¸‹ç‰¹å¾ï¼ˆè¢«é¢„æµ‹æ–‡æ¡£ä¸­å‡ºç°çš„è¯ï¼‰çš„æ¦‚ç‡**
    *   è®¡ç®—æ–¹æ³•ï¼šP(F1â”‚C)=Ni/N ï¼ˆè®­ç»ƒæ–‡æ¡£ä¸­å»è®¡ç®—ï¼‰
        *   Niä¸ºè¯¥F1è¯åœ¨Cç±»åˆ«æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°
        *   Nä¸ºæ‰€å±ç±»åˆ«Cä¸‹çš„æ–‡æ¡£æ‰€æœ‰è¯å‡ºç°çš„æ¬¡æ•°å’Œ
*   P(F1,F2,â€¦) é¢„æµ‹æ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„æ¦‚ç‡

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214930771-427587425.png)

**æœ´ç´ è´å¶æ–¯å³å‡å®šæ‰€æœ‰çš„ç‰¹å¾å€¼ä¹‹é—´ç›¸äº’ç‹¬ç«‹**

3.2 æ–‡æ¡£åˆ†ç±»è®¡ç®—
----------

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214917563-830379152.png)

    ç§‘æŠ€ï¼šP(ç§‘æŠ€|å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—) = ğ‘ƒ(å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—|ç§‘æŠ€)âˆ—P(ç§‘æŠ€)=(8/100)âˆ—(20/100)âˆ—(63/100)âˆ—(30/90) = 0.00456109
    
    å¨±ä¹ï¼šP(å¨±ä¹|å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—) = ğ‘ƒ(å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—|å¨±ä¹)âˆ—P(å¨±ä¹)=(56/121)âˆ—(15/121)âˆ—(0/121)âˆ—(60/90) = 0
    

ä¸ºäº†ä¸å‡ºç°æ¦‚ç‡ä¸º0çš„æƒ…å†µ

3.3 æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°
------------

ç›®çš„ï¼šé˜²æ­¢è®¡ç®—å‡ºçš„åˆ†ç±»æ¦‚ç‡ä¸º0

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214907954-196694004.png)

    P(å¨±ä¹|å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—) =P(å½±é™¢,æ”¯ä»˜å®,äº‘è®¡ç®—|å¨±ä¹)P(å¨±ä¹) =P(å½±é™¢|å¨±ä¹)*P(æ”¯ä»˜å®|å¨±ä¹)*P(äº‘è®¡ç®—|å¨±ä¹)P(å¨±ä¹)=(56+1/121+4)(15+1/121+4)(0+1/121+1*4)(60/90) = 0.00002
    

3.4 æ¡ˆä¾‹ï¼ˆæ–°é—»åˆ†ç±»ï¼‰
------------

*   sklearn.naive\_bayes.MultinomialNB(alpha = 1.0)
    *   æœ´ç´ è´å¶æ–¯åˆ†ç±»
    *   alphaï¼šæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214844556-881555234.png)

    def nb_news():
        """
        ç”¨æœ´ç´ è´å¶æ–¯ç®—æ³•å¯¹æ–°é—»è¿›è¡Œåˆ†ç±»
        :return:
        """
        # 1ï¼‰è·å–æ•°æ®
        news = fetch_20newsgroups(subset="all")
        print("ç‰¹å¾å€¼åå­—ï¼š\n ",news["DESCR"])
        # 2ï¼‰åˆ’åˆ†æ•°æ®é›†
        x_train, x_test, y_train, y_test = train_test_split(news.data, news.target)
    
        # 3ï¼‰ç‰¹å¾å·¥ç¨‹ï¼šæ–‡æœ¬ç‰¹å¾æŠ½å–-tfidf
        transfer = TfidfVectorizer()
        x_train = transfer.fit_transform(x_train)
        x_test = transfer.transform(x_test)
    
        # 4ï¼‰æœ´ç´ è´å¶æ–¯ç®—æ³•é¢„ä¼°å™¨æµç¨‹
        estimator = MultinomialNB()
        estimator.fit(x_train, y_train)
    
        # 5ï¼‰æ¨¡å‹è¯„ä¼°
        # æ–¹æ³•1ï¼šç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼
        y_predict = estimator.predict(x_test)
        print("y_predict:\n", y_predict)
        print("ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n", y_test == y_predict)
    
        # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
        score = estimator.score(x_test, y_test)
        print("å‡†ç¡®ç‡ä¸ºï¼š\n", score)
    
        return None
    
    

è¿”å›ç»“æœï¼š

    y_predict:
     [14  1 14 ... 12  6  5]
    ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:
     [ True  True  True ...  True  True False]
    å‡†ç¡®ç‡ä¸ºï¼š
     0.8423174872665535
    
    

### å°ç»“ï¼š

*   ä¼˜ç‚¹ï¼š
    *   æœ´ç´ è´å¶æ–¯æ¨¡å‹å‘æºäºå¤å…¸æ•°å­¦ç†è®ºï¼Œæœ‰ç¨³å®šçš„åˆ†ç±»æ•ˆç‡ã€‚
    *   å¯¹ç¼ºå¤±æ•°æ®ä¸å¤ªæ•æ„Ÿï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¸¸ç”¨äºæ–‡æœ¬åˆ†ç±»ã€‚
    *   åˆ†ç±»å‡†ç¡®åº¦é«˜ï¼Œé€Ÿåº¦å¿«
*   ç¼ºç‚¹ï¼š
    *   ç”±äºä½¿ç”¨äº†æ ·æœ¬å±æ€§ç‹¬ç«‹æ€§çš„å‡è®¾ï¼Œæ‰€ä»¥å¦‚æœç‰¹å¾å±æ€§æœ‰å…³è”æ—¶å…¶æ•ˆæœä¸å¥½

* * *

4ã€å†³ç­–æ ‘
=====

4.1 è®¤è¯†å†³ç­–æ ‘
---------

å†³ç­–æ ‘æ€æƒ³çš„æ¥æºéå¸¸æœ´ç´ ï¼Œç¨‹åºè®¾è®¡ä¸­çš„æ¡ä»¶åˆ†æ”¯ç»“æ„å°±æ˜¯if-thenç»“æ„ï¼Œæœ€æ—©çš„å†³ç­–æ ‘å°±æ˜¯åˆ©ç”¨è¿™ç±»ç»“æ„åˆ†å‰²æ•°æ®çš„ä¸€ç§åˆ†ç±»å­¦ä¹ æ–¹æ³•ã€‚

### å†³ç­–æ ‘åˆ†ç±»åŸç†

é“¶è¡Œè´·æ¬¾æ•°æ®ï¼š

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214821393-2026669467.png)

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214805681-759295492.png)

4.2 ä¿¡æ¯ç†µ
-------

*   Hçš„ä¸“ä¸šæœ¯è¯­ç§°ä¹‹ä¸ºä¿¡æ¯ç†µï¼Œå•ä½ä¸ºæ¯”ç‰¹ã€‚

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214730861-160485587.png)

*   ä¿¡æ¯å’Œæ¶ˆé™¤ä¸ç¡®å®šæ€§æ˜¯ç›¸è”ç³»çš„

å½“æˆ‘ä»¬å¾—åˆ°çš„é¢å¤–ä¿¡æ¯ï¼ˆçƒé˜Ÿå†å²æ¯”èµ›æƒ…å†µç­‰ç­‰ï¼‰è¶Šå¤šçš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŒœæµ‹çš„ä»£ä»·è¶Šå°ï¼ˆçŒœæµ‹çš„ä¸ç¡®å®šæ€§å‡å°ï¼‰

å½“ä½ è·å–å„ä¸ªä¿¡æ¯çš„æ¦‚ç‡éƒ½ä¸å˜ï¼ˆä¸”éƒ½æ˜¯ç›¸åŒçš„ç™¾åˆ†ä¹‹50 ä¹Ÿå°±æ˜¯æˆç«‹æˆ–è€…ä¸æˆç«‹ ï¼‰çš„æ—¶å€™ï¼Œä¿¡æ¯ç†µæ˜¯ä¸€å®šçš„ï¼Œåªè¦è·å–ä¿¡æ¯çš„æ¦‚ç‡å‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚å…¶ä¸­æŸæ¡ä¿¡æ¯æˆç«‹çš„æ¦‚ç‡å˜æˆäº†ç™¾åˆ†ä¹‹60ï¼Œä¸æˆç«‹çš„æ¦‚ç‡å˜æˆç™¾åˆ†ä¹‹40ï¼‰ï¼Œé‚£ä¹ˆæ–°çš„ä¿¡æ¯ç†µçš„å€¼ä¸€å®šä¼šå¤§äºåˆšåˆšè®¡ç®—çš„å€¼ã€‚

é—®é¢˜ï¼š å›åˆ°æˆ‘ä»¬å‰é¢çš„è´·æ¬¾æ¡ˆä¾‹ï¼Œæ€ä¹ˆå»åˆ’åˆ†ï¼Ÿå¯ä»¥åˆ©ç”¨å½“å¾—çŸ¥æŸä¸ªç‰¹å¾ï¼ˆæ¯”å¦‚æ˜¯å¦æœ‰æˆ¿å­ï¼‰ä¹‹åï¼Œ**æˆ‘ä»¬èƒ½å¤Ÿå‡å°‘çš„ä¸ç¡®å®šæ€§å¤§å°ã€‚è¶Šå¤§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸ªç‰¹å¾å¾ˆé‡è¦ã€‚é‚£æ€ä¹ˆå»è¡¡é‡å‡å°‘çš„ä¸ç¡®å®šæ€§å¤§å°å‘¢ï¼Ÿ**

4.3 å†³ç­–æ ‘çš„åˆ’åˆ†ä¾æ®ä¹‹ä¸€---ä¿¡æ¯å¢ç›Š
---------------------

ç‰¹å¾Aå¯¹è®­ç»ƒæ•°æ®é›†Dçš„ä¿¡æ¯å¢ç›Šg(D,A),å®šä¹‰ä¸ºé›†åˆDçš„ä¿¡æ¯ç†µH(D)ä¸ç‰¹å¾Aç»™å®šæ¡ä»¶ä¸‹Dçš„ä¿¡æ¯æ¡ä»¶ç†µH(D|A)ä¹‹å·®ï¼Œå³å…¬å¼ä¸ºï¼š

![](https://img2022.cnblogs.com/blog/2090080/202204/2090080-20220404214713374-526170550.png)

â€‹ **æ³¨ï¼šä¿¡æ¯å¢ç›Šè¡¨ç¤ºå¾—çŸ¥ç‰¹å¾Xçš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ä½¿å¾—ç±»Yçš„ä¿¡æ¯ç†µå‡å°‘çš„ç¨‹åº¦**

**å¾—çŸ¥æŸç‰¹å¾ä¹‹åä¿¡æ¯çš„ä¸ç¡®å®šæ€§å°±ä¼šå‡å°‘ï¼Œé‚£ä¹ˆä¿¡æ¯å¢ç›Šå°±è¡¨ç¤ºè¿™ä¸ªæ–°ä¿¡æ¯çš„åŠ å…¥ä¼šç»™è¿™ä¸ªåˆ†ç±»çš„æœ€ç»ˆä¿¡æ¯ç†µå¸¦æ¥å¤šå¤§çš„å‡å°‘ç¨‹åº¦ï¼Œå¦‚æœå¸¦æ¥çš„æ•ˆç›Šè¶Šå¤§ï¼Œè¯´æ˜è¿™æ¡ä¿¡æ¯è¶Šæœ‰ä»·å€¼ã€‚**

æ¯”å¦‚ä¸Šé¢çš„é“¶è¡Œè´·æ¬¾æ¡ˆä¾‹ï¼š

    1ã€g(D, å¹´é¾„) = H(D) -H(D|å¹´é¾„) = 0.971-[5/15H(é’å¹´)+5/15H(ä¸­å¹´)+5/15H(è€å¹´]
    
    2ã€H(D) = -(6/15log(6/15)+9/15log(9/15))=0.971
    
    3ã€H(é’å¹´) = -(3/5log(3/5) +2/5log(2/5))
    H(ä¸­å¹´)=-(3/5log(3/5) +2/5log(2/5))
    H(è€å¹´)=-(4/5og(4/5)+1/5log(1/5))
                                                                  
    æˆ‘ä»¬ä»¥A1ã€A2ã€A3ã€A4ä»£è¡¨å¹´é¾„ã€æœ‰å·¥ä½œã€æœ‰è‡ªå·±çš„æˆ¿å­å’Œè´·æ¬¾æƒ…å†µã€‚æœ€ç»ˆè®¡ç®—çš„ç»“æœg(D, A1) = 0.313, g(D, A2) = 0.324, g(D, A3) = 0.420,g(D, A4) = 0.363ã€‚æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©A3ï¼ˆA3æœ€å¤§ï¼Œæœ€æœ‰ä»·å€¼ï¼Œæ‰€ä»¥æ”¾åœ¨æ ‘çš„å‰é¢ï¼‰ä½œä¸ºåˆ’åˆ†çš„ç¬¬ä¸€ä¸ªç‰¹å¾ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸€æ£µæ ‘æ…¢æ…¢å»ºç«‹ã€‚
    

4.4 å†³ç­–æ ‘çš„ä¸‰ç§ç®—æ³•å®ç°
--------------

*   ID3
    *   ä¿¡æ¯å¢ç›Š æœ€å¤§çš„å‡†åˆ™
*   C4.5
    *   ä¿¡æ¯å¢ç›Šæ¯” æœ€å¤§çš„å‡†åˆ™
*   CART
    *   åˆ†ç±»æ ‘: åŸºå°¼ç³»æ•° æœ€å°çš„å‡†åˆ™ åœ¨sklearnä¸­å¯ä»¥é€‰æ‹©åˆ’åˆ†çš„é»˜è®¤åŸåˆ™
    *   ä¼˜åŠ¿ï¼šåˆ’åˆ†æ›´åŠ ç»†è‡´ï¼ˆä»åé¢ä¾‹å­çš„æ ‘æ˜¾ç¤ºæ¥ç†è§£ï¼‰

### æ¡ˆä¾‹ï¼ˆç”¨å†³ç­–æ ‘å¯¹é¸¢å°¾èŠ±è¿›è¡Œåˆ†ç±»ï¼‰

*   class sklearn.tree.DecisionTreeClassifier(criterion=â€™giniâ€™, max\_depth=None,random\_state=None)
    *   å†³ç­–æ ‘åˆ†ç±»å™¨
    *   criterion:é»˜è®¤æ˜¯â€™giniâ€™ç³»æ•°ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¿¡æ¯å¢ç›Šçš„ç†µâ€™entropyâ€™
    *   max\_depth:æ ‘çš„æ·±åº¦å¤§å°
    *   random\_state:éšæœºæ•°ç§å­
*   å…¶ä¸­ä¼šæœ‰äº›è¶…å‚æ•°ï¼šmax\_depth:æ ‘çš„æ·±åº¦å¤§å°
    *   å…¶å®ƒè¶…å‚æ•°æˆ‘ä»¬ä¼šç»“åˆéšæœºæ£®æ—è®²è§£

    def decision_iris():
        """
        ç”¨å†³ç­–æ ‘å¯¹é¸¢å°¾èŠ±è¿›è¡Œåˆ†ç±»
        :return:
        """
        # 1ï¼‰è·å–æ•°æ®é›†
        iris = load_iris()
    
        # 2ï¼‰åˆ’åˆ†æ•°æ®é›†
        x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, random_state=22)
    
        # 3ï¼‰å†³ç­–æ ‘é¢„ä¼°å™¨
        """
        å†³ç­–æ ‘åˆ†ç±»å™¨
        criterion:é»˜è®¤æ˜¯â€™giniâ€™ç³»æ•°ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¿¡æ¯å¢ç›Šçš„ç†µâ€™entropyâ€™
        max_depth:æ ‘çš„æ·±åº¦å¤§å°
        random_state:éšæœºæ•°ç§å­
        """
        estimator = DecisionTreeClassifier(criterion="entropy")
        estimator.fit(x_train, y_train)
    
        # 4ï¼‰æ¨¡å‹è¯„ä¼°
        # æ–¹æ³•1ï¼šç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼
        y_predict = estimator.predict(x_test)
        print("y_predict:\n", y_predict)
        print("ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n", y_test == y_predict)
    
        # æ–¹æ³•2ï¼šè®¡ç®—å‡†ç¡®ç‡
        score = estimator.score(x_test, y_test)
        print("å‡†ç¡®ç‡ä¸ºï¼š\n", score)
    
        # å¯è§†åŒ–å†³ç­–æ ‘
        export_graphviz(estimator, out_file="iris_tree.dot", feature_names=iris.feature_names)
    
        return None
    

è¿”å›ç»“æœï¼š

    y_predict:
     [0 2 1 2 1 1 1 1 1 0 2 1 2 2 0 2 1 1 1 1 0 2 0 1 2 0 2 2 2 1 0 0 1 1 1 0 0
     0]
    ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:
     [ True  True  True  True  True  True  True False  True  True  True  True
      True  True  True  True  True  True False  True  True  True  True  True
      True  True  True  True  True False  True  True  True  True  True  True
      True  True]
    å‡†ç¡®ç‡ä¸ºï¼š
     0.9210526315789473
    

å°ç»“ï¼š
---

*   ä¼˜ç‚¹ï¼š
    *   ç®€å•çš„ç†è§£å’Œè§£é‡Šï¼Œæ ‘æœ¨å¯è§†åŒ–ã€‚
*   ç¼ºç‚¹ï¼š
    *   **å†³ç­–æ ‘å­¦ä¹ è€…å¯ä»¥åˆ›å»ºä¸èƒ½å¾ˆå¥½åœ°æ¨å¹¿æ•°æ®çš„è¿‡äºå¤æ‚çš„æ ‘ï¼Œè¿™è¢«ç§°ä¸ºè¿‡æ‹Ÿåˆã€‚**
*   æ”¹è¿›ï¼š
    *   å‡æcartç®—æ³•(å†³ç­–æ ‘APIå½“ä¸­å·²ç»å®ç°ï¼Œéšæœºæ£®æ—å‚æ•°è°ƒä¼˜æœ‰ç›¸å…³ä»‹ç»)
    *   **éšæœºæ£®æ—**

**æ³¨ï¼šä¼ä¸šé‡è¦å†³ç­–ï¼Œç”±äºå†³ç­–æ ‘å¾ˆå¥½çš„åˆ†æèƒ½åŠ›ï¼Œåœ¨å†³ç­–è¿‡ç¨‹åº”ç”¨è¾ƒå¤šï¼Œ å¯ä»¥é€‰æ‹©ç‰¹å¾**

* * *

5ã€éšæœºæ£®æ—
======

5.1 ä»€ä¹ˆæ˜¯é›†æˆå­¦ä¹ æ–¹æ³•
-------------

é›†æˆå­¦ä¹ é€šè¿‡å»ºç«‹å‡ ä¸ªæ¨¡å‹ç»„åˆçš„æ¥è§£å†³å•ä¸€é¢„æµ‹é—®é¢˜ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯**ç”Ÿæˆå¤šä¸ªåˆ†ç±»å™¨/æ¨¡å‹**ï¼Œå„è‡ªç‹¬ç«‹åœ°å­¦ä¹ å’Œä½œå‡ºé¢„æµ‹ã€‚**è¿™äº›é¢„æµ‹æœ€åç»“åˆæˆç»„åˆé¢„æµ‹ï¼Œå› æ­¤ä¼˜äºä»»ä½•ä¸€ä¸ªå•åˆ†ç±»çš„åšå‡ºé¢„æµ‹ã€‚**

5.2 ä»€ä¹ˆæ˜¯éšæœºæ£®æ—
-----------

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œ**éšæœºæ£®æ—æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå†³ç­–æ ‘çš„åˆ†ç±»å™¨**ï¼Œå¹¶ä¸”å…¶è¾“å‡ºçš„ç±»åˆ«æ˜¯ç”±ä¸ªåˆ«æ ‘è¾“å‡ºçš„ç±»åˆ«çš„ä¼—æ•°è€Œå®šã€‚

*   ä¾‹å¦‚, å¦‚æœä½ è®­ç»ƒäº†5ä¸ªæ ‘, å…¶ä¸­æœ‰4ä¸ªæ ‘çš„ç»“æœæ˜¯True, 1ä¸ªæ•°çš„ç»“æœæ˜¯False, é‚£ä¹ˆæœ€ç»ˆæŠ•ç¥¨ç»“æœå°±æ˜¯True

5.3 éšæœºæ£®æ—åŸç†è¿‡ç¨‹
------------

å­¦ä¹ ç®—æ³•æ ¹æ®ä¸‹åˆ—ç®—æ³•è€Œå»ºé€ æ¯æ£µæ ‘ï¼š

*   ç”¨Næ¥è¡¨ç¤ºè®­ç»ƒç”¨ä¾‹ï¼ˆæ ·æœ¬ï¼‰çš„ä¸ªæ•°ï¼ŒMè¡¨ç¤ºç‰¹å¾æ•°ç›®ã€‚
    
    *   1ã€ä¸€æ¬¡éšæœºé€‰å‡ºä¸€ä¸ªæ ·æœ¬ï¼Œé‡å¤Næ¬¡ï¼Œ ï¼ˆæœ‰å¯èƒ½å‡ºç°é‡å¤çš„æ ·æœ¬ï¼‰
    *   2ã€éšæœºå»é€‰å‡ºmä¸ªç‰¹å¾, m <<Mï¼Œå»ºç«‹å†³ç­–æ ‘
*   é‡‡å–bootstrapæŠ½æ ·
    
    ä»€ä¹ˆæ˜¯BootStrapæŠ½æ ·ï¼Ÿ
    
    *   ### bootstrap ç‹¬ç«‹çš„
        
*   ä¸ºä»€ä¹ˆè¦éšæœºæŠ½æ ·è®­ç»ƒé›†ï¼Ÿã€€ã€€
    
    *   å¦‚æœä¸è¿›è¡ŒéšæœºæŠ½æ ·ï¼Œæ¯æ£µæ ‘çš„è®­ç»ƒé›†éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆæœ€ç»ˆè®­ç»ƒå‡ºçš„æ ‘åˆ†ç±»ç»“æœä¹Ÿæ˜¯å®Œå…¨ä¸€æ ·çš„
*   ä¸ºä»€ä¹ˆè¦æœ‰æ”¾å›åœ°æŠ½æ ·ï¼Ÿ
    
    *   å¦‚æœä¸æ˜¯æœ‰æ”¾å›çš„æŠ½æ ·ï¼Œé‚£ä¹ˆæ¯æ£µæ ‘çš„è®­ç»ƒæ ·æœ¬éƒ½æ˜¯ä¸åŒçš„ï¼Œéƒ½æ˜¯æ²¡æœ‰äº¤é›†çš„ï¼Œè¿™æ ·æ¯æ£µæ ‘éƒ½æ˜¯â€œæœ‰åçš„â€ï¼Œéƒ½æ˜¯ç»å¯¹â€œç‰‡é¢çš„â€ï¼ˆå½“ç„¶è¿™æ ·è¯´å¯èƒ½ä¸å¯¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ£µæ ‘è®­ç»ƒå‡ºæ¥éƒ½æ˜¯æœ‰å¾ˆå¤§çš„å·®å¼‚çš„ï¼›è€Œéšæœºæ£®æ—æœ€ååˆ†ç±»å–å†³äºå¤šæ£µæ ‘ï¼ˆå¼±åˆ†ç±»å™¨ï¼‰çš„æŠ•ç¥¨è¡¨å†³ã€‚

5.4 éšæœºæ£®æ—API
-----------

*   class sklearn.ensemble.RandomForestClassifier(n\_estimators=10, criterion=â€™giniâ€™, max\_depth=None, bootstrap=True, random\_state=None, min\_samples\_split=2)
    
    *   éšæœºæ£®æ—åˆ†ç±»å™¨
    *   n\_estimatorsï¼šintegerï¼Œoptionalï¼ˆdefault = 10ï¼‰**æ£®æ—é‡Œçš„æ ‘æœ¨æ•°é‡**120,200,300,500,800,1200
    *   criteriaï¼šstringï¼Œå¯é€‰ï¼ˆdefault =â€œginiâ€ï¼‰åˆ†å‰²ç‰¹å¾çš„æµ‹é‡æ–¹æ³•
    *   max\_depthï¼šintegeræˆ–Noneï¼Œå¯é€‰ï¼ˆé»˜è®¤=æ— ï¼‰æ ‘çš„æœ€å¤§æ·±åº¦ 5,8,15,25,30
    *   max\_features="autoâ€,æ¯ä¸ªå†³ç­–æ ‘çš„æœ€å¤§ç‰¹å¾æ•°é‡
        *   If "auto", then `max_features=sqrt(n_features)`.
        *   If "sqrt", then `max_features=sqrt(n_features)` (same as "auto").
        *   If "log2", then `max_features=log2(n_features)`.
        *   If None, then `max_features=n_features`.
    *   bootstrapï¼šbooleanï¼Œoptionalï¼ˆ**default = True**ï¼‰æ˜¯å¦åœ¨æ„å»ºæ ‘æ—¶ä½¿ç”¨æ”¾å›æŠ½æ ·
    *   min\_samples\_split:èŠ‚ç‚¹åˆ’åˆ†æœ€å°‘æ ·æœ¬æ•°
    *   min\_samples\_leaf:å¶å­èŠ‚ç‚¹çš„æœ€å°æ ·æœ¬æ•°
*   è¶…å‚æ•°ï¼šn\_estimator, max\_depth, min\_samples\_split,min\_samples\_leaf
    

    # éšæœºæ£®æ—å»è¿›è¡Œé¢„æµ‹
    rf = RandomForestClassifier()
    
    param = {"n_estimators": [120,200,300,500,800,1200], "max_depth": [5, 8, 15, 25, 30]}
    
    # è¶…å‚æ•°è°ƒä¼˜
    gc = GridSearchCV(rf, param_grid=param, cv=2)
    
    gc.fit(x_train, y_train)
    
    print("éšæœºæ£®æ—é¢„æµ‹çš„å‡†ç¡®ç‡ä¸ºï¼š", gc.score(x_test, y_test))
    

å°ç»“ï¼š
---

*   åœ¨å½“å‰æ‰€æœ‰ç®—æ³•ä¸­ï¼Œå…·æœ‰æå¥½çš„å‡†ç¡®ç‡
*   èƒ½å¤Ÿæœ‰æ•ˆåœ°è¿è¡Œåœ¨å¤§æ•°æ®é›†ä¸Šï¼Œå¤„ç†å…·æœ‰é«˜ç»´ç‰¹å¾çš„è¾“å…¥æ ·æœ¬ï¼Œè€Œä¸”ä¸éœ€è¦é™ç»´
*   èƒ½å¤Ÿè¯„ä¼°å„ä¸ªç‰¹å¾åœ¨åˆ†ç±»é—®é¢˜ä¸Šçš„é‡è¦æ€§

* * *

å‡ ä¸ªé—®é¢˜ï¼š
-----

### 1ã€æ•°æ®é›†çš„ç»“æ„æ˜¯ä»€ä¹ˆ?

ç­”æ¡ˆ: ç‰¹å¾å€¼+ ç›®æ ‡å€¼

### 2ã€æœºå™¨å­¦ä¹ ç®—æ³•åˆ†æˆå“ªäº›ç±»åˆ«? å¦‚ä½•åˆ†ç±»

ç­”æ¡ˆ:

æ ¹æ®æ˜¯å¦æœ‰ç›®æ ‡å€¼åˆ†ä¸º

1.  ç›‘ç£å­¦ä¹ 
    
2.  éç›‘ç£å­¦ä¹ 
    

æ ¹æ®ç›®æ ‡å€¼çš„æ•°æ®ç±»å‹

1.  ç›®æ ‡å€¼ä¸ºç¦»æ•£å€¼å°±æ˜¯åˆ†ç±»é—®é¢˜
    
2.  ç›®æ ‡å€¼ä¸ºè¿ç»­å€¼å°±æ˜¯å›å½’é—®é¢˜
    

### 3ã€ä»€ä¹ˆæ˜¯æ ‡å‡†åŒ–? å’Œå½’ä¸€åŒ–ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜ç‚¹?

ç­”æ¡ˆ: æ ‡å‡†åŒ–æ˜¯é€šè¿‡å¯¹åŸå§‹æ•°æ®è¿›è¡Œå˜æ¢æŠŠæ•°æ®å˜æ¢åˆ°å‡å€¼ä¸º0,æ–¹å·®ä¸º1èŒƒå›´å†…

ä¼˜ç‚¹: å°‘é‡å¼‚å¸¸ç‚¹, ä¸å½±å“å¹³å‡å€¼å’Œæ–¹å·®, å¯¹è½¬æ¢å½±å“å°

æ³¨ï¼šå‚è€ƒäº†é»‘é©¬ç¨‹åºå‘˜ç›¸å…³èµ„æ–™ã€‚