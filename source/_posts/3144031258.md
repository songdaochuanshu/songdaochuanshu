---
layout: post
title: "ç²¾å‡†ç”¨æˆ·ç”»åƒï¼å•†åŸç”¨æˆ·åˆ†ç¾¤2.0ï¼â›µ"
date: "2022-11-20T13:27:14.585Z"
---
ç²¾å‡†ç”¨æˆ·ç”»åƒï¼å•†åŸç”¨æˆ·åˆ†ç¾¤2.0ï¼â›µ
==================

![ç²¾å‡†ç”¨æˆ·ç”»åƒï¼å•†åŸç”¨æˆ·åˆ†ç¾¤2.0ï¼â›µ](https://img2022.cnblogs.com/blog/2637458/202211/2637458-20221120142841061-1647930690.png) å®¢æˆ·åˆ†ç¾¤ï¼ˆå®¢æˆ·ç»†åˆ†ï¼‰å¯¹äºç»˜åˆ¶ç”¨æˆ·ç”»åƒã€æ„å»ºä¸ªæ€§åŒ–æ¨å¹¿ã€äº§å“å’ŒæœåŠ¡ç­–ç•¥ï¼Œéƒ½éå¸¸é‡è¦ã€‚æœ¬æ–‡è®²è§£æ­¤è¿‡ç¨‹ä¸­ï¼Œå¤šç§æœºå™¨å­¦ä¹ èšç±»ç®—æ³•çš„å»ºæ¨¡æµç¨‹ä¸è¯„ä¼°æ¨¡å¼ã€‚

![](https://img-blog.csdnimg.cn/img_convert/6da4a55b1b06f519affda4dee9b11994.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/40)ï¼š[https://www.showmeai.tech/tutorials/40](https://www.showmeai.tech/tutorials/40)  
> ğŸ“˜ [æœºå™¨å­¦ä¹ å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/41)ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/334)ï¼š[https://www.showmeai.tech/article-detail/334](https://www.showmeai.tech/article-detail/334)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

![](https://img-blog.csdnimg.cn/img_convert/00112ab01437ae0f524c3f4f98d1ad81.png)

å¾ˆå¤šå…¬å¸çš„æŠ€æœ¯äººå‘˜åœ¨åšç”¨æˆ·ç”»åƒçš„å·¥ä½œï¼Œ**ç»†åˆ†å®¢æˆ·/å®¢æˆ·åˆ†ç¾¤**æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„ä¹‰çš„å·¥ä½œï¼Œå¯ä»¥ç¡®ä¿ä¼ä¸šæ„å»ºæ›´ä¸ªæ€§åŒ–çš„æ¶ˆè´¹è€…é’ˆå¯¹ç­–ç•¥ï¼ŒåŒæ—¶ä¼˜åŒ–äº§å“å’ŒæœåŠ¡ã€‚

åœ¨æœºå™¨å­¦ä¹ çš„è§’åº¦çœ‹ï¼Œå®¢æˆ·åˆ†ç¾¤é€šå¸¸ä¼šé‡‡ç”¨æ— ç›‘ç£å­¦ä¹ çš„ç®—æ³•å®Œæˆã€‚åº”ç”¨è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šå…ˆæ”¶é›†æ•´ç†å®¢æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚**åœ°åŒºã€æ€§åˆ«ã€å¹´é¾„ã€åå¥½**ç­‰ï¼Œå†å¯¹å…¶è¿›è¡Œåˆ†ç¾¤ã€‚

![](https://img-blog.csdnimg.cn/img_convert/51eddc48f37759b290d6a57938b3877f.png)

åœ¨ä¹‹å‰çš„æ–‡ç«  ğŸ“˜[**åŸºäºæœºå™¨å­¦ä¹ çš„ç”¨æˆ·ä»·å€¼æ•°æ®æŒ–æ˜ä¸å®¢æˆ·åˆ†ç¾¤**](https://showmeai.tech/article-detail/325)ä¸­ï¼Œ[ShowMeAI](https://www.showmeai.tech/) å·²ç»åšäº†ä¸€äº›ç”¨æˆ·åˆ†ç¾¤å®æ“ä»‹ç»ï¼Œæœ¬ç¯‡å†…å®¹ä¸­ï¼Œ[ShowMeAI](https://www.showmeai.tech/) å°†æ›´æ·±å…¥åœ°ä»‹ç»èšç±»åˆ†ç¾¤çš„æ–¹æ³•ï¼Œä½¿ç”¨æ›´ä¸°å¯Œçš„å»ºæ¨¡æ–¹å¼ï¼Œå¹¶å‰–ææ¨¡å‹è¯„ä¼°çš„æ–¹æ³•æ¨¡å¼ã€‚

![](https://img-blog.csdnimg.cn/img_convert/1dcd947470fc849832b42bc071ff7bcc.png)

ğŸ’¡ æ•°æ®åŠ è½½ & åŸºæœ¬å¤„ç†
==============

æˆ‘ä»¬å…ˆä½¿ç”¨ pandas åŠ è½½ ğŸ†**Mall\_Customersæ•°æ®**ï¼Œå¹¶åšäº†ä¸€äº›æœ€åŸºæœ¬çš„æ•°æ®æ¸…æ´—ï¼ŒæŠŠå­—æ®µåç§°æ›´æ”¹ä¸ºæ¸…æ™°å¯ç†è§£çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚

> ğŸ† **å®æˆ˜æ•°æ®é›†ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰**ï¼šå…¬ä¼—å·ã€ShowMeAIç ”ç©¶ä¸­å¿ƒã€å›å¤ã€**å®æˆ˜**ã€ï¼Œæˆ–è€…ç‚¹å‡» [**è¿™é‡Œ**](https://www.showmeai.tech/article-detail/305) è·å–æœ¬æ–‡ [\[27\]åŸºäºå¤šç§èšç±»ç®—æ³•çš„å•†åŸç”¨æˆ·åˆ†ç¾¤ï¼ç»˜åˆ¶ç²¾å‡†ç”¨æˆ·ç”»åƒ](https://www.showmeai.tech/article-detail/334) ã€**Mall\_Customersæ•°æ®é›†**ã€

> â­ **ShowMeAIå®˜æ–¹GitHub**ï¼š[https://github.com/ShowMeAI-Hub](https://github.com/ShowMeAI-Hub)

    df= pd.read csv( "Mall Customers.csv")
    df.rename (columns={"CustomerID": "id", "Age": "age", "Annual Income (k$)": "annual_income", "Spending Score (1-100)": "spending_score"}, inplace=True)
    df.drop(columns=["id"], inplace=True)
    

ğŸ’¡ æ¢ç´¢æ€§æ•°æ®åˆ†æ
==========

![](https://img-blog.csdnimg.cn/img_convert/f00a46cae7b111f90e409a8523f4527f.png)

> æœ¬æ–‡æ•°æ®æ“ä½œå¤„ç†ä¸åˆ†ææ¶‰åŠçš„å·¥å…·å’ŒæŠ€èƒ½ï¼Œæ¬¢è¿å¤§å®¶æŸ¥é˜… [ShowMeAI](https://www.showmeai.tech/) å¯¹åº”çš„æ•™ç¨‹å’Œå·¥å…·é€ŸæŸ¥è¡¨ï¼Œå¿«å­¦å¿«ç”¨ã€‚
> 
> *   [**å›¾è§£æ•°æ®åˆ†æï¼šä»å…¥é—¨åˆ°ç²¾é€šç³»åˆ—æ•™ç¨‹**](https://www.showmeai.tech/tutorials/33)
> *   [**æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Pandas é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/101)
> *   [**æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Matplotlib é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/103)
> *   [**æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Seaborn é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/105)

ä¸‹é¢æˆ‘ä»¬å¯¹æ•°æ®åšä¸€äº›æ¢ç´¢æ€§æ•°æ®åˆ†æï¼Œé¦–å…ˆæˆ‘ä»¬çš„ç‰¹å¾å­—æ®µå¯ä»¥åˆ†ä¸º**æ•°å€¼å‹**å’Œ**ç±»åˆ«å‹**ä¸¤ç§ç±»å‹ã€‚åé¢æˆ‘ä»¬å•ç‹¬å¯¹ä¸¤ç±»ç‰¹å¾å­—æ®µè¿›è¡Œåˆ†æã€‚

    numcol = ["age", "annual_income", "spending_score"]
    objcol = ['Gender']
    

ğŸ’¦ å•å˜é‡åˆ†æ
--------

### â‘  ç±»åˆ«å‹ç‰¹å¾

æˆ‘ä»¬å¯¹æ€§åˆ«ï¼ˆå¥³æ€§å’Œç”·æ€§ï¼‰åšè®¡æ•°ç»Ÿè®¡å’Œç»˜å›¾ï¼Œä»£ç å¦‚ä¸‹ï¼š

    sns.set_style("ticks")
    my_pal = {"Male": "slateblue", "Female": "lightsalmon"}
    ax = sns.countplot(data=df, x="Gender", palette=-my_pal)
    ax.grid(True, axis='both' )
    for p in ax.patches:
            ax.annotate( '{:.Of}'. format(p.get _height()), (p.get _x()+0.25, p.get_height()+0.3))
            percentage = "{:.If}%'. format(100 * p.get height )/lendf[ "Gender" ]))
            ax.annotate(percentage, (p.get x()+0.25, p.get height ( )/2))
    olt.title( "Gender Countolot")
    

![](https://img-blog.csdnimg.cn/img_convert/58b4ab122492ebaa70fef620af2246d5.png)

### â‘¡ æ•°å€¼ç‰¹å¾

åç»­çš„ç”¨æˆ·åˆ†ç¾¤ä¼šä½¿ç”¨åˆ°èšç±»ç®—æ³•ï¼Œä¸ºäº†ç¡®ä¿èšç±»ç®—æ³•å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬ä¼šæŸ¥çœ‹è¿ç»­å€¼æ•°æ®åˆ†å¸ƒå¹¶æ£€æŸ¥å¼‚å¸¸å€¼ã€‚å¦‚æœä¸åŠ è¿™ä¸ªæ­¥éª¤ï¼Œä¸¥é‡å€¾æ–œçš„æ•°æ®å’Œå¼‚å¸¸å€¼å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ã€‚

![](https://img-blog.csdnimg.cn/img_convert/81c7d7a37167af6fd2012e5908405e82.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé™¤äº†`annual_income`ç‰¹å¾æœ‰ä¸€ä¸ªå¼‚å¸¸å€¼ä¹‹å¤–ï¼Œå¤§å¤šæ•°æ•°å€¼ç‰¹å¾å·²ç»å¾ˆè§„æ•´äº†ã€‚

    sns.set_style("ticks", {'axes.grid' : False})
    for idx, col in enumerate (numcol):
            plt.figure()
            f, ax = plt.subplots(nrows=2, sharex=True, gridspec_kw={"height_ratios": (0.2,0.85)}, figsize=(10,8));
            plt.suptitle(f"{col.upper()}",y=0.93);
            sns.boxplot(data=df,x=col,ax=ax[0],color="slateblue",boxprops=dict(alpha=.7),
                                    linewidth=0.8, width=0.6, fliersize=10,
                                    flierprops={ "marker" :"O", "markerfacecolor": "slateblue"},
                                    medianprops={ "color": "black", "linewidth":2.5})
    
            sns.histplot(data=df, Ã—=col, ax=ax[1],multiple="layer", fill=True, color= "slateblue", bins=40)
            ax2 =ax[1].twinx()
            sns.kdeplot(data=df, x=col, ax=ax2,
                                    multiple="layer",
                                    fill=True,
                                    color="slateblue",
                                    bw_adjust=0.9,
                                    alpha=0.1,
                                    linestyles="--")
    
            ax[1].grid(False)
            ax[0].set(xlabel="");
    
            ax[1].set _xlabel(col, fontsize=14)
            ax[1].grid(True)
    

![](https://img-blog.csdnimg.cn/img_convert/b3540282bc1a20622315a1592bcf289d.png)

![](https://img-blog.csdnimg.cn/img_convert/7841975eef5fddab63cc684eedd7dbf9.png)

![](https://img-blog.csdnimg.cn/img_convert/a335e2400a4c1eb69e2f5366a3334503.png)

ğŸ’¦ åŒå˜é‡åˆ†æ
--------

æˆ‘ä»¬å†å¯¹ä¸¤ä¸¤çš„ç‰¹å¾åšè”åˆåˆ†æï¼Œä»£ç å’Œç»˜åˆ¶ç»“æœå¦‚ä¸‹ï¼š

    sns.set_style("ticks", {'axes.grid' : False})
    
    def pairplot_hue(df, hue, **kwargs):
        g = sns.pairplot(df, hue=hue, **kwargs)
        g.fig.subplots_adjust(top=0.9)
        g.fig.suptitle(hue)
        return g
    
    pairplot_hue(df[numcol+objcol], hue='Gender')
    

![](https://img-blog.csdnimg.cn/img_convert/128ad8056c6a89a4527f2b1229902c23.png)

ğŸ’¡ å»ºæ¨¡
=====

ğŸ’¦ æ•°æ®ç¼©æ”¾
-------

ä¸ºäº†ä¿è¯åç»­èšç±»ç®—æ³•çš„æ€§èƒ½æ•ˆæœï¼Œæ•°å€¼ç‰¹å¾åœ¨é€å…¥æ¨¡å‹ä¹‹å‰éœ€è¦åšç¼©æ”¾å¤„ç†ã€‚æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ sklearn ä¸­çš„ `MinMaxScaler` ç¼©æ”¾æ–¹æ³•æ¥å®Œæˆè¿™é¡¹å·¥ä½œï¼Œå°†æ•°å€¼å‹å­—æ®µæ•°æ®èŒƒå›´è½¬æ¢ä¸º \[0,1\]ã€‚

    scaler = MinMaxScaler()
    df_scaled = df.copy()
    for col in numcol:
            df scaled[col] = pd.DataFrame(scaler.fit_transform(df_scaled[col].values.reshape(-1,1) ))
    

ğŸ’¦ æ¨¡å‹é€‰æ‹©
-------

> æœ¬ç¯‡å†…å®¹æ¶‰åŠçš„èšç±»æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ¬¢è¿å¤§å®¶æŸ¥çœ‹[ShowMeAI](https://www.showmeai.tech/)çš„æ•™ç¨‹æ–‡ç« ï¼š
> 
> *   [**å›¾è§£æœºå™¨å­¦ä¹  | èšç±»ç®—æ³•è¯¦è§£**](https://www.showmeai.tech/article-detail/197)

### â‘  K-Means èšç±»

K-Means ç®—æ³•æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå®ƒé€šè¿‡è¿­ä»£å’Œèšåˆæ¥æ ¹æ®æ•°æ®åˆ†å¸ƒç¡®å®šæ•°æ®å±äºå“ªä¸ªç°‡ã€‚

![](https://img-blog.csdnimg.cn/img_convert/d85d973d7b14d5df6bd1a15321708114.gif)

### â‘¡ å±‚æ¬¡èšç±»(BIRCH) ç®—æ³•

BIRCHï¼ˆBalanced Iterative Reducing and Clustering Using Hierarchiesï¼‰ç¿»è¯‘ä¸ºä¸­æ–‡å°±æ˜¯ã€åˆ©ç”¨å±‚æ¬¡æ–¹æ³•çš„å¹³è¡¡è¿­ä»£è§„çº¦å’Œèšç±»ã€ï¼Œå…¨ç§°éå¸¸å¤æ‚ã€‚ç®€å•æ¥è¯´ï¼ŒBIRCH ç®—æ³•åˆ©ç”¨äº†ä¸€ä¸ªæ ‘ç»“æ„æ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„èšç±»ï¼Œè¿™ä¸ªç‰¹æ®Šçš„æ ‘ç»“æ„ï¼Œå°±æ˜¯æˆ‘ä»¬åé¢è¦è¯¦ç»†ä»‹ç»çš„**èšç±»ç‰¹å¾æ ‘**ï¼ˆCF-treeï¼‰ã€‚ç®€å•åœ°è¯´ç®—æ³•å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼š

*   1ï¼‰æ‰«ææ•°æ®åº“ï¼Œå»ºç«‹ä¸€æ£µå­˜æ”¾äºå†…å­˜çš„ CF-Treeï¼Œå®ƒå¯ä»¥è¢«çœ‹ä½œæ•°æ®çš„å¤šå±‚å‹ç¼©ï¼Œè¯•å›¾ä¿ç•™æ•°æ®çš„å†…åœ¨èšç±»ç»“æ„ï¼›
    
*   2ï¼‰é‡‡ç”¨æŸä¸ªé€‰å®šçš„èšç±»ç®—æ³•ï¼Œå¦‚ K-Means æˆ–è€…å‡èšç®—æ³•ï¼Œå¯¹ CF æ ‘çš„å¶èŠ‚ç‚¹è¿›è¡Œèšç±»ï¼ŒæŠŠç¨€ç–çš„ç°‡å½“ä½œç¦»ç¾¤ç‚¹åˆ é™¤ï¼Œè€ŒæŠŠæ›´ç¨ å¯†çš„ç°‡åˆå¹¶ä¸ºæ›´å¤§çš„ç°‡ã€‚
    

![](https://img-blog.csdnimg.cn/img_convert/13245cfa078520faacbb28b9400a7a35.gif)

ğŸ’¦ æ¨¡å‹è¯„ä¼°
-------

### â‘  èšç±»ç®—æ³•è¯„ä¼°

è™½ç„¶è¯´èšç±»æ˜¯ä¸€ä¸ªæ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œä½†æˆ‘ä»¬ä¹Ÿæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥å¯¹å…¶æœ€ç»ˆèšç±»æ•ˆæœè¿›è¡Œè¯„ä¼°ï¼Œå¯¹æˆ‘ä»¬çš„å»ºæ¨¡å’Œèšåˆæœ‰ä¸€äº›æŒ‡å¯¼ä½œç”¨ã€‚

**â—‰ è½®å»“åˆ†æ•°ï¼ˆSilhouette scoreï¼‰**

è½®å»“åˆ†æ•°ï¼ˆ Silhouette scoreï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„èšç±»è¯„ä¼°æ–¹å¼ã€‚å¯¹äºå•ä¸ªæ ·æœ¬ï¼Œè®¾ a æ˜¯ä¸å®ƒåŒç±»åˆ«ä¸­å…¶ä»–æ ·æœ¬çš„å¹³å‡è·ç¦»ï¼Œb æ˜¯ä¸å®ƒè·ç¦»æœ€è¿‘ä¸åŒç±»åˆ«ä¸­æ ·æœ¬çš„å¹³å‡è·ç¦»ï¼Œè½®å»“ç³»æ•°ä¸ºï¼š

![](https://img-blog.csdnimg.cn/img_convert/f626646e40cbba427dd075e2756edc61.png)

å¯¹äºä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒçš„è½®å»“ç³»æ•°æ˜¯æ‰€æœ‰æ ·æœ¬è½®å»“ç³»æ•°çš„å¹³å‡å€¼ã€‚è½®å»“ç³»æ•°å–å€¼èŒƒå›´æ˜¯ \[-1,1\]ï¼ŒåŒç±»åˆ«æ ·æœ¬è¶Šè·ç¦»ç›¸è¿‘ä¸”ä¸åŒç±»åˆ«æ ·æœ¬è·ç¦»è¶Šè¿œï¼Œåˆ†æ•°è¶Šé«˜ã€‚

![](https://img-blog.csdnimg.cn/img_convert/e14a6c693409d4128b6ffc711eda8d38.png)

**â—‰ å¡æ—æ–¯åŸºå“ˆæ‹‰å·´æ–¯å¾—åˆ†ï¼ˆCalinski Harabasz scoreï¼‰**

å¡æ—æ–¯åŸºå“ˆæ‹‰å·´æ–¯å¾—åˆ†ï¼ˆCalinski Harabasz scoreï¼‰ä¹Ÿç§°ä¸ºæ–¹å·®æ¯”æ ‡å‡†ï¼Œç”±æ‰€æœ‰ç°‡çš„**ç°‡é—´ç¦»æ•£åº¦**ï¼ˆBetween Group Sum of Squares, BGSSï¼‰ä¹‹å’Œä¸**ç°‡å†…ç¦»æ•£åº¦**ï¼ˆWithin Group Sum of Squares, WGSSï¼‰ä¹‹å’Œçš„æ¯”å€¼è®¡ç®—å¾—å‡ºã€‚è¾ƒé«˜çš„ Calinski Harabasz åˆ†æ•°æ„å‘³ç€æ›´å¥½çš„èšç±»ï¼ˆæ¯ä¸ªèšç±»ä¸­æ›´å¯†é›†ï¼‰ã€‚ä»¥ä¸‹ç»™å‡ºè®¡ç®—è¿‡ç¨‹ï¼š

> **ç¬¬ä¸€æ­¥ï¼šè®¡ç®—ç°‡é—´ç¦»æ•£åº¦ï¼ˆBetween Group Sum of Squares, BGSSï¼‰**

![](https://img-blog.csdnimg.cn/img_convert/d132cf28a7e5768e9145f5d7021573ba.png)

> **ç¬¬äºŒéƒ¨ï¼šè®¡ç®—ç°‡å†…ç¦»æ•£åº¦ï¼ˆWithin Group Sum of Squares, WGSSï¼‰**

![](https://img-blog.csdnimg.cn/img_convert/f4d5dcaeee57afa8e77ca271251f8592.png)

> **ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—å¡æ—æ–¯åŸºå“ˆæ‹‰å·´æ–¯å¾—åˆ†ï¼ˆCalinski Harabasz scoreï¼‰**

![](https://img-blog.csdnimg.cn/img_convert/d8eeb154654aab6b75f47c0b05fd81ce.png)

**â—‰ æˆ´ç»´æ–¯å¸ƒå°”ä¸¹å¾—åˆ†ï¼ˆDavies Bouldin scoreï¼‰**

æˆ´ç»´æ–¯å¸ƒå°”ä¸¹å¾—åˆ†ï¼ˆDavies Bouldin scoreï¼‰è¡¨ç¤ºæ¯ä¸ªé›†ç¾¤ä¸ä¸å…¶æœ€ç›¸ä¼¼çš„é›†ç¾¤æˆ–æ¯ä¸ªé›†ç¾¤çš„å†…éƒ¨æ¨¡å¼çš„å¹³å‡ç›¸ä¼¼åº¦ã€‚æœ€ä½å¯èƒ½æˆ–æœ€æ¥è¿‘é›¶è¡¨ç¤ºæ›´å¥½çš„èšç±»ã€‚

### â‘¡ åº”ç”¨ K-Means èšç±»

æˆ‘ä»¬å…ˆåº”ç”¨ K-Means èšç±»å¯¹æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œèšåˆå¾—åˆ°ä¸åŒçš„ç”¨æˆ·ç°‡ï¼Œä»£ç å¦‚ä¸‹ï¼š

    k_range = range(2,10)
    for x in k range:
            model = KMeans(n_clusters=x, random_state=42)
      X = df_scaled[[ "annual_ income", "spending_score"]]
      model.fit(x)
    

è¯„ä¼° K-Means ç®—æ³•çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•æ˜¯è‚˜ç‚¹æ³•ï¼Œå®ƒä¼šå¯è§†åŒ–å…·æœ‰ä¸åŒæ•°é‡çš„ç°‡çš„å¹³æ–¹è·ç¦»ä¹‹å’Œï¼ˆå¤±çœŸåˆ†æ•°ï¼‰çš„åŠ é€Ÿå˜åŒ–ï¼ˆé€’å‡æ”¶ç›Šï¼‰çš„è¿‡ç¨‹ã€‚

æˆ‘ä»¬ç»“åˆä¸Šè¿°æåˆ°çš„3ä¸ªå¾—åˆ†ï¼Œä»¥åŠè‚˜ç‚¹æ³•è¿›è¡Œè®¡ç®—å’Œç»˜å›¾å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/13c6e507f26b1a1f0b6ddfe2b7cf2847.png)

![](https://img-blog.csdnimg.cn/img_convert/01b26e9534021f3c7c321a304ee87725.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç°‡æ•° = 5 æ˜¯é€‚ç”¨äºè¯¥æ•°æ®é›†çš„é€‚å½“ç°‡æ•°ï¼Œå› ä¸ºå®ƒæœ‰ç€è¿™äº›ç‰¹æ€§ï¼š

*   å¼€å§‹é€’å‡æ”¶ç›Šï¼ˆè‚˜æ³•ï¼‰
*   æœ€é«˜å¹³å‡è½®å»“åˆ†æ•°
*   ç›¸å¯¹è¾ƒé«˜çš„ Calinski Harabarsz è¯„åˆ†ï¼ˆå±€éƒ¨æœ€å¤§å€¼ï¼‰
*   Davies Bouldin æœ€ä½åˆ†æ•°

æˆ‘ä»¬ä»¥5ä¸ºèšç±»ä¸ªæ•°ï¼Œå¯¹æ•°æ®é‡æ–°èšç±»ï¼Œå¹¶åˆ†å‘èšç±» idï¼Œç„¶åå†å¯¹æ•°æ®è¿›è¡Œåˆ†å¸ƒåˆ†æç»˜å›¾ï¼Œä¸åŒçš„ç”¨æˆ·ç°‡çš„æ•°æ®åˆ†å¸ƒå¦‚ä¸‹ï¼ˆæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒæ¸…æ™°çœ‹åˆ°ä¸åŒç”¨æˆ·ç¾¤çš„åˆ†å¸ƒå·®å¼‚ï¼‰ã€‚

![](https://img-blog.csdnimg.cn/img_convert/3212e1b06ac5e134bee0d40148f8a0e2.png)

### â‘¢ åº”ç”¨ BIRCH èšç±»

æˆ‘ä»¬å†ä½¿ç”¨ BIRCH è¿›è¡Œèšç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

    n = range(2,10)
    for x in n:
      model = Birch(n_clusters=x, threshold=0.17)
      X = df_scaledI[ "annual income", "spending_score"]]
      model.fit(X)
    

ä¸ K-Means èšç±»ä¸åŒï¼ŒBIRCH èšç±»æ²¡æœ‰å¤±çœŸåˆ†æ•°ã€‚å…¶ä»–3 ä¸ªè¯„åˆ†æŒ‡æ ‡ï¼ˆSilhouetteã€CHã€DBIï¼‰ä»ç„¶ç›¸åŒã€‚

![](https://img-blog.csdnimg.cn/img_convert/f79bf3c215ac334f78a4d90047d24327.png)

![](https://img-blog.csdnimg.cn/img_convert/279390f74611766c7aea3ad1a9e12c86.png)

BIRCH çš„è®¡ç®—ä¹Ÿç»™å‡ºäº†ç°‡æ•°ç­‰äº5è¿™æ ·çš„ä¸€ä¸ªç»“è®ºã€‚æˆ‘ä»¬åŒæ ·å¯¹æ•°æ®è¿›è¡Œåˆ†å¸ƒåˆ†æç»˜å›¾ï¼Œä¸åŒçš„ç”¨æˆ·ç°‡çš„æ•°æ®åˆ†å¸ƒå¦‚ä¸‹ï¼ˆä¾æ—§å¯ä»¥æ¯”è¾ƒæ¸…æ™°çœ‹åˆ°ä¸åŒç”¨æˆ·ç¾¤çš„åˆ†å¸ƒå·®å¼‚ï¼‰ã€‚

![](https://img-blog.csdnimg.cn/img_convert/00316c839cbd2655702e003e0f282cdd.png)

ä¸¤ç§ç®—æ³•éƒ½å¾—å‡ºç›¸ä¼¼çš„ç»“æœï¼ˆä¸å®Œå…¨ç›¸åŒï¼‰ã€‚

### â‘£ å»ºæ¨¡ç»“æœè§£é‡Š

æˆ‘ä»¬æ¥å¯¹èšç±»åçš„ç»“æœåšä¸€äº›è§£é‡Šåˆ†æï¼Œå¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/1bcab50b01f9819eca333db3e81eeee7.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä»å¹´é¾„çš„è§’åº¦æ¥çœ‹ï¼Œä¸åŒçš„ç”¨æˆ·ç°‡æœ‰å„è‡ªçš„ä¸€äº›åˆ†å¸ƒç‰¹ç‚¹ï¼š

*   ç¬¬ 2 ä¸ªç”¨æˆ·ç°‡ => **å¹´é¾„åœ¨ 27 åˆ° 40 å²ä¹‹é—´** ï¼Œå¹³å‡å€¼ä¸º 33 å²ã€‚
*   ç¬¬ 5 ä¸ªç”¨æˆ·ç°‡ => **å¹´é¾„åœ¨ 18 åˆ° 35 å²ä¹‹é—´** ï¼Œå¹³å‡ä¸º 25 å²ã€‚

![](https://img-blog.csdnimg.cn/img_convert/bb0bad80ac5a1179274761b1451bd000.png)

ä»æ”¶å…¥ç»´åº¦æ¥çœ‹ï¼š

*   ç”¨æˆ·ç¾¤4å’Œ5çš„å¹´æ”¶å…¥å¤§è‡´ç›¸ç­‰ï¼Œå¤§çº¦ä¸º 26,000 ç¾å…ƒã€‚ â†’ **ä½æ”¶å…¥ç¾¤ä½“**
*   ç”¨æˆ·ç¾¤1å’Œ2çš„å¹´æ”¶å…¥å¤§è‡´ç›¸ç­‰ï¼Œè¿™æ„å‘³ç€å¤§çº¦ 87,000 ç¾å…ƒã€‚ â†’ **é«˜æ”¶å…¥ç¾¤ä½“**
*   ç”¨æˆ·ç¾¤3æ˜¯ç‹¬ç«‹ç»„ï¼Œå¹³å‡å¹´æ”¶å…¥ä¸º 55,000 ç¾å…ƒã€‚ â†’ **ä¸­ç­‰æ”¶å…¥ç¾¤ä½“**

ç»¼åˆå¹´é¾„å’Œå¹´æ”¶å…¥å¾—å‡ºä»¥ä¸‹ç»“æœã€‚

![](https://img-blog.csdnimg.cn/img_convert/b8522b24c25b4302cb8c55c72e04d5ee.png)

ç»“æœè¡¨æ˜

*   **ç”¨æˆ·ç¾¤2å’Œ5çš„å¹´é¾„èŒƒå›´ç›¸åŒï¼Œä½†å¹´æ”¶å…¥æœ‰æ˜¾ç€å·®å¼‚**
*   **ç”¨æˆ·ç¾¤4å’Œ5çš„å¹´æ”¶å…¥èŒƒå›´ç›¸åŒï¼Œä½†ç¬¬ 5 æ®µå±äºé’å°‘å¹´ç»„ï¼ˆ20-40 å²ï¼‰**

ä»èŠ±è´¹çš„è§’åº¦æ¥çœ‹åˆ†ç»„çš„ç”¨æˆ·ç¾¤ï¼š

![](https://img-blog.csdnimg.cn/img_convert/7f15ab9a3757fa427b27dea339e624f7.png)

ç»“æœè¡¨æ˜

*   ç”¨æˆ·ç¾¤5çš„ **æ”¯å‡ºå¾—åˆ†æœ€é«˜**ã€‚
*   ç”¨æˆ·ç¾¤4çš„ **æ”¯å‡ºå¾—åˆ†æœ€ä½**ã€‚

ç»¼åˆæ”¯å‡ºåˆ†å’Œå¹´æ”¶å…¥æ¥çœ‹ã€‚

![](https://img-blog.csdnimg.cn/img_convert/6237b98555cb9b61445fb3573cb49726.png)

ç»“æœè¡¨æ˜ï¼š

*   **ç”¨æˆ·ç¾¤1å’Œ2çš„å¹´æ”¶å…¥èŒƒå›´ç›¸åŒï¼Œä½†æ”¯å‡ºåˆ†èŒƒå›´å®Œå…¨ä¸åŒã€‚**
*   **ç”¨æˆ·ç¾¤4å’Œ5çš„å¹´æ”¶å…¥èŒƒå›´ç›¸åŒï¼Œä½†æ”¯å‡ºåˆ†èŒƒå›´å®Œå…¨ä¸åŒã€‚**

ğŸ’¡ ç»“è®º
=====

æˆ‘ä»¬å¯¹å„ä¸ªç”¨æˆ·ç¾¤è¿›è¡Œå¹³å‡æ±‡æ€»ï¼Œå¹¶ç»˜åˆ¶å›¾è¡¨å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/e44d00abee37ced5d799e7d3519b8055.png)

*   ç”¨æˆ·ç¾¤1æ˜¯æœ€é«˜å¹´æ”¶å…¥ç»„ï¼Œä½†æœ‰æœ€å·®çš„æ”¯å‡ºæ¶ˆè´¹ã€‚ â†’ **ç›®å‰å•†åŸçš„äº§å“å¹¶ä¸æ˜¯è¿™éƒ¨åˆ†å®¢æˆ·çš„æ¶ˆè´¹é¦–é€‰ï¼ˆéç›®æ ‡å®¢æˆ·ï¼‰ã€‚**
*   ç”¨æˆ·ç¾¤2çš„å¹³å‡å¹´é¾„æ¯”ç¬¬ 1 æ®µä½ 10 å€ï¼Œä½†åœ¨ç›¸åŒå¹´æ”¶å…¥èŒƒå›´å†…çš„å¹³å‡æ”¯å‡ºåˆ†æ•°æ˜¯ 4 å€ã€‚
*   ç”¨æˆ·ç¾¤5æ˜¯æœ€é«˜æ”¯å‡ºåˆ†æ•°ä½†æ˜¯æœ€ä½å¹´æ”¶å…¥ç»„ã€‚ â†’ **å®¢æˆ·è´­ä¹°æ¬²æœ›å¼ºï¼Œä½†æ¶ˆè´¹èƒ½åŠ›æœ‰é™ã€‚**

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ **åŸºäºæœºå™¨å­¦ä¹ çš„ç”¨æˆ·ä»·å€¼æ•°æ®æŒ–æ˜ä¸å®¢æˆ·åˆ†ç¾¤**ï¼š[https://showmeai.tech/article-detail/325](https://showmeai.tech/article-detail/325)
*   ğŸ“˜ **æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Pandas é€ŸæŸ¥è¡¨**ï¼š[https://www.showmeai.tech/article-detail/101](https://www.showmeai.tech/article-detail/101)
*   ğŸ“˜ **æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Matplotlib é€ŸæŸ¥è¡¨**ï¼š[https://www.showmeai.tech/article-detail/103](https://www.showmeai.tech/article-detail/103)
*   ğŸ“˜ **æ•°æ®ç§‘å­¦å·¥å…·åº“é€ŸæŸ¥è¡¨ | Seaborn é€ŸæŸ¥è¡¨**ï¼š[https://www.showmeai.tech/article-detail/105](https://www.showmeai.tech/article-detail/105)
*   ğŸ“˜ **å›¾è§£æ•°æ®åˆ†æï¼šä»å…¥é—¨åˆ°ç²¾é€šç³»åˆ—æ•™ç¨‹**ï¼š[https://www.showmeai.tech/tutorials/33](https://www.showmeai.tech/tutorials/33)
*   ğŸ“˜ **å›¾è§£æœºå™¨å­¦ä¹  | èšç±»ç®—æ³•è¯¦è§£**ï¼š[ttps://www.showmeai.tech/article-detail/197](https://www.showmeai.tech/article-detail/197)

[![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)](https://www.showmeai.tech/)