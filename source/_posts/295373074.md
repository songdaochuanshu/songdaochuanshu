---
layout: post
title: "å®é™…åº”ç”¨æ•ˆæœä¸ä½³ï¼Ÿæ¥çœ‹çœ‹æå‡æ·±åº¦ç¥ç»ç½‘ç»œæ³›åŒ–èƒ½åŠ›çš„æ ¸å¿ƒæŠ€æœ¯ï¼ˆé™„ä»£ç ï¼‰"
date: "2022-11-02T10:23:30.457Z"
---
å®é™…åº”ç”¨æ•ˆæœä¸ä½³ï¼Ÿæ¥çœ‹çœ‹æå‡æ·±åº¦ç¥ç»ç½‘ç»œæ³›åŒ–èƒ½åŠ›çš„æ ¸å¿ƒæŠ€æœ¯ï¼ˆé™„ä»£ç ï¼‰
==================================

![å®é™…åº”ç”¨æ•ˆæœä¸ä½³ï¼Ÿæ¥çœ‹çœ‹æå‡æ·±åº¦ç¥ç»ç½‘ç»œæ³›åŒ–èƒ½åŠ›çš„æ ¸å¿ƒæŠ€æœ¯ï¼ˆé™„ä»£ç ï¼‰](https://img2022.cnblogs.com/blog/2637458/202210/2637458-20221026172830142-1577031272.png) ç¥ç»ç½‘ç»œåœ¨å­¦ä¹ èƒ½åŠ›ä¸æ€§èƒ½æ–¹é¢ï¼Œè¿œè¶…ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå…¶å¤§é‡å±‚ä¸æ•°åäº¿å‚æ•°çš„ç½‘ç»œå¯ä»¥è½»æ¾å­¦ä¹ æ•°æ®çš„æ¨¡å¼ä¸è§„å¾‹ï¼Œä¹Ÿå®¹æ˜“é™·å…¥äº†ã€è¿‡æ‹Ÿåˆã€é—®é¢˜ã€‚æœ¬ç¯‡æ¢³ç†4ç±»ç¼“è§£è¿‡æ‹Ÿåˆçš„æ–¹æ³•ï¼šæ•°æ®å¢å¼ºã€Dropoutéšæœºå¤±æ´»ã€L1å’ŒL2æ­£åˆ™åŒ–ã€Early Stopping/æ—©åœæ­¢ã€‚

![](https://img-blog.csdnimg.cn/img_convert/a51cc83248dac86819bada656ac29875.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [æ·±åº¦å­¦ä¹ å®æˆ˜ç³»åˆ—](https://www.showmeai.tech/tutorials/42)ï¼š[https://www.showmeai.tech/tutorials/42](https://www.showmeai.tech/tutorials/42)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/317)ï¼š[https://www.showmeai.tech/article-detail/317](https://www.showmeai.tech/article-detail/317)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

![](https://img-blog.csdnimg.cn/img_convert/c09b70be1c1bfb9d1fa7f4afb0ba1e66.png)

ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§ç”±ç¥ç»å…ƒã€å±‚ã€æƒé‡å’Œåå·®ç»„åˆè€Œæˆçš„ç‰¹æ®Šæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œéšç€è¿‘äº›å¹´æ·±åº¦å­¦ä¹ çš„é«˜é€Ÿå‘å±•ï¼Œç¥ç»ç½‘ç»œå·²è¢«å¹¿æ³›ç”¨äºè¿›è¡Œé¢„æµ‹å’Œå•†ä¸šå†³ç­–å¹¶å¤§æ”¾å¼‚å½©ã€‚

ç¥ç»ç½‘ç»œä¹‹æ‰€ä»¥å¹¿å—è¿½æ§ï¼Œæ˜¯å› ä¸ºå®ƒä»¬èƒ½å¤Ÿåœ¨å­¦ä¹ èƒ½åŠ›å’Œæ€§èƒ½æ–¹é¢è¿œè¿œè¶…è¿‡ä»»ä½•ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ ç°ä»£åŒ…å«å¤§é‡å±‚å’Œæ•°åäº¿å‚æ•°çš„ç½‘ç»œå¯ä»¥è½»æ¾å­¦ä¹ æŒæ¡äº’è”ç½‘æµ·é‡æ•°æ®ä¸‹çš„æ¨¡å¼å’Œè§„å¾‹ï¼Œå¹¶ç²¾å‡†é¢„æµ‹ã€‚

![](https://img-blog.csdnimg.cn/img_convert/e2e6913ca7c04bfa3281b598ea203f0d.png)

éšç€AIç”Ÿæ€å’Œå„ç§ç¥ç»ç½‘ç»œå·¥å…·åº“ï¼ˆKerasã€Tensorflow å’Œ Pytorch ç­‰ï¼‰çš„å‘å±•ï¼Œæ­å»ºç¥ç»ç½‘ç»œæ‹Ÿåˆæ•°æ®å˜å¾—éå¸¸å®¹æ˜“ã€‚ä½†å¾ˆå¤šæ—¶å€™ï¼Œåœ¨ç”¨äºå­¦ä¹ çš„è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°è‰¯å¥½çš„æ¨¡å‹ï¼Œåœ¨æ–°çš„æ•°æ®ä¸Šå´æ•ˆæœä¸ä½³ï¼Œè¿™æ˜¯æ¨¡å‹é™·å…¥äº†ã€è¿‡æ‹Ÿåˆã€çš„é—®é¢˜ä¸­äº†ï¼Œåœ¨æœ¬ç¯‡å†…å®¹ä¸­ï¼Œ[ShowMeAI](https://www.showmeai.tech/)å°†ç»™å¤§å®¶æ¢³ç†å¸®åŠ©æ·±åº¦ç¥ç»ç½‘ç»œç¼“è§£è¿‡æ‹Ÿåˆæé«˜æ³›åŒ–èƒ½åŠ›çš„æ–¹æ³•ã€‚

![](https://img-blog.csdnimg.cn/img_convert/0a84d042a571b2b35f56757816e9c0a2.png)

ğŸ’¡ æ•°æ®å¢å¼º
=======

ğŸ“Œ æŠ€æœ¯ä»‹ç»
-------

ç¼“è§£è¿‡æ‹Ÿåˆæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯å¢åŠ æ•°æ®é‡ï¼Œåœ¨æ•°æ®é‡æœ‰é™çš„æƒ…å†µä¸‹å¯ä»¥é‡‡ç”¨æ•°æ®å¢å¼ºæŠ€æœ¯ã€‚ æ•°æ®å¢å¼ºæ˜¯ä»ç°æœ‰è®­ç»ƒæ ·æœ¬ä¸­æ„å»ºæ–°æ ·æœ¬çš„è¿‡ç¨‹ï¼Œä¾‹å¦‚åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œæˆ‘ä»¬ä¼šä¸ºå·ç§¯ç¥ç»ç½‘ç»œæ‰©å¢è®­ç»ƒå›¾åƒã€‚

å…·ä½“ä½“ç°åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å›¾åƒè¿›è¡Œå˜æ¢å¤„ç†å¾—åˆ°æ–°çªç ´ï¼Œä¾‹å¦‚ä½ç½®å’Œé¢œè‰²è°ƒæ•´æ˜¯å¸¸è§çš„è½¬æ¢æŠ€æœ¯ï¼Œå¸¸è§çš„å›¾åƒå¤„ç†è¿˜åŒ…æ‹¬â€”â€”ç¼©æ”¾ã€è£å‰ªã€ç¿»è½¬ã€å¡«å……ã€æ—‹è½¬å’Œå¹³ç§»ã€‚

ğŸ“Œ æ‰‹åŠ¨æ•°æ®å¤„ç†&å¢å¼º
------------

æˆ‘ä»¬å¯ä»¥åŸºäºPILåº“æ‰‹åŠ¨å¯¹å›¾åƒå¤„ç†å¾—åˆ°æ–°å›¾åƒä»¥æ‰©å¢æ ·æœ¬é‡

    from PIL import Image
    import matplotlib.pyplot as plt
    img = Image.open("/content/drive/MyDrive/cat.jpg")
    flipped_img = img.transpose(Image.FLIP_LEFT_RIGHT) ### ç¿»è½¬
    roated_img = img.transpose(Image.ROTATE_90) ## æ—‹è½¬
    scaled_img = img.resize((400, 400))  ### å›¾åƒç¼©æ”¾
    cropped_img = img.crop((100,50,400,200)) # è£å‰ª
    # é¢œè‰²å˜æ¢
    width, height = img.size
    pad_pixel = 20
    canvas = Image.new(img.mode, (width+pad_pixel, height+pad_pixel), 'blue')
    canvas.paste(img, (pad_pixel//2,pad_pixel//2))
    

![](https://img-blog.csdnimg.cn/img_convert/e1a96689dd743e26b6bf45540c63a513.png)

é¢œè‰²å¢å¼ºå¤„ç†é€šè¿‡æ”¹å˜å›¾åƒçš„åƒç´ å€¼æ¥æ”¹å˜å›¾åƒçš„é¢œè‰²å±æ€§ã€‚æ›´ç»†ä¸€ç‚¹è®²ï¼Œå¯ä»¥é€šè¿‡æ”¹å˜äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ã€è‰²è°ƒã€ç°åº¦ã€è†¨èƒ€ç­‰æ¥å¤„ç†ã€‚

    from PIL import Image, ImageEnhance
    import matplotlib.pyplot as plt
    img = Image.open("/content/drive/MyDrive/cat.jpg")
    enhancer = ImageEnhance.Brightness(img)
    img2 = enhancer.enhance(1.5)  ## æ›´äº®
    img3 = enhancer.enhance(0.5)  ## æ›´æš— 
    imageenhancer = ImageEnhance.Contrast(img)
    img4 = enhancer.enhance(1.5) ## æå‡å¯¹æ¯”åº¦
    img5 = enhancer.enhance(0.5) ## é™ä½å¯¹æ¯”åº¦
    enhancer = ImageEnhance.Sharpness(img)
    img6 = enhancer.enhance(5) ## é”åŒ–
    

![](https://img-blog.csdnimg.cn/img_convert/28d8bf5b776cfa62bab93cdba9b40f44.png)

è™½ç„¶å¯ä»¥é€šè¿‡ä½¿ç”¨åƒ pillow å’Œ OpenCV è¿™æ ·çš„å›¾åƒå¤„ç†åº“æ¥æ‰‹åŠ¨æ‰§è¡Œå›¾åƒå¢å¼ºï¼Œä½†æ›´ç®€å•ä¸”è€—æ—¶æ›´å°‘çš„æ–¹æ³•æ˜¯ä½¿ç”¨ ğŸ“˜[**Keras**](https://keras.io/) API æ¥å®Œæˆã€‚

> å…³äºkerasçš„æ ¸å¿ƒçŸ¥è¯†ï¼Œ[ShowMeAI](https://www.showmeai.tech/)ä¸ºå…¶åˆ¶ä½œäº†é€ŸæŸ¥æ‰‹å†Œï¼Œæ¬¢è¿å¤§å®¶é€šè¿‡å¦‚ä¸‹æ–‡ç« å¿«æŸ¥å¿«ç”¨ï¼š
> 
> *   [**AIå‚ç›´é¢†åŸŸå·¥å…·åº“é€ŸæŸ¥è¡¨ | Keras é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/110)

Keras æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„æ·±åº¦å­¦ä¹  APIï¼Œå¯ä»¥è¿è¡Œåœ¨æœºå™¨å­¦ä¹ å¹³å° Tensorflow ä¹‹ä¸Šã€‚ Keras æœ‰è®¸å¤šå¯æé«˜å®éªŒé€Ÿåº¦çš„å†…ç½®æ–¹æ³•å’Œç±»ã€‚ åœ¨ Keras ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª ğŸ“˜[**ImageDataGenerator**](https://keras.io/zh/preprocessing/image/)ç±»ï¼Œå®ƒä¸ºå›¾åƒå¢å¼ºæä¾›äº†å¤šä¸ªé€‰é¡¹ã€‚

    keras.preprocessing.image.ImageDataGenerator()
    

ğŸ“˜[**å‚æ•°**](https://keras.io/zh/preprocessing/image/)ï¼š

*   **featurewise\_center**: å¸ƒå°”å€¼ã€‚å°†è¾“å…¥æ•°æ®çš„å‡å€¼è®¾ç½®ä¸º 0ï¼Œé€ç‰¹å¾è¿›è¡Œã€‚
*   **samplewise\_center**: å¸ƒå°”å€¼ã€‚å°†æ¯ä¸ªæ ·æœ¬çš„å‡å€¼è®¾ç½®ä¸º 0ã€‚
*   **featurewise\_std\_normalization**: Boolean. å¸ƒå°”å€¼ã€‚å°†è¾“å…¥é™¤ä»¥æ•°æ®æ ‡å‡†å·®ï¼Œé€ç‰¹å¾è¿›è¡Œã€‚
*   **samplewise\_std\_normalization**: å¸ƒå°”å€¼ã€‚å°†æ¯ä¸ªè¾“å…¥é™¤ä»¥å…¶æ ‡å‡†å·®ã€‚
*   **zca\_epsilon**: ZCA ç™½åŒ–çš„ epsilon å€¼ï¼Œé»˜è®¤ä¸º 1e-6ã€‚
*   **zca\_whitening**: å¸ƒå°”å€¼ã€‚æ˜¯å¦åº”ç”¨ ZCA ç™½åŒ–ã€‚
*   **rotation\_range**: æ•´æ•°ã€‚éšæœºæ—‹è½¬çš„åº¦æ•°èŒƒå›´ã€‚
*   **width\_shift\_range**: æµ®ç‚¹æ•°ã€ä¸€ç»´æ•°ç»„æˆ–æ•´æ•°
    *   float: å¦‚æœ <1ï¼Œåˆ™æ˜¯é™¤ä»¥æ€»å®½åº¦çš„å€¼ï¼Œæˆ–è€…å¦‚æœ >=1ï¼Œåˆ™ä¸ºåƒç´ å€¼ã€‚
    *   1-D æ•°ç»„: æ•°ç»„ä¸­çš„éšæœºå…ƒç´ ã€‚
    *   int: æ¥è‡ªé—´éš” `(-width_shift_range, +width_shift_range)` ä¹‹é—´çš„æ•´æ•°ä¸ªåƒç´ ã€‚
    *   `width_shift_range=2` æ—¶ï¼Œå¯èƒ½å€¼æ˜¯æ•´æ•° `[-1, 0, +1]`ï¼Œä¸ `width_shift_range=[-1, 0, +1]` ç›¸åŒï¼›è€Œ `width_shift_range=1.0` æ—¶ï¼Œå¯èƒ½å€¼æ˜¯ `[-1.0, +1.0)` ä¹‹é—´çš„æµ®ç‚¹æ•°ã€‚
*   **height\_shift\_range**: æµ®ç‚¹æ•°ã€ä¸€ç»´æ•°ç»„æˆ–æ•´æ•°
    *   float: å¦‚æœ <1ï¼Œåˆ™æ˜¯é™¤ä»¥æ€»å®½åº¦çš„å€¼ï¼Œæˆ–è€…å¦‚æœ >=1ï¼Œåˆ™ä¸ºåƒç´ å€¼ã€‚
    *   1-D array-like: æ•°ç»„ä¸­çš„éšæœºå…ƒç´ ã€‚
    *   int: æ¥è‡ªé—´éš” `(-height_shift_range, +height_shift_range)` ä¹‹é—´çš„æ•´æ•°ä¸ªåƒç´ ã€‚
    *   `height_shift_range=2` æ—¶ï¼Œå¯èƒ½å€¼æ˜¯æ•´æ•° `[-1, 0, +1]`ï¼Œä¸ `height_shift_range=[-1, 0, +1]` ç›¸åŒï¼›è€Œ `height_shift_range=1.0` æ—¶ï¼Œå¯èƒ½å€¼æ˜¯ `[-1.0, +1.0)` ä¹‹é—´çš„æµ®ç‚¹æ•°ã€‚
*   **shear\_range**: æµ®ç‚¹æ•°ã€‚å‰ªåˆ‡å¼ºåº¦ï¼ˆä»¥å¼§åº¦é€†æ—¶é’ˆæ–¹å‘å‰ªåˆ‡è§’åº¦ï¼‰ã€‚
*   **zoom\_range**: æµ®ç‚¹æ•° æˆ– `[lower, upper]`ã€‚éšæœºç¼©æ”¾èŒƒå›´ã€‚å¦‚æœæ˜¯æµ®ç‚¹æ•°ï¼Œ`[lower, upper] = [1-zoom_range, 1+zoom_range]`ã€‚
*   **channel\_shift\_range**: æµ®ç‚¹æ•°ã€‚éšæœºé€šé“è½¬æ¢çš„èŒƒå›´ã€‚
*   **fill\_mode**: {"constant", "nearest", "reflect" or "wrap"} ä¹‹ä¸€ã€‚é»˜è®¤ä¸º 'nearest'ã€‚è¾“å…¥è¾¹ç•Œä»¥å¤–çš„ç‚¹æ ¹æ®ç»™å®šçš„æ¨¡å¼å¡«å……ã€‚
*   **cval**: æµ®ç‚¹æ•°æˆ–æ•´æ•°ã€‚ç”¨äºè¾¹ç•Œä¹‹å¤–çš„ç‚¹çš„å€¼ï¼Œå½“ `fill_mode = "constant"` æ—¶ã€‚
*   **horizontal\_flip**: å¸ƒå°”å€¼ã€‚éšæœºæ°´å¹³ç¿»è½¬ã€‚
*   **vertical\_flip**: å¸ƒå°”å€¼ã€‚éšæœºå‚ç›´ç¿»è½¬ã€‚
*   **rescale**: é‡ç¼©æ”¾å› å­ã€‚é»˜è®¤ä¸º Noneã€‚å¦‚æœæ˜¯ None æˆ– 0ï¼Œä¸è¿›è¡Œç¼©æ”¾ï¼Œå¦åˆ™å°†æ•°æ®ä¹˜ä»¥æ‰€æä¾›çš„å€¼ï¼ˆåœ¨åº”ç”¨ä»»ä½•å…¶ä»–è½¬æ¢ä¹‹å‰ï¼‰ã€‚
*   **preprocessing\_function**: åº”ç”¨äºæ¯ä¸ªè¾“å…¥çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨ä»»ä½•å…¶ä»–æ”¹å˜ä¹‹å‰è¿è¡Œã€‚è¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªå‚æ•°ï¼šä¸€å¼ å›¾åƒï¼ˆç§©ä¸º 3 çš„ Numpy å¼ é‡ï¼‰ï¼Œå¹¶ä¸”åº”è¯¥è¾“å‡ºä¸€ä¸ªåŒå°ºå¯¸çš„ Numpy å¼ é‡ã€‚
*   **data\_format**: å›¾åƒæ•°æ®æ ¼å¼ï¼Œ{"channels\_first", "channels\_last"} ä¹‹ä¸€ã€‚"channels\_last" æ¨¡å¼è¡¨ç¤ºå›¾åƒè¾“å…¥å°ºå¯¸åº”è¯¥ä¸º `(samples, height, width, channels)`ï¼Œ"channels\_first" æ¨¡å¼è¡¨ç¤ºè¾“å…¥å°ºå¯¸åº”è¯¥ä¸º `(samples, channels, height, width)`ã€‚é»˜è®¤ä¸º åœ¨ Keras é…ç½®æ–‡ä»¶ `~/.keras/keras.json` ä¸­çš„ `image_data_format` å€¼ã€‚å¦‚æœä½ ä»æœªè®¾ç½®å®ƒï¼Œé‚£å®ƒå°±æ˜¯ "channels\_last"ã€‚
*   **validation\_split**: æµ®ç‚¹æ•°ã€‚Float. ä¿ç•™ç”¨äºéªŒè¯çš„å›¾åƒçš„æ¯”ä¾‹ï¼ˆä¸¥æ ¼åœ¨0å’Œ1ä¹‹é—´ï¼‰ã€‚
*   **dtype**: ç”Ÿæˆæ•°ç»„ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚

ğŸ“Œ åŸºäº TensorFlow çš„æ•°æ®å¢å¼º
----------------------

å¦‚æœè¦åŸºäº TensorFlow å®ç°æ•°æ®å¢å¼ºï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    from keras.preprocessing.image import ImageDataGenerator, array_to_img, img_to_array, load_img
    
    datagen = ImageDataGenerator(
            rotation_range=40,
            width_shift_range=0.2,
            height_shift_range=0.2,
            brightness_range= [0.5, 1.5],
            rescale=1./255,
            shear_range=0.2,
            zoom_range=0.4,
            horizontal_flip=True,
            fill_mode='nearest',
            zca_epsilon=True)
    
    path = '/content/drive/MyDrive/cat.jpg' ## Image Path
    img = load_img(f"{path}")
    x = img_to_array(img)
    x = x.reshape((1,) + x.shape)
    i = 0
    
    ### åŸºäºæ•°æ®å¢å¼ºæ„å»º25å¼ å›¾ç‰‡å¹¶å­˜å…¥aug_imgæ–‡ä»¶å¤¹
    for batch in datagen.flow(x, batch_size=1, save_to_dir="/content/drive/MyDrive/aug_imgs", save_prefix='img', save_format='jpeg'):
        i += 1
        if i > 25:
            break 
    

![](https://img-blog.csdnimg.cn/img_convert/5ad21b9782be563842e6ae3073d9f0e9.png)

ğŸ’¡ Dropout éšæœºå¤±æ´»
===============

> å…³äºéšæœºå¤±æ´»çš„è¯¦ç»†åŸç†çŸ¥è¯†ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹[ShowMeAI](https://www.showmeai.tech/)åˆ¶ä½œçš„æ·±åº¦å­¦ä¹ ç³»åˆ—æ•™ç¨‹å’Œå¯¹åº”æ–‡ç« 
> 
> *   [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ï¼šå´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**](https://www.showmeai.tech/tutorials/35)
>     
> *   [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢**](https://www.showmeai.tech/article-detail/216)
>     
> *   [**æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æ•™ç¨‹ï¼šæ–¯å¦ç¦CS231n Â· å…¨å¥—ç¬”è®°è§£è¯»**](https://www.showmeai.tech/tutorials/37)
>     
> *   [**æ·±åº¦å­¦ä¹ ä¸CVæ•™ç¨‹(7) | ç¥ç»ç½‘ç»œè®­ç»ƒæŠ€å·§ (ä¸‹)**](https://www.showmeai.tech/article-detail/266)
>     

ğŸ“Œ æŠ€æœ¯ä»‹ç»
-------

Dropout å±‚æ˜¯è§£å†³æ·±åº¦ç¥ç»ç½‘ç»œä¸­è¿‡åº¦æ‹Ÿåˆçš„æœ€å¸¸ç”¨æ–¹æ³•ã€‚ å®ƒé€šè¿‡åŠ¨æ€è°ƒæ•´ç½‘ç»œæ¥å‡å°‘è¿‡æ‹Ÿåˆçš„æ¦‚ç‡ã€‚

Dropout å±‚ **éšæœº** åœ¨è®­ç»ƒé˜¶æ®µä»¥æ¦‚ç‡rateéšæœºå°†è¾“å…¥å•å…ƒä¸¢å¼ƒï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯å¯¹è¾“å…¥ç½®0ï¼‰ï¼Œæœªç½®0çš„è¾“å…¥æŒ‰ 1/(1 - rate) æ”¾å¤§ï¼Œä»¥ä½¿æ‰€æœ‰è¾“å…¥çš„æ€»å’Œä¿æŒä¸å˜ã€‚

**ä¸¢å¼ƒç‡rate** æ˜¯ä¸»è¦å‚æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 1ã€‚0.5 çš„rateå–å€¼æ„å‘³ç€ 50% çš„ç¥ç»å…ƒåœ¨è®­ç»ƒé˜¶æ®µä»ç½‘ç»œä¸­éšæœºä¸¢å¼ƒã€‚

![](https://img-blog.csdnimg.cn/img_convert/b1951599908b514b9e5383ed203f8725.png)

TensorFlowä¸­çš„dropoutä½¿ç”¨æ–¹å¼å¦‚ä¸‹

    tf.keras.layers.Dropout(rate, noise_shape=None, seed=None)
    

ğŸ“˜[**å‚æ•°**](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dropout)

*   `rate`**:** åœ¨ 0 å’Œ 1 ä¹‹é—´æµ®åŠ¨ï¼Œä¸¢å¼ƒæ¦‚ç‡ã€‚
*   `noise_shape`:1D æ•´æ•°å¼ é‡ï¼Œè¡¨ç¤ºå°†ä¸è¾“å…¥ç›¸ä¹˜çš„äºŒè¿›åˆ¶ dropout æ©ç çš„å½¢çŠ¶ã€‚
*   `seed`: éšæœºç§å­ã€‚

ğŸ“Œ åŸºäºTensorFlowåº”ç”¨Dropout
------------------------

    import tensorflow as tf
    from tensorflow.keras.models import Sequential
    from tensorflow.keras.layers import Dense,Reshape
    from tensorflow.keras.layers import Dropout
    
    def create_model():
      model = Sequential()
      model.add(Dense(60, input_shape=(60,), activation='relu'))
      model.add(Dropout(0.2))
      model.add(Dense(30, activation='relu'))
      model.add(Dropout(0.2))
      model.add(Dense(1, activation='sigmoid'))
      return model
      
    adam = tf.keras.optimizers.Adam()
    model.compile(loss='binary_crossentropy', optimizer=adam, metrics=['accuracy'])
    
    model = create_model()
    model.summary()
    

![](https://img-blog.csdnimg.cn/img_convert/de01b5dd5f813cf04bf444f019f663ea.png)

åœ¨å‘ç¥ç»ç½‘ç»œæ·»åŠ  dropout å±‚æ—¶ï¼Œæœ‰ä¸€äº›æŠ€å·§å¤§å®¶å¯ä»¥äº†è§£ä¸€ä¸‹ï¼š

*   ä¸€èˆ¬ä¼šä½¿ç”¨ 20%-50% çš„å°çš„ dropout å€¼ï¼Œå¤ªå¤§çš„ dropout å€¼å¯èƒ½ä¼šé™ä½æ¨¡å‹æ€§èƒ½ï¼ŒåŒæ—¶é€‰æ‹©éå¸¸å°çš„å€¼ä¸ä¼šå¯¹ç½‘ç»œäº§ç”Ÿå¤ªå¤§å½±å“ã€‚
*   ä¸€èˆ¬åœ¨å¤§å‹ç½‘ç»œä¸­ä¼šä½¿ç”¨dropoutå±‚ä»¥è·å¾—æœ€å¤§æ€§èƒ½ã€‚
*   è¾“å…¥å±‚å’Œéšå±‚ä¸Šéƒ½å¯ä»¥ä½¿ç”¨ dropoutï¼Œè¡¨ç°éƒ½è‰¯å¥½ã€‚

ğŸ’¡ L1 å’Œ L2 æ­£åˆ™åŒ–
==============

> å…³äºæ­£åˆ™åŒ–çš„è¯¦ç»†åŸç†çŸ¥è¯†ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹[ShowMeAI](https://www.showmeai.tech/)åˆ¶ä½œçš„æ·±åº¦å­¦ä¹ ç³»åˆ—æ•™ç¨‹å’Œå¯¹åº”æ–‡ç« 
> 
> *   [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ï¼šå´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**](https://www.showmeai.tech/tutorials/35)
>     
> *   [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢**](https://www.showmeai.tech/article-detail/216)
>     
> *   [**æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æ•™ç¨‹ï¼šæ–¯å¦ç¦CS231n Â· å…¨å¥—ç¬”è®°è§£è¯»**](https://www.showmeai.tech/tutorials/37)
>     
> *   [**æ·±åº¦å­¦ä¹ ä¸CVæ•™ç¨‹(7) | ç¥ç»ç½‘ç»œè®­ç»ƒæŠ€å·§ (ä¸‹)**](https://www.showmeai.tech/article-detail/266)
>     

ğŸ“Œ æŠ€æœ¯ä»‹ç»
-------

æ­£åˆ™åŒ–æ˜¯ä¸€ç§é€šè¿‡æƒ©ç½šæŸå¤±å‡½æ•°æ¥é™ä½ç½‘ç»œå¤æ‚æ€§çš„æŠ€æœ¯ã€‚ å®ƒä¸ºæŸå¤±å‡½æ•°æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„æƒé‡çº¦æŸéƒ¨åˆ†ï¼Œå®ƒåœ¨æ¨¡å‹è¿‡äºå¤æ‚çš„æ—¶å€™ä¼šè¿›è¡Œæƒ©ç½šï¼ˆé«˜lossï¼‰ï¼Œç®€å•åœ°è¯´ï¼Œæ­£åˆ™åŒ–é™åˆ¶æƒé‡å¹…åº¦è¿‡å¤§ã€‚

L1 æ­£åˆ™åŒ–çš„å…¬å¼å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/2e8f9ea255639bc78dc570f920ad04fc.png)

L2 æ­£åˆ™åŒ–å…¬å¼å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/fe6e36d63cb477bbbf78ff6dfe12b84b.png)

ğŸ“Œ åŸºäºTensorFlowåº”ç”¨æ­£åˆ™åŒ–
--------------------

åœ¨TensorFlowæ­å»ºç¥ç»ç½‘ç»œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ·»åŠ å¯¹åº”çš„å±‚æ¬¡æ—¶ï¼Œé€šè¿‡å‚æ•°è®¾ç½®æ·»åŠ æ­£åˆ™åŒ–é¡¹ã€‚

    import tensorflow as tf
    from tensorflow.keras.models import Sequential
    from tensorflow.keras.layers import Dense,Reshape
    from tensorflow.keras.layers import Dropout
    
    def create_model():
      # æ„å»ºæ¨¡å‹
      model = Sequential()
      # æ·»åŠ æ­£åˆ™åŒ–
      model.add(Dense(60, input_shape=(60,), activation='relu',  kernel_regularizer=keras.regularizers.l1(0.01)))
      model.add(Dropout(0.2))
      # æ·»åŠ æ­£åˆ™åŒ–
      model.add(Dense(30, activation='relu',  kernel_regularizer=keras.regularizers.l2(0.001)))
      model.add(Dropout(0.2))
      model.add(Dense(1, activation='sigmoid'))
      return model
    
    
    adam = tf.keras.optimizers.Adam()
    model.compile(loss='binary_crossentropy', optimizer=adam, metrics=['accuracy'])
    
    model = create_model()
    model.summary()
    

ğŸ’¡ Early Stopping / æ—©åœæ­¢
=======================

ğŸ“Œ æŠ€æœ¯ä»‹ç»
-------

åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œä¸€ä¸ª epochæŒ‡çš„æ˜¯å®Œæ•´è®­ç»ƒæ•°æ®è¿›è¡Œä¸€è½®çš„è®­ç»ƒã€‚è¿­ä»£è½®æ¬¡epochçš„å¤šå°‘å¯¹äºæ¨¡å‹çš„çŠ¶æ€å½±å“å¾ˆå¤§ï¼šå¦‚æœæˆ‘ä»¬çš„ epoch è®¾ç½®å¤ªå¤§ï¼Œè®­ç»ƒæ—¶é—´è¶Šé•¿ï¼Œä¹Ÿæ›´å¯èƒ½å¯¼è‡´æ¨¡å‹è¿‡æ‹Ÿåˆï¼›ä½†è¿‡å°‘çš„epochå¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹æ¬ æ‹Ÿåˆã€‚

Early stoppingæ—©åœæ­¢æ˜¯ä¸€ç§åˆ¤æ–­è¿­ä»£è½®æ¬¡çš„æŠ€æœ¯ï¼Œå®ƒä¼šè§‚å¯ŸéªŒè¯é›†ä¸Šçš„æ¨¡å‹æ•ˆæœï¼Œä¸€æ—¦æ¨¡å‹æ€§èƒ½åœ¨éªŒè¯é›†ä¸Šåœæ­¢æ”¹è¿›ï¼Œå°±ä¼šåœæ­¢è®­ç»ƒè¿‡ç¨‹ï¼Œå®ƒä¹Ÿç»å¸¸è¢«ä½¿ç”¨æ¥ç¼“è§£æ¨¡å‹è¿‡æ‹Ÿåˆã€‚

![](https://img-blog.csdnimg.cn/img_convert/baa4b705540ddba598671a474b86a441.png)

ğŸ“Œ åŸºäºTensorFlowåº”ç”¨Early stopping
-------------------------------

Keras æœ‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥å®Œæˆearly stoppingã€‚

    from tensorflow.keras.callbacks import EarlyStopping
    early_stopping = EarlyStopping(
        monitor='val_loss',
        min_delta=0,
        patience=0,
        verbose=0,
        mode='auto',
        baseline=None,
        restore_best_weights=False
    )
    

ğŸ“˜[**å‚æ•°**](https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping)

*   **monitor**: è¢«ç›‘æµ‹çš„æ•°æ®ã€‚
*   **min\_delta**: åœ¨è¢«ç›‘æµ‹çš„æ•°æ®ä¸­è¢«è®¤ä¸ºæ˜¯æå‡çš„æœ€å°å˜åŒ–ï¼Œ ä¾‹å¦‚ï¼Œå°äº min\_delta çš„ç»å¯¹å˜åŒ–ä¼šè¢«è®¤ä¸ºæ²¡æœ‰æå‡ã€‚
*   **patience**: æ²¡æœ‰è¿›æ­¥çš„è®­ç»ƒè½®æ•°ï¼Œåœ¨è¿™ä¹‹åè®­ç»ƒå°±ä¼šè¢«åœæ­¢ã€‚
*   **verbose**: è¯¦ç»†ä¿¡æ¯æ¨¡å¼ã€‚
*   **mode**: {auto, min, max} å…¶ä¸­ä¹‹ä¸€ã€‚ åœ¨ `min` æ¨¡å¼ä¸­ï¼Œ å½“è¢«ç›‘æµ‹çš„æ•°æ®åœæ­¢ä¸‹é™ï¼Œè®­ç»ƒå°±ä¼šåœæ­¢ï¼›åœ¨ `max` æ¨¡å¼ä¸­ï¼Œå½“è¢«ç›‘æµ‹çš„æ•°æ®åœæ­¢ä¸Šå‡ï¼Œè®­ç»ƒå°±ä¼šåœæ­¢ï¼›åœ¨ `auto` æ¨¡å¼ä¸­ï¼Œæ–¹å‘ä¼šè‡ªåŠ¨ä»è¢«ç›‘æµ‹çš„æ•°æ®çš„åå­—ä¸­åˆ¤æ–­å‡ºæ¥ã€‚
*   **baseline**: è¦ç›‘æ§çš„æ•°é‡çš„åŸºå‡†å€¼ã€‚ å¦‚æœæ¨¡å‹æ²¡æœ‰æ˜¾ç¤ºåŸºå‡†çš„æ”¹å–„ï¼Œè®­ç»ƒå°†åœæ­¢ã€‚
*   **restore\_best\_weights**: æ˜¯å¦ä»å…·æœ‰ç›‘æµ‹æ•°é‡çš„æœ€ä½³å€¼çš„æ—¶æœŸæ¢å¤æ¨¡å‹æƒé‡ã€‚ å¦‚æœä¸º Falseï¼Œåˆ™ä½¿ç”¨åœ¨è®­ç»ƒçš„æœ€åä¸€æ­¥è·å¾—çš„æ¨¡å‹æƒé‡ã€‚

    from tensorflow.keras.callbacks import EarlyStoppingearly_stopping = EarlyStopping(monitor='loss', patience=2)history = model.fit(
        X_train,
        y_train,
        epochs= 100,
        validation_split= 0.20,
        batch_size= 50,
        verbose= "auto",
        callbacks= [early_stopping]
    )
    

![](https://img-blog.csdnimg.cn/img_convert/70eaa304a77e7c8214b59e80bc70f14f.png)

ğŸ’¡ æ€»ç»“
=====

[ShowMeAI](https://www.showmeai.tech/)åœ¨æœ¬ç¯‡å†…å®¹ä¸­ï¼Œå¯¹ç¼“è§£è¿‡æ‹Ÿåˆçš„æŠ€æœ¯åšäº†ä»‹ç»å’Œåº”ç”¨è®²è§£ï¼Œå¤§å®¶å¯ä»¥åœ¨å®è·µä¸­é€‰æ‹©å’Œä½¿ç”¨ã€‚ã€æ•°æ®å¢å¼ºã€æŠ€æœ¯å°†é€šè¿‡æ„å»ºå’Œæ‰©å¢æ ·æœ¬é›†æ¥ç¼“è§£æ¨¡å‹è¿‡æ‹Ÿåˆï¼Œdropout å±‚é€šè¿‡éšæœºä¸¢å¼ƒä¸€äº›ç¥ç»å…ƒæ¥é™ä½ç½‘ç»œå¤æ‚æ€§ï¼Œæ­£åˆ™åŒ–æŠ€æœ¯å°†æƒ©ç½šç½‘ç»œè®­ç»ƒå¾—åˆ°çš„å¤§å¹…åº¦çš„æƒé‡ï¼Œearly stopping ä¼šé˜²æ­¢ç½‘ç»œè¿‡åº¦è®­ç»ƒå’Œå­¦ä¹ ã€‚

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ **Keras**ï¼š[https://keras.io/](https://keras.io/)
*   ğŸ“˜ **ImageDataGenerator**ï¼š[https://keras.io/zh/preprocessing/image/](https://keras.io/zh/preprocessing/image/)
*   ğŸ“˜ **AIå‚ç›´é¢†åŸŸå·¥å…·åº“é€ŸæŸ¥è¡¨ | Keras é€ŸæŸ¥è¡¨**ï¼š[https://www.showmeai.tech/article-detail/110](https://www.showmeai.tech/article-detail/110)
*   ğŸ“˜ **æ·±åº¦å­¦ä¹ æ•™ç¨‹ï¼šå´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**ï¼š[https://www.showmeai.tech/tutorials/35](https://www.showmeai.tech/tutorials/35)
*   ğŸ“˜ **æ·±åº¦å­¦ä¹ æ•™ç¨‹ | æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢**ï¼š[https://www.showmeai.tech/article-detail/216](https://www.showmeai.tech/article-detail/216)
*   ğŸ“˜ **æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æ•™ç¨‹ï¼šæ–¯å¦ç¦CS231n Â· å…¨å¥—ç¬”è®°è§£è¯»**ï¼š[https://www.showmeai.tech/tutorials/37](https://www.showmeai.tech/tutorials/37)
*   ğŸ“˜ **æ·±åº¦å­¦ä¹ ä¸CVæ•™ç¨‹(7) | ç¥ç»ç½‘ç»œè®­ç»ƒæŠ€å·§ (ä¸‹)**ï¼š[https://www.showmeai.tech/article-detail/266](https://www.showmeai.tech/article-detail/266)

[![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)](https://www.showmeai.tech/)