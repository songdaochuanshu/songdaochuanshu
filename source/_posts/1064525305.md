---
layout: post
title: "Tauri-Vue3æ¡Œé¢ç«¯èŠå¤©å®¤|tauri+vite3ä»¿å¾®ä¿¡|taurièŠå¤©ç¨‹åºEXE"
date: "2022-10-26T22:23:08.224Z"
---
Tauri-Vue3æ¡Œé¢ç«¯èŠå¤©å®¤|tauri+vite3ä»¿å¾®ä¿¡|taurièŠå¤©ç¨‹åºEXE
============================================

åŸºäºtauri+vue3.js+vite3è·¨æ¡Œé¢ç«¯ä»¿å¾®ä¿¡èŠå¤©å®ä¾‹_TauriVue3Chat_ã€‚

**tauri-chat** è¿ç”¨æœ€æ–°tauri+vue3+vite3+element-plus+v3layerç­‰æŠ€æœ¯è·¨æ¡Œé¢ç«¯ä»¿å¾®ä¿¡|QQèŠå¤©ç¨‹åºEXEã€‚åŸºæœ¬å®ç°äº†å‘é€å›¾æ–‡æ··æ’æ¶ˆæ¯ã€å›¾ç‰‡/è§†é¢‘/ç½‘å€é¢„è§ˆã€æ‹–æ‹½èŠå¤©åŒºå‘é€å›¾ç‰‡ã€æœ‹å‹åœˆç­‰åŠŸèƒ½ã€‚æ”¯æŒtauriæ‰“å¼€å¤šä¸ªçª—ä½“ã€æ›´æ¢ä¸»é¢˜çš®è‚¤ç­‰åŠŸèƒ½ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221026234932955-2025508281.png)

### ä¸€ã€æŠ€æœ¯æ¡†æ¶

*   ç¼–è¾‘å™¨ï¼šVScode
*   ä½¿ç”¨æŠ€æœ¯ï¼štauri+vue^3.2.37+vite^3.0.2+vuex4+vue-router@4
*   UIç»„ä»¶åº“ï¼šelement-plus^2.2.17 (é¥¿äº†ä¹ˆvue3ç»„ä»¶åº“)
*   å¼¹çª—ç»„ä»¶ï¼šv3layerï¼ˆåŸºäºvue3è‡ªå®šä¹‰pcç«¯å¼¹çª—ç»„ä»¶ï¼‰
*   æ»šåŠ¨æ¡ç»„ä»¶ï¼šv3scrollï¼ˆåŸºäºvue3æ¨¡æ‹Ÿæ»šåŠ¨æ¡ç»„ä»¶ï¼‰
*   çŸ¢é‡å›¾æ ‡ï¼šé˜¿é‡Œiconfontå­—ä½“å›¾æ ‡åº“

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221026235417656-2107225755.gif)

### äºŒã€é¡¹ç›®ç»“æ„

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221026235604337-58894863.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221026235734211-2056861939.gif)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221026235953799-301845373.gif)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000016427-1214884911.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000047027-656200018.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000111564-791951753.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000135004-114590603.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000156385-1092721312.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000209717-2131268694.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000248881-290674796.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000340733-1601808723.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000441021-378517690.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000455073-1197784686.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000611298-2082215043.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000620539-865647645.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000654828-324903698.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000953518-1038037865.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000716670-1126728393.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000800212-1650914402.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027000841862-1431181513.png)

### **â—† Tauriæ–°å»ºå¤šå¼€çª—å£**

é¡¹ç›®ä¸­ä¸»é¢˜æ¢è‚¤ã€æœ‹å‹åœˆã€å…³äºã€è§†é¢‘é¢„è§ˆç­‰çª—å£å‡æ˜¯æ–°å¼€çª—å£ã€‚

// å…³äº
const openAboutWin = () => {
    createWin({
        label: 'about',
        title: 'å…³äº',
        url: '/about',
        width: 430,
        height: 330,
        resizable: false,
        alwaysOnTop: true,
    })
}

// ä¸»é¢˜æ¢è‚¤
const openThemeSkinWin = () => {
    createWin({
        label: 'skin',
        title: 'æ¢è‚¤',
        url: '/skin',
        width: 630,
        height: 400,
        resizable: false,
    })
}

// æœ‹å‹åœˆ
const openQzoneWin = () => {
    createWin({
        label: 'fzone',
        title: 'æœ‹å‹åœˆ',
        url: '/fzone',
        width: 550,
        height: 700,
        resizable: false,
    })
}

tauriå¤šçª—å£å‚æ•°é…ç½®

// çª—å£é…ç½®
export const windowConfig = {
    label: null,            // çª—å£å”¯ä¸€label
    title: '',              // çª—å£æ ‡é¢˜
    url: '',                // è·¯ç”±åœ°å€url
    width: 900,             // çª—å£å®½åº¦
    height: 640,            // çª—å£é«˜åº¦
    minWidth: null,         // çª—å£æœ€å°å®½åº¦
    minHeight: null,        // çª—å£æœ€å°é«˜åº¦
    x: null,                // çª—å£ç›¸å¯¹äºå±å¹•å·¦ä¾§åæ ‡
    y: null,                // çª—å£ç›¸å¯¹äºå±å¹•é¡¶ç«¯åæ ‡
    center: true,           // çª—å£å±…ä¸­æ˜¾ç¤º
    resizable: true,        // æ˜¯å¦æ”¯æŒç¼©æ”¾
    maximized: false,       // æœ€å¤§åŒ–çª—å£
    decorations: false,     // çª—å£æ˜¯å¦æ— è¾¹æ¡†åŠå¯¼èˆªæ¡
    alwaysOnTop: false,     // ç½®é¡¶çª—å£
    fileDropEnabled: false, // ç¦æ­¢ç³»ç»Ÿæ‹–æ”¾
    visible: false,         // éšè—çª—å£
}

ç”±äºä¹‹å‰æœ‰å†™è¿‡ä¸€ç¯‡vue3+tauriåˆ›å»ºå¤šçª—å£çš„åˆ†äº«æ–‡ç« ï¼Œè¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»äº†ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/16812092.html](https://www.cnblogs.com/xiaoyan2017/p/16812092.html)

### **â—† Tauriè‡ªå®šä¹‰æ‹–æ‹½çª—ä½“|æœ€å¤§åŒ–/æœ€å°åŒ–/å…³é—­åŠŸèƒ½**

åˆ›å»ºçª—å£çš„æ—¶å€™é…ç½®Â decorations: falseÂ å‚æ•°ï¼Œåˆ™åˆ›å»ºçš„çª—å£æ²¡æœ‰é¡¶éƒ¨å¯¼èˆªæ åŠè¾¹æ¡†ã€‚æ‹–æ‹½åŒºåŸŸ/æœ€å¤§åŒ–/æœ€å°åŒ–åŠå…³é—­æŒ‰é’®éƒ½éœ€è¦è‡ªå®šä¹‰åŠŸèƒ½ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027002719131-235938324.png)

tauriæä¾›äº†Â data-tauri-drag-regionÂ å±æ€§ï¼Œåœ¨éœ€è¦æ‹–æ‹½çš„å…ƒç´ ä¸Šè®¾ç½®è¯¥å±æ€§ï¼Œè¯¥åŒºåŸŸå°±èƒ½è‡ªç”±æ‹–æ‹½äº†ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027002412566-1725607765.gif)

<template\>
    <div class\="nt\_\_navbar"\>
        <div data-tauri-drag-region class\="nt\_\_navbar-wrap"\>
            <div class\="nt\_\_navbar-title"\>
                <template v-if\="$slots.title"\><slot name\="title" /></template\>
                <template v-else\>{{title}}</template\>
            </div\>
        </div\>
        <WinTool :minimizable\="minimizable" :maximizable\="maximizable" :closable\="closable"\>
            <slot name\="wbtn" />
        </WinTool\>
    </div\>
</template\>

ä¸‹é¢è¿™ç¯‡æ–‡ç« ä»‹ç»tauriè‡ªå®šä¹‰æœ€å¤§åŒ–/æœ€å°åŒ–åŠå…³é—­æŒ‰é’®åŠŸèƒ½ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/16818283.html](https://www.cnblogs.com/xiaoyan2017/p/16818283.html)

### **â—† Tauriåˆ›å»ºç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡**

å½“å…³é—­çª—ä½“çš„æ—¶å€™ï¼Œä¼šåˆ¤æ–­æ˜¯å¦ä¸»çª—å£ï¼Œå¹¶ç»™å‡ºå…³é—­æç¤ºã€‚å½“ä¸æ˜¯ä¸»çª—å£ï¼Œåˆ™ç›´æ¥å…³é—­ï¼Œæ˜¯ä¸»çª—å£åˆ™ç»™å‡ºä¸‹å›¾å¼¹çª—æç¤ºã€‚æœ€å°åŒ–è‡³æ‰˜ç›˜ åˆ™æ˜¯éšè—çª—å£ï¼Œé€€å‡ºç¨‹åºåˆ™ç›´æ¥æ‰§è¡Œexitæ–¹æ³•é€€å‡ºåº”ç”¨äº†ã€‚

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027003549038-1500733271.png)

// å…³é—­çª—ä½“
const handleCloseWindow = async() => {
    if(appWindow.label.indexOf('main') > -1) {
        let $el \= v3layer({
            type: 'android',
            content: 'ç¡®è®¤é€€å‡ºåº”ç”¨ç¨‹åºå—ï¼Ÿ',
            btns: \[
                {
                    text: 'æœ€å°åŒ–æ‰˜ç›˜',
                    style: 'color:#24c8db',
                    click: () \=> {
                        $el.close()
                        await appWindow.hide()
                    }
                },
                {
                    text: 'é€€å‡ºç¨‹åº',
                    style: 'color:#ff5438',
                    click: async() \=> {
                        $el.close()
                        store.commit('LOGOUT')
                        await exit()
                    }
                }
            \]
        })
    }else {
        await appWindow.close()
    }
}

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027004148248-1753961682.png)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027005310853-1473416979.png)

/\*\*
 \* åˆ›å»ºç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡Tray
 \*/

use tauri::{
    AppHandle, Manager, 
    CustomMenuItem, SystemTray, SystemTrayEvent, SystemTrayMenu, SystemTrayMenuItem, SystemTraySubmenu
};

// æ‰˜ç›˜èœå•
pub fn menu() -> SystemTray {
    let exit \= CustomMenuItem::new("exit".to\_string(), "é€€å‡º");
    let relaunch \= CustomMenuItem::new("relaunch".to\_string(), "é‡å¯åº”ç”¨");
    let show \= CustomMenuItem::new("show".to\_string(), "æ˜¾ç¤ºçª—å£");
    let hide \= CustomMenuItem::new("hide".to\_string(), "éšè—çª—å£");
    let change\_ico \= CustomMenuItem::new("change\_ico".to\_string(), "æ›´æ¢æ‰˜ç›˜å›¾æ ‡");
    let tray\_menu \= SystemTrayMenu::new()
        .add\_submenu(SystemTraySubmenu::new(
            "å›½é™…åŒ–", // è¯­è¨€èœå•
            SystemTrayMenu::new()
                .add\_item(CustomMenuItem::new("lang\_english".to\_string(), "English"))
                .add\_item(CustomMenuItem::new("lang\_zh\_CN".to\_string(), "ç®€ä½“ä¸­æ–‡"))
                .add\_item(CustomMenuItem::new("lang\_zh\_HK".to\_string(), "ç¹ä½“ä¸­æ–‡")),
        ))
        .add\_native\_item(SystemTrayMenuItem::Separator) // åˆ†å‰²çº¿
        .add\_item(change\_ico)
        .add\_native\_item(SystemTrayMenuItem::Separator)
        .add\_item(hide)
        .add\_item(show)
        .add\_native\_item(SystemTrayMenuItem::Separator)
        .add\_item(relaunch)
        .add\_item(exit);

    SystemTray::new().with\_menu(tray\_menu)
}

// æ‰˜ç›˜äº‹ä»¶
pub fn handler(app: &AppHandle, event: SystemTrayEvent) {
    match event {
        SystemTrayEvent::LeftClick {
            position: \_,
            size: \_,
            ..
        } \=> {
            println!("ç‚¹å‡»å·¦é”®");
        }
        SystemTrayEvent::RightClick {
            position: \_,
            size: \_,
            ..
        } \=> {
            println!("ç‚¹å‡»å³é”®");
        }
        SystemTrayEvent::DoubleClick {
            position: \_,
            size: \_,
            ..
        } \=> {
            println!("åŒå‡»");
            app.emit\_all("win-show", {}).unwrap();
        }
        SystemTrayEvent::MenuItemClick { id, .. } \=> match id.as\_str() {
            // æ›´æ–°æ‰˜ç›˜å›¾æ ‡
            "change\_ico" => {
                app.tray\_handle()
                    .set\_icon(tauri::Icon::Raw(
                        include\_bytes!("../icons/tray-empty.ico").to\_vec()
                    ))
                    .unwrap();
            }
            // é€‰æ‹©è¯­è¨€ï¼ŒåŒ¹é… id å‰ç¼€åŒ…å« \`lang\_\` çš„äº‹ä»¶
            lang if lang.contains("lang\_") => {
                Lang::new(
                    app,
                    id,
                    vec!\[
                        Lang {
                            name: "English",
                            id: "lang\_english",
                        },
                        Lang {
                            name: "ç¹ä½“ä¸­æ–‡",
                            id: "lang\_zh\_HK",
                        },
                        Lang {
                            name: "ç®€ä½“ä¸­æ–‡",
                            id: "lang\_zh\_CN",
                        },
                    \],
                );
            }
            "hide" => {
                // println!("ç‚¹å‡»éšè—");
                app.emit\_all("win-hide", {}).unwrap();
            }
            "show" => {
                // println!("ç‚¹å‡»æ˜¾ç¤º");
                app.emit\_all("win-show", {}).unwrap();
            }
            "relaunch" => {
                // println!("ç‚¹å‡»é‡å¯");
                app.emit\_all("win-relaunch", {}).unwrap();
            }
            "exit" => {
                // println!("ç‚¹å‡»é€€å‡º");
                app.emit\_all("win-exit", {}).unwrap();
            }
            \_ \=> {}
        },
        \_ \=> {}
    }
}

struct Lang<'a> {
    name: &'a str,
    id: &'a str,
}

impl Lang<'static> {
    fn new(app: &AppHandle, id: String, langs: Vec<Lang>) {
        // è·å–ç‚¹å‡»çš„èœå•é¡¹çš„å¥æŸ„
        langs.iter().for\_each(|lang| {
            let handle \= app.tray\_handle().get\_item(lang.id);
            if lang.id.to\_string() == id.as\_str() {
                // è®¾ç½®èœå•åç§°
                handle.set\_title(format!("  {}", lang.name)).unwrap();
                handle.set\_selected(true).unwrap();
            } else {
                handle.set\_title(lang.name).unwrap();
                handle.set\_selected(false).unwrap();
            }
        });
    }
}

tauriåˆ›å»ºæ‰˜ç›˜å›¾æ ‡é»˜è®¤è¯»å–Â src-tauri/iconsÂ ç›®å½•ä¸‹å›¾æ ‡ï¼Œå¦‚æœè‡ªå®šä¹‰çš„.icoå›¾æ ‡ï¼Œå¯åœ¨tauri.cong.jsonæ–‡ä»¶ä¸­é…ç½®ã€‚

"systemTray": {
    "iconPath": "icons/tray.ico",
    "iconAsTemplate": true,
    "menuOnLeftClick": false
}

ä½¿ç”¨icoå›¾æ ‡æŠ¥é”™ï¼Œéœ€è¦åœ¨Â src-tauri/src/Cargo.tomlÂ ä¸­é…ç½®Â icon-icoÂ æˆ–Â icon-png

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027005110881-540020133.png)

**tauri build** æ‰“åŒ…æ„å»ºï¼Œå¦‚æœæ‰“åŒ…çš„æ—¶å€™æŠ¥é”™ï¼Œéœ€è¦åœ¨ _src-tauri/tauri.conf.json_ è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ° **identifier** è¿™ä¸ªå­—æ®µï¼Œå°†å®ƒçš„å€¼è¿›è¡Œæ›´æ”¹å³å¯ã€‚

**tauri.conf.jsoné…ç½®æ–‡ä»¶**

{
  "build": {
    "beforeDevCommand": "npm run dev",
    "beforeBuildCommand": "npm run build",
    "devPath": "http://localhost:1420",
    "distDir": "../dist",
    "withGlobalTauri": false
  },
  "package": {
    "productName": "tauri-chat",
    "version": "0.0.0"
  },
  "tauri": {
    "allowlist": {
      "all": true
    },
    "bundle": {
      "active": true,
      "category": "DeveloperTool",
      "copyright": "",
      "deb": {
        "depends": \[\]
      },
      "externalBin": \[\],
      "icon": \[
        "icons/32x32.png",
        "icons/128x128.png",
        "icons/128x128@2x.png",
        "icons/icon.icns",
        "icons/icon.ico"
      \],
      "identifier": "com.tauri.chat",
      "longDescription": "",
      "macOS": {
        "entitlements": null,
        "exceptionDomain": "",
        "frameworks": \[\],
        "providerShortName": null,
        "signingIdentity": null
      },
      "resources": \[\],
      "shortDescription": "",
      "targets": "all",
      "windows": {
        "certificateThumbprint": null,
        "digestAlgorithm": "sha256",
        "timestampUrl": ""
      }
    },
    "security": {
      "csp": null
    },
    "updater": {
      "active": false
    },
    "windows": \[
      {
        "fullscreen": false,
        "height": 640,
        "resizable": true,
        "title": "TAURI-CHAT",
        "width": 900,
        "center": true,
        "decorations": false,
        "fileDropEnabled": false,
        "visible": false
      }
    \],
    "systemTray": {
      "iconPath": "icons/tray.ico",
      "iconAsTemplate": true,
      "menuOnLeftClick": false
    }
  }
}

Okerï¼ŒåŸºäºtauri+vue3å®æˆ˜æ¡Œé¢ç«¯èŠå¤©åº”ç”¨å°±åˆ†äº«åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰äº›å¸®åŠ©ã€‚ğŸ’

**æœ€åé™„ä¸Šä¸€ä¸ªuniapp+uviewè·¨ç«¯åå°ç®¡ç†ç³»ç»Ÿ**

[https://www.cnblogs.com/xiaoyan2017/p/15836112.html](https://www.cnblogs.com/xiaoyan2017/p/15836112.html)

![](https://img2022.cnblogs.com/blog/1289798/202210/1289798-20221027011031591-652180180.gif)

æœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œæœªç»åšä¸»å…è®¸ä¸å¾—è½¬è½½ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµ QQï¼ˆ282310962ï¼‰ wxï¼ˆxy190310ï¼‰