---
layout: post
title: "Djangoçš„ç®€å•ä½¿ç”¨"
date: "2022-11-11T09:19:52.621Z"
---
Djangoçš„ç®€å•ä½¿ç”¨
===========

Django åŸºç¡€ç®€ä»‹
===========

åŸºç¡€ç®€ä»‹
====

1\. è½¯ä»¶æ¡†æ¶
--------

ä¸€ä¸ªå…¬å¸æ˜¯ç”±å…¬å¸ä¸­çš„å„éƒ¨éƒ¨é—¨æ¥ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªéƒ¨é—¨æ‹¥æœ‰ç‰¹å®šçš„èŒèƒ½ï¼Œéƒ¨é—¨ä¸éƒ¨é—¨ä¹‹é—´é€šè¿‡ç›¸äº’çš„é…åˆæ¥å®Œæˆè®©å…¬å¸è¿è½¬èµ·æ¥ã€‚

ä¸€ä¸ªè½¯ä»¶æ¡†æ¶æ˜¯ç”±å…¶ä¸­å„ä¸ªè½¯ä»¶æ¨¡å—ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½ï¼Œæ¨¡å—ä¸æ¨¡å—ä¹‹é—´é€šè¿‡ç›¸äº’é…åˆæ¥å®Œæˆè½¯ä»¶çš„å¼€å‘ã€‚

è½¯ä»¶æ¡†æ¶æ˜¯é’ˆå¯¹æŸä¸€ç±»è½¯ä»¶è®¾è®¡é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚

2\. MVCæ¡†æ¶
---------

### 2.1 MVCç®€ä»‹

MVCæœ€åˆæ˜¯ç”±æ–½ä¹å…¬å¸æ——ä¸‹çš„å¸•ç½—å¥¥å¤šç ”ç©¶ä¸­å¿ƒä¸­çš„ä¸€ä½ç ”ç©¶äººå‘˜ç»™ smalltalkè¯­è¨€å‘æ˜çš„ä¸€ä¸­è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚

MVCçš„äº§ç”Ÿç†å¿µï¼š **åˆ†å·¥**ã€‚è®©ä¸“é—¨çš„äººå»åšä¸“é—¨çš„äº‹ã€‚

MVCçš„æ ¸å¿ƒæ€æƒ³ï¼š **è§£è€¦**ã€‚

MVCçš„æ€æƒ³è¢«åº”ç”¨åœ¨çš„webå¼€å‘çš„æ–¹é¢ï¼Œäº§ç”Ÿäº†**web MVCæ¡†æ¶**ã€‚

### 2.2 Web MVCæ¡†æ¶æ¨¡å—åŠŸèƒ½

é€šè¿‡æµè§ˆå™¨æ³¨å†Œç”¨æˆ·ä¿¡æ¯ã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717794682-9b78cd08-c484-430c-879f-d145fda33399.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u7f9bbbfe&name=image.png&originHeight=760&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=138340&status=done&style=none&taskId=u3a4eba0a-ca70-4597-bfd7-7b56dff4b5a&title=)

M:Model,æ¨¡å‹ï¼Œ å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

V:View,è§†å›¾ï¼Œ äº§ç”Ÿhtmlé¡µé¢ã€‚

C:Controller,æ§åˆ¶å™¨, æ¥æ”¶è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œä¸Må’ŒVè¿›è¡Œäº¤äº’ï¼Œè¿”å›åº”ç­”ã€‚

3\. Djangoæ¡†æ¶
------------

### 3.1 ç®€ä»‹

Djangoæ˜¯åŠ³ä¼¦æ–¯å‡ºç‰ˆé›†å›¢çš„å¼€å‘äººå‘˜ä¸ºå¼€å‘æ–°é—»å†…å®¹ç½‘ç«™è€Œè®¾è®¡å‡ºæ¥çš„ä¸€ä¸ªè½¯ä»¶ï¼Œå®ƒéµå¾ªMVCæ€æƒ³ï¼Œä½†æ˜¯æœ‰è‡ªå·±çš„ä¸€ä¸ªåè¯ï¼Œå«åš**MVT**ã€‚

Djangoéµå¾ªå¿«é€Ÿå¼€å‘å’ŒDRYåŸåˆ™ã€‚Do not repeat yourself.ä¸è¦è‡ªå·±å»é‡å¤ä¸€äº›å·¥ä½œã€‚

### 3.2 MVTå„éƒ¨åˆ†åŠŸèƒ½

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717799075-02b90131-f616-47e8-8796-915a453d7e31.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ua5d9d299&name=image.png&originHeight=742&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=133721&status=done&style=none&taskId=u966fc7e3-3c78-466f-99cf-650450368d5&title=)

M:Model,æ¨¡å‹ï¼Œ å’ŒMVCä¸­MåŠŸèƒ½ç›¸åŒï¼Œå’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

V:View,è§†å›¾ï¼Œ å’ŒMVCä¸­CåŠŸèƒ½ç›¸åŒï¼Œæ¥æ”¶è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œä¸Må’ŒTè¿›è¡Œäº¤äº’ï¼Œè¿”å›åº”ç­”ã€‚

T:Template,æ¨¡æ¿ï¼Œ å’ŒMVCä¸­VåŠŸèƒ½ç›¸åŒï¼Œäº§ç”Ÿhtmlé¡µé¢ã€‚

4\. è™šæ‹Ÿç¯å¢ƒ
--------

### 4.1 æ¦‚å¿µ

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717803947-1e80e248-b278-44a7-a31b-faa08a22b522.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u42e48eab&name=image.png&originHeight=382&originWidth=1156&originalType=url&ratio=1&rotation=0&showTitle=false&size=24365&status=done&style=none&taskId=ueb8a4ba2-57d6-4999-ae46-0e753ff8608&title=)

ä¹‹å‰å®‰è£…pythonåŒ…çš„å‘½ä»¤ï¼š sudo pip3 install åŒ…å

åŒ…çš„å®‰è£…è·¯å¾„ï¼š/usr/local/lib/python3.5/dist-packages

åœ¨åŒä¸€ä¸ªpythonç¯å¢ƒä¸­å®‰è£…åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œåå®‰è£…çš„åŒ…ä¼šæŠŠåŸæ¥å®‰è£…çš„åŒ…è¦†ç›–æ‰ã€‚è¿™æ ·ï¼Œå¦‚æœåŒä¸€å°æœºå™¨ä¸Šä¸¤ä¸ªé¡¹ç›®ä¾èµ–äºç›¸åŒåŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œåˆ™ä¼šå¯¼è‡´ä¸€äº›é¡¹ç›®è¿è¡Œå¤±è´¥ã€‚

è§£å†³çš„æ–¹æ¡ˆå°±æ˜¯ï¼šè™šæ‹Ÿç¯å¢ƒã€‚

**è™šæ‹Ÿç¯å¢ƒæ˜¯çœŸå®pythonç¯å¢ƒçš„å¤åˆ¶ç‰ˆæœ¬ã€‚**

**åœ¨è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨çš„pythonæ˜¯å¤åˆ¶çš„python,å®‰è£…pythonåŒ…ä¹Ÿæ˜¯å®‰è£…åœ¨å¤åˆ¶çš„pythonä¸­ã€‚**

### 4.2 å®‰è£…å’Œé…ç½®

**å®‰è£…è™šæ‹Ÿç¯å¢ƒçš„å‘½ä»¤ï¼š**

1ï¼‰`sudo pip install virtualenv -i [https://pypi.tuna.tsinghua.edu.cn/simple/](https://pypi.tuna.tsinghua.edu.cn/simple/)` #å®‰è£…è™šæ‹Ÿç¯å¢ƒ

2ï¼‰`sudo pip install virtualenvwrapper -i [https://pypi.tuna.tsinghua.edu.cn/simple/](https://pypi.tuna.tsinghua.edu.cn/simple/)` #å®‰è£…è™šæ‹Ÿç¯å¢ƒæ‰©å±•åŒ…

3ï¼‰ç¼–è¾‘å®¶ç›®å½•ä¸‹é¢çš„.bashrcæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢ä¸¤è¡Œã€‚

    export WORKON_HOME=$HOME/.virtualenvs
    export VIRTUALENVWRAPPER_PYTHON='/usr/bin/python3'
    # export VIRTUALENVWRAPPER_VIRTUALENV=~/virtualenvs
    export VIRTUALENVWRAPPER_VIRTUALENV=~/.local/bin/virtualenv
    source /usr/local/bin/virtualenvwrapper.sh
    

4ï¼‰ä½¿ç”¨source .bashrcä½¿å…¶ç”Ÿæ•ˆä¸€ä¸‹ã€‚

### 4.3 ä½¿ç”¨

**åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå‘½ä»¤ï¼š**

> mkvirtualenv è™šæ‹Ÿç¯å¢ƒå

**åˆ›å»ºpython3è™šæ‹Ÿç¯å¢ƒï¼š**

> mkvirtualenv -p python3 bj11\_py3

**è¿›å…¥è™šæ‹Ÿç¯å¢ƒå·¥ä½œï¼š**

> workon è™šæ‹Ÿç¯å¢ƒå

**æŸ¥çœ‹æœºå™¨ä¸Šæœ‰å¤šå°‘ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š**

> workon ç©ºæ ¼ + ä¸¤ä¸ªtabé”®

**é€€å‡ºè™šæ‹Ÿç¯å¢ƒï¼š**

> deactivate

**åˆ é™¤è™šæ‹Ÿç¯å¢ƒï¼š**

> rmvirtualenv è™šæ‹Ÿç¯å¢ƒå

è™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…åŒ…çš„å‘½ä»¤ï¼š

> pip install åŒ…å

æ³¨æ„ï¼šä¸èƒ½ä½¿ç”¨sudo pip install åŒ…åï¼Œè¿™ä¸ªå‘½ä»¤ä¼šæŠŠåŒ…å®‰è£…åˆ°çœŸå®çš„ä¸»æœºç¯å¢ƒä¸Šè€Œä¸æ˜¯å®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒä¸­ã€‚

**æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…äº†å“ªäº›pythonåŒ…ï¼š**

> pip list  
> pip freeze

**å®‰è£…djangoç¯å¢ƒï¼š**

> pip install django==3.2.6

**æ‹“å±•:**

> apt-get install è½¯ä»¶

> pip install pythonåŒ…å

5\. é¡¹ç›®åˆ›å»º
--------

### 5.1 åˆ›å»ºDjangoé¡¹ç›®

å‘½ä»¤ï¼š

> django-admin startproject é¡¹ç›®å

æ³¨æ„ï¼šåˆ›å»ºåº”ç”¨å¿…é¡»å…ˆè¿›å…¥è™šæ‹Ÿç¯å¢ƒã€‚

é¡¹ç›®ç›®å½•å¦‚ä¸‹ï¼š

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717820789-9cc9d4f8-68b4-407b-aa2c-0094e4e68b3a.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u7f6697e1&name=image.png&originHeight=400&originWidth=918&originalType=url&ratio=1&rotation=0&showTitle=false&size=32979&status=done&style=none&taskId=ud1bde44e-defe-46ba-b011-6b98a2d399f&title=)

### 5.2 åˆ›å»ºDjangoåº”ç”¨

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717824293-714e5222-5ed4-4889-a037-c0eb7cadb2c4.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u256378df&name=image.png&originHeight=400&originWidth=918&originalType=url&ratio=1&rotation=0&showTitle=false&size=32979&status=done&style=none&taskId=uc073a185-6474-42ab-b504-787a4236aa4&title=)

ä¸€ä¸ªé¡¹ç›®ç”±å¾ˆå¤šä¸ªåº”ç”¨ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªåº”ç”¨å®Œæˆä¸€ä¸ªåŠŸèƒ½æ¨¡å—ã€‚

åˆ›å»ºåº”ç”¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š

> python manage.py startapp åº”ç”¨å

æ³¨æ„ï¼šåˆ›å»ºåº”ç”¨æ—¶éœ€è¦å…ˆè¿›å…¥é¡¹ç›®ç›®å½•ã€‚

åº”ç”¨ç›®å½•å¦‚ä¸‹ï¼š

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717838906-d19eaf77-9d27-40d4-baf3-d5efd9ed774d.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u525246f6&name=image.png&originHeight=384&originWidth=1024&originalType=url&ratio=1&rotation=0&showTitle=false&size=30074&status=done&style=none&taskId=ub92e89b9-895e-40bb-a3c9-597c2d29f59&title=)

### 5.3 åº”ç”¨æ³¨å†Œ

å»ºç«‹åº”ç”¨å’Œé¡¹ç›®ä¹‹é—´çš„è”ç³»ï¼Œéœ€è¦å¯¹åº”ç”¨è¿›è¡Œæ³¨å†Œã€‚

ä¿®æ”¹settings.pyä¸­çš„INSTALLED\_APPSé…ç½®é¡¹ã€‚

### 5.4 å¯åŠ¨é¡¹ç›®

è¿è¡Œå¼€å‘webæœåŠ¡å™¨å‘½ä»¤ï¼š

> python manage.py runserver

6\. æ¨¡å‹ç±»
-------

### 6.1 ORM

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717834186-f0045509-0600-417f-b365-65f09b5dc33a.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ub437bbeb&name=image.png&originHeight=684&originWidth=1101&originalType=url&ratio=1&rotation=0&showTitle=false&size=71780&status=done&style=none&taskId=u27f99158-18af-4a5f-992b-bd112d4fa97&title=)

djangoä¸­å†…åµŒäº†ORMæ¡†æ¶ï¼ŒORMæ¡†æ¶å¯ä»¥å°†ç±»å’Œæ•°æ®è¡¨è¿›è¡Œå¯¹åº”èµ·æ¥ï¼Œåªéœ€è¦é€šè¿‡ç±»å’Œå¯¹è±¡å°±å¯ä»¥å¯¹æ•°æ®è¡¨è¿›è¡Œæ“ä½œã€‚

åœ¨Djangoä¸­ä¸»è¦æ˜¯è®¾è®¡ç±»ï¼šæ¨¡å‹ç±»ã€‚

ORMå¦å¤–ä¸€ä¸ªä½œç”¨ï¼šæ ¹æ®è®¾è®¡çš„ç±»ç”Ÿæˆæ•°æ®åº“ä¸­çš„è¡¨ã€‚

### 6.2 æ¨¡å‹ç±»è®¾è®¡

åœ¨åº”ç”¨models.pyä¸­è®¾è®¡æ¨¡å‹ç±»ã€‚

å¿…é¡»ç»§æ‰¿ä¸models.Modelç±»ã€‚

1.  è®¾è®¡BookInfoç±»ã€‚
2.  è®¾è®¡HeroInfoç±»ã€‚

Models.ForeignKeyå¯ä»¥å»ºç«‹ä¸¤ä¸ªæ¨¡å‹ç±»ä¹‹é—´ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œdjangoåœ¨ç”Ÿæˆè¡¨çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨å¤šç«¯çš„è¡¨ä¸­åˆ›å»ºä¸€åˆ—ä½œä¸ºå¤–é”®ï¼Œå»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´ä¸€å¯¹å¤šçš„å…³ç³»ã€‚

### 6.3 æ¨¡å‹ç±»ç”Ÿæˆè¡¨

1.  ç”Ÿæˆè¿ç§»æ–‡ä»¶  
    å‘½ä»¤ï¼špython manage.py makemigrations  
    ![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717845766-636586c5-2967-4cd3-8593-2fb97d88831d.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u9fcfa9a7&name=image.png&originHeight=275&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=84678&status=done&style=none&taskId=u3956e7e9-228b-4878-b223-3b915dc1805&title=)  
    è¿ç§»æ–‡ä»¶æ˜¯æ ¹æ®æ¨¡å‹ç±»ç”Ÿæˆçš„ã€‚
2.  è¡Œè¿ç§»ç”Ÿæˆè¡¨  
    å‘½ä»¤ï¼špython mange.py migrate  
    æ ¹æ®è¿ç§»æ–‡ä»¶ç”Ÿæˆè¡¨ã€‚  
    ç”Ÿæˆè¡¨åçš„é»˜è®¤æ ¼å¼ï¼š  
    åº”ç”¨å\_æ¨¡å‹ç±»åå°å†™

### 6.4 é€šè¿‡æ¨¡å‹ç±»æ“ä½œæ•°æ®è¡¨

è¿›å…¥é¡¹ç›®shellçš„å‘½ä»¤:

> python manage.py shell

ä»¥ä¸‹ä¸ºåœ¨ç›¸äº’shellç»ˆç«¯ä¸­æ¼”ç¤ºçš„ä¾‹å­ï¼š

é¦–å…ˆå¯¼å…¥æ¨¡å‹ç±»ï¼š

> from booktest.models import BookInfo,HeroInfo

1.  oktest\_bookinfoè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ã€‚

    b = BookInfo() #å®šä¹‰ä¸€ä¸ªBookInfoç±»çš„å¯¹è±¡
    b.btitle ='å¤©é¾™å…«éƒ¨' #å®šä¹‰bå¯¹è±¡çš„å±æ€§å¹¶èµ‹å€¼
    b.bpub_date = date(1990,10,11)
    b.save() #æ‰ä¼šå°†æ•°æ®ä¿å­˜è¿›æ•°æ®åº“
    

2.  booktest\_bookinfoè¡¨ä¸­idä¸º1çš„æ•°æ®ã€‚

    b = BookInfo.objects.get(id=1)
    

3.  æ­¥çš„åŸºç¡€ä¸Šæ”¹å˜bå¯¹åº”å›¾ä¹¦çš„å‡ºç‰ˆæ—¥æœŸã€‚

    b.bpub_date = date(1989,10,21)
    b.save() #æ‰ä¼šæ›´æ–°è¡¨æ ¼ä¸­çš„æ•°æ®
    

4.  ä¸€æ­¥ï¼Œåˆ é™¤bå¯¹åº”çš„å›¾ä¹¦çš„æ•°æ®ã€‚

    b.delete() #æ‰ä¼šåˆ é™¤
    

5.  oktest\_heroInfoè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ã€‚

    h = HeroInfo()
    h.hname = 'éƒ­é–'
    h.hgender = False
    h.hcomment = 'é™é¾™åå…«æŒ'
    b2 = BookInfo.objects.get(id=2)
    h.hbook = b2 #ç»™å…³ç³»å±æ€§èµ‹å€¼ï¼Œè‹±é›„å¯¹è±¡æ‰€å±çš„å›¾ä¹¦å¯¹è±¡
    h.save()
    

6.  ä¹¦è¡¨é‡Œé¢çš„æ‰€æœ‰å†…å®¹ã€‚

    BookInfo.objects.all()
    HeroInfo.objects.all()
    

### 6.5 å…³è”æ“ä½œ

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717855496-97bea734-67fe-468b-bdc5-aba099ad6f9a.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uf57670bd&name=image.png&originHeight=509&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=65323&status=done&style=none&taskId=u2b376647-bd96-4e8f-8516-03c861539bf&title=)

1.  æŸ¥è¯¢å‡ºidä¸º2çš„å›¾ä¹¦ä¸­æ‰€æœ‰è‹±é›„äººç‰©çš„ä¿¡æ¯ã€‚

    b = BookInfo.objects.get(id=2)
    b.heroinfo_set.all() #æŸ¥è¯¢å‡ºbå›¾ä¹¦ä¸­æ‰€æœ‰è‹±é›„äººç‰©çš„ä¿¡æ¯
    

7\. åå°ç®¡ç†
--------

1.  æœ¬åœ°åŒ–

> è¯­è¨€å’Œæ—¶åŒºçš„æœ¬åœ°åŒ–ã€‚
> 
> ä¿®æ”¹settings.pyæ–‡ä»¶ã€‚

1.  åˆ›å»ºç®¡ç†å‘˜

> å‘½ä»¤ï¼špython manage.py createsuperuser

1.  æ³¨å†Œæ¨¡å‹ç±»

> åœ¨åº”ç”¨ä¸‹çš„admin.pyä¸­æ³¨å†Œæ¨¡å‹ç±»ã€‚
> 
> å‘Šè¯‰djangæ¡†æ¶æ ¹æ®æ³¨å†Œçš„æ¨¡å‹ç±»æ¥ç”Ÿæˆå¯¹åº”è¡¨ç®¡ç†é¡µé¢ã€‚

    b = BookInfo()
    str(b) __str__
    

1.  è‡ªå®šä¹‰ç®¡ç†é¡µé¢

> è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†ç±»ã€‚æ¨¡å‹ç®¡ç†ç±»å°±æ˜¯å‘Šè¯‰djangoåœ¨ç”Ÿæˆçš„ç®¡ç†é¡µé¢ä¸Šæ˜¾ç¤ºå“ªäº›å†…å®¹ã€‚

8\. è§†å›¾
------

åœ¨Djangoä¸­ï¼Œé€šè¿‡æµè§ˆå™¨å»è¯·æ±‚ä¸€ä¸ªé¡µé¢æ—¶ï¼Œä½¿ç”¨è§†å›¾å‡½æ•°æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚çš„ï¼Œè§†å›¾å‡½æ•°å¤„ç†ä¹‹åï¼Œè¦ç»™æµè§ˆå™¨è¿”å›é¡µé¢å†…å®¹ã€‚

### 8.1 è§†å›¾å‡½æ•°çš„ä½¿ç”¨

1.  å®šä¹‰è§†å›¾å‡½æ•°

è§†å›¾å‡½æ•°å®šä¹‰åœ¨views.pyä¸­ã€‚

ä¾‹ï¼š

    def index(request):
    #è¿›è¡Œå¤„ç†...
            return HttpResponse('hello python')
    

è§†å›¾å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªå‚æ•°requestï¼Œè¿›è¡Œå¤„ç†ä¹‹åï¼Œéœ€è¦è¿”å›ä¸€ä¸ªHttpResponseçš„ç±»å¯¹è±¡ï¼Œhello pythonå°±æ˜¯è¿”å›ç»™æµè§ˆå™¨æ˜¾ç¤ºçš„å†…å®¹ã€‚

2.  è¿›è¡Œurlé…ç½®

urlé…ç½®çš„ç›®çš„æ˜¯è®©å»ºç«‹urlå’Œè§†å›¾å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚urlé…ç½®é¡¹å®šä¹‰åœ¨urlpatternsçš„åˆ—è¡¨ä¸­ï¼Œæ¯ä¸€ä¸ªé…ç½®é¡¹éƒ½è°ƒç”¨urlå‡½æ•°ã€‚

urlå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç¬¬äºŒä¸ªæ˜¯å¯¹åº”çš„å¤„ç†åŠ¨ä½œã€‚

é…ç½®urlæ—¶ï¼Œæœ‰ä¸¤ç§è¯­æ³•æ ¼å¼ï¼š

*   url(æ­£åˆ™è¡¨è¾¾å¼ï¼Œè§†å›¾å‡½æ•°å)
*   url(æ­£åˆ™è¡¨è¾¾å¼ï¼Œinclude(åº”ç”¨ä¸­çš„urlsæ–‡ä»¶))

å·¥ä½œä¸­åœ¨é…ç½®urlæ—¶ï¼Œé¦–å…ˆåœ¨é¡¹ç›®çš„urls.pyæ–‡ä»¶ä¸­æ·»åŠ é…ç½®é¡¹æ—¶ï¼Œå¹¶ä¸å†™å…·ä½“çš„urlå’Œè§†å›¾å‡½æ•°ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œè€Œæ˜¯åŒ…å«å…·ä½“åº”ç”¨çš„urls.pyæ–‡ä»¶ï¼Œåœ¨åº”ç”¨çš„urls.pyæ–‡ä»¶ä¸­å†™urlå’Œè§†å›¾å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚

### 8.2 urlåŒ¹é…çš„è¿‡ç¨‹

åœ¨é¡¹ç›®çš„urls.pyæ–‡ä»¶ä¸­åŒ…å«å…·ä½“åº”ç”¨çš„urls.pyæ–‡ä»¶ï¼Œåº”ç”¨çš„urls.pyæ–‡ä»¶ä¸­å†™urlå’Œè§†å›¾å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717898437-798f6c5a-85ff-4263-8665-e19bff7ca548.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u73a05474&name=image.png&originHeight=473&originWidth=865&originalType=url&ratio=1&rotation=0&showTitle=false&size=116711&status=done&style=none&taskId=u757395b6-224e-4677-90ee-6f06aa75c35&title=)

å½“ç”¨æˆ·è¾“å…¥å¦‚http://127.0.0.1:8000/aindexæ—¶ï¼Œå»é™¤åŸŸåå’Œæœ€å‰é¢çš„/ï¼Œå‰©ä¸‹aindexï¼Œæ‹¿aindexå­—ç¬¦ä¸²åˆ°é¡¹ç›®çš„urlsæ–‡ä»¶ä¸­è¿›è¡ŒåŒ¹é…ï¼Œé…ç½®æˆåŠŸä¹‹åï¼Œå»é™¤åŒ¹é…çš„aå­—ç¬¦ï¼Œé‚£å‰©ä¸‹çš„indexå­—ç¬¦ä¸²ç»§ç»­åˆ°åº”ç”¨çš„urlsæ–‡ä»¶ä¸­è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸä¹‹åæ‰§è¡Œè§†å›¾å‡½æ•°indexï¼Œindexè§†å›¾å‡½æ•°è¿”å›å†…å®¹hellopythonç»™æµè§ˆå™¨æ¥æ˜¾ç¤ºã€‚

9\. æ¨¡æ¿
------

æ¨¡æ¿ä¸ä»…ä»…æ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶ã€‚

### 9.1 æ¨¡æ¿æ–‡ä»¶çš„ä½¿ç”¨

1.  åˆ›å»ºæ¨¡æ¿æ–‡ä»¶å¤¹
2.  é…ç½®æ¨¡æ¿ç›®å½•

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717894048-8a2bb44d-06b1-4967-a0ff-be465857e4ac.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u4d692bfc&name=image.png&originHeight=415&originWidth=855&originalType=url&ratio=1&rotation=0&showTitle=false&size=133162&status=done&style=none&taskId=u3bded565-284c-4964-8041-205f4fac3e2&title=)

1.  ä½¿ç”¨æ¨¡æ¿æ–‡ä»¶
    *   åŠ è½½æ¨¡æ¿æ–‡ä»¶
        *   å»æ¨¡æ¿ç›®å½•ä¸‹é¢è·å–htmlæ–‡ä»¶çš„å†…å®¹ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡æ¿å¯¹è±¡ã€‚
    *   å®šä¹‰æ¨¡æ¿ä¸Šä¸‹æ–‡
        *   å‘æ¨¡æ¿æ–‡ä»¶ä¼ é€’æ•°æ®ã€‚
    *   æ¨¡æ¿æ¸²æŸ“
        *   å¾—åˆ°ä¸€ä¸ªæ ‡å‡†çš„htmlå†…å®¹ã€‚

### 9.2 ç»™æ¨¡æ¿æ–‡ä»¶ä¼ é€’æ•°æ®

10\. æ¡ˆä¾‹å®Œæˆ
---------

ç¼–ç ä¹‹å‰çš„å‡†å¤‡å·¥ä½œï¼š

1.  è®¾è®¡å‡ºè®¿é—®é¡µé¢çš„urlå’Œå¯¹åº”çš„è§†å›¾å‡½æ•°çš„åå­—ï¼Œç¡®å®šè§†å›¾å‡½æ•°çš„åŠŸèƒ½ã€‚
2.  è®¾è®¡æ¨¡æ¿æ–‡ä»¶çš„åå­—ã€‚

ä»¥ä¸‹ä¸ºæ¡ˆä¾‹ä¸­çš„ç®€å•è®¾è®¡è¿‡ç¨‹ï¼š

1.  å®Œæˆå›¾ä¹¦ä¿¡æ¯çš„å±•ç¤ºï¼š
2.  è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® [http://127.0.0.1:8000/books æ—¶æ˜¾ç¤ºå›¾ä¹¦ä¿¡æ¯é¡µé¢](http://127.0.0.1:8000/books/%20%E6%97%B6%E6%98%BE%E7%A4%BA%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF%E9%A1%B5%E9%9D%A2)ã€‚
3.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°show\_booksã€‚  
    æŸ¥è¯¢å‡ºæ‰€æœ‰å›¾ä¹¦çš„ä¿¡æ¯ï¼Œå°†è¿™äº›ä¿¡æ¯ä¼ é€’ç»™æ¨¡æ¿æ–‡ä»¶ã€‚
4.  ç¼–å†™æ¨¡æ¿æ–‡ä»¶show\_books.htmlã€‚  
    éå†æ˜¾ç¤ºå‡ºæ¯ä¸€æœ¬å›¾ä¹¦çš„ä¿¡æ¯ã€‚
5.  å®Œæˆç‚¹å‡»æŸæœ¬å›¾ä¹¦æ—¶ï¼Œæ˜¾ç¤ºå‡ºå›¾ä¹¦é‡Œæ‰€æœ‰è‹±é›„ä¿¡æ¯çš„é¡µé¢ã€‚
6.  è®¾è®¡url,é€šè¿‡è®¿é—®http://127.0.0.1:8000/books/æ•°å­—æ—¶æ˜¾ç¤ºå¯¹åº”çš„è‹±é›„ä¿¡æ¯é¡µé¢ã€‚  
    è¿™é‡Œæ•°å­—æŒ‡ç‚¹å‡»çš„å›¾ä¹¦çš„idã€‚
7.  è®¾è®¡å¯¹åº”çš„è§†å›¾å‡½æ•°detailã€‚  
    æ¥æ”¶å›¾ä¹¦çš„id,æ ¹æ®idæŸ¥è¯¢å‡ºç›¸åº”çš„å›¾ä¹¦ä¿¡æ¯ï¼Œç„¶åæŸ¥è¯¢å‡ºå›¾ä¹¦ä¸­çš„æ‰€æœ‰è‹±é›„ä¿¡æ¯ã€‚
8.  ç¼–å†™æ¨¡æ¿æ–‡ä»¶detail.htmlã€‚

Django æ¨¡å‹
=========

æ¨¡å‹
==

1\. Django ORM
--------------

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717905338-6e326da3-ba7d-44da-9388-8e3142e898a3.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u820cd791&name=image.png&originHeight=398&originWidth=588&originalType=url&ratio=1&rotation=0&showTitle=false&size=43057&status=done&style=none&taskId=u8f78e7e4-8cbd-4903-9b4a-4be5d5a1706&title=)

> O(objects):ç±»å’Œå¯¹è±¡ã€‚

> R(Relation):å…³ç³»ï¼Œå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨æ ¼ã€‚

> M(Mapping):æ˜ å°„ã€‚

**Django ORMæ¡†æ¶çš„åŠŸèƒ½ï¼š**

1.  å»ºç«‹æ¨¡å‹ç±»å’Œè¡¨ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥æ“ä½œæ•°æ®åº“ã€‚
2.  æ ¹æ®è®¾è®¡çš„æ¨¡å‹ç±»ç”Ÿæˆæ•°æ®åº“ä¸­çš„è¡¨æ ¼ã€‚
3.  é€šè¿‡æ–¹ä¾¿çš„é…ç½®å°±å¯ä»¥è¿›è¡Œæ•°æ®åº“çš„åˆ‡æ¢ã€‚

2\. Djangoæ•°æ®åº“é…ç½®
---------------

### 2.1 mysqlå‘½ä»¤å›é¡¾

### 2.2 Djangoé…ç½®ä½¿ç”¨mysqlæ•°æ®åº“

ä¿®æ”¹settings.pyä¸­çš„DATABASESã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717910460-824c8db0-1a12-4ea3-b73d-86172086bdb9.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u2878a9cc&name=image.png&originHeight=472&originWidth=1224&originalType=url&ratio=1&rotation=0&showTitle=false&size=81128&status=done&style=none&taskId=ufc26958d-b507-482a-bd3b-c309b2454b7&title=)  
æ³¨æ„ï¼šdjangoæ¡†æ¶ä¸ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆmysqlæ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå·±å»åˆ›å»ºã€‚

### 2.3 åˆ‡æ¢mysqlæ•°æ®åº“ä¹‹åä¸èƒ½å¯åŠ¨æœåŠ¡å™¨

éœ€è¦å®‰è£…æ“ä½œmysqlæ•°æ®åº“çš„åŒ…ï¼Œpython2ç¯å¢ƒå’Œpython3ç¯å¢ƒæœ‰ä»¥ä¸‹åŒºåˆ«ã€‚

*   **python2éœ€è¦å®‰è£…mysql-python:**

> pip install mysql-python

*   **python3éœ€è¦å®‰è£…pymysql**:

> pip install pymysql

python3ä¸­å®‰è£…å¥½pymysqlï¼Œéœ€è¦åœ¨test2/**init**.pyä¸­åŠ å¦‚ä¸‹å†…å®¹ï¼š

3\. å¤ä¹ æ¡ˆä¾‹
--------

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717916052-eac1c0bd-488d-4721-a7c6-349bdb5051f6.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u8a9fca7f&name=image.png&originHeight=723&originWidth=1101&originalType=url&ratio=1&rotation=0&showTitle=false&size=77884&status=done&style=none&taskId=u19a01d11-e986-4f32-b0d3-1dc493c7eb0&title=)

é¡µé¢é‡å®šå‘ï¼šæœåŠ¡å™¨ä¸è¿”å›é¡µé¢ï¼Œè€Œæ˜¯å‘Šè¯‰æµè§ˆå™¨å†å»è¯·æ±‚å…¶ä»–çš„urlåœ°å€ã€‚

1.  è®¾è®¡æ¨¡å‹ç±»å¹¶ç”Ÿæˆè¡¨
2.  è®¾è®¡BookInfo,å¢åŠ å±æ€§breadå’Œbcommentï¼Œå¦å¤–è®¾ç½®è½¯åˆ é™¤æ ‡è®°å±æ€§isDeleteã€‚
3.  è®¾è®¡HeroInfoç±»ï¼Œå¢åŠ è½¯åˆ é™¤æ ‡è®°å±æ€§isDeleteã€‚  
    è½¯åˆ é™¤æ ‡è®°ï¼šåˆ é™¤æ•°æ®æ—¶ä¸åšçœŸæ­£çš„åˆ é™¤ï¼Œè€Œæ˜¯æŠŠæ ‡è®°æ•°æ®è®¾ç½®ä¸º1è¡¨ç¤ºåˆ é™¤ï¼Œç›®çš„æ˜¯é˜²æ­¢é‡è¦çš„æ•°æ®ä¸¢å¤±ã€‚
4.  ç¼–å†™è§†å›¾å‡½æ•°å¹¶é…ç½®URLã€‚
5.  åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ã€‚  
    **æ‹†è§£åŠŸèƒ½ï¼š**
6.  å›¾ä¹¦ä¿¡æ¯å±•ç¤ºé¡µã€‚
7.  è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® [http://127.0.0.1:8000/indexæ—¶æ˜¾ç¤ºå›¾ä¹¦ä¿¡æ¯é¡µé¢](http://127.0.0.1/index/%20%E6%97%B6%E6%98%BE%E7%A4%BA%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF%E9%A1%B5%E9%9D%A2)ã€‚
8.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°indexã€‚  
    æŸ¥è¯¢å‡ºæ‰€æœ‰å›¾ä¹¦çš„ä¿¡æ¯ï¼Œå°†è¿™äº›ä¿¡æ¯ä¼ é€’ç»™æ¨¡æ¿æ–‡ä»¶ã€‚
9.  ç¼–å†™æ¨¡æ¿æ–‡ä»¶index.htmlã€‚

> éå†æ˜¾ç¤ºå‡ºæ¯ä¸€æœ¬å›¾ä¹¦çš„ä¿¡æ¯å¹¶å¢åŠ æ–°å»ºå’Œåˆ é™¤è¶…é“¾æ¥ã€‚

2.  å›¾ä¹¦ä¿¡æ¯æ–°å¢ã€‚  
    a. è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® [http://127.0.0.1:8000/createæ—¶å‘æ•°æ®åº“ä¸­æ–°å¢ä¸€æ¡å›¾ä¹¦ä¿¡æ¯](http://127.0.0.1:8000/create%E6%97%B6%E5%90%91%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%96%B0%E5%A2%9E%E4%B8%80%E6%9D%A1%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF)  
    b. è®¾è®¡urlå¯¹åº”å¾—è§†å›¾å‡½æ•°createã€‚
3.  å›¾ä¹¦ä¿¡æ¯åˆ é™¤ã€‚  
    a. è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® [http://127.0.0.1:8000/deleteæ•°](http://127.0.0.1:8000/delete%E6%95%B0) å­—åˆ é™¤æ•°æ®åº“ä¸­å¯¹åº”çš„ä¸€æ¡å›¾ä¹¦æ•°æ®  
    å…¶ä¸­æ•°å­—æ˜¯ç‚¹å‡»çš„å›¾ä¹¦çš„idã€‚  
    b. è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°deleteã€‚ è·å–å›¾ä¹¦çš„id,è¿›è¡Œåˆ é™¤ã€‚

4\. å­—æ®µå±æ€§å’Œé€‰é¡¹
-----------

### 4.1 æ¨¡å‹ç±»å±æ€§å‘½åé™åˆ¶

1.  ä¸èƒ½æ˜¯pythonçš„ä¿ç•™å…³é”®å­—ã€‚
2.  ä¸å…è®¸ä½¿ç”¨è¿ç»­çš„ä¸‹åˆ’çº¿ï¼Œè¿™æ˜¯ç”±djangoçš„æŸ¥è¯¢æ–¹å¼å†³å®šçš„ã€‚
3.  å®šä¹‰å±æ€§æ—¶éœ€è¦æŒ‡å®šå­—æ®µç±»å‹ï¼Œé€šè¿‡å­—æ®µç±»å‹çš„å‚æ•°æŒ‡å®šé€‰é¡¹ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š

å±æ€§å=models.å­—æ®µç±»å‹(é€‰é¡¹)

### 4.2 å­—æ®µç±»å‹

ä½¿ç”¨æ—¶éœ€è¦å¼•å…¥django.db.modelsåŒ…ï¼Œå­—æ®µç±»å‹å¦‚ä¸‹ï¼š

### 4.3 å­—æ®µé€‰é¡¹

é€šè¿‡é€‰é¡¹å®ç°å¯¹å­—æ®µçš„çº¦æŸï¼Œé€‰é¡¹å¦‚ä¸‹ï¼š

å¯¹æ¯”ï¼šnullæ˜¯æ•°æ®åº“èŒƒç•´çš„æ¦‚å¿µï¼Œblankæ˜¯åå°ç®¡ç†é¡µé¢è¡¨å•éªŒè¯èŒƒç•´çš„ã€‚

**ç»éªŒ:**

å½“ä¿®æ”¹æ¨¡å‹ç±»ä¹‹åï¼Œå¦‚æœæ·»åŠ çš„é€‰é¡¹ä¸å½±å“è¡¨çš„ç»“æ„ï¼Œåˆ™ä¸éœ€è¦é‡æ–°åšè¿ç§»ï¼Œå•†å“çš„é€‰é¡¹ä¸­defaultå’Œblankä¸å½±å“è¡¨ç»“æ„ã€‚

**å‚è€ƒæ–‡æ¡£:**

[**http://python.usyiyi.cn/translate/django\_182/index.html**](http://python.usyiyi.cn/translate/django_182/index.html)

5\. æŸ¥è¯¢
------

### 5.1 mysqlçš„æ—¥å¿—æ–‡ä»¶

mysql.logæ˜¯mysqlçš„æ—¥å¿—æ–‡ä»¶ï¼Œé‡Œé¢è®°å½•çš„å¯¹MySQLæ•°æ®åº“çš„æ“ä½œè®°å½•ã€‚é»˜è®¤æƒ…å†µä¸‹mysqlçš„æ—¥å¿—æ–‡ä»¶æ²¡æœ‰äº§ç”Ÿï¼Œéœ€è¦ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

1.  ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ‰“å¼€mysqlçš„é…ç½®æ–‡ä»¶ï¼Œå»é™¤68,69è¡Œçš„æ³¨é‡Šï¼Œç„¶åä¿å­˜ã€‚

> sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf

1.  é‡å¯mysqlæœåŠ¡ï¼Œå°±ä¼šäº§ç”Ÿmysqlæ—¥å¿—æ–‡ä»¶ã€‚

> sudo service mysql restart

1.  æ‰“å¼€MySQLçš„æ—¥å¿—æ–‡ä»¶ã€‚

> /var/log/mysql/mysql.log æ˜¯mysqlæ—¥å¿—æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ã€‚

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯ä»¥å®æ—¶æŸ¥çœ‹mysqlçš„æ—¥å¿—æ–‡ä»¶:

> sudo tail -f /var/log/mysql/mysql.log

### 5.2 æŸ¥è¯¢å‡½æ•°

é€šè¿‡æ¨¡å‹ç±».objectså±æ€§å¯ä»¥è°ƒç”¨å¦‚ä¸‹å‡½æ•°ï¼Œå®ç°å¯¹æ¨¡å‹ç±»å¯¹åº”çš„æ•°æ®è¡¨çš„æŸ¥è¯¢ã€‚

**getç¤ºä¾‹**ï¼š

ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦idä¸º3çš„å›¾ä¹¦ä¿¡æ¯ã€‚

**allæ–¹æ³•ç¤ºä¾‹ï¼š**

ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦æ‰€æœ‰ä¿¡æ¯ã€‚

**filteræ–¹æ³•ç¤ºä¾‹ï¼š**

æ¡ä»¶æ ¼å¼ï¼š

æ¨¡å‹ç±»å±æ€§å\_\_æ¡ä»¶å=å€¼

æŸ¥è¯¢å›¾ä¹¦è¯„è®ºé‡ä¸º34çš„å›¾ä¹¦çš„ä¿¡æ¯ï¼š

**a) åˆ¤ç­‰ æ¡ä»¶å:exact**

    ä¾‹ï¼šæŸ¥è¯¢ç¼–å·ä¸º1çš„å›¾ä¹¦ã€‚
    # Django models è¯­æ³•
    BookInfo.objects.get(id=1)
    

**b) æ¨¡ç³ŠæŸ¥è¯¢**

ä¾‹ï¼šæŸ¥è¯¢ä¹¦ååŒ…å«â€™ä¼ â€™çš„å›¾ä¹¦ã€‚contains

    BookInfo.objects.filter(btitle__contains='ä¼ ')
    

ä¾‹ï¼šæŸ¥è¯¢ä¹¦åä»¥â€™éƒ¨â€™ç»“å°¾çš„å›¾ä¹¦ endswith å¼€å¤´:startswith

    BookInfo.objects.filter(btitle__endswith='éƒ¨')
    

**c)ç©ºæŸ¥è¯¢ isnull**

    ä¾‹ï¼šæŸ¥è¯¢ä¹¦åä¸ä¸ºç©ºçš„å›¾ä¹¦ã€‚isnull
    select * from booktest_bookinfo where btitle is not null;
    

    # Django models è¯­æ³•
    BookInfo.objects.filter(btitle__isnull=False)
    

**d)èŒƒå›´æŸ¥è¯¢** in

    ä¾‹ï¼šæŸ¥è¯¢idä¸º1æˆ–3æˆ–5çš„å›¾ä¹¦ã€‚
    select * from booktest_bookinfo where id in (1,3,5);
    

    # Django models è¯­æ³•
    BookInfo.objects.filter(id__in = [1,3,5])
    

**e)æ¯”è¾ƒæŸ¥è¯¢** gt(greate than) lt(less than) gte(equal) å¤§äºç­‰äº

lte å°äºç­‰äº

    ä¾‹ï¼šæŸ¥è¯¢idå¤§äº3çš„å›¾ä¹¦ã€‚
    Select * from booktest_bookinfo where id>3;
    

    # Django models è¯­æ³•
    BookInfo.objects.filter(id__gt=3)
    

**f)æ—¥æœŸæŸ¥è¯¢**

    # ä¾‹ï¼šæŸ¥è¯¢1980å¹´å‘è¡¨çš„å›¾ä¹¦ã€‚
    BookInfo.objects.filter(bpub_date__year=1980)
    

    # ä¾‹ï¼šæŸ¥è¯¢1980å¹´1æœˆ1æ—¥åå‘è¡¨çš„å›¾ä¹¦ã€‚
    from datetime import date
    BookInfo.objects.filter(bpub_date__gt=date(1980,1,1))
    

**excludeæ–¹æ³•ç¤ºä¾‹ï¼š**

    # ä¾‹ï¼šæŸ¥è¯¢idä¸ä¸º3çš„å›¾ä¹¦ä¿¡æ¯ã€‚
    BookInfo.objects.exclude(id=3)
    

**order\_byæ–¹æ³•ç¤ºä¾‹ï¼š**

**ä½œç”¨ï¼š**è¿›è¡ŒæŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºã€‚

    # ä¾‹ï¼šæŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦çš„ä¿¡æ¯ï¼ŒæŒ‰ç…§idä»å°åˆ°å¤§è¿›è¡Œæ’åºã€‚
    BookInfo.objects.all().order_by('id')
    

    # ä¾‹ï¼šæŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦çš„ä¿¡æ¯ï¼ŒæŒ‰ç…§idä»å¤§åˆ°å°è¿›è¡Œæ’åºã€‚
    BookInfo.objects.all().order_by('-id')
    

    # ä¾‹ï¼šæŠŠidå¤§äº3çš„å›¾ä¹¦ä¿¡æ¯æŒ‰é˜…è¯»é‡ä»å¤§åˆ°å°æ’åºæ˜¾ç¤ºã€‚
    BookInfo.objects.filter(id__gt=3).order_by('-bread')
    

6\. Få¯¹è±¡
-------

ä½œç”¨ï¼šç”¨äºç±»å±æ€§ä¹‹é—´çš„æ¯”è¾ƒã€‚

**ä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆå¯¼å…¥**ï¼š

    from django.db.models import F
    

    # ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦é˜…è¯»é‡å¤§äºè¯„è®ºé‡å›¾ä¹¦ä¿¡æ¯ã€‚
    BookInfo.objects.filter(bread__gt=F('bcomment'))
    

    # ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦é˜…è¯»é‡å¤§äº2å€è¯„è®ºé‡å›¾ä¹¦ä¿¡æ¯ã€‚
    BookInfo.objects.filter(bread__gt=F('bcomment')*2)
    

7\. Qå¯¹è±¡
-------

ä½œç”¨ï¼šç”¨äºæŸ¥è¯¢æ—¶æ¡ä»¶ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚not and orï¼Œå¯ä»¥å¯¹Qå¯¹è±¡è¿›è¡Œ&|~æ“ä½œã€‚

**ä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆå¯¼å…¥ï¼š**

    from django.db.models import Q
    

    # ä¾‹ï¼šæŸ¥è¯¢idå¤§äº3ä¸”é˜…è¯»é‡å¤§äº30çš„å›¾ä¹¦çš„ä¿¡æ¯ã€‚
    BookInfo.objects.filter(id__gt=3, bread__gt=30)
    BookInfo.objects.filter(Q(id__gt=3)&Q(bread__gt=30))
    

    # ä¾‹ï¼šæŸ¥è¯¢idå¤§äº3æˆ–è€…é˜…è¯»é‡å¤§äº30çš„å›¾ä¹¦çš„ä¿¡æ¯ã€‚
    BookInfo.objects.filter(Q(id__gt=3)|Q(bread__gt=30))
    

    # ä¾‹ï¼šæŸ¥è¯¢idä¸ç­‰äº3å›¾ä¹¦çš„ä¿¡æ¯ã€‚
    BookInfo.objects.filter(~Q(id=3))
    

8\. èšåˆå‡½æ•°
--------

ä½œç”¨ï¼šå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œèšåˆæ“ä½œã€‚

sum count avg max min

**aggregateï¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥ä½¿ç”¨èšåˆã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—å…¸**

**ä½¿ç”¨å‰éœ€å…ˆå¯¼å…¥èšåˆç±»ï¼š**

    from django.db.models import Sum,Count,Max,Min,Avg
    

    # ä¾‹ï¼šæŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦çš„æ•°ç›®ã€‚
    BookInfo.objects.all().aggregate(Count('id'))
    
    {'id__count': 5}
    

    # ä¾‹ï¼šæŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦é˜…è¯»é‡çš„æ€»å’Œã€‚
    BookInfo.objects.aggregate(Sum('bread'))
    {'bread__sum': 126}
    

**countå‡½æ•° è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å­—**

ä½œç”¨ï¼šç»Ÿè®¡æ»¡è¶³æ¡ä»¶æ•°æ®çš„æ•°ç›®ã€‚

    # ä¾‹ï¼šç»Ÿè®¡æ‰€æœ‰å›¾ä¹¦çš„æ•°ç›®ã€‚
    BookInfo.objects.all().count()
    BookInfo.objects.count()
    

    # ä¾‹ï¼šç»Ÿè®¡idå¤§äº3çš„æ‰€æœ‰å›¾ä¹¦çš„æ•°ç›®ã€‚
    BookInfo.objects.filter(id__gt=3).count()
    

å°ç»“:

æŸ¥è¯¢ç›¸å…³å‡½æ•°  
get ï¼šè¿”å›ä¸€æ¡ä¸”åªèƒ½æœ‰ä¸€æ¡æ•°æ®ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå‚æ•°å¯ä»¥å†™æŸ¥è¯¢æ¡ä»¶ã€‚

all ï¼šè¿”å›æ¨¡å‹ç±»å¯¹åº”è¡¨çš„æ‰€æœ‰æ•°æ®ï¼Œè¿”å›å€¼æ˜¯ Oueryset ã€‚

filter ï¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œè¿”å›å€¼æ˜¯ Oueryset ï¼Œå‚æ•°å¯ä»¥å†™æŸ¥è¯¢æ¡ä»¶ã€‚

exclude ï¼šè¿”å›ä¸æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œè¿”å›å€¼æ˜¯ Oueryset ï¼Œå‚æ•°å¯ä»¥å†™æŸ¥è¯¢æ¡ä»¶ã€‚

order \_ by ï¼šå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºï¼Œè¿”å›å€¼æ˜¯ Queryset ï¼Œå‚æ•°ä¸­å†™æ’åºçš„å­—æ®µã€‚

æ³¨æ„ï¼š

1.  getï¼Œfilter , exclude å‡½æ•°ä¸­å¯ä»¥å†™æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚æœä¼ å¤šä¸ªå‚æ•°ï¼Œæ¡ä»¶ä¹‹é—´ä»£è¡¨ä¸”çš„å…³ç³»ã€‚
2.  allï¼Œfilter , exclude , order \_ by å‡½æ•°çš„è¿”å›å€¼æ˜¯ Queryset ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œ å«åšæŸ¥è¯¢é›†.

`from django.db.models import F,Q,Sum,Count,Avg,Max,Min`

Få¯¹è±¡ï¼šç”¨äºç±»å±æ€§ä¹‹é—´çš„æ¯”è¾ƒã€‚  
Qå¯¹è±¡ï¼šç”¨äºæ¡ä»¶ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚

aggregate ï¼šè¿›è¡Œèšåˆæ“ä½œï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè¿›è¡Œèšåˆçš„æ—¶å€™éœ€è¦å…ˆå¯¼å…¥èšåˆç±»ã€‚  
count ï¼šè¿”å›ç»“æœé›†ä¸­æ•°æ®çš„æ•°ç›®ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å­—ã€‚

æ³¨æ„ï¼šå¯¹ä¸€ä¸ª Oueryset å®ä¾‹å¯¹è±¡ï¼Œå¯ä»¥ç»§ç»­è°ƒç”¨ä¸Šé¢çš„æ‰€æœ‰å‡½æ•°ã€‚

**å‚è€ƒæ–‡æ¡£ï¼š**

[http://python.usyiyi.cn/translate/django\_182/ref/models/querysets.html](http://python.usyiyi.cn/translate/django_182/ref/models/querysets.html)

9\. æŸ¥è¯¢é›†
-------

all, filter, exclude, order\_byè°ƒç”¨è¿™äº›å‡½æ•°ä¼šäº§ç”Ÿä¸€ä¸ªæŸ¥è¯¢é›†ï¼ŒQuerySetç±»å¯¹è±¡å¯ä»¥ç»§ç»­è°ƒç”¨ä¸Šé¢çš„æ‰€æœ‰å‡½æ•°ã€‚

### 9.1 æŸ¥è¯¢é›†ç‰¹æ€§

1.  æƒ°æ€§æŸ¥è¯¢ï¼šåªæœ‰åœ¨å®é™…ä½¿ç”¨æŸ¥è¯¢é›†ä¸­çš„æ•°æ®çš„æ—¶å€™æ‰ä¼šå‘ç”Ÿå¯¹æ•°æ®åº“çš„çœŸæ­£æŸ¥è¯¢ã€‚
2.  ç¼“å­˜ï¼šå½“ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªæŸ¥è¯¢é›†æ—¶ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™ä¼šå‘ç”Ÿå®é™…æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œç„¶åæŠŠç»“æœç¼“å­˜èµ·æ¥ï¼Œä¹‹åå†ä½¿ç”¨è¿™ä¸ªæŸ¥è¯¢é›†æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ç¼“å­˜ä¸­çš„ç»“æœã€‚

### 9.2 é™åˆ¶æŸ¥è¯¢é›†

å¯ä»¥å¯¹ä¸€ä¸ªæŸ¥è¯¢é›†è¿›è¡Œå–ä¸‹æ ‡æˆ–è€…åˆ‡ç‰‡æ“ä½œæ¥é™åˆ¶æŸ¥è¯¢é›†çš„ç»“æœã€‚

å¯¹ä¸€ä¸ªæŸ¥è¯¢é›†è¿›è¡Œåˆ‡ç‰‡æ“ä½œ**ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æŸ¥è¯¢é›†**ï¼Œä¸‹æ ‡ä¸å…è®¸ä¸ºè´Ÿæ•°ã€‚

å–å‡ºæŸ¥è¯¢é›†ç¬¬ä¸€æ¡æ•°æ®çš„ä¸¤ç§æ–¹å¼:

**_exists:åˆ¤æ–­ä¸€ä¸ªæŸ¥è¯¢é›†ä¸­æ˜¯å¦æœ‰æ•°æ®ã€‚True False_**

10\. æ¨¡å‹ç±»å…³ç³»
----------

1.  ä¸€å¯¹å¤šå…³ç³»

> ä¾‹ï¼šå›¾ä¹¦ç±»-è‹±é›„ç±»
> 
> models.ForeignKey() å®šä¹‰åœ¨å¤šçš„ç±»ä¸­ã€‚

1.  å¤šå¯¹å¤šå…³ç³»

> ä¾‹ï¼šæ–°é—»ç±»-æ–°é—»ç±»å‹ç±» ä½“è‚²æ–°é—» å›½é™…æ–°é—»
> 
> models.ManyToManyField() å®šä¹‰åœ¨å“ªä¸ªç±»ä¸­éƒ½å¯ä»¥ã€‚

1.  ä¸€å¯¹ä¸€å…³ç³»

> ä¾‹ï¼šå‘˜å·¥åŸºæœ¬ä¿¡æ¯ç±»-å‘˜å·¥è¯¦ç»†ä¿¡æ¯ç±». å‘˜å·¥å·¥å·
> 
> models.OneToOneFieldå®šä¹‰åœ¨å“ªä¸ªç±»ä¸­éƒ½å¯ä»¥ã€‚

11\. å…³è”æŸ¥è¯¢ï¼ˆä¸€å¯¹å¤šï¼‰
--------------

### 11.1 æŸ¥è¯¢å’Œå¯¹è±¡å…³è”çš„æ•°æ®

åœ¨ä¸€å¯¹å¤šå…³ç³»ä¸­ï¼Œä¸€å¯¹åº”çš„ç±»æˆ‘ä»¬æŠŠå®ƒå«åšä¸€ç±»ï¼Œå¤šå¯¹åº”çš„é‚£ä¸ªç±»æˆ‘ä»¬æŠŠå®ƒå«åšå¤šç±»ï¼Œæˆ‘ä»¬æŠŠå¤šç±»ä¸­å®šä¹‰çš„å»ºç«‹å…³è”çš„ç±»å±æ€§å«åšå…³è”å±æ€§ã€‚

    # ä¾‹ï¼šæŸ¥è¯¢idä¸º1çš„å›¾ä¹¦å…³è”çš„è‹±é›„çš„ä¿¡æ¯ã€‚
    b=BookInfo.objects.get(id=1)
    b.heroinfo_set.all()
    

**é€šè¿‡æ¨¡å‹ç±»æŸ¥è¯¢ï¼š**

    HeroInfo.objects.filter(hbook__id=1)
    

    # ä¾‹ï¼šæŸ¥è¯¢idä¸º1çš„è‹±é›„å…³è”çš„å›¾ä¹¦ä¿¡æ¯ã€‚
    h = HeroInfo.objects.get(id=1)
    h.hbook
    

**é€šè¿‡æ¨¡å‹ç±»æŸ¥è¯¢ï¼š**

    BookInfo.objects.filter(heroinfo__id=1)
    

**æ ¼å¼ï¼š**  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717938622-4742eff5-5b42-4d07-a12d-3e346e25340b.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ud02c1852&name=image.png&originHeight=588&originWidth=1098&originalType=url&ratio=1&rotation=0&showTitle=false&size=82321&status=done&style=none&taskId=u8e91a375-bd0a-4249-b7e9-fccf7721072&title=)

ç”±ä¸€ç±»çš„å¯¹è±¡æŸ¥è¯¢å¤šç±»çš„æ—¶å€™ï¼š

ä¸€ç±»çš„å¯¹è±¡.å¤šç±»åå°å†™\_set.all() #æŸ¥è¯¢æ‰€ç”¨æ•°æ®

ç”±å¤šç±»çš„å¯¹è±¡æŸ¥è¯¢ä¸€ç±»çš„æ—¶å€™ï¼š

å¤šç±»çš„å¯¹è±¡.å…³è”å±æ€§ #æŸ¥è¯¢å¤šç±»çš„å¯¹è±¡å¯¹åº”çš„ä¸€ç±»çš„å¯¹è±¡

ç”±å¤šç±»çš„å¯¹è±¡æŸ¥è¯¢ä¸€ç±»å¯¹è±¡çš„idæ—¶å€™ï¼š

å¤šç±»çš„å¯¹è±¡. å…³è”å±æ€§\_id

### 11.2 é€šè¿‡æ¨¡å‹ç±»å®ç°å…³è”æŸ¥è¯¢

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717946055-dd0aa1c0-f65b-4f6c-9b3e-b326104412d4.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u9bc8f8e6&name=image.png&originHeight=286&originWidth=1186&originalType=url&ratio=1&rotation=0&showTitle=false&size=72821&status=done&style=none&taskId=u8a44be83-9d6b-4fdb-9aa4-e1633271776&title=)

ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦ä¿¡æ¯ï¼Œè¦æ±‚å›¾ä¹¦å…³è”çš„è‹±é›„çš„æè¿°åŒ…å«â€™å…«â€™ã€‚

    BookInfo.objects.filter(heroinfo__hcomment__contains='å…«')
    

ä¾‹ï¼šæŸ¥è¯¢å›¾ä¹¦ä¿¡æ¯ï¼Œè¦æ±‚å›¾ä¹¦ä¸­çš„è‹±é›„çš„idå¤§äº3.

    BookInfo.objects.filter(heroinfo__id__gt=3)
    

ä¾‹ï¼šæŸ¥è¯¢ä¹¦åä¸ºâ€œå¤©é¾™å…«éƒ¨â€çš„æ‰€æœ‰è‹±é›„ã€‚

    HeroInfo.objects.filter(hbook__btitle='å¤©é¾™å…«éƒ¨')
    

é€šè¿‡å¤šç±»çš„æ¡ä»¶æŸ¥è¯¢ä¸€ç±»çš„æ•°æ®ï¼š

    ä¸€ç±»å.objects.filter(å¤šç±»åå°å†™__å¤šç±»å±æ€§å__æ¡ä»¶å)
    

é€šè¿‡ä¸€ç±»çš„æ¡ä»¶æŸ¥è¯¢å¤šç±»çš„æ•°æ®ï¼š

    å¤šç±»å.objects.filter(å…³è”å±æ€§__ä¸€ç±»å±æ€§å__æ¡ä»¶å)
    

12\. å…¥ã€æ›´æ–°å’Œåˆ é™¤
------------

> è°ƒç”¨ä¸€ä¸ªæ¨¡å‹ç±»å¯¹è±¡çš„saveæ–¹æ³•çš„æ—¶å€™å°±å¯ä»¥å®ç°å¯¹æ¨¡å‹ç±»å¯¹åº”æ•°æ®è¡¨çš„æ’å…¥å’Œæ›´æ–°ã€‚
> 
> è°ƒç”¨ä¸€ä¸ªæ¨¡å‹ç±»å¯¹è±¡çš„deleteæ–¹æ³•çš„æ—¶å€™å°±å¯ä»¥å®ç°å¯¹æ¨¡å‹ç±»å¯¹åº”æ•°æ®è¡¨æ•°æ®çš„åˆ é™¤ã€‚

13\. è‡ªå…³è”
--------

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717952647-bb6eeded-be63-4eab-a851-1e77a80dcd49.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u990be2dc&name=image.png&originHeight=998&originWidth=1408&originalType=url&ratio=1&rotation=0&showTitle=false&size=64589&status=done&style=none&taskId=u623de316-b605-4173-95d5-870eabf9934&title=)

è‡ªå…³è”æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸€å¯¹å¤šçš„å…³ç³»ã€‚

æ¡ˆä¾‹ï¼šæ˜¾ç¤ºå¹¿å·å¸‚çš„ä¸Šçº§åœ°åŒºå’Œä¸‹çº§åœ°åŒºã€‚

åœ°åŒºè¡¨ï¼šid, atitle, aParent\_id;

mysqlç»ˆç«¯ä¸­æ‰¹é‡æ‰§è¡Œsqlè¯­å¥ï¼š

    source areas.sql;
    

14\. ç®¡ç†å™¨
--------

BookInfo.objects.all()->objectsæ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ

> ç­”ï¼šobjectsæ˜¯Djangoå¸®æˆ‘è‡ªåŠ¨ç”Ÿæˆçš„ç®¡ç†å™¨å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªç®¡ç†å™¨å¯ä»¥å®ç°å¯¹æ•°æ®çš„æŸ¥è¯¢ã€‚objectsæ˜¯models.Mangerç±»çš„ä¸€ä¸ªå¯¹è±¡ã€‚è‡ªå®šä¹‰ç®¡ç†å™¨ä¹‹åDjangoä¸å†å¸®æˆ‘ä»¬ç”Ÿæˆé»˜è®¤çš„objectsç®¡ç†å™¨ã€‚

### 14.1 è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†å™¨ç±»

1.  è‡ªå®šä¹‰ä¸€ä¸ªç®¡ç†å™¨ç±»ï¼Œè¿™ä¸ªç±»ç»§æ‰¿models.Mangerç±»ã€‚
2.  å†åœ¨å…·ä½“çš„æ¨¡å‹ç±»é‡Œå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ç®¡ç†å™¨ç±»çš„å¯¹è±¡ã€‚

### 14.2 è‡ªå®šä¹‰ç®¡ç†å™¨ç±»çš„åº”ç”¨åœºæ™¯

1.  æ”¹å˜æŸ¥è¯¢çš„ç»“æœé›†ã€‚  
    æ¯”å¦‚è°ƒç”¨BookInfo.books.all()è¿”å›çš„æ˜¯æ²¡æœ‰åˆ é™¤çš„å›¾ä¹¦çš„æ•°æ®ã€‚
2.  æ·»åŠ é¢å¤–çš„æ–¹æ³•ã€‚  
    ç®¡ç†å™¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•å¸®æˆ‘ä»¬æ“ä½œæ¨¡å‹ç±»å¯¹åº”çš„æ•°æ®è¡¨ã€‚  
    ä½¿ç”¨self.model()å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªè·Ÿè‡ªå®šä¹‰ç®¡ç†å™¨å¯¹åº”çš„æ¨¡å‹ç±»å¯¹è±¡ã€‚  
    **å°ç»“:**

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717961778-db44c493-b04e-4970-8343-eaf291dbf745.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u4332de13&name=image.png&originHeight=896&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=120216&status=done&style=none&taskId=u19f4ed06-76c2-4bc0-a767-9e0dd060a19&title=)

15\. å…ƒé€‰é¡¹
--------

Djangoé»˜è®¤ç”Ÿæˆçš„è¡¨åï¼š

åº”ç”¨åå°å†™\_æ¨¡å‹ç±»åå°å†™ã€‚

**å…ƒé€‰é¡¹ï¼š**

éœ€è¦åœ¨æ¨¡å‹ç±»ä¸­å®šä¹‰ä¸€ä¸ªå…ƒç±»Meta,åœ¨é‡Œé¢å®šä¹‰ä¸€ä¸ªç±»å±æ€§db\_tableå°±å¯ä»¥æŒ‡å®šè¡¨åã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717965993-489336d2-6f1a-49ef-9d47-62a73c75fe96.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ucdf08c6a&name=image.png&originHeight=751&originWidth=1100&originalType=url&ratio=1&rotation=0&showTitle=false&size=69009&status=done&style=none&taskId=u21d59585-6f2d-44c0-8e01-e03383141ae&title=)

Django è§†å›¾
=========

è§†å›¾
==

1\. è§†å›¾çš„åŠŸèƒ½
---------

æ¥æ”¶è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œä¸Må’ŒTè¿›è¡Œäº¤äº’ï¼Œè¿”å›åº”ç­”ã€‚

è¿”å›htmlå†…å®¹ HttpResponseï¼Œä¹Ÿå¯èƒ½é‡å®šå‘ redirect,è¿˜å¯ä»¥è¿”å›jsonæ•°æ®ã€‚

2\. è§†å›¾å‡½æ•°ä½¿ç”¨
----------

### 2.1 ä½¿ç”¨

1.  å®šä¹‰è§†å›¾å‡½æ•°  
    requestå‚æ•°å¿…é¡»æœ‰ã€‚æ˜¯ä¸€ä¸ªHttpRequestç±»å‹çš„å¯¹è±¡ã€‚å‚æ•°åå¯ä»¥å˜åŒ–ï¼Œ  
    ä½†ä¸è¦æ›´æ”¹ã€‚
2.  é…ç½®url  
    å»ºç«‹urlå’Œè§†å›¾å‡½æ•°ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚

3\. urlé…ç½®çš„è¿‡ç¨‹
------------

1.  åœ¨é¡¹ç›®çš„urlsæ–‡ä»¶ä¸­åŒ…å«å…·ä½“åº”ç”¨çš„urlsæ–‡ä»¶ï¼Œåœ¨å…·ä½“åº”ç”¨çš„urlsæ–‡ä»¶ä¸­åŒ…å«å…·ä½“urlå’Œè§†å›¾çš„å¯¹åº”å…³ç³»ã€‚
2.  urlé…ç½®é¡¹æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªåå«urlpatternsçš„åˆ—è¡¨ä¸­ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªé…ç½®é¡¹ï¼Œæ¯ä¸€ä¸ªé…ç½®é¡¹éƒ½è°ƒç”¨urlå‡½æ•°ã€‚

4\. urlåŒ¹é…çš„è¿‡ç¨‹
------------

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717972197-c049a13c-c5e0-4094-8527-2d530745e097.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u92f45246&name=image.png&originHeight=912&originWidth=1393&originalType=url&ratio=1&rotation=0&showTitle=false&size=158017&status=done&style=none&taskId=u11740cd9-c87c-48f1-9859-48a688189af&title=)

**url:** [http://127.0.0.1:8000/aindex?a=1](http://127.0.0.1:8000/aindex?a=1)

1.  å»é™¤åŸŸåå’Œåé¢çš„å‚æ•°ï¼Œå‰©ä¸‹/aindex,å†æŠŠå‰é¢çš„/å»æ‰ï¼Œå‰©ä¸‹aindex
2.  æ‹¿aindexå…ˆåˆ°é¡¹ç›®çš„url.pyæ–‡ä»¶ä¸­è¿›è¡Œä»ä¸Šåˆ°ä¸‹çš„åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸä¹‹åæ‰§è¡Œåé¢å¯¹åº”çš„å¤„ç†åŠ¨ä½œï¼Œå°±æ˜¯æŠŠåŒ¹é…æˆåŠŸçš„éƒ¨åˆ†aå­—ç¬¦å»é™¤ï¼Œç„¶åæ‹¿å‰©ä¸‹çš„éƒ¨åˆ†indexåˆ°åº”ç”¨çš„urls.pyæ–‡ä»¶ä¸­å†è¿›è¡Œä»ä¸Šåˆ°ä¸‹çš„åŒ¹é…ã€‚
3.  å¦‚æœåŒ¹é…æˆåŠŸåˆ™è°ƒç”¨ç›¸åº”çš„è§†å›¾äº§ç”Ÿå†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¦‚æœåŒ¹é…å¤±è´¥åˆ™äº§ç”Ÿ404é”™è¯¯ã€‚

4\. é”™è¯¯è§†å›¾
--------

404ï¼šæ‰¾ä¸åˆ°é¡µé¢ï¼Œå…³é—­è°ƒè¯•æ¨¡å¼ä¹‹åï¼Œé»˜è®¤ä¼šæ˜¾ç¤ºä¸€ä¸ªæ ‡å‡†çš„é”™è¯¯é¡µé¢ï¼Œå¦‚æœè¦æ˜¾ç¤ºè‡ªå®šä¹‰çš„é¡µé¢ï¼Œåˆ™éœ€è¦çš„templatesç›®å½•ä¸‹é¢è‡ªå®šä¹‰ä¸€ä¸ª404.htmlæ–‡ä»¶ã€‚

1.  urlæ²¡æœ‰é…ç½®
2.  urlé…ç½®é”™è¯¯

500: æœåŠ¡å™¨ç«¯çš„é”™è¯¯ã€‚

1.  è§†å›¾å‡ºé”™

ç½‘ç«™å¼€å‘å®Œæˆéœ€è¦å…³é—­è°ƒè¯•æ¨¡å¼ï¼Œåœ¨settings.pyæ–‡ä»¶ä¸­ï¼š

DEBUG=False

ALLOWED\_HOST=\[ â€˜\*â€™\]

5\. æ•è·urlå‚æ•°
-----------

è¿›è¡ŒurlåŒ¹é…æ—¶ï¼ŒæŠŠæ‰€éœ€è¦çš„æ•è·çš„éƒ¨åˆ†è®¾ç½®æˆä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ç»„ï¼Œè¿™æ ·djangoæ¡†æ¶å°±ä¼šè‡ªåŠ¨æŠŠåŒ¹é…æˆåŠŸåç›¸åº”ç»„çš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™è§†å›¾å‡½æ•°ã€‚

1.  ä½ç½®å‚æ•°  
    ä½ç½®å‚æ•°ï¼Œå‚æ•°åå¯ä»¥éšæ„æŒ‡å®š
2.  å…³é”®å­—å‚æ•°ï¼šåœ¨ä½ç½®å‚æ•°çš„åŸºç¡€ä¸Šç»™æ­£åˆ™è¡¨è¾¾å¼ç»„å‘½åå³å¯ã€‚  
    ?P<ç»„å>  
    å…³é”®å­—å‚æ•°ï¼Œè§†å›¾ä¸­å‚æ•°åå¿…é¡»å’Œæ­£åˆ™è¡¨è¾¾å¼ç»„åä¸€è‡´.

6\. æ™®é€šç™»å½•æ¡ˆä¾‹
----------

### 6.1æ˜¾ç¤ºå‡ºç™»å½•é¡µé¢

1.  è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® [http://127.0.0.1:8000/login](http://127.0.0.1:8000/login) æ—¶æ˜¾ç¤ºç™»å½•é¡µé¢
2.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°loginã€‚
3.  ç¼–å†™æ¨¡æ¿æ–‡ä»¶login.htmlã€‚

### 6.2 ç™»å½•æ ¡éªŒåŠŸèƒ½

1.  è®¾è®¡url,ç‚¹å‡»ç™»å½•é¡µçš„ç™»å½•æŒ‰é’®å‘èµ·è¯·æ±‚ [http://127.0.0.1:8000/login\_checkæ—¶è¿›è¡Œç™»å½•æ ¡éªŒã€‚](http://127.0.0.1:8000/login_check%E6%97%B6%E8%BF%9B%E8%A1%8C%E7%99%BB%E5%BD%95%E6%A0%A1%E9%AA%8C%E3%80%82)
2.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°login\_checkã€‚  
    æ¥æ”¶è¡¨å•æäº¤è¿‡æ¥çš„æ•°æ®ã€‚  
    è¿›è¡Œç™»å½•æ ¡éªŒï¼Œè‹¥ç”¨æˆ·åå¯†ç æ­£ç¡®åˆ™è·³è½¬åˆ°ç™»å½•æˆåŠŸé¡µã€‚è‹¥å¤±è´¥åœ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚
3.  ç™»å½•æˆåŠŸåè·³è½¬åˆ°é¦–é¡µã€‚

7\. Ajax
--------

### 7.1 åŸºæœ¬æ¦‚å¿µ

å¼‚æ­¥çš„javascriptã€‚åœ¨ä¸å…¨éƒ¨åŠ è½½æŸä¸€ä¸ªé¡µé¢éƒ¨çš„æƒ…å†µä¸‹ï¼Œå¯¹é¡µé¢è¿›è¡Œå±€çš„åˆ·æ–°ï¼Œajaxè¯·æ±‚éƒ½åœ¨åå°ã€‚

å›¾ç‰‡ï¼Œcssæ–‡ä»¶ï¼Œjsæ–‡ä»¶éƒ½æ˜¯é™æ€æ–‡ä»¶ã€‚

1.  å‘èµ·ajaxè¯·æ±‚ï¼šjqueryå‘èµ·
2.  æ‰§è¡Œç›¸åº”çš„è§†å›¾å‡½æ•°ï¼Œè¿”å›jsonå†…å®¹
3.  æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚é€šè¿‡åˆ¤æ–­jsonå†…å®¹ï¼Œè¿›è¡Œç›¸åº”å¤„ç†ã€‚

### 7.2 Ajaxç™»å½•æ¡ˆä¾‹

1.  é¦–å…ˆåˆ†æå‡ºè¯·æ±‚åœ°å€æ—¶éœ€è¦æºå¸¦çš„å‚æ•°ã€‚
2.  è§†å›¾å‡½æ•°å¤„ç†å®Œæˆä¹‹åï¼Œæ‰€è¿”å›çš„jsonçš„æ ¼å¼ã€‚

**æ˜¾ç¤ºå‡ºç™»å½•é¡µé¢**

1.  **è®¾è®¡urlï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® **[**http://127.0.0.1:8000/login\_ajax**](http://127.0.0.1:8000/login_ajax)** æ—¶æ˜¾ç¤ºç™»å½•é¡µé¢**
2.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°login\_ajaxã€‚
3.  ç¼–å†™æ¨¡æ¿æ–‡ä»¶login\_ajax.htmlã€‚

    def login_ajax(request):
            returnrender(request,'booktest/login_ajax.html')
    

2.  **ç™»å½•æ ¡éªŒåŠŸèƒ½**
3.  è®¾è®¡url,ç‚¹å‡»ç™»å½•é¡µçš„ç™»å½•æŒ‰é’®å‘èµ·è¯·æ±‚http://127.0.0.1:8000/login\_ajax\_check æ—¶è¿›è¡Œç™»å½•æ ¡éªŒã€‚
4.  è®¾è®¡urlå¯¹åº”çš„è§†å›¾å‡½æ•°login\_ajax\_checkã€‚  
    æ¥æ”¶postæäº¤è¿‡æ¥çš„æ•°æ®ã€‚  
    è¿›è¡Œç™»å½•æ ¡éªŒï¼Œå¹¶è¿”å›jsonå†…å®¹ã€‚ JsonRepsone  
    **Jsonæ ¼å¼å¦‚ä¸‹ï¼š**

    {â€˜resâ€™:â€˜1â€™} #è¡¨ç¤ºç™»å½•æˆåŠŸ
    
    {â€˜resâ€™:â€˜0â€™} #è¡¨ç¤ºç™»å½•å¤±è´¥
    

8\. çŠ¶æ€ä¿æŒ
--------

httpåè®®æ˜¯æ— çŠ¶æ€çš„ã€‚ä¸‹ä¸€æ¬¡å»è®¿é—®ä¸€ä¸ªé¡µé¢æ—¶å¹¶ä¸çŸ¥é“ä¸Šä¸€æ¬¡å¯¹è¿™ä¸ªé¡µé¢åšäº†ä»€ä¹ˆã€‚

### 8.1 Cookie

cookieæ˜¯ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå­˜å‚¨åœ¨æµè§ˆå™¨ç«¯çš„ä¸€å°æ®µæ–‡æœ¬ä¿¡æ¯ã€‚

cookieçš„ç‰¹ç‚¹ï¼š

1.  ä»¥é”®å€¼å¯¹æ–¹å¼è¿›è¡Œå­˜å‚¨ã€‚
2.  é€šè¿‡æµè§ˆå™¨è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œä¼šå°†æµè§ˆå™¨å­˜å‚¨çš„è·Ÿç½‘ç«™ç›¸å…³çš„æ‰€æœ‰cookieä¿¡æ¯å‘é€ç»™è¯¥ç½‘ç«™çš„æœåŠ¡å™¨ã€‚request.COOKIES
3.  cookieæ˜¯åŸºäºåŸŸåå®‰å…¨çš„ã€‚www.baidu.com
4.  cookieæ˜¯æœ‰è¿‡æœŸæ—¶é—´çš„ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤å…³é—­æµè§ˆå™¨ä¹‹åcookieå°±ä¼šè¿‡æœŸã€‚

è®°ä½ç”¨æˆ·åæ¡ˆä¾‹:

### 8.2 Session

sessionå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ã€‚

sessionçš„ç‰¹ç‚¹ï¼š

1.  sessionæ˜¯ä»¥é”®å€¼å¯¹è¿›è¡Œå­˜å‚¨çš„ã€‚
2.  sessionä¾èµ–äºcookieã€‚å”¯ä¸€çš„æ ‡è¯†ç ä¿å­˜åœ¨sessionid cookieä¸­ã€‚
3.  sessionä¹Ÿæ˜¯æœ‰è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸¤å‘¨å°±ä¼šè¿‡æœŸã€‚

**è®°ä½ç”¨æˆ·ç™»å½•çŠ¶æ€æ¡ˆä¾‹ã€‚**

### 8.3 cookieå’Œsessionçš„åº”ç”¨åœºæ™¯

cookie:è®°ä½ç”¨æˆ·åã€‚å®‰å…¨æ€§è¦æ±‚ä¸é«˜ã€‚

session:æ¶‰åŠåˆ°å®‰å…¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„æ•°æ®ã€‚é“¶è¡Œå¡è´¦æˆ·,å¯†ç 

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717985893-16be2001-f48a-44e3-937d-d8f7e25c2074.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u0f67e80b&name=image.png&originHeight=901&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=106783&status=done&style=none&taskId=ubcd49c48-4971-4dcb-b68d-15b76a8b659&title=)![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717986197-aec5cdcf-bd0b-4eef-8b71-99216f98d5f2.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u492b9eb6&name=image.png&originHeight=840&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=156051&status=done&style=none&taskId=u1c99fbc0-7088-49f6-b068-2e661df026d&title=)![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717986146-0e2346a2-96a7-4115-a05c-87bc9283cb4e.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u71798630&name=image.png&originHeight=854&originWidth=1100&originalType=url&ratio=1&rotation=0&showTitle=false&size=155772&status=done&style=none&taskId=u56ef66d1-e361-447a-8049-f331aedad16&title=)

Django æ¨¡æ¿
=========

æ¨¡æ¿
==

1\. æ¨¡æ¿çš„åŠŸèƒ½
---------

äº§ç”Ÿhtmlï¼Œæ§åˆ¶é¡µé¢ä¸Šå±•ç¤ºçš„å†…å®¹ã€‚æ¨¡æ¿æ–‡ä»¶ä¸ä»…ä»…æ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶ã€‚

æ¨¡æ¿æ–‡ä»¶åŒ…å«ä¸¤éƒ¨åˆ†å†…å®¹ï¼š

1.  é™æ€å†…å®¹ï¼šcss,js,htmlã€‚
2.  åŠ¨æ€å†…å®¹ï¼šç”¨äºåŠ¨æ€å»äº§ç”Ÿä¸€äº›ç½‘é¡µå†…å®¹ã€‚é€šè¿‡æ¨¡æ¿è¯­è¨€æ¥äº§ç”Ÿã€‚

2\. æ¨¡æ¿æ–‡ä»¶çš„ä½¿ç”¨
-----------

é€šå¸¸æ˜¯åœ¨è§†å›¾å‡½æ•°ä¸­ä½¿ç”¨æ¨¡æ¿äº§ç”Ÿhtmlå†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

1.  åŠ è½½æ¨¡æ¿æ–‡ä»¶ loader.get\_template  
    è·å–æ¨¡æ¿æ–‡ä»¶çš„å†…å®¹ï¼Œäº§ç”Ÿä¸€ä¸ªæ¨¡æ¿å¯¹è±¡ã€‚
2.  å®šä¹‰æ¨¡æ¿ä¸Šä¸‹æ–‡ RequeseContext  
    ç»™æ¨¡æ¿æ–‡ä»¶ä¼ é€’æ•°æ®ã€‚
3.  æ¨¡æ¿æ¸²æŸ“äº§ç”Ÿhtmlé¡µé¢å†…å®¹ render  
    ç”¨ä¼ é€’çš„æ•°æ®æ›¿æ¢ç›¸åº”çš„å˜é‡ï¼Œäº§ç”Ÿä¸€ä¸ªæ›¿æ¢åçš„æ ‡å‡†çš„htmlå†…å®¹ã€‚

3\. æ¨¡æ¿æ–‡ä»¶åŠ è½½é¡ºåº
------------

1.  é¦–å…ˆå»é…ç½®çš„æ¨¡æ¿ç›®å½•ä¸‹é¢å»æ‰¾æ¨¡æ¿æ–‡ä»¶ã€‚
2.  å»INSTALLED\_APPSä¸‹é¢çš„æ¯ä¸ªåº”ç”¨çš„templateså»æ‰¾æ¨¡æ¿æ–‡ä»¶ï¼Œå‰ææ˜¯åº”ç”¨ä¸­å¿…é¡»æœ‰templatesæ–‡ä»¶å¤¹ã€‚

4\. æ¨¡æ¿è¯­è¨€
--------

æ¨¡æ¿è¯­è¨€ç®€ç§°ä¸ºDTLã€‚ï¼ˆDjango Template Languageï¼‰

### 4.1 æ¨¡æ¿å˜é‡

æ¨¡æ¿å˜é‡åæ˜¯ç”±æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿å’Œç‚¹ç»„æˆçš„ï¼Œä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ã€‚

ä½¿ç”¨æ¨¡æ¿å˜é‡ï¼š{{æ¨¡æ¿å˜é‡å}}

æ¨¡æ¿å˜é‡çš„è§£æé¡ºåºï¼š

ä¾‹å¦‚ï¼š{{ book.btitle }}

1.  é¦–å…ˆæŠŠbookå½“æˆä¸€ä¸ªå­—å…¸ï¼ŒæŠŠbtitleå½“æˆé”®åï¼Œè¿›è¡Œå–å€¼book\[â€˜btitleâ€™\]
2.  æŠŠbookå½“æˆä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠbtitleå½“æˆå±æ€§ï¼Œè¿›è¡Œå–å€¼book.btitle
3.  æŠŠbookå½“æˆä¸€ä¸ªå¯¹è±¡ï¼ŒæŠŠbtitleå½“æˆå¯¹è±¡çš„æ–¹æ³•ï¼Œè¿›è¡Œå–å€¼book.btitle

*   ä¾‹å¦‚ï¼š{{book.0}}
    1.  é¦–å…ˆæŠŠbookå½“æˆä¸€ä¸ªå­—å…¸ï¼ŒæŠŠ0å½“æˆé”®åï¼Œè¿›è¡Œå–å€¼book\[0\]
    2.  æŠŠbookå½“æˆä¸€ä¸ªåˆ—è¡¨ï¼ŒæŠŠ0å½“æˆä¸‹æ ‡ï¼Œè¿›è¡Œå–å€¼book\[0\]

å¦‚æœè§£æå¤±è´¥ï¼Œåˆ™äº§ç”Ÿå†…å®¹æ—¶ç”¨ç©ºå­—ç¬¦ä¸²å¡«å……æ¨¡æ¿å˜é‡ã€‚

**ä½¿ç”¨æ¨¡æ¿å˜é‡æ—¶ï¼Œ.å‰é¢çš„å¯èƒ½æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜å¯èƒ½æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚**

### 4.2 æ¨¡æ¿æ ‡ç­¾

    {% ä»£ç æ®µ %}
        forå¾ªç¯ï¼š
        {% for x in åˆ—è¡¨ %}
        # åˆ—è¡¨ä¸ä¸ºç©ºæ—¶æ‰§è¡Œ
        {% empty %}
        # åˆ—è¡¨ä¸ºç©ºæ—¶æ‰§è¡Œ
        {% endfor %}
    å¯ä»¥é€šè¿‡{{ forloop.counter }}å¾—åˆ°forå¾ªç¯éå†åˆ°äº†ç¬¬å‡ æ¬¡ã€‚
    {% if æ¡ä»¶ %}
    
    {% elif æ¡ä»¶ %}
    
    {% else %}
    
    {% endif %}
    

å…³ç³»æ¯”è¾ƒæ“ä½œç¬¦ï¼š> < >= <= == !=

æ³¨æ„ï¼šè¿›è¡Œæ¯”è¾ƒæ“ä½œæ—¶ï¼Œæ¯”è¾ƒæ“ä½œç¬¦ä¸¤è¾¹å¿…é¡»æœ‰ç©ºæ ¼ã€‚

é€»è¾‘è¿ç®—ï¼šnot and or

### 4.3 è¿‡æ»¤å™¨

è¿‡æ»¤å™¨ç”¨äºå¯¹æ¨¡æ¿å˜é‡è¿›è¡Œæ“ä½œã€‚

dateï¼šæ”¹å˜æ—¥æœŸçš„æ˜¾ç¤ºæ ¼å¼ã€‚

length:æ±‚é•¿åº¦ã€‚å­—ç¬¦ä¸²ï¼Œåˆ—è¡¨.

default:è®¾ç½®æ¨¡æ¿å˜é‡çš„é»˜è®¤å€¼ã€‚

æ ¼å¼ï¼šæ¨¡æ¿å˜é‡ï½œè¿‡æ»¤å™¨ï¼šå‚æ•°

è‡ªå®šä¹‰è¿‡æ»¤å™¨ã€‚

**è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨å‡½æ•°ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ï¼Œæœ€å¤šä¸¤ä¸ª**

**å‚è€ƒèµ„æ–™ï¼š(æ¨¡æ¿æ ‡ç­¾å’Œå†…ç½®è¿‡æ»¤å™¨)**

[http://python.usyiyi.cn/documents/django\_182/ref/templates/builtins.html](http://python.usyiyi.cn/documents/django_182/ref/templates/builtins.html)

### 4.4 æ¨¡æ¿æ³¨é‡Š

å•è¡Œæ³¨é‡Šï¼š{# æ³¨é‡Šå†…å®¹ #}

å¤šè¡Œæ³¨é‡Šï¼š

    {% comment %}
    æ³¨é‡Šå†…å®¹
    {% endcomment %}
    

5\. æ¨¡æ¿ç»§æ‰¿
--------

æ¨¡æ¿ç»§æ‰¿ä¹Ÿæ˜¯ä¸ºäº†é‡ç”¨htmlé¡µé¢å†…å®¹ã€‚  
![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660717995747-94f182e3-53ba-4265-9c29-08b7f4bd8eaa.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u7adb35e0&name=image.png&originHeight=935&originWidth=1098&originalType=url&ratio=1&rotation=0&showTitle=false&size=149132&status=done&style=none&taskId=uec4a37ec-1408-462b-9e70-fa8e076932d&title=)

**åœ¨çˆ¶æ¨¡æ¿é‡Œå¯ä»¥å®šä¹‰å—ï¼Œä½¿ç”¨æ ‡ç­¾ï¼š**

    {% block å—å %}
    å—ä¸­é—´å¯ä»¥å†™å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä¸å†™
    {% endblock å—å%}
    

å­æ¨¡æ¿å»ç»§æ‰¿çˆ¶æ¨¡æ¿ä¹‹åï¼Œå¯ä»¥é‡å†™çˆ¶æ¨¡æ¿ä¸­çš„æŸä¸€å—çš„å†…å®¹ã€‚

**ç»§æ‰¿æ ¼å¼ï¼š{% extends çˆ¶æ¨¡æ¿æ–‡ä»¶è·¯å¾„%}**

{% block å—å %}

{{ block.super}} #è·å–çˆ¶æ¨¡æ¿ä¸­å—çš„é»˜è®¤å†…å®¹

é‡å†™çš„å†…å®¹

{% endblock å—å%}

6\. htmlè½¬ä¹‰
----------

ç¼–è¾‘å•†å“è¯¦æƒ…ä¿¡æ¯ï¼Œæ•°æ®è¡¨ä¸­ä¿å­˜çš„æ˜¯htmlå†…å®¹ã€‚

åœ¨æ¨¡æ¿ä¸Šä¸‹æ–‡ä¸­çš„htmlæ ‡è®°é»˜è®¤æ˜¯ä¼šè¢«è½¬ä¹‰çš„ã€‚

    å°äºå·< è½¬æ¢ä¸º&lt;
    
    å¤§äºå·> è½¬æ¢ä¸º&gt;
    
    å•å¼•å·' è½¬æ¢ä¸º&#39;
    
    åŒå¼•å·" è½¬æ¢ä¸º &quot;
    
    ä¸ç¬¦å·& è½¬æ¢ä¸º &amp;
    

è¦å…³é—­æ¨¡æ¿ä¸Šä¸‹æ–‡å­—ç¬¦ä¸²çš„è½¬ä¹‰ï¼šå¯ä»¥ä½¿ç”¨ {{ æ¨¡æ¿å˜é‡|safe}}

    {% autoescape off %}
    æ¨¡æ¿è¯­è¨€ä»£ç 
    {% endautoescape %}
    

æ¨¡æ¿ç¡¬ç¼–ç ä¸­çš„å­—ç¬¦ä¸²é»˜è®¤ä¸ä¼šç»è¿‡è½¬ä¹‰ï¼Œå¦‚æœéœ€è¦è½¬ä¹‰ï¼Œé‚£éœ€è¦æ‰‹åŠ¨è¿›è¡Œè½¬ä¹‰ã€‚

7\. csrfæ”»å‡»
----------

é¦–å…ˆåšä¸€ä¸ªç™»å½•é¡µï¼Œè®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œç™»å½•æˆåŠŸä¹‹åè·³è½¬çš„ä¿®æ”¹å¯†ç é¡µé¢ã€‚åœ¨ä¿®æ”¹å¯†ç é¡µé¢è¾“å…¥æ–°å¯†ç ï¼Œç‚¹å‡»ç¡®è®¤æŒ‰é’®å®Œæˆå¯†ç ä¿®æ”¹ã€‚

ç™»å½•é¡µéœ€è¦ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶login.html.ä¿®æ”¹å¯†ç é¡µé¢ä¹Ÿéœ€è¦ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶change\_pwd.html.

æ˜¾ç¤ºç™»å½•é¡µçš„è§†å›¾loginï¼ŒéªŒè¯ç™»å½•çš„è§†å›¾login\_checkï¼Œæ˜¾ç¤ºå‘å¸–é¡µçš„è§†å›¾change\_pwd,å¤„ç†ä¿®æ”¹å¯†ç çš„è§†å›¾change\_pwd\_action.

åŠ åŠŸèƒ½ï¼š

> ç”¨æˆ·ç™»å½•ä¹‹åæ‰å¯ä»¥è¿›è¡Œä¿®æ”¹å¯†ç æ“ä½œã€‚

**ç™»å½•è£…é¥°å™¨å‡½æ•°ã€‚**

![](../_resources/a0e02ebdd393919de7228885ba267a55.png#crop=0&crop=0&crop=1&crop=1&id=xNoXJ&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**æ¡ˆä¾‹æµç¨‹å›¾ï¼š**

![](../_resources/debd94ab54c5563c8bcbf809c8f98be5.png#crop=0&crop=0&crop=1&crop=1&id=E2Fr0&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

djangoé˜²æ­¢csrfçš„æ–¹å¼ï¼š

1.  é»˜è®¤æ‰“å¼€csrfä¸­é—´ä»¶ã€‚
2.  è¡¨å•postæäº¤æ•°æ®æ—¶åŠ ä¸Š{% csrf\_token %}æ ‡ç­¾ã€‚

**é˜²å¾¡åŸç†:**

1.  æ¸²æŸ“æ¨¡æ¿æ–‡ä»¶æ—¶åœ¨é¡µé¢ç”Ÿæˆä¸€ä¸ªåå­—å«åšcsrfmiddlewaretokençš„éšè—åŸŸã€‚
2.  æœåŠ¡å™¨äº¤ç»™æµè§ˆå™¨ä¿å­˜ä¸€ä¸ªåå­—ä¸ºcsrftokençš„cookieä¿¡æ¯ã€‚
3.  æäº¤è¡¨å•æ—¶ï¼Œä¸¤ä¸ªå€¼éƒ½ä¼šå‘ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœä¸€æ ·ï¼Œåˆ™csrféªŒè¯é€šè¿‡ï¼Œå¦åˆ™å¤±è´¥ã€‚

8\. éªŒè¯ç 
-------

åœ¨ç”¨æˆ·æ³¨å†Œã€ç™»å½•é¡µé¢ï¼Œä¸ºäº†é˜²æ­¢æš´åŠ›è¯·æ±‚ï¼Œå¯ä»¥åŠ å…¥éªŒè¯ç åŠŸèƒ½ï¼Œå¦‚æœéªŒè¯ç é”™è¯¯ï¼Œåˆ™ä¸éœ€è¦ç»§ç»­å¤„ç†ï¼Œå¯ä»¥å‡è½»ä¸šåŠ¡æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨çš„å‹åŠ›ã€‚

9\. åå‘è§£æ
--------

å½“æŸä¸€ä¸ªurlé…ç½®çš„åœ°å€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé¡µé¢ä¸Šä½¿ç”¨åå‘è§£æç”Ÿæˆåœ°å€çš„ä½ç½®ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ã€‚

**æ ¹æ®url æ­£åˆ™è¡¨è¾¾å¼çš„é…ç½®åŠ¨æ€çš„ç”Ÿæˆurlã€‚**

**åœ¨é¡¹ç›®urlsä¸­åŒ…å«å…·ä½“åº”ç”¨çš„urlsæ–‡ä»¶æ—¶æŒ‡å®šnamespace;**

    urlpatterns-[
        url(r'^admin/',include(admin.site.urls)),
        # åŒ…å«åº”ç”¨çš„urlsæ–‡ä»¶	
        url(r'^',include('booktest.urls'),namespace='booktest'),
    ]
    

**åœ¨åº”ç”¨çš„urlsä¸­é…ç½®æ˜¯æŒ‡å®šname;**

    urlpatterns-[
        url(r'^index1/$',views.index1,name='index1'),
        url(r'^index2/$',views.index2,name='index2'),
    ]
    

    åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­ä½¿ç”¨æ—¶ï¼Œæ ¼å¼å¦‚ä¸‹:
    {% url 'namespaceåå­—ï¼šname' %} 
    ä¾‹å¦‚{% url 'booktest:fan2'%}
    

    å¸¦ä½ç½®å‚æ•°ï¼š
    {% url 'namespaceåå­—ï¼šname' å‚æ•° %} 
    ä¾‹å¦‚{% url 'booktest:fan2' 1%}
    

    å¸¦å…³é”®å­—å‚æ•°ï¼š
    {% url 'namespaceåå­—ï¼šname' å…³é”®å­—å‚æ•° %} 
    ä¾‹å¦‚{% url 'booktest:fan2' id=1 %}
    

    åœ¨é‡å®šå‘çš„æ—¶å€™ä½¿ç”¨åå‘è§£æï¼š
    from django.core.urlresolvers import reverse
    

    æ— å‚æ•°ï¼š
    reverse('namespaceåå­—:nameåå­—')
    

    å¦‚æœæœ‰ä½ç½®å‚æ•°
    reverse('namespaceåå­—:nameåå­—', args = ä½ç½®å‚æ•°å…ƒç»„)
    

    å¦‚æœæœ‰å…³é”®å­—å‚æ•°
    reverse('namespaceåå­—:nameåå­—', kwargs=å­—å…¸)
    

Django å…¶ä»–æŠ€æœ¯
===========

å…¶ä»–æŠ€æœ¯
====

1\. é™æ€æ–‡ä»¶
--------

### 1.1 ä½¿ç”¨

åœ¨ ç½‘é¡µä½¿ç”¨çš„cssæ–‡ä»¶ï¼Œjsæ–‡ä»¶å’Œå›¾ç‰‡å«åšé™æ€æ–‡ä»¶ã€‚

1.  æ–°å»ºé™æ€æ–‡ä»¶å¤¹ staticã€‚
2.  é…ç½®é™æ€æ–‡ä»¶æ‰€åœ¨çš„ç‰©ç†ç›®å½•ã€‚Settings.py

    STATIC_URL = '/static/'
    STATICFILES_DIRS = [BASE_DIR / 'static']
    STATIC_ROOT = "/home/zic/æ¡Œé¢/singleBlog/singleBlog/static"
    

STATIC\_URLè®¾ç½®è®¿é—®é™æ€æ–‡ä»¶å¯¹åº”çš„urlã€‚

STATICFILES\_DIRSè®¾ç½®é™æ€æ–‡ä»¶æ‰€åœ¨çš„ç‰©ç†ç›®å½•ã€‚

**åŠ¨æ€ç”Ÿæˆé™æ€æ–‡ä»¶çš„è·¯å¾„ã€‚**

### 1.2 åŠ è½½ç›®å½•

    STATICFILES_FINDERS=('django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder')
    

2\. ä¸­é—´ä»¶
-------

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718004938-03040550-13f8-4ee8-933a-ef232e7d1a1d.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=udd60381b&name=image.png&originHeight=212&originWidth=352&originalType=url&ratio=1&rotation=0&showTitle=false&size=21500&status=done&style=none&taskId=u85669701-bc07-4aaa-a95d-aafa84a3ff2&title=)

ä¸­é—´ä»¶å‡½æ•°æ˜¯djangoæ¡†æ¶ç»™æˆ‘ä»¬é¢„ç•™çš„å‡½æ•°æ¥å£ï¼Œè®©æˆ‘ä»¬å¯ä»¥å¹²é¢„è¯·æ±‚å’Œåº”ç­”çš„è¿‡ç¨‹ã€‚

### 2.1 è·å–æµè§ˆå™¨ç«¯çš„ipåœ°å€

ä½¿ç”¨requestå¯¹è±¡çš„METAå±æ€§ï¼šrequest.META\[â€˜REMOTE\_ADDRâ€™\]

### 2.2 ä½¿ç”¨ä¸­é—´ä»¶

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718009883-2f939e57-7eac-48d7-90bd-2faa4d825849.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ufedd08be&name=image.png&originHeight=659&originWidth=1099&originalType=url&ratio=1&rotation=0&showTitle=false&size=70265&status=done&style=none&taskId=u2155db91-5cc6-4ed3-8f04-fe8dfba5ee8&title=)

1.  æ–°å»ºmiddleware.pyæ–‡ä»¶ã€‚
2.  å®šä¹‰ä¸­é—´ä»¶ç±»ã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718020575-818adea8-5c1b-4c46-a95b-e144995e1440.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ue2467254&name=image.png&originHeight=517&originWidth=1158&originalType=url&ratio=1&rotation=0&showTitle=false&size=221866&status=done&style=none&taskId=ub01b23f2-c923-4d83-943d-0317c81773a&title=)

åœ¨ç±»ä¸­å®šä¹‰ä¸­é—´ä»¶é¢„ç•™å‡½æ•°ã€‚  
ğŸ’¡ _init_:æœåŠ¡å™¨å“åº”ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™è°ƒç”¨ã€‚  
ğŸ’¡ process\_request:æ˜¯åœ¨äº§ç”Ÿrequestå¯¹è±¡ï¼Œè¿›è¡ŒurlåŒ¹é…ä¹‹å‰è°ƒç”¨ã€‚  
ğŸ’¡ process\_viewï¼šæ˜¯urlåŒ¹é…ä¹‹åï¼Œè°ƒç”¨è§†å›¾å‡½æ•°ä¹‹å‰ã€‚  
ğŸ’¡ process\_responseï¼šè§†å›¾å‡½æ•°è°ƒç”¨ä¹‹åï¼Œå†…å®¹è¿”å›ç»™æµè§ˆå™¨ä¹‹å‰ã€‚  
ğŸ’¡ process\_exception:è§†å›¾å‡½æ•°å‡ºç°å¼‚å¸¸ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚  
å¦‚æœæ³¨å†Œçš„å¤šä¸ªä¸­é—´ä»¶ç±»ä¸­åŒ…å«process\_exceptionå‡½æ•°çš„æ—¶å€™ï¼Œè°ƒç”¨çš„é¡ºåºè·Ÿæ³¨å†Œçš„é¡ºåºæ˜¯ç›¸åçš„ã€‚

1.  æ³¨å†Œä¸­é—´ä»¶ç±»ã€‚  
    ![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718027752-abe43a02-769e-4a97-a496-18ef966d1a0c.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=408&id=u43a696a3&name=image.png&originHeight=408&originWidth=1090&originalType=binary&ratio=1&rotation=0&showTitle=false&size=228127&status=done&style=none&taskId=uc2a1c3a7-e232-410b-a704-912b34036c6&title=&width=1090)

3\. Adminåå°ç®¡ç†
-------------

### 3.1 ä½¿ç”¨

1.  æœ¬åœ°åŒ–ã€‚è¯­è¨€å’Œæ—¶åŒºæœ¬åœ°åŒ–ã€‚
2.  åˆ›å»ºè¶…çº§ç®¡ç†å‘˜ã€‚  
    `python mange.py createsuperuser`
3.  æ³¨å†Œæ¨¡å‹ç±»ã€‚
4.  è‡ªå®šä¹‰ç®¡ç†é¡µé¢ã€‚  
    è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†ç±»ã€‚  
    æ³¨å†Œæ¨¡å‹ç±»çš„æ—¶å€™ç»™registerå‡½æ•°æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†ç±»çš„åå­—ã€‚

### 3.2 æ¨¡å‹ç®¡ç†ç±»ç›¸å…³å±æ€§

1.  åˆ—è¡¨é¡µç›¸å…³çš„é€‰é¡¹ã€‚
2.  ç¼–è¾‘é¡µç›¸å…³çš„é€‰é¡¹ã€‚

4\. ä¸Šä¼ å›¾ç‰‡
--------

å•†å“é”€å”®ç½‘ç«™ã€‚

### 4.1 é…ç½®ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç›®å½•

1.  æ–°å»ºä¸Šä¼ æ–‡ä»¶ä¿å­˜ç›®å½•ã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718051334-4ebbef64-b3de-40af-8aa4-577de4c39bde.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u419c36a1&name=image.png&originHeight=280&originWidth=277&originalType=url&ratio=1&rotation=0&showTitle=false&size=11890&status=done&style=none&taskId=u0d5b754d-8254-45df-9fc5-2dbd515d15e&title=)

2.  é…ç½®ä¸Šä¼ æ–‡ä»¶ä¿å­˜ç›®å½•ã€‚

    MEDIA_URL = '/media/'
    MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
    

### 4.2 åå°ç®¡ç†é¡µé¢ä¸Šä¼ å›¾ç‰‡

1.  è®¾è®¡æ¨¡å‹ç±»ã€‚

    class PicTest(models.Model):
        """ä¸Šä¼ å›¾ç‰‡"""
        good_pic = models.ImageField(upload_to="booktest")
    

2.  è¿ç§»ç”Ÿæˆè¡¨æ ¼ã€‚

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718056438-e945a57a-4b13-4dcc-8c2e-2cb3bdbda8b6.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ufb5fae31&name=image.png&originHeight=320&originWidth=1525&originalType=url&ratio=1&rotation=0&showTitle=false&size=108082&status=done&style=none&taskId=udfe71895-9ec5-445c-ad35-1de60b3d0b6&title=)

3.  æ³¨å†Œæ¨¡å‹ç±»ã€‚

### 4.3 ç”¨æˆ·è‡ªå®šä¹‰é¡µé¢ä¸Šä¼ å›¾ç‰‡

1.  å®šä¹‰ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡çš„é¡µé¢å¹¶æ˜¾ç¤ºï¼Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„è¡¨å•ã€‚

![](../_resources/21f1a43162199003188ef50fbd5baa7b.png#crop=0&crop=0&crop=1&crop=1&id=v18mf&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

2.  å®šä¹‰æ¥æ”¶ä¸Šä¼ æ–‡ä»¶çš„è§†å›¾å‡½æ•°ã€‚  
    requestå¯¹è±¡æœ‰ä¸€ä¸ªFILESçš„å±æ€§ï¼Œç±»ä¼¼äºå­—å…¸ï¼Œé€šè¿‡request.FILESå¯ä»¥è·å–ä¸Šä¼ æ–‡ä»¶çš„å¤„ç†å¯¹è±¡ã€‚  
    åœ¨djangoä¸­ï¼Œä¸Šä¼ æ–‡ä»¶ä¸å¤§äº2.5M,æ–‡ä»¶æ”¾åœ¨å†…å­˜ä¸­ã€‚ä¸Šä¼ æ–‡ä»¶å¤§äº2.5M,æ–‡ä»¶å†…å®¹å†™åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ã€‚  
    Djangoå¤„ç†ä¸Šä¼ æ–‡ä»¶çš„ä¸¤ä¸ªç±»ï¼š

    FILE_UPLOAD_HANDLERS= (
    "django.core.files.uploadhandler.MemoryFileUploadHandler",
    "django.core.files.uploadhandler.TemporaryFileUploadHandler"
    )
    

**ä¸Šä¼ å›¾ç‰‡å‚è€ƒèµ„æ–™ï¼š**

1.  [http://python.usyiyi.cn/documents/django\_182/topics/http/file-uploads.html](http://python.usyiyi.cn/documents/django_182/topics/http/file-uploads.html)
2.  [http://python.usyiyi.cn/documents/django\_182/ref/files/uploads.html#django.core.files.uploadedfile.UploadedFile](http://python.usyiyi.cn/documents/django_182/ref/files/uploads.html#django.core.files.uploadedfile.UploadedFile)

5\. åˆ†é¡µ
------

æŸ¥è¯¢å‡ºæ‰€æœ‰çœçº§åœ°åŒºçš„ä¿¡æ¯ï¼Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚

    areaInfo.objects.filter(aParent__isnull = True)
    

1.  æŸ¥è¯¢å‡ºæ‰€æœ‰çœçº§åœ°åŒºçš„ä¿¡æ¯ã€‚
2.  æŒ‰æ¯é¡µæ˜¾ç¤º10æ¡ä¿¡æ¯è¿›è¡Œåˆ†é¡µï¼Œé»˜è®¤æ˜¾ç¤ºç¬¬ä¸€é¡µçš„ä¿¡æ¯ï¼Œä¸‹é¢å¹¶æ˜¾ç¤ºå‡ºé¡µç ã€‚
3.  ç‚¹å‡»ié¡µé“¾æ¥çš„æ—¶å€™ï¼Œå°±æ˜¾ç¤ºç¬¬ié¡µçš„çœçº§åœ°åŒºä¿¡æ¯ã€‚

    from django.core.paginator import Paginator
    paginator = Paginator(areas, 10) #æŒ‰æ¯é¡µ10æ¡æ•°æ®è¿›è¡Œåˆ†é¡µ
    

**Paginatorç±»å¯¹è±¡çš„å±æ€§:**

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718088848-9b2f54d8-f0ae-4107-8474-e4c77c2d3d32.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ue4f00175&name=image.png&originHeight=90&originWidth=275&originalType=url&ratio=1&rotation=0&showTitle=false&size=4258&status=done&style=none&taskId=u508fc7dc-857f-4ad2-864f-065b390d4a0&title=)

**Paginatorç±»å¯¹è±¡çš„æ–¹æ³•:**

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718091018-11eda1ef-4f65-4e54-a3f5-6f9b2c6b9a10.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u73d7f24b&name=image.png&originHeight=69&originWidth=404&originalType=url&ratio=1&rotation=0&showTitle=false&size=4013&status=done&style=none&taskId=u2a6dee06-5d6c-4cb9-9b36-88e4cd6aa80&title=)

**Pageç±»å¯¹è±¡çš„å±æ€§ï¼š**

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718093124-50d407ea-8332-459c-b5c7-4fe9d637904f.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u7612115c&name=image.png&originHeight=124&originWidth=330&originalType=url&ratio=1&rotation=0&showTitle=false&size=6688&status=done&style=none&taskId=u0aeee062-7f28-4ed2-868c-c2d71e7b8fc&title=)

**Pageç±»å¯¹è±¡çš„æ–¹æ³•ï¼š**

![image.png](https://cdn.nlark.com/yuque/0/2022/png/12843286/1660718095754-15d0305d-b8dd-4ed7-b2a6-6f77303daf12.png#clientId=u9a44a867-5b9f-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u02a36be6&name=image.png&originHeight=145&originWidth=354&originalType=url&ratio=1&rotation=0&showTitle=false&size=6265&status=done&style=none&taskId=u88794242-7a9b-462e-acb9-86b9747b4b1&title=)

> åˆ†é¡µå‚è€ƒèµ„æ–™ï¼š
> 
> [http://python.usyiyi.cn/translate/django\_182/topics/pagination.html](http://python.usyiyi.cn/translate/django_182/topics/pagination.html)

6\. çœå¸‚å¿é€‰æ‹©æ¡ˆä¾‹
-----------

1.  æ˜¾ç¤ºçœåœ°åŒºä¿¡æ¯ã€‚

    $.get('/prov', function(data){
    
    })
    

2.  çœæ”¹å˜æ—¶åœ¨å¯¹åº”çš„ä¸‹æ‹‰åˆ—è¡¨æ¡†ä¸­æ˜¾ç¤ºä¸‹çº§å¸‚çš„ä¿¡æ¯ã€‚

    $.get('/city?pid='+pid, function(data){
    })
    
    request.GET.get('pid')
    æˆ–è€…:
    $.get('/city'+$(this).val(), function(data){
    
    })
    

3.  å¸‚æ”¹å˜æ—¶åœ¨å¯¹åº”çš„ä¸‹æ‹‰åˆ—è¡¨æ¡†ä¸­æ˜¾ç¤ºä¸‹çº§å¿çš„ä¿¡æ¯ã€‚

    $.get('/dis?pid='+pid, function(data){
    
    })
    æˆ–è€…:
    $.get('/dis'+$(this).val(), function(data){
    
    })
    

Django settings é…ç½®
==================

    """
    Django settings for singleBlog project.
    
    Generated by 'django-admin startproject' using Django 3.2.8.
    
    For more information on this file, see
    https://docs.djangoproject.com/en/3.2/topics/settings/
    
    For the full list of settings and their values, see
    https://docs.djangoproject.com/en/3.2/ref/settings/
    """
    
    from pathlib import Path
    import simpleui, ckeditor
    import sys, os
    
    # Build paths inside the project like this: BASE_DIR / 'subdir'.
    BASE_DIR = Path(__file__).resolve().parent.parent
    sys.path.insert(0, os.path.join(BASE_DIR, 'apps'))
    
    # Quick-start development settings - unsuitable for production
    # See https://docs.djangoproject.com/en/3.2/howto/deployment/checklist/
    
    # SECURITY WARNING: keep the secret key used in production secret!
    SECRET_KEY = 'django-insecure-3n0*8@=0qc465q+3j_$v73@l$358(85v09%295&&4jm9lr@(e5'
    
    # SECURITY WARNING: don't run with debug turned on in production!
    DEBUG = True
    
    ALLOWED_HOSTS = ['*']
    
    # Application definition
    
    INSTALLED_APPS = [
        'ckeditor',
        'simpleui',
        'django.contrib.admin',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'blog',  # ä¸»åº”ç”¨
        'user',  # ç”¨æˆ·ä¸­å¿ƒ
        'other',  # å…¶ä»–
    ]
    
    MIDDLEWARE = [
        'django.middleware.security.SecurityMiddleware',
        'django.contrib.sessions.middleware.SessionMiddleware',
        'django.middleware.common.CommonMiddleware',
        'django.middleware.csrf.CsrfViewMiddleware',
        'django.contrib.auth.middleware.AuthenticationMiddleware',
        'django.contrib.messages.middleware.MessageMiddleware',
        'django.middleware.clickjacking.XFrameOptionsMiddleware',
    ]
    
    ROOT_URLCONF = 'singleBlog.urls'
    
    TEMPLATES = [
        {
            'BACKEND': 'django.template.backends.django.DjangoTemplates',
            'DIRS': [BASE_DIR / 'templates'],
            'APP_DIRS': True,
            'OPTIONS': {
                'context_processors': [
                    'django.template.context_processors.debug',
                    'django.template.context_processors.request',
                    'django.contrib.auth.context_processors.auth',
                    'django.contrib.messages.context_processors.messages',
                    'django.template.context_processors.media',  # ç”¨æˆ·ä¸Šä¼ 
                ],
            },
        },
    ]
    
    WSGI_APPLICATION = 'singleBlog.wsgi.application'
    
    # Database
    # https://docs.djangoproject.com/en/3.2/ref/settings/#databases
    
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.mysql',
            'NAME': 'singleblog',
            'HOST': '127.0.0.1',
            'PORT': 3306,
            'USER': 'root',
            'PASSWORD': 'admin*123'
        }
    }
    
    # Password validation
    # https://docs.djangoproject.com/en/3.2/ref/settings/#auth-password-validators
    
    AUTH_PASSWORD_VALIDATORS = [
        {
            'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
        },
        {
            'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
        },
    ]
    
    # Internationalization
    # https://docs.djangoproject.com/en/3.2/topics/i18n/
    
    LANGUAGE_CODE = 'zh-hans'
    
    TIME_ZONE = 'Asia/Shanghai'
    
    USE_I18N = True
    
    USE_L10N = True
    
    USE_TZ = False
    
    # Static files (CSS, JavaScript, Images)
    # https://docs.djangoproject.com/en/3.2/howto/static-files/
    
    STATIC_URL = '/static/'
    STATICFILES_DIRS = [BASE_DIR / 'static']
    STATIC_ROOT = "/home/zic/æ¡Œé¢/singleBlog/singleBlog/static"
    
    # Default primary key field type
    # https://docs.djangoproject.com/en/3.2/ref/settings/#default-auto-field
    
    DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
    
    MEDIA_URL = '/media/'
    MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
    
    AUTHENTICATION_BACKENDS = {
        'apps.user.views.MyBackend',
    }
    # å‘é€é‚®ä»¶é…ç½®
    EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
    # smptæœåŠ¡åœ°å€
    EMAIL_HOST = 'smtp.163.com'
    EMAIL_PORT = 25
    # å‘é€é‚®ä»¶çš„é‚®ç®±  # ZDJTKDEFODMIXSQD
    EMAIL_HOST_USER = 'hybpjx@163.com'
    # åœ¨é‚®ç®±ä¸­è®¾ç½®çš„å®¢æˆ·ç«¯æˆæƒå¯†ç 
    EMAIL_HOST_PASSWORD = 'XDXXQCOFVKZSIQQQ'
    # æ”¶ä»¶äººçœ‹åˆ°çš„å‘ä»¶äºº
    EMAIL_FROM = 'zicåšå®¢<hybpjx@163.com>'
    
    CKEDITOR_CONFIGS = {
        # django-ckeditoré»˜è®¤ä½¿ç”¨defaulté…ç½®
        'default': {
            # ç¼–è¾‘å™¨å®½åº¦è‡ªé€‚åº”
            'width': 'auto',
            'height': '250px',
            # tabé”®è½¬æ¢ç©ºæ ¼æ•°
            'tabSpaces': 4,
            # å·¥å…·æ é£æ ¼
            'toolbar': 'Custom',
            # å·¥å…·æ æŒ‰é’®
            'toolbar_Custom': [
                # è¡¨æƒ… ä»£ç å—
                ['Smiley', 'CodeSnippet'],
                # å­—ä½“é£æ ¼
                ['Bold', 'Italic', 'Underline', 'RemoveFormat', 'Blockquote'],
                # å­—ä½“é¢œè‰²
                ['TextColor', 'BGColor'],
                # é“¾æ¥
                ['Link', 'Unlink'],
                # åˆ—è¡¨
                ['NumberedList', 'BulletedList'],
                # æœ€å¤§åŒ–
                ['Maximize']
            ],
            # åŠ å…¥ä»£ç å—æ’ä»¶
            'extraPlugins': ','.join(['codesnippet', 'widget', 'lineutils']),
    
        }
    }