---
layout: post
title: "ã€SpringBootã€‘YAML é…ç½®æ–‡ä»¶"
date: "2022-06-21T14:17:45.400Z"
---
ã€SpringBootã€‘YAML é…ç½®æ–‡ä»¶
=====================

> ğŸ‘‰ åšå®¢ä¸»é¡µï¼š[å‡†Javaå…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ](https://blog.csdn.net/Coder_Farmer)  
> ğŸ‘‰ 00å¹´å‡ºç”Ÿï¼Œå³å°†è¿›å…¥èŒåœºé—¯è¡ï¼Œç›®æ ‡èµšé’±ï¼Œå¯èƒ½ä¼šæœ‰äººè§‰å¾—æˆ‘æ ¼å±€å°ã€è§‰å¾—ä¿—ï¼Œä½†ä¸å¾—ä¸æ‰¿è®¤è¿™ä¸ªä¸–ç•Œå·²ç»ä¸å†æ˜¯ä»¥ä¸€æ¡çº¿æ¥åˆ†å‰²çš„å¹³é¢ï¼Œè€Œæ˜¯å›´ç»•è´¢å¯Œæ—‹è½¬çš„çƒé¢ï¼Œæˆä¸ºæœ‰é’±äººä¸æ˜¯ä¸ºäº†å»æŒæ§çƒä½“çš„è½¬å‘ï¼Œè€Œæ˜¯å½“æœ‰äººæ¶æ„æŒæ§æ—¶ï¼ŒåŠªåŠ›ä¿æŠ¤å¥½å®¶äººå’Œè‡ªå·±ã€‚

ä¸€ã€YAML ç®€ä»‹
=========

### 1ã€ä»€ä¹ˆæ˜¯ YAML ï¼Ÿ

*   YAMLï¼ˆYAML Ain't Markup Languageï¼‰ï¼Œä¸€ç§æ•°æ®åºåˆ—åŒ–æ ¼å¼ã€‚
*   è¿™ç§æ ¼å¼çš„é…ç½®æ–‡ä»¶è¿‘äº›å¹´é€æ¸è¿›å…¥å¸‚åœºï¼Œå¹¶å¼€å§‹å æ®ä¸»å¯¼åœ°ä½ã€‚

### 2ã€ä¼˜ç‚¹

*   è¾ƒ xml ç±»å‹å’Œ properties ç±»å‹ç›¸æ¯”ï¼Œæ›´å®¹æ˜“é˜…è¯»ï¼Œç»“æ„ä¹Ÿæ›´åŠ çš„æ¸…æ™°ã€‚
*   å®¹æ˜“ä¸è„šæœ¬è¯­è¨€äº¤äº’ã€‚
*   ä»¥æ•°æ®ä¸ºæ ¸å¿ƒï¼Œé‡æ•°æ®è½»æ ¼å¼ï¼Œè½»æ ¼å¼å¹¶ä¸æ˜¯è¯´å¯ä»¥ä¸éµå®ˆæ ¼å¼ï¼Œåªæ˜¯æ ¼å¼æ›´åŠ éšæ€§ä¸€äº›ã€‚

### 3ã€æ‰©å±•å

*   æ‰©å±•åæœ‰ä¸¤ç§ï¼Œæ— è®ºæ˜¯é‚£ä¸ªæ‰©å±•åï¼Œéƒ½æ˜¯ YAML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œæ‹¥æœ‰ YAML çš„å±æ€§ã€‚
    *   .yml ï¼Œè¿™ç§æ‰©å±•åæ›´åŠ ä¸»æµä¸€äº›
    *   .yaml

### 4ã€è¯­æ³•è§„åˆ™

*   å¯¹å¤§å°å†™éå¸¸æ•æ„Ÿï¼Œå¦‚ï¼šå®šä¹‰ age å’Œ AGE éƒ½ä¼šè®¤ä¸ºæ˜¯ä¸¤ä¸ªå±æ€§ã€‚
*   å±æ€§å±‚çº§å…³ç³»ä½¿ç”¨å¤šè¡Œæè¿°ï¼Œæ¯è¡Œç»“å°¾ä½¿ç”¨å†’å·ç»“æŸã€‚
*   ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼ŒåŒå±‚çº§å·¦ä¾§å¯¹é½ï¼Œåªå…è®¸ä½¿ç”¨ç©ºæ ¼ã€‚
*   ç©ºæ ¼ä¸ªæ•°å¹¶ä¸é‡è¦ï¼Œåªè¦ä¿è¯åŒå±‚çº§çš„å·¦ä¾§å¯¹é½å³å¯ã€‚
*   å±æ€§å€¼å‰é¢æ·»åŠ ç©ºæ ¼ã€‚
*   å·è¡¨ç¤ºæ³¨é‡Šã€‚
    ======
    

### 5ã€æ ¼å¼

    server:
      port: 80
    

*   åˆ‡è®°ï¼šå±æ€§å€¼å‰é¢å¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚
*   port æ˜¯ server ä¸‹çš„ä¸€ä¸ªå±æ€§ï¼Œæ ¹æ®å±æ€§å±‚çº§ä¹‹é—´ä½¿ç”¨å¤šè¡Œæè¿°ï¼Œä»¥åŠä½¿ç”¨ç¼©è¿›è¡¨ç¤ºçš„è§„åˆ™ï¼Œport çš„ä¹¦å†™ä½ç½®å¦‚ä¸Šæ‰€ç¤ºï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ç§æ ¼å¼æˆ‘ä»¬æ— éœ€è¿‡å¤šçº ç»“ï¼Œæˆ‘ä»¬å›è½¦æ¢è¡Œåè‡ªåŠ¨æä¾›çš„æ ¼å¼ä¸€èˆ¬éƒ½æ˜¯æ­£ç¡®çš„ã€‚

### 6ã€æ•°ç»„æ•°æ®

    name: å‡†Javaå…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ
    server:
      port: 80
    # æ•°ç»„æ ¼å¼
    likes:
      - game
      - movie
      - music
    

*   æ•°ç»„æ•°æ®çš„å±æ€§å€¼æ¢è¡Œä¹¦å†™ï¼Œä»¥ â€œ-â€ å‡å·å¼€å¤´ï¼Œæ³¨æ„å±æ€§å€¼å‰ç©ºæ ¼ï¼Œå¦‚ä¸Šè¿° likes æ‰€ç¤ºã€‚

äºŒã€ä¸‰ç§é…ç½®æ–‡ä»¶
========

ä»¥é…ç½®ç«¯å£å·ä¸ºä¾‹ï¼Œä»‹ç»ä¸‰ç§é…ç½®æ–‡ä»¶åŠå…¶æ ¼å¼ã€‚

### 1ã€properties ç±»å‹

*   åœ¨æœªæ¥è§¦åˆ° yaml ä¹‹å‰ï¼Œæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶å¤§å¤šæ•°éƒ½æ˜¯ä»¥ properties ç»“å°¾çš„æ–‡ä»¶ã€‚

    server.port=80
    

*   æ ¼å¼ä¸ºï¼šå±æ€§å=å±æ€§å€¼ ã€‚
*   è¿™ç§æ–¹å¼è¿˜æ˜¯éå¸¸å¸¸è§çš„ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨é…ç½®è¿æ¥æ•°æ®åº“ç›¸å…³ä¿¡æ¯çš„ jdbc.properties æ–‡ä»¶ä¹Ÿæ˜¯ä½¿ç”¨çš„è¯¥æ–¹å¼ã€‚

### 2ã€yml ç±»å‹

    server:
      port: 81
    

*   å°†ç«¯å£å·è®¾ç½®ä¸º 81 ã€‚

### 3ã€yaml ç±»å‹

*   yml å’Œ yaml åªæ˜¯æ‰©å±•åä¸åŒè€Œå·²ï¼Œå…¶å®æ˜¯ä¸€ç§ç±»å‹çš„é…ç½®æ–‡ä»¶ã€‚

    server:
      port: 82
    

### 4ã€ä¼˜å…ˆçº§

*   å½“é¡¹ç›®ä¸­åŒæ—¶å­˜åœ¨ä¸Šè¿°ä¸‰ä¸ªé…ç½®æ–‡ä»¶æ—¶ï¼Œç”¨é‡‡ç”¨é‚£ä¸ªé…ç½®æ–‡ä»¶å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿç«¯å£å·æ¥è·å¾—ä¼˜å…ˆçº§é¡ºåºã€‚  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/e8706bb49e0242bd83c6de4399c9ea8b.png#pic_center)
*   ç«¯å£å·ä¸º 80 ï¼Œè¯´æ˜ä¼˜å…ˆé‡‡ç”¨äº† properties ç±»å‹çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒçš„ä¼˜å…ˆçº§æœ€é«˜ã€‚
*   å°† properties é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®å†…å®¹åˆ é™¤ï¼Œè§‚å¯Ÿ .yaml å’Œ .yml é‚£ç§æ–‡ä»¶ä¼˜å…ˆçº§æ›´é«˜ã€‚  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/e06728196fff49b6a43ce440b2a74513.png#pic_center)
*   ç«¯å£å·åˆå˜ä¸ºäº† 81 ï¼Œè¯´æ˜ .yml æ–‡ä»¶ä¼˜å…ˆçº§æ›´é«˜ä¸€äº›ï¼Œè™½ç„¶ .yaml åªæ˜¯ä¸åŒçš„æ‰©å±•åç½¢äº†ã€‚
*   æ€»ç»“ï¼šä¼˜å…ˆçº§ç”±é«˜åˆ°ä½ properties > yml > yaml

ä¸‰ã€YAML ä»£ç æç¤ºåŠŸèƒ½
=============

*   æœ‰å¾ˆå¤šå°ä¼™ä¼´ååº”ï¼Œè¯´åœ¨å†™ YAML æ–‡ä»¶æ—¶ï¼Œä»£ç ä¸æç¤ºã€‚  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/a996a97ee40b4846bd9b6f30b7c81782.png)
*   æ²¡æœ‰ä»£ç æç¤ºåŠŸèƒ½ï¼Œå¯¹æˆ‘ä»¬å¼€å‘è¿˜æ˜¯é€ æˆäº†ä¸€å®šçš„å½±å“çš„ï¼Œä¸‹é¢å°±å¸¦ç€å¤§å®¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
*   é¦–å…ˆè¿›å…¥åˆ°æ¨¡å—ç®¡ç†ã€‚  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/a33e635a82e94922930fa28a1c4d15b1.png#pic_center)
*   å°† YAML ç±»å‹çš„ä¸¤ä¸ªé…ç½®æ–‡ä»¶æ·»åŠ ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/ebb08c75d37d45a78f10a693d03a1dd4.png#pic_center)

*   é€‰ä¸­åˆ›å»ºçš„ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®Œæˆåç‚¹å‡» â€œOKâ€ å³å¯ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6bd1fd81a4be4eaf914043562f0cdddd.png#pic_center)

*   æ­¤æ—¶çš„é…ç½®æ–‡ä»¶å·²ç»å˜æˆäº†ä¸‰ä¸ªã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/4c156ccd6abc4fae8a7516986b0c269f.png#pic_center)

*   é‡æ–°å›åˆ°é…ç½®æ–‡ä»¶çœ‹æ˜¯å¦å®ç°äº†ä»£ç æç¤ºåŠŸèƒ½ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6c972a2d0d5648a8a4aa93c8d3220fa7.png#pic_center)

*   å·²ç»å®ç°äº†ä»£ç æç¤ºåŠŸèƒ½ï¼Œè™½ç„¶æ˜¯ YAML æ–‡ä»¶ï¼Œä½†æ˜¯ä»£ç æç¤ºçš„è¿˜æ˜¯æŒ‰ç…§ properties ç±»å‹è¿›è¡Œçš„ï¼Œå¹¶ä¸å½±å“ï¼Œæ‰¾åˆ°éœ€è¦çš„å±æ€§ç›´æ¥å›è½¦åè¿˜æ˜¯ä¼šå‘ˆç°å‡º YAML æ ¼å¼ã€‚  
    ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/25168c1f837041d9a1d034bf00b88ddb.png)

å››ã€è¯»å– YAML é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®
==================

### 1ã€æ•°æ®å‡†å¤‡

    sourceName: SpringBoot
    
    server:
      port: 80
    
    user:
      name: å‡†Javaå…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ
      age: 22
      likes:
        - music
        - game
        - movie
    

### 2ã€æ–¹å¼ä¸€ï¼š@Value

    @SpringBootTest
    class DemoApplicationTests {
    
        @Value("${sourceName}")
        private String sourceName;
        @Value("${server.port}")
        private Integer port;
        @Value("${user.likes[0]}")
        private String likes;
    
        @Test
        void contextLoads() {
            System.out.println(sourceName);
            System.out.println(port);
            System.out.println(likes);
        }
    }
    

*   å°†è¦è¯»å–çš„æ•°æ®å®šä¹‰ä¸ºå±æ€§ï¼Œä½¿ç”¨ @Value æ³¨è§£è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®å¹¶æ³¨å…¥ç»™å±æ€§ï¼Œä¹‹ååœ¨æ–¹æ³•ä½“ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

### 3ã€æ–¹å¼äºŒï¼šEnvironment

    @SpringBootTest
    class DemoApplicationTests {
        @Autowired
        private Environment environment;
    
        @Test
        void contextLoads() {
            System.out.println(environment.getProperty("sourceName"));
            System.out.println(environment.getProperty("server.port"));
            System.out.println(environment.getProperty("user.likes[0]"));
        }
    }
    

*   SpringBoot æä¾›æœ‰ Environment å¯¹è±¡ï¼Œå¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å°è£…åˆ°è¯¥å¯¹è±¡ä¸­ï¼Œä½¿ç”¨ getProperty æ–¹æ³•ï¼Œå°†æƒ³è¦è¯»å–çš„æ•°æ®åä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ã€‚

### 4ã€æ–¹å¼ä¸‰ï¼šè‡ªå®šä¹‰å¯¹è±¡

    user:
      name: å‡†Javaå…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ
      age: 22
      likes:
        - music
        - game
        - movie
    

*   å¯¹äºé…ç½®ç±»ä¸­çš„ user æ•°æ®ï¼Œå…¶ä¸‹è¿˜æœ‰å¾ˆå¤šå­å±‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä¸€ä¸‹å­å°† user çš„æ‰€æœ‰æ•°æ®éƒ½å–å‡ºï¼Œåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå°†å…¶å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚

    @Component  // å°†beançš„åˆ›å»ºå·¥ä½œäº¤ç”±Springç®¡ç†
    // @ConfigurationProperties æ³¨è§£è¡¨ç¤ºåŠ è½½é…ç½®æ–‡ä»¶
    // ä½¿ç”¨prefixå‰ç¼€è¡¨ç¤ºåªåŠ è½½æŒ‡å®šå‰ç¼€çš„æ•°æ®
    @ConfigurationProperties(prefix = "user")
    public class User {
        private String name;
        private Integer age;
        private Object[] likes;
    	// getã€setã€toStringå’Œæ„é€ å™¨æ–¹æ³•çœç•¥
    }
    

*   å’Œæˆ‘ä»¬å®šä¹‰å®ä½“ç±»æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œåªæ˜¯è¿™æ¬¡ä¸å†æ˜¯å’Œæ•°æ®åº“è¡¨ä¸­çš„å­—æ®µå¯¹åº”ï¼Œè€Œæ˜¯å’Œé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æ•°æ®å¯¹åº”ã€‚
*   é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä½¿ç”¨ ConfigurationProperties æ³¨è§£åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ prefix æŒ‡å®šåŠ è½½æ•°æ®çš„å‰ç¼€ã€‚

    @SpringBootTest
    class DemoApplicationTests {
        @Autowired
        private User user;
    
        @Test
        void contextLoads() {
            System.out.println(user);
        }
    }
    

*   ä½¿ç”¨è¯¥æ–¹å¼åœ¨å®šä¹‰å®ä½“ç±»æ—¶ï¼Œä¼šæŠ¥çº¢æç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/091b0821b007417ca5d94fcc4043c5e3.png#pic_center)

*   æˆ‘ä»¬åªéœ€è¦åœ¨ pom.xml æ–‡ä»¶ä¸­å¯¼å…¥ç›¸åº”çš„ä¾èµ–å³å¯ã€‚

    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-configuration-processor</artifactId>
        <optional>true</optional>
    </dependency>
    

> ğŸ‘‰ ä»¥ä¸Šå°±æ˜¯æ–‡ç« çš„å…¨éƒ¨å†…å®¹å•¦ï¼Œè¯¸ä½¬å¦‚æœæœ‰ä»»ä½•å»ºè®®éƒ½å¯ä»¥æå“¦ã€‚  
> ğŸ‘‰ åˆ›ä½œä¸æ˜“ï¼Œå¦‚æœè§‰å¾—å¯¹æ‚¨æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿å…³æ³¨âœ¨ç‚¹èµğŸ‘æ”¶è—ğŸ“‚å“¦ã€‚