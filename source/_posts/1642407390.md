---
layout: post
title: "Pythonä¸­å†…ç½®æ•°æ®åº“ï¼SQLiteä½¿ç”¨æŒ‡å—ï¼ â›µ"
date: "2022-12-03T08:20:01.015Z"
---
Pythonä¸­å†…ç½®æ•°æ®åº“ï¼SQLiteä½¿ç”¨æŒ‡å—ï¼ â›µ
==========================

![Pythonä¸­å†…ç½®æ•°æ®åº“ï¼SQLiteä½¿ç”¨æŒ‡å—ï¼ â›µ](https://img2023.cnblogs.com/blog/2637458/202211/2637458-20221129110133007-1368566657.png) ä½¿ç”¨Pythonå†…ç½®åº“SQLiteï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®Œæˆå»ºè¡¨ã€æ’å…¥æ•°æ®ã€æŸ¥è¯¢æ•°æ®ç­‰æ•°æ®åº“æ“ä½œï¼Œä¹Ÿå¯ä»¥é…åˆpandasè¿›è¡Œçµæ´»ä½¿ç”¨ï¼é«˜æ•ˆå·¥å…·åº“getï¼

![](https://img-blog.csdnimg.cn/img_convert/acf36f9e82347ca06ed1aa321ba096f5.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [Python3â—‰æŠ€èƒ½æå‡ç³»åˆ—](https://www.showmeai.tech/tutorials/56)ï¼š[https://www.showmeai.tech/tutorials/56](https://www.showmeai.tech/tutorials/56)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/390)ï¼š[https://www.showmeai.tech/article-detail/390](https://www.showmeai.tech/article-detail/390)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

![](https://img-blog.csdnimg.cn/img_convert/fa1a5346487dcaba741e8a828cb12106.png)

Python æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨å„ä¸ªé¢†åŸŸéƒ½èƒ½å‘æŒ¥å¾ˆå¤§çš„ä½œç”¨ï¼Œè€Œä¸”å®‰è£… Python ç¯å¢ƒçš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå®‰è£…äº†å¾ˆå¤šå…¶ä»–å‡ºè‰²çš„å·¥å…·ï¼Œå…¶ä¸­å½“ç„¶å°‘ä¸äº†æ•°æ®åº“ã€‚

Python å†…ç½®äº† SQLite3ï¼Œåœ¨ Python ä¸­ä½¿ç”¨ SQLiteï¼Œä¸éœ€è¦å®‰è£…ä»»ä½•ä¸œè¥¿ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚æˆ‘ä»¬åªéœ€è¦å¯¼å…¥å†…ç½® Python åº“`sqlite3`å°±å¯ä»¥å¼€å§‹ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“å•¦ï¼

åœ¨æœ¬ç¯‡å†…å®¹ä¸­ï¼Œ[ShowMeAI](https://www.showmeai.tech/)å°†å¸¦å¤§å®¶ä¸€èµ·æ¥äº†è§£ï¼Œå¦‚ä½•åŸºäº Python ç¯å¢ƒè¿æ¥åˆ°æ•°æ®åº“ã€åˆ›å»ºè¡¨ã€æ’å…¥æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®ï¼Œä»¥åŠä¸ Pandas å·¥å…·åº“æ­é…ä½¿ç”¨ã€‚

![](https://img-blog.csdnimg.cn/img_convert/2e11bb1278937d43cf862823e853023a.png)

> å¯¹äº SQL æ›´è¯¦å°½çš„å†…å®¹ï¼Œæ¬¢è¿å¤§å®¶æŸ¥é˜…[ShowMeAI](https://www.showmeai.tech/)åˆ¶ä½œçš„é€ŸæŸ¥è¡¨ï¼š
> 
> ğŸ“˜ [**ç¼–ç¨‹è¯­è¨€é€ŸæŸ¥è¡¨ | SQL é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/99)

ğŸ’¡ è¿æ¥æ•°æ®åº“
========

è¦ä½¿ç”¨æ•°æ®åº“ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¿æ¥æ•°æ®åº“ã€‚åœ¨ Python ä¸­å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€å¯¼å…¥`sqlite3`å·¥å…·åº“å¹¶ä½¿ç”¨`.connect`å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°æ˜¯æ•°æ®åº“åç§°ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º`students.db`ã€‚

    # å¯¼å…¥å·¥å…·åº“
    import sqlite3
    # å»ºç«‹è¿æ¥
    conn = sqlite3.connect('students.db')
    

æˆ‘ä»¬ç¬¬1æ¬¡è¿è¡Œä¸Šé¢ä»£ç çš„è¯ï¼Œä¼šåœ¨å·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºâ€œstudents.dbâ€çš„æ–°æ–‡ä»¶ã€‚

![](https://img-blog.csdnimg.cn/img_convert/3450b51bb9ec7ce181fb0be8c682f2d8.png)

ğŸ’¡ åˆ›å»ºè¡¨
======

æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åœ¨è¿æ¥çš„æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œå¹¶å°†æ•°æ®æ’å…¥å…¶ä¸­ã€‚

åœ¨åˆ›å»ºè¡¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡ cursorï¼ˆç”¨äºå»ºç«‹è¿æ¥ä»¥æ‰§è¡Œ SQL æŸ¥è¯¢çš„å¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åˆ›å»ºè¡¨ã€æ’å…¥æ•°æ®ç­‰ã€‚å…·ä½“çš„æ“ä½œå¦‚ä¸‹ä»£ç ï¼š

    c = conn.cursor()
    

å®Œæˆæ¸¸æ ‡åˆ›å»ºåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `.execute`æ–¹æ³•æ‰§è¡ŒSQLè¯­å¥ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡¨ã€‚åœ¨å¼•å·å†…ï¼Œæˆ‘ä»¬ç¼–å†™äº†å»ºè¡¨ SQL è¯­å¥ï¼Œä½¿ç”¨`CREATE TABLE`è¯­å¥ï¼š

    c.execute("""CREATE TABLE students (
    name TEXT,
    age INTEGER,
    height REAL
    )""")
    

æˆ‘ä»¬åœ¨åˆ›å»ºè¡¨çš„å­—æ®µæ—¶ï¼Œéœ€è¦å®šä¹‰æ•°æ®ç±»å‹ã€‚SQLite åªæœ‰ 5 ç§æ•°æ®ç±»å‹ï¼š

*   `Null`ï¼šç¼ºå¤±å€¼
*   `INTEGER`ï¼šæ²¡æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼ˆä¾‹å¦‚ï¼Œ1ã€2ã€3ã€4ï¼‰
*   `REAL`ï¼šå¸¦å°æ•°ç‚¹çš„æ•°å­—ï¼ˆä¾‹å¦‚ï¼Œ6.2ã€7.6ã€11.2ï¼‰
*   `TEXT`ï¼šä»»ä½•å­—ç¬¦æ•°æ®
*   `Blob`ï¼šäºŒè¿›åˆ¶æ•°æ®çš„é›†åˆï¼Œä½œä¸ºå€¼å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­å­˜å‚¨æ–‡æ¡£ã€å›¾åƒå’Œå…¶ä»–å¤šåª’ä½“æ–‡ä»¶ã€‚

æˆ‘ä»¬è¦æäº¤ä¸Šè¿°è¯­å¥ï¼Œå¹¶å…³é—­è¿æ¥ã€‚æˆªæ­¢ç›®å‰çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

    # å¯¼å…¥å·¥å…·åº“
    import sqlite3
    
    # åˆ›å»ºè¿æ¥
    conn = sqlite3.connect('students.db')
    
    # æ¸¸æ ‡
    c = conn.cursor()  
    
    # å»ºè¡¨è¯­å¥
    c.execute("""CREATE TABLE students (
                name TEXT,
                age INTEGER,
                height REAL
        )""")
    
    # æ‰§è¡Œ
    conn.commit()
    
    # å…³é—­è¿æ¥
    conn.close()
    

ğŸ’¡ æ’å…¥æ•°æ®
=======

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`.execute`æ‰§è¡Œ`INSERT INTO`è¯­å¥åœ¨â€œstudentsâ€è¡¨ä¸­æ’å…¥ä¸€è¡Œæ•°æ®ã€‚ä¸‹é¢æ˜¯æ·»åŠ ä¸€ä¸ª20 å²ï¼Œèº«é«˜ 1.9 ç±³çš„å­¦ç”Ÿ`mark`çš„ä»£ç ï¼š

    c.execute("INSERT INTO students VALUES ('mark', 20, 1.9)")
    

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸€æ¬¡æ’å…¥å¤šè¡Œï¼Œæ¢æˆ`.executemany`æ–¹æ³•å³å¯ã€‚ä¸è¿‡æ³¨æ„ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨`INSERT`è¯­å¥ä¸­ä¼šä½¿ç”¨`?`ä½œä¸ºå ä½ç¬¦ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

    all_students = [
    ('john', 21, 1.8),
    ('david', 35, 1.7),
    ('michael', 19, 1.83),
    ]
    c.executemany("INSERT INTO students VALUES (?, ?, ?)", all_students)
    

ğŸ’¡ æŸ¥è¯¢æ•°æ®
=======

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`SELECT`è¯­å¥æŸ¥çœ‹æˆ‘ä»¬çš„æ•°æ®ï¼Œæ³¨æ„ä¸€ä¸‹å¦‚æœè¦è·å–æ•°æ®å¹¶è¾“å‡ºï¼Œéœ€è¦æ‰§è¡Œ`.fetchall`æ–¹æ³•ï¼š

    c.execute("SELECT * FROM students")
    print(c.fetchall())
    

æ‰“å°çš„è¾“å‡ºå¦‚ä¸‹ï¼š

    [(â€˜markâ€™, 20, 1.9), (â€˜johnâ€™, 21, 1.8), (â€˜davidâ€™, 35, 1.7), (â€˜michaelâ€™, 19, 1.83)]
    

å½“ç„¶ï¼Œå¤§å®¶å…¶å®å¯ä»¥é…åˆä¸€äº›åœ¨çº¿å·¥å…·æ¥å®Œæˆæ•°æ®çš„ç›´è§‚æŸ¥è¯¢ï¼Œä¾‹å¦‚ ğŸ“˜[**SQLiteViewer**](https://inloop.github.io/sqlite-viewer/)ã€‚æˆ‘ä»¬åªéœ€æ‹–åŠ¨å‰é¢ Python ä»£ç ç”Ÿæˆçš„ `.db` æ•°æ®åº“æ–‡ä»¶è¿›å»ï¼Œå³å¯æŸ¥çœ‹å…¶å†…å®¹ã€‚

![](https://img-blog.csdnimg.cn/img_convert/78fcdc26f9279aa577701eb90cd68c1e.png)

æˆªæ­¢ç›®å‰ä¸ºæ­¢çš„æ‰€æœ‰ä»£ç å¦‚ä¸‹

    # å¯¼å…¥å·¥å…·åº“
    import sqlite3
    
    # åˆ›å»ºè¿æ¥
    conn = sqlite3.connect('students.db')
    
    # æ¸¸æ ‡
    c = conn.cursor()  
    
    # å»ºè¡¨è¯­å¥
    c.execute("""CREATE TABLE students (
                name TEXT,
                age INTEGER,
                height REAL
        )""")
    
    # æ’å…¥å•æ¡æ•°æ®
    c.execute("INSERT INTO students VALUES ('mark', 20, 1.9)")
    
    
    # æ’å…¥å¤šæ¡æ•°æ®
    all_students = [
        ('john', 21, 1.8),
        ('david', 35, 1.7),
        ('michael', 19, 1.83),
    ]
    c.executemany("INSERT INTO students VALUES (?, ?, ?)", all_students)
    
    # æŸ¥è¯¢æ•°æ®
    c.execute("SELECT * FROM students")
    print(c.fetchall())
    
    # æ‰§è¡Œ
    conn.commit()
    
    # å…³é—­è¿æ¥
    conn.close()
    

å…¶å®å¤§å®¶åœ¨SQLä¸­çš„æ›´é«˜çº§çš„å¤æ‚æŸ¥è¯¢ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸Šè¿°æ–¹å¼è¿›è¡ŒæŸ¥è¯¢å’Œäº¤äº’

ğŸ’¡ SQLite é…åˆ Pandas åº”ç”¨
======================

SQLite å¯ä»¥ä¸ Pandas ä¸­çš„Dataframeæ­é…ä½¿ç”¨ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸ºğŸ†`population_total.csv`çš„ csv æ–‡ä»¶ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡ [ShowMeAI](https://www.showmeai.tech/) çš„ç™¾åº¦ç½‘ç›˜åœ°å€ä¸‹è½½ã€‚

> ğŸ† **å®æˆ˜æ•°æ®é›†ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰**ï¼šå…¬âœ¦ä¼—âœ¦å·ã€ShowMeAIç ”ç©¶ä¸­å¿ƒã€å›å¤ã€**å®æˆ˜**ã€ï¼Œæˆ–è€…ç‚¹å‡» [**è¿™é‡Œ**](https://www.showmeai.tech/article-detail/305) è·å–æœ¬æ–‡ [\[61\]Pythonå†…ç½®æ•°æ®åº“SQLiteä½¿ç”¨æŒ‡å—](https://www.showmeai.tech/article-detail/390) ã€**SQLiteç¤ºä¾‹æ•°æ®é›†**ã€

> â­ **ShowMeAIå®˜æ–¹GitHub**ï¼š[https://github.com/ShowMeAI-Hub](https://github.com/ShowMeAI-Hub)

æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ Pandas è¯»å–å®ƒï¼š

    import pandas as pd
    df = pd.read_csv("population_total.csv")
    

Dataframe å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š

    >>> df             country year    population0             China  2020.0  1.439324e+09
    1             China  2019.0  1.433784e+09
    2             China  2018.0  1.427648e+09
    3             China  2017.0  1.421022e+09
    4             China  2016.0  1.414049e+09
    ...             ...     ...           ...
    4180  United States  1965.0  1.997337e+08
    4181  United States  1960.0  1.867206e+08
    4182  United States  1955.0  1.716853e+08
    4183          India  1960.0  4.505477e+08
    4184          India  1955.0  4.098806e+08
    

æˆ‘ä»¬å¯ä»¥æŠŠ pandas Dataframe å½¢æ€çš„æ•°æ®ä¸€æ¬¡æ€§å¯¼å…¥ SQLite æ•°æ®åº“ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å€ŸåŠ© sqlalchemy å·¥å…·åº“ï¼ˆå¯ä»¥é€šè¿‡`pip install sqlalchemy`è½»æ¾å®‰è£…ï¼‰

    from sqlalchemy import create_engine
    engine = create_engine('sqlite://', echo=False)
    

ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥è½»æ¾æŠŠæ•°æ®å¯¼å…¥æ•°æ®åº“å¹¶åˆ›å»º population è¡¨ï¼š

    df.to_sql("population", con=engine)
    

æŸ¥è¯¢æ•°æ®è¡¨çš„è¯­å¥å¦‚ä¸‹ï¼š

    engine.execute("SELECT * FROM population").fetchall()
    

å¦‚æœä½ æƒ³åˆ›å»ºè¡¨çš„åŒæ—¶ç”Ÿæˆä¸€ä¸ª sqlite æ–‡ä»¶ï¼ˆå‰é¢çš„æ“ä½œï¼Œç”Ÿæˆçš„æ˜¯å†…å­˜æ•°æ®åº“ï¼‰ï¼Œå¯ä»¥å¦‚ä¸‹æ–¹å¼æ“ä½œã€‚ï¼ˆæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª`mydb.db`æ–‡ä»¶ä½œä¸ºæ•°æ®åº“çš„å®ä½“æ–‡ä»¶ï¼‰ã€‚

    from sqlalchemy import create_engine
    engine = create_engine("sqlite:///mydb.db")
    df.to_sql("population", engine)
    

è¿™ä¸ª`mydb.db`å°±å’Œå‰é¢çš„ä½¿ç”¨æ–¹å¼ä¸€æ ·å•¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ SQLite æŸ¥çœ‹å™¨æŸ¥çœ‹æ•°æ®å†…å®¹ã€‚

![](https://img-blog.csdnimg.cn/img_convert/23ad72be85ccb8adba575ac90d7b8a04.png)

ğŸ’¡ æ€»ç»“
=====

ä»¥ä¸Šå°±æ˜¯[ShowMeAI](https://www.showmeai.tech/)å¸¦å¤§å®¶ç®€å•äº†è§£pythonçš„å†…ç½®æ•°æ®åº“SQLiteçš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®Œæˆå»ºè¡¨ã€æ’å…¥æ•°æ®ã€æŸ¥è¯¢æ•°æ®ï¼Œä¹Ÿå¯ä»¥é…åˆpandasè¿›è¡Œçµæ´»ä½¿ç”¨ï¼Œå¤§å®¶å¿«å¿«ç”¨èµ·æ¥å§ï¼

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ [**ç¼–ç¨‹è¯­è¨€é€ŸæŸ¥è¡¨ | SQL é€ŸæŸ¥è¡¨**](https://www.showmeai.tech/article-detail/99)ï¼š[https://www.showmeai.tech/article-detail/99](https://www.showmeai.tech/article-detail/99)
*   ğŸ“˜[**SQLiteViewer**](https://inloop.github.io/sqlite-viewer/)ï¼š[https://inloop.github.io/sqlite-viewer/](https://inloop.github.io/sqlite-viewer/)

æ¨èé˜…è¯»
====

*   ğŸŒ [**æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/40) ï¼š[https://www.showmeai.tech/tutorials/40](https://www.showmeai.tech/tutorials/40)
*   ğŸŒ [**æœºå™¨å­¦ä¹ æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/41)ï¼š[https://www.showmeai.tech/tutorials/41](https://www.showmeai.tech/tutorials/41)
*   ğŸŒ [**æ·±åº¦å­¦ä¹ æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/42)ï¼š[https://www.showmeai.tech/tutorials/42](https://www.showmeai.tech/tutorials/42)
*   ğŸŒ [**TensorFlowæ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/43)ï¼š[https://www.showmeai.tech/tutorials/43](https://www.showmeai.tech/tutorials/43)
*   ğŸŒ [**PyTorchæ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/44)ï¼š[https://www.showmeai.tech/tutorials/44](https://www.showmeai.tech/tutorials/44)
*   ğŸŒ [**NLPå®æˆ˜æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/45)ï¼š[https://www.showmeai.tech/tutorials/45](https://www.showmeai.tech/tutorials/45)
*   ğŸŒ [**CVå®æˆ˜æ•°æ®åˆ†æå®æˆ˜ç³»åˆ—**](https://www.showmeai.tech/tutorials/46)ï¼š[https://www.showmeai.tech/tutorials/46](https://www.showmeai.tech/tutorials/46)
*   ğŸŒ [**AI é¢è¯•é¢˜åº“ç³»åˆ—**](https://www.showmeai.tech/tutorials/48)ï¼š[https://www.showmeai.tech/tutorials/48](https://www.showmeai.tech/tutorials/48)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)