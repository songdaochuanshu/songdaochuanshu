---
layout: post
title: "å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆä¸€ï¼‰ï¼šæ­å»ºé¡¹ç›®"
date: "2022-05-25T18:23:47.393Z"
---
å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆä¸€ï¼‰ï¼šæ­å»ºé¡¹ç›®
==========================

â€‹

Â å‰è¨€
---

å»å¹´12æœˆä»½åšäº†MAUIæ··åˆå¼€å‘æ¡†æ¶çš„è°ƒç ”ï¼Œæƒ³èµ·æ¥æ–‡ç« é‡Œç»™è‡ªå·±æŒ–äº†ä¸ªå‘ï¼Œè¦æ•™å¤§å®¶å¦‚ä½•æŠŠAbpç§»æ¤è¿›Mauié¡¹ç›®ï¼Œç”±äºç¯‡å¹…é™åˆ¶ï¼Œå°†åˆ†ä¸ºä¸‰ä¸ªç« èŠ‚ã€‚

[å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆä¸€ï¼‰ï¼šæ­å»ºé¡¹ç›® - æ—æ™“lx - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jevonsflash/p/16310387.html)

[å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆäºŒï¼‰ï¼šé…ç½®ä¸åŸºç±»ç¼–å†™ - æ—æ™“lx - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jevonsflash/p/16310391.html)

[å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆä¸‰ï¼‰ï¼šæ„å»ºUIå±‚ - æ—æ™“lx - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jevonsflash/p/16310399.html)

ç†Ÿæ‚‰Abpçš„åŒå­¦éƒ½çŸ¥é“ï¼ŒAbp æ˜¯ä¸€å¥—å¼ºå¤§çš„åº”ç”¨ç¨‹åºè®¾è®¡æ—¶æ¡†æ¶ï¼ˆä¿—ç§°è„šæ‰‹æ¶ï¼‰ï¼Œæ–°ç‰ˆæœ¬çš„Abp vNextä¸ºå¾®æœåŠ¡å’Œç½‘ç»œä¼˜åŒ–çš„æ›´å¤šï¼Œç„¶è€Œæœ¬åœ°å¼€å‘ç»å…¸Abpå·²ç»å¤Ÿç”¨ï¼Œè€Œä¸”å®˜æ–¹æ²¡æœ‰åœæ­¢ç»´æŠ¤ï¼Œå› æ­¤ä½¿ç”¨è¿™ä¸ªæ¡†æ¶

MAUIåˆ™æ˜¯è·¨å¹³å°çš„åº”ç”¨ç¨‹åºæŠ½è±¡å±‚ï¼Œå¼ºå¤§çš„è¿è¡Œæ—¶æ¡†æ¶ + å¼ºå¤§çš„è®¾è®¡æ—¶æ¡†æ¶ ï¼Œ æˆ‘è¯´è¿™æ˜¯å®‡å®™æœ€å¼ºå¤§è·¨å¹³å°å¼€å‘æ¡†æ¶ï¼Œä¸ä¸ºè¿‡å§ï¼ŸğŸ˜

è®¡åˆ’ï¼š

*   æ•´ä¸ªç¨‹åºæˆ‘ä»¬è¿˜æ˜¯åˆ©ç”¨Mvvmè®¾è®¡æ¨¡å¼ï¼Œä½†æ˜¯å°†åˆ©ç”¨Abpçš„Iocå®¹å™¨ï¼Œè€Œä¸ä½¿ç”¨mvvmlightæˆ–è€…xamarinToolkitè¿™äº›åº“ï¼Œè‡ªè¡Œç¼–å†™ä¸€ä¸ªViewModelBase
*   ä½¿ç”¨Abp.EntityFrameworkCoreåº“ä¸­çš„EFç›¸å…³åŠŸèƒ½ï¼Œä½¿ç”¨sqliteä½œä¸ºæ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆã€‚

ç›®æ ‡ï¼šç¼–å†™ä¸€ä¸ªæ­Œå•Appï¼Œå¯¹æ­Œæ›²ä¿¡æ¯è¿›è¡Œå¢ã€åˆ ã€æŸ¥ã€æ”¹ã€‚

ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•æ­å»º

æ­å»ºMAUIé¡¹ç›®
--------

è¯·æ³¨æ„ï¼šæœ¬æ–‡å‘å¸ƒæ—¶ï¼ŒMAUIå¤„äºRC3ç‰ˆæœ¬ï¼Œä»æ²¡æœ‰æ­£å¼å‘å¸ƒï¼Œéœ€è¦å®‰è£…Visual Studio 2022 17.3 (Preview)

é¦–å…ˆæŒ‰ç…§å®˜æ–¹æ•™ç¨‹æ­å»ºä¸€ä¸ªMAUIé¡¹ç›®ï¼Œ å‘½åä¸ºMauiBoilerplate[Build your first .NET MAUI app - .NET MAUI | Microsoft Docs](https://docs.microsoft.com/en-us/dotnet/maui/get-started/first-app "Build your first .NET MAUI app - .NET MAUI | Microsoft Docs")

å†å‰å¾€Abpå®˜ç½‘ç”Ÿæˆä¸€ä¸ªé¡¹ç›®Â   
[Startup Templates - Create a Demo | AspNet Boilerplate](https://aspnetboilerplate.com/Templates "Startup Templates - Create a Demo | AspNet Boilerplate")

*   é€‰æ‹©æœ€æ–°ç‰ˆæœ¬ v7.x å’Œ.Net 6ç‰ˆæœ¬
*   å–æ¶ˆå‹¾é€‰â€œInclude login, register, user, role and tenant management pagesâ€
*   é¡¹ç›®åç§°ä¸­å¡«å…¥MauiBoilerplateä¸Mauié¡¹ç›®ä¿æŒä¸€è‡´

![](https://img-blog.csdnimg.cn/b3370549e7ea4bd3b1869536b1b45490.png)![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")â€‹ç¼–è¾‘

ç‚¹å‡»â€œCreate My Projectâ€ç”Ÿæˆabpé¡¹ç›®æ–‡ä»¶ï¼Œç­‰å¾…ä¸‹è½½å®Œæˆ

ä¸‹è½½ï¼Œè§£å‹å¥½åï¼Œæ‰“å¼€srcç›®å½•å¯ä»¥å‘ç°4ä¸ªé¡¹ç›®ç›®å½•ï¼Œæˆ‘ä»¬ä»…éœ€è¦Coreå’ŒEntityFrameworkCoreé¡¹ç›®ï¼Œå°†è¿™ä¸¤ä¸ªç›®å½•ç§»è‡³é¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶ä¸”æ·»åŠ è‡³è§£å†³æ–¹æ¡ˆã€‚

![](https://img-blog.csdnimg.cn/4fe495b14ccb4e3ea95084a7ed900a26.png)![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")â€‹ç¼–è¾‘

é…ç½®åº”ç”¨å…¥å£ç‚¹
-------

åœ¨MauiBoilerplate.Coreé¡¹ç›®ä¸­

æ”¹å†™é»˜è®¤é…ç½®æ–‡ä»¶

    {
      "ConnectionStrings": {
        "Default": "Data Source=file:{0};"
      },
      "Logging": {
        "IncludeScopes": false,
        "LogLevel": {
          "Default": "Debug",
          "System": "Information",
          "Microsoft": "Information"
        }
      }
    }
    

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

åœ¨MauiBoilerplate.Core.csprojä¸­çš„ItemGroupèŠ‚ç‚¹ä¸‹æ·»åŠ 

    	  <EmbeddedResource Include="appsettings.json">
    	    <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    	  </EmbeddedResource>

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

åœ¨MauiBoilerplate.Coreé¡¹ç›®ä¸­æ–°å»ºMauiBoilerplateBuilderExtensions.cs ä½œä¸ºç¨‹åºå…¥å£

æ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³•InitConfigï¼Œç”¨äºè¯»å–é¡¹ç›®çš„é…ç½®æ–‡ä»¶appsettings.jsonï¼Œè‹¥ç¬¬ä¸€æ¬¡è¿è¡Œæˆ–è€…è¯¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™è¯»å–é»˜è®¤çš„é…ç½®æ–‡ä»¶

            private static void InitConfig(string logCfgName, string documentsPath)
            {
    
                var assembly = IntrospectionExtensions.GetTypeInfo(typeof(MauiBoilerplateBuilderExtensions)).Assembly;
    
                Stream stream = assembly.GetManifestResourceStream($"MauiBoilerplate.Core.{logCfgName}");
                string text = "";
                using (var reader = new System.IO.StreamReader(stream))
                {
                    text = reader.ReadToEnd();
                }
                if (DirFileHelper.IsExistFile(documentsPath))
                {
                    var currentFileContent = DirFileHelper.ReadFile(documentsPath);
                    var isSameContent = currentFileContent.ToMd5() == text.ToMd5();
                    if (isSameContent)
                    {
                        return;
                    }
                    DirFileHelper.CreateFile(documentsPath, text);
    
                }
                else
                {
                    DirFileHelper.CreateFile(documentsPath, text);
    
                }
            }
    

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

æ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³•InitDataBaseç”¨äºåˆå§‹åŒ–sqliteæ•°æ®åº“æ–‡ä»¶"mato.db"

        private static void InitDataBase(string dbName, string documentsPath)
        {
                var assembly = IntrospectionExtensions.GetTypeInfo(typeof(MauiBoilerplateBuilderExtensions)).Assembly;
                Stream stream = assembly.GetManifestResourceStream($"MauiBoilerplate.Core.{dbName}");
                StreamHelper.WriteStream(stream, documentsPath);
    
                var path = Path.GetDirectoryName(documentsPath);
                DirFileHelper.CreateDir(path);
        }

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

æ·»åŠ ä¸€ä¸ª é™æ€æ–¹æ³•UseMauiBoilerplateç”¨äºåˆå§‹åŒ–é…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–dbæ–‡ä»¶å’Œå‘ç®¡é“æœåŠ¡ä¸­æ³¨å†ŒAbpBootstrapperå®ä¾‹ã€‚

            public static MauiAppBuilder UseMauiBoilerplate<TStartupModule>(this MauiAppBuilder builder) where TStartupModule : AbpModule
            {
                var logCfgName = "log4net.config";
                var appCfgName = "appsettings.json";
                var dbName = "mato.db";
    
                string documentsPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), MauiBoilerplateConsts.LocalizationSourceName, logCfgName);
                string documentsPath2 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), MauiBoilerplateConsts.LocalizationSourceName, appCfgName);
                string dbPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), MauiBoilerplateConsts.LocalizationSourceName, dbName);
    
                InitConfig(logCfgName, documentsPath);
                InitConfig(appCfgName, documentsPath2);
                InitDataBase(dbName, dbPath);
                var _bootstrapper = AbpBootstrapper.Create<TStartupModule>(options =>
                {
                    options.IocManager = new IocManager();
                });
                _bootstrapper.IocManager.IocContainer.AddFacility<LoggingFacility>(f => f.UseAbpLog4Net().WithConfig(documentsPath));
    
                builder.Services.AddSingleton(_bootstrapper);
                WindsorRegistrationHelper.CreateServiceProvider(_bootstrapper.IocManager.IocContainer, builder.Services);
    
                return builder;
            }
    

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

åœ¨MauiBoilerplateé¡¹ç›®ä¸­

æ–°å»ºMauiBoilerplateModule.cs ï¼Œå¹¶ç¼–å†™ä»£ç å¦‚ä¸‹ï¼Œè¿™æ˜¯Appèµ·å§‹æ¨¡å—

    [DependsOn(typeof(MauiBoilerplateEntityFrameworkCoreModule))]
        public class MauiBoilerplateModule : AbpModule
        {
            public override void Initialize()
            {
                IocManager.RegisterAssemblyByConvention(typeof(MauiBoilerplateModule).GetAssembly());
            }
    
        }

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

æ‰“å¼€MauiProgram.csæ–‡ä»¶ï¼Œå°†UseMauiBoilerplateæ·»åŠ åˆ°MauiAppBuilder

è¿™é‡Œæä¸€ä¸‹,Â MAUI åº”ç”¨è·Ÿå…¶ä»–.Net6åº”ç”¨ä¸€æ ·é‡‡ç”¨æ³›å‹ä¸»æœºå¯åŠ¨åº”ç”¨ï¼Œåœ¨é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªé™æ€`MauiProgram`ç±»ï¼Œè¿™æ˜¯åº”ç”¨çš„å…¥å£ç‚¹ã€‚ è¿™æä¾›äº†ä»å•ä¸ªä½ç½®é…ç½®åº”ç”¨ã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„åŠŸèƒ½ã€‚

æ›´å¤šæ³›å‹ä¸»æœºçš„ä¿¡æ¯ï¼Œè¯·å‚é˜…å¾®è½¯æ–‡æ¡£[.NET é€šç”¨ä¸»æœº | Microsoft Docs](https://docs.microsoft.com/zh-CN/dotnet/core/extensions/generic-host ".NET é€šç”¨ä¸»æœº | Microsoft Docs")

![](https://img-blog.csdnimg.cn/44c5e71f7aee4139b7b610296f05eb8e.png)![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")â€‹ç¼–è¾‘

Â è‡³æ­¤ï¼Œåœ¨ä¸»æœºç®¡é“ä¸­å·²ç»é…ç½®äº†MauiBoilerplateæœåŠ¡

é…ç½®Abp
-----

App.xamlæ˜¯åº”ç”¨çš„å£°æ˜èµ·å§‹ç‚¹ï¼Œå°†ä»è¿™é‡Œåˆå§‹åŒ–Abp

æ‰“å¼€App.xaml.csï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

    public partial class App : Application
        {
            private readonly AbpBootstrapper _abpBootstrapper;
    
            public App(AbpBootstrapper abpBootstrapper)
            {
                _abpBootstrapper = abpBootstrapper;
                InitializeComponent();
                _abpBootstrapper.Initialize();
                this.MainPage = abpBootstrapper.IocManager.Resolve(typeof(MainPage)) as MainPage;
            }
        }

![](https://img2022.cnblogs.com/blog/644861/202205/644861-20220525184242097-1492628253.gif "ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨")

æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰åˆ›å»ºåˆå§‹é¡µé¢MainPageï¼Œä½ å¯ä»¥å…ˆåˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå°†åœ¨ç¬¬ä¸‰ç« è®²UIå±‚æ—¶ä»‹ç»

è‡³æ­¤ï¼Œå°±å®Œæˆäº†MAUIé¡¹ç›®çš„æ­å»ºä¸Abpè„šæ‰‹æ¶çš„é›†æˆï¼Œç°åœ¨ä½ å¯ä»¥åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨Abpçš„IocManagerï¼ŒConfigurationManagerï¼Œå·¥ä½œå•å…ƒç‰¹æ€§ï¼Œæ¨¡ç»„åŒ–ç‰¹æ€§ï¼Œç­‰ç­‰ä»»ä½•çš„Abpæä¾›çš„åŠŸèƒ½äº†ã€‚

ä½†æ˜¯è·ç¦»ç›®æ ‡ï¼šåˆ¶ä½œä¸€ä¸ªå…·æœ‰æ•°æ®è®¿é—®å±‚çš„Appï¼Œè¿˜éœ€è¦ä¸¤æ®µè·¯è¦èµ°ï¼šé…ç½®æ•°æ®åº“ï¼Œä»¥åŠç¼–å†™ç•Œé¢ã€‚

è¯·çœ‹ä¸‹ä¸€ç« [å°†Abpç§»æ¤è¿›.NET MAUIé¡¹ç›®ï¼ˆäºŒï¼‰ï¼šé…ç½®ä¸åŸºç±»ç¼–å†™ - æ—æ™“lx - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jevonsflash/p/16310391.html)

Â é¡¹ç›®åœ°å€
-----

[jevonsflash/maui-abp-sample (github.com)](https://github.com/jevonsflash/maui-abp-sample "jevonsflash/maui-abp-sample (github.com)")

  

â€‹