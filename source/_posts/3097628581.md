---
layout: post
title: "Pythonå…¨æ ˆå·¥ç¨‹å¸ˆä¹‹ä»ç½‘é¡µæ­å»ºå…¥é—¨åˆ°Flaskå…¨æ ˆé¡¹ç›®å®æˆ˜(4) - Flaskæ¨¡æ¿è¯­æ³•ä¸ç»§æ‰¿"
date: "2022-12-06T13:27:36.594Z"
---
Pythonå…¨æ ˆå·¥ç¨‹å¸ˆä¹‹ä»ç½‘é¡µæ­å»ºå…¥é—¨åˆ°Flaskå…¨æ ˆé¡¹ç›®å®æˆ˜(4) - Flaskæ¨¡æ¿è¯­æ³•ä¸ç»§æ‰¿
=================================================

1.Flaskæ¨¡æ¿ä»‹ç»
-----------

**å‰ç½®ï¼š**ç†è§£æ¸²æŸ“æœºåˆ¶å³ä¸Šç¯‡ç¬”è®°ä¸­render\_template()åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼

1ï¼‰æ‰¾åˆ°htmlæ–‡ä»¶åœ°å€

2ï¼‰è¯»å–htmlæ–‡ä»¶ä¸­çš„å†…å®¹

3ï¼‰æ›¿æ¢htmlä¸­çš„ç‰¹æ®Šå­—ç¬¦

4ï¼‰å°†htmlçš„å†…å®¹å‘é€ç»™æµè§ˆå™¨

 1 <!-- htmlæ–‡ä»¶ \-->
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>Title</title\>
 8 </head\>
 9 <body\>
10     <nav\>
11 å¯¼èˆªæ¡
12     </nav\>
13     <h1 style\="color: #f00"\>ä½ å¥½, å½“å‰çš„æ—¶é—´æ˜¯ï¼š{{time}} {{user}}</h1\>
14 </body\>
15 </html\>

 1 # Flask pyæ–‡ä»¶
 2 
 3 import os 4 from datetime import datetime 5 
 6 from flask import Flask,render\_template 7 app = Flask(\_\_name\_\_)
 8 
 9 
10 @app.route('/')
11 def index():
12     return 'index'
13 
14 
15 @app.route('/html')
16 def html\_from\_file():
17     """ æŠŠhtmlæ–‡ä»¶çš„å†…å®¹åœ¨æµè§ˆå™¨å±•ç°å‡ºæ¥"""
18     return render\_template('index.html')
19 
20 
21 @app.route('/show/html')
22 def html\_show():
23     """ ç†è§£æ¸²æŸ“æœºåˆ¶ """
24     # 1. æ‰¾åˆ°ç£ç›˜ä¸Šçš„htmlæ–‡ä»¶åœ°å€ï¼ˆå…¨è·¯å¾„ï¼‰
25     file\_name = os.path.join(os.path.dirname(\_\_file\_\_), 'templates', 'index.html')
26     print(file\_name)
27     # 2. è¯»å–htmlæ–‡ä»¶ä¸­çš„å†…å®¹
28     now\_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
29     with open(file\_name, 'r', encoding='utf-8') as f:
30         html = f.read()
31         # 3. æ›¿æ¢htmlä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆ{{time}}ï¼‰
32         html = html.replace('{{time}}', now\_time)
33         # 4. å°†htmlçš„å†…å®¹å‘é€ç»™æµè§ˆå™¨
34         return html

**ä»€ä¹ˆæ˜¯æ¨¡æ¿ï¼Ÿ**

*   **æ¨¡æ¿**å…¶å®æ˜¯ä¸€ä¸ªåŒ…å«å“åº”æ–‡æœ¬çš„æ–‡ä»¶ï¼Œå…¶ä¸­ç”¨å ä½ç¬¦(å˜é‡)è¡¨ç¤ºåŠ¨æ€éƒ¨åˆ†ï¼Œå‘Šè¯‰æ¨¡æ¿å¼•æ“å…¶å…·ä½“çš„å€¼éœ€è¦ä»ä½¿ç”¨çš„æ•°æ®ä¸­è·å–
*   ä½¿ç”¨çœŸå®å€¼æ›¿æ¢å˜é‡ï¼Œå†è¿”å›æœ€ç»ˆå¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ¸²æŸ“

**ä¸ºä»€ä¹ˆå­¦æ¨¡æ¿ï¼Ÿ**åˆšåˆšçš„ç¤ºä¾‹ä»£ç ï¼Œå°†æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘ä»£ç éƒ½å†™åœ¨ä¸€ä¸ªpyæ–‡ä»¶é‡Œé¢ï¼Œå…¬å…±çš„ä¸šåŠ¡å˜æ›´éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç ï¼›æŒæ¡æ¨¡æ¿ä¹‹åï¼Œå°±å¯ä»¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚

2.å…¥é—¨Flaskæ¨¡æ¿
-----------

### 2.1.æ¨¡æ¿å¼•æ“Jinja2

**æ¨¡æ¿å¼•æ“ï¼š**å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œå®ƒå°±æ˜¯å¯¹æ¨¡æ¿ï¼ˆhtmlï¼‰ä¸­çš„å†…å®¹æŒ‰ç…§ä¸€å®šè§„åˆ™ï¼ˆå˜é‡ï¼‰è¿›è¡Œæ›¿æ¢ã€‚å¾—åˆ°æœ€ç»ˆæˆ‘ä»¬ç»™å®¢æˆ·ç«¯å±•ç¤ºçš„é¡µé¢ï¼ˆæ¨¡æ¿ï¼‰

*   Flaskä½¿ç”¨Jinja2ä½œä¸ºé»˜è®¤æ¨¡æ¿å¼•æ“ï¼Œå®‰è£…Flaskçš„æ—¶å€™å·²ç»è‡ªåŠ¨å®‰è£…äº†ï¼›ä¸éœ€è¦å†æ¬¡å®‰è£…Jinja2äº†
*   å¦‚æœä¸æ˜¯Flaskæ¡†æ¶ï¼Œæ˜¯å…¶ä»–æ¡†æ¶æƒ³è¦ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼Œä¹Ÿæ˜¯å¯ä»¥å®‰è£…çš„ã€‚é€šè¿‡pipè¿›è¡Œå®‰è£…ï¼špip install Jinja2ï¼›æˆ–è€…é€šè¿‡æºç å®‰è£…ï¼špython setup.py install(æŠŠæºç å…ˆä¸‹è½½ä¸‹æ¥ï¼Œè¿›å…¥setup.pyæ–‡ä»¶çš„ç›®å½•)

**Jinja2çš„é»˜è®¤é…ç½®**

*   template\_folder='templates'ï¼šè¿™ä¸ªæ˜¯æ¨¡æ¿å­˜æ”¾çš„é»˜è®¤ç›®å½•ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä½†æ˜¯ä¸å»ºè®®æ”¹ï¼Œå°±ç”¨å®ƒé»˜è®¤çš„å°±è¡Œäº†ï¼Œä¾¿äºé¡¹ç›®æˆå‘˜ç†è§£å…±è¯†

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221026165655278-1277891788.png)

*   render\_template()ï¼š(x)htmlè‡ªåŠ¨è½¬ä¹‰ï¼ŒæŠŠhtmlè¯»å–å‡ºæ¥ï¼Œä¹Ÿå¯ä»¥å¯¹å®ƒé‡Œé¢ä¸€äº›å˜é‡è¿›è¡Œæ›¿æ¢ï¼Œåœ¨**Jinja2é‡Œé¢è¿™äº›å˜é‡çš„æ ¼å¼ä¸ºåŒå¤§æ‹¬å·å¼€å¤´ï¼ŒåŒå¤§æ‹¬å·ç»“å°¾ï¼Œå¦‚ï¼š{{name}}**
*   render\_template\_string()ï¼šå­—ç¬¦ä¸²è‡ªåŠ¨è½¬ä¹‰ï¼Œhtmlæ˜¯ä»¥å­—ç¬¦ä¸²èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å°†htmlå“åº”ç»“æœå±•ç¤ºå‡ºæ¥ï¼›å¦‚æœè·Ÿrender\_templateä¸€æ ·ä¼ htmlæ–‡ä»¶åæ—¶ï¼Œrender\_template\_stringæ˜¯ä¸ä¼šè¯»å–é‡Œé¢æ–‡ä»¶çš„ï¼Œåªä¼šå°†è¿™ä¸ªæ–‡ä»¶åå±•ç¤ºå‡ºæ¥

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221026172731624-980697146.png)

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221026172457922-343811815.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221026172428802-1470104880.png)

*   {% autoescape %}ï¼šæ‰‹åŠ¨è®¾ç½®æ˜¯å¦è½¬ä¹‰  
    
*   å…¨å±€å‡½æ•°å’Œè¾…åŠ©å¯¹è±¡ï¼šå¢å¼ºæ¨¡æ¿çš„åŠŸèƒ½

**ä»€ä¹ˆæ˜¯è½¬ä¹‰ï¼Ÿ**

æŠŠæœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦æ˜¾ç¤ºå‡ºæ¥ï¼Œä¾‹å¦‚ï¼š

*   htmlæ ‡ç­¾ä¸­çš„<>ï¼š&lt;&gt;
*   ä»£ç ä¸­çš„&ï¼š&amp;
*   ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰å¯¹ç…§è¡¨ï¼›è¯¦ç»†çš„å¯ä»¥ç™¾åº¦é”®å…¥å…³é”®å­—â€œHTMLç‰¹æ®Šè½¬ä¹‰å­—ç¬¦å¯¹ç…§è¡¨â€è¿›è¡Œæœç´¢

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027100326854-1706113601.png)

**ç¤ºä¾‹ï¼š**

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027100431230-967076359.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027100453837-693766563.png)

### 2.2.æ¨¡æ¿å¸¸ç”¨å…¨å±€å¯¹è±¡

*   **configï¼š**Flaskçš„é…ç½®ä¿¡æ¯

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027101839181-494289462.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027101916344-1749970037.png)

*   **requestï¼š**è¯·æ±‚çš„å¯¹è±¡
*   **sessionï¼š**ä¼šè¯å¯¹è±¡
*   **gï¼š**è¯·æ±‚ç›¸å…³çš„å…¨å±€å˜é‡ï¼ˆå¦‚ï¼šg.userï¼‰

Â ![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027102549235-1812126241.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027102625326-1559336158.png)

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027102707309-1434770993.png)

### 2.3.æ¨¡æ¿å¸¸ç”¨å…¨å±€å‡½æ•°

*   **url\_for()ï¼š**URLè§£æå‡½æ•°ï¼ˆå¦‚ï¼šé™æ€æ–‡ä»¶åœ°å€è§£æã€é“¾æ¥è·³è½¬åœ°å€è§£æï¼‰ï¼›ä¼ å…¥è§†å›¾å‡½æ•°ï¼Œæ˜¾ç¤ºå…¶urlè·¯å¾„ï¼›

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027110450090-1573051503.png)

å¸¸ç”¨åœºæ™¯ï¼šhtmlå¸¸å¸¸ä¼šè¿›è¡Œhrefé¡µé¢è·³è½¬ï¼Œå¦‚æœç›´æ¥æŒ‡å®šè·¯ç”±(å³è·¯å¾„)ï¼Œå½“è§†å›¾å‡½æ•°è·¯ç”±å‘ç”Ÿå˜æ›´æ—¶ï¼Œå°±ä¼šæ‰¾ä¸åˆ°ã€‚å®é™…å¼€å‘ä¸­è·¯ç”±åœ°å€ä¼šå˜ï¼Œä½†æ˜¯è§†å›¾å‡½æ•°ä¸€èˆ¬ä¸ä¼šå˜ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨url\_forå¯¹è§†å›¾å‡½æ•°è¿›è¡Œåå‘è§£æè·å–å…¶è·¯ç”±ï¼Œè¿™æ ·htmlé¡µé¢å°±èƒ½æ­£å¸¸è·³è½¬äº†

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027112440494-2051300411.png)

ğŸ‘‡è¿™ä¹ˆå†™ï¼Œæ˜¯å¸¸ç”¨æ‰‹æ³•

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027113139833-123509996.png)

*   **get\_flashed\_messages()ï¼š**ä¼šè¯æ¶ˆæ¯ï¼›å¸¸è§åœºæ™¯é€€å‡ºç™»å½•ï¼Œæç¤ºä½ ä¸‹æ¬¡å†æ¥ï¼›å…·ä½“ä½¿ç”¨åé¢ç¬”è®°ä¼šæœ‰ï¼Œä¹Ÿå¯è‡ªè¡Œç™¾åº¦äº†è§£ä¸‹ï¼Œæ¯”å¦‚[https://www.cnblogs.com/cangqinglang/p/13656739.html](https://www.cnblogs.com/cangqinglang/p/13656739.html)

### 2.4.æ¨¡æ¿ä¸Šä¸‹æ–‡å¤„ç†å™¨

*   é€šè¿‡è£…é¥°å™¨@app.context\_processorå®ç°
*   åœ¨æ¨¡æ¿çš„ä¸Šä¸‹æ–‡ä¸­æ·»åŠ æ–°çš„å†…å®¹
*   å†…å®¹å¯ä»¥æ˜¯å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027140322024-1921051938.png)

### 2.5.æ¨¡æ¿ä¸­å˜é‡çš„ä½¿ç”¨

æ€è€ƒï¼šdict/list/tupleè¿™äº›ç±»å‹çš„æ•°æ®æ€ä¹ˆæ¸²æŸ“ï¼Ÿ(å¼€ç¯‡è®²è¿‡ï¼Œæ¸²æŸ“ï¼šä½¿ç”¨çœŸå®å€¼æ›¿æ¢å˜é‡ï¼Œå†è¿”å›æœ€ç»ˆå¾—åˆ°çš„å­—ç¬¦ä¸²å±•ç¤ºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ¸²æŸ“)

æ¨¡æ¿å½“ä¸­å˜é‡çš„è¯­æ³•ï¼š{{ value }}ï¼ŒåŒæ‹¬å·å¼€å¤´åŒå¤§æ‹¬å·ç»“å°¾ï¼›è¿™ä¸ªé»˜è®¤è§„åˆ™æˆ‘ä»¬åŒæ ·æ˜¯å¯ä»¥åœ¨æ¨¡æ¿å¼•æ“é…ç½®ä¸­æ”¹æˆ3ä¸ªå¤§æ‹¬å·.....éƒ½å¯ä»¥ï¼Œå»ºè®®ä¸è¦åŠ¨ï¼Œä½¿ç”¨ é»˜è®¤ç»Ÿä¸€è§„èŒƒ

*   ç®€å•æ•°æ®ç±»å‹çš„æ¸²æŸ“ï¼Œå¦‚å­—ç¬¦ä¸²ã€æ•´å‹ã€æµ®ç‚¹å‹ï¼š**{{ value }}**
*   dictç±»å‹æ•°æ®çš„æ¸²æŸ“ï¼š**{{ object.attribute }}æˆ–{{ object\['attribute'\] }}**
*   list/tupleç±»å‹æ•°æ®çš„æ¸²æŸ“ï¼š**{{ object\[index\] }}**
*   list/tupleåµŒå¥—dictå¤æ‚ç±»å‹æ•°æ®çš„æ¸²æŸ“ï¼š**è¯¦è§ç¤ºä¾‹ä»£ç **  
    

åœ¨ä½¿ç”¨render\_templateè¯»å–è§£æhtmlæ¨¡æ¿æ—¶ï¼Œå°†å˜é‡ä¼ é€’è¿›å»

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027144624437-711504271.png)

 1 **\# app.py**
 2 
 3 from flask import Flask, render\_template 4 
 5 app = Flask(\_\_name\_\_)
 6 
 7 @app.route('/index')
 8 def index1(): 9     return 'hello zhangsan'
10 
11 
12 @app.route('/')
13 def index():
14     # 1. ç®€å•æ•°æ®ç±»å‹çš„æ¸²æŸ“
15     age = 40
16     money = 65.89
17     name = 'å¼ ä¸‰'
18     # 2. ç”¨æˆ·ä¿¡æ¯ dict
19     user\_info = {
20         'username': 'å¼ ä¸‰',
21         'nickname': 'ä¸‰ä¸ª',
22         'address.city': 'å¹¿å·',
23         'address.area': 'å¤©æ²³'
24 }
25     # 3. å…ƒç»„å’Œåˆ—è¡¨
26     tuple\_city = ('åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³')
27     list\_city = ('åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³')
28 
29     # 4. å¤æ‚çš„æ•°æ®ç»“æ„
30     list\_user = \[
31 {
32             'username': 'å¼ ä¸‰',
33             'address': {
34                 'city': 'å¹¿å·'
35 }
36 },
37 {
38             'username': 'æå››',
39             'address': {
40                 'city': 'åŒ—äº¬'
41 }
42 }
43 \]
44     return render\_template('index.html',
45                            age=age,
46                            money=money,
47                            name=name,
48                            user\_info=user\_info,
49                            tuple\_city=tuple\_city,
50                            list\_city=list\_city,
51                            list\_user=list\_user)

 1 **<!-- index.html -->**
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>Title</title\>
 8 </head\>
 9 <body\>
10     <h3\>1\. ç®€å•æ•°æ®ç±»å‹çš„æ¸²æŸ“</h3\>
11     <p\>æˆ‘çš„å¹´é¾„: {{ age }}</p\>
12     <p\>æˆ‘çš„é’±åŒ…: {{ money }}</p\>
13     <p\>æˆ‘çš„åå­—ï¼š{{ name }}</p\>
14 
15     <h3\>2\. ç”¨æˆ·ä¿¡æ¯ dict</h3\>
16     <p\>ç”¨æˆ·åï¼š {{ user\_info.username }}</p\>
17     <p\>ç”¨æˆ·æ˜µç§°ï¼š {{ user\_info.nickname }}</p\>
18     <p\>ç”¨æˆ·çš„åœ°å€ï¼š{{ user\_info\['address.city'\] }}- {{ user\_info\['address.area'\] }}</p\>
19 
20     <h3\>3\. å…ƒç»„å’Œåˆ—è¡¨</h3\>
21     <p\>
22         {{ tuple\_city\[0\] }} <br/>
23         {{ tuple\_city\[1\] }} <br/>
24         {{ tuple\_city\[2\] }} <br/>
25         {{ tuple\_city\[3\] }} <br/>
26     </p\>
27     <p\>
28         {{ list\_city\[0\] }} <br/>
29         {{ list\_city\[1\] }} <br/>
30         {{ list\_city\[2\] }} <br/>
31         {{ list\_city\[3\] }} <br/>
32     </p\>
33 
34     <h3\>4\. å¤æ‚çš„æ•°æ®ç»“æ„</h3\>
35     <p\>
36         ç¬¬ä¸€ä¸ªï¼š<br/>
37 ç”¨æˆ·åï¼š{{ list\_user\[0\].username }};åœ°å€ï¼š {{ list\_user\[0\]\['address'\]\['city'\] }}
38     </p\>
39     <p\>
40         ç¬¬äºŒä¸ªï¼š<br/>
41 ç”¨æˆ·åï¼š{{ list\_user\[1\].username }};åœ°å€ï¼š {{ list\_user\[1\]\['address'\]\['city'\] }}
42     </p\>
43 </body\>
44 </html\>

**æ€è€ƒï¼šé•¿åº¦ä¸º100çš„listå¯¹è±¡å¦‚ä½•æ¸²æŸ“ï¼Ÿ**

3.Flaskæ¨¡æ¿è¯­æ³•
-----------

### 3.1.æ¨¡æ¿è¯­æ³•\_æ¨¡æ¿æ ‡ç­¾

åœ¨ã€æ¨¡æ¿ä¸­å˜é‡çš„ä½¿ç”¨ã€‘ç¬”è®°ä¸­ï¼Œå¯¹listå’Œtupleè¿™ä¸¤ç§pythonæ•°æ®ç±»å‹è¿›è¡Œæ¸²æŸ“çš„æ—¶å€™ã€‚å‘ç°é•¿åº¦éå¸¸é•¿çš„æ—¶å€™ï¼Œå»å–å®ƒçš„ä¸‹æ ‡æ¥è¿›è¡Œæ¸²æŸ“éå¸¸çš„ä¸æ–¹ä¾¿ã€‚æ¨¡æ¿æ ‡ç­¾å°±å¯ä»¥å¾ˆå¥½è§£å†³è¿™ä¸ªé—®é¢˜ï¼

ä»€ä¹ˆæ˜¯æ¨¡æ¿æ ‡ç­¾ï¼Ÿæˆ‘ä»¬èƒ½åœ¨æ¨¡æ¿ä¸­ï¼Œä¹Ÿå°±æ˜¯htmlä¸­å†™pythonçš„é€»è¾‘ä»£ç (æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ã€èµ‹å€¼)å—ï¼Ÿ

**æ¨¡æ¿æ ‡ç­¾è¯­æ³•ï¼š**

1)ï¼š{% tag %}

2)ï¼šç¬¬äºŒç§æ˜¯æœ‰tagå¼€å§‹å’Œç»“æŸï¼Œä¸€ä¸€å¯¹åº”çš„ï¼Œæ¯”å¦‚å†™pythoné€»è¾‘ä»£ç ifï¼Œåœ¨{% ifÂ  %}å¼€å§‹ï¼Œä½†æ˜¯å®ƒä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚æœ€åç”¨{% endif %}ç»“å°¾ï¼Œå®ƒå°±çŸ¥é“ç»“æŸäº†

{% tag %}
å†…å®¹
{% endtag %}

*   æ¨¡æ¿æ ‡ç­¾ç¤ºä¾‹æ¨¡æ¿ï¼šæ¡ä»¶è¡¨è¾¾å¼

<!-- æ¡ä»¶è¡¨è¾¾å¼ \-->

{% if condition\_a %}
    æ»¡è¶³äº†Aæ¡ä»¶
{% elif condition\_b %}
    æ»¡è¶³äº†Bæ¡ä»¶
{% else %}
    éƒ½ä¸æ»¡è¶³
{% endif %}

*   ifæ ‡ç­¾ä¸­çš„isåˆ¤æ–­ï¼Œä»¥åŠä¸€äº›å…¶ä»–çš„å†…ç½®åˆ¤æ–­æ¡ä»¶
    *   defined/undefinedï¼šå˜é‡æ˜¯å¦å·²ç»å®šä¹‰
    *   noneï¼šå˜é‡æ˜¯å¦ä¸ºNone
    *   number/stringï¼šæ•°å­—/å­—ç¬¦ä¸²åˆ¤æ–­
    *   even/oddï¼šå¥‡å¶åˆ¤æ–­
    *   upper/lowerï¼šå¤§å°å†™åˆ¤æ–­

{% if value is defined %}
.......
{% endif %}

*   if æ ‡ç­¾ä¸­é™¤äº†isè¿˜æœ‰å…¶ä»–é€»è¾‘æ§åˆ¶åˆ¤æ–­
    *   and , or
    *   \== , !=
    *   \> , <
    *   \>= , <=
    *   in , not in
*   forå¾ªç¯ï¼Œç¤ºä¾‹ï¼šå¦‚æœ{% for....... %}å¾ªç¯æˆç«‹ï¼Œæ˜¾ç¤ºforå¾ªç¯ä¸‹é¢çš„è¯­å¥å—ï¼›å¦‚æœforå¾ªç¯é‡Œé¢æ²¡æœ‰ä»»ä½•ä¸œè¥¿å°±ä¼šæ˜¾ç¤º{% else %}ä¸‹é¢çš„è¯­å¥å—

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027155612613-423776753.png)

**ç¤ºä¾‹ä»£ç ï¼š**

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027160520475-348678926.png)

 1 # app.py
 2 
 3 from flask import Flask, render\_template 4 
 5 app = Flask(\_\_name\_\_)
 6 
 7 @app.route('/tag')
 8 def tag(): 9     """  æ¨¡æ¿æ ‡ç­¾çš„ä½¿ç”¨ """
10     var = None
11     a = 2
12     list\_user = \[
13         {'username': 'å¼ ä¸‰', 'age': 32, 'address': 'åŒ—äº¬'},
14         {'username': 'æå››', 'age': 22}
15 \]
16     # list\_user = \[\]
17     return render\_template('tag.html',
18                            var=var,
19                            a=a,
20                            list\_user=list\_user)

 1 <!-- tag.html \-->
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>æ¨¡æ¿æ ‡ç­¾çš„ä½¿ç”¨</title\>
 8 </head\>
 9 <body\>
10     <h3\>if çš„ä½¿ç”¨</h3\>
11 {% if var is none %}
12     <p\>var æ˜¯ none</p\>
13 {% else %}
14     <p\>var ä¸æ˜¯ none</p\>
15 {% endif %}
16 
17 {% if a is defined %}
18      <p\>aå®šä¹‰äº†</p\>
19 {% else %}
20      <p\> a æ²¡æœ‰å®šä¹‰</p\>
21 {% endif %}
22 {% if a == 2 %}
23     <p\>a æ˜¯ 2</p\>
24 {% endif %}
25 
26     <h3\>forå¾ªç¯çš„ä½¿ç”¨</h3\>
27 {% for item in list\_user %}
28         <p\>ç”¨æˆ·åï¼š{{ item.username }}ï¼Œå¹´é¾„ï¼š{{ item.age }}</p\>
29 {% else %}
30         <p\>ç”¨æˆ·ä¿¡æ¯ä¸ºç©º</p\>
31 {% endfor %}
32 </body\>
33 </html\>

*   forå¾ªç¯ä½“å†…çš„å˜é‡

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027163040142-1600681714.png)

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027164249604-1124902464.png)

**æ€è€ƒï¼š**å¦‚æœè¦åœ¨forå¾ªç¯ä¸­ä½¿ç”¨continue/breakæ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**Â jinja\_env = Environment(extensions=\['jinja2.ext.loopcontrols'\])Â ä¸‹å›¾è¿™ä¸ªæ‰©å±•æ–¹å¼ä¸ºè¦†ç›–ï¼Œç”¨çš„=ã€‚ä¸å»ºè®®ï¼Œæ¨èä½¿ç”¨æ·»åŠ æ‰©å±•ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç ä¼šæœ‰ï¼›åŒæ—¶Â jinja2è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ‰©å±•ï¼Œæ„Ÿå…´è¶£[ç‚¹å‡»](http://doc.yonyoucloud.com/doc/jinja2-docs-cn/extensions.html#loopcontrols-extension)çœ‹ä¸‹ï¼›

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027165917109-2049196004.png)

**ç¤ºä¾‹ä»£ç **

**![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027171702042-1133200225.png)**

 1 # app.py
 2 
 3 from flask import Flask, render\_template 4 
 5 
 6 app = Flask(\_\_name\_\_)
 7 # æ·»åŠ æ‰©å±•ï¼šä¸ºæ¨¡æ¿å¼•æ“æ·»åŠ æ‰©å±•ï¼Œæ”¯æŒbreak/continueè¯­æ³•
 8 app.jinja\_env.add\_extension('jinja2.ext.loopcontrols')
 9 
10 '''
11 è¯¥æ‰©å±•ä¸ºè¦†ç›–ä¸å»ºè®®ä½¿ç”¨
12 from jinja2 import Environment
13 app.jinja\_env=Environment(extensions=\['jinja2.ext.loopcontrols'\])
14 '''
15 @app.route('/tag')
16 def tag():
17     """  æ¨¡æ¿æ ‡ç­¾çš„ä½¿ç”¨ """
18     var = None
19     a = 2
20     list\_user = \[
21         {'username': 'å¼ ä¸‰', 'age': 32, 'address': 'åŒ—äº¬'},
22         {'username': 'æå››', 'age': 22},
23         {'username': 'ç‹äº”', 'age': 32, 'address': 'åŒ—äº¬'},
24         {'username': 'ç‹æ–‡', 'age': 22}
25 \]
26     # list\_user = \[\]
27     return render\_template('tag.html',
28                            var=var,
29                            a=a,
30                            list\_user=list\_user)

 1 <!-- tag.html \-->
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>æ¨¡æ¿æ ‡ç­¾çš„ä½¿ç”¨</title\>
 8     <style type\="text/css"\>
 9 .odd {
10             background-color: #f00;
11             color: #fff;
12         }
13 .even {
14             background-color: aqua;
15             color: #fff;
16         }
17     </style\>
18 </head\>
19 <body\>
20     <h3\>for å¾ªç¯ dict</h3\>
21 {% for user in list\_user %}
22         <p class\="{{ loop.cycle('odd','even') }}"\>
23         ç¬¬{{ loop.index }}ä¸ªç”¨æˆ·ï¼Œæ€»å…±{{ loop.length }}ä¸ªï¼š<br/>
24 {% for key, value in user.items() %}
25 {{ key }}: {{ value }}
26 {% endfor %}
27         </p\>
28 {% else %}
29         <p\>ç”¨æˆ·ä¿¡æ¯ä¸ºç©º</p\>
30 {% endfor %}
31 
32     <h3\>for å¾ªç¯ dict -break</h3\>
33 {% for user in list\_user -%}
34         <p class\="{{ loop.cycle('odd','even') }}"\>
35         ç¬¬{{ loop.index }}ä¸ªç”¨æˆ·ï¼Œæ€»å…±{{ loop.length }}ä¸ªï¼š<br/>
36 {% for key, value in user.items() -%}
37             {% if loop.index > 2 -%}    <!--è·³å‡ºäº†addressçš„æ˜¾ç¤º\-->
38 {% break -%}
39 {% endif -%}
40 {{ key }}: {{ value }}
41 {% endfor -%}
42         </p\>
43 {% else %}
44         <p\>ç”¨æˆ·ä¿¡æ¯ä¸ºç©º</p\>
45 {% endfor %}
46 </body\>
47 </html\>

**åŒæ—¶æ¨¡æ¿æ ‡ç­¾è¿˜æ”¯æŒæ·»åŠ æ³¨é‡Š**ï¼Œæ³¨é‡Šåˆ†ä¸ºä¸¤ç§ï¼š

1ï¼‰ä¼šåœ¨æµè§ˆå™¨htmlæºç ä¸­æ˜¾ç¤ºï¼šÂ <!-- æˆ‘æ˜¯HTMLæ³¨é‡Š \-->Â 

2ï¼‰ä¸ä¼šåœ¨æµè§ˆå™¨htmlæºç ä¸­æ˜¾ç¤ºï¼šÂ {# æ³¨é‡Šå†…å®¹ #}Â 

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027173209663-1257252269.png)

**å»é™¤HTMLæºç ä¸­å¤šä½™çš„ç©ºç™½**å¯ä»¥æé«˜æ€§èƒ½ï¼Œä¸èƒ½å¿½è§†ï¼å»é™¤æ–¹å¼ï¼Œåœ¨å—çš„å¼€å§‹æˆ–ç»“æŸæ”¾ç½®ä¸€ä¸ªå‡å·ï¼ˆ-ï¼‰ï¼Œä¸èƒ½æœ‰ç©ºæ ¼

Â ![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027173715611-685576099.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027173901175-1928163723.png)

*   è®¾ç½®å˜é‡ï¼Œè¿›è¡Œèµ‹å€¼æ“ä½œï¼šå…ˆè®¾ç½®ï¼Œåä½¿ç”¨ï¼Œå¯ä»¥é€šè¿‡importå¯¼å…¥ï¼›

<!-- è®¾ç½®å˜é‡  \-->
{% set key,value = (1,2) %}

å»ºè®®è®¾ç½®å˜é‡çš„æ—¶å€™ï¼Œå’Œwithä»£ç å—ç»“åˆä½¿ç”¨ï¼Œå®ç°å—çº§ä½œç”¨åŸŸã€‚è¿™ä¸ªå˜é‡åªåœ¨withè¿™ä¸ªä»£ç å—ä¸­æœ‰æ•ˆæœã€‚

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027174536845-1183845072.png)![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027175047810-1230444514.png)

**æ€è€ƒï¼šå¦‚ä¸‹å†…å®¹å¦‚ä½•æ˜¾ç¤ºï¼Ÿ**

{{}}ã€€ã€€{% %}

1ï¼‰è§†ä¸ºå­—ç¬¦ä¸²ï¼šÂ {{ â€˜{{}} {% %}â€™ }} Â 

2ï¼‰ä½¿ç”¨**rawæ ‡ç­¾è¿›è¡Œè½¬ä¹‰**ï¼Œä½¿å¾—ç‰¹æ®Šç¬¦å·æ­£å¸¸æ˜¾ç¤º

![](https://img2022.cnblogs.com/blog/2281865/202210/2281865-20221027175815274-1864320113.png)

### 3.2.æ¨¡æ¿è¯­æ³•\_è¿‡æ»¤å™¨

æ€è€ƒï¼šä¸‹é¢çš„åœºæ™¯å¦‚ä½•å®ç°ï¼Ÿ

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103145836134-1442566689.png)

**ä»€ä¹ˆæ˜¯è¿‡æ»¤å™¨ï¼Ÿ**

*   è¿‡æ»¤å™¨ï¼šå®šä¹‰å¥½è§„åˆ™ï¼Œä¿®æ”¹å˜é‡ï¼ˆå¦‚ï¼šæ ¼å¼åŒ–æ˜¾ç¤ºï¼‰
*   è¿‡æ»¤å™¨çš„ä½¿ç”¨æ ¼å¼ï¼Œç”¨ç®¡é“ç¬¦å·ï¼ˆ|ï¼‰åˆ†å‰²ï¼Œå¦‚ï¼š{{ name|striptags }}ï¼Œstriptagså°±æ˜¯è¿‡æ»¤å™¨ï¼Œå°†nameå˜é‡ä¼ é€’ç»™striptagså¤„ç†æœ€åè¿”å›å¤„ç†åçš„ç»“æœ
*   å¯ä»¥é“¾å¼è°ƒç”¨ï¼š{{ name|striptags|title }}ï¼Œnameä¼ é€’ç»™å¤šä¸ªè¿‡æ»¤å™¨
*   å¯ä»¥ç”¨å›­æ‹¬å·ä¼ é€’å¯é€‰å‚æ•°{{ list|join(',')}}

**è¿‡æ»¤å™¨çš„ä½¿ç”¨**

æ–¹å¼ä¸€ï¼šç”¨ç®¡é“ç¬¦ï¼ˆ | ï¼‰

{{ value|safe }}

æ–¹å¼äºŒï¼šä½¿ç”¨ä¾¿ç­¾{% filter è¿‡æ»¤å™¨ %} {% endfilter %}

{% filter upper %}
    This text becomes uppercase
{% endfilter %}

è¿‡æ»¤å™¨upperå¯¹å­—ç¬¦ä¸²This textã€‚ã€‚ã€‚è¿›è¡Œæ ¼å¼åŒ–æ˜¾ç¤º

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103152642953-2127537318.png)

**å†…ç½®çš„è¿‡æ»¤å™¨**

*   æ±‚ç»å¯¹å€¼absï¼š{{ value|abs }}
*   é»˜è®¤å€¼æ˜¾ç¤ºï¼šdefault(value,default\_value='',boolean=False)
    *   {{ value|default('é»˜è®¤å€¼')}}ï¼šå¦‚æœvalueå˜é‡æ²¡æœ‰å®šä¹‰ï¼Œä¼ é€’è¿‡æ¥ï¼Œdefaultè¿‡æ»¤å™¨å¤„ç†valueè¿”å›â€œé»˜è®¤å€¼â€Â 
    *   {{ value|d('é»˜è®¤å€¼') }}ï¼šä¸Šé¢çš„ç®€å†™

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103154353568-1515461903.png)

*   Â htmlè½¬ä¹‰escapeæˆ–eï¼š{{ value | escape }} æˆ– {{ value | e }}

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103160256969-827552472.png)

ğŸ‘†ç”±äºæµè§ˆå™¨ä¸€èˆ¬é»˜è®¤å¯¹htmlè‡ªåŠ¨è½¬ä¹‰æˆå­—ç¬¦ä¸²è¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨{% autoescape fale %}å°†å…¶å…³é—­ã€‚è¿™æ—¶è°ƒè¯•ï¼Œè¿‡æ»¤å™¨eçš„ä½œç”¨å°±ç›´è§‚äº†ã€‚

*   å¯Œæ–‡æœ¬å†…å®¹è½¬ä¹‰æ˜¾ç¤ºsafeï¼š{{ value|safe }}
*   å€’å™æ˜¾ç¤ºreverseï¼š{{ value|reverse }}
*   [æŸ¥çœ‹æ›´å¤šå†…ç½®è¿‡æ»¤å™¨](http://doc.yonyoucloud.com/doc/jinja2-docs-cn/templates.html#builtin-filters)

**è‡ªå®šä¹‰è¿‡æ»¤å™¨**

æ–¹å¼ä¸€ï¼šä½¿ç”¨è£…é¥°å™¨@app.template\_filterå¯¹è‡ªå®šä¹‰è£…é¥°å™¨è¿›è¡Œæ³¨å†Œï¼›æ¨èä½¿ç”¨è¿™ä¸ª

*   ç¤ºä¾‹reverseï¼šè‡ªå®šä¹‰è£…é¥°å™¨åç§°
*   ç¤ºä¾‹reverse\_filterå‡½æ•°ï¼šè‡ªå®šä¹‰è£…é¥°å™¨çš„é€»è¾‘æ–¹æ³•ï¼Œéœ€è¦ä¼ é€’è¢«ä¿®æ”¹çš„å˜é‡s

@app.template\_filter('reverse')
def reverse\_filter(s):
    return s\[::-1\]

æ–¹å¼äºŒï¼šè°ƒç”¨å‡½æ•°app.jinja\_env.filterså¯¹è‡ªå®šä¹‰è£…é¥°å™¨è¿›è¡Œæ³¨å†Œ

*   ç¤ºä¾‹reverseï¼šè‡ªå®šä¹‰è£…é¥°å™¨åç§°
*   ç¤ºä¾‹reverse\_filterå‡½æ•°ï¼šè‡ªå®šä¹‰è£…é¥°å™¨çš„é€»è¾‘æ–¹æ³•ï¼Œéœ€è¦ä¼ é€’è¢«ä¿®æ”¹çš„å˜é‡s

def reverse\_filter(s):
    return s\[::-1\]
app.jinja\_env.filters\['reverse'\] = reverse\_filter

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103170056585-123487066.png)

### 3.3.æ¨¡æ¿è¯­æ³•\_æ¨¡æ¿å…¨å±€å‡½æ•°

æ€è€ƒï¼šå¦‚ä½•åœ¨æ¨¡æ¿ä¸­å®ç°rangeå‡½æ•°çš„æ•ˆæœï¼Ÿ

å…¨å±€å‡½æ•°å¯åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨

1 <ul\>
2 {% for i in range(10) %}
3   <li\>{{ i }}</li\>
4 {% endfor %}
5 </ul\>

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103173446200-1161344752.png)

**æ¨¡æ¿æä¾›çš„å…¨å±€å‡½æ•°æœ‰ï¼š**

*   range(\[start\],stop\[,step\])ï¼šå’Œpythonçš„rangeç”¨æ³•åŸºæœ¬ä¸€è‡´
*   dict(\*\*items)ï¼šè½¬æ¢æˆå­—å…¸å½¢å¼
*   cycler(\*items)ï¼šå¸¸ç”¨äºcssç±»åçš„å¾ªç¯ã€‚

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103174659131-1715980534.png)

åº”ç”¨åœºæ™¯ç®€å•è¯´æ˜ï¼šå£°æ˜å˜é‡class\_nameï¼Œé€šè¿‡cycler()èµ‹å€¼ç»™è¿™ä¸ªå˜é‡ã€‚æ ‡ç­¾çš„classå±æ€§å€¼ç­‰äºè¿™ä¸ªå˜é‡ï¼Œé€šè¿‡next()è·å–ä¸‹ä¸€ä¸ªã€‚ä½¿ç”¨cssæŸ¥æ‰¾classå¹¶å¯¹å…¶æ ·å¼ä¿®æ”¹ã€‚

*   joiner(sep= ',')ï¼šå¯ç”¨äºå­—ç¬¦ä¸²æ‹¼æ¥ï¼›ç›¸å½“äºpythoné‡Œé¢joinçš„è¯­æ³•
*   url\_for()ï¼šURLè§£æå‡½æ•°ï¼ˆå¦‚ï¼šé™æ€æ–‡ä»¶åœ°å€è§£æã€é“¾æ¥è·³è½¬åœ°å€è§£æï¼‰

é™æ€æ–‡ä»¶åœ°å€è§£æï¼›ä½¿ç”¨linkå¼•ç”¨å¤–éƒ¨cssæ–‡ä»¶æ—¶ï¼Œéœ€è¦åŠ ä¸Šrel=stylesheetï¼›rel="stylesheet" æè¿°äº†å½“å‰é¡µé¢ä¸hrefæ‰€æŒ‡å®šæ–‡æ¡£çš„å…³ç³».å³è¯´æ˜çš„æ˜¯ï¼šhrefè¿æ¥çš„æ–‡æ¡£æ˜¯ä¸€ä¸ªæ ·å¼è¡¨ã€‚

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103185709958-2099651409.png)

é“¾æ¥è·³è½¬åœ°å€è§£æ

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103190139059-1363749172.png)

4.Flaskæ¨¡æ¿ä¸­çš„å®
------------

**ä»€ä¹ˆæ˜¯å®ï¼Ÿ**

æŠŠå¸¸ç”¨åŠŸèƒ½æŠ½å–å‡ºæ¥ï¼Œå®ç°å¯é‡ç”¨ï¼›ç®€å•ç†è§£ï¼šå®â‰ˆå‡½æ•°ï¼›å®å¯ä»¥å†™åœ¨å•ç‹¬çš„htmlæ–‡ä»¶ä¸­ã€‚

### **4.1.æ¨¡æ¿ä¸­çš„å®**

**1ï¼‰å®šä¹‰å®{% macro %}ï¼š**åƒä¹¦å†™å‡½æ•°ä¸€æ ·å®šä¹‰å®ï¼Œç¤ºä¾‹è§£æ

*   ç¤ºä¾‹ä»£ç å®šä¹‰äº†ä¸€ä¸ªinputçš„å®
*   è°ƒç”¨inputå®çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥nameã€valueã€typeã€sizeï¼›å…¶ä¸­nameæ˜¯å¿…ä¼ å‚æ•°ï¼Œvalueã€typeå’Œsizeéƒ½æœ‰é»˜è®¤å€¼ï¼Œä¸ä¼ æ—¶ä½¿ç”¨é»˜è®¤å€¼
*   è¿”å›çš„å†…å®¹ä¸ºğŸ‘‡ï¼Œè°ƒç”¨inputå®ä¼ é€’çš„å‚æ•°ï¼Œèµ‹å€¼ç»™è¿”å›å†…å®¹{{å˜é‡}}ã€‚å…¶ä¸­valueè¿˜ç»è¿‡äº†è¿‡æ»¤å™¨eè¿›è¡Œäº†htmlè½¬ä¹‰ã€‚

![](https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif)![](https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif)

<input type\="{{ type }}" name\="{{ name }}" value"{{ value|e }}" size\="{{ size }}"\>

è°ƒç”¨å®è¿”å›çš„å†…å®¹

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103191616102-1101133857.png)

**2ï¼‰ä½¿ç”¨å®{{ å®å() }}ï¼š**åƒè°ƒç”¨å‡½æ•°ä¸€æ ·è°ƒç”¨ã€‚

**![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103193343450-948335816.png)**

**3ï¼‰å®Œæ•´ç¤ºä¾‹**

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103194049478-147800889.png)

### **4.2.æ–‡ä»¶ä¸­çš„å®**

å¯ä»¥æŠŠå†™åœ¨htmlæ–‡ä»¶ä¸­çš„å®ï¼Œå½“æˆpythonçš„ä¸€ä¸ªæ¨¡å—è¿›è¡Œä½¿ç”¨

**1ï¼‰å¯¼å…¥å®**ï¼Œè·Ÿpythonä½¿ç”¨æ¨¡å—æ–¹æ³•ä¸€æ ·ã€‚

*   {% import 'forms.html' as forms %}ï¼šå¯¼å…¥å®æ–‡ä»¶forms.htmlï¼Œå¹¶é‡å‘½åforms
*   {%Â  from 'forms2.html' import input2 %}ï¼šå¯¼å…¥å®æ–‡ä»¶forms2.htmlä¸­çš„inputå®

**2ï¼‰ä½¿ç”¨å®**

*   <p>{{ forms.input('username' )}}</p>
*   <p>{{ input2('password' )}}</p>

**3ï¼‰å®Œæˆç¤ºä¾‹**

**![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103200657502-582004423.png)**

5.Flaskæ¨¡æ¿çš„ç»§æ‰¿
------------

**æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦å¯¹æ¨¡æ¿è¿›è¡ŒæŠ½è±¡å’Œç»§æ‰¿ï¼Ÿæ¨¡æ¿çš„æŠ½è±¡ç»§æ‰¿ï¼Œå’Œpythonçš„é¢å‘å¯¹è±¡æ˜¯ä¸€æ ·çš„ã€‚**

**æ€è€ƒï¼šå¦‚ä¸‹åœºæ™¯æ€æ ·è®¾è®¡ï¼ˆæ˜“ç»´æŠ¤ã€å¯æ‰©å±•ï¼‰ï¼Ÿ**

*   æ¯ä¸ªé¡µé¢éƒ½å¼•ç”¨äº†å…¬å…±çš„å¤´éƒ¨ï¼Œjsï¼Œcss
*   æœ‰å‡ ä¸ªé¡µé¢ç»“æ„å’Œå†…å®¹åŠå…¶ç›¸ä¼¼ï¼ˆå¦‚ï¼šå¯¼èˆªèœå•ï¼‰

### 5.1.ç»§æ‰¿å®ç°

è®¾å®šï¼šæœ‰ä¸€ä¸ªå…¬ç”¨æ¨¡æ¿é¡µé¢base.htmlã€‚å…¶ä»–æ¨¡æ¿é¡µé¢åŸºäºbase.htmlä¿®æ”¹è‡ªå·±é¡µé¢çš„headerã€bodyç­‰éƒ¨åˆ†ä¿¡æ¯ã€‚å…¶ä»–çš„ä½¿ç”¨å…¬å…±æ¨¡æ¿é¡µé¢base.html

ã€€ã€€1ï¼‰åœ¨é€šç”¨æ¨¡æ¿ä¸Šï¼Œé€šè¿‡Â {% block éƒ¨åˆ†åç§°%}{% endblock %}Â å°†å¯å˜çš„éƒ¨åˆ†åœˆå‡ºæ¥ï¼›å›¾ç¤ºæ­¥éª¤ä¸€ï¼Œä½¿ç”¨blockå°†å¯å˜çš„éƒ¨åˆ†åœˆå‡ºæ¥ï¼Œå‘½åä¸ºcontentã€‚

ã€€ã€€2ï¼‰æ–°æ¨¡æ¿é¡µé¢ï¼Œé€šè¿‡Â {% extends "çˆ¶æ¨¡æ¿" %}Â ç»§æ‰¿é€šç”¨æ¨¡æ¿ï¼›è™½ç„¶æ–°æ¨¡æ¿.htmlåªæœ‰ä¸€è¡Œä»£ç Â {% extends "çˆ¶æ¨¡æ¿" %}Â ï¼Œä½†æ˜¯æ–°æ¨¡æ¿ç›®å‰æ˜¯å’Œçˆ¶ç±»æ¨¡æ¿å±•ç¤ºæ•ˆæœä¸€æ ·çš„ã€‚

ã€€ã€€3ï¼‰æ–°æ¨¡æ¿é¡µé¢è¿™æ—¶å€™è¦å®šåˆ¶å¼€å‘äº†ï¼Œé€šè¿‡Â {% block é€‰æ‹©è¦ä¿®æ”¹çš„å¯å˜éƒ¨åˆ†åç§°%}ä½ ä¿®æ”¹çš„æ–°ä»£ç å—{% endblock %}Â ï¼Œå®Œæˆä¿®æ”¹åï¼Œæ–°æ¨¡æ¿é¡µé¢å±•ç¤ºä½ ä¿®æ”¹åçš„æ•ˆæœ

ã€€ã€€4ï¼‰å½“ä½ æƒ³ä¿ç•™å¯å˜éƒ¨åˆ†ï¼Œå¹¶ä¸”åŸºæœ¬å¯å˜éƒ¨åˆ†åŸå…ˆå†…å®¹å†æ·»åŠ æ–°å†…å®¹æ—¶ï¼Œé€šè¿‡Â {{ super() }}åé¢æ¥ä½ æ–°çš„å†…å®¹Â ï¼Œæ—¢ä¿ç•™äº†å¯å˜éƒ¨åˆ†åˆæ·»åŠ äº†ä½ æ–°å¢çš„éƒ¨åˆ†

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103201755492-2020045210.png)

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103201952889-741412856.png)

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103202909523-1154595961.png)

**ç¤ºä¾‹ä»£ç ï¼š**

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103205839889-1196761419.png)

**æ€è€ƒï¼šåªæœ‰éƒ¨åˆ†é¡µé¢ä½¿ç”¨åˆ°çš„å¯¼èˆªæ¡æ€ä¹ˆè®¾è®¡ï¼Ÿ**

*   æŒ‰ç…§ç»§æ‰¿çš„æ‰‹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›éƒ¨åˆ†é¡µé¢åœˆèµ·æ¥ï¼Œç»§æ‰¿çš„æ—¶å€™ï¼Œç„¶åé‡å†™ä»–å†…å®¹ä¸ºç©ºã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯å¾ˆlow
*   ä½¿ç”¨æ¨¡æ¿çš„**åŒ…å«è¯­æ³•**è¿›è¡Œå®ç°æ‰æ˜¯æœ€æœ‰è§£å†³æ–¹æ¡ˆ

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221103203102719-837144719.png)

### 5.2.æ¨¡æ¿ç»§æ‰¿çš„åŒ…å«è¯­æ³•

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221104101053638-1214642252.png)

![](https://img2022.cnblogs.com/blog/2281865/202211/2281865-20221104101336283-736372252.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206141023650-805769876.png)

*   include â€œsidebar.htmlâ€ **ignore missing**ï¼šsidebar.htmlä¸å­˜åœ¨ï¼Œä¸ä¼šæŠ¥é”™
*   include â€œsidebar.htmlâ€ ignore missing**with context**ï¼šå°†æ¨¡æ¿çš„ä¸Šä¸‹æ–‡å¯¹è±¡ä¼ é€’åˆ°sidebar.htmlæ–‡ä»¶ä¸­
*   include â€œsidebar.htmlâ€ ignore missing **without context**ï¼šå°†æ¨¡æ¿çš„ä¸Šä¸‹æ–‡å¯¹è±¡ä¸ä¼ é€’åˆ°sidebar.htmlæ–‡ä»¶ä¸­
*   **include without contextçš„ç®€å•ç¤ºä¾‹**

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206141835064-1932470516.png)

Â ![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206142319365-1718165865.png)![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206141959891-996452583.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206142111143-513508027.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206142640186-2059485185.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206143941616-1635686273.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206144353984-1473116999.png)

### 5.3.ç»§æ‰¿ä¸åŒ…å«çš„åŒºåˆ«

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206144722219-34622509.png)

6.æ¶ˆæ¯é—ªç°
------

**ä»€ä¹ˆæ˜¯æ¶ˆæ¯é—ªç°**

æ€è€ƒï¼šè¦åœ¨å¦‚ä¸‹åœºæ™¯ä¸‹ç»™äºˆæ“ä½œæç¤ºï¼Œæ€ä¹ˆå®ç°ï¼Ÿ

*   ç”¨æˆ·ç™»å½•æˆåŠŸï¼Œæç¤ºï¼šæ¬¢è¿å›æ¥
*   ç”¨æˆ·å‘å¸ƒé—®é¢˜æˆåŠŸï¼Œæç¤ºï¼šå‘å¸–æˆåŠŸ

**æ¶ˆæ¯é—ªç°**

ç¬¬ä¸€æ­¥ï¼šåœ¨è§†å›¾ä¸­äº§ç”Ÿä¸€ä¸ªæ¶ˆæ¯ï¼ˆæç¤º/è­¦å‘Š/é”™è¯¯ï¼‰

![](https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif)![](https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif)

flash(msg\_content,msg\_type)

#å‚æ•°msg\_contentï¼šæ¶ˆæ¯å†…å®¹
#å‚æ•°msg\_typeï¼šæ¶ˆæ¯ç±»å‹

View Code

ç¬¬äºŒæ­¥ï¼šåœ¨æ¨¡æ¿ä¸­å±•ç¤ºæ¶ˆæ¯

![](https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif)![](https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif)

get\_flashed\_messages(category\_filter=\["error"\])

#å‚æ•°category\_filterï¼šå¯¹äº§ç”Ÿçš„æ¶ˆæ¯æŒ‰ç±»åˆ«æŸ¥è¯¢
#è¿”å›çš„æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡

View Code

ä½¿ç”¨forå¾ªç¯è·å–get\_flashed\_messagesè¿”å›çš„å¯¹è±¡å†…å®¹ï¼šcategoryï¼Œmessage

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206151459554-567163787.png)

**å®ä¾‹ï¼š**

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206154151237-1342987031.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206154222455-413685491.png)

![](https://img2023.cnblogs.com/blog/2281865/202212/2281865-20221206154243702-2135990130.png)

Â **get\_flashed\_messageså‚æ•°è¯´æ˜**

*   å‚æ•°ä¸æ˜¯å¿…å¡«çš„å¯ä»¥ä¸ä¼ 
*   with\_categories=trueï¼šä»£è¡¨æˆ‘ä»¬å¯ç”¨æ¶ˆæ¯åˆ†ç±»ï¼Œä¹‹åé’ˆå¯¹æ¶ˆæ¯ç±»å‹ï¼Œå¯ä»¥è¿›è¡Œç›¸å…³çš„è¿‡æ»¤æ“ä½œ
*   category\_filter=\['error'\]ï¼šè¿™é‡Œé¢å‚æ•°æ˜¯listï¼Œç­›é€‰å‚æ•°msg\_typeï¼šæ¶ˆæ¯ç±»å‹

**code**

 1 # app.py
 2 
 3 from flask import Flask, render\_template, flash, redirect, request 4 
 5 app = Flask(\_\_name\_\_)
 6 # sessionçš„å®‰å…¨æœºåˆ¶ï¼Œä½¿ç”¨flashæ—¶éœ€è¦è®¾ç½®è¯¥éšæœºä¸²
 7 app.secret\_key = 'secret\_keyabcdes334'
 8 
 9 # ç”¨æˆ·ç™»å½•ä¹‹åï¼Œè·³è½¬åˆ°ä¸ªäººä¸­å¿ƒï¼Œåœ¨ä¸ªäººä¸­å¿ƒé¡µé¢ï¼Œå±•ç¤ºä¸€ä¸ªæç¤ºï¼šç™»å½•æˆåŠŸ
10 
11 
12 @app.route('/login', methods=\['GET', 'POST'\])
13 def login():
14     """  ç”¨æˆ·ç™»å½• """
15     if request.method == 'POST':
16         print('å¤„ç†äº†ç™»å½•çš„é€»è¾‘')
17         flash('ç™»å½•æˆåŠŸ', 'success')
18         flash('æ¬¢è¿å›æ¥', 'success')
19         flash('é”™è¯¯æç¤º', 'error')
20         return redirect('/mine')
21     return render\_template('login.html')
22 
23 
24 @app.route('/mine')
25 def mine():
26     """  ä¸ªäººä¸­å¿ƒ """
27     return render\_template('mine.html')

 1 <!-- login.html \-->
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>ç”¨æˆ·ç™»å½•</title\>
 8 </head\>
 9 <body\>
10     <h3\>ç”¨æˆ·ç™»å½•</h3\>
11     <form action\="{{ url\_for('login') }}" method\="post"\>
12         <div\>
13             <input type\="text" name\="username" value\="admin"\>
14         </div\>
15         <div\>
16             <input type\="password" name\="password"\>
17         </div\>
18         <div\>
19             <button type\="submit"\>ç™»å½•</button\>
20         </div\>
21     </form\>
22 </body\>
23 </html\>

 1 <!--  mine.html \-->
 2 
 3 <!DOCTYPE html\>
 4 <html lang\="en"\>
 5 <head\>
 6     <meta charset\="UTF-8"\>
 7     <title\>ä¸ªäººä¸­å¿ƒ</title\>
 8     <style type\="text/css"\>
 9 .success {
10             color: #0f0;
11         }
12 .error {
13             color: #f00;
14         }
15     </style\>
16 </head\>
17 <body\>
18     <h3\>ä¸ªäººä¸­å¿ƒ</h3\>
19 {% for category, message in get\_flashed\_messages(with\_categories=true, category\_filter=\['error'\]) %}
20     <p class\="{{ category }}"\>
21 {{ category }} -{{ message }}
22     </p\>
23 {% endfor %}
24 </body\>
25 </html\>

6.é‡ç‚¹æŒæ¡
------

*   æ¨¡æ¿è¯­æ³•çš„ä½¿ç”¨ï¼ˆå˜é‡ã€æ ‡ç­¾ã€è¿‡æ»¤å™¨ï¼‰
*   æ¨¡æ¿çš„ç»§æ‰¿ã€åŒ…å«ã€å¼•ç”¨
*   æ¨¡æ¿ä¸­çš„å®å®šä¹‰å’Œä½¿ç”¨
*   æ¶ˆæ¯é—ªç°