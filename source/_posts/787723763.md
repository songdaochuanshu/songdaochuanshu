---
layout: post
title: "è‡ªåŠ¨åŒ–è¿ç»´ï¼Ÿçœ‹çœ‹Pythonæ€æ ·å®Œæˆè‡ªåŠ¨ä»»åŠ¡è°ƒåº¦â›µ"
date: "2022-11-08T05:25:42.800Z"
---
è‡ªåŠ¨åŒ–è¿ç»´ï¼Ÿçœ‹çœ‹Pythonæ€æ ·å®Œæˆè‡ªåŠ¨ä»»åŠ¡è°ƒåº¦â›µ
=========================

![è‡ªåŠ¨åŒ–è¿ç»´ï¼Ÿçœ‹çœ‹Pythonæ€æ ·å®Œæˆè‡ªåŠ¨ä»»åŠ¡è°ƒåº¦â›µ](https://img2022.cnblogs.com/blog/2637458/202211/2637458-20221108110842058-464087028.png) æœ¬æ–‡è®²è§£å¦‚ä½•ä½¿ç”¨Pythonçš„scheduleåº“å®Œæˆè‡ªåŠ¨åŒ–è°ƒåº¦ç¨‹åºï¼Œé€šè¿‡ä»£ã€å‘é€é‚®ä»¶ã€è¿™ä¸€ä»£ç å®ä¾‹å±•ç¤ºäº†æ„å»ºä»»åŠ¡ä¸ä»»åŠ¡è°ƒåº¦çš„å…¨è¿‡ç¨‹ã€‚

![](https://img-blog.csdnimg.cn/img_convert/033ba1686294138aae8933afa4f31a7e.png)

> ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](https://www.showmeai.tech/)  
> ğŸ“˜ [Python3â—‰æŠ€èƒ½æå‡ç³»åˆ—](https://www.showmeai.tech/tutorials/56)ï¼š[https://www.showmeai.tech/tutorials/56](https://www.showmeai.tech/tutorials/56)  
> ğŸ“˜ [æœ¬æ–‡åœ°å€](https://www.showmeai.tech/article-detail/323)ï¼š[https://www.showmeai.tech/article-detail/323](https://www.showmeai.tech/article-detail/323)  
> ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„  
> ğŸ“¢ æ”¶è—[ShowMeAI](https://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

![](https://img-blog.csdnimg.cn/img_convert/ef52563da043349ae0fdec48f8dd6dd1.png)

è®¡åˆ’ä»»åŠ¡æ˜¯å‡ ä¹æ¯ä¸ªå¼€å‘äººå‘˜éƒ½ä¼šç”¨åˆ°çš„åŠŸèƒ½ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå¯ä»¥ç”¨ Cron ä½œä¸šæ¥è¿›è¡Œä»»åŠ¡è°ƒåº¦ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ç¨³å®šçš„æ–¹å¼ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥å®Œå…¨ç¨‹åºåŒ–ï¼Œå…¨éƒ¨ä½¿ç”¨ Python æ¥å®Œæˆè°ƒåº¦ç¨‹åºï¼Œè€Œä¸”å¯ä»¥æœ‰æ›´ç®€å•çš„é…ç½®æ–¹å¼ã€‚

ğŸ’¡ åŸºäº Python çš„ä»»åŠ¡è°ƒåº¦
==================

ğŸ“Œ å¿«é€Ÿå®‰è£…ä¸åº”ç”¨
----------

Pythonå·¥å…·åŒ… ğŸ“˜[**schedule**](https://schedule.readthedocs.io/en/stable/)å¯ä»¥è½»æ¾åœ°åœ¨ Python ä¸­è¿›è¡Œä»»åŠ¡è°ƒåº¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ PyPI å¿«é€Ÿå®‰è£…å®ƒã€‚

    $ pip install schedule
    

å€ŸåŠ©äº scheduleï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥åƒç”¨è‡ªç„¶è¯­è¨€è¯´è¯ä¸€æ ·å¿«é€Ÿæ„å»ºä»»åŠ¡è®¡åˆ’å’Œæ—¶é—´è¡¨ã€‚æ¯”å¦‚ï¼Œä½ æƒ³æ¯å°æ—¶è¿è¡Œä¸€æ¬¡æŸä¸ªåŠŸèƒ½å‡½æ•°ï¼ˆæ¯”å¦‚åŠŸèƒ½æ˜¯å‘é‚®ä»¶çš„å‡½æ•°`send_email`) ï¼Œå†™æ³•æ˜¯è¿™æ ·çš„ï¼š

    schedule.every().hour.do(send_email)
    

æ•´ä¸ªè¿‡ç¨‹éå¸¸ç¨‹åºåŒ–å’Œè‡ªç„¶ï¼Œå®Œæ•´çš„ä¸€ä¸ªã€**æ„å»ºä»»åŠ¡+ä»»åŠ¡è°ƒåº¦**ã€ç¨‹åºå¦‚ä¸‹ï¼ˆæˆ‘ä»¬æŠŠæ¯å°æ—¶å‘é€ä¸€æ¬¡é‚®ä»¶è°ƒæ•´ä¸ºæ¯å¤©ä¸€æ¬¡äº†ï¼‰ã€‚

    import time
    import schedule
    
    
    def send_email():
        # å‘é€é‚®ä»¶çš„æ“ä½œå¯ä»¥åŠ åœ¨è¿™é‡Œ
        print("Sending email...")
    
    
    schedule.every().day.at("14:45").do(send_email)
    
    while True:
        schedule.run_pending()
        time.sleep(1)
    

ä¸Šé¢çš„ä»£ç å°†åœ¨æ¯å¤©ä¸‹åˆ14:45 è°ƒç”¨`send_email`å‡½æ•°ã€‚é™¤ä¹¦å†™ç®€å•æ˜“ç”¨ä¹‹å¤–ï¼Œschedule å·¥å…·åº“è¿˜æä¾›äº†ä¸€ç³»åˆ—å…¶ä»–åŠŸèƒ½ã€‚

ğŸ“Œ ä½¿ç”¨è£…é¥°å™¨è¿›è¡Œè°ƒåº¦
------------

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨è®©ä»£ç æ›´åŠ å¹²å‡€å’Œä¼˜é›…ã€‚schedule å·¥å…·åŒ…æ”¯æŒå¼€ç®±å³ç”¨çš„è£…é¥°å™¨ã€‚æˆ‘ä»¬æŠŠä¸Šé¢å‘é€ç”µå­é‚®ä»¶çš„ç¤ºä¾‹æ”¹ç”¨è£…é¥°å™¨å®Œæˆï¼Œä»£ç å¦‚ä¸‹ã€‚

    import time
    from schedule import repeat, every, run_pending
    
    
    @repeat(every(10).seconds)
    @repeat(every(5).seconds)
    def send_email():
        # å‘é€é‚®ä»¶çš„æ“ä½œå¯ä»¥åŠ åœ¨è¿™é‡Œ
        print("Sending email...")
    
    
    while True:
        run_pending()
        time.sleep(1)
    

ä¸Šè¿°ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸ºåŒä¸€ä¸ªä»»åŠ¡å®šåˆ¶äº†ä¸¤ä¸ªè®¡åˆ’ã€‚ç¬¬ä¸€ä¸ªå°†æ¯ 10 ç§’è°ƒç”¨ä¸€æ¬¡åŠŸèƒ½å‡½æ•°ï¼Œç¬¬äºŒä¸ªå°†æ¯ 5 ç§’è°ƒç”¨ä¸€æ¬¡ã€‚

ğŸ“Œ ä½¿ç”¨å‚æ•°è¿è¡Œè®¡åˆ’ä»»åŠ¡
-------------

æˆ‘ä»¬æœ‰æ—¶å€™ä¼šå¸Œæœ›ä»»åŠ¡çš„è°ƒç”¨æ›´çµæ´»ä¸€äº›ï¼Œæ¯”å¦‚å¦‚æœå¯ä»¥é€šè¿‡ä¼ é€’å‚æ•°æ¥æ§åˆ¶ä»»åŠ¡è°ƒåº¦ï¼Œé‚£å°±å…å»äº†å†™æ­»å„ç§ç»†èŠ‚çš„é—®é¢˜ã€‚ä¸‹é¢æˆ‘ä»¬æŠŠå‘é‚®ä»¶çš„ä»»åŠ¡å†™æˆå¯æ¥å—å‚æ•°çš„å½¢å¼ï¼š

    @repeat(every(10).seconds)
    @repeat(every(5).seconds, email="showmeai@yeah.net")
    def send_email(email="default_email@yeah.net"):
        # å‘é€é‚®ä»¶çš„æ“ä½œå¯ä»¥åŠ åœ¨è¿™é‡Œ
        print(f"Sending email...: to {email}")
    

ç»è¿‡ä¸Šé¢çš„ç®€å•å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç”µå­é‚®ç®±å½“ä½œå‚æ•°ä¼ é€’ç»™è°ƒåº¦ä»»åŠ¡ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»™è„šæœ¬ä¼ å‚ï¼Œä¸€ä¸ªç¤ºä¾‹çš„ä»£ç å¦‚ä¸‹ï¼š

    import argparse
    
    def send_email(email="default_email@yeah.net"):
        # å‘é€é‚®ä»¶çš„æ“ä½œå¯ä»¥åŠ åœ¨è¿™é‡Œ
        print(f"Sending email...: to {email}")
    
    
    if __name__ == "__main__":
        parser = argparse.ArgumentParser()
        parser.add_argument("-e", "--email", help="Email to send")
    
        args = parser.parse_args()
    
        if args.email:
            send_email(args.email)
        else:
            send_email()
    

æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸Šè¿°è„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    $ python send_mail.py -e showmeai@yeah.net
    
    # æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤çš„é‚®ç®±å‚æ•°
    $ python send_email.py
    

ğŸ’¡ æ€»ç»“
=====

æŒ‰è®¡åˆ’è¿è¡Œä»»åŠ¡æ˜¯å¼€å‘è¿‡ç¨‹ä¸­çš„æœ€å¸¸è§éœ€æ±‚ä¹‹ä¸€ï¼Œç³»ç»Ÿè‡ªå¸¦çš„ Crontab å¾ˆå¥½ç”¨ï¼Œä½†å¤§å®¶ä¹Ÿå¯ä»¥è¯•è¯•ç”¨ Python çš„ schedule åº“ï¼Œè®©æ•´ä¸ªä»£ç æµç¨‹ä»åŠŸèƒ½åˆ°è‡ªåŠ¨åŒ–ä»»åŠ¡è°ƒåº¦éƒ½æµ‘ç„¶ä¸€ä½“ã€‚

å‚è€ƒèµ„æ–™
====

*   ğŸ“˜ **schedule**ï¼š[https://schedule.readthedocs.io/en/stable/](https://schedule.readthedocs.io/en/stable/)

[![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image)](https://www.showmeai.tech/)