---
layout: post
title: "ã€è®¾è®¡æ¨¡å¼ã€‘Javaè®¾è®¡æ¨¡å¼ - äº«å…ƒæ¨¡å¼"
date: "2022-09-16T08:26:37.163Z"
---
ã€è®¾è®¡æ¨¡å¼ã€‘Javaè®¾è®¡æ¨¡å¼ - äº«å…ƒæ¨¡å¼
=====================

äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ä¸»è¦ç”¨äºå‡å°‘åˆ›å»ºå¯¹è±¡çš„æ•°é‡ï¼Œä»¥å‡å°‘å†…å­˜å ç”¨å’Œæé«˜æ€§èƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†å‡å°‘å¯¹è±¡æ•°é‡ä»è€Œæ”¹å–„åº”ç”¨æ‰€éœ€çš„å¯¹è±¡ç»“æ„çš„æ–¹å¼ã€‚

Javaè®¾è®¡æ¨¡å¼ - äº«å…ƒæ¨¡å¼
===============

> ğŸ˜„ ä¸æ–­å­¦ä¹ æ‰æ˜¯ç‹é“  
> ğŸ”¥ ç»§ç»­è¸ä¸Šå­¦ä¹ ä¹‹è·¯ï¼Œå­¦ä¹‹åˆ†äº«ç¬”è®°  
> ğŸ‘Š æ€»æœ‰ä¸€å¤©æˆ‘ä¹Ÿèƒ½åƒå„ä½å¤§ä½¬ä¸€æ ·  
> ğŸ†åŸåˆ›ä½œå“ï¼Œæ›´å¤šå…³æ³¨æˆ‘CSDN: [ä¸€ä¸ªæœ‰æ¢¦æœ‰æˆçš„äºº](https://blog.csdn.net/qq_43843951?spm=1011.2415.3001.5343 "ä¸€ä¸ªæœ‰æ¢¦æœ‰æˆçš„äºº")  
> ğŸ‘Šå‡†å¤‡å°†åšå®¢å›­ã€CSDNä¸€èµ·è®°å½•åˆ†äº«è‡ªå·±çš„å­¦ä¹ å¿ƒå¾—ï¼ï¼ï¼  
> ğŸŒåˆ†äº«å­¦ä¹ å¿ƒå¾—ï¼Œæ¬¢è¿æŒ‡æ­£ï¼Œå¤§å®¶ä¸€èµ·å­¦ä¹ æˆé•¿ï¼

![image](https://img2022.cnblogs.com/blog/1954113/202209/1954113-20220916130751961-1964128391.jpg)

ç›®å½•

*   [Javaè®¾è®¡æ¨¡å¼ - äº«å…ƒæ¨¡å¼](#javaè®¾è®¡æ¨¡å¼---äº«å…ƒæ¨¡å¼)
    *   [ç®€ä»‹](#ç®€ä»‹)
        *   [ä¸»è¦è§’è‰²](#ä¸»è¦è§’è‰²)
        *   [å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€](#å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€)
    *   [å®ä¾‹](#å®ä¾‹)
        *   [â‘ ã€æŠ½è±¡ç±»çš„å®šä¹‰](#æŠ½è±¡ç±»çš„å®šä¹‰)
        *   [â‘¡ã€æŠ½è±¡ç±»çš„å­ç±»](#æŠ½è±¡ç±»çš„å­ç±»)
        *   [â‘¢ã€å¤–éƒ¨çŠ¶æ€ - Userå®ä½“ç±»](#å¤–éƒ¨çŠ¶æ€---userå®ä½“ç±»)
        *   [â‘£ã€å·¥å‚ç±»](#å·¥å‚ç±»)
        *   [â‘¤ã€æµ‹è¯•](#æµ‹è¯•)
    *   [å¥½æ–‡æ¨è](#å¥½æ–‡æ¨è)

ç®€ä»‹
--

äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ä¸»è¦ç”¨äºå‡å°‘åˆ›å»ºå¯¹è±¡çš„æ•°é‡ï¼Œä»¥å‡å°‘å†…å­˜å ç”¨å’Œæé«˜æ€§èƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†å‡å°‘å¯¹è±¡æ•°é‡ä»è€Œæ”¹å–„åº”ç”¨æ‰€éœ€çš„å¯¹è±¡ç»“æ„çš„æ–¹å¼ã€‚

äº«å…ƒæ¨¡å¼å°è¯•é‡ç”¨ç°æœ‰çš„åŒç±»å¯¹è±¡ï¼Œå¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„å¯¹è±¡ï¼Œåˆ™åˆ›å»ºæ–°å¯¹è±¡ã€‚  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â€”â€”â€”â€” èœé¸Ÿè”ç›Ÿ  
UMLå›¾ï¼š  
![image](https://img2022.cnblogs.com/blog/1954113/202209/1954113-20220916130807168-515669398.jpg)

### ä¸»è¦è§’è‰²

1.æŠ½è±¡äº«å…ƒè§’è‰²(Flyweight)

> äº«å…ƒå¯¹è±¡æŠ½è±¡åŸºç±»æˆ–è€…æ¥å£ï¼ŒåŒæ—¶å®šä¹‰å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€çš„æ¥å£æˆ–å®ç°ã€‚

2.å…·ä½“äº«å…ƒè§’è‰²(ConcreteFlyweight)

> å®ç°æŠ½è±¡è§’è‰²å®šä¹‰çš„ä¸šåŠ¡ã€‚è¯¥è§’è‰²çš„å†…éƒ¨çŠ¶æ€å¤„ç†åº”è¯¥ä¸ç¯å¢ƒæ— å…³ï¼Œä¸èƒ½å‡ºç°ä¼šæœ‰ä¸€ä¸ªæ“ä½œæ”¹å˜å†…éƒ¨çŠ¶æ€ï¼ŒåŒæ—¶ä¿®æ”¹äº†å¤–éƒ¨çŠ¶æ€ã€‚

3.ä¸å¯åŒäº«è§’è‰²(UnConcreteFlyweight)

> ä¸€èˆ¬ä¸ä¼šå‡ºç°åœ¨äº«å…ƒå·¥å‚ä¸­

4.äº«å…ƒå·¥å‚(FlyweightFactory)

> è´Ÿè´£ç®¡ç†äº«å…ƒå¯¹è±¡æ± å’Œåˆ›å»ºäº«å…ƒå¯¹è±¡ï¼Œæä¾›å®¹å™¨æ± ï¼ŒåŒæ—¶æä¾›è·å–å¯¹è±¡æ–¹æ³•ã€‚

### å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€

*   äº«å…ƒæ¨¡å¼æä¾›äº†ä¸¤ä¸ªè¦æ±‚ï¼šç»†ç²’åº¦å’Œå…±äº«å¯¹è±¡ã€‚
*   å¤–éƒ¨çŠ¶æ€ï¼šå¯¹è±¡å¾—ä»¥ä¾èµ–çš„ä¸€ä¸ªæ ‡è®°ï¼Œæ˜¯éšç€ç¯å¢ƒçš„å˜æ¢è€Œå˜åŒ–ï¼Œä¸å¯å…±äº«çš„çŠ¶æ€ã€‚
*   å†…éƒ¨çŠ¶æ€ï¼šå¯¹è±¡å…±äº«å‡ºæ¥çš„ä¿¡æ¯ï¼Œå­˜åœ¨äº«å…ƒå¯¹è±¡å†…éƒ¨ä¸”ä¸ä¼šéšç€ç¯å¢ƒçš„å˜åŒ–è€Œå˜åŒ–ã€‚

å®ä¾‹
--

æœ¬æ¬¡é‡‡ç”¨å›¾ä¹¦é¦†å€Ÿä¹¦çš„æ¡ˆä¾‹æ¥ç†è§£äº«å…ƒæ¨¡å¼ï¼Œå½¢å¼å¾ˆç®€å•ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œé‡Œé¢æœ‰ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæ¥ç€å®šä¹‰å­ç±»æ¥ç»§æ‰¿æŠ½è±¡ç±»ï¼Œå¹¶å®ç°å…¶æ–¹æ³•ã€‚ä¸ºäº†æ¨¡æ‹Ÿå¤–éƒ¨çŠ¶æ€ï¼Œè¿˜éœ€å®šä¹‰ä¸€ä¸ªç”¨æˆ·å®ä½“ç±»ã€‚æ„å»ºå·¥å‚æ¥ä½œä¸ºæ± å­˜æ”¾å¯¹è±¡ï¼Œå¹¶æš´éœ²è·å–å¯¹è±¡çš„æ–¹æ³•ã€‚æœ€åé€šè¿‡è°ƒç”¨æ–¹æ³•ã€‚  
ç±»å›¾ï¼š  
![image](https://img2022.cnblogs.com/blog/1954113/202209/1954113-20220916130822485-1680263293.png)

### â‘ ã€æŠ½è±¡ç±»çš„å®šä¹‰

åªæœ‰ä¸€ä¸ªå€Ÿä¹¦çš„æ–¹æ³•

    package com.lyd.demo.flyweight;
    import com.lyd.demo.entity.User;
    /**
     * @Author: lyd
     * @Description: å›¾ä¹¦é¦† - æŠ½è±¡ç±»
     * @Date: 2022-09-01
     */
    public abstract class Library {
        public abstract void borrow(User user); // æŠ½è±¡æ–¹æ³• - å€Ÿä¹¦
    }
    

### â‘¡ã€æŠ½è±¡ç±»çš„å­ç±»

å®ç°æŠ½è±¡æ–¹æ³•

    package com.lyd.demo.flyweight;
    import com.lyd.demo.entity.User;
    /**
     * @Author: lyd
     * @Description: å…·ä½“å­ç±»
     * @Date: 2022-09-01
     */
    public class LibraryImpl extends Library {
        private String name; // ä¹¦å - å†…éƒ¨çŠ¶æ€
        public LibraryImpl(String name) {
            this.name = name;
        }
        @Override
        public void borrow(User user) {
            System.out.println("å›¾ä¹¦é¦†çš„ä¹¦ã€Š" + name + "ã€‹å·²è¢«[" + user.getName() + "]å€Ÿå‡º");
        }
    }
    

### â‘¢ã€å¤–éƒ¨çŠ¶æ€ - Userå®ä½“ç±»

    package com.lyd.demo.entity;
    /**
     * @Author: lyd
     * @Description: å®ä½“ - user - æ¨¡æ‹Ÿ å¤–éƒ¨çŠ¶æ€
     * @Date: 2022-09-01
     */
    public class User {
        private String name;
        public User(String name) {
            this.name = name;
        }
        public String getName() {
            return name;
        }
        public void setName(String name) {
            this.name = name;
        }
    }
    

### â‘£ã€å·¥å‚ç±»

ç”¨Mapé›†åˆæ¥å……å½“ç¼“å†²æ± ï¼Œå­˜æ”¾å¯¹è±¡ï¼Œå¹¶ä¸”æä¾›è·å–å¯¹è±¡çš„æ–¹æ³•ï¼Œä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿäº«å…ƒæ¨¡å¼çš„ä½œç”¨ï¼Œè¿˜æœ‰ä¸ªè·å–å¯¹è±¡æ± ä¸­å¯¹è±¡æ•°é‡ã€‚

    package com.lyd.demo.factory;
    import com.lyd.demo.flyweight.Library;
    import com.lyd.demo.flyweight.LibraryImpl;
    import java.util.HashMap;
    /**
     * @Author: lyd
     * @Description: å·¥å‚ç±»
     * @Date: 2022-09-01
     */
    public class LibraryFactory {
        // ç”¨é›†åˆæ¥å……å½“ç¼“å­˜æ± ï¼Œæš‚å­˜ä¹¦ç±
        private HashMap<String, LibraryImpl> pool = new HashMap<String, LibraryImpl>();
        // å¦‚æœæœ‰ä¹¦ç±å°±æ”¾å…¥ç¼“å­˜
        public Library getLibraryImpl(String name) {
            if (!pool.containsKey(name)) {
                // åˆ›å»ºä¸€ä¸ªæ”¾å…¥
                pool.put(name, new LibraryImpl(name));
            }
            return pool.get(name);
        }
        // è·å–ä¹¦ç±ä¸ªæ•°
        public int bookCount() {
            return pool.size();
        }
    }
    

### â‘¤ã€æµ‹è¯•

é€šè¿‡å·¥å‚ç±»è°ƒç”¨è·å¾—å¯¹è±¡ï¼Œå†å»è°ƒç”¨å€Ÿä¹¦æ–¹æ³•ï¼Œé‡‡ç”¨ä¸¤ç§ä¸ç”¨è§’è‰²å’Œä¸åŒæ•°æ®æ¥æ¼”ç»äº«å…ƒæ¨¡å¼çš„æ¡ˆä¾‹å®ç°ã€‚

    package com.lyd.demo.test;
    
    import com.lyd.demo.entity.User;
    import com.lyd.demo.factory.LibraryFactory;
    import com.lyd.demo.flyweight.Library;
    
    /**
     * @Author: lyd
     * @Description: æµ‹è¯•ç±»
     * @Date: 2022-09-01
     */
    public class FlyWeightTest {
        public static void main(String[] args) {
            // åˆ›å»ºå·¥å‚
            LibraryFactory libraryFactory = new LibraryFactory();
            Library book = libraryFactory.getLibraryImpl("Javaè®¾è®¡æ¨¡å¼");
            book.borrow(new User("æ€’æ”¾å§å¾·å¾·"));
    
            // å‡è®¾ä¹¦å·²ç»å½’è¿˜
    
            Library book2 = libraryFactory.getLibraryImpl("Javaè®¾è®¡æ¨¡å¼");
            book2.borrow(new User("æ„¤æ€’å§å¾·å¾·"));
    
            Library book3 = libraryFactory.getLibraryImpl("Goè¯­è¨€ç¼–ç¨‹");
            book3.borrow(new User("æ€’æ”¾å§å¾·å¾·"));
    
            System.out.println("ç°åœ¨æœ‰ä¹¦ï¼š" + libraryFactory.bookCount() + " æœ¬");
        }
    }
    

è¿è¡Œç»“æœï¼š  
![image](https://img2022.cnblogs.com/blog/1954113/202209/1954113-20220916130838730-1405105977.png)

å¥½æ–‡æ¨è
----

*   è®¾è®¡æ¨¡å¼ | äº«å…ƒæ¨¡å¼åŠå…¸å‹åº”ç”¨ æ˜é‡‘ [https://juejin.cn/post/6844903683860217864](https://juejin.cn/post/6844903683860217864)
*   ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹äº«å…ƒæ¨¡å¼ 51CTO [https://blog.51cto.com/chencoding/5592357](https://blog.51cto.com/chencoding/5592357)
*   äº«å…ƒæ¨¡å¼ ç®€ä¹¦ [https://www.jianshu.com/p/a2aa75939766](https://www.jianshu.com/p/a2aa75939766)
*   09ã€äº«å…ƒè®¾è®¡æ¨¡å¼ã€‘ CSDN [https://blog.csdn.net/Bb15070047748/article/details/126367998](https://blog.csdn.net/Bb15070047748/article/details/126367998)

ğŸ‘åˆ›ä½œä¸æ˜“ï¼Œå¯èƒ½æœ‰äº›è¯­è¨€ä¸æ˜¯å¾ˆé€šç•…ï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡æ­£ï¼Œæ„Ÿè°¢è§‚çœ‹ï¼è®°å¾—ä¸€é”®ä¸‰è¿å“¦ï¼ğŸ‘