---
layout: post
title: "10åˆ†é’Ÿåšå¥½ Bootstrap Blazor çš„è¡¨æ ¼ç»„ä»¶å¯¼å‡º Excel/Word/Html/Pdf"
date: "2023-01-11T18:24:20.555Z"
---
10åˆ†é’Ÿåšå¥½ Bootstrap Blazor çš„è¡¨æ ¼ç»„ä»¶å¯¼å‡º Excel/Word/Html/Pdf
===================================================

![10åˆ†é’Ÿåšå¥½ Bootstrap Blazor çš„è¡¨æ ¼ç»„ä»¶å¯¼å‡º Excel/Word/Html/Pdf](https://img2023.cnblogs.com/blog/1980213/202301/1980213-20230111192908772-651948659.png) æ‰‹æŠŠæ‰‹æ•™ä¼šè¡¨æ ¼ç»„ä»¶é€šç”¨å¿«é€Ÿå¯¼å‡º Excel/Word/Html/Pdf åŠŸèƒ½ (ä¸€è·¯CVå³å¯)

ä¸Šç¯‡: [Bootstrap Blazor å®æˆ˜ é€šç”¨å¯¼å…¥å¯¼å‡ºæœåŠ¡(Tableç»„ä»¶)](https://www.cnblogs.com/densen2014/p/16101931.html)

![](https://img2023.cnblogs.com/blog/1980213/202301/1980213-20230111192814418-771209531.png)

1.æ–°å»ºå·¥ç¨‹
------

æ–°å»ºå·¥ç¨‹b14table

    dotnet new blazorserver -o b14table
    

å°†é¡¹ç›®æ·»åŠ åˆ°è§£å†³æ–¹æ¡ˆä¸­ï¼š

    dotnet sln add b14table/b14table.csproj
    

ä½¿ç”¨ nuget.org è¿›è¡Œ BootstrapBlazor ç»„ä»¶å®‰è£…, FreeSql sqliteåº“,å­—ä½“ ..

    dotnet add b03sqlite package BootstrapBlazor
    dotnet add b03sqlite package BootstrapBlazor.FontAwesome
    dotnet add b03sqlite package FreeSql.Provider.Sqlite
    dotnet add b03sqlite Densen.Extensions.BootstrapBlazor
    dotnet add b03sqlite package Densen.FreeSql.Extensions.BootstrapBlazor
    dotnet add b03sqlite package Magicodes.IE.Core
    dotnet add b03sqlite package Magicodes.IE.Excel
    dotnet add b03sqlite package Magicodes.IE.Html
    dotnet add b03sqlite package Magicodes.IE.Pdf
    dotnet add b03sqlite package Magicodes.IE.Word
    dotnet add b03sqlite package HtmlToOpenXml.dll
    dotnet add b03sqlite package Haukcode.WkHtmlToPdfDotNet
    

2.æ ·å¼è¡¨å’ŒJavascript å¼•ç”¨
-------------------

å¢åŠ ä¸»é¢˜æ ·å¼è¡¨åˆ° `Pages/_Host.cshtml` æ–‡ä»¶ä¸­

åˆ é™¤ `<link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />`

å¹¶åœ¨ä¸‹é¢æ·»åŠ ä¸¤è¡Œ

    <link href="_content/BootstrapBlazor.FontAwesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="_content/BootstrapBlazor/css/bootstrap.blazor.bundle.min.css" rel="stylesheet">
    

æ·»åŠ  Javascript å¼•ç”¨åˆ° `Pages/_Layout.cshtml` æ–‡ä»¶ä¸­

åœ¨ `<script src="_framework/blazor.server.js"></script>` ä¹‹å‰æ·»åŠ 

    <script src="_content/BootstrapBlazor/js/bootstrap.blazor.bundle.min.js" asp-append-version="true"></script>
    

å®Œæ•´æ–‡ä»¶

    @page "/"
    @using Microsoft.AspNetCore.Components.Web
    @namespace b14table.Pages
    @addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
    
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <base href="~/" />
    
        <!-- åˆ æ‰è¿™è¡Œ <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" /> !-->
        <link href="css/site.css" rel="stylesheet" />
        
        <!-- æ·»åŠ ä¸‹é¢ä¸¤è¡Œ !-->
        <link href="_content/BootstrapBlazor.FontAwesome/css/font-awesome.min.css" rel="stylesheet">
        <link href="_content/BootstrapBlazor/css/bootstrap.blazor.bundle.min.css" rel="stylesheet">
        <!-- æ·»åŠ ä¸Šé¢ä¸¤è¡Œ !-->
    
        <link href="b14table.styles.css" rel="stylesheet" />
        <link rel="icon" type="image/png" href="favicon.png" />
        <component type="typeof(HeadOutlet)" render-mode="ServerPrerendered" />
    </head>
    <body>
        <component type="typeof(App)" render-mode="ServerPrerendered" />
    
        <div id="blazor-error-ui">
            <environment include="Staging,Production">
                An error has occurred. This application may no longer respond until reloaded.
            </environment>
            <environment include="Development">
                An unhandled exception has occurred. See browser dev tools for details.
            </environment>
            <a href="" class="reload">Reload</a>
            <a class="dismiss">ğŸ—™</a>
        </div>
    
        <!-- å¢åŠ è¿™è¡Œ !-->
        <script src="_content/BootstrapBlazor/js/bootstrap.blazor.bundle.min.js"></script>
    
        <script src="_framework/blazor.server.js"></script>
    </body>
    </html>
    

3.æ·»åŠ å¢åŠ å‘½åç©ºé—´å¼•ç”¨åˆ° `_Imports.razor` æ–‡ä»¶ä¸­
----------------------------------

å…¶ä¸­ AME.Services å’Œ Blazor100.Service å‘½åç©ºé—´ç¨åæ–‡ä»¶é‡Œç”¨åˆ°

    @using BootstrapBlazor.Components 
    @using AME.Services
    @using Blazor100.Service
    @using System.Diagnostics.CodeAnalysis
    

4.å¢åŠ  BootstrapBlazorRoot ç»„ä»¶åˆ° App.razor æ–‡ä»¶ä¸­
------------------------------------------

    <BootstrapBlazorRoot>
        <Router AppAssembly="@typeof(App).Assembly">
            ...
        </Router>
    </BootstrapBlazorRoot>
    

5.æ·»åŠ  BootstrapBlazoræœåŠ¡/ FreeSql æ•°æ®æœåŠ¡/ ImportExportsService å¯¼å‡ºæœåŠ¡ åˆ° `Program.cs` æ–‡ä»¶ä¸­
----------------------------------------------------------------------------------

åœ¨ `builder.Services.AddSingleton<WeatherForecastService>();` ååŠ å…¥

    
    builder.Services.AddFreeSql(option =>
    {
        option.UseConnectionString(FreeSql.DataType.Sqlite, "Data Source=test.db;")  //ä¹Ÿå¯ä»¥å†™åˆ°é…ç½®æ–‡ä»¶ä¸­
    #if DEBUG
             //å¼€å‘ç¯å¢ƒ:è‡ªåŠ¨åŒæ­¥å®ä½“
             .UseAutoSyncStructure(true)
             .UseNoneCommandParameter(true)
             //è°ƒè¯•sqlè¯­å¥è¾“å‡º
             .UseMonitorCommand(cmd => System.Console.WriteLine(cmd.CommandText))
    #endif
        ;
    });
    builder.Services.AddTransient<ImportExportsService>();
    //ä¸å†™è¿™å¥å› ä¸ºä¸‹é¢ä¸€å¥æ‰©å±•åŒ…å«äº† //builder.Services.AddBootstrapBlazor();
    builder.Services.AddDensenExtensions();
    

6\. å¯¼å‡ºæœåŠ¡ Service/ImportExportsService.cs
----------------------------------------

    ï»¿using BootstrapBlazor.Components;
    using Magicodes.ExporterAndImporter.Core;
    using Magicodes.ExporterAndImporter.Excel;
    using Magicodes.ExporterAndImporter.Html;
    using Magicodes.ExporterAndImporter.Pdf;
    using Magicodes.ExporterAndImporter.Word;
    
    namespace Blazor100.Service
    {
        /// <summary>
        /// é€šç”¨å¯¼å…¥å¯¼å‡ºæœåŠ¡ç±»
        /// </summary>
        public class ImportExportsService
        {
            public enum ExportType
            {
                Excel,
                Pdf,
                Word,
                Html
            }
    
            public async Task<string> Export<T>(string filePath, List<T>? items = null, ExportType exportType = ExportType.Excel) where T : class, new()
            {
                switch (exportType)
                {
                    case ExportType.Pdf:
                        var exporterPdf = new PdfExporter();
                        items = items ?? new List<T>();
                        var resultPdf = await exporterPdf.ExportListByTemplate(filePath + ".pdf", items);
                        return resultPdf.FileName;
                    case ExportType.Word:
                        var exporterWord = new WordExporter();
                        items = items ?? new List<T>();
                        var resultWord = await exporterWord.ExportListByTemplate(filePath + ".docx", items);
                        return resultWord.FileName;
                    case ExportType.Html:
                        var exporterHtml = new HtmlExporter();
                        items = items ?? new List<T>();
                        var resultHtml = await exporterHtml.ExportListByTemplate(filePath + ".html", items);
                        return resultHtml.FileName;
                    default:
                        IExporter exporter = new ExcelExporter();
                        items = items ?? new List<T>();
                        var result = await exporter.Export(filePath + ".xlsx", items);
                        return result.FileName;
                }
            }
    
            public async Task<(IEnumerable<T>? items,string error)> ImportFormExcel<T>(string filePath) where T : class, new()
            {
                IExcelImporter Importer = new ExcelImporter();
                var import = await Importer.Import<T>(filePath);
                if (import.Data == null ) 
                {
                    return (null, import.Exception.Message);
                }
                return (import.Data!.ToList(),""); 
            }
     
        }
    }
    
    

7\. æ•°æ®å®ä½“ç±» Data/WeatherForecast.cs
---------------------------------

    using BootstrapBlazor.Components;
    using FreeSql.DataAnnotations;
    using Magicodes.ExporterAndImporter.Excel;
    using OfficeOpenXml.Table;
    using System.ComponentModel;
    
    namespace b14table.Data;
    
    [ExcelImporter(IsLabelingError = true)]
    [ExcelExporter(Name = "å¯¼å…¥å•†å“ä¸­é—´è¡¨", TableStyle = TableStyles.Light10, AutoFitAllColumn = true)]
    [AutoGenerateClass(Searchable = true, Filterable = true, Sortable = true)]
    public class WeatherForecast
    {
        [Column(IsIdentity = true)]
        [DisplayName("åºå·")]
        public int ID { get; set; }
    
        [DisplayName("æ—¥æœŸ")]
        public DateTime Date { get; set; }
    
        public int TemperatureC { get; set; }
    
        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
    
        public string? Summary { get; set; }
    }
    
    

8\. ç•Œé¢å’Œä»£ç  Pages/Index.razor
---------------------------

    @page "/"
    @using b14table.Data
    <PageTitle>Index</PageTitle>
    
    <Tab>
        <TabItem Text="å¯¼å…¥å¯¼å‡º">
            <ImpExpII />
        </TabItem> 
        <TabItem Text="æ•°æ®ç»´æŠ¤">
            <Table TItem="WeatherForecast"
                   IsPagination="true"
                   IsStriped="true"
                   IsBordered="true"
                   AutoGenerateColumns="true"
                   ShowSearch="true"
                   ShowToolbar="true"
                   ShowExtendButtons="true"
                   DoubleClickToEdit=true
                   ShowColumnList=true
                   ShowCardView=true>
            </Table>
    
            @code{
                // ç”±äºä½¿ç”¨äº†FreeSql ORM æ•°æ®æœåŠ¡,å¯ä»¥ç›´æ¥å–å¯¹è±¡
                [Inject] IFreeSql? fsql { get; set; }
                [Inject] ToastService? toastService { get; set; }
    
                //ç”¨æ¼”ç¤ºæœåŠ¡çš„æ•°æ®åˆå§‹åŒ–æ•°æ®åº“
                [Inject] WeatherForecastService? ForecastService { get; set; }
                protected override async Task OnAfterRenderAsync(bool firstRender)
                {
                    if (firstRender)
                    {
                        //æ‡’çš„äºº,ç›´æ¥åˆå§‹åŒ–ä¸€äº›æ•°æ®ç”¨ç”¨
                        var res = fsql!.Select<WeatherForecast>().Count();
                        if (res == 0)
                        {
                            var forecasts = (await ForecastService!.GetForecastAsync(DateTime.Now)).ToList();
                            fsql.Insert<WeatherForecast>().AppendData(forecasts).ExecuteAffrows();
                        }
                    }
                }
    
    
            }
    
        </TabItem>
    </Tab>
    

9\. ç•Œé¢å’Œä»£ç  Pages/ImpExpII.razor
------------------------------

    ï»¿@page "/impexpii"
    @using b14table.Data
    @using static Blazor100.Service.ImportExportsService
    
    <PageTitle>å¯¼å…¥å¯¼å‡ºII</PageTitle>
    
    <InputFile OnChange="OnChange" style="max-width:400px" class="form-control"  />
    <br/>
    
    <Table @ref="list1"
           TItem="WeatherForecast"
           IsPagination="true"
           IsStriped="true"
           IsBordered="true"
           AutoGenerateColumns="true"
           ShowSearch="true"
           ShowToolbar="true"
           ShowExtendButtons="true"
           DataService="LazyHeroDataService"
           OnSaveAsync="LazyHeroDataService!.SaveAsync"
           OnDeleteAsync="LazyHeroDataService.DeleteAsync"
           DoubleClickToEdit="@DoubleClickToEdit"
           IsExcel="@IsExcel"
           ScrollingDialogContent="true"
           EditDialogIsDraggable="true"
           EditDialogSize="Size.ExtraLarge"
           EditDialogShowMaximizeButton="true"
           ShowExportButton
           OnExportAsync="ExportAsync"
           PageItemsSource="new int[] {5, 20, 50, 100, 200, 500, 1000 }">
    
        <TableToolbarTemplate>
            <TableToolbarButton TItem="WeatherForecast" Color="Color.Primary" Text="è‡ªç”±ç¼–è¾‘" OnClick="@IsExcelToggle" />
            <TableToolbarButton TItem="WeatherForecast" Color="Color.Warning" Text="éšæœºæ•°æ®" IsAsync OnClick="@GetDatasAsync" />
            <TableToolbarButton TItem="WeatherForecast" Color="Color.Secondary" Text="å¯¼å…¥" IsAsync OnClick="@ImportExcel" />
            <TableToolbarButton TItem="WeatherForecast" Color="Color.Danger" Text="æ¸…ç©º" IsAsync OnClick="EmptyAll" />
            <TableToolbarButton TItem="WeatherForecast" Color="Color.Success" Text="æ¨¡æ¿" IsAsync OnClick="Exportæ¨¡æ¿Async" />
        </TableToolbarTemplate>
    
        <ExportButtonDropdownTemplate>
            <h6 class="dropdown-header">å½“å‰é¡µæ•°æ®</h6>
            <div class="dropdown-item" @onclick="_=>ExportExcelAsync(list1.Rows)">
                <i class="fas fa-file-excel"></i>
                <span>Excel</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportWordAsync(list1.Rows)">
                <i class="fas fa-file-word"></i>
                <span>Word</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportHtmlAsync(list1.Rows)">
                <i class="fa-brands fa-html5"></i>
                <span>Html</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportPDFAsync(list1.Rows)">
                <i class="fas fa-file-pdf"></i>
                <span>PDF</span>
            </div>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">å…¨éƒ¨æ•°æ®</h6>
            <div class="dropdown-item" @onclick="_=>ExportExcelAsync(LazyHeroDataService!.Items)">
                <i class="fas fa-file-excel"></i>
                <span>Excel</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportWordAsync(LazyHeroDataService!.Items)">
                <i class="fas fa-file-word"></i>
                <span>Word</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportHtmlAsync(LazyHeroDataService!.Items)">
                <i class="fa-brands fa-html5"></i>
                <span>Html</span>
            </div>
            <div class="dropdown-item" @onclick="_=>ExportPDFAsync(LazyHeroDataService!.Items)">
                <i class="fas fa-file-pdf"></i>
                <span>PDF</span>
            </div>
        </ExportButtonDropdownTemplate>
    </Table>
    
    @code{
        [Inject]
        Microsoft.AspNetCore.Hosting.IWebHostEnvironment? HostEnvironment { get; set; }
    
        [Inject]
        [NotNull]
        NavigationManager? NavigationManager { get; set; }
    
        [Inject]
        [NotNull]
        ImportExportsService? ImportExportsService { get; set; }
    
        [Inject]
        [NotNull]
        ToastService? ToastService { get; set; }
    
        [Inject]
        WeatherForecastService? ForecastService { get; set; }
    
        [Inject]
        [NotNull]
        LazyHeroDataService<WeatherForecast>? LazyHeroDataService { get; set; }
    
        [NotNull]
        Table<WeatherForecast>? list1 { get; set; }
    
        public bool IsExcel { get; set; }
        public bool DoubleClickToEdit { get; set; } = true;
        protected string UploadPath = "";
        protected string? uploadstatus;
        long maxFileSize = 1024 * 1024 * 15;
        string? tempfilename;
    
    
        protected async Task GetDatasAsync()
        {
            LazyHeroDataService!.Items = (await ForecastService!.GetForecastAsync(DateTime.Now)).ToList();
            await list1!.QueryAsync();
        }
    
        protected override async void OnAfterRender(bool firstRender)
        {
            if (firstRender)
            {
                UploadPath = Path.Combine(HostEnvironment!.WebRootPath, "uploads");
                if (!Directory.Exists(UploadPath)) Directory.CreateDirectory(UploadPath);
                await GetDatasAsync();
            }
        }
    
        private Task IsExcelToggle()
        {
            IsExcel = !IsExcel;
            DoubleClickToEdit = !IsExcel;
            StateHasChanged();
            return Task.CompletedTask;
        }
    
        public async Task<bool> Exportæ¨¡æ¿Async()
        {
            await Export();
            return true;
        } 
    
        private async Task<bool> ExportExcelAsync(IEnumerable<WeatherForecast> items) => await ExportAutoAsync(items, ExportType.Excel);
        private async Task<bool> ExportPDFAsync(IEnumerable<WeatherForecast> items) => await ExportAutoAsync(items, ExportType.Pdf);
        private async Task<bool> ExportWordAsync(IEnumerable<WeatherForecast> items) => await ExportAutoAsync(items, ExportType.Word);
        private async Task<bool> ExportHtmlAsync(IEnumerable<WeatherForecast> items) => await ExportAutoAsync(items, ExportType.Html);
    
        private async Task<bool> ExportAutoAsync(IEnumerable<WeatherForecast> items, ExportType exportType = ExportType.Excel)
        {
            if ((items == null || !items.Any()) && (LazyHeroDataService!.Items == null || !LazyHeroDataService!.Items.Any()))
            {
                await ToastService.Error("æç¤º", "æ— æ•°æ®å¯å¯¼å‡º");
                return false;
            }
            var option = new ToastOption()
            {
                Category = ToastCategory.Information,
                Title = "æç¤º",
                Content = $"å¯¼å‡ºæ­£åœ¨æ‰§è¡Œ,è¯·ç¨ç­‰ç‰‡åˆ»...",
                IsAutoHide = false
            };
            // å¼¹å‡º Toast
            await ToastService.Show(option);
            await Task.Delay(100);
    
    
            // å¼€å¯åå°è¿›ç¨‹è¿›è¡Œæ•°æ®å¤„ç†
            await Export(items?.ToList(), exportType);
    
            // å…³é—­ option ç›¸å…³è”çš„å¼¹çª—
            option.Close();
    
            // å¼¹çª—å‘ŠçŸ¥ä¸‹è½½å®Œæ¯•
            await ToastService.Show(new ToastOption()
            {
                Category = ToastCategory.Success,
                Title = "æç¤º",
                Content = $"å¯¼å‡ºæˆåŠŸ,è¯·æ£€æŸ¥æ•°æ®",
                IsAutoHide = false
            });
            return true;
    
        }
    
        private async Task Export(List<WeatherForecast>? items=null, ExportType exportType = ExportType.Excel)
        {
            try
            {
                if (items==null || !items.Any()) items = LazyHeroDataService!.Items;
                var fileName = items == null ? "æ¨¡æ¿" : typeof(WeatherForecast).Name;
                var fullName = Path.Combine(UploadPath, fileName);
                fullName = await ImportExportsService.Export(fullName, items, exportType);
                fileName = (new System.IO.FileInfo(fullName)).Name;
                ToastService?.Success("æç¤º", fileName + "å·²ç”Ÿæˆ");
    
                //ä¸‹è½½åæ¸…é™¤æ–‡ä»¶
                NavigationManager.NavigateTo($"uploads/{fileName}", true);
                _ = Task.Run(() =>
                {
                    Thread.Sleep(50000);
                    System.IO.File.Delete(fullName);
                });
    
            }
            catch (Exception e)
            {
                ToastService?.Error($"å¯¼å‡º", $"{exportType}å‡ºé”™,è¯·æ£€æŸ¥. {e.Message}");
            }
        }
    
        public async Task<bool> EmptyAll()
        {
            LazyHeroDataService!.Items = new List<WeatherForecast>();
            await ToastService!.Show(new ToastOption()
            {
                Category = ToastCategory.Success,
                Title = "æç¤º",
                Content = "å·²æ¸…ç©ºæ•°æ®",
            });
    
            await list1!.QueryAsync();
            return true;
        }
        private async Task ImportExcel()
        {
            if (string.IsNullOrEmpty(tempfilename))
            {
                ToastService?.Error("æç¤º", "è¯·æ­£ç¡®é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ");
                return;
            }
            var option = new ToastOption()
            {
                Category = ToastCategory.Information,
                Title = "æç¤º",
                Content = "å¯¼å…¥æ–‡ä»¶ä¸­,è¯·ç¨ç­‰ç‰‡åˆ»...",
                IsAutoHide = false
            };
            // å¼¹å‡º Toast
            await ToastService!.Show(option);
            await Task.Delay(100);
    
    
            // å¼€å¯åå°è¿›ç¨‹è¿›è¡Œæ•°æ®å¤„ç†
            var isSuccess= await MockImportExcel();
    
            // å…³é—­ option ç›¸å…³è”çš„å¼¹çª—
            option.Close();
    
            // å¼¹çª—å‘ŠçŸ¥ä¸‹è½½å®Œæ¯•
            await ToastService.Show(new ToastOption()
            {
                Category = isSuccess? ToastCategory.Success : ToastCategory.Error,
                Title = "æç¤º",
                Content = isSuccess ? "æ“ä½œæˆåŠŸ,è¯·æ£€æŸ¥æ•°æ®":"å‡ºç°é”™è¯¯,è¯·é‡è¯•å¯¼å…¥æˆ–è€…ä¸Šä¼ ",
                IsAutoHide = false
            });
    
            await list1!.QueryAsync();
        }
        private async Task<bool> MockImportExcel()
        {
            var items_temp = await ImportExportsService!.ImportFormExcel<WeatherForecast>(tempfilename!);
            if (items_temp.items == null)
            {
                ToastService?.Error("æç¤º", "æ–‡ä»¶å¯¼å…¥å¤±è´¥: "+ items_temp.error);
                return false;
            }
            //items = SmartCombine(items_temp, items).ToList(); æ–°æ•°æ®å’Œè€æ•°æ®åˆå¹¶å¤„ç†,ç•¥100å­—
            LazyHeroDataService!.Items = items_temp!.items.ToList();
            return true;
        }
    
        protected async Task OnChange(InputFileChangeEventArgs e)
        {
            if (e.File == null) return;
            tempfilename = Path.Combine(UploadPath, e.File.Name);
            await using FileStream fs = new(tempfilename, FileMode.Create);
            using var stream = e.File.OpenReadStream(maxFileSize);
            await stream.CopyToAsync(fs);
    
            //æ­£å¼å·¥ç¨‹æ­¤å¤„æ˜¯å›è°ƒ,ç®€åŒ–ç‰ˆå¿…é¡»InvokeAsyncä¸€ä¸‹,è‡ªç”±å‘æŒ¥
            _ = Task.Run(async () => await InvokeAsync(async () => await ImportExcel()));
    
        }
    
        /// <summary>
        /// å¯¼å‡ºæ•°æ®æ–¹æ³•
        /// </summary>
        /// <param name="Items"></param>
        /// <param name="opt"></param>
        /// <returns></returns>
        protected async Task<bool> ExportAsync(IEnumerable<WeatherForecast> Items, QueryPageOptions opt)
        {
            var ret = false;
            ret = await ExportExcelAsync(Items);
            return ret;
        }
    
    
    }
    
    

#### é¡¹ç›®æºç 

[Github](https://github.com/densen2014/Blazor100) | [Gitee](https://gitee.com/densen2014/Blazor100)

#### å…³è”é¡¹ç›®

FreeSql QQç¾¤ï¼š4336577(å·²æ»¡)ã€8578575(å·²æ»¡)ã€52508226(åœ¨çº¿)

BA & Blazor QQç¾¤ï¼š795206915ã€675147445

#### çŸ¥è¯†å…±äº«è®¸å¯åè®®

æœ¬ä½œå“é‡‡ç”¨ [çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®](https://creativecommons.org/licenses/by-nc-sa/4.0/) è¿›è¡Œè®¸å¯ã€‚æ¬¢è¿è½¬è½½ã€ä½¿ç”¨ã€é‡æ–°å‘å¸ƒï¼Œä½†åŠ¡å¿…ä¿ç•™æ–‡ç« ç½²åAlexChowï¼ˆåŒ…å«é“¾æ¥ï¼š [https://github.com/densen2014](https://github.com/densen2014) ï¼‰ï¼Œä¸å¾—ç”¨äºå•†ä¸šç›®çš„ï¼ŒåŸºäºæœ¬æ–‡ä¿®æ”¹åçš„ä½œå“åŠ¡å¿…ä»¥ç›¸åŒçš„è®¸å¯å‘å¸ƒã€‚å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·[ä¸æˆ‘è”ç³»](zhouchuanglin@gmail.com) ã€‚

#### AlexChow

[ä»Šæ—¥å¤´æ¡](https://www.toutiao.com/c/user/token/MS4wLjABAAAAGMBzlmgJx0rytwH08AEEY8F0wIVXB2soJXXdUP3ohAE/?) | [åšå®¢å›­](https://www.cnblogs.com/densen2014) | [çŸ¥ä¹](https://www.zhihu.com/people/alex-chow-54) | [Gitee](https://gitee.com/densen2014) | [GitHub](https://github.com/densen2014)

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼šå‘¨åˆ›ç³ [AlexChow](https://www.cnblogs.com/densen2014/)ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/densen2014/p/17044736.html](https://www.cnblogs.com/densen2014/p/17044736.html)