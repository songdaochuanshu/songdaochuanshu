---
layout: post
title: "å…¨æ¸ é“å®šä»·ã€åº“å­˜å†³ç­–ï¼Œæ··åˆæ•´æ•°è§„åˆ’å»ºæ¨¡æ±‚è§£ï¼ŒMNLé€‰æ‹©æ¨¡åž‹ï¼Œå†…é™„ä»£ç ï¼"
date: "2023-03-30T01:10:18.860Z"
---
å…¨æ¸ é“å®šä»·ã€åº“å­˜å†³ç­–ï¼Œæ··åˆæ•´æ•°è§„åˆ’å»ºæ¨¡æ±‚è§£ï¼ŒMNLé€‰æ‹©æ¨¡åž‹ï¼Œå†…é™„ä»£ç ï¼
===================================

![å…¨æ¸ é“å®šä»·ã€åº“å­˜å†³ç­–ï¼Œæ··åˆæ•´æ•°è§„åˆ’å»ºæ¨¡æ±‚è§£ï¼ŒMNLé€‰æ‹©æ¨¡åž‹ï¼Œå†…é™„ä»£ç ï¼](https://img2023.cnblogs.com/blog/2744125/202303/2744125-20230329212919414-110423560.png) æ•²æ•²æ•²è¯¦ç»†çš„é«˜åˆ†ç‰›åˆŠè®ºæ–‡é˜…è¯»ç¬”è®°ï¼Œè¿˜æœ‰Pythonçš„PyLogitåŒ…è¯¦è§£ï¼å…¨æ¸ é“ã€è¿ç­¹è§„åˆ’é¢†åŸŸå…¥é—¨/åŸºç¡€æ¨¡åž‹ï¼Œå¯æä¾›å†™ä½œçµæ„Ÿï¼Œå†…é™„è®ºæ–‡çš„ä¸»è¦å†…å®¹ç¿»è¯‘è§£è¯»ã€æ¨¡åž‹è®²è§£å’Œä»£ç å®žçŽ°ï¼

0\. å†™åœ¨å‰é¢
========

ðŸ‚åˆŠè®ºæ–‡ï¼æ¨¡åž‹ç®€å•ï¼Œä»£ç å®žçŽ°æ›´ç®€å•ï¼Œå¢™è£‚æŽ¨èï¼å¯ä¸ºè¿ç­¹å»ºæ¨¡æä¾›å‚è€ƒï¼Œä¹Ÿå¯ä½œä¸ºå…¨æ¸ é“é›¶å”®ç ”ç©¶çš„å…¥é—¨èµ„æ–™ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ð· å…¨æ–‡æœ‰ç‚¹é•¿ï¼Œå‰é¢å…ˆæ”¾ä¸€ä¸ªåšæ–‡ç»“æž„å’Œæ¶‰åŠå†…å®¹ï¼š

*   ç¬¬ä¸€éƒ¨åˆ†ä¸ºæ–‡ç« ä¿¡æ¯ï¼Œä¸»è¦ä»‹ç»äº†è¿™ç¯‡è®ºæ–‡çš„åŸºæœ¬ä¿¡æ¯ã€å‘è¡¨æ—¶é—´ã€ç ”ç©¶æ–¹å‘ï¼Œä»¥åŠå¯¹è®ºæ–‡éš¾åº¦çš„è¯„ä»·ã€‚
    
*   ç¬¬äºŒéƒ¨åˆ†ä¸ºä¸»è¦å†…å®¹ï¼Œä»‹ç»äº†è®ºæ–‡å†…å®¹ï¼Œå¸®åŠ©è¯»è€…å¿«é€Ÿäº†è§£è®ºæ–‡ã€‚
    
*   ç¬¬ä¸‰éƒ¨åˆ†ä¸ºæ¨¡åž‹æž„å»ºï¼Œå¯¹æ–‡ç« ä¸­æ‰€æ¶‰åŠçš„æ¨¡åž‹è¿›è¡Œäº†è¯¦ç»†è§£é‡Šã€‚
    
*   ç¬¬å››éƒ¨åˆ†ä¸ºä»£ç æ±‚è§£ï¼Œä»‹ç»äº†æ–‡ç« çš„æ±‚è§£æ–¹æ³•ï¼ŒåŒæ—¶é™„åŠ äº†Pythonçš„PyLogitåº“çš„è¯¦è§£ï¼Œä»¥åŠæˆ‘å°è¯•ç”¨PyLogitåŒ…åŽ»æ±‚è§£è®ºæ–‡ä¸­MNLæ¨¡åž‹çš„ä»£ç ã€‚
    

1\. æ–‡ç« ä¿¡æ¯
========

*   **åŸºæœ¬ä¿¡æ¯**
    
    ï¼ˆ1ï¼‰å‘è¡¨æœŸåˆŠï¼šTransportation Research Part Eï¼ˆ10.047/Q1ï¼Œè¿è¾“é¢†åŸŸçš„good goodåˆŠ à«® Â´Íˆ á—œ \`Íˆ áƒâ™¡ï¼‰
    
    ï¼ˆ2ï¼‰æ ‡é¢˜ï¼šFulfillment and pricing optimization for omni-channel retailers considering shipment of in-store demandï¼ˆä¸ºè€ƒè™‘åº—å†…éœ€æ±‚å‘è´§çš„å…¨æ¸ é“é›¶å”®å•†æä¾›å±¥è¡Œå’Œå®šä»·ä¼˜åŒ–ï¼‰
    
    ï¼ˆ3ï¼‰ä½œè€…/å‘è¡¨æ—¶é—´ï¼šKhosro Pichka, Layth C. Alwan\*, Xiaohang Yue / November 2022
    
    ï¼ˆ4ï¼‰ç ”ç©¶æ–¹å‘ï¼šè¿ç­¹å­¦ï¼Œå…¨æ¸ é“ç‰©æµï¼Œå®šä»·ï¼Œåº“å­˜ï¼ŒMNLï¼Œæ··åˆæ•´æ•°è§„åˆ’
    
*   **éš¾åº¦è¯„ä»·**
    
    ï¼ˆ1ï¼‰æ¨¡åž‹éš¾åº¦ï¼šâ˜…â˜…â˜…â˜†â˜†
    
    ï¼ˆ2ï¼‰ç¼–ç¨‹éš¾åº¦ï¼šâ˜…â˜†â˜†â˜†â˜†
    
    ï¼ˆ3ï¼‰è¯„ä»·ï¼šé€‚åˆç”¨äºŽå…¥é—¨å…¨æ¸ é“ç‰©æµ/è¿ç­¹è°ƒåº¦ï¼Œæ¨¡åž‹è¾ƒä¸ºåŸºç¡€ï¼Œä½†åˆå› ä¸ºå®ƒå¾ˆåŸºç¡€ï¼Œæ‰€ä»¥èƒ½ç»™è¯»è€…å¸¦æ¥å¾ˆå¤šçµæ„Ÿå’Œå¯å‘ã€‚è¿™ç¯‡æ–‡ç« ä¹ä¸€çœ‹å¾ˆéš¾ï¼Œç”šè‡³é™„å½•éƒ¨åˆ†è¿˜å°†æ­£æ–‡è¿ç­¹æ¨¡åž‹çš„çº¦æŸæ¡ä»¶åŒ–ä¸ºäº†80å¤šæ¡ã€‚ä½†æ–‡ä¸­çš„éžçº¿æ€§è¿ç­¹æ¨¡åž‹ï¼Œæœ€åŽå®žé™…ä¸ŠåŒ–ä¸ºäº†çº¿æ€§è§„åˆ’æ¨¡åž‹ï¼Œä½œè€…ç›´æŽ¥ç”¨äº†Cplexæ±‚è§£ï¼›å…¶ä»–éœ€è¦ç¼–ç¨‹çš„éƒ¨åˆ†ï¼Œä½œè€…ç”šè‡³ç›´æŽ¥importäº†pythonçš„åŒ…åŽ»è§£å†³ à«®â‚ Ë™ÐžË™â‚Žáƒ
    

2\. ä¸»è¦å†…å®¹
========

2.1 æ‘˜è¦ã€å…³é”®å­—ï¼ˆç¿»è¯‘ç‰ˆï¼‰
---------------

**æ‘˜è¦ï¼š** å…¨æ¸ é“é›¶å”®å•†é€šè¿‡ç”µå­å•†åŠ¡æ¸ é“å’Œä¸åŒåŒºåŸŸçš„å®žä½“å•†åº—æ»¡è¶³å„åœ°å®¢æˆ·çš„éœ€æ±‚ã€‚ä»–ä»¬ä¸ä»…å¯ä»¥é€šè¿‡ç”µå­å±¥è¡Œä¸­å¿ƒæ¥æ»¡è¶³ä»–ä»¬çš„çº¿ä¸Šè®¢å•ï¼Œè¿˜å¯ä»¥é€šè¿‡å®žä½“åº—çš„åº—å†…åº“å­˜æ¥æ»¡è¶³çº¿ä¸Šè®¢å•ã€‚å¦ä¸€æ–¹é¢ï¼Œé›¶å”®å•†å¯ä»¥ä½¿ç”¨å®šä»·å†³ç­–æ¥æŽ§åˆ¶çº¿ä¸Šã€å®žä½“æ¸ é“çš„éœ€æ±‚ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡å¤šé¡¹å¼ logit(MNL)é€‰æ‹©æ¨¡åž‹ï¼Œå¯¹å®¢æˆ·éœ€æ±‚è¿›è¡Œå»ºæ¨¡ã€‚ç„¶åŽï¼Œæˆ‘ä»¬æå‡ºäº†ä¸¤ä¸ªæ··åˆæ•´æ•°éžçº¿æ€§è§„åˆ’ï¼ˆMINLPï¼‰æ¨¡åž‹ï¼Œé€šè¿‡è€ƒè™‘å±¥è¡Œå’Œå®šä»·å†³ç­–æ¥æœ€å¤§åŒ–æ€»åˆ©æ¶¦ã€‚æˆ‘ä»¬å‡è®¾ï¼Œå¦‚æžœå•†åº—åº“å­˜ä¸è¶³ï¼Œç”µå­å±¥è¡Œä¸­å¿ƒçš„åº“å­˜ä¹Ÿå¯ä»¥ç”¨ä½œåº—å†…è®¢å•çš„å¤‡ç”¨åº“å­˜ï¼Œä½†ä»…é€‚ç”¨äºŽåŒä¸€åŒºåŸŸä¸­çš„å•†åº—ã€‚æˆ‘ä»¬è¿˜å‡è®¾åˆå§‹åº“å­˜æœ‰é™ï¼Œå¹¶ä¸”åœ¨æœ‰é™çš„é”€å”®èŒƒå›´å†…æ²¡æœ‰è¡¥è´§ã€‚åœ¨ç¬¬äºŒä¸ª MINLP æ¨¡åž‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å…è®¸å¤šç§è¿è¾“é€‰é¡¹å’Œåº“å­˜å†³ç­–ã€‚é€šè¿‡æ•°å€¼å®žéªŒï¼Œæˆ‘ä»¬è¡¨æ˜Žå…¨æ¸ é“é›¶å”®å•†å¯ä»¥é€šè¿‡æŽ§åˆ¶åˆå§‹åº“å­˜åˆ†é…å¹¶é€šè¿‡ç”µå­å±¥è¡Œåº“å­˜æ»¡è¶³åº—å†…éœ€æ±‚æ¥å¢žåŠ åˆ©æ¶¦ã€‚

**å…³é”®å­—ï¼šå…¨æ¸ é“é›¶å”®ï¼›è·¨æ¸ é“å±¥è¡Œï¼›å®šä»·ï¼›æ•´æ•°è§„åˆ’ç¼–ç¨‹**

2.2 ç ”ç©¶æ€è·¯
--------

*   **å…¨æ¸ é“å±¥è¡Œæ–¹å¼**
    
    è¯·ç»“åˆä¸‹å›¾ä¸€èµ·é£Ÿç”¨ï¼š
    

![](https://img2023.cnblogs.com/blog/2744125/202303/2744125-20230329210706092-1678976569.png)

ï¼ˆ1ï¼‰æ¯ä¸ªåŒºåŸŸéƒ½æœ‰å„è‡ªçš„ç”µå­å±¥è¡Œåº“å­˜å’Œé—¨åº—åº“å­˜ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰å„è‡ªçš„å®žä½“åº—åŠå®žä½“åº—é¡¾å®¢ï¼ŒåŠé€šè¿‡çº¿ä¸Šæ¸ é“è´­ä¹°å•†å“çš„çº¿ä¸Šé¡¾å®¢ã€‚

ï¼ˆ2ï¼‰å¯¹äºŽåŒä¸€åœ°åŒºï¼Œç”µå­å±¥è¡Œåº“å­˜å¯æ»¡è¶³è¯¥åœ°åŒºçº¿ä¸Šé¡¾å®¢çš„éœ€æ±‚ï¼Œé—¨åº—åº“å­˜å¯æ»¡è¶³è¯¥åœ°åŒºå®žä½“åº—é¡¾å®¢çš„éœ€æ±‚ã€‚å½“å‡ºçŽ°ç¼ºè´§æƒ…å†µæ—¶ï¼Œç”µå­å±¥è¡Œåº“å­˜å’Œé—¨åº—åº“å­˜å¯äº’è¡¥ï¼Œä½†å±¥è¡Œæˆæœ¬ä¼šå‘ç”Ÿå˜åŒ–ã€‚

ï¼ˆ3ï¼‰å¯¹äºŽä¸åŒåœ°åŒºï¼Œå½“ç”µå­å±¥è¡Œåº“å­˜å‘ç”Ÿç¼ºè´§æ—¶ï¼Œå¯ä½¿ç”¨å¦ä¸€åœ°åŒºçš„ç”µå­å±¥è¡Œåº“å­˜æ»¡è¶³çº¿ä¸Šé¡¾å®¢çš„éœ€æ±‚ã€‚å¯¹äºŽå®žä½“åº—é¡¾å®¢çš„éœ€æ±‚ï¼Œä¸èƒ½é€šè¿‡è·¨åŒºåŸŸè°ƒåº¦ç”µå­å±¥è¡Œåº“å­˜æ¥æ»¡è¶³ï¼›å¯¹äºŽé—¨åº—åº“å­˜ï¼Œä¸èƒ½è·¨åŒºåŸŸè°ƒåº¦ä»¥æ»¡è¶³å…¶ä»–åŒºåŸŸçš„çº¿ä¸Šæˆ–çº¿ä¸‹é¡¾å®¢éœ€æ±‚ã€‚

*   æ–‡ç« çš„ç ”ç©¶æ€è·¯
    
    ï¼ˆ1ï¼‰åˆ©ç”¨å¤šé¡¹å¼logit(MNL)é€‰æ‹©æ¨¡åž‹ï¼Œå¯¹å®¢æˆ·éœ€æ±‚è¿›è¡Œå»ºæ¨¡ï¼Œä»Žè€Œ**é¢„ä¼°éœ€æ±‚é‡**ã€‚
    
    ï¼ˆ2ï¼‰åœ¨å¾—åˆ°å®¢æˆ·éœ€æ±‚é‡çš„åŸºç¡€ä¸Šï¼Œç¬¬ä¸€ä¸ªæ¨¡åž‹ä»¥**æœ€å¤§åŒ–æ€»åˆ©æ¶¦ä¸ºç›®æ ‡**ï¼Œè€ƒè™‘å±¥è¡Œå’Œå®šä»·å†³ç­–ã€‚ç”±äºŽå¯¹åº“å­˜æ˜¯çŸ­æœŸè®¡åˆ’ï¼Œæ•…è¯¥æ¨¡åž‹ä¸è€ƒè™‘åº“å­˜æŒæœ‰æˆæœ¬ã€‚
    
    ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªæ¨¡åž‹åœ¨ä¸Šä¸€ä¸ªæ¨¡åž‹çš„åŸºç¡€ä¸Šè¿›è¡Œæ‹“å±•ï¼Œå¯¹äºŽåº“å­˜ï¼ŒåŠ å…¥å¯¹åº“å­˜æŒæœ‰æˆæœ¬çš„è€ƒè™‘ï¼›å¯¹äºŽçº¿ä¸Šæ¸ é“å±¥è¡Œæ–¹å¼ï¼Œä¸ºå®¢æˆ·å¢žåŠ **å¸¸è§„è¿è¾“å’Œæ¬¡æ—¥è¾¾**çš„é…é€é€‰é¡¹ã€‚æ¨¡åž‹åœ¨å¢žåŠ ä¸Šè¿°å› ç´ åŽï¼Œä»ä»¥æœ€å¤§åŒ–æ€»åˆ©æ¶¦ä¸ºç›®æ ‡ï¼Œè€ƒè™‘å±¥è¡ŒåŠå®šä»·å†³ç­–ã€‚
    
    ï¼ˆ4ï¼‰æ–‡ç« æœ€åŽé€šè¿‡æ•°å€¼å®žéªŒï¼Œè¡¨æ˜Žå…¨æ¸ é“é›¶å”®å•†å¯ä»¥é€šè¿‡æŽ§åˆ¶åˆå§‹åº“å­˜åˆ†é…å¹¶é€šè¿‡ç”µå­å±¥è¡Œåº“å­˜æ»¡è¶³åº—å†…éœ€æ±‚æ¥å¢žåŠ åˆ©æ¶¦ã€‚
    

3\. æ¨¡åž‹å»ºç«‹
========

3.1 MNLé€‰æ‹©æ¨¡åž‹çš„å»ºç«‹
--------------

æ–‡ä¸­MNLé€‰æ‹©æ¨¡åž‹çš„å»ºç«‹ï¼Œä¸»è¦å‚è€ƒäº†Ben-Akivaç­‰äºº1985å¹´æ—¶å‘çš„ä¸€ç¯‡æœ‰å…³Travel Demandç ”ç©¶çš„è®ºæ–‡ï¼Œè¯¥ç¯‡è®ºæ–‡é“¾æŽ¥å¦‚ä¸‹ï¼š

[Discrete Choice Analysis: Theory and Application to Travel Demand | SpringerLink](https://link.springer.com/article/10.1057/jors.1987.63)

æ–‡ä¸­æž„å»ºMNLé€‰æ‹©æ¨¡åž‹çš„ç›®çš„æ˜¯é¢„ä¼°çº¿ä¸Šã€çº¿ä¸‹æ¸ é“çš„å®¢æˆ·éœ€æ±‚ï¼Œä»¥ä¾¿åŽé¢å»ºç«‹è¿ç­¹å­¦æ¨¡åž‹ã€‚ä¸‹é¢æ˜¯æ–‡ç« å»ºç«‹MNLé€‰æ‹©æ¨¡åž‹çš„è¿‡ç¨‹ï¼š

*   å‡è®¾å®¢æˆ·æ•ˆç”¨çš„éšæœºåˆ†é‡\\(\\xi\_i\\)æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¸”æœä»Ž\\(Gumbel\\)åˆ†å¸ƒï¼Œç´¯ç§¯åˆ†å¸ƒå‡½æ•°ä¸ºï¼š
    
    \\\[F(x)=P(\\xi\_i\\leq x)=e^{-\\mu(x-\\eta)} \\\]
    
    å…¶ä¸­ï¼Œ\\(x\\)æ˜¯è¯¯å·®éšæœºå˜é‡ï¼Œ\\(\\eta\\)æ˜¯ä½ç½®å‚æ•°ï¼Œ\\(\\mu\\)æ˜¯æ­£æ¯”ä¾‹å‡½æ•°ã€‚
    
    éšæœºå˜é‡\\(\\xi\_i\\)çš„å‡å€¼å’Œæ–¹å·®ä¸ºï¼š
    
    \\\[E\[\\xi\_i\]=\\eta+\\frac{\\gamma}{\\mu}Var\[\\xi\_i\]=\\frac{\\pi^2}{6\\mu^2} \\\]
    
    å…¶ä¸­ï¼Œ\\(\\pi\\approx3.14\\)ï¼Œ\\(\\gamma\\approx0.57\\)(æ¬§æ‹‰å¸¸æ•°)
    
*   å‡è®¾å…¨æ¸ é“ç½‘ç»œä¸­å…±æœ‰\\(Z\\)ä¸ªåœ°åŒºï¼Œå®¢æˆ·ä»Žå®žä½“æ¸ é“è´­ä¹°çš„æ•ˆç”¨ä¸º\\(U\_{bz}\\)ï¼Œä»Žç½‘ä¸Šæ¸ é“è´­ä¹°å•†å“çš„æ•ˆç”¨ä¸º\\(U\_{ez}\\)ï¼ˆå¯¹äºŽ\\(z\\)åœ°åŒºæ¥è¯´ï¼Œ\\(z\\in{Z}\\)ï¼‰
    
    \\\[U\_{bz}=u\_{bz}+\\xi\_{bz} \\\]
    
    \\\[U\_{ez}=u\_{ez}+\\xi\_{ez} \\\]
    
    å…¶ä¸­ï¼Œ\\(u\_{iz}(i\\in{\\{b,e\\}})\\)æ˜¯é€‰æ‹©\\(i\\)çš„æ•ˆç›Šï¼Œ\\(\\xi\_{iz}(i\\in{\\{b,e\\}})\\)æ˜¯ä¸€ä¸ª\\(i.i.d. Gumber\\)éšæœºå˜é‡ï¼Œæ‰€æœ‰çš„\\(i\\)**å‡å€¼ä¸º0**ï¼Œ**æ ‡åº¦å‡½æ•°ä¸º1**.
    
    å¦‚æžœå®¢æˆ·ä¸ä»Žè¿™äº›æ¸ é“è´­ä¹°ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„**å¹³å‡æ•ˆç”¨ä¸º0**ï¼Œåœ¨è¿™ä¸ªæ•ˆç”¨æ¨¡åž‹ä¸‹ï¼Œå®¢æˆ·é€‰æ‹©æ¸ é“\\(i\\)è´­ä¹°çš„æ•ˆç›Šä¸ºï¼š
    
    \\\[\\theta=\\frac{e^{u\_{iz}}}{\\sum\\limits\_{j\\in{\\{e,b\\}}}(e^{u\_{jz}})+e^{u\_0}}\\forall{i}\\in{\\{e,b\\}},\\forall{z}\\in{Z} \\\]
    
    å…¶ä¸­ï¼Œ\\(\\theta\_{iz}\\)æ˜¯å®¢æˆ·ä»ŽåŒºåŸŸ\\(z\\)ä¸­é€‰æ‹©æ¸ é“\\(i\\)è´­ä¹°çš„æ¦‚çŽ‡ï¼Œè€Œ\\(u\_0\\)æ˜¯å®¢æˆ·é€‰æ‹©ä¸è´­ä¹°æ—¶çš„å¹³å‡æ•ˆç”¨ã€‚
    

3.2 æ¨¡åž‹1çš„å»ºç«‹ï¼ˆçŸ­æœŸè§„åˆ’ï¼‰
----------------

*   å‡è®¾é€‰æ‹©\\(i\\)çš„å¹³å‡æ•ˆç”¨\\(u\_{iz}(i\\in{\\{e,b\\}})\\)æ˜¯ä¸€ä¸ªå…³äºŽæ¸ é“ä»·æ ¼çš„çº¿æ€§å‡½æ•°ã€‚
    
    \\\[u\_{bz}=\\beta\_{0z}+\\beta\_{1z}P\_{bz} \\\]
    
    \\\[u\_{ez}=\\beta\_{0z}+\\beta\_{1z}P\_{ez} \\\]
    
    å…¶ä¸­ï¼Œ\\(\\beta\_{0z}\\)æ˜¯å¸¸é‡ï¼Œ\\(\\beta\_{1z}\\)æ˜¯åœ¨çº¿æˆ–å®žä½“æ¸ é“ä¸­çš„ä»·æ ¼ç³»æ•°ï¼Œå®ƒå¯ä»¥é€šè¿‡ä½¿ç”¨åŽ†å²æ•°æ®è®¡ç®—ã€‚\\(P\_{iz}(i\\in{{e,b}})\\)æ˜¯zåŒºåŸŸçš„æ¸ é“ä¸ºé¡¾å®¢æä¾›çš„ä»·æ ¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘é‡ã€‚
    
    ä»·æ ¼å‘é‡å‡½æ•°\\(P^t\_z\\)çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š
    
    \\\[D^t\_{bz}(P^t\_z)=n^t\_zÃ—\\theta\_{bz}D^t\_{bz}(P^t\_z)=n^t\_zÃ—\\frac{e^{\\beta\_{0z}+\\beta\_{1z}P\_{bz}}}{e^{\\beta\_{0z}+\\beta\_{1z}P\_{bz}}+e^{\\beta\_{0z}+\\beta\_{1z}P\_{ez}+1}} \\\]
    
    \\\[D^t\_{ez}(P^t\_z)=n^t\_zÃ—\\theta\_{ez}D^t\_{ez}(P^t\_z)=n^t\_zÃ—\\frac{e^{\\beta\_{0z}+\\beta\_{1z}P\_{bz}}}{e^{\\beta\_{0z}+\\beta\_{1z}P\_{ez}}+e^{\\beta\_{0z}+\\beta\_{1z}P\_{ez}+1}} \\\]
    
    å…¶ä¸­ï¼Œ\\(n^t\_z\\)æ˜¯\\(z\\)åŒºåŸŸ\\(t\\)æ—¶é—´æ®µçš„å¸‚åœºè§„æ¨¡ï¼Œ\\(\\theta\_{bz}\\)ã€\\(\\theta\_{ez}\\)åˆ†åˆ«æ˜¯å®¢æˆ·ä»Žçº¿ä¸‹ã€çº¿ä¸Šæ¸ é“è´­ä¹°çš„æ¦‚çŽ‡ã€‚\\(P^t\_z=(P^t\_{bz},P^t\_{ez})\\)æ˜¯ä»·æ ¼çŸ¢é‡ï¼Œå…¶åŒ…æ‹¬åœ¨\\(z\\)åŒºåŸŸ\\(t\\)æ—¶é—´ä¸­æä¾›çš„çº¿ä¸‹å’Œçº¿ä¸Šæ¸ é“ä»·æ ¼ã€‚
    

### 3.2.1 åŸºæœ¬å‡è®¾å’Œç¬¦å·è¯´æ˜Ž

*   è®ºæ–‡çš„åŸºæœ¬å‡è®¾å¦‚ä¸‹ï¼š
    
    ï¼ˆ1ï¼‰å‡è®¾å®¢æˆ·ä»Žçº¿ä¸‹æ¸ é“å–è´§çš„å¹³å‡æ•ˆç”¨ä¸Žçº¿ä¸Šæ¸ é“ç›¸åŒã€‚
    
    ï¼ˆ2ï¼‰çº¿ä¸‹å’Œçº¿ä¸Šæ¸ é“åº“å­˜æœ‰é™ã€‚
    
    ï¼ˆ3ï¼‰é”€å”®å‘¨æœŸæœ‰é™ï¼Œä¸”åˆ†ä¸ºTä¸ªå‘¨æœŸã€‚
    
    ï¼ˆ4ï¼‰åœ¨å‘¨æœŸtå¼€å§‹æ—¶ï¼Œé›¶å”®å•†å…¬å¼€æ¯ä¸ªé”€å”®åŒºåŸŸzä¸­çš„ä»·æ ¼å‘é‡\\(P^t\_z=(P^t\_{bz},P^t\_{ez})\\)ï¼Œæ¶ˆè´¹è€…å¯ä»¥æ®æ­¤äº†è§£åˆ°å„ä¸ªæ¸ é“çš„ä»·æ ¼ã€‚
    
    ï¼ˆ5ï¼‰çº¿ä¸‹å’Œåœ¨çº¿æ¸ é“åœ¨åŒºåŸŸzä¸­çš„éœ€æ±‚è¡¨ç¤ºä¸º\\(D^t\_{bz}(P^t\_z)\\)å’Œ\\(D^t\_{ez}(P^t\_z)\\)
    
    ï¼ˆ6ï¼‰ä¸è€ƒè™‘è¡¥è´§å’Œç¼ºè´§ï¼Œä¸è€ƒè™‘ç¼ºè´§æˆæœ¬ã€‚
    
*   è®ºæ–‡çš„ç¬¦å·è¯´æ˜Žå¦‚ä¸‹ï¼š
    

![](https://img2023.cnblogs.com/blog/2744125/202303/2744125-20230329210800892-317180837.png)

*   å†³ç­–å˜é‡ï¼š\\(S^t\_{bwz}ã€S^t\_{ewz}ã€O^t\_{bwz}ã€O^t\_{ewz}ã€L\_{bz}ã€L\_{ez}ã€P^t\_{bz}ã€P^t\_{ez}\\)

### 3.2.2 æ¨¡åž‹å»ºç«‹

\\\[Max\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{w\\in{Z}}\\sum\\limits\_{z\\in{Z}}\[P^t\_{bz}(S^t\_{bwz}+S^t\_{ewz})+P^t\_{ez}(O^t\_{bwz}+O^t\_{ewz})\]+v\[\\sum\\limits\_{w\\in{Z}}(L\_{bw}+L\_{ew})\]\\\\-\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{w\\in{Z}}\\sum\\limits\_{z\\in{Z}}(c^s\_{bwz}S^t\_{bwz}+c^s\_{ewz}S^t\_{ewz}+c^o\_{bwz}O^t\_{bwz}+c^o\_{ewz}O^t\_{ewz}) \\\]

\\(s.t.\\)

\\\[\\sum\\limits\_{w\\in{Z}}(S^t\_{bwz}+S^t\_{ewz})\\leq{D^t\_{bz}(P^t\_z)} \\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[\\sum\\limits\_{w\\in{Z}}(O^t\_{bwz}+O^t\_{ewz})\\leq{D^t\_{ez}(P^t\_z)} \\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[L\_{bw}=x\_{bw}-\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{z\\in{Z}}(S^t\_{bwz}+O^t\_{bwz})\\forall{w}\\in{Z} \\\]

\\\[L\_{ew}=x\_{ew}-\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{z\\in{Z}}(S^t\_{bwz}+O^t\_{bwz})\\forall{w}\\in{Z} \\\]

\\\[P^t\_z=(P^t\_{bz},P^t\_{ez})\\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[S^t\_{bwz},S^t\_{ewz},O^t\_{bwz},O^t\_{ewz}\\geq0\\forall{z}\\in{Z},\\forall{w}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[L\_{ez},L\_{bz}\\geq0\\forall{z\\in{Z}} \\\]

*   ç›®æ ‡å‡½æ•°ä¸ºæ€»åˆ©æ¶¦æœ€å¤§åŒ–ï¼Œä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸ºæ»¡è¶³çº¿ä¸Šã€çº¿ä¸‹æ¸ é“éœ€æ±‚çš„æ”¶å…¥ï¼›ç¬¬äºŒéƒ¨åˆ†ä¸ºå‰©ä½™åº“å­˜çš„ä»·å€¼ï¼›ç¬¬ä¸‰éƒ¨åˆ†ä¸ºçº¿ä¸‹ã€çº¿ä¸Šæ¸ é“çš„å±¥è¡Œæˆæœ¬ã€‚
    
*   å…³äºŽçº¦æŸæ¡ä»¶ï¼šç¬¬ä¸€ã€ç¬¬äºŒæ¡çº¦æŸæ¡ä»¶ä¸ºéœ€æ±‚çº¦æŸï¼Œå³é”€å”®é¢å¿…é¡»å°äºŽå¯¹åº”æ¸ é“çš„éœ€æ±‚ï¼›ç¬¬ä¸‰ã€ç¬¬å››æ¡ä¸ºå‰©ä½™åº“å­˜çš„è®¡ç®—ï¼›ç¬¬äº”æ¡ä¸ºä»·æ ¼å‘é‡çº¦æŸï¼›å…¶ä»–çº¦æŸæ¡ä»¶ä¸ºå˜é‡çš„éžè´Ÿçº¦æŸã€‚
    

3.3 æ¨¡åž‹2çš„å»ºç«‹ï¼ˆé•¿æœŸè§„åˆ’ï¼‰
----------------

*   å‡è®¾å®¢æˆ·è´­ä¹°æ¸ é“ä¸ºçº¿ä¸‹å’Œçº¿ä¸Šæ¸ é“ï¼Œå…¶ä¸­çº¿ä¸Šæ¸ é“åˆå¯ä»¥é€‰æ‹©**å¸¸è§„è¿è¾“**å’Œ**æ¬¡æ—¥è¾¾**ä¸¤ç§é…é€æ–¹å¼ã€‚å®¢æˆ·ä»Žå•†åº—è´­ä¹°äº§å“çš„æ•ˆç”¨ä¸Žç½‘ä¸Šè´­ä¹°åˆ°åº—å–è´§ï¼ˆBOPSï¼‰çš„å¹³å‡æ•ˆç”¨ç›¸åŒã€‚åŸºäºŽæ­¤å®šä¹‰çš„å®¢æˆ·æ•ˆç”¨å‡½æ•°ä¸ºï¼š
    
    \\\[u\_{bz}=\\beta\_{0z}+\\beta\_{1z}P\_{bz}+\\beta\_{2z}t\_{bz}+\\beta\_{3z}t\_{bz}P\_{bz} \\\]
    
    \\\[u\_{fz}=\\beta\_{0z}+\\beta\_{1z}P\_{fz}+\\beta\_{2z}t\_{fz}+\\beta\_{3z}t\_{fz}P\_{fz} \\\]
    
    \\\[u\_{sz}=\\beta\_{0z}+\\beta\_{1z}P\_{sz}+\\beta\_{2z}t\_{sz}+\\beta\_{3z}t\_{sz}P\_{sz} \\\]
    
    å…¶ä¸­ï¼Œ\\(P\_{iz}\\)ã€\\(t\_{iz}\\)ï¼Œ\\(i\\in{\\{b,f,s\\}}\\)åˆ†åˆ«ä»£è¡¨å‘å®¢æˆ·äº¤ä»˜çš„ä»·æ ¼ã€æ—¶é—´ï¼›\\(bã€fã€s\\)åˆ†åˆ«ä»£è¡¨å®žä½“æ¸ é“ã€å¸¸è§„è¿è¾“ã€æ¬¡æ—¥è¾¾ï¼›\\(\\beta\_{0z}\\)æ˜¯æˆªè·ï¼›\\(\\beta\_{1z}\\)åˆ†åˆ«æ˜¯å®žä½“æ¸ é“ã€å¸¸è§„è¿è¾“ã€æ¬¡æ—¥è¾¾çš„ä»·æ ¼ç³»æ•°ï¼›\\(\\beta\_{2z}\\)æ˜¯äº¤è´§æ—¶é—´ç³»æ•°ï¼›\\(\\beta\_{3z}\\)æ˜¯ä»·æ ¼ä¸Žäº¤è´§æ—¶é—´çš„ç›¸äº’ä½œç”¨ç³»æ•°ã€‚
    
*   å‡è®¾æœ‰\\(T\\)ä¸ªå‘¨æœŸï¼Œåœ¨åŒºåŸŸ\\(z\\)ï¼Œ\\(t\\)æ—¶é—´æ®µçš„å¸‚åœºè§„æ¨¡ä¸º\\(n^t\_t\\)ã€‚æ­¤æ—¶ï¼Œçº¿ä¸Šå’Œå®žä½“æ¸ é“å¯¹äºŽåŒºåŸŸ\\(z\\)å’Œæ—¶é—´\\(t\\)ä¸‹ä¸åŒçš„å•†å“é…é€æ–¹å¼é€‰æ‹©çš„éœ€æ±‚å‡½æ•°éµå¾ªä»¥ä¸‹å½¢å¼ï¼š
    
    \\\[D^t\_{bz}(P^t\_z)=n^t\_zÃ—\\frac{e^{u\_{bz}}}{e^{u\_{bz}}+e^{u\_{fz}}+e^{u\_{sz}}+1} \\\]
    
    \\\[D^t\_{fz}(P^t\_z)=n^t\_zÃ—\\frac{e^{u\_{fz}}}{e^{u\_{bz}}+e^{u\_{fz}}+e^{u\_{sz}}+1} \\\]
    
    \\\[D^t\_{sz}(P^t\_z)=n^t\_zÃ—\\frac{e^{u\_{sz}}}{e^{u\_{bz}}+e^{u\_{fz}}+e^{u\_{sz}}+1} \\\]
    
    å…¶ä¸­ï¼Œ\\(P^t\_z\\)ä¸ºä»·æ ¼å‘é‡å‡½æ•°ï¼Œ\\(P^t\_z=(P^t\_{bz},P^t\_{fz},P^t\_{sz})\\)æ˜¯ä»·æ ¼çŸ¢é‡ï¼Œåœ¨åŒºåŸŸ\\(z\\)æ—¶é—´æ®µ\\(t\\)ä¸­ä¸ºçº¿ä¸Šå’Œå®žä½“æ¸ é“æä¾›çš„ä»·æ ¼ã€‚
    

### 3.3.1 åŸºæœ¬å‡è®¾å’Œç¬¦å·è¯´æ˜Ž

*   è®ºæ–‡çš„åŸºæœ¬å‡è®¾å¦‚ä¸‹ï¼š
    
    ï¼ˆ1ï¼‰åœ¨å‘¨æœŸ\\(t\\)å¼€å§‹æ—¶ï¼Œé›¶å”®å•†åœ¨æ¯ä¸ªåŒºåŸŸ\\(z\\in{Z}\\)è®¾ç½®ä»·æ ¼å‘é‡\\(P^t\_z=(P^t\_{bz},P^t\_{fz},P^t\_{sz})\\)ï¼Œç¡®å®šä»·æ ¼åŽï¼Œä¼°ç®—å®žä½“æ¸ é“çš„éœ€æ±‚\\(D^t\_{bz}(P^t\_z), D^t\_{fz}(P^t\_z), D^t\_{sz}(P^t\_z)\\)ã€‚
    
    ï¼ˆ2ï¼‰å‡è®¾é›¶å”®å•†åœ¨æ¯ä¸ªåŒºåŸŸéƒ½æœ‰ä¸€å®¶å•†åº—å’Œä¸€ä¸ªç”µå­å±¥è¡Œä¸­å¿ƒã€‚
    
    ï¼ˆ3ï¼‰ä¸è€ƒè™‘ç¼ºè´§æˆæœ¬ã€‚
    
    ï¼ˆ4ï¼‰åº—å†…åº“å­˜å¯ç”¨äºŽæ»¡è¶³å¸¸è§„é…é€å’Œæ¬¡æ—¥è¾¾éœ€æ±‚ã€‚
    
*   è®ºæ–‡çš„ç¬¦å·è¯´æ˜Žå¦‚ä¸‹ï¼š
    

![](https://img2023.cnblogs.com/blog/2744125/202303/2744125-20230329211102724-797824969.png)

*   å†³ç­–å˜é‡ï¼š\\(S^t\_{bwz}ã€S^t\_{ewz}ã€O^{ft}\_{bwz}ã€O^{ft}\_{ewz}ã€O^{st}\_{bwz}ã€O^{st}\_{ewz}ã€P^t\_{bz}ã€P^t\_{fz}ã€P^t\_{sz}ã€X\_{bz}ã€X\_{ez}\\)

### 3.3.2 æ¨¡åž‹å»ºç«‹

\\\[Max\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{w\\in{Z}}\\sum\\limits\_{z\\in{Z}}\[P^t\_{bz}(S^t\_{bwz}+S^t\_{ewz})+P^t\_{fz}(O^{ft}\_{bwz}+O^{ft}\_{ewz})+P^t\_{sz}(O^{st}\_{bwz}+O^{st}\_{ewz})\]+v\[\\sum\\limits\_{z\\in{Z}}(X^T\_{bz}+X^T\_{ew})\]+h\[\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{z\\in{Z}}(X^t\_{bz}+X^t\_{ez})\] \\\]

\\\[-\\sum\\limits\_{t\\in{T}}\\sum\\limits\_{w\\in{Z}}\\sum\\limits\_{z\\in{Z}}(c^s\_{bwz}S^t\_{bwz}+c^s\_{ewz}S^t\_{ewz}+c^f\_{bwz}O^{ft}\_{bwz}+c^s\_{ewz}O^{ft}\_{ewz}+c^s\_{bwz}O^{st}\_{bwz}+c^s\_{ewz}O^{st}\_{ewz}) \\\]

\\(s.t.\\)

\\\[\\sum\\limits\_{w\\in{Z}}(S^t\_{bwz}+S^t\_{ewz})\\leq{D^t\_{bz}(P^t\_z)} \\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[\\sum\\limits\_{w\\in{Z}}(O^{ft}\_{bwz}+O^{ft}\_{ewz})\\leq{D^t\_{fz}(P^t\_z)} \\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[\\sum\\limits\_{w\\in{Z}}(O^{st}\_{bwz}+O^{st}\_{ewz})\\leq{D^t\_{sz}(P^t\_z)} \\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[X^t\_{bw}=X^{t-1}\_{bw}-\\sum\\limits\_{z\\in{Z}}(S^t\_{bwz}+O^{ft}\_{bwz}+O^{st}\_{bwz})\\forall{w}\\in{Z}, \\forall{t}\\in{T} \\\]

\\\[X^t\_{ew}=X^{t-1}\_{ew}-\\sum\\limits\_{z\\in{Z}}(S^t\_{ewz}+O^{ft}\_{ewz}+O^{st}\_{ewz})\\forall{w}\\in{Z}, \\forall{t}\\in{T} \\\]

\\\[\\sum\\limits\_{w\\in{Z}}X^0\_{ew}+\\sum\\limits\_{w\\in{Z}}X^0\_{bw}=x \\\]

\\\[P^t\_z=(P^t\_{bz},P^t\_{fz}, P^t\_{sz})\\forall{z}\\in{Z},\\forall{t\\in{T}} \\\]

\\\[S^t\_{bwz}, S^t\_{ewz}, O^{ft}\_{bwz}, O^{ft}\_{ewz}, O^{st}\_{bwz}, O^{st}\_{ewz}\\geq{0}\\forall{z}\\in{Z}, \\forall{w}\\in{Z}, \\forall{t\\in{T}} \\\]

\\\[X^t\_{ez}, X^t\_{bz}\\geq0\\forall{z}\\in{Z}, \\forall{t}\\in{T} \\\]

*   ç›®æ ‡å‡½æ•°ä¸ºæ€»åˆ©æ¶¦æœ€å¤§åŒ–ï¼Œä¸»è¦åˆ†ä¸ºå››éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸ºæ»¡è¶³çº¿ä¸Šã€çº¿ä¸‹æ¸ é“éœ€æ±‚çš„æ”¶å…¥ï¼›ç¬¬äºŒéƒ¨åˆ†ä¸ºå‰©ä½™åº“å­˜çš„ä»·å€¼ï¼›ç¬¬ä¸‰éƒ¨åˆ†ä¸ºåº“å­˜æŒæœ‰æˆæœ¬ï¼›ç¬¬å››éƒ¨åˆ†ä¸ºçº¿ä¸‹ã€çº¿ä¸Šæ¸ é“çš„å±¥è¡Œæˆæœ¬ã€‚
    
*   å…³äºŽçº¦æŸæ¡ä»¶ï¼šç¬¬ä¸€ã€ç¬¬äºŒã€ç¬¬ä¸‰æ¡çº¦æŸæ¡ä»¶ä¸ºéœ€æ±‚çº¦æŸï¼Œå³é”€å”®é¢å¿…é¡»å°äºŽå¯¹åº”æ¸ é“çš„éœ€æ±‚ï¼›ç¬¬å››ã€ç¬¬äº”æ¡ä¸ºåŒºåŸŸ\\(z\\)åœ¨\\(t\\)æœŸæœ«çš„å‰©ä½™åº“å­˜è®¡ç®—ï¼›ç¬¬äº”æ¡ä¸ºåº“å­˜çº¦æŸï¼Œç¡®ä¿æœŸåˆçº¿ä¸Šã€çº¿ä¸‹çš„åº“å­˜ä¹‹å’Œä¸ºæ•´ä¸ªè®¡åˆ’æœŸå‰çš„åº“å­˜é‡ï¼›ç¬¬å…­æ¡ä¸ºä»·æ ¼å‘é‡çº¦æŸï¼›å…¶ä»–çº¦æŸæ¡ä»¶ä¸ºå˜é‡çš„éžè´Ÿçº¦æŸã€‚
    

4\. æ¨¡åž‹æ±‚è§£
========

æ–‡ä¸­çš„æ¨¡åž‹ä¸»è¦æ˜¯ç”¨PyLogitå’ŒCPLEXæ±‚è§£å™¨æ±‚è§£çš„ï¼ŒCPLEXæ±‚è§£æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä¸åŠ èµ˜è¿°ã€‚ä½†æˆ‘å‘çŽ°æœ‰å…³PyLogitå‡½æ•°çš„èµ„æ–™å±…ç„¶å…¨ç½‘éƒ½æœä¸åˆ°(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»ï¼ŒäºŽæ˜¯æˆ‘é‡‡ç”¨äº†ä¸€äº›æŠ€æœ¯æ‰‹æ®µï¼Œæ‰¾ChatGPTå¸®æˆ‘å†™äº†ä¸ªè¯¦è§£å’Œä»£ç ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»PyLogitçš„è¯¦è§£åŠæ–‡ç« çš„MNLé€‰æ‹©æ¨¡åž‹ä»£ç ã€‚

4.1 Pythonçš„PyLogitåŒ…è¯¦è§£
---------------------

ä»¥ä¸‹ä¸ºChatGPTçš„å›žç­”ã€‚

ä½¿ç”¨Pythonçš„PyLogitåŒ…æ±‚è§£MNLæ¨¡åž‹æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1.Â Â  è®¡ç®—å˜é‡å¹¶ç”Ÿæˆæ•°æ®é›†

é¦–å…ˆï¼Œæ‚¨éœ€è¦ç¡®å®šMNLæ¨¡åž‹ä¸­éœ€è¦è€ƒè™‘å“ªäº›å˜é‡å¹¶å°†è¿™äº›å˜é‡æ”¶é›†åˆ°ä¸€ä¸ªæ•°æ®é›†ä¸­ã€‚ç„¶åŽéœ€è¦è®¡ç®—å…¶ä¸­å˜é‡çš„å€¼ï¼Œè¿™äº›å€¼å¯èƒ½æ¥è‡ªä¸åŒçš„æ•°æ®é›†ï¼Œå¯ä»¥ç›´æŽ¥ä»Žä»£ç ä¸­è¯»å–ï¼Œä¹Ÿå¯ä»¥ä»Žæ–‡ä»¶ä¸­è¯»å–åˆ°æ•°æ®é›†ä¸­ã€‚åœ¨å°†æ•°æ®é›†å¯¼å…¥PythonçŽ¯å¢ƒä¸­ä¹‹åŽï¼Œå¯ä»¥ä½¿ç”¨Pandas DataFrameå±žæ€§è®¡ç®—å˜é‡ã€‚

2.Â Â  æ¨¡åž‹æ‹Ÿåˆ

ä½¿ç”¨PyLogitåŒ…çš„æ¨¡åž‹æ‹Ÿåˆå‡½æ•°ï¼Œæ‚¨å¯ä»¥æ‹ŸåˆMNLæ¨¡åž‹ã€‚è¿™ä¸ªå‡½æ•°å°†éœ€è¦ä»¥ä¸‹å‚æ•°ï¼š

*   formulaï¼šä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºæ¨¡åž‹å…¬å¼ï¼Œè¯­æ³•å¯ä»¥å‚ç…§Rè¯­è¨€çš„glam()å‡½æ•°ã€‚
    
*   dataï¼šåŒ…å«æ•°æ®é›†å’Œå˜é‡çš„Pandas DataFrameå¯¹è±¡ã€‚
    
*   alt\_nameï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯æ•°æ®é›†ä¸­åŒ…å«é€‰æ‹©é¡¹çš„åˆ—åã€‚
    
*   obs\_idï¼šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®é›†ä¸­åŒ…å«è§‚æµ‹ç¼–å·çš„åˆ—åã€‚
    
*   num\_paramsï¼šä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ¨¡åž‹å‚æ•°çš„æ•°é‡ã€‚
    

3.Â Â  æ¨¡åž‹è¯„ä»·

ä½¿ç”¨PyLogitåŒ…çš„æ¨¡åž‹è¯„ä»·å‡½æ•°è¯„ä»·æ¨¡åž‹ã€‚è¿™ä¸ªå‡½æ•°å°†éœ€è¦ä»¥ä¸‹å‚æ•°ï¼š

*   model\_resultsï¼šåŒ…å«æ¨¡åž‹æ‹Ÿåˆç»“æžœçš„PyLogit Mnlogitç»“æžœå¯¹è±¡ã€‚
    
*   print\_resultsï¼šä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰“å°å‡ºç»“æžœã€‚
    

é€šè¿‡è¿™äº›æ­¥éª¤å®Œæˆä¹‹åŽï¼Œæ‚¨å°†æ‹Ÿåˆä¸€ä¸ªMNLæ¨¡åž‹å¹¶å¯ä»¥ä½¿ç”¨PyLogitåŒ…è¿›è¡Œç›¸å…³çš„åˆ†æžï¼Œå¦‚é¢„æµ‹æ–°æ•°æ®ç­‰ã€‚

ä»£ç ç¤ºä¾‹ï¼š

    # å¯¼å…¥PyLogitåŒ…
    from pylogit import PyLogit
    
    # ä»Žæ–‡ä»¶ä¸­è¯»å–æ•°æ®é›†
    data = pd.read_csv("data.csv")
    
    # è®¡ç®—å˜é‡
    # ...
    
    # å°†å˜é‡æ·»åŠ åˆ°æ•°æ®é›†ä¸­
    # ...
    
    # æŒ‡å®šæ¨¡åž‹å…¬å¼
    formula = 'Y ~ X1 + X2 + X3'
    
    # æ‹Ÿåˆæ¨¡åž‹
    mnl_model = PyLogit(data=data,
                        formula=formula,
                        alt_name='Y',
                        obs_id='Obs_ID',
                        # num_params ç­‰äºŽ X1 + X2 + X3 ä¸­å˜é‡æ•°é‡
                        num_params=3)
    
    # è¯„ä¼°æ¨¡åž‹
    mnl_model.fit(maxiter=1000,   # æœ€å¤§è¿­ä»£æ¬¡æ•°
                  halton_iterations=0,
                  check_gradient=True)
    
    # æ‰“å°ç»“æžœ
    print(mnl_model.summary())
    

4.2 PyLogitæ±‚è§£MNLé€‰æ‹©æ¨¡åž‹
--------------------

æˆ‘åŽé¢åˆè¯¢ï¼ˆå¥´ï¼‰é—®ï¼ˆå½¹ï¼‰äº†ä¸€ä¸‹ChatGPTï¼Œè®©å®ƒå¸®æˆ‘å†™ä½¿ç”¨PyLogitåŒ…æ±‚è§£MNLé€‰æ‹©æ¨¡åž‹çš„ä»£ç ï¼Œä»¥ä¸‹ä»£ç æ˜¯æˆ‘æ ¹æ®GPTçš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå¯¹è®ºæ–‡ä¸­MNLé€‰æ‹©æ¨¡åž‹çš„å¤çŽ°ã€‚

    import numpy as np
    import pandas as pd
    import pylogit as pl
    
    #IDä»£è¡¨å®¢æˆ·çš„ID
    #Choiceä»£è¡¨å®¢æˆ·å¯¹æ¸ é“çš„é€‰æ‹©(bä¸ºçº¿ä¸‹æ¸ é“ï¼Œeä¸ºçº¿ä¸Šæ¸ é“)
    #Priceä»£è¡¨å¯¹åº”çš„ä»·æ ¼
    data = pd.DataFrame({
        'ID': [1, 1, 2, 2, 3, 3, 4, 4],
        'Choice': ['b', 'e', 'b', 'e', 'b', 'e', 'b', 'e'],
        'Price': [10, 8, 12, 6, 20, 15, 18, 10]
    })
    
    #'gev'æ˜¯å¯¹Gumbelåˆ†å¸ƒçš„å®šä¹‰
    data['b_Price_Utility'] = pl.create_choice_column(data['Price'], 0.0, 'gev', (1,))
    data['e_Price_Utility'] = pl.create_choice_column(data['Price'], 0.0, 'gev', (1,))
    
    # å°†æ•°æ®é‡æž„ä¸º"wide"æ ¼å¼
    long_data = pl.convert_wide_to_long(data, id_col='ID', alt_col='Choice', 
                                        observation_col=None, drop_alt_id=False)
    wide_data = pl.convert_long_to_wide_format(long_data, id_col='ID', 
                                                value_col='Price Utility')
    
    #ä½¿ç”¨MNLè®­ç»ƒæ¨¡åž‹
    model = pl.create_choice_model(data=wide_data, alt_id_col='alt_id', 
                                    obs_id_col='obs_id', choice_col='choice', 
                                    specification={
                                        'Price': [1, 2]
                                    }, 
                                    model_type='MNL')
    result = model.fit()
    
    #è¾“å‡ºæ¨¡åž‹çš„å‚æ•°ï¼Œé‡Œé¢åŒ…å«äº†æ–‡ä¸­æ‰€éœ€çš„Î²å‚æ•°
    print(result.summary())
    

ä»£ç ä¸­IDã€Choiceã€Priceçš„æ•°æ®éƒ½æ˜¯æˆ‘ä¹±ç¼–çš„ï¼Œå› ä¸ºè®ºæ–‡ä¸­æ²¡ç»™è®­ç»ƒæ•°æ®é›†ã€‚ä½†å¤§å®¶å¦‚æžœæœ‰éœ€è¦çš„è¯å¯ä»¥è‡ªå·±æ”¶é›†æ•°æ®è¯»å…¥è®­ç»ƒã€‚