---
layout: post
title: "æ¨¡å‹è¯„ä¼°ä¸æ”¹è¿›ï¼šäº¤å‰éªŒè¯"
date: "2022-05-26T15:22:24.679Z"
---
æ¨¡å‹è¯„ä¼°ä¸æ”¹è¿›ï¼šäº¤å‰éªŒè¯
============

â­ä¸ºä»€ä¹ˆè¦åˆ’åˆ†æµ‹è¯•é›†ä¸è®­ç»ƒé›†ï¼Ÿ

*   ç”¨æµ‹è¯•é›†åº¦é‡æ¨¡å‹å¯¹æœªè§è¿‡æ•°æ®çš„æ³›åŒ–æ€§èƒ½

â­äº¤å‰éªŒè¯

*   æ•°æ®è¢«å¤šæ¬¡åˆ’åˆ†ï¼Œéœ€è¦è®­ç»ƒå¤šä¸ªæ¨¡å‹
*   æœ€å¸¸ç”¨KæŠ˜äº¤å‰éªŒè¯
    *   kæ˜¯ç”¨æˆ·æŒ‡å®šçš„æ•°å­—ï¼Œé€šå¸¸å–0/5ï¼Œ
        
    *   5æŠ˜äº¤å‰éªŒè¯ï¼šæ•°æ®åˆ’åˆ†ä¸º5éƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†å«åšæŠ˜ã€‚æ¯ä¸€æŠ˜ä¾æ¬¡è½®æµä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™åšè®­ç»ƒé›†
        
        mglearn.plots.plot\_cross\_validation()
        

![](https://img2022.cnblogs.com/blog/2145457/202205/2145457-20220526221609709-1426573263.png)

1ã€scikit-learnä¸­çš„äº¤å‰éªŒè¯
--------------------

åˆ©ç”¨model\_selectionä¸­çš„cross\_val\_score(æ¨¡å‹ï¼Œè®­ç»ƒæ•°æ®ï¼ŒçœŸå®æ ‡ç­¾)

      #åœ¨irisæ•°æ®ä¸Šï¼Œåˆ©ç”¨logisticregreè¿›è¡Œè¯„ä¼°
    
      from sklearn.linear_model import LogisticRegression
      from sklearn.datasets import load_iris
      from sklearn.model_selection import cross_val_score
    
      iris = load_iris()
      lrg = LogisticRegression()
    
      scores = cross_val_score(lrg,iris.data,iris.target)
      print("cross_validation scores:{}".format(scores))
    
      '''
      `cross_validation scores:[0.96666667 1.         0.93333333 0.96666667 1.        ]`
      '''
    

é»˜è®¤æƒ…å†µä¸‹ï¼Œcross\_val\_scoreæ‰§è¡Œ3æŠ˜äº¤å‰éªŒè¯ï¼Œå¯é€šè¿‡ä¿®æ”¹cvå€¼æ”¹å˜æŠ˜æ•°

      #æ€»ç»“äº¤å‰éªŒè¯ç²¾åº¦ï¼šè®¡ç®—å¹³å‡å€¼
    
      print("Average cross-validation:{:.2f}".format(scores.mean()))
    
      '''
      `Average cross-validation:0.97`
      '''
    

2ã€åˆ†å±‚kæŠ˜äº¤å‰éªŒè¯å’Œå…¶å®ƒç­–ç•¥
---------------

â­sklearné‡Œé¢çš„äº¤å‰éªŒè¯

*   åˆ†ç±»é—®é¢˜æ—¶ä½¿ç”¨ï¼šåˆ†å±‚äº¤å‰éªŒè¯
    
    *   ä½¿æ¯ä¸ªæŠ˜ä¸­ç±»åˆ«ä¹‹é—´çš„æ¯”ä¾‹ä¸æ•´ä¸ªæ•°æ®é›†ä¸­çš„æ¯”ä¾‹ç›¸åŒ
*   å›å½’é—®é¢˜ï¼šæ ‡å‡†kæŠ˜äº¤å‰éªŒè¯
    
        mglearn.plots.plot_stratified_cross_validation()
        
    

![](https://img2022.cnblogs.com/blog/2145457/202205/2145457-20220526221954858-1064183974.png)

### 2.1 å¯¹äº¤å‰éªŒè¯çš„æ›´å¤šæ§åˆ¶

â­å¯ä»¥ç”¨cvæ¥è°ƒèŠ‚cross\_val\_scoreçš„æŠ˜æ•°

*   sklearnè¿˜æä¾›ä¸€ä¸ªäº¤å‰éªŒè¯åˆ†ç¦»å™¨ï¼ˆcross\_validatoin splitterï¼‰ä½œä¸ºcvå‚æ•°
    
        #åœ¨åˆ†ç±»æ•°æ®é›†ä¸Šä½¿ç”¨æ ‡å‡†KæŠ˜äº¤å‰éªŒè¯
        #éœ€è¦ä»model_selectionå¯¼å…¥KFoldåˆ†ç¦»å™¨ç±»ï¼Œå¹¶å°†å…¶å®ä¾‹åŒ–
        
        from sklearn.model_selection import KFold
        
        kf = KFold(n_splits=5) #5æŠ˜
        
        scores = cross_val_score(lrg,iris.data,iris.target,cv=kf)
        print("cross_validation scores:{}".format(scores))
        
        '''
        `cross_validation scores:[1.         1.         0.86666667 0.93333333 0.83333333]`
        '''
        
        kf = KFold(n_splits=3) #3æŠ˜
        
        scores = cross_val_score(lrg,iris.data,iris.target,cv=kf)
        print("cross_validation scores:{}".format(scores))
        
        '''
        `cross_validation scores:[0. 0. 0.]`
        '''
        
    

ğŸ“£  
åœ¨irisæ•°æ®é›†ä¸Šä½¿ç”¨3æŠ˜äº¤å‰éªŒè¯å¾ˆç³Ÿï¼Œå› ä¸ºå®ƒæ¯ä¸ªæŠ˜å¯¹åº”ä¸€ä¸ªç±»åˆ«

â­å¯ä»¥å°†æ•°æ®æ‰“ä¹±ï¼Œä»£æ›¿åˆ†å±‚

      kf = KFold(n_splits=3,shuffle=True)
      scores = cross_val_score(lrg,iris.data,iris.target,cv=kf)
      print("cross_validation scores:{}".format(scores))
    
      '''
      `cross_validation scores:[0.94 0.96 0.98]`
      '''
    

### 2.2 ç•™ä¸€æ³•äº¤å‰éªŒè¯ï¼ˆleave-one-outï¼‰

â­æ¯æŠ˜åªåŒ…å«å•ä¸ªæ ·æœ¬çš„kæŠ˜äº¤å‰éªŒè¯

*   æ¯æ¬¡åˆ’åˆ†ï¼Œé€‰æ‹©å•ä¸ªæ•°æ®ç‚¹ä½œä¸ºæµ‹è¯•é›†
    
*   éå¸¸è€—æ—¶ï¼Œé€‚åˆå°æ•°æ®é›†ç»™å‡ºå¥½çš„ä¼°è®¡ç»“æœ
    
        from sklearn.model_selection import LeaveOneOut
        
        loo = LeaveOneOut()
        scores = cross_val_score(lrg,iris.data,iris.target,cv=loo)
        print("cross_validation scores:{}".format(scores.mean()))
        
        '''
        `cross_validation scores:0.9666666666666667`
        '''
        
    

### 2.3 æ‰“ä¹±åˆ’åˆ†äº¤å‰éªŒè¯

â­æ¯æ¬¡åˆ’åˆ†ä¸ºè®­ç»ƒé›†å–æ ·train\_sizeä¸ªæ ·æœ¬ï¼Œä¸ºæµ‹è¯•é›†å–æ ·test\_sizeä¸ªæ ·æœ¬ï¼Œå°†è¿™ä¸ªåˆ’åˆ†é‡å¤n\_itersæ¬¡

      mglearn.plots.plot_shuffle_split()
    

![](https://img2022.cnblogs.com/blog/2145457/202205/2145457-20220526222335411-1463429631.png)

      #å°†æ•°æ®é›†åˆ’åˆ†ä¸º50%çš„è®­ç»ƒé›†å’Œ50%çš„æµ‹è¯•é›†ï¼Œå…±è¿è¡Œ10æ¬¡è¿­ä»£
    
      from sklearn.model_selection import ShuffleSplit
      shuffle_split = ShuffleSplit(test_size=.5,train_size=.5,n_splits=10)
    
      scores = cross_val_score(lrg,iris.data,iris.target,cv=shuffle_split)
      print("cross_validation scores:{}".format(scores))
    
      '''
      ```
      cross_validation scores:[0.97333333 0.93333333 0.92       0.94666667 0.93333333 0.97333333
       0.94666667 0.88       0.97333333 0.96      ]
      ```
      '''
    

ğŸ“£  
æ‰“ä¹±åˆ’åˆ†äº¤å‰éªŒè¯å¯ä»¥åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†å¤§å°ä¹‹å¤–ç‹¬ç«‹æ§åˆ¶è¿­ä»£æ¬¡æ•°  
å…è®¸åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä»…ä½¿ç”¨éƒ¨åˆ†æ•°æ®

*   train\_size,test\_sizeä¹‹å’Œä¸ç­‰äº1æ¥å®ç°

### 2.4 åˆ†ç»„äº¤å‰éªŒè¯

â­é€‚ç”¨äºæ•°æ®ä¸­åˆ†ç»„é«˜ç›¸å…³åº¦æ—¶ã€‚  
GroupsKFold

*   å‚æ•°ï¼šgroupsï¼Œè¯´æ˜æ•°æ®å±äºå“ªä¸€ç»„ï¼ŒåŒä¸€ç»„çš„æ•°æ®è¦ä¹ˆéƒ½åœ¨æµ‹è¯•é›†ï¼Œè¦ä¹ˆéƒ½åœ¨è®­ç»ƒé›†
    
        from sklearn.model_selection import GroupKFold
        from sklearn.datasets import make_blobs
        
        X,y = make_blobs(n_samples=12,random_state=0)
        groups = [0,0,0,1,1,1,1,2,2,3,3,3]
        gk = GroupKFold(n_splits=3) #3æŠ˜
        
        scores = cross_val_score(lrg,X,y,groups,cv=gk)
        print("cross_validation scores:{}".format(scores))
        
        '''
        `cross_validation scores:[0.75       0.6        0.66666667]`
        '''
        
    

  

      mglearn.plots.plot_group_kfold()
    

![](https://img2022.cnblogs.com/blog/2145457/202205/2145457-20220526222524266-334127816.png)

3ã€äº¤å‰éªŒè¯çš„ä¼˜ç‚¹
---------

â­1ã€æ¯ä¸ªæ ·ä¾‹éƒ½èƒ½åœ¨æµ‹è¯•é›†ä¸­å‡ºç°ä¸€æ¬¡

*   æ¯ä¸ªæ ·ä¾‹ä½äºä¸€ä¸ªæŠ˜ä¸­ï¼Œè€Œæ¯ä¸€ä¸ªæŠ˜éƒ½ä¼šè¢«ä½œä¸ºä¸€æ¬¡test

â­2ã€æä¾›æˆ‘ä»¬çš„æ¨¡å‹å¯¹è®­ç»ƒé›†é€‰æ‹©çš„æ•æ„Ÿæ€§ä¿¡æ¯

*   å®ƒå¯ä»¥å‘Šè¯‰æˆ‘ä»¬æ¨¡å‹åº”ç”¨äºæ–°æ•°æ®æ—¶åœ¨æœ€åå’Œæœ€å¥½æƒ…å†µä¸‹çš„å¯èƒ½è¡¨ç°

â­3ã€å¯¹æˆ‘ä»¬çš„æ•°æ®çš„ä½¿ç”¨æ›´åŠ é«˜æ•ˆ

ç¼ºç‚¹ï¼šå¢åŠ è®¡ç®—æˆæœ¬

ğŸ“£è®°ä½ï¼šäº¤å‰éªŒè¯ä¸ä¼šè¿”å›ä¸€ä¸ªæ¨¡å‹

*   ç›®çš„åªæ˜¯è¯„ä¼°ç»™å®šç®—æ³•åœ¨ç‰¹å®šæ•°æ®é›†è®­ç»ƒåçš„æ³›åŒ–æ€§èƒ½

4ã€å‚è€ƒæ–‡çŒ®
------

ã€Špythonæœºå™¨å­¦ä¹ åŸºç¡€æ•™ç¨‹ã€‹