---
layout: post
title: "如何定制一个智能洒水装置（养狗/养花人士请进）"
date: "2023-02-26T01:21:26.350Z"
---
如何定制一个智能洒水装置（养狗/养花人士请进）
=======================

### 目录

*   [如何用智能地教狗狗上厕所](https://www.aboydfd.com/home_automation/2023/01/08/dog-detection/)
*   [如何定制一个智能洒水装置](https://www.aboydfd.com/home_automation/2023/02/25/spray-automation/)

背景
--

[上一篇](https://www.aboydfd.com/home_automation/2023/01/08/dog-detection/)文章中提到了，我实现了一个自动检测狗狗有没有进厕所的功能。现在我们家的狗狗用它那不算大的小脑瓜，已经百分百学会（但是！也不知道它是不是聪明过头了，如果我不在家、或者我在睡觉，那它就会乱拉乱尿，所以自动奖励程序还是很有必要性）在自己的厕所上尿尿了。

现在的清理工作已经轻松了很多了，只需要捡个屎，再冲一下狗厕所就ok了。但是，人的懒惰是上限的，现在我开始嫌冲狗厕所太麻烦了。那怎么办呢？当然是自动化之咯！

方案选定
----

### 自动浇花工具

当初和老婆要回老家很久，而老婆又养了很多花，所以买过一个自动浇花的工具，可以直接使用这个工具来进行自动冲狗厕所。

但是在我这个场景下使用，会有一个很严重的问题，这个工具只有一个定时功能，所以只能每天在固定的时间点冲水，这样的话：

1.  浪费水，冲水必须足够频繁，才能覆盖狗狗尿完的时间点
2.  可能会吓到狗狗，万一人家在尿尿，突然来一下，这不造成心理阴影了
3.  狗厕所上有屎的时候可能也会冲，那就比较恶心了，屎可能都软了，还沾水了，这个绝美的画面无法想象。

### 定制浇水工具

由于以上种种缺点，我还是决定自制一套冲水的工具，

#### 自动出水

要想自动冲水，肯定要有办法控制自动出水吧，由于之前没有任何此类知识，我花了整整一晚上，才了解到了有一个神奇的东西叫[电磁阀](https://zh.wikipedia.org/wiki/%E7%94%B5%E7%A3%81%E9%98%80)，通过它就能用电来控制水龙头的开和闭，当然，它也能用来控制其它气体/液体管道的开闭。

#### 控制硬件

电磁阀有了，那就是考虑怎么来控制了。这里又有两个方案：

1.  通过ESP8266+电池来控制
    1.  这样可以不必接插头、就可以移动。
    2.  实现起来比较麻烦，需要自己设计电路，考虑升压、稳压、充电等多种因素。
2.  直接通过米家智能插座+一个DC电源适配器来控制
    1.  必须要有插座。
    2.  家里有小爱音箱，并且能有控制手段，目前我是通过HomeAssistant来控制的。
    3.  实现起来比较简单。

两种方案的价格应该算是差不多的，ESP8266方案会稍微贵一点：

米家：30的米家智能插座+8的DC电源适配器  
ESP8266：13的ESP8266+15的电池+X的升压、稳压等电路以及3D打印的外壳

由于我现在没有电路设计相关的知识储备，所以暂时还是选用了米家的方案。

#### 控制程序

现在的控制比较简单，在米家上添加了一个自动化的程序：打开电源->等10秒->关闭电源。

这样，在看到狗狗尿完了之后，就可以喊一句："小爱同学，清理狗厕所"。就能自动出水、停水了。

#### 洒水工具

说到洒水工具，之前买的那个浇花的工具附带的管子和出水喷头都太差了：管子软软的没法固定，喷头是塑料的，要么就是360度喷雾，要么就是出一大道水，没法做到集中喷雾。

这次由于是自己组装，所以就在淘宝销量前列看到了一款比较符合心意的，管子是能进行折叠固定的，并且是金属喷头，可以很丝滑地调节。

#### 费用

电磁阀+米家智能插座+DC电源适配器+洒水管+三通 = 19+29+8+46+6 = 108

#### 效果

![spray](https://nextcloud.aboydfd.com/s/495cgyit9yF8qcZ/preview)

现在清理狗厕所是真的轻松很多了，能动嘴的咱绝不动手。

#### 题外话

这里科普一个小知识点，不感兴趣的同学可以跳过。

我在搜索资料的过程中，知道了自动感应水龙头的原理，没错就是你想的那样，它就是用电磁阀来控制出水的。但是我想讲的是它感应的原理，它其实就是通过红外发射管和红外接收管来实现的，只不过发射管的功率很有限。所以它发射的红外线只有通过挡在它前面的手掌来进行反射时，接收管才能收到该红外信号，之后就是一段程序控制电磁阀来出水了。

### 结论

相较于当初125买的浇花工具，我自己动手整的这个方案更省钱、自动化程度更高、洒水效果更好。

不管是养狗，还是养花的同学都可以考虑自己动手搭建一套这样的方案了哈，这套方案绝对比成套的方案好多了，而且如果电磁阀坏了，换个新的成本也不高，但是如果是一整套的那种方案，人家给不给保修都要另说。

后续扩展
----

### 自动冲尿

其实我现在已经能够实现用程序自动冲尿了，我训练的模型也已经可以检测屎了，但是现在召回率还是稍微低了一点，按实际使用的经验来看，真实数据的召回率大概在0.8-0.9左右。主要是有时候狗狗拉的屎太小了，或者太分散了，模型还没法检测出来。所以我还是没有狠下心来使用自动冲水的功能，就怕屎还在厕所上时，就给冲水了。

### 用esp8266替代米家的智能插座来控制电磁阀

如果阳台/厕所没有插座，那么这个功能就是必须的了。

### 自动捡屎

如果屎也能自动捡了，那真的就解放双手了。

但是要实现它还是太太太难了。

其他
--

透露一下上一篇博文中提到的自动奖励、惩罚的进展：

1.  现在已经能做到自动识别崽崽拉屎拉对了，因为相对于尿来说，屎还是比较好通过图像来识别的。
2.  惩罚想到的是喷狗狗讨厌的气味（暂时考虑是用少量的醋），目前已经能达到远程控制了，但是想要将其移动化，所以还在学习电源管理的电路知识。