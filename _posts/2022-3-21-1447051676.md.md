---
layout: post
title: "《前端运维》一、Linux基础--06Shell流程控制"
date: "2022-03-21T08:38:33.298Z"
---
《前端运维》一、Linux基础--06Shell流程控制
============================

这章我们来学习下流程控制，简单来说就是逻辑判断和循环的写法。并不复杂，我们来简单地看下。

#### 1、if语句

shell的if语句有两种写法，一种是shell脚本式的，一种是命令式的。

if condition
then
    command1 
    command2
    ...
    commandN 
fi

命令式，是这样的：

if \[ $(ps -ef | grep -c "ssh") -gt 1 \]; then echo "true"; fi

if语句使用fi结尾。就像上面的例子那样。

#### 2、if else语句

语法格式：

if condition
then
    command1 
    command2
    ...
    commandN
else
    command
fi

这里要注意的是，加入else没有语句执行，在shell中的语法层面上，是不允许写else，但是在java或php中，语法层面上是允许空else逻辑的。

#### 3、if else-if else语句

语法格式：

if condition1
then
    command1
elif condition2 
then 
    command2
else
    commandN
fi

以上，无论是if else还是if else-if else语法，都可以通过分号，写在一行。这里就不多说了，咱们看下例子：

#!/bin/bash
a\=10
b\=20
if \[ $a == $b \]
then
   echo "a 等于 b"
elif \[ $a -gt $b \]
then
   echo "a 大于 b"
elif \[ $a -lt $b \]
then
   echo "a 小于 b"
else
   echo "没有符合的条件"
fi

结果：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529145927943-524067761.png)

 另外，if else语句经常与test命令互相结合使用:

#!/bin/bash
num1\=$\[2\*3\]
num2\=$\[1+5\]
if test $\[num1\] -eq $\[num2\]
then
    echo '两个数字相等!'
else
    echo '两个数字不相等!'
fi

你猜结果是啥：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529150202175-593494873.png)

#### 4、for循环

一般格式：

for var in item1 item2 ... itemN
do
    command1
    command2
    ...
    commandN
done

写成一行和if语句是一样的，或者说，shell中写成一行的语法都是类似的：

for var in item1 item2 ... itemN; do command1; command2… done;

首先，我们要注意的是当变量值在列表里，for 循环即执行一次所有命令，使用变量名获取列表中的当前取值。命令可为任何有效的 shell 命令和语句。in 列表可以包含替换、字符串和文件名。另外，in列表是可选的，如果不用它，for循环使用命令行的位置参数。

我们来看个例子：

#!/bin/bash
for loop in 1 2 3 4 5
do
    echo "The value is: $loop"
done

结果是：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529151229039-797743965.png)

 另外一个例子：

#!/bin/bash

for str in This is a string
do
    echo $str
done

结果是：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529151324515-2076393400.png)

#### 5、while循环

while 循环用于不断执行一系列命令，也用于从输入文件中读取数据。其语法格式为：

while condition
do
    command
done

我们来看个例子：

#!/bin/bash
int\=1
while(( $int<=5 ))
do
    echo $int
    let "int++"
done

结果是：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529152206014-1976384705.png)

 上面的语句使用了let命令，它用于执行一个或多个表达式，变量计算中不需要加上 $ 来表示变量。while循环可用于读取键盘信息。下面的例子中，输入信息被设置为变量FILM，按<Ctrl-D>结束循环。

echo '按下 <CTRL-D> 退出'
echo -n '输入你最喜欢的网站名: '
while read FILM
do
    echo "是的！$FILM 是一个好网站"
done

这个代码，大家可以自己去试一下哦。

#### 6.until循环

until 循环执行一系列命令直至条件为 true 时停止。until 循环与 while 循环在处理方式上刚好相反。一般 while 循环优于 until 循环，但在某些时候—也只是极少数情况下，until 循环更加有用。

语法是这样的：

until condition
do
    command
done

condition 一般为条件表达式，如果返回值为 false，则继续执行循环体内的语句，否则跳出循环。

以下实例我们使用 until 命令来输出 0 ~ 9 的数字：

#!/bin/bash

a\=0

until \[ ! $a -lt 10 \]
do
   echo $a
   a\=\`expr $a + 1\`
done

结果可想而知：

![](https://img2020.cnblogs.com/blog/1184971/202105/1184971-20210529152938025-705382396.png)

#### 7、case ... esac

**case ... esac** 为多选择语句，与其他语言中的 switch ... case 语句类似，是一种多分枝选择结构，每个 case 分支用右圆括号开始，用两个分号 ;; 表示 break，即执行结束，跳出整个 case ... esac 语句，esac（就是 case 反过来）作为结束标记。

可以用 case 语句匹配一个值与一个模式，如果匹配成功，执行相匹配的命令。语法格式如下：

case 值 in
模式1)
    command1
    command2
    ...
    commandN
    ;;
模式2）
    command1
    command2
    ...
    commandN
    ;;
esac

case 工作方式如上所示，取值后面必须为单词 **in**，每一模式必须以右括号结束。取值可以为变量或常数，匹配发现取值符合某一模式后，其间所有命令开始执行直至 ;;。取值将检测匹配的每一个模式。一旦模式匹配，则执行完匹配模式相应命令后不再继续其他模式。如果无一匹配模式，使用星号 \* 捕获该值，再执行后面的命令。我们来看个例子：

#!/bin/bash

echo '输入 1 到 4 之间的数字:'
echo '你输入的数字为:'
read aNum
case $aNum in
    1)  echo '你选择了 1'
    ;;
    2)  echo '你选择了 2'
    ;;
    3)  echo '你选择了 3'
    ;;
    4)  echo '你选择了 4'
    ;;
    \*)  echo '你没有输入 1 到 4 之间的数字'
    ;;
esac

自己试一下代码，看下结果是啥。

#### 8、跳出循环

在循环过程中，有时候需要在未达到循环结束条件时强制跳出循环，Shell使用两个命令来实现该功能：break和continue。

1）break命令

break命令允许跳出所有循环（终止执行后面的所有循环）。

我们来看个例子：

#!/bin/bash
while :
do
    echo -n "输入 1 到 5 之间的数字:"
    read aNum
    case $aNum in
        1|2|3|4|5) echo "你输入的数字为 $aNum!"
        ;;
        \*) echo "你输入的数字不是 1 到 5 之间的! 游戏结束"
            break
        ;;
    esac
done

2）continue命令

continue命令与break命令类似，只有一点差别，它不会跳出所有循环，仅仅跳出当前循环。

我们对上面的例子做一点修改：

#!/bin/bash
while :
do
    echo -n "输入 1 到 5 之间的数字: "
    read aNum
    case $aNum in
        1|2|3|4|5) echo "你输入的数字为 $aNum!"
        ;;
        \*) echo "你输入的数字不是 1 到 5 之间的!"
            continue
            echo "游戏结束"
        ;;
    esac
done

运行代码发现，当输入大于5的数字时，该例中的循环不会结束，语句 **echo "游戏结束"** 永远不会被执行。

站在巨人的肩膀上，希望我可以看的更远。