---
layout: post
title: "快速整明白Redis中的字典到底是个啥"
date: "2022-03-17T02:40:58.841Z"
---
快速整明白Redis中的字典到底是个啥
===================

### 字典简介

字典是一种用于保存键值对的数据结构，可以通过键值对中的键快速地查找到对应的值。在Redis所使用的C语言中，并没有内置字典，所以Redis自己实现了字典。

整个Redis数据库的所有的键和值就组成了一个全局的字典，对数据库的增删改查操作都是构建在字典的操作之上的。

字典还是Redis的基本数据类型哈希（hash）的底层实现之一，当哈希数据类型的键和值的长度较大或者键值对数量较多的时候，Redis就会把字典作为哈希数据类型的底层实现。

字典还是Redis的基本数据类型有序集合（zset）的底层实现之一，当有序集合中的所有元素的成员长度较长或者元素个数较多的时候，Redis就会把跳跃表和哈希表作为有序集合的内部实现。

### 字典的实现

在Redis中的字典是由`dict`结构表示的，其底层实现使用了哈希表，一个哈希表包含多个哈希表结点，每一个哈希表结点都保存了字典中的一个键值对。下面我们一个一个地详细了解一下。

### 字典结构

字典是由`dict`结构表示的，它包含以下几个属性：

*   `type`属性：一个指向`dictType`结构的指针，每个`dictType`结构都保存了一套针对其特定类型键值对操作的函数。
*   `privdata`属性：保存了需要传给其特定类型函数的可选参数。
*   `ht`属性：一个包含两个项的数组，每一项都是一个哈希表。一般情况下，字典只使用第一个哈希表，只由在重新散列（rehash）的时候才会用到第二个哈希表。
*   `rehashidx`属性：用于记录重新散列（rehash）的进度，当没有重新散列（rehash）的时候，它的值为-1。

其中，`type`属性和`privdata`属性组合以后，就可以针对不同类型的键值对做不同的处理操作，比如：计算哈希值、复制键、复制值、对比键、销毁键、销毁值等等。

### 哈希表

哈希表使用`dictht`结构表示，它包含以下几个属性：

*   `table`属性：一个哈希表数组，数组中每个项都是指向哈希表结点的指针，每一个哈希表结点都保存了字典中的一个键值对。
*   `size`属性：哈希表的大小，也是就是哈希表数组（`table`）的大小。
*   `sizemask`属性：哈希表大小掩码，用于计算索引值，一直等于哈希表大小（`size`）-1。
*   `used`属性：哈希表中已有结点的数量。

### 哈希表结点

哈希表结点使用`dictEntry`结构表示，它包含以下几个属性：

*   `key`属性：用于保存键值对中的键。
*   `v`属性：用于保存键值对中的值。它可以是一个指针，也可以是一个`uint64_t`的整数，也可以是一个`int64_t`的整数。
*   `next`属性：一个指向下一个哈希表结点的指针。当发生键冲突的时候，它可以把多个哈希表结点连接起来，形成一个单向链表。

### 字典示例

说了这么多，都比较抽象不容易理解，我们来举个例子：

![万猫学社](https://img2022.cnblogs.com/other/145687/202203/145687-20220317102220227-801760346.png)

这就是一个字典的内部结构，其中有3个键值对，键分别是：万、猫、学社。

> 最后，谢谢你这么帅，还给我**点赞**和**关注**。

微信公众号：万猫学社

微信扫描二维码

关注后回复「电子书」

获取12本Java必读技术书籍

![](https://images.cnblogs.com/cnblogs_com/heihaozi/1575453/o_onemore.jpg)

![](https://images.cnblogs.com/cnblogs_com/heihaozi/1575453/o_onemore.jpg)

作者：[万猫学社](http://www.cnblogs.com/heihaozi/)  
出处：[http://www.cnblogs.com/heihaozi/](http://www.cnblogs.com/heihaozi/)  
版权声明：本文遵循 [CC 4.0 BY-NC-SA](http://creativecommons.org/licenses/by-nc-sa/4.0/) 版权协议，转载请附上原文出处链接和本声明。  
微信扫描二维码，关注**万猫学社**，回复「**电子书**」，免费获取12本Java必读技术书籍。