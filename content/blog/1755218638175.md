---
layout: post
title: 'ã€æ¸²æŸ“æµæ°´çº¿ã€‘[å‡ ä½•é˜¶æ®µ]-[å‡ ä½•ç€è‰²]ä»¥UnityURPä¸ºä¾‹'
date: "2025-08-15T00:43:58Z"
---
ã€æ¸²æŸ“æµæ°´çº¿ã€‘\[å‡ ä½•é˜¶æ®µ\]-\[å‡ ä½•ç€è‰²\]ä»¥UnityURPä¸ºä¾‹
===================================

![ã€æ¸²æŸ“æµæ°´çº¿ã€‘[å‡ ä½•é˜¶æ®µ]-[å‡ ä½•ç€è‰²]ä»¥UnityURPä¸ºä¾‹](https://img2024.cnblogs.com/blog/3685400/202508/3685400-20250814152452812-450212077.png) ã€ŠUnity URPå‡ ä½•ç€è‰²å™¨æŠ€æœ¯è§£æã€‹æ‘˜è¦ï¼š å‡ ä½•ç€è‰²å™¨æ˜¯URPä¸­å”¯ä¸€æ”¯æŒè‡ªå®šä¹‰å›¾å…ƒç”Ÿæˆçš„ç€è‰²å™¨é˜¶æ®µï¼ˆéƒ¨åˆ†å¹³å°å—é™ï¼‰ã€‚å®ƒä½äºé¡¶ç‚¹/æ›²é¢ç»†åˆ†ç€è‰²å™¨ä¹‹åï¼Œå¯æ¥æ”¶å®Œæ•´å›¾å…ƒæ•°æ®å¹¶é€šè¿‡æµè¾“å‡ºæœºåˆ¶åŠ¨æ€ä¿®æ”¹å‡ ä½•ç»“æ„ï¼Œæ”¯æŒé¡¶ç‚¹å¢åˆ æ”¹æ“ä½œã€‚å…¸å‹åº”ç”¨åŒ…æ‹¬æ¨¡å‹ç»†åˆ†ï¼ˆå¦‚å°†ä¸‰è§’å½¢æ‹†åˆ†ä¸ºå­ä¸‰è§’å½¢ï¼‰å’Œè½®å»“çº¿ç”Ÿæˆã€‚å®ç°æ—¶éœ€å£°æ˜#pragma geometryï¼Œä½¿ç”¨TriangleStreamç­‰è¾“å‡ºæµç±»å‹ï¼Œå¹¶é€šè¿‡maxvertexcountæ§åˆ¶é¡¶ç‚¹è¾“å‡ºé‡ã€‚éœ€æ³¨æ„è¯¥æŠ€æœ¯å¯¹DX11/OpenGL ES3.2åŠä»¥ä¸ŠAPIçš„ä¾èµ–ï¼Œç§»åŠ¨ç«¯å…¼å®¹æ€§é—®é¢˜

*   å…è®¸è‡ªå®šä¹‰å¢åŠ å’Œåˆ›å»ºæ–°å›¾å…ƒï¼Œ**å”¯ä¸€ä¸€ä¸ªèƒ½è‡ªå®šä¹‰å¢åŠ æ–°å›¾å…ƒçš„ç€è‰²å™¨**ã€‚ï¼ˆéƒ¨åˆ†å¹³å°æ”¯æŒï¼Œç§»åŠ¨ç«¯å¾ˆå¤šä¸æ”¯æŒã€appleçš„metalä¸æ”¯æŒï¼‰

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

â€Œ**ä½œç”¨**â€Œ
========

*   åŸºäºå›¾å…ƒç”Ÿæˆæ–°å‡ ä½•ä½“ï¼ˆå¦‚å°†ç‚¹æ‰©å±•ä¸ºç²’å­ï¼‰ï¼Œä½äºæ›²é¢ç»†åˆ†åã€å…‰æ …åŒ–å‰ â€Œã€‚
*   è¿™æ˜¯ä¸€ä¸ªâ€Œ**å¯é€‰**â€Œé˜¶æ®µã€‚å®ƒåœ¨æ›²é¢ç»†åˆ†ç€è‰²å™¨ä¹‹åè¿è¡Œï¼ˆæˆ–åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¹‹åï¼Œå¦‚æœæ²¡æœ‰æ›²é¢ç»†åˆ†ï¼‰ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå®Œæ•´çš„å›¾å…ƒï¼ˆç‚¹ã€çº¿æˆ–ä¸‰è§’å½¢ï¼Œä»¥åŠå…¶æ‰€æœ‰é¡¶ç‚¹ï¼‰ï¼Œå¯ä»¥è¾“å‡ºé›¶ä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªä¿®æ”¹è¿‡çš„æˆ–å…¨æ–°çš„å›¾å…ƒï¼ˆç‚¹ã€çº¿ã€ä¸‰è§’å¸¦ï¼‰ã€‚â€Œ

â€Œ**é…ç½®**â€Œ
========

*   Shader ä¸­å£°æ˜Â `#pragma geometry geom`ã€‚

**æ ¸å¿ƒå·¥ä½œåŸç†**
==========

*   æ•°æ®å¤„ç†æµç¨‹ï¼š
    *   è¾“å…¥é˜¶æ®µï¼šæ¥æ”¶å®Œæ•´å›¾å…ƒæ•°æ®ï¼ˆç‚¹/çº¿/ä¸‰è§’å½¢åŠå…¶é‚»æ¥å˜ä½“ï¼‰çš„é¡¶ç‚¹æ•°ç»„
    *   å¤„ç†é˜¶æ®µï¼šé€šè¿‡æµè¾“å‡ºå¯¹è±¡åŠ¨æ€ä¿®æ”¹å‡ ä½•æ•°æ®ï¼Œæ”¯æŒé¡¶ç‚¹å¢åˆ æ”¹æ“ä½œ
    *   è¾“å‡ºé˜¶æ®µï¼šä½¿ç”¨Append()æ–¹æ³•å°†æ–°é¡¶ç‚¹å†™å…¥æµå¯¹è±¡ï¼ŒRestartStrip()é‡ç½®ä¸‰è§’å¸¦
*   å›¾å…ƒæ“ä½œæœºåˆ¶ï¼š
    *   å¢åˆ æ§åˆ¶ï¼šé€šè¿‡maxvertexcounté™åˆ¶å•æ¬¡è°ƒç”¨æœ€å¤§è¾“å‡ºé¡¶ç‚¹æ•°ï¼ˆå»ºè®®å€¼3-20ä¸ªï¼‰
    *   ä¿®æ”¹æ–¹å¼ï¼šåœ¨é½æ¬¡è£å‰ªç©ºé—´é‡æ–°è®¡ç®—é¡¶ç‚¹ä½ç½®
    *   åˆ†è£‚å®ç°ï¼šä¾‹å¦‚å°†ä¸‰è§’å½¢æ‹†åˆ†ä¸ºå¤šä¸ªå­ä¸‰è§’å½¢æ—¶éœ€é‡æ–°è®¡ç®—æ³•çº¿

**URPå®ç°æ­¥éª¤**
===========

*   ShaderåŸºç¡€ç»“æ„ï¼š
    
        hlsl
        Shader "Custom/URPGeoShader" {
            Properties { _Extrude("Extrude", Float) = 0.1 }
            SubShader {
                Pass {
                    HLSLPROGRAM
                    #pragma vertex vert
                    #pragma geometry geom
                    #pragma fragment frag
                    #include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"
        
                    struct v2g {
                        float4 posOS : TEXCOORD0;
                        float3 normalOS : NORMAL;
                    };
        
                    struct g2f {
                        float4 posCS : SV_POSITION;
                        float3 normalWS : TEXCOORD0;
                    };
        
                    [maxvertexcount(6)]
                    void geom(triangle v2g input[3], inout TriangleStream<g2f> stream) {
                        // å‡ ä½•å¤„ç†é€»è¾‘
                    }
                    ENDHLSL
                }
            }
        }
        
    
*   å…³é”®å‚æ•°è¯´æ˜ï¼š
    
    *   PrimitiveTypeï¼šæ”¯æŒpoint/line/triangleåŠå…¶é‚»æ¥ç±»å‹
    *   Streamç±»å‹ï¼šPointStream/LineStream/TriangleStreamä¸‰ç§è¾“å‡ºæµ
    *   æ€§èƒ½ä¼˜åŒ–ï¼šå»ºè®®è¾“å‡ºæ ‡é‡æ€»æ•°æ§åˆ¶åœ¨20ä¸ªä»¥å†…

å…¸å‹åº”ç”¨æ¡ˆä¾‹
======

æ¨¡å‹ç»†åˆ†ï¼š
-----

    hlsl
    void geom(triangle v2g input[3], inout TriangleStream<g2f> stream) {
        float3 center = (input[0].posOS + input[1].posOS + input[2].posOS) / 3;
        for(int i=0; i<3; i++) {
            g2f o;
            o.posCS = UnityObjectToClipPos(center);
            stream.Append(o);
            o.posCS = UnityObjectToClipPos(input[i].posOS);
            stream.Append(o);
            o.posCS = UnityObjectToClipPos(input[(i+1)%3].posOS);
            stream.Append(o);
            stream.RestartStrip();
        }
    }
    

è½®å»“çº¿ç”Ÿæˆï¼š
------

    hlsl
    [maxvertexcount(6)]
    void geom(triangle v2g input[3], inout TriangleStream<g2f> stream) {
        // åŸå§‹ä¸‰è§’å½¢
        for(int i=0; i<3; i++) {
            g2f o;
            o.posCS = UnityObjectToClipPos(input[i].posOS);
            stream.Append(o);
        }
        stream.RestartStrip();
    
        // å¤–æ‰©è½®å»“
        float extrude = _Extrude;
        for(int i=0; i<3; i++) {
            g2f o;
            float4 offset = float4(input[i].normalOS * extrude, 0);
            o.posCS = UnityObjectToClipPos(input[i].posOS + offset);
            stream.Append(o);
        }
    }
    

æ³¨æ„äº‹é¡¹ï¼š
=====

*   å¹³å°å…¼å®¹æ€§ï¼šéœ€DX11/OpenGL ES3.2ä»¥ä¸ŠAPIæ”¯æŒ
*   ç§»åŠ¨ç«¯é™åˆ¶ï¼šéƒ¨åˆ†ä½ç«¯è®¾å¤‡å¯èƒ½ä¸æ”¯æŒå‡ ä½•ç€è‰²å™¨
*   æ€§èƒ½å½±å“ï¼šå»ºè®®åœ¨PCå¹³å°ä½¿ç”¨ï¼Œç§»åŠ¨ç«¯éœ€ä¸¥æ ¼æµ‹è¯•

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰