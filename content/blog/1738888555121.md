---
layout: post
title: '基于开源Drasi 实时监控和自动响应系统'
date: "2025-02-07T00:35:55Z"
---
基于开源Drasi 实时监控和自动响应系统
=====================

Drasi 是微软使用MIT协议开源的一个项目，已经提交到CNCF孵化，github：[https://github.com/drasi-project/drasi-platform/](https://github.com/drasi-project/drasi-platform/) ，他提供了一个集成解决方案，可以用于监控变化并自动做出适当的响应，解决扩展事件驱动系统所面临的挑战。它提供了一个统一的框架，降低了复杂性并能确保及时响应，使开发人员无需手动构建源（Source）：这些源可监控各种数据点，包括应用程序日志、数据库变化和系统指标。

Drasi 是一种全面的解决方案，提供内置功能来跟踪特定事件的系统日志和更改源、评估它们的相关性并自动启动适当的反应。 Drasi 包含以下三个核心的基本组件：

*   源**（Source）：**这些源可监控各种数据点，包括应用程序日志、数据库变化和系统指标。源可以实时跟踪变化，捕获数据而无需将其复制到中央存储库或数据湖。
*   连续查询（Continuous Query）：Drasi 不依赖传统的时间点查询，而是使用连续查询，在数据到达时对其进行评估。这些查询是使用 Cypher 查询语言编写的，整合了多个源的信息，无需人工干预即可不断地更新结果。
*   响应（Reaction）：当变化符合连续查询中定义的标准时，Drasi 会自动触发响应，包括发送警报、更新系统或根据特定业务需求启动补救措施等任务。

![](https://img2024.cnblogs.com/blog/562987/202411/562987-20241101164801526-1592509483.png)

Cypher 支持
=========

  
连续查询是使用Cypher 查询语言的子集编写的。如果您是 Cypher 新手，Cypher 查询语言的原始创建者 Neo4J 有很多资源可以帮助您理解、学习和尝试 Cypher，包括：

*   [入门](https://neo4j.com/docs/getting-started/cypher-intro/)
*   [备忘单](https://neo4j.com/docs/cypher-cheat-sheet/current/)

它是一种被严重低估的查询语言，虽然大多数查询也可以转换为关系 SQL，使用 WITH 子句的 Cypher 线性构造更容易推理。

Cypher 的关键之一（至少在图形数据库的上下文中）是它有一种很好的方法将“JOIN”操作表示为图形遍历。

    MATCH (p:Person)-\[r\]-(c:Company) RETURN p.Name, c.Name  

其中 \`r\` 可以表示两个集合 \`Person\` 和 \`Company\` 之间的任何关系（又称为 \`JOIN\`），例如 \`WORKS\_AT\`、\`EMPLOYED\_BY\`、\`CONTRACTOR\_FOR\` 等。

Drasi 不仅仅是在数据上运行图形查询，它还使用 Cypher 查询语言作为一种方便的方式来表达您想要观察的数据变化。

  

Dapr 支持
=======

Drasi 的基础架构是Dapr 支撑的，在以下方面支持：

###### **(1) 事件源与 Dapr 的集成**

*   Drasi 支持多种数据源（如日志、数据库更新、Azure Event Grid 等）。而 Dapr 的 **发布/订阅（Pub/Sub）** 功能可用于在不同服务间传递事件消息。例如，Dapr 的 Pub/Sub 组件（如 Redis、Azure Service Bus）可作为 Drasi 的事件源之一，帮助 Drasi 捕获跨系统的实时事件流。
    

###### （2）**响应动作触发 Dapr 服务**

*   Drasi 的响应（Reaction）机制可触发自定义操作，例如调用外部 API 或启动修复流程。在此场景下，Dapr 的 **服务调用（Service Invocation）** 功能可用于安全、可靠地调用其他微服务，或在 Kubernetes 环境中通过 Sidecar 代理完成跨服务通信56。
    

###### （3）**状态管理与查询优化**

*   Dapr 的 **状态管理（State Management）** 组件支持持久化存储（如 Redis、MySQL），可能被 Drasi 用于缓存连续查询的中间结果或历史数据，从而提升查询效率56。
    

* * *

##### **(4) 技术生态的互补性**

*   **Dapr 的跨语言支持**：Dapr 提供多语言 SDK（如 .NET、Java、Go），而 Drasi 的查询语言 CQL 基于图数据库语法。两者结合时，Dapr 可帮助 Drasi 兼容更多异构系统，扩展其应用场景58。
    
*   **Kubernetes 部署**：Dapr 在 Kubernetes 中通过 Sidecar 注入运行，Drasi 同样支持云原生部署。两者可通过 Kubernetes 的注解（Annotations）协同配置，例如通过 Dapr 的服务发现机制优化 Drasi 的事件路由
    

  

  

参考文章：

*   ### 使用 Drasi 检测数据变化并做出智能反应：[https://opensource.microsoft.com/blog/2024/10/22/detect-and-react-intelligently-to-changes-in-data-with-drasi/](https://opensource.microsoft.com/blog/2024/10/22/detect-and-react-intelligently-to-changes-in-data-with-drasi/ "https://opensource.microsoft.com/blog/2024/10/22/detect-and-react-intelligently-to-changes-in-data-with-drasi/")
    

  

欢迎大家扫描下面二维码成为我的客户，扶你上云

![](https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg)