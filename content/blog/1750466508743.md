---
layout: post
title: 'åœ¨æœ¬åœ°è°ƒè¯• GitLab CI Pipeline (WSLæ­å»ºGitLab Runner)'
date: "2025-06-21T00:41:48Z"
---
åœ¨æœ¬åœ°è°ƒè¯• GitLab CI Pipeline (WSLæ­å»ºGitLab Runner)
=============================================

ğŸ’¡ ä¸ºä»€ä¹ˆæœ¬åœ°æ­å»º
==========

æœ‰æ—¶å€™æˆ‘ä»¬å¯¹å…¬å¸è¿œç«¯Gitlab Serverçš„ä¸»åˆ†æ”¯ï¼ˆmainï¼‰æ²¡æœ‰æƒé™ã€‚åœ¨è°ƒè¯• CI/CD æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¾‘ `.gitlab-ci.yml`ï¼Œç„¶åæäº¤ï¼Œå†è¿›è¡Œåˆå¹¶ï¼Œæ‰èƒ½æŸ¥çœ‹ Pipeline çš„æ‰§è¡Œç»“æœã€‚

GitLab Runner æœ‰æ—¶å€™æ˜¾ç¤ºâ€œ**ç­‰å¾…ä¸­ï¼ˆPendingï¼‰**â€ï¼Œè¿™é€šå¸¸æ˜¯å› ä¸ºèµ„æºæœ‰é™ï¼Œå…¶ä»–äººä¹Ÿæœ‰å¹¶è¡Œçš„ Pipeline ä»»åŠ¡ã€‚

åœ¨ Windows ä¸Šåˆ›å»º GitLab ç¯å¢ƒå’Œ GitLab Runner å¹¶ä¸å®¹æ˜“ã€‚

ç”±äºæˆ‘ä»¬ä¸€èˆ¬ä¸ä½¿ç”¨ Linux å‘è¡Œç‰ˆä½œä¸ºä¸»æ“ä½œç³»ç»Ÿï¼Œ**WSL æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆ**ã€‚

* * *

ğŸ› ï¸ ä½¿ç”¨ WSL å’Œæœ¬åœ° GitLab Runner æ­å»º GitLab CI/CD
============================================

ğŸ“¦ å‰ææ¡ä»¶
-------

éœ€è¦å®‰è£… WSLï¼ˆä¾‹å¦‚ï¼šUbuntu 22.04.5 LTSï¼‰ã€‚

å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼š

    sudo apt update
    sudo apt install -y curl openssh-server ca-certificates tzdata perl
    sudo apt install -y postfix
    

* * *

ğŸ”§ å®‰è£… GitLab CE
---------------

### æ·»åŠ  GitLab ä»“åº“

    curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
    

### å®‰è£… GitLab CE

    sudo EXTERNAL_URL="http://localhost" apt-get install gitlab-ce
    

### å¯åŠ¨å¹¶é…ç½® GitLab

    sudo gitlab-ctl reconfigure
    sudo gitlab-ctl start
    

ğŸ“Œ **é»˜è®¤ `root` ç”¨æˆ·çš„å¯†ç ä¿å­˜åœ¨ï¼š**  
`/etc/gitlab/initial_root_password`

ğŸ”‘ **å¯ä»¥åœ¨ä»¥ä¸‹é¡µé¢æ›´æ”¹å¯†ç ï¼š**  
[http://localhost/-/user\_settings/password/edit](http://localhost/-/user_settings/password/edit)  
â†’ ç¼–è¾‘ä¸ªäººèµ„æ–™ â†’ å¯†ç 

è¿™è®©ä½ æˆä¸º GitLab çš„ root ç”¨æˆ·ã€‚  
å¯¹äºå¿«é€Ÿæµ‹è¯•æ¥è¯´ï¼Œä¸å†ä¼šé‡åˆ°æƒé™é—®é¢˜ï¼Œéå¸¸æ–¹ä¾¿ã€‚  
![](https://img2024.cnblogs.com/blog/1201453/202506/1201453-20250620160211023-825484011.png)
-------------------------------------------------------------------------------------------------------------------------------------------------

âš™ï¸ å®‰è£… GitLab Runner
-------------------

### æ·»åŠ  GitLab Runner ä»“åº“

    curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh | sudo bash
    

### å®‰è£… GitLab Runner

    sudo apt-get install gitlab-runner
    

* * *

ğŸš€ æ³¨å†Œ GitLab Runner
-------------------

1.  æ‰“å¼€ï¼š`CI/CD > Runners > Create a new runner`
2.  æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

    gitlab-runner register --url http://localhost --token <yourToken>
    

âœ… **é…ç½®å·²ä¿å­˜è‡³ï¼š**  
`/etc/gitlab-runner/config.toml`

### éªŒè¯ Runner æ˜¯å¦æ­£å¸¸

    sudo gitlab-runner verify
    

ğŸŒ **æŸ¥çœ‹æ‰€æœ‰ Runnerï¼š**

    http://localhost/admin/runners
    

![](https://img2024.cnblogs.com/blog/1201453/202506/1201453-20250620160423775-566016287.png)
--------------------------------------------------------------------------------------------

ğŸŒ ä½¿ç”¨ IP è®¿é—® GitLab
------------------

### æŸ¥æ‰¾æœ¬æœº IP åœ°å€

    hostname -I
    

ç¤ºä¾‹è¾“å‡ºï¼š

    172.24.208.12
    

### ä¿®æ”¹ GitLab é…ç½®æ–‡ä»¶

    sudo vi /etc/gitlab/gitlab.rb
    

å°†ä»¥ä¸‹è¡Œä¿®æ”¹ä¸ºä½ çš„ IP åœ°å€ï¼š

    external_url 'http://172.24.208.12'
    

### é‡æ–°é…ç½® GitLab

    sudo gitlab-ctl reconfigure
    

* * *

ğŸ” ä¹‹åå¦‚æœPipelineä»»åŠ¡å¤±è´¥å¯ä»¥æ‰‹åŠ¨ç‚¹å‡» â€œRetryâ€ é‡æ–°è¿è¡Œ Pipelineã€‚

  
ä½œè€…ï¼š[Restæ¢è·¯è€…](http://www.cnblogs.com/Java-Starter/)  
å‡ºå¤„ï¼š[http://www.cnblogs.com/Java-Starter/](http://www.cnblogs.com/Java-Starter/)  
æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„è¯·ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œè¯·åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡è¿æ¥  
Githubï¼š[https://github.com/cjy513203427](https://github.com/cjy513203427)