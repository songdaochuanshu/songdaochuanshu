---
layout: post
title: 'ã€URPã€‘Unity[åå¤„ç†]é¢œè‰²æ›²çº¿ColorCurves'
date: "2025-11-04T00:41:36Z"
---
ã€URPã€‘Unity\[åå¤„ç†\]é¢œè‰²æ›²çº¿ColorCurves
================================

![ã€URPã€‘Unity[åå¤„ç†]é¢œè‰²æ›²çº¿ColorCurves](https://img2024.cnblogs.com/blog/3685400/202511/3685400-20251103171311429-334022559.png) ColorCurves æ˜¯ Unity é€šç”¨æ¸²æŸ“ç®¡çº¿(URP)ä¸­çš„ä¸€ç§é«˜çº§é¢œè‰²åˆ†çº§å·¥å…·ï¼Œå®ƒå…è®¸é€šè¿‡æ›²çº¿ç²¾ç»†è°ƒæ•´å›¾åƒçš„è‰²ç›¸ã€é¥±å’Œåº¦å’Œäº®åº¦ã€‚è¿™ç§å·¥å…·æœ€åˆåœ¨ä¸“ä¸šå½±è§†åæœŸè½¯ä»¶(å¦‚ Fusion)ä¸­æˆç†Ÿåº”ç”¨ï¼Œå

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ColorCurves æ˜¯ Unity é€šç”¨æ¸²æŸ“ç®¡çº¿(URP)ä¸­çš„ä¸€ç§é«˜çº§é¢œè‰²åˆ†çº§å·¥å…·ï¼Œå®ƒå…è®¸é€šè¿‡æ›²çº¿ç²¾ç»†è°ƒæ•´å›¾åƒçš„è‰²ç›¸ã€é¥±å’Œåº¦å’Œäº®åº¦ã€‚è¿™ç§å·¥å…·æœ€åˆåœ¨ä¸“ä¸šå½±è§†åæœŸè½¯ä»¶(å¦‚ Fusion)ä¸­æˆç†Ÿåº”ç”¨ï¼Œåè¢«å¼•å…¥æ¸¸æˆå¼•æ“ç”¨äºå®æ—¶æ¸²æŸ“çš„è‰²å½©æ§åˆ¶ã€‚

ColorCurves æä¾›äº†8æ¡ç‹¬ç«‹æ›²çº¿ï¼ŒåŒ…æ‹¬ï¼š

*   Master(æ•´ä½“äº®åº¦)
    *   â€Œ**åŠŸèƒ½**â€Œï¼šæ•´ä½“è°ƒæ•´å›¾åƒçš„äº®åº¦å’Œå¯¹æ¯”åº¦ã€‚
    *   â€Œ**å®ç°**â€Œï¼šé€šè¿‡è°ƒæ•´æ›²çº¿å½¢çŠ¶æ§åˆ¶å…¨å±€äº®åº¦ï¼Œæ›²çº¿å‘ä¸Šæå‡äº®åº¦ï¼Œå‘ä¸‹é™ä½äº®åº¦
*   Red/Green/Blue(å•é€šé“è°ƒæ•´ï¼Œä¸‰æ¡æ›²çº¿)
    *   **åŠŸèƒ½**â€Œï¼šåˆ†åˆ«å•ç‹¬è°ƒæ•´çº¢ã€ç»¿ã€è“é€šé“çš„äº®åº¦å’Œè‰²å½©å¹³è¡¡ã€‚
    *   â€Œ**å®ç°**â€Œï¼šé’ˆå¯¹åˆ†é‡è¿›è¡Œç‹¬ç«‹è°ƒèŠ‚ï¼Œå½±å“å›¾åƒä¸­çº¢ã€ç»¿è“åŒºåŸŸçš„æ˜¾è‰²å¼ºåº¦
*   HueVsHue(è‰²è°ƒæ›¿æ¢ **è‰²ç›¸-è‰²ç›¸æ›²çº¿**)
    *   â€Œ**åŠŸèƒ½**â€Œï¼šåŸºäºè‰²ç›¸æ›¿æ¢é¢œè‰²ï¼ˆå¦‚å°†çº¢è‰²æ›¿æ¢ä¸ºè“è‰²ï¼‰ã€‚
    *   â€Œ**å®ç°**â€Œï¼šé€šè¿‡æ˜ å°„åŸå§‹è‰²ç›¸åˆ°ç›®æ ‡è‰²ç›¸ï¼Œå®ç°é¢œè‰²è½¬æ¢
*   HueVsSat(è‰²è°ƒé¥±å’Œåº¦è°ƒæ•´ **è‰²ç›¸-é¥±å’Œåº¦æ›²çº¿**)
    *   **åŠŸèƒ½**â€Œï¼šæ ¹æ®è‰²ç›¸è°ƒæ•´ç‰¹å®šé¢œè‰²çš„é¥±å’Œåº¦ã€‚
    *   â€Œ**å®ç°**â€Œï¼šé€‰æ‹©ç‰¹å®šè‰²ç›¸èŒƒå›´åï¼Œå¢åŠ æˆ–é™ä½å…¶é¥±å’Œåº¦
*   SatVsSat(é¥±å’Œåº¦å¯¹æ¯” **é¥±å’Œåº¦-é¥±å’Œåº¦æ›²çº¿**)
    *   â€Œ**åŠŸèƒ½**â€Œï¼šåŸºäºå½“å‰é¥±å’Œåº¦è¿›ä¸€æ­¥è°ƒæ•´é¥±å’Œåº¦ã€‚
    *   â€Œ**å®ç°**â€Œï¼šå¯¹ä½é¥±å’Œåº¦åŒºåŸŸå¢å¼ºæˆ–é«˜é¥±å’Œåº¦åŒºåŸŸæŠ‘åˆ¶ï¼Œå®ç°éçº¿æ€§è°ƒæ•´
*   LumVsSat(äº®åº¦é¥±å’Œåº¦å…³ç³» **äº®åº¦-é¥±å’Œåº¦æ›²çº¿**)
    *   **åŠŸèƒ½**â€Œï¼šæ ¹æ®äº®åº¦è°ƒæ•´é¥±å’Œåº¦ï¼ˆå¦‚å¢å¼ºæš—éƒ¨é¥±å’Œåº¦ï¼‰ã€‚
    *   â€Œ**å®ç°**â€Œï¼šåœ¨ä½äº®åº¦åŒºåŸŸæå‡é¥±å’Œåº¦ä»¥å¢å¼ºè§†è§‰å¯¹æ¯”ï¼Œæˆ–åœ¨é«˜äº®åº¦åŒºåŸŸé™ä½é¥±å’Œåº¦é¿å…è¿‡æ›

**å‘å±•å†å²**
========

é¢œè‰²æ›²çº¿æŠ€æœ¯èµ·æºäºç”µå½±å·¥ä¸šçš„åæœŸè°ƒè‰²æµç¨‹ï¼Œæ—©æœŸåœ¨ DaVinci Resolve ç­‰ä¸“ä¸šè°ƒè‰²è½¯ä»¶ä¸­å®ç°ã€‚Unity åœ¨ 2017 å¹´å¼•å…¥ Post-processing Stack v1 æ—¶é¦–æ¬¡åŒ…å«äº†åŸºç¡€æ›²çº¿è°ƒæ•´ï¼Œ2019 å¹´ URP æ­£å¼ç‰ˆå°†å…¶æ•´åˆä¸º ColorCurves æ¨¡å—ï¼Œå¹¶å¢åŠ äº†é’ˆå¯¹æ¸¸æˆä¼˜åŒ–çš„ ACES è‰²å½©ç©ºé—´æ”¯æŒã€‚

**å®ç°åŸç†**
========

ColorCurves åœ¨æ¸²æŸ“ç®¡çº¿çš„åå¤„ç†é˜¶æ®µå·¥ä½œï¼Œä½äºè‰²è°ƒæ˜ å°„ä¹‹å‰ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š

*   å°†è¾“å…¥å›¾åƒåˆ†è§£ä¸º HSL åˆ†é‡
*   å¯¹æ¯ä¸ªåˆ†é‡åº”ç”¨é¢„å®šä¹‰çš„æ›²çº¿å˜æ¢
*   é‡æ–°ç»„åˆåˆ†é‡å¹¶è¾“å‡ºåˆ°ä¸‹ä¸€å¤„ç†é˜¶æ®µ

**æ›²çº¿æ˜ å°„åŸç†**
----------

ColorCurvesé€šè¿‡8æ¡ç‹¬ç«‹æ›²çº¿å¯¹å›¾åƒè¿›è¡Œåˆ†é€šé“å¤„ç†ï¼Œæ¯æ¡æ›²çº¿é‡‡ç”¨256ä¸ªæ§åˆ¶ç‚¹çš„æŸ¥æ‰¾è¡¨(LUT)å®ç°éçº¿æ€§æ˜ å°„ã€‚ä¾‹å¦‚Masteræ›²çº¿é‡‡ç”¨xè½´(è¾“å…¥äº®åº¦)åˆ°yè½´(è¾“å‡ºäº®åº¦)çš„æ˜ å°„å…³ç³»ï¼Œé€šè¿‡è´å¡å°”æ’å€¼ç®—æ³•å®ç°å¹³æ»‘è¿‡æ¸¡ã€‚

### è´å¡å°”æ›²çº¿

*   â€Œ**é€šç”¨å…¬å¼**
    
    å¯¹äºné˜¶è´å¡å°”æ›²çº¿ï¼Œå…¶å‚æ•°æ–¹ç¨‹ä¸ºï¼š
    
    $B(t)=\\sum\_{i=0}{n}\\binom{n}{i}(1âˆ’t)t^iP\_i,t\\in\[0,1\]$
    
    å…¶ä¸­ï¼š
    
    *   $P\_i$ä¸ºæ§åˆ¶ç‚¹ï¼Œå…±_n_+1ä¸ªï¼›
    *   $\\binom{n}{i}$ä¸ºç»„åˆæ•°ï¼›
    *   tä¸ºå‚æ•°ï¼Œæ§åˆ¶æ›²çº¿ä¸Šçš„ä½ç½®â€Œã€‚
*   â€Œ**å¸¸è§ç±»å‹**â€Œ
    
    *   â€Œ**çº¿æ€§ 1é˜¶**â€Œï¼šä¸¤ç‚¹é—´ç›´çº¿ï¼Œå…¬å¼ä¸º
        *   $B(t)=(1âˆ’t)P\_0+tP\_1$
    *   â€Œ**äºŒæ¬¡ 2é˜¶**â€Œï¼š3ä¸ªæ§åˆ¶ç‚¹ï¼Œå…¬å¼ä¸º
        *   $B(t)=(1âˆ’t)2P\_0+2t(1âˆ’t)P\_1+t2P\_2$
    *   â€Œ**ä¸‰æ¬¡ 3é˜¶**â€Œï¼š4ä¸ªæ§åˆ¶ç‚¹ï¼Œå…¬å¼ä¸º
        *   $B(t)=(1âˆ’t)3P\_0+3(1âˆ’t)2tP\_1+3(1âˆ’t)t2P2+t3P\_3$
        *   ä¸‰æ¬¡è´å¡å°”æ›²çº¿å› å¹³è¡¡è®¡ç®—å¤æ‚æ€§å’Œçµæ´»æ€§ï¼Œæˆä¸ºå›¾å½¢å­¦ä¸­æœ€å¸¸ç”¨çš„ç±»å‹â€Œ
*   **å®ç°æ–¹æ³•**
    
    *   â€Œ**é€’å½’è®¡ç®—**â€Œï¼šé€šè¿‡å¾·å¡æ–¯ç‰¹é‡Œå¥¥ç®—æ³•ï¼ˆDe Casteljau's algorithmï¼‰é€æ­¥æ’å€¼ä¸­é—´ç‚¹â€Œï¼›
        
    *   â€Œ**çŸ©é˜µè¡¨ç¤º**â€Œï¼šå°†ä¸‰æ¬¡è´å¡å°”æ›²çº¿è¡¨ç¤ºä¸ºæ§åˆ¶ç‚¹ä¸åŸºå‡½æ•°çš„çŸ©é˜µä¹˜æ³•â€Œï¼›
        
    *   â€Œ**ä»£ç ç¤ºä¾‹**â€Œï¼ˆUnity/C#ï¼‰ï¼šï¼ˆæ³¨ï¼šå®é™…åº”ç”¨ä¸­éœ€å¤„ç†æµ®ç‚¹ç²¾åº¦å’Œæ€§èƒ½ä¼˜åŒ–ï¼‰â€Œ
        
            csharp
            public Vector3 CalculateBezierPoint(Vector3 p0, Vector3 p1, Vector3 p2, Vector3 p3, float t) {
                float u = 1 - t;
                return u*u*u * p0 + 3*u*u*t * p1 + 3*u*t*t * p2 + t*t*t * p3;
            }
            
        

**é€šé“å¤„ç†æµç¨‹**
----------

*   â€Œ**RGBé€šé“åˆ†ç¦»**â€Œï¼šå…ˆå°†å›¾åƒåˆ†è§£ä¸ºR/G/Bä¸‰ä¸ªé€šé“ï¼š
    
    *   channelR = (R,0,0)
        
    *   channelG = (0,G,0)
        
    *   channelB = (0,0,0)
        
    *   HLSLä¸­å¸¸ç”¨äº®åº¦å…¬å¼Luminance=0.2126Ã—R+0.7152Ã—G+0.0722Ã—B
        
        *   è¯¥å…¬å¼åŸºäºCIE 1931è‰²å½©ç©ºé—´çš„äººçœ¼æ„ŸçŸ¥æƒé‡
    *   RGB\_Separate.hlsl
        
            hlsl
            Texture2D InputTexture : register(t0);
            SamplerState LinearSampler : register(s0);
            
            struct PS_Input {
                float4 Position : SV_POSITION;
                float2 UV : TEXCOORD;
            };
            
            // çº¢è‰²é€šé“åˆ†ç¦»
            float4 PS_RedChannel(PS_Input input) : SV_TARGET {
                float3 color = InputTexture.Sample(LinearSampler, input.UV).rgb;
                return float4(color.r, 0, 0, 1); // ä»…ä¿ç•™Råˆ†é‡
            }
            
            // ç»¿è‰²é€šé“åˆ†ç¦»  
            float4 PS_GreenChannel(PS_Input input) : SV_TARGET {
                float3 color = InputTexture.Sample(LinearSampler, input.UV).rgb;
                return float4(0, color.g, 0, 1); // ä»…ä¿ç•™Gåˆ†é‡
            }
            
            // è“è‰²é€šé“åˆ†ç¦»
            float4 PS_BlueChannel(PS_Input input) : SV_TARGET {
                float3 color = InputTexture.Sample(LinearSampler, input.UV).rgb;
                return float4(0, 0, color.b, 1); // ä»…ä¿ç•™Båˆ†é‡
            }
            
            // äº®åº¦è®¡ç®—
            float4 PS_Luminance(PS_Input input) : SV_TARGET {
                float3 color = InputTexture.Sample(LinearSampler, input.UV).rgb;
                float lum = dot(color, float3(0.2126, 0.7152, 0.0722));
                return float4(lum.xxx, 1); // ç°åº¦è¾“å‡º
            }
            
        
*   â€Œ**æ›²çº¿åº”ç”¨**â€Œï¼š
    
    *   ä¸»é€šé“ï¼šMasteræ›²çº¿åŒæ—¶å½±å“æ‰€æœ‰é€šé“
        
        *   ä½œä¸ºå…¨å±€äº®åº¦è°ƒæ•´æ›²çº¿ï¼Œç›´æ¥å¯¹RGBä¸‰é€šé“è¿›è¡Œç»Ÿä¸€æ˜ å°„ã€‚å…¬å¼ä¸ºï¼šOutput=f\_master(Input)
        *   å…¶ä¸­Inputæ˜¯åŸå§‹äº®åº¦å€¼ï¼ˆ0-1ï¼‰ï¼Œf\_masteræ˜¯ç”¨æˆ·å®šä¹‰çš„æ›²çº¿å‡½æ•°
    *   åˆ†é€šé“ï¼šRed/Green/Blueæ›²çº¿åˆ†åˆ«å¤„ç†å¯¹åº”é€šé“
        
    *   **HueVsHueæ›²çº¿**
        
        *   å®ç°è‰²ç›¸æ›¿æ¢æ•ˆæœï¼Œé€šè¿‡è§’åº¦åç§»æ”¹å˜ç‰¹å®šè‰²ç›¸ã€‚HSVç©ºé—´ä¸­çš„å…¬å¼ï¼šH\_out=H\_in+f\_hue(H\_in)âˆ—360Â°
        *   f\_hueæ˜¯å®šä¹‰åœ¨0-1èŒƒå›´çš„æ›²çº¿ï¼Œè¾“å‡ºå€¼ä½œä¸ºè§’åº¦åç§»é‡ã€‚
    *   **HueVsSatæ›²çº¿**
        
        *   æ§åˆ¶ä¸åŒè‰²ç›¸åŒºåŸŸçš„é¥±å’Œåº¦å¢å¼º/å‡å¼±: S\_out=S\_inâˆ—(1+f\_sat(H\_in))
        *   f\_satæ›²çº¿è¾“å‡º-1åˆ°1çš„å€¼ï¼Œè´Ÿå€¼é™ä½é¥±å’Œåº¦ï¼Œæ­£å€¼å¢åŠ ã€‚
    *   **SatVsSatæ›²çº¿**
        
        *   éçº¿æ€§è°ƒæ•´é¥±å’Œåº¦åˆ†å¸ƒï¼šS\_out=f\_satmap(S\_in)
        *   ç›´æ¥é‡æ˜ å°„é¥±å’Œåº¦å€¼ï¼Œå¸¸ç”¨äºåˆ›å»ºå“‘å…‰æ•ˆæœã€‚
    *   **LumVsSatæ›²çº¿**
        
        *   åŸºäºäº®åº¦æ§åˆ¶é¥±å’Œåº¦ï¼šS\_out=S\_inâˆ—(1+f\_lum(L\_in))
        *   L\_inæ˜¯HSLäº®åº¦å€¼ï¼Œf\_lumæ›²çº¿æ§åˆ¶ä¸åŒäº®åº¦åŒºåŸŸçš„é¥±å’Œåº¦å˜åŒ–
    *   ColorCurves.hlsl
        
        *   ä½¿ç”¨çº¹ç†é‡‡æ ·å®ç°æ›²çº¿æŸ¥æ‰¾ï¼Œæå‡GPUæ‰§è¡Œæ•ˆç‡
        *   RgbToHsv/HsvToRgbéœ€è‡ªè¡Œå®ç°æ ‡å‡†è‰²å½©ç©ºé—´è½¬æ¢
        *   æ›²çº¿å‚æ•°é€šè¿‡çº¹ç†ä¼ å…¥ï¼Œæ”¯æŒä»»æ„å½¢çŠ¶çš„è°ƒæ•´æ›²çº¿
        *   æœ€ç»ˆæ•ˆæœæ˜¯å„æ›²çº¿è°ƒæ•´çš„å åŠ ç»„åˆ
        *   åœ¨C#ä¸­å¯é€šè¿‡Shader.SetGlobalTextureä¼ é€’æ›²çº¿çº¹ç†ï¼Œæˆ–åœ¨CPUç«¯å®ç°ç±»ä¼¼ç®—æ³•å¤„ç†å›¾åƒæ•°æ®ã€‚å®é™…åº”ç”¨æ—¶é€šå¸¸é…åˆUIæ§ä»¶è®©ç”¨æˆ·äº¤äº’å¼è°ƒæ•´æ›²çº¿å½¢çŠ¶ã€‚
        
            // è¾“å…¥å‚æ•°
            Texture2D InputTexture;
            SamplerState LinearSampler;
            float4 HueVsHueCurve; // æ›²çº¿é‡‡æ ·çº¹ç†
            float4 HueVsSatCurve;
            float4 SatVsSatCurve;
            float4 LumVsSatCurve;
            
            float3 ApplyColorCurves(float3 rgb)
            {
                // è½¬æ¢åˆ°HSVç©ºé—´
                float3 hsv = RgbToHsv(rgb);
                float hue = hsv.x;
                float sat = hsv.y;
                float lum = GetLuminance(rgb);
            
                // HueVsHueå¤„ç†
                float hueOffset = SampleCurve(HueVsHueCurve, hue);
                hsv.x = frac(hue + hueOffset);
            
                // HueVsSatå¤„ç†
                float satScale = SampleCurve(HueVsSatCurve, hue) * 2.0 - 1.0;
                hsv.y = sat * (1.0 + satScale);
            
                // SatVsSatå¤„ç†
                hsv.y = SampleCurve(SatVsSatCurve, sat);
            
                // LumVsSatå¤„ç†
                float lumSatScale = SampleCurve(LumVsSatCurve, lum) * 2.0 - 1.0;
                hsv.y = sat * (1.0 + lumSatScale);
            
                // è¿”å›RGBç©ºé—´
                return HsvToRgb(hsv);
            }
            
            // è¾…åŠ©å‡½æ•°
            float SampleCurve(float4 curve, float x)
            {
                return curve.SampleLevel(LinearSampler, float2(x, 0), 0).r;
            }
            
        
*   â€Œ**è‰²ç›¸è½¬æ¢**â€Œï¼šå°†RGBè½¬æ¢ä¸ºHSVè‰²å½©ç©ºé—´å¤„ç†HueVsHueç­‰æ›²çº¿
    
    *   HSVï¼ˆHue, Saturation, Valueï¼‰æ˜¯ä¸€ç§åŸºäºäººç±»è§†è§‰æ„ŸçŸ¥çš„ç›´è§‚é¢œè‰²æ¨¡å‹ï¼Œç”±è‰²ç›¸ï¼ˆHï¼‰ã€é¥±å’Œåº¦ï¼ˆSï¼‰å’Œæ˜åº¦ï¼ˆVï¼‰ä¸‰ä¸ªåˆ†é‡ç»„æˆâ€Œ
        
    *   **åŸºæœ¬æ¦‚å¿µ**
        
        *   â€Œ**è‰²ç›¸H**â€Œï¼šè¡¨ç¤ºé¢œè‰²ç±»å‹ï¼Œå–å€¼èŒƒå›´0Â°-360Â°ï¼ˆå¦‚çº¢è‰²0Â°ã€ç»¿è‰²120Â°ã€è“è‰²240Â°ï¼‰ï¼Œé€šè¿‡è‰²è½®è§’åº¦å®šä½é¢œè‰²â€Œã€‚
        *   â€Œ**é¥±å’Œåº¦S**â€Œï¼šè¡¨ç¤ºé¢œè‰²çº¯åº¦ï¼Œ0%ä¸ºç°è‰²ï¼Œ100%ä¸ºçº¯è‰²ï¼Œæ•°å€¼è¶Šé«˜é¢œè‰²è¶Šé²œè‰³â€Œã€‚
        *   â€Œ**æ˜åº¦V**â€Œï¼šæ§åˆ¶é¢œè‰²äº®åº¦ï¼Œ0%ä¸ºé»‘è‰²ï¼Œ100%ä¸ºæœ€äº®ï¼ˆå¦‚ç™½è‰²éœ€S=0%ã€V=100%ï¼‰â€Œ
    *   **æ¨¡å‹ç‰¹ç‚¹**
        
        *   â€Œ**å…­è§’é”¥ä½“ç»“æ„**â€Œï¼šä»RGBç«‹æ–¹ä½“æ¼”åŒ–è€Œæ¥ï¼Œè‰²è°ƒHæ²¿åœ†å‘¨åˆ†å¸ƒï¼Œé¥±å’Œåº¦Så’Œæ˜åº¦Våˆ†åˆ«è¡¨ç¤ºå¾„å‘å’Œè½´å‘è·ç¦»â€Œã€‚
        *   â€Œ**ç¬¦åˆç›´è§‰**â€Œï¼šæ¯”RGBæ›´æ¥è¿‘ä¼ ç»Ÿç»˜ç”»è°ƒè‰²ä¹ æƒ¯ï¼Œé€‚åˆç›´è§‚è°ƒæ•´é¢œè‰²å±æ€§ï¼ˆå¦‚Photoshopè°ƒè‰²æ¿ï¼‰â€Œã€‚
        *   â€Œ**åˆ†é‡ç‹¬ç«‹**â€Œï¼šäº®åº¦Vä¸é¢œè‰²æ— å…³ï¼Œä»…å½±å“å…‰ç…§å¼ºåº¦ï¼›è‰²è°ƒHå’Œé¥±å’Œåº¦Säº’ä¸å¹²æ‰°â€Œ
    *   RGBè½¬HSV
        
    *   HSVè½¬RGB
        
    *   ColorSpace.hlsl
        
            // RGBè½¬HSV
            float3 RGBtoHSV(float3 rgb) {
                float cmax = max(rgb.r, max(rgb.g, rgb.b));
                float cmin = min(rgb.r, min(rgb.g, rgb.b));
                float delta = cmax - cmin;
            
                float h = 0;
                if (delta != 0) {
                    if (cmax == rgb.r) 
                        h = 60 * fmod(((rgb.g - rgb.b)/delta + 6), 6);
                    else if (cmax == rgb.g) 
                        h = 60 * ((rgb.b - rgb.r)/delta + 2);
                    else 
                        h = 60 * ((rgb.r - rgb.g)/delta + 4);
                }
            
                float s = (cmax == 0) ? 0 : delta / cmax;
                return float3(h, s, cmax);
            }
            
            // HSVè½¬RGB
            float3 HSVtoRGB(float3 hsv) {
                float c = hsv.z * hsv.y;
                float x = c * (1 - abs(fmod(hsv.x / 60, 2) - 1));
                float m = hsv.z - c;
            
                float3 rgb;
                if (hsv.x < 60) rgb = float3(c, x, 0);
                else if (hsv.x < 120) rgb = float3(x, c, 0);
                else if (hsv.x < 180) rgb = float3(0, c, x);
                else if (hsv.x < 240) rgb = float3(0, x, c);
                else if (hsv.x < 300) rgb = float3(x, 0, c);
                else rgb = float3(c, 0, x);
            
                return rgb + m;
            }
            
        

**ç¤ºä¾‹ï¼šå®ç°å†·è‰²è°ƒå¢å¼º**
--------------

    // åœ¨Volumeç»„ä»¶ä¸­æ·»åŠ ColorCurvesé‡è½½
    var curves = volumeProfile.Add<ColorCurves>();
    curves.active = true;
    
    // è°ƒæ•´è“è‰²é€šé“æ›²çº¿
    curves.blue.Override(new AnimationCurve(
        new Keyframe(0, 0),
        new Keyframe(0.5f, 0.7f),
        new Keyframe(1, 1)
    ));
    
    // é™ä½æš–è‰²é¥±å’Œåº¦
    curves.hueVsSat.Override(new AnimationCurve(
        new Keyframe(0.1f, 0.8f),// çº¢è‰²èŒƒå›´
        new Keyframe(0.6f, 1.2f)// è“è‰²èŒƒå›´
    ));
    

è¯¥ç¤ºä¾‹é€šè¿‡æå‡ä¸­é—´è°ƒè“è‰²å’ŒæŠ‘åˆ¶çº¢è‰²é¥±å’Œåº¦ï¼Œå®ç°ç”µå½±çº§å†·è‰²è°ƒæ•ˆæœã€‚

**ä¼½é©¬æ ¡æ­£å¤„ç†**
----------

URPä¼šåœ¨æ›²çº¿å¤„ç†å‰åè‡ªåŠ¨æ‰§è¡Œä¼½é©¬/çº¿æ€§ç©ºé—´è½¬æ¢ï¼Œç¡®ä¿é¢œè‰²æ··åˆç¬¦åˆç‰©ç†æ­£ç¡®æ€§ã€‚å…·ä½“æµç¨‹ï¼š

*   è¾“å…¥å›¾åƒä»sRGBè½¬ä¸ºçº¿æ€§ç©ºé—´
*   åº”ç”¨æ‰€æœ‰æ›²çº¿è°ƒæ•´
*   ç»“æœè½¬æ¢å›sRGBç©ºé—´è¾“å‡º

**æ€§èƒ½ä¼˜åŒ–**
--------

é‡‡ç”¨è®¡ç®—ç€è‰²å™¨å¹¶è¡Œå¤„ç†LUTç”Ÿæˆï¼Œæ¯æ¡æ›²çº¿ä»…éœ€1æ¬¡çº¹ç†é‡‡æ ·ï¼Œ8æ¡æ›²çº¿å…±äº§ç”Ÿçº¦0.3msçš„æ€§èƒ½å¼€é”€ï¼ˆ1080påˆ†è¾¨ç‡ï¼‰ã€‚å»ºè®®é¿å…æ¯å¸§åŠ¨æ€ä¿®æ”¹æ›²çº¿æ§åˆ¶ç‚¹ï¼Œæ”¹ä¸ºé¢„çƒ˜ç„™å¤šå¥—æ›²çº¿é…ç½®ã€‚

**å®Œæ•´ç¤ºä¾‹**
========

*   ColorCurvesExample.cs
    
        using UnityEngine;
        using UnityEngine.Rendering;
        using UnityEngine.Rendering.Universal;
        
        [System.Serializable]
        public class ColorCurvesSettings
        {
            public AnimationCurve masterCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve redCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve greenCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve blueCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve hueVsHueCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve hueVsSatCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve satVsSatCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
            public AnimationCurve lumVsSatCurve = new AnimationCurve(new Keyframe(0f, 0f), new Keyframe(1f, 1f));
        }
        
        public class CustomColorCurvesRenderPass : ScriptableRenderPass
        {
            private Material m_Material;
            private ColorCurvesSettings m_Settings;
        
            public CustomColorCurvesRenderPass(Material material, ColorCurvesSettings settings)
            {
                m_Material = material;
                m_Settings = settings;
            }
        
            public override void Execute(ScriptableRenderContext context, ref RenderingData renderingData)
            {
                if (m_Material == null) return;
        
                CommandBuffer cmd = CommandBufferPool.Get("Color Curves");
        
                // è®¾ç½®æ›²çº¿å‚æ•°
                m_Material.SetTexture("_MasterCurve", CreateCurveTexture(m_Settings.masterCurve));
                m_Material.SetTexture("_RedCurve", CreateCurveTexture(m_Settings.redCurve));
                m_Material.SetTexture("_GreenCurve", CreateCurveTexture(m_Settings.greenCurve));
                m_Material.SetTexture("_BlueCurve", CreateCurveTexture(m_Settings.blueCurve));
                m_Material.SetTexture("_HueVsHueCurve", CreateCurveTexture(m_Settings.hueVsHueCurve));
                m_Material.SetTexture("_HueVsSatCurve", CreateCurveTexture(m_Settings.hueVsSatCurve));
                m_Material.SetTexture("_SatVsSatCurve", CreateCurveTexture(m_Settings.satVsSatCurve));
                m_Material.SetTexture("_LumVsSatCurve", CreateCurveTexture(m_Settings.lumVsSatCurve));
        
                // æ‰§è¡Œåå¤„ç†
                Blit(cmd, renderingData.cameraData.renderer.cameraColorTarget, 
                    renderingData.cameraData.renderer.cameraColorTarget, m_Material);
        
                context.ExecuteCommandBuffer(cmd);
                CommandBufferPool.Release(cmd);
            }
        
            private Texture2D CreateCurveTexture(AnimationCurve curve)
            {
                Texture2D texture = new Texture2D(256, 1, TextureFormat.RFloat, false);
                for (int i = 0; i < 256; i++)
                {
                    float value = curve.Evaluate(i / 255f);
                    texture.SetPixel(i, 0, new Color(value, 0, 0, 0));
                }
                texture.Apply();
                return texture;
            }
        }
        
    

**ä½¿ç”¨æµç¨‹**
========

*   åœ¨ Unity ä¸­åˆ›å»º Volume å¯¹è±¡å¹¶æ·»åŠ  Color Curves æ•ˆæœ
*   è°ƒæ•´å„æ¡æ›²çº¿å‚æ•°
*   é€šè¿‡é¢„è§ˆçª—å£å®æ—¶æŸ¥çœ‹æ•ˆæœ

**å‚æ•°è¯¦è§£ä¸ç”¨ä¾‹**
===========

**Master æ›²çº¿**
-------------

*   â€Œ**ä½œç”¨**â€Œï¼šå…¨å±€äº®åº¦è°ƒæ•´
*   â€Œ**ç”¨ä¾‹**â€Œï¼šä¿®æ­£æ•´ä½“æ›å…‰ä¸è¶³æˆ–è¿‡æ›çš„åœºæ™¯

**RGB æ›²çº¿(Red/Green/Blue)**
--------------------------

*   â€Œ**ä½œç”¨**â€Œï¼šå•ç‹¬è°ƒæ•´å„é¢œè‰²é€šé“
*   â€Œ**ç”¨ä¾‹**â€Œï¼šä¿®æ­£è‰²åæˆ–åˆ›é€ é£æ ¼åŒ–æ•ˆæœ(å¦‚èµ›åšæœ‹å…‹çš„è“è‰²è°ƒ)

**HueVsHue**
------------

*   â€Œ**ä½œç”¨**â€Œï¼šåŸºäºè¾“å…¥è‰²è°ƒæ›¿æ¢è¾“å‡ºè‰²è°ƒ
*   â€Œ**ç”¨ä¾‹**â€Œï¼šå°†ç»¿è‰²æ¤è¢«æ”¹ä¸ºç§‹å­£é»„è‰²

**HueVsSat**
------------

*   â€Œ**ä½œç”¨**â€Œï¼šè°ƒæ•´ç‰¹å®šè‰²è°ƒçš„é¥±å’Œåº¦
*   â€Œ**ç”¨ä¾‹**â€Œï¼šå¢å¼ºå¤©ç©ºè“è‰²é¥±å’Œåº¦è€Œä¸å½±å“å…¶ä»–é¢œè‰²

**SatVsSat**
------------

*   â€Œ**ä½œç”¨**â€Œï¼šè°ƒæ•´é¥±å’Œåº¦å¯¹æ¯”
*   â€Œ**ç”¨ä¾‹**â€Œï¼šä½¿é«˜é¥±å’ŒåŒºåŸŸæ›´é²œè‰³ï¼Œä½é¥±å’ŒåŒºåŸŸæ›´ç°

**LumVsSat**
------------

*   â€Œ**ä½œç”¨**â€Œï¼šåŸºäºäº®åº¦è°ƒæ•´é¥±å’Œåº¦
*   â€Œ**ç”¨ä¾‹**â€Œï¼šä½¿æš—éƒ¨åŒºåŸŸé™ä½é¥±å’Œåº¦(ç”µå½±æ„Ÿæ•ˆæœ)

**å®é™…åº”ç”¨æŠ€å·§**
==========

â€Œ**ç”µå½±æ„Ÿè°ƒè‰²**â€Œ
-----------

*   ä½¿ç”¨ LumVsSat é™ä½æš—éƒ¨é¥±å’Œåº¦ï¼ŒHueVsHue å¾®è°ƒè‚¤è‰²

â€Œ**å­£èŠ‚å˜æ¢**â€Œ
----------

*   é€šè¿‡ HueVsHue å°†ç»¿è‰²å˜ä¸ºé»„è‰²/çº¢è‰²æ¨¡æ‹Ÿç§‹å­£

â€Œ**é£æ ¼åŒ–æ•ˆæœ**â€Œ
-----------

*   å¤¸å¼ çš„ S å½¢ RGB æ›²çº¿åˆ›é€ é«˜å¯¹æ¯”åº¦ç”»é¢

â€Œ**è‰²å½©åŒ¹é…**â€Œ
----------

*   Match åŠŸèƒ½åŸç†ï¼Œä½¿ç”¨æ›²çº¿åŒ¹é…ä¸åŒé•œå¤´çš„è‰²å½©

ColorCurves ä¸ Unity çš„ ACES è‰²å½©ç©ºé—´é…åˆä½¿ç”¨æ—¶æ•ˆæœæœ€ä½³ï¼Œèƒ½å¤Ÿä¿æŒæ›´å¹¿è‰²åŸŸçš„è‰²å½©å…³ç³»

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**  
> ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰