---
layout: post
title: '凯亚物联网增加MQTT设备功能测试'
date: "2025-05-15T00:40:45Z"
---
凯亚物联网增加MQTT设备功能测试
=================

一、前言 
-----

这几天一直在测试设备功能，并且搭建了线上分布式流媒体推送，内存还比较稳定，.NET 8.0 性能不错，内存控制已经赶上了C++了，大家闲暇时间可以玩玩设备功能以及其它功能，过几天会发布测试版提供下载，后续会把surging 升级基于.NET 8.0，spandotnetty 稳定版本

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514231843142-694509353.png)

HttpFlv:[http://117.72.121.2:281/httpflv.html](http://117.72.121.2:281/httpflv.html)  （黑衣人）

 HttpFlv:[http://117.72.121.2:281/httpflv1.html](http://117.72.121.2:281/httpflv1.html)  （大红包）

rtmp:rtmp://117.72.121.2:76/live1/livestream2   （黑衣人）

rtmp:rtmp://117.72.121.2:76/live1/livestream3   （大红包）

  凯亚 (Kayak) 是什么?

       凯亚(Kayak)是基于.NET6.0软件环境下的surging微服务引擎进行开发的, 平台包含了微服务和物联网平台。支持异步和响应式编程开发，功能包含了物模型,设备,产品,网络组件的统一管理和微服务平台下的注册中心，服务路由，模块，中间服务等管理。还有多协议适配(TCP,MQTT,UDP,CoAP,HTTP,Grpc,websocket,rtmp,httpflv,webservice,等),通过灵活多样的配置适配能够接入不同厂家不同协议等设备。并且通过设备告警,消息通知,数据可视化等功能。能够让你能快速建立起微服务物联网平台系统。

     凯亚物联网平台：[http://117.72.121.2:3100](http://117.72.121.2:3100)（用户名：fanly  密码：123456）

    链路跟踪Skywalking V8:[http://117.72.121.2:8080/](http://117.72.121.2:8080/)

      surging 微服务引擎开源地址：[https://github.com/fanliang11/surging](https://github.com/fanliang11/surging)（后面surging 会移动到[microsurging](https://github.com/microsurging/)进行维护）

二、测试工具使用
--------

大家可以下载mqttclient 进行测试，直接点击连接服务器和订阅，都自动生成好了

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514232721192-161026087.png)

通过网盘分享的文件：mqttclient.zip  
链接: https://pan.baidu.com/s/1LsBTVtJdW7Qd24wc\_cUYEg?pwd=m3g9 提取码: m3g9

三、配置
----

可以在产品中配置设备接入

![](https://img2024.cnblogs.com/blog/192878/202504/192878-20250427215305869-74566803.png)

配置MQTT认证配置

![](https://img2024.cnblogs.com/blog/192878/202504/192878-20250427215635332-1164524694.png)

功能定义

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233153794-392821647.png)

 配置输入参数

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233251847-357330321.png)

 配置输出参数

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233332894-122677502.png)

 四、设备功能
-------

设备功能包括常规模式和窗口模式， 常规模式是文本框输入进行提交执行，窗口模式是json 提交执行，如果没有设备连接，点击执行会提示设备未在线

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233548598-1398039070.png)

 点击执行后，在MQTT客户端会接收一条消息，然后对于该命令消息进行回复通知服务端，表示设备已经执行， 对于消息回复需要发布主题为 /game-123/DJI-Mavic-v332x12/function/call/reply的消息，消息内容为

{"Outputs":{"Code":22,"Success":true,"Message":""},"FunctionId":"close","MessageId":"932279d5f8a84b8881624ea9714bf9d7"}

注意：要与接收消息MessageId保持一致，这样才知道这条消息为回复消息。

![](https://img2024.cnblogs.com/blog/192878/202505/192878-20250514233807757-1415559204.png)