---
layout: post
title: '用Qwen code进行CUDA代码优化（一）'
date: "2026-02-26T00:55:56Z"
---
用Qwen code进行CUDA代码优化（一）

code agent.

code agent似乎最近比较火，之前有看到有文章介绍使用chatGPT配合使用进行代码优化感觉还可以，就下了个chatGPT的apk没聊几句，就开始提示收费，这种体验实在差劲。然后发现了Claude，大致了解了一下，也是编程的辅助开发工具，因为电脑没法联网，就在手机上装了个Termux,下载了Claude,然后还是提示收费，因为只想测试使用一下，并不打算长期使用，所以也果断放弃收费模式。然后就找有没有免费的code agent,就发现了Qwen code,下面是使用经过。

启动Qwen code,输入项目需求，项目需求尽量简明扼要，但要说明细节。

因为我注明使用所有的优化技巧，意在考查一下AI对于优化的掌握程度，一口气列出了七种优化方法，算是比较全的，但是优化是个复杂的过程，不仅需要了解所有的优化技巧，还有了解每种优化实施的特定条件，如果只是把所有的优化列举出来，简单丢给AI，希望AI能达到最佳的优化，那也是不现实的，下一篇会讲到某些条件下，要达到最佳的优化效果，人的因素还是占主要成分。

默认的windows生成项目是visual studio 2017,需要更新到visual studio 2019.

因为优化只针对特定的GPU,AI还详细列出了GPU的具体参数，非常的详细，可见AI对于编程所涉的范围和知识储备还是非常详尽的。

虽然AI一下列举出了七种优化方法，但是还是展现出了局限性，我已经在项目创建的时候注明要达到最高性能的matrix multiplication,但是结果只能达到cuBLAS的80%。

我指示AI进一步优化代码以超过cuBLAS的性能。

显示各种优化版本的性能评估结果。

鉴于AI仍然未找到最佳的优化方向，我告知AI换个思路以实现最高计算性能。

评估各个版本的预估优化结果。PTX Unroll达到最佳理论性能。

使用过程中有不少感触,大模型在自然语言处理方面已经取得了让人惊讶的进步，在使用过程中，无论输入英文还是中文，都能准确识别，有时候不想输入过长的语句，使用缩略语进行简单的描述AI都能准确识别，虽然AI能根据人类的描述自动生成代码，但是也存在一些认知盲点，不过在经过指令提示后AI能迅速补充跟进，可见AI本身的知识储备是非常丰富的，但是怎么使用还需要人类的指导，AI虽然表现出了高度的智能化倾向，但是如何组合使用已知的知识和经验达到最佳的实战效果，还是需要人类做出抉择，这就好像并不是这个型号的CPU比那个型号的CPU快一些，你的电脑就天然地更加智能，或者你使用了win11就觉得用win7的人就落伍了一样，电脑的智商跟它使用者的智商大致相当，甚至不同公司的code agent在基准测试的数据上略有差异，你使用不同的工具所能达到的生产力也不会天然地有很大差别一样，即使在AI年代，人的因素仍然是起决定性作用的，不是工具本身有多大差异，而是使用工具的人能够发挥工具的潜力。  
当然，另外一个感触就是，你看到的截图只是理论上的数据，AI生成的代码还是有不少问题的，但是因为测试的目的在于考察一下 AI的编程实力，所以提示AI进行了相应的修改，AI在修整错误方面还是非常积极和迅速的，这一点还是值的称赞的。