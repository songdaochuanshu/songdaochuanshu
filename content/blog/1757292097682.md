---
layout: post
title: '中控IFace302考勤机二开内存问题解决方案'
date: "2025-09-08T00:41:37Z"
---
中控IFace302考勤机二开内存问题解决方案
=======================

> 文章背景：收到几好位博友、微信公众号读者在询问中控iface302开发的问题，如“**尝试读取或写入受保护的内存**”。

一、前言
====

周日刚好在家，把以前的移动硬盘找了个遍，也找到以前开**发中控Iface302**的一些案例，由于年份比较较，不能保证一定可以解决问题，但这可能也是一种思路，具体需要根据问题去调度搜索。

二、为什么会有中控考勤机开发
==============

大致的开发背景为：

*   各工厂考勤没有联网，处理**数据孤岛**状态
    
*   出差到各工厂时，只能手工重复性的采集生物信息，体验、效率都不好,考勤专员每月得处理1~2天
    
*   考勤、指纹等生物信息缺乏集中管理，存在同一编号不同机器不同人员的情况
    
*   更新考勤机器，或新增考勤机器时无法同步现有的人员、指纹，如果公司有几百、几千人那会是一个少的工作量且非常浪费大家的时间；
    
*   与中控售后了解，考勤机不具备对换设备、信息整合的同步
    
*   以上问题及要求，最终只能自己根据中控SDK做二次开发，开干~
    

三、开发效果
======

零星几张中控考勤机二开效果图：

*   监控或收集各中控考勤机的打开情况，相当中控提供的客户端，解决**数据孤岛**问题，包括自动自动指纹、面纹：
    

![](https://files.mdnice.com/user/24855/bb032ee6-b65f-4010-b269-77fa85fd64e1.png)

![](https://files.mdnice.com/user/24855/52505fb2-8812-4747-8200-b42be8af9a65.png)

*   整合**各厂人员信息**，对指纹进行合并并同步到新考勤中；
    

![](https://files.mdnice.com/user/24855/f23c8b6b-1a3a-4beb-89ce-28536d73d912.png)

四、关键代码
======

通过ReleaseComOjbect释放对象可能会导致对象占用的内存问题导致出错，这里做了优化，即设置对象为空，并执行垃圾回收。

`/// <summary>           /// 连接设备           /// </summary>           public void ConnectAsyn()           {               if (isConnectting == true)               {                   OnShowMessage("正在连接...请稍后...");                   return;               }               try               {                   ThreadJob = new Thread(new ThreadStart(Connect));                   ThreadJob.IsBackground = true;                   ThreadJob.Start();               }               catch (Exception ex)               {                   Utils.WriteLog(ex.ToString(), "ConnectAsyn");                      try                   {                       //Marshal.ReleaseComObject(zkDevice);        //否则多次调用时会出现  示尝试读取或写入受保护的内存 这通常指示其它内存已损坏                            GC.Collect();                       zkDevice = null;                       GC.Collect();                   }                   catch (Exception ex2)                   {                       Utils.WriteLog(ex2.ToString(), "zkDevice=null");                   }               }              }   `

五、总结
====

*   通过中控提供的SDK做二次开发，可以有效的解决中控产品本来不具备的功能，如做人员、指纹的整合、同步；
    
*   通过SDK二开，可以做更多个性化的开发，如员工打开时的语音或文字提示；
    

更多信息可以浏览微信公众号：[https://mp.weixin.qq.com/s/DJg9WOSkafFIiz7Fy74jjw](https://mp.weixin.qq.com/s/DJg9WOSkafFIiz7Fy74jjw)

转载请注明出处［[http://samlin.cnblogs.com/](http://samlin.cnblogs.com/)］  

**欢迎关注本人公众号：** ![](https://images.cnblogs.com/cnblogs_com/samlin/248024/o_%E6%8A%80%E6%9C%AF%E5%AE%85%E7%88%B8.jpg "扫描关注快乐IT")

**作者赞赏**  
![](https://images.cnblogs.com/cnblogs_com/samlin/248024/o_%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20180104210613.jpg "支付宝赞赏") ![](https://images.cnblogs.com/cnblogs_com/samlin/248024/o_weixin_1.png "微信赞赏")