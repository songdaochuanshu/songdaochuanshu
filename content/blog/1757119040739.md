---
layout: post
title: 'ã€URPã€‘Unity3Dç‰©ä½“é®ç½©çš„å¤šç§æ–¹æ¡ˆå®ç°'
date: "2025-09-06T00:37:20Z"
---
ã€URPã€‘Unity3Dç‰©ä½“é®ç½©çš„å¤šç§æ–¹æ¡ˆå®ç°
=======================

![ã€URPã€‘Unity3Dç‰©ä½“é®ç½©çš„å¤šç§æ–¹æ¡ˆå®ç°](https://img2024.cnblogs.com/blog/3685400/202509/3685400-20250905113525768-1355523152.png) æœ¬æ–‡ä»‹ç»äº†Unity URPä¸­å®ç°3Dç‰©ä½“åŠ¨æ€é®ç½©çš„å¤šç§æ–¹æ¡ˆã€‚æ ¸å¿ƒæ–¹æ¡ˆé‡‡ç”¨æ–¹å‘æ€§é®ç½©Shaderï¼Œé€šè¿‡\_MaskDirectionå‘é‡å®šä¹‰é®ç½©æ–¹å‘ï¼Œä½¿ç”¨\_MaskProgresså‚æ•°æ§åˆ¶æ˜¾ç¤ºæ¯”ä¾‹ï¼ŒåŸºäºé¡¶ç‚¹ä¸–ç•Œåæ ‡æŠ•å½±å€¼è¿›è¡Œè£å‰ªã€‚æ§åˆ¶å™¨è„šæœ¬æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´å‚æ•°ï¼Œå¹¶ä¿æŒé«˜æ•ˆæ•°æ®äº¤äº’ã€‚æ–‡ç« è¿˜å¯¹æ¯”äº†æ¨¡æ¿æµ‹è¯•ã€å¤šPassæ·±åº¦æµ‹è¯•ã€UGUIæ··åˆå’ŒRenderTextureç­‰ä¸åŒå®ç°æ–¹æ¡ˆçš„ç‰¹ç‚¹åŠé€‚ç”¨åœºæ™¯ï¼Œä¸ºå¼€å‘è€…æä¾›äº†çµæ´»é€‰æ‹©ã€‚å„ç§æ–¹æ¡ˆåœ¨æ€§èƒ½ã€ç²¾ç¡®åº¦å’Œçµæ´»æ€§ä¸Šå„æœ‰ä¾§é‡ï¼Œå¯æ ¹æ®å…·ä½“é¡¹ç›®éœ€æ±‚é€‰ç”¨ã€‚

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

**ç‰©ä½“è‡ªèº«é®ç½©æ§åˆ¶æ–¹æ¡ˆ**
==============

åŸºäºUnity URPå®ç°3Dç‰©ä½“æ–¹å‘æ€§åŠ¨æ€é®ç½©
------------------------

### â€Œ**Shaderæ ¸å¿ƒåŠŸèƒ½**â€Œï¼š

*   é€šè¿‡`_MaskDirection`å‘é‡å®šä¹‰é®ç½©æ–¹å‘
*   ä½¿ç”¨`_MaskProgress`å‚æ•°(0-1èŒƒå›´)æ§åˆ¶æ˜¾ç¤ºæ¯”ä¾‹
*   åŸºäºé¡¶ç‚¹ä¸–ç•Œåæ ‡åœ¨é®ç½©æ–¹å‘ä¸Šçš„æŠ•å½±å€¼è¿›è¡Œè£å‰ª(clip)
*   å…¼å®¹URPæ¸²æŸ“ç®¡çº¿æ ‡å‡†ç»“æ„

### â€Œ**æ§åˆ¶å™¨ç‰¹ç‚¹**â€Œï¼š

*   æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´é®ç½©æ–¹å‘å’Œè¿›åº¦
    
*   å†…ç½®æ¼”ç¤ºåŠ¨ç”»(æ—‹è½¬æ–¹å‘å’Œè¿›åº¦æ³¢åŠ¨)
    
*   æä¾›å¤–éƒ¨è°ƒç”¨æ¥å£ç”¨äºç¨‹åºæ§åˆ¶
    
*   è‡ªåŠ¨è§„èŒƒåŒ–æ–¹å‘å‘é‡ç¡®ä¿è®¡ç®—å‡†ç¡®
    
*   DirectionalMask.shader
    
        Shader "Custom/DirectionalMask"
        {
            Properties
            {
                _MainTex("Texture", 2D) = "white" {}
                _MaskDirection("Mask Direction", Vector) = (1,0,0,0)
                _MaskProgress("Mask Progress", Range(0, 1)) = 0.5
            }
        
            SubShader
            {
                Tags { "RenderType"="Opaque" "RenderPipeline"="UniversalPipeline" }
        
                HLSLINCLUDE
                #include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"
        
                struct Attributes
                {
                    float4 positionOS : POSITION;
                    float2 uv : TEXCOORD0;
                };
        
                struct Varyings
                {
                    float4 positionCS : SV_POSITION;
                    float2 uv : TEXCOORD0;
                    float3 positionWS : TEXCOORD1;
                };
        
                TEXTURE2D(_MainTex);
                SAMPLER(sampler_MainTex);
                float4 _MainTex_ST;
                float3 _MaskDirection;
                float _MaskProgress;
        
                Varyings Vert(Attributes input)
                {
                    Varyings output;
                    output.positionCS = TransformObjectToHClip(input.positionOS.xyz);
                    output.uv = TRANSFORM_TEX(input.uv, _MainTex);
                    output.positionWS = TransformObjectToWorld(input.positionOS.xyz);
                    return output;
                }
        
                half4 Frag(Varyings input) : SV_Target
                {
                    half4 col = SAMPLE_TEXTURE2D(_MainTex, sampler_MainTex, input.uv);
                    
                    // è®¡ç®—ç‰©ä½“é¡¶ç‚¹åœ¨é®ç½©æ–¹å‘ä¸Šçš„æŠ•å½±æ¯”ä¾‹
                    float dotProduct = dot(normalize(input.positionWS), normalize(_MaskDirection));
                    float normalizedDot = (dotProduct + 1) * 0.5; // æ˜ å°„åˆ°0-1èŒƒå›´
                    
                    // æ ¹æ®è¿›åº¦å‚æ•°è£å‰ª
                    clip(normalizedDot - _MaskProgress);
                    
                    return col;
                }
                ENDHLSL
        
                Pass
                {
                    HLSLPROGRAM
                    #pragma vertex Vert
                    #pragma fragment Frag
                    ENDHLSL
                }
            }
        }
        
        
    
*   DirectionalMaskController.cs
    
        using UnityEngine;
        
        public class DirectionalMaskController : MonoBehaviour
        {
            [SerializeField] private Renderer _targetRenderer;
            [SerializeField] private Vector3 _maskDirection = Vector3.right;
            [Range(0, 1)] public float maskProgress = 0.5f;
            [SerializeField] private float _rotationSpeed = 30f;
            [SerializeField] private float _progressSpeed = 0.2f;
        
            private Material _material;
            private static readonly int MaskDirection = Shader.PropertyToID("_MaskDirection");
            private static readonly int MaskProgress = Shader.PropertyToID("_MaskProgress");
        
            void Start()
            {
                _material = _targetRenderer.material;
                UpdateShaderParams();
            }
        
            void Update()
            {
                // åŠ¨æ€æ—‹è½¬é®ç½©æ–¹å‘
                _maskDirection = Quaternion.Euler(0, _rotationSpeed * Time.deltaTime, 0) * _maskDirection;
                
                // åŠ¨æ€è°ƒæ•´é®ç½©è¿›åº¦
                maskProgress = Mathf.PingPong(Time.time * _progressSpeed, 1f);
                
                UpdateShaderParams();
            }
        
            private void UpdateShaderParams()
            {
                _material.SetVector(MaskDirection, _maskDirection.normalized);
                _material.SetFloat(MaskProgress, maskProgress);
            }
        
            // å¤–éƒ¨è°ƒç”¨æ¥å£
            public void SetMaskDirection(Vector3 newDirection)
            {
                _maskDirection = newDirection.normalized;
                UpdateShaderParams();
            }
        
            public void SetMaskProgress(float progress)
            {
                maskProgress = Mathf.Clamp01(progress);
                UpdateShaderParams();
            }
        }
        
    

### â€Œ**æ‰©å±•**ï¼š

*   å¯æ·»åŠ `_MaskSharpness`å‚æ•°æ§åˆ¶è¾¹ç¼˜è¿‡æ¸¡æŸ”å’Œåº¦
*   ç»“åˆ`Stencil Buffer`å®ç°å¤šç‰©ä½“é®ç½©å åŠ 
*   é€šè¿‡`AnimationCurve`æ§åˆ¶è¿›åº¦å˜åŒ–æ›²çº¿

è¯¥æ–¹æ¡ˆç›¸æ¯”åŸºç¡€é®ç½©å®ç°å¢åŠ äº†æ–¹å‘å‘é‡å‚æ•°å’ŒåŠ¨æ€è¿›åº¦æ§åˆ¶ï¼Œé€šè¿‡é¡¶ç‚¹æŠ•å½±è®¡ç®—å®ç°æ–¹å‘æ€§è£å‰ªæ•ˆæœã€‚æ§åˆ¶å™¨è„šæœ¬æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´æ‰€æœ‰å‚æ•°ï¼Œå¹¶ä¿æŒä¸Shaderçš„é«˜æ•ˆæ•°æ®äº¤äº’ã€‚

â€Œ**HLSL Shaderå®ç°**â€Œï¼ˆåŸºäºé€æ˜åº¦é®ç½©ï¼‰ï¼š
-----------------------------

*   **unity\_urpé®ç½©shader**
    
        Shader "Custom/TransparentColorURP" {
            Properties {
                _Color("Color Tint", Color) = (1,1,1,1)
                _MainTex("Main Tex", 2D) = "white" {}
                _AlphaScale("Alpha Scale", Range(0, 1)) = 0.5
            }
            SubShader {
                Pass {
                    ZWrite On
                    ColorMask 0
                }
                Pass {
                    ZWrite Off
                    Blend SrcAlpha OneMinusSrcAlpha
                    // HLSLä»£ç ...
                }
            }
        }
        
    

â€Œ**æ§åˆ¶è„šæœ¬**â€Œï¼š
-----------

*   **unity\_é®ç½©æ§åˆ¶è„šæœ¬**
    
        public class MaskController : MonoBehaviour {
            public Renderer targetRenderer;
            public float maskProgress = 0.5f;
        
            void Update() {
                targetRenderer.material.SetFloat("_AlphaScale", 
                    Mathf.PingPong(Time.time, 1f));
            }
        }
        
    

**æ¨¡æ¿æµ‹è¯•å®ç°æ–¹æ¡ˆ**
============

â€Œ**æ¨¡æ¿Shaderæ ¸å¿ƒä»£ç **â€Œï¼š
-------------------

*   åˆ›å»ºä¸€ä¸ªå››è¾¹å½¢ï¼Œå°†StencilMaskåšæˆæè´¨èµ‹ç»™å®ƒã€‚é€šè¿‡è°ƒæ•´å››è¾¹å½¢çš„å¤§å°ï¼Œæ¥è°ƒæ•´é®ç½©åŒºåŸŸã€‚
    
*   å½“ç„¶ä¹Ÿå¯åœ¨c#ç«¯åŠ¨æ€è°ƒæ•´meshçš„ç‚¹æ¥åšåŠ¨æ€å¼‚å½¢é®ç½©ã€‚
    
*   å°†éœ€è¦è¢«é®ç½©çš„URPä¸­Litçš„ç‰©ä½“ï¼Œæ¢æˆStencilLitçš„shaderã€‚è¿™æ ·åŸæ¥çš„Litçš„ç‰©ä½“å°±æ”¯æŒStencilMaskçš„é®ç½©äº†ã€‚
    
*   StencilMask.shader
    
        Shader "Custom/StencilMask"
        {
            SubShader
            {
                Tags { "RenderType"="Opaque" "Queue"="Geometry-100" }
                
                Pass
                {
                    ColorMask 0
                    ZWrite Off
                    
                    Stencil {
                        Ref 1
                        Comp Always
                        Pass Replace
                    }
                }
            }
        }
        
    
*   StencilLit.shader
    
        Shader "Universal Render Pipeline/StencilLit"
        {
            Properties
            {
                // Specular vs Metallic workflow
                _WorkflowMode("WorkflowMode", Float) = 1.0
        
                [MainTexture] _BaseMap("Albedo", 2D) = "white" {}
                [MainColor] _BaseColor("Color", Color) = (1,1,1,1)
        
                _Cutoff("Alpha Cutoff", Range(0.0, 1.0)) = 0.5
        
                _Smoothness("Smoothness", Range(0.0, 1.0)) = 0.5
                _SmoothnessTextureChannel("Smoothness texture channel", Float) = 0
        
                _Metallic("Metallic", Range(0.0, 1.0)) = 0.0
                _MetallicGlossMap("Metallic", 2D) = "white" {}
        
                _SpecColor("Specular", Color) = (0.2, 0.2, 0.2)
                _SpecGlossMap("Specular", 2D) = "white" {}
        
                [ToggleOff] _SpecularHighlights("Specular Highlights", Float) = 1.0
                [ToggleOff] _EnvironmentReflections("Environment Reflections", Float) = 1.0
        
                _BumpScale("Scale", Float) = 1.0
                _BumpMap("Normal Map", 2D) = "bump" {}
        
                _Parallax("Scale", Range(0.005, 0.08)) = 0.005
                _ParallaxMap("Height Map", 2D) = "black" {}
        
                _OcclusionStrength("Strength", Range(0.0, 1.0)) = 1.0
                _OcclusionMap("Occlusion", 2D) = "white" {}
        
                [HDR] _EmissionColor("Color", Color) = (0,0,0)
                _EmissionMap("Emission", 2D) = "white" {}
        
                _DetailMask("Detail Mask", 2D) = "white" {}
                _DetailAlbedoMapScale("Scale", Range(0.0, 2.0)) = 1.0
                _DetailAlbedoMap("Detail Albedo x2", 2D) = "linearGrey" {}
                _DetailNormalMapScale("Scale", Range(0.0, 2.0)) = 1.0
                [Normal] _DetailNormalMap("Normal Map", 2D) = "bump" {}
        
                // SRP batching compatibility for Clear Coat (Not used in Lit)
                [HideInInspector] _ClearCoatMask("_ClearCoatMask", Float) = 0.0
                [HideInInspector] _ClearCoatSmoothness("_ClearCoatSmoothness", Float) = 0.0
        
                // Blending state
                _Surface("__surface", Float) = 0.0
                _Blend("__blend", Float) = 0.0
                _Cull("__cull", Float) = 2.0
                [ToggleUI] _AlphaClip("__clip", Float) = 0.0
                [HideInInspector] _SrcBlend("__src", Float) = 1.0
                [HideInInspector] _DstBlend("__dst", Float) = 0.0
                [HideInInspector] _SrcBlendAlpha("__srcA", Float) = 1.0
                [HideInInspector] _DstBlendAlpha("__dstA", Float) = 0.0
                [HideInInspector] _ZWrite("__zw", Float) = 1.0
                [HideInInspector] _BlendModePreserveSpecular("_BlendModePreserveSpecular", Float) = 1.0
                [HideInInspector] _AlphaToMask("__alphaToMask", Float) = 0.0
        
                [ToggleUI] _ReceiveShadows("Receive Shadows", Float) = 1.0
                // Editmode props
                _QueueOffset("Queue offset", Float) = 0.0
        
                // ObsoleteProperties
                [HideInInspector] _MainTex("BaseMap", 2D) = "white" {}
                [HideInInspector] _Color("Base Color", Color) = (1, 1, 1, 1)
                [HideInInspector] _GlossMapScale("Smoothness", Float) = 0.0
                [HideInInspector] _Glossiness("Smoothness", Float) = 0.0
                [HideInInspector] _GlossyReflections("EnvironmentReflections", Float) = 0.0
        
                [HideInInspector][NoScaleOffset]unity_Lightmaps("unity_Lightmaps", 2DArray) = "" {}
                [HideInInspector][NoScaleOffset]unity_LightmapsInd("unity_LightmapsInd", 2DArray) = "" {}
                [HideInInspector][NoScaleOffset]unity_ShadowMasks("unity_ShadowMasks", 2DArray) = "" {}
            }
        
            SubShader
            {
                // Universal Pipeline tag is required. If Universal render pipeline is not set in the graphics settings
                // this Subshader will fail. One can add a subshader below or fallback to Standard built-in to make this
                // material work with both Universal Render Pipeline and Builtin Unity Pipeline
                Tags
                {
                    "RenderType" = "Opaque"
                    "RenderPipeline" = "UniversalPipeline"
                    "UniversalMaterialType" = "Lit"
                    "IgnoreProjector" = "True"
                }
                LOD 300
        
                // ------------------------------------------------------------------
                //  Forward pass. Shades all light in a single pass. GI + emission + Fog
                Pass
                {
                    // Lightmode matches the ShaderPassName set in UniversalRenderPipeline.cs. SRPDefaultUnlit and passes with
                    // no LightMode tag are also rendered by Universal Render Pipeline
                    Name "ForwardLit"
                    Tags
                    {
                        "LightMode" = "UniversalForward"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    Blend[_SrcBlend][_DstBlend], [_SrcBlendAlpha][_DstBlendAlpha]
                    ZWrite[_ZWrite]
                    Cull[_Cull]
                    AlphaToMask[_AlphaToMask]
                    Stencil {
                        Ref 1
                        Comp Equal
                        Pass Keep
                    }
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex LitPassVertex
                    #pragma fragment LitPassFragment
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local _NORMALMAP
                    #pragma shader_feature_local _PARALLAXMAP
                    #pragma shader_feature_local _RECEIVE_SHADOWS_OFF
                    #pragma shader_feature_local _ _DETAIL_MULX2 _DETAIL_SCALED
                    #pragma shader_feature_local_fragment _SURFACE_TYPE_TRANSPARENT
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _ _ALPHAPREMULTIPLY_ON _ALPHAMODULATE_ON
                    #pragma shader_feature_local_fragment _EMISSION
                    #pragma shader_feature_local_fragment _METALLICSPECGLOSSMAP
                    #pragma shader_feature_local_fragment _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
                    #pragma shader_feature_local_fragment _OCCLUSIONMAP
                    #pragma shader_feature_local_fragment _SPECULARHIGHLIGHTS_OFF
                    #pragma shader_feature_local_fragment _ENVIRONMENTREFLECTIONS_OFF
                    #pragma shader_feature_local_fragment _SPECULAR_SETUP
        
                    // -------------------------------------
                    // Universal Pipeline keywords
                    #pragma multi_compile _ _MAIN_LIGHT_SHADOWS _MAIN_LIGHT_SHADOWS_CASCADE _MAIN_LIGHT_SHADOWS_SCREEN
                    #pragma multi_compile _ _ADDITIONAL_LIGHTS_VERTEX _ADDITIONAL_LIGHTS
                    #pragma multi_compile _ EVALUATE_SH_MIXED EVALUATE_SH_VERTEX
                    #pragma multi_compile_fragment _ _ADDITIONAL_LIGHT_SHADOWS
                    #pragma multi_compile_fragment _ _REFLECTION_PROBE_BLENDING
                    #pragma multi_compile_fragment _ _REFLECTION_PROBE_BOX_PROJECTION
                    #pragma multi_compile_fragment _ _SHADOWS_SOFT _SHADOWS_SOFT_LOW _SHADOWS_SOFT_MEDIUM _SHADOWS_SOFT_HIGH
                    #pragma multi_compile_fragment _ _SCREEN_SPACE_OCCLUSION
                    #pragma multi_compile_fragment _ _DBUFFER_MRT1 _DBUFFER_MRT2 _DBUFFER_MRT3
                    #pragma multi_compile_fragment _ _LIGHT_COOKIES
                    #pragma multi_compile _ _LIGHT_LAYERS
                    #pragma multi_compile _ _FORWARD_PLUS
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/RenderingLayers.hlsl"
        
                    // -------------------------------------
                    // Unity defined keywords
                    #pragma multi_compile _ LIGHTMAP_SHADOW_MIXING
                    #pragma multi_compile _ SHADOWS_SHADOWMASK
                    #pragma multi_compile _ DIRLIGHTMAP_COMBINED
                    #pragma multi_compile _ LIGHTMAP_ON
                    #pragma multi_compile _ DYNAMICLIGHTMAP_ON
                    #pragma multi_compile_fragment _ LOD_FADE_CROSSFADE
                    #pragma multi_compile_fog
                    #pragma multi_compile_fragment _ DEBUG_DISPLAY
        
                    //--------------------------------------
                    // GPU Instancing
                    #pragma multi_compile_instancing
                    #pragma instancing_options renderinglayer
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitForwardPass.hlsl"
                    ENDHLSL
                }
        
                Pass
                {
                    Name "ShadowCaster"
                    Tags
                    {
                        "LightMode" = "ShadowCaster"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    ZWrite On
                    ZTest LEqual
                    ColorMask 0
                    Cull[_Cull]
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex ShadowPassVertex
                    #pragma fragment ShadowPassFragment
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
        
                    //--------------------------------------
                    // GPU Instancing
                    #pragma multi_compile_instancing
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    // -------------------------------------
                    // Universal Pipeline keywords
        
                    // -------------------------------------
                    // Unity defined keywords
                    #pragma multi_compile_fragment _ LOD_FADE_CROSSFADE
        
                    // This is used during shadow map generation to differentiate between directional and punctual light shadows, as they use different formulas to apply Normal Bias
                    #pragma multi_compile_vertex _ _CASTING_PUNCTUAL_LIGHT_SHADOW
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/ShadowCasterPass.hlsl"
                    ENDHLSL
                }
        
                Pass
                {
                    // Lightmode matches the ShaderPassName set in UniversalRenderPipeline.cs. SRPDefaultUnlit and passes with
                    // no LightMode tag are also rendered by Universal Render Pipeline
                    Name "GBuffer"
                    Tags
                    {
                        "LightMode" = "UniversalGBuffer"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    ZWrite[_ZWrite]
                    ZTest LEqual
                    Cull[_Cull]
        
                    HLSLPROGRAM
                    #pragma target 4.5
        
                    // Deferred Rendering Path does not support the OpenGL-based graphics API:
                    // Desktop OpenGL, OpenGL ES 3.0, WebGL 2.0.
                    #pragma exclude_renderers gles3 glcore
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex LitGBufferPassVertex
                    #pragma fragment LitGBufferPassFragment
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local _NORMALMAP
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    //#pragma shader_feature_local_fragment _ALPHAPREMULTIPLY_ON
                    #pragma shader_feature_local_fragment _EMISSION
                    #pragma shader_feature_local_fragment _METALLICSPECGLOSSMAP
                    #pragma shader_feature_local_fragment _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
                    #pragma shader_feature_local_fragment _OCCLUSIONMAP
                    #pragma shader_feature_local _PARALLAXMAP
                    #pragma shader_feature_local _ _DETAIL_MULX2 _DETAIL_SCALED
        
                    #pragma shader_feature_local_fragment _SPECULARHIGHLIGHTS_OFF
                    #pragma shader_feature_local_fragment _ENVIRONMENTREFLECTIONS_OFF
                    #pragma shader_feature_local_fragment _SPECULAR_SETUP
                    #pragma shader_feature_local _RECEIVE_SHADOWS_OFF
        
                    // -------------------------------------
                    // Universal Pipeline keywords
                    #pragma multi_compile _ _MAIN_LIGHT_SHADOWS _MAIN_LIGHT_SHADOWS_CASCADE _MAIN_LIGHT_SHADOWS_SCREEN
                    //#pragma multi_compile _ _ADDITIONAL_LIGHTS_VERTEX _ADDITIONAL_LIGHTS
                    //#pragma multi_compile _ _ADDITIONAL_LIGHT_SHADOWS
                    #pragma multi_compile_fragment _ _REFLECTION_PROBE_BLENDING
                    #pragma multi_compile_fragment _ _REFLECTION_PROBE_BOX_PROJECTION
                    #pragma multi_compile_fragment _ _SHADOWS_SOFT _SHADOWS_SOFT_LOW _SHADOWS_SOFT_MEDIUM _SHADOWS_SOFT_HIGH
                    #pragma multi_compile_fragment _ _DBUFFER_MRT1 _DBUFFER_MRT2 _DBUFFER_MRT3
                    #pragma multi_compile_fragment _ _RENDER_PASS_ENABLED
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/RenderingLayers.hlsl"
        
                    // -------------------------------------
                    // Unity defined keywords
                    #pragma multi_compile _ LIGHTMAP_SHADOW_MIXING
                    #pragma multi_compile _ SHADOWS_SHADOWMASK
                    #pragma multi_compile _ DIRLIGHTMAP_COMBINED
                    #pragma multi_compile _ LIGHTMAP_ON
                    #pragma multi_compile _ DYNAMICLIGHTMAP_ON
                    #pragma multi_compile_fragment _ LOD_FADE_CROSSFADE
                    #pragma multi_compile_fragment _ _GBUFFER_NORMALS_OCT
        
                    //--------------------------------------
                    // GPU Instancing
                    #pragma multi_compile_instancing
                    #pragma instancing_options renderinglayer
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitGBufferPass.hlsl"
                    ENDHLSL
                }
        
                Pass
                {
                    Name "DepthOnly"
                    Tags
                    {
                        "LightMode" = "DepthOnly"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    ZWrite On
                    ColorMask R
                    Cull[_Cull]
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex DepthOnlyVertex
                    #pragma fragment DepthOnlyFragment
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
        
                    // -------------------------------------
                    // Unity defined keywords
                    #pragma multi_compile_fragment _ LOD_FADE_CROSSFADE
        
                    //--------------------------------------
                    // GPU Instancing
                    #pragma multi_compile_instancing
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/DepthOnlyPass.hlsl"
                    ENDHLSL
                }
        
                // This pass is used when drawing to a _CameraNormalsTexture texture
                Pass
                {
                    Name "DepthNormals"
                    Tags
                    {
                        "LightMode" = "DepthNormals"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    ZWrite On
                    Cull[_Cull]
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex DepthNormalsVertex
                    #pragma fragment DepthNormalsFragment
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local _NORMALMAP
                    #pragma shader_feature_local _PARALLAXMAP
                    #pragma shader_feature_local _ _DETAIL_MULX2 _DETAIL_SCALED
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
        
                    // -------------------------------------
                    // Unity defined keywords
                    #pragma multi_compile_fragment _ LOD_FADE_CROSSFADE
        
                    // -------------------------------------
                    // Universal Pipeline keywords
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/RenderingLayers.hlsl"
        
                    //--------------------------------------
                    // GPU Instancing
                    #pragma multi_compile_instancing
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitDepthNormalsPass.hlsl"
                    ENDHLSL
                }
        
                // This pass it not used during regular rendering, only for lightmap baking.
                Pass
                {
                    Name "Meta"
                    Tags
                    {
                        "LightMode" = "Meta"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    Cull Off
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex UniversalVertexMeta
                    #pragma fragment UniversalFragmentMetaLit
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local_fragment _SPECULAR_SETUP
                    #pragma shader_feature_local_fragment _EMISSION
                    #pragma shader_feature_local_fragment _METALLICSPECGLOSSMAP
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _ _SMOOTHNESS_TEXTURE_ALBEDO_CHANNEL_A
                    #pragma shader_feature_local _ _DETAIL_MULX2 _DETAIL_SCALED
                    #pragma shader_feature_local_fragment _SPECGLOSSMAP
                    #pragma shader_feature EDITOR_VISUALIZATION
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitMetaPass.hlsl"
        
                    ENDHLSL
                }
        
                Pass
                {
                    Name "Universal2D"
                    Tags
                    {
                        "LightMode" = "Universal2D"
                    }
        
                    // -------------------------------------
                    // Render State Commands
                    Blend[_SrcBlend][_DstBlend]
                    ZWrite[_ZWrite]
                    Cull[_Cull]
        
                    HLSLPROGRAM
                    #pragma target 2.0
        
                    // -------------------------------------
                    // Shader Stages
                    #pragma vertex vert
                    #pragma fragment frag
        
                    // -------------------------------------
                    // Material Keywords
                    #pragma shader_feature_local_fragment _ALPHATEST_ON
                    #pragma shader_feature_local_fragment _ALPHAPREMULTIPLY_ON
        
                    #include_with_pragmas "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DOTS.hlsl"
        
                    // -------------------------------------
                    // Includes
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/LitInput.hlsl"
                    #include "Packages/com.unity.render-pipelines.universal/Shaders/Utils/Universal2D.hlsl"
                    ENDHLSL
                }
            }
        
            FallBack "Hidden/Universal Render Pipeline/FallbackError"
            CustomEditor "UnityEditor.Rendering.Universal.ShaderGUI.LitShader"
        }
        
    

â€Œ**RenderFeatureé…ç½®è¦ç‚¹**â€Œï¼š
------------------------

*   éœ€åˆ›å»ºURP Renderer Feature
*   è®¾ç½®Layer MaskåŒ¹é…ç›®æ ‡å±‚çº§
*   åœ¨åå¤„ç†å‰æ·»åŠ Pass

**ä¸‰ã€å…¶ä»–å®ç°æ–¹å¼**
============

â€Œ**å¤šPassæ·±åº¦æµ‹è¯•æ³•**â€Œï¼š
-----------------

    Pass {
        ZTest Greater
        ZWrite On
        ColorMask 0
    }
    Pass {
        ZTest LEqual
        // æ­£å¸¸æ¸²æŸ“...
    }
    
    

â€Œ**UGUI Maskæ··åˆæ–¹æ¡ˆ**â€Œï¼š
--------------------

*   ä½¿ç”¨RectTransformç¡®å®šé®ç½©åŒºåŸŸ
*   é€šè¿‡ç¬¬äºŒæ‘„åƒæœºæ¸²æŸ“3Dç‰©ä½“
*   ç»“åˆUI Maskç»„ä»¶æ§åˆ¶æ˜¾ç¤ºèŒƒå›´

â€Œ**RenderTextureé®ç½©**â€Œï¼š
----------------------

*   åˆ›å»ºä¸´æ—¶RenderTexture
*   ä½¿ç”¨ç‰¹å®šShaderæ¸²æŸ“é®ç½©é€šé“
*   é€šè¿‡åæœŸå¤„ç†åˆæˆæœ€ç»ˆæ•ˆæœ

**å››ã€æ–¹æ¡ˆå¯¹æ¯”**
==========

æ–¹æ¡ˆç±»å‹

ä¼˜ç‚¹

é€‚ç”¨åœºæ™¯

æ¨¡æ¿æµ‹è¯•

é«˜æ€§èƒ½ï¼Œç²¾ç¡®æ§åˆ¶

è§’è‰²è½®å»“/å›ºå®šå½¢çŠ¶é®ç½©

å¤šPass

æ— éœ€é¢å¤–çº¹ç†

ç®€å•é®æŒ¡æç¤º

UGUIæ··åˆ

å¯ç»“åˆUIç³»ç»Ÿ

HUDå…ƒç´ é®ç½©

RenderTexture

æ•ˆæœæœ€çµæ´»

å¤æ‚åŠ¨æ€é®ç½©

æ¨¡æ¿æµ‹è¯•é€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶åƒç´ çº§æ˜¾ç¤ºçš„åœºæ™¯ï¼Œè€Œå¤šPassæ–¹æ¡ˆæ›´é€‚åˆç®€å•çš„é®æŒ¡æç¤ºæ•ˆæœ

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰