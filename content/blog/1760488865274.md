---
layout: post
title: 'ä½¿ç”¨ Docker å¿«é€Ÿæ­å»º MinIO æ–‡ä»¶å­˜å‚¨æœåŠ¡'
date: "2025-10-15T00:41:05Z"
---
ä½¿ç”¨ Docker å¿«é€Ÿæ­å»º MinIO æ–‡ä»¶å­˜å‚¨æœåŠ¡
===========================

åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€å­˜å‚¨ä¸è®¿é—®çš„åœºæ™¯ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ã€æ—¥å¿—æ–‡ä»¶ã€æ¨¡å‹æ•°æ®é›†ç­‰ã€‚ä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿéš¾ä»¥æ»¡è¶³é«˜å¹¶å‘ã€åˆ†å¸ƒå¼éƒ¨ç½²ä»¥åŠäº‘åŸç”ŸåŒ–çš„éœ€æ±‚ã€‚è€Œ **MinIO** ä½œä¸ºä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§ã€å…¼å®¹ Amazon S3 åè®®çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œæ­£æ˜¯ä¸ºæ­¤è€Œç”Ÿã€‚

æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œé€šè¿‡ **Docker éƒ¨ç½² MinIO** æœåŠ¡ï¼Œå¹¶ç»“åˆ **Java SDK** å®ç°æ–‡ä»¶çš„ä¸Šä¼ ä¸è®¿é—®ã€‚

æ— è®ºä½ æ˜¯æƒ³åœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªè½»é‡æ–‡ä»¶ä¸­å¿ƒï¼Œè¿˜æ˜¯ä¸ºä¼ä¸šå†…éƒ¨ç³»ç»Ÿæ„å»ºä¸€ä¸ªå¯æ‰©å±•çš„å¯¹è±¡å­˜å‚¨æ–¹æ¡ˆï¼Œè¿™ç¯‡æ–‡ç« éƒ½èƒ½å¸®ä½ å¿«é€Ÿä¸Šæ‰‹ã€‚

1 æ‹‰å– Minio é•œåƒ
=============

    docker pull minio/minio:RELEASE.2025-04-22T22-12-26Z
    

2 å¯åŠ¨ Minio å®¹å™¨
=============

æˆ‘ä»¬å‡è®¾ä½ å¸Œæœ›è®¿é—®ç«¯å£ä¸º `9000`ï¼ˆAPIï¼‰å’Œ `9001`ï¼ˆWeb æ§åˆ¶å°ï¼‰ï¼Œå¯ä»¥è¿™æ ·è¿è¡Œï¼š

    docker run -d \
      --name minio \
      -p 9000:9000 \
      -p 9001:9001 \
      -v /Users/zhangyong/docker/minio/data:/data \
      -v /Users/zhangyong/docker/minio/config:/root/.minio \
      -e "MINIO_ROOT_USER=admin" \
      -e "MINIO_ROOT_PASSWORD=admin123456" \
      minio/minio:RELEASE.2025-04-22T22-12-26Z \
      server /data --console-address ":9001"
    

01 å‚æ•°è¯´æ˜
-------

*   `-p 9000:9000`ï¼šMinIO API æœåŠ¡ç«¯å£
*   `-p 9001:9001`ï¼šWeb æ§åˆ¶å°ç«¯å£
*   `-v /Users/zhangyong/docker/minio/data:/data`ï¼šæ˜ å°„æ•°æ®ç›®å½•
*   `-v /Users/zhangyong/docker/minio/config:/root/.minio`ï¼šä¿å­˜é…ç½®
*   `MINIO_ROOT_USER`ã€`MINIO_ROOT_PASSWORD`ï¼šç®¡ç†å‘˜è´¦å·å¯†ç 
*   `server /data --console-address ":9001"`ï¼šæŒ‡å®šæ•°æ®ç›®å½•å¹¶å¯ç”¨æ§åˆ¶å°ç«¯å£

* * *

02 å¯åŠ¨åè®¿é—®
--------

*   æ§åˆ¶å°åœ°å€ï¼š[http://localhost:9001](http://localhost:9001)
*   ç™»å½•è´¦å·ï¼š`admin`
*   ç™»å½•å¯†ç ï¼š`admin123456`

3 ä¸Šä¼ æ–‡ä»¶
======

åœ¨ **MinIO**ï¼ˆä»¥åŠæ‰€æœ‰å…¼å®¹ S3 çš„å¯¹è±¡å­˜å‚¨ç³»ç»Ÿï¼‰ä¸­ï¼Œ**æ¡¶ï¼ˆBucketï¼‰** æ˜¯æœ€é¡¶å±‚çš„é€»è¾‘å­˜å‚¨å•å…ƒï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œå‘½åç©ºé—´â€æˆ–â€œå¤§æ–‡ä»¶å¤¹â€ï¼Œå®ƒæ˜¯æ‰€æœ‰å¯¹è±¡ï¼ˆæ–‡ä»¶ï¼‰çš„å®¹å™¨ã€‚

MinIO ä¸å­˜åœ¨çœŸæ­£çš„ç›®å½•ç»“æ„ï¼Œè€Œæ˜¯**é€šè¿‡å¯¹è±¡ key çš„å‰ç¼€æ¥æ¨¡æ‹Ÿç›®å½•å±‚çº§**ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª bucket å« `datasets` ï¼Œæ•°æ®é›†ä¸‹é¢çš„æ–‡ä»¶å¯¹è±¡å¦‚ä¸‹ï¼š

    datasets/
     â”œâ”€â”€ mydataset1/
     â”‚    â”œâ”€â”€ train/image1.jpg
     â”‚    â””â”€â”€ train/image2.jpg
     â””â”€â”€ mydataset2/
          â”œâ”€â”€ data.csv
          â””â”€â”€ labels.txt
    

è™½ç„¶çœ‹èµ·æ¥åƒç›®å½•æ ‘ï¼Œä½†å®é™…ä¸Šå­˜å‚¨ç³»ç»Ÿä¸­åªæœ‰å¯¹è±¡ï¼š

    datasets/mydataset1/train/image1.jpg
    datasets/mydataset1/train/image2.jpg
    datasets/mydataset2/data.csv
    datasets/mydataset2/labels.txt
    

MinIO å®¢æˆ·ç«¯ï¼ˆmcï¼‰æˆ– SDKï¼ˆJava/Pythonï¼‰åœ¨åˆ—ä¸¾å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨æŠŠè¿™äº›å‰ç¼€è¯†åˆ«ä¸ºâ€œç›®å½•â€ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰ç…§æµç¨‹ä¸Šä¼ æ–‡ä»¶ã€‚

**1ã€åˆ›å»ºæ¡¶ datasets**

**2ã€åˆ›å»ºæ–°è·¯å¾„ mydataset1**

**3ã€ä¸Šä¼ å›¾ç‰‡**

4 è®¿é—®æˆæƒ
======

**1ã€ä¿®æ”¹æ¡¶çš„è®¿é—®ç­–ç•¥**

å›¾ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†è®¿é—®ç­–ç•¥ä» Private ä¿®æ”¹æˆ Public ã€‚

**2ã€è®¿é—®å›¾ç‰‡**

MinIO åœ°å€ï¼š`http://localhost:9000`

æ¡¶åï¼š`datasets`

å¯¹è±¡è·¯å¾„ï¼š`mydataset1/çˆ¶ä¸å¥³.png`

å› ä¸ºæ¡¶å·²ç»è®¾ç½®ä¸º Public ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®å¦‚ä¸‹çš„é“¾æ¥å³å¯ï¼š

5 Java ç¤ºä¾‹
=========

01 åˆ›å»º Access Key
----------------

02 Minio ä¸Šä¼ ç¤ºä¾‹
-------------

**1ã€æ·»åŠ ä¾èµ–**

    <dependency>
        <groupId>io.minio</groupId>
        <artifactId>minio</artifactId>
        <version>8.5.10</version>
    </dependency>
    

**2ã€ç¼–å†™ä»£ç **

    public class MinioUnitTest {
    
        public static void main(String[] args) {
            try {
                // 1. åˆå§‹åŒ– MinIO å®¢æˆ·ç«¯
                MinioClient minioClient = MinioClient.builder()
                        .endpoint("http://localhost:9000") // MinIO åœ°å€
                        // accessKey å’Œ secretKey
                        .credentials("yHxFBiulXKsuhbg9nHqO", "qmsQU4JuWuwlr3ZgY4eMFbQ9LaTzzEHMV6T722kC")
                        .build();
    
                // 2. æ–‡ä»¶ä¿¡æ¯
                String bucketName = "datasets";
                String objectName = "mydataset1/images/xiaoyuanjiang.webp"; // ä¸Šä¼ è·¯å¾„ï¼ˆç±»ä¼¼ç›®å½•ï¼‰
                String filePath = "/Users/zhangyong/Pictures/xiaoyuanjiang.webp"; // æœ¬åœ°æ–‡ä»¶è·¯å¾„
    
                // 3. ä¸Šä¼ æ–‡ä»¶ï¼ˆæµå¼ä¸Šä¼ ï¼‰
                try (InputStream in = new FileInputStream(filePath)) {
                    minioClient.putObject(
                            PutObjectArgs.builder()
                                    .bucket(bucketName)
                                    .object(objectName)
                                    .stream(in, in.available(), -1)
                                    .contentType("image/png") // å¯æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®
                                    .build()
                    );
                    System.out.println("âœ… æ–‡ä»¶ä¸Šä¼ æˆåŠŸ: " + objectName);
                }
    
                // 4. æ‹¼æ¥ç›´é“¾ URLï¼ˆå› ä¸ºæ˜¯ public bucketï¼‰
                String publicUrl = String.format("http://localhost:9000/%s/%s", bucketName, objectName);
                System.out.println("âœ… ä¸Šä¼ æˆåŠŸï¼Œç›´é“¾åœ°å€ï¼š");
                System.out.println(publicUrl);
    
    //            // 4. ç”Ÿæˆä¸´æ—¶è®¿é—®é“¾æ¥ï¼ˆå¯é€‰ï¼‰
    //            String url = minioClient.getPresignedObjectUrl(
    //                    GetPresignedObjectUrlArgs.builder()
    //                            .method(Method.GET)
    //                            .bucket(bucketName)
    //                            .object(objectName)
    //                            .expiry(60 * 60) // 1å°æ—¶æœ‰æ•ˆ
    //                            .build()
    //            );
    //            System.out.println("ğŸ“ ä¸´æ—¶è®¿é—®åœ°å€: " + url);
    
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
    

**3ã€æ‰§è¡Œæ•ˆæœ**