---
layout: post
title: 'ä»é›¶å¼€å§‹æ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººï¼šRasaä¸ChatGPT APIå®æˆ˜æ•™ç¨‹'
date: "2025-04-12T00:38:32Z"
---
ä»é›¶å¼€å§‹æ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººï¼šRasaä¸ChatGPT APIå®æˆ˜æ•™ç¨‹
==================================

åœ¨æ•°å­—åŒ–è½¬å‹æµªæ½®ä¸­ï¼ŒèŠå¤©æœºå™¨äººå·²æˆä¸ºè¿æ¥ç”¨æˆ·ä¸æœåŠ¡çš„å…³é”®çº½å¸¦ã€‚æ— è®ºæ˜¯å®¢æœç³»ç»Ÿä¸­çš„7Ã—24å°æ—¶å³æ—¶å“åº”ï¼Œè¿˜æ˜¯æ™ºèƒ½å®¶å±…ä¸­çš„è¯­éŸ³äº¤äº’ï¼ŒèŠå¤©æœºå™¨äººæ­£åœ¨é‡å¡‘äººæœºäº¤äº’æ–¹å¼ã€‚æœ¬æ–‡å°†é€šè¿‡è¯¦ç»†æ•™ç¨‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨Rasaæ¡†æ¶å’ŒChatGPT APIæ„å»ºå¯äº¤äº’çš„Webç«¯èŠå¤©æœºå™¨äººï¼Œæ¶µç›–ç¯å¢ƒæ­å»ºã€æ¨¡å‹è®­ç»ƒã€APIè°ƒç”¨åˆ°éƒ¨ç½²è¿ç»´çš„å…¨æµç¨‹ã€‚

å¼•è¨€ï¼šAIå¯¹è¯ç³»ç»Ÿçš„æ—¶ä»£æœºé‡
--------------

åœ¨æ•°å­—åŒ–è½¬å‹æµªæ½®ä¸­ï¼ŒèŠå¤©æœºå™¨äººå·²æˆä¸ºè¿æ¥ç”¨æˆ·ä¸æœåŠ¡çš„å…³é”®çº½å¸¦ã€‚æ— è®ºæ˜¯å®¢æœç³»ç»Ÿä¸­çš„7Ã—24å°æ—¶å³æ—¶å“åº”ï¼Œè¿˜æ˜¯æ™ºèƒ½å®¶å±…ä¸­çš„è¯­éŸ³äº¤äº’ï¼ŒèŠå¤©æœºå™¨äººæ­£åœ¨é‡å¡‘äººæœºäº¤äº’æ–¹å¼ã€‚æœ¬æ–‡å°†é€šè¿‡è¯¦ç»†æ•™ç¨‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨Rasaæ¡†æ¶å’ŒChatGPT APIæ„å»ºå¯äº¤äº’çš„Webç«¯èŠå¤©æœºå™¨äººï¼Œæ¶µç›–ç¯å¢ƒæ­å»ºã€æ¨¡å‹è®­ç»ƒã€APIè°ƒç”¨åˆ°éƒ¨ç½²è¿ç»´çš„å…¨æµç¨‹ã€‚

ä¸€ã€æŠ€æœ¯é€‰å‹ï¼šRasaä¸ChatGPTçš„æ ¸å¿ƒä¼˜åŠ¿
------------------------

### Rasaæ¡†æ¶ï¼šå¼€æºå¯¹è¯ç³»ç»Ÿçš„ç‘å£«å†›åˆ€

*   **æ¨¡å—åŒ–æ¶æ„**ï¼šNLUï¼ˆè‡ªç„¶è¯­è¨€ç†è§£ï¼‰+ Coreï¼ˆå¯¹è¯ç®¡ç†ï¼‰+ Xï¼ˆå¯è§†åŒ–å·¥å…·ï¼‰ï¼›
*   **æ•°æ®å¯æ§æ€§**ï¼šæ”¯æŒæœ¬åœ°åŒ–è®­ç»ƒï¼Œæ•æ„Ÿæ•°æ®æ— éœ€ä¸Šä¼ äº‘ç«¯ï¼›
*   **å®šåˆ¶çµæ´»æ€§**ï¼šé€šè¿‡YAMLæ–‡ä»¶å®šä¹‰å¯¹è¯æµç¨‹ï¼ŒPythonä»£ç å®ç°ä¸šåŠ¡é€»è¾‘ï¼›
*   **å…¸å‹åœºæ™¯**ï¼šéœ€è¦å¤æ‚å¤šè½®å¯¹è¯ã€é¢†åŸŸçŸ¥è¯†åº“é›†æˆçš„ä¼ä¸šçº§åº”ç”¨ã€‚

### ChatGPT APIï¼šç”Ÿæˆå¼AIçš„ç»ˆææ­¦å™¨

*   **å¤§æ¨¡å‹èƒ½åŠ›**ï¼šåŸºäºGPT-3.5-turboå¼•æ“ï¼Œæ“…é•¿å¼€æ”¾å¼å¯¹è¯ä¸åˆ›æ„ç”Ÿæˆï¼›
*   **å¿«é€Ÿè¿­ä»£**ï¼šé€šè¿‡APIè°ƒç”¨å³å¯è·å¾—æœ€æ–°æ¨¡å‹èƒ½åŠ›ï¼Œæ— éœ€æœ¬åœ°è®­ç»ƒï¼›
*   **æˆæœ¬æ•ˆç›Š**ï¼šæŒ‰éœ€ä»˜è´¹æ¨¡å¼ï¼ˆ$0.002/1000 tokensï¼‰ï¼Œé€‚åˆæµé‡æ³¢åŠ¨å¤§çš„åœºæ™¯ï¼›
*   **å…¸å‹åœºæ™¯**ï¼šå®¢æœé—®ç­”ã€å†…å®¹åˆ›ä½œã€æ•™è‚²è¾…å¯¼ç­‰æ³›åœºæ™¯å¯¹è¯ã€‚

äºŒã€åŸºäºRasaçš„èŠå¤©æœºå™¨äººå¼€å‘å®æˆ˜
------------------

### 2.1 ç¯å¢ƒæ­å»ºï¼šPythonç”Ÿæ€çš„é­”æ³•å¯åŠ¨

    # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èPython 3.8+ï¼‰
    python -m venv rasa_env
    source rasa_env/bin/activate  # Linux/Mac
    rasa_env\Scripts\activate     # Windows
     
    # å®‰è£…Rasaæ ¸å¿ƒåº“
    pip install rasa
     
    # åˆå§‹åŒ–é¡¹ç›®ï¼ˆè‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹æ–‡ä»¶ï¼‰
    rasa init --no-prompt
    

### 2.2 é¢†åŸŸå»ºæ¨¡ï¼šå¯¹è¯ç³»ç»Ÿçš„DNAè®¾è®¡

**domain.yml**ç¤ºä¾‹ï¼š

    version: "3.0"
    intents:
      - greet
      - ask_weather
      - goodbye
     
    entities:
      - city
     
    responses:
      utter_greet:
        - text: "ä½ å¥½ï¼æˆ‘æ˜¯å¤©æ°”æŸ¥è¯¢æœºå™¨äººï¼Œè¯·è¾“å…¥åŸå¸‚åç§°æŸ¥è¯¢å¤©æ°”"
      utter_weather:
        - text: "ğŸŒ¦ï¸ {city}ä»Šå¤©å¤©æ°”ï¼šæ™´ï¼Œæ¸©åº¦25â„ƒ"
     
    actions:
      - action_fetch_weather
    

### 2.3 è®­ç»ƒæ•°æ®å‡†å¤‡ï¼šNLUçš„ç²®é£Ÿ

**nlu.yml**ç¤ºä¾‹ï¼š

    version: "3.0"
    nlu:
      - intent: greet
        examples: |
          - ä½ å¥½
          - æ—©ä¸Šå¥½
          - åœ¨å—
     
      - intent: ask_weather
        examples: |
          - [åŒ—äº¬](city)å¤©æ°”æ€ä¹ˆæ ·
          - æŸ¥[ä¸Šæµ·](city)çš„å¤©æ°”é¢„æŠ¥
    

**stories.yml**ç¤ºä¾‹ï¼š

    version: "3.0"
    stories:
      - story: ç®€å•æŸ¥è¯¢
        steps:
          - intent: greet
          - action: utter_greet
          - intent: ask_weather
          - action: action_fetch_weather
          - intent: goodbye
          - action: utter_goodbye
    

### 2.4 æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–

    # è®­ç»ƒNLUæ¨¡å‹
    rasa train nlu
     
    # è®­ç»ƒå¯¹è¯æ¨¡å‹
    rasa train core
     
    # äº¤å‰éªŒè¯æµ‹è¯•
    rasa test
    

### 2.5 éƒ¨ç½²ä¸Webé›†æˆ

**app.py**ï¼ˆä½¿ç”¨Flask-SocketIOå®ç°å®æ—¶é€šä¿¡ï¼‰ï¼š

    from flask import Flask, render_template
    from flask_socketio import SocketIO, send
    import rasa
     
    app = Flask(__name__)
    app.config['SECRET_KEY'] = 'your_secret_key'
    socketio = SocketIO(app)
     
    # åŠ è½½è®­ç»ƒå¥½çš„Rasaæ¨¡å‹
    interpreter = rasa.model.get_model('models').interpreter
     
    @app.route('/')
    def index():
        return render_template('chat.html')
     
    @socketio.on('message')
    def handle_message(msg):
        # è·å–ç”¨æˆ·è¾“å…¥
        user_input = msg['message']
        
        # Rasaæ¨¡å‹å¤„ç†
        result = interpreter.parse(user_input)
        response = result['text']
        
        # è¿”å›å“åº”
        send({'message': response}, broadcast=True)
     
    if __name__ == '__main__':
        socketio.run(app, debug=True)
    

**chat.html**å‰ç«¯ç•Œé¢ï¼š

    <!DOCTYPE html>
    <html>
    <head>
        <title>RasaèŠå¤©æœºå™¨äºº</title>
        <style>
            .chat-container { height: 400px; overflow-y: auto; border: 1px solid #ccc; }
            .message { padding: 8px; margin: 5px; border-radius: 4px; }
            .user { background-color: #e3f2fd; text-align: right; }
            .bot { background-color: #f0f4c3; text-align: left; }
        </style>
    </head>
    <body>
        <div class="chat-container" id="chatbox"></div>
        <input type="text" id="userInput" placeholder="è¾“å…¥æ¶ˆæ¯...">
        <button onclick="sendMessage()">å‘é€</button>
     
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
        <script>
            const socket = io();
            
            function sendMessage() {
                const message = document.getElementById('userInput').value;
                const chatbox = document.getElementById('chatbox');
                
                // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
                chatbox.innerHTML += `<div class="message user">${message}</div>`;
                
                // å‘é€æ¶ˆæ¯åˆ°åç«¯
                socket.emit('message', { message });
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                document.getElementById('userInput').value = '';
                
                // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
                chatbox.scrollTop = chatbox.scrollHeight;
            }
     
            // æ¥æ”¶æœºå™¨äººå“åº”
            socket.on('message', (data) => {
                const chatbox = document.getElementById('chatbox');
                chatbox.innerHTML += `<div class="message bot">${data.message}</div>`;
                chatbox.scrollTop = chatbox.scrollHeight;
            });
        </script>
    </body>
    </html>
    

ä¸‰ã€ChatGPT APIå¿«é€Ÿé›†æˆæ–¹æ¡ˆ
-------------------

### 3.1 APIå¯†é’¥è·å–

1.  è®¿é—®https://www.openai.com/æ³¨å†Œè´¦å·ï¼›
2.  è¿›å…¥æ§åˆ¶å°ç”ŸæˆAPIå¯†é’¥ï¼ˆå¦¥å–„ä¿ç®¡ï¼‰ã€‚

### 3.2 Pythonè°ƒç”¨ç¤ºä¾‹

    import openai
    import os
     
    # ä»ç¯å¢ƒå˜é‡åŠ è½½APIå¯†é’¥
    openai.api_key = os.getenv("OPENAI_API_KEY")
     
    def chat_with_gpt(prompt, max_tokens=50, temperature=0.7):
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": prompt}]
        )
        return response.choices[0].text.strip()
     
    # æµ‹è¯•å¯¹è¯
    user_input = "å¸®æˆ‘å†™ä¸€é¦–å…³äºç§‹å¤©çš„è¯—"
    bot_response = chat_with_gpt(user_input)
    print(f"ç”¨æˆ·: {user_input}\næœºå™¨äºº: {bot_response}")
    

### 3.3 Webç«¯é›†æˆï¼ˆFlaskç¤ºä¾‹ï¼‰

    from flask import Flask, request, jsonify
     
    app = Flask(__name__)
     
    @app.route('/chat', methods=['POST'])
    def chat():
        user_message = request.json['message']
        bot_response = chat_with_gpt(user_message)
        return jsonify({'response': bot_response})
     
    if __name__ == '__main__':
        app.run(port=5000)
    

å››ã€æ··åˆæ¶æ„ï¼šRasa + ChatGPTçš„ååŒè¿›åŒ–
--------------------------

### 4.1 æ¶æ„è®¾è®¡

Rasa + ChatGPTååŒè¿›åŒ–ã€‚

### 4.2 å®ç°æ­¥éª¤

1.  **Rasaå¤„ç†ç»“æ„åŒ–è¯·æ±‚**ï¼š

    # actions.py
    from rasa_sdk import Action
    import openai
     
    class ActionQueryWeather(Action):
        def name(self):
            return "action_query_weather"
        
        def run(self, dispatcher, tracker, domain):
            city = tracker.get_slot("city")
            prompt = f"æŸ¥è¯¢{city}çš„å®æ—¶å¤©æ°”"
            response = openai.ChatCompletion.create(
                model="gpt-3.5-turbo",
                messages=[{"role": "user", "content": prompt}]
            )
            dispatcher.utter_message(text=response.choices[0].text)
            return []
    

2.**é…ç½®Rasaè°ƒç”¨å¤–éƒ¨API**ï¼š

    # endpoints.yml
    action_endpoint:
      url: "http://localhost:5055/webhook"
    

äº”ã€éƒ¨ç½²ä¸è¿ç»´æœ€ä½³å®è·µ
-----------

### 5.1 éƒ¨ç½²æ–¹æ¡ˆé€‰æ‹©

æ–¹æ¡ˆ

é€‚ç”¨åœºæ™¯

æˆæœ¬

çµæ´»æ€§

æœ¬åœ°æœåŠ¡å™¨

å°å‹é¡¹ç›®/æµ‹è¯•ç¯å¢ƒ

ä½

ä¸­

äº‘å‡½æ•°ï¼ˆAWS Lambdaï¼‰

æµé‡æ³¢åŠ¨å¤§

ä¸­

é«˜

å®¹å™¨åŒ–ï¼ˆDocker+K8sï¼‰

ä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒ

è¾ƒé«˜

æé«˜

### 5.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§

1.  **è¯·æ±‚æ‰¹å¤„ç†**ï¼šåˆå¹¶å¤šä¸ªç”¨æˆ·è¯·æ±‚å‡å°‘APIè°ƒç”¨æ¬¡æ•°ï¼›
2.  **ç¼“å­˜æœºåˆ¶**ï¼šå¯¹é«˜é¢‘é—®é¢˜ï¼ˆå¦‚å¤©æ°”æŸ¥è¯¢ï¼‰è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼›
3.  **è´Ÿè½½å‡è¡¡**ï¼šä½¿ç”¨Nginxåˆ†å‘è¯·æ±‚åˆ°å¤šä¸ªRasaå®ä¾‹ã€‚

å…­ã€ä¸šåŠ¡åœºæ™¯æ·±åº¦å®šåˆ¶
----------

### 6.1 ç‰©æµä¾›åº”é“¾æ¡ˆä¾‹

**éœ€æ±‚**ï¼šä¼˜åŒ–å¤šå¼è”è¿è°ƒåº¦å†³ç­–ã€‚  
**å®ç°**ï¼š

    def analyze_logistics_data(data):
        # ä½¿ç”¨ChatGPTè§£æéç»“æ„åŒ–ç‰©æµæ•°æ®
        prompt = f"åˆ†æä»¥ä¸‹ç‰©æµæ•°æ®ï¼š\n{data}"
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": prompt}]
        )
        return response.choices[0].text
    

### 6.2 æ•™è‚²å¹³å°æ¡ˆä¾‹

**éœ€æ±‚**ï¼šä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„æ¨èã€‚  
**å®ç°**ï¼š

    def generate_study_plan(student_data):
        prompt = f"æ ¹æ®ä»¥ä¸‹å­¦ç”Ÿæ•°æ®ç”Ÿæˆå­¦ä¹ è®¡åˆ’ï¼š\n{student_data}"
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": prompt}]
        )
        return response.choices[0].text
    

ä¸ƒã€æ€»ç»“ä¸å±•æœ›
-------

æœ¬æ–‡é€šè¿‡Rasaæ¡†æ¶å’ŒChatGPT APIçš„ç»„åˆæ‹³ï¼Œå±•ç¤ºäº†ä»åŸºç¡€èŠå¤©æœºå™¨äººåˆ°ä¼ä¸šçº§æ™ºèƒ½å¯¹è¯ç³»ç»Ÿçš„å®Œæ•´å¼€å‘æµç¨‹ã€‚æœªæ¥ï¼Œéšç€å¤§æ¨¡å‹èƒ½åŠ›çš„æŒç»­è¿›åŒ–ï¼Œä»¥ä¸‹æ–¹å‘å€¼å¾—å…³æ³¨ï¼š

1.  **å¤šæ¨¡æ€äº¤äº’**ï¼šé›†æˆè¯­éŸ³è¯†åˆ«ã€å›¾åƒç†è§£ç­‰èƒ½åŠ›ï¼›
2.  **å¼ºåŒ–å­¦ä¹ **ï¼šé€šè¿‡ç”¨æˆ·åé¦ˆä¼˜åŒ–å¯¹è¯ç­–ç•¥ï¼›
3.  **è¾¹ç¼˜è®¡ç®—**ï¼šåœ¨æœ¬åœ°è®¾å¤‡å®ç°ä½å»¶è¿Ÿå“åº”ã€‚

ç«‹å³åŠ¨æ‰‹å®è·µï¼Œæ„å»ºå±äºä½ çš„æ™ºèƒ½å¯¹è¯ç³»ç»Ÿå§ï¼