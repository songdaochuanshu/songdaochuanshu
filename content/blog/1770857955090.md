---
layout: post
title: 'MyBatis XML 里＜![CDATA[ ]]＞的使用'
date: "2026-02-12T00:59:15Z"
---
MyBatis XML 里＜!\[CDATA\[ \]\]＞的使用
=================================

是 MyBatis 中处理 SQL 语句与 XML 语法冲突的安全屏障。对包含 特殊字符 的 SQL 片段进行最小范围的 CDATA 包裹，既保证了安全，又确保了 MyBatis 动态 SQL 功能的完整性。

今天我们来聊聊 MyBatis XML 文件里的 **<!\[CDATA\[ \]\]>** ，我依稀记得我第一次看到 **<!\[CDATA\[ \]\]>**，心想，这是个啥啊？

首先我们要明确：**<!\[CDATA\[ \]\]>  不是 MyBatis 的专属语法**，而是 XML 的原生语法（全称 Character Data，字符数据）。

**XML 解析器** 对某些特殊字符（比如 **<、>、&、'、"** 等）进行解析的时候，可能会将这些特殊字符 **误判**，比如 将 **<** 识别为 XML 标签的开始，等等。

**<!\[CDATA\[ \]\]>** 的核心作用：**将包裹的内容标记为 "纯文本"**，XML 解析器会跳过对其中内容的语法解析，直接 **原样保留**，从而避免特殊字符与 XML 语法的冲突，保证 MyBatis 最终拿到的 SQL 是我们预期的样子。

我们除了可以使用 **<!\[CDATA\[ \]\]>**，也可以使用 **转义字符**。

常用的 **转义字符对照**：

*   **< → &lt;**
*   **\> → &gt;**
*   **& → &amp;**
*   **" → &quot;**
*   **' → &apos;**

注意结尾的 **;** 需要留着。

**错误写法**：

    <!-- XML解析器会把 < 识别为标签开始，直接报错 -->
    <select id="getUserByAge" resultType="User">
        SELECT * FROM user WHERE age < #{age}
    </select>

**使用 转义 写法**：

    <select id="getUserByAge" resultType="User">
        SELECT * FROM user WHERE age &lt; #{age}
    </select>

**使用 CDATA 写法**：

    <select id="getUserByAge" resultType="User">
        SELECT * FROM user WHERE <![CDATA[ age < #{age} ]]>
    </select>

是不是使用 **CDATA** 的可读性要高很多，所以推荐使用 **CDATA**，尤其是复杂SQL。

我们看个不是很复杂的SQL。

**复杂SQL 转义 写法**：

    <select id="getUserBySpec" resultType="User">
        SELECT * FROM user WHERE (age &lt; #{age} OR salary &gt; #{salary})
        AND (create_time gt;= #{startTime} OR update_time lt;= #{endTime})
    </select>

**复杂SQL CDATA 写法**：

    <select id="getUserBySpec" resultType="User">
        SELECT * FROM user
        <![CDATA[
            WHERE (age < #{age} OR salary > #{salary}) 
            AND (create_time >= #{startTime} OR update_time <= #{endTime})
        ]]>
    </select>

**MyBatis 高版本** 对部分特殊字符做了兼容，比如直接写 **\>** 可能不报错了。这是 "宽松解析"，跨环境（比如不同 XML 解析器、不同数据库驱动等）仍有可能出问题，**推荐始终用 CDATA 保证兼容性**。

**<!\[CDATA\[ \]\]>** 是 MyBatis 中处理 SQL 语句与 XML 语法冲突的安全屏障。对包含 **特殊字符** 的 SQL 片段进行最小范围的 **CDATA 包裹**，既保证了安全，又确保了 MyBatis 动态 SQL 功能的完整性。

手执烟火以谋生，心怀诗意以谋爱。-- 烟沙九洲