---
layout: post
title: '用 just 简化项目命令管理'
date: "2025-02-19T00:36:17Z"
---
用 just 简化项目命令管理
===============

在软件开发过程中，高效管理项目命令是提升开发效率的关键，

它们可以帮助我们自动化重复的任务，简化项目管理流程，提高效率。

今天，我们来介绍一个名为 `just` 的任务运行器。

它由 Casey 发起，用 Rust 编写，旨在提供一个简单、高效且用户友好的任务管理解决方案。

`just` 的设计理念是让任务运行变得轻量级且易于上手，同时避免了传统工具如 `Make` 的复杂性。

1\. 安装
======

`just` 提供了多种安装方式，几乎涵盖了所有主流操作系统。

以下是几种常见的安装方法：

1.1. 使用 Cargo 安装
----------------

如果你已经安装了 `Rust`，可以通过 `Cargo` 安装 `just`:

    cargo install just
    

1.2. 使用 Homebrew
----------------

在 `macOS` 上，可以通过 `Homebrew` 安装 `just`：

    brew install just
    

1.3. 使用 Scoop
-------------

对于 `Windows` 用户，`Scoop` 是一个方便的包管理器，可以通过以下命令安装 `just`：

    scoop install just
    

1.4. 使用预制二进制文件
--------------

如果你不想使用包管理器，也可以直接下载 `just` 的预制二进制文件。

访问 just 的 [GitHub Releases](https://github.com/casey/just/releases) 页面，选择适合你操作系统的版本并下载。

安装完成后，运行以下命令以确保 `just` 已正确安装：

    just --version
    

如果一切正常，你将看到 `just` 的版本信息。

2\. 核心语法
========

`just`的核心是`justfile`文件，它类似于 `Make` 的 `Makefile`，用于定义任务和任务之间的依赖关系。

`just`的语法简洁明了，易于上手。

下面总结了其语法中常用的部分，如果熟悉make工具的话，看着会觉得很熟悉。

2.1. 定义任务
---------

在`justfile`中，任务以名称开头，后跟冒号和任务的具体命令。

    hello:
        echo "hello JUST"
    

运行任务时，只需在终端中输入 `just hello`，`just` 就会执行 `hello` 这个任务。

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952912-378215374.png)

2.2. 任务依赖
---------

`just` 支持任务之间的依赖关系，可以通过在任务名称后添加依赖任务来实现。

    build:
        echo "this is BUILD command"
    
    release: build
        echo "start to RELEASE... ..."
    

`release`任务依赖`build`任务，所以执行`release`任务是会自动先执行`build`任务。

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952911-1626634287.png)

2.3. 参数和变量
----------

`just`支持任务参数和变量，这使得任务更加灵活。

    build version:
        echo "BUILD for version: {{version}}"
    

给`build`任务添加一个参数`version`，这样可以指定要编译的版本。

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952912-334028678.png)

2.4. 条件表达式
----------

`just`支持条件表达式，可以根据条件动态执行任务。

    build version:
      echo {{ if version == "latest" { "使用【最新】的编译方式" } else { "使用【旧】的编译方式" } }}
    

根据`version`参数，选择不同的编译方式。

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952898-1573931846.png)

2.5. 静默模式
---------

默认情况下，`just`会在执行命令前打印命令内容。

如果希望隐藏这些输出，可以在命令前加上`@`符号，比如上面的示例中，每个`echo`命令本身都被输出了出来。

比如在第一个示例中，我们在`echo`前面加一个`@`符号。

    hello:
      @echo "hello JUST"
    

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952899-1783713841.png)

这样就只输出内容，不会将命令本身输出出来了。

2.6. 错误处理
---------

`just`会在命令失败时停止执行任务，这有助于避免错误的传播。

    hello:
      echo "命令1"
      echo1 "错误的命令"
      echo "命令2"
    

![](https://img2024.cnblogs.com/blog/83005/202502/83005-20250218140952908-1377322818.png)

`echo1` 这个命令是不存在的，执行到这一步的时候出现了错误，直接退出，不会执行下面的 \*\*命令2 \*\*了。

3\. 与make的比较
============

与`just`最接近的工具就是`make`，但它们在设计理念和实现上有显著的区别。

just

make

语法简洁性

简洁明了，易于理解和使用

较为复杂，尤其是对于新手来说，可能会感到困惑

跨平台支持

用 `Rust` 编写的，具有良好的跨平台支持

主要用于 `Unix-like` 系统，虽然也有 `Windows` 版本（如 `MinGW`），但使用起来可能会有一些兼容性问题

任务依赖管理

直观和灵活。它允许任务依赖于其他任务，并且可以动态地传递参数

基于文件的时间戳，对于复杂的任务依赖关系，可能需要更多的配置

错误处理

自动处理错误，如果某个命令失败，任务会立即停止执行

默认会继续执行后续任务，除非显式地指定`stop`

输出友好性

输出友好，支持颜色化输出，并且在错误处理上更加用户友好

输出较为简单，可能需要额外的工具来美化输出

4\. 总结
======

`just` 是一个现代的任务运行器，它以简洁的语法、强大的功能和良好的跨平台支持，为开发者提供了一个高效的项目管理工具。

它不仅适用于构建和测试任务，还可以用于初始化开发环境、创建快捷命令等多种场景。

如果你正在寻找一个替代 `make` 的工具，`just` 绝对值得一试。