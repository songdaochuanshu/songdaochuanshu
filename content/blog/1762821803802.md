---
layout: post
title: 'Oracle OGG日常运维命令都在这里了。'
date: "2025-11-11T00:43:23Z"
---
Oracle OGG日常运维命令都在这里了。
----------------------

OGG配置与日常运维操作指南
==============

Oracle GoldenGate（OGG）作为主流的数据同步工具，其配置的合理性与运维的规范性直接影响数据同步的效率与稳定性。本文将详细介绍OGG的核心配置步骤（含源端与目的端）及高频日常运维命令，助力技术人员高效管理OGG环境。

一、OGG核心配置
---------

OGG配置需区分**源端**（数据抽取端）与**目的端**（数据接收端），两端因功能定位不同，所需配置的参数文件数量与类型存在差异。

### （一）源端配置：4个关键参数文件

源端核心功能是“抽取数据+投递数据”，需配置检查点、管理进程（mgr）、抽取进程、投递进程4类参数文件，操作均在GGSCI（OGG命令行界面）中执行：

1.  **配置检查点（GLOBALS文件）**  
    检查点用于记录OGG进程的运行位置，确保进程中断后可从断点恢复。命令如下：
    
        GGSCI (myoracle) 7> edit params ./GLOBALS
        
    
    该文件为全局配置，需定义检查点相关参数（如CHECKPOINTTABLE），确保进程间检查点信息同步。
    
2.  **配置管理进程（mgr）**  
    mgr是OGG的核心管理进程，负责监听客户端连接、管理其他进程（如抽取、投递进程）。命令如下：
    
        GGSCI (myoracle) 7> edit param mgr
        
    
    需配置监听端口（如PORT 7809）、进程超时时间等参数，保证mgr进程稳定运行。
    
3.  **配置抽取进程（以extorcl为例）**  
    抽取进程用于从源数据库日志（如Oracle的redo log）中抽取增量数据。命令如下：
    
        GGSCI (myoracle) 7> edit params extorcl
        
    
    需定义源数据库连接信息、抽取表范围、trail文件（数据传输中间文件）路径等参数，确保精准抽取目标数据。
    
4.  **配置投递进程（以PUMYSQL为例）**  
    投递进程将抽取进程生成的trail文件投递至目的端。命令如下：
    
        GGSCI (myoracle) 7> edit params PUMYSQL
        
    
    需配置目的端IP、端口、trail文件接收路径等参数，保证数据高效投递至目的端。
    

### （二）目的端配置：3个关键参数文件

目的端核心功能是“接收数据+应用数据”，需配置检查点、管理进程（mgr）、复制进程3类参数文件：

1.  **配置检查点（GLOBALS文件）**  
    与源端逻辑一致，目的端需通过GLOBALS文件定义检查点规则，确保复制进程断点恢复功能正常。命令如下：
    
        GGSCI (myoracle) 7> edit params ./GLOBALS
        
    
2.  **配置管理进程（mgr）**  
    目的端mgr进程负责接收源端投递的trail文件，并管理复制进程。命令与源端一致：
    
        GGSCI (myoracle) 7> edit param mgr
        
    
    需注意端口与源端投递进程配置的端口一致，避免连接失败。
    
3.  **配置复制进程（以R\_TAB1为例）**  
    复制进程将目的端接收的trail文件解析并应用到目标数据库。命令如下：
    
        GGSCI (mysql) 11> edit param R_TAB1
        
    
    需配置目标数据库连接信息、数据映射规则（如源表与目标表对应关系）、冲突处理策略等参数，确保数据正确应用。
    

二、OGG日常运维核心命令
-------------

日常运维需围绕“进程监控、问题排查、进程管理”三类场景展开，以下为高频运维命令及说明：

### 1\. 查看操作历史记录

快速回溯GGSCI中执行过的命令，便于问题排查：

    GGSCI (myoracle) 2> h
    

### 2\. 查看进程参数设置

确认进程的配置参数（如抽取表、投递地址），命令格式为`view params <进程名>`：

    GGSCI (myoracle) 3> view params PUMYSQL
    

### 3\. 查看进程状态（关键监控命令）

根据需求选择不同粒度的状态查询，全面掌握进程运行情况：

*   查看所有进程状态：
    
        GGSCI (myoracle) 6> info all
        
    
*   查看单个进程基础状态（含进程状态、checkpoint信息、延时）：
    
        GGSCI (myoracle) 6> info PUMYSQL
        
    
*   查看单个进程详细状态（含trail文件路径、参数文件/报告文件/警告日志位置）：
    
        GGSCI (myoracle) 6> info PUMYSQL detail
        
    
*   查看进程checkpoint详细信息（含未处理事务的redo log位置，用于日志保留策略制定）：
    
        GGSCI (myoracle) 6> info PUMYSQL showch
        
    
    关键说明：`recovery checkpoint`（恢复检查点）表示源数据中最早未处理的事务，序列号大于该值的redo log需保留，避免数据丢失。

### 4\. 查看数据同步延时

比`info`命令更精准的延时查询，仅显示最后一条处理记录的延时：

    GGSCI (myoracle) 9> lag PUMYSQL
    

结果解读：若显示`At EOF, no more records to process.`，表示所有抽取数据已完成应用，无延时。

### 5\. 查看进程运行报告

查看进程运行日志（含错误信息、数据处理量），用于问题排查：

    GGSCI (myoracle) 15> view report PUMYSQL
    

### 6\. 重置进程（重新读取trail文件）

*   重置抽取进程：本地trail文件序列号从0开始生成
    
        GGSCI (myoracle) 15> alter extract extorcl, extseqno 0, extrba 0
        
    
*   重置复制进程：从0号trail文件开始读取
    
        GGSCI (myoracle) 15> alter replicat R_TAB1, extseqno 0, extrba 0
        
    
    适用场景：数据初始化、进程故障后重新同步。

### 7\. 查看告警信息

查看OGG全局告警日志，定位系统级问题（如mgr进程异常、数据库连接失败）：

    GGSCI (myoracle) 15> view ggsevt
    

### 8\. 删除OGG进程

需先登录数据库验证权限，再执行删除操作：

    # 1. 数据库登录（两种方式）
    GGSCI (myoracle) 15> dblogin userid 用户名, password 密码
    # 或通过别名登录
    GGSCI (myoracle) 10> dblogin useridalias ora19c
    
    # 2. 删除进程（抽取/复制进程通用）
    GGSCI (myoracle) 15> delete extract/replicat extorcl
    

### 9\. 进程启停管理

*   单个进程启停（以extorcl为例）：
    
        # 停止进程
        GGSCI (myoracle) 15> stop extorcl
        # 启动进程
        GGSCI (myoracle) 15> start extorcl
        
    
*   mgr进程启停（影响所有依赖进程）：
    
        # 停止mgr（需先停止其他进程）
        GGSCI (myoracle) 15> stop mgr
        # 启动mgr
        GGSCI (myoracle) 15> start mgr
        
    

### 10\. 新增/修改/删除进程

*   新增抽取进程：
    
        GGSCI (myoracle) 15> ADD EXTRACT extorcl, TRANLOG, BEGIN NOW
        
    
    说明：`TRANLOG`表示从数据库日志抽取数据，`BEGIN NOW`表示从当前时间开始抽取。
    
*   新增复制进程：
    
        GGSCI (myoracle) 15> ADD REPLICAT extorcl, EXTTRAIL <trail_name>
        
    
    说明：`<trail_name>`为目的端接收的trail文件路径。
    
*   修改进程参数：
    
        GGSCI (myoracle) 15> EDIT PARAMS extorcl
        
    
    说明：修改后需重启进程生效。
    
*   删除进程（同“8. 删除OGG进程”）。
    

### 11\. 清除抽取进程队列

清除抽取进程生成的历史trail文件，释放磁盘空间：

    GGSCI (myoracle) 15> ALTER EXTRACT extorcl, ETROLLOVER
    

### 12\. 数据库登录（权限验证）

OGG操作需先登录数据库获取权限，支持两种登录方式：

*   直接指定用户信息登录（以Oracle PDB为例）：
    
        GGSCI (myoracle) 18> dblogin userid ogg@192.168.59.251:1521/pdb19c password ogg
        
    
*   通过预配置的别名登录：
    
        GGSCI (myoracle) 10> dblogin useridalias ora19c
        
    

三、总结
----

OGG的配置需严格区分源端与目的端的功能定位，确保参数文件与业务需求匹配；日常运维则需通过高频监控命令（如`info`、`lag`、`view report`）及时掌握进程状态，借助重置、启停、删除等命令快速处理故障。掌握本文梳理的配置步骤与运维命令，可有效提升OGG环境的稳定性与数据同步的可靠性。

posted on 2025-11-10 13:52  [刘子毅](https://www.cnblogs.com/liuziyi1)  阅读(90)  评论(0)    [收藏](javascript:void\(0\))  [举报](javascript:void\(0\))