---
layout: post
title: 'æ–°æ¥çš„å¤–åŒ…ï¼Œé™æµç®—æ³•ç”¨çš„è¿™ä¹ˆ6'
date: "2025-11-04T00:41:36Z"
---
æ–°æ¥çš„å¤–åŒ…ï¼Œé™æµç®—æ³•ç”¨çš„è¿™ä¹ˆ6
===============

[CloudFlareä»‹ç»é™é€Ÿ](https://www.cloudflare.com/zh-cn/learning/bots/what-is-rate-limiting/ "CloudFlareä»‹ç»é™é€Ÿ")çš„æ–‡ç« ï¼Œ è®²è¿°äº†é™é€Ÿçš„ä½¿ç”¨åœºæ™¯å’Œè¿ä½œæ–¹å¼ã€‚

æœ€éš¾çš„æ˜¯æ„å»ºä¸€ä¸ªæ—¢é«˜æ•ˆåˆåŒ¹é…éœ€æ±‚çš„ç®—æ³•ã€‚

1.[æµè¡Œçš„é™é€Ÿå™¨](https://medium.com/redis-with-raphael-de-lio/rate-limiting-with-redis-an-essential-guide-df798b1c63db "æµè¡Œçš„é™é€Ÿå™¨")
--------------------------------------------------------------------------------------------------------------------------

### â‘  å›ºå®šçª—å£é™é€Ÿ Fixed Window Counter

è·Ÿè¸ªå›ºå®šæ—¶é—´é—´éš”ï¼ˆå¦‚ 1 åˆ†é’Ÿï¼‰å†…çš„è¯·æ±‚æ•°é‡ï¼Œä¸€æ—¦è¾¾åˆ°ä¸Šé™ï¼Œå°±ä¼šæ‹’ç»è¯¥çª—å£ä¸­çš„åç»­æ‰€æœ‰è¯·æ±‚ã€‚

![1_VsdNn5KGd1A0rIfbczGy8Q.gif](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/8628e09e050147bebbffd85fa580b7df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=YfpNXneYuFBoslgdGgPXyDmH5jY%3D)

UserCaseï¼š å¯é¢„æµ‹æµé‡ã€ä½ç²¾åº¦éœ€æ±‚çš„ç®€å•APIï¼Œæ¯”å¦‚äº‘å¹³å°ä¼šå¯¹å¼€å‘è€…æä¾› â€œå…è´¹è°ƒç”¨APIâ€çš„é™é€Ÿé¢åº¦ã€‚

egï¼š å…¬å…±å¤©æ°” API å…è®¸æ¯ä¸ªç”¨æˆ·æ¯åˆ†é’Ÿ 100 æ¬¡è¯·æ±‚ï¼Œä»»ä½•é¢å¤–è¯·æ±‚éƒ½ä¼šè¿”å› â€œ429 è¯·æ±‚è¿‡å¤š â€å“åº”ã€‚

Drawbackï¼š å®¢æˆ·ç«¯å¯é€šè¿‡åœ¨ä¸¤ä¸ªæ—¶é—´çª—å£çš„è¾¹ç•Œå †ç Œè¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œåœ¨1minæ—¶é—´çª—å£çš„ç¬¬59ç§’å’Œä¸‹ä¸€ä¸ª1minçª—å£çš„ç¬¬1séƒ½å †ç Œ100 ä¸ªè¯·æ±‚ï¼‰ï¼Œ è½»æ¾çªç ´qps=100/min è¯­ä¹‰ã€‚

å›ºå®šçª—å£ç®—æ³•å¯¹åº”æœ€ç›´è§‚æ„ä¹‰çš„qpsè¯­ä¹‰ï¼Œä½†æ˜¯qpsæ¼æ´ä¹Ÿå¾ˆæ˜æ˜¾ã€‚

### â‘¡ æ»‘åŠ¨çª—å£é™é€Ÿ Sliding Window Log

ç»´æŠ¤æ¯ä¸ªè¯·æ±‚çš„æ—¶é—´æˆ³æ—¥å¿—ï¼Œå¹¶æ ¹æ®æ»šåŠ¨æ—¶é—´çª—å£è®¡ç®—é™åˆ¶ã€‚

![1_tmaCfNHgzaAJNop4Aa2afA.gif](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/9f96548eb34f4b56b853ea7aaa1e523b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=L7XaJzwwJc8TaTUqM2Nt4HXTcf8%3D)

UserCaseï¼šè¦æ±‚é«˜ç²¾åº¦çš„æ ¸å¿ƒç³»ç»Ÿï¼Œå¦‚é‡‘èäº¤æ˜“ API æˆ–æ¬ºè¯ˆæ£€æµ‹æœºåˆ¶ã€‚

egï¼š é“¶è¡Œ API é™åˆ¶æ¯å°æ—¶å–æ¬¾æ¬¡æ•°ä¸º 10 æ¬¡ï¼Œæ¯æ¬¡æ–°è¯·æ±‚éƒ½è¦æ ¹æ®æœ€è¿‘1å°æ—¶çš„å–æ¬¾æ¬¡æ•°æ¥è¯„ä¼°ã€‚

Drawbackï¼š å½“æ‰©å±•åˆ°æ•°ç™¾ä¸‡ç”¨æˆ·æˆ–é¢‘ç¹è¯·æ±‚æ—¶ï¼Œå†…å­˜ä½¿ç”¨é‡å¤§ï¼ˆå¯ä»¥æƒ³è±¡å¯¹æ¯ä¸€ä¸ªè¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªkvçª—å£è®¡æ•°å™¨ï¼‰ï¼Œè®¡ç®—æˆæœ¬é«˜ã€‚

æ»‘åŠ¨çª—å£é™é€Ÿå™¨å¯¹åº”ä¸¥æ ¼æ„ä¹‰çš„qpsè¯­ä¹‰ï¼Œä»ä»»æ„ä¸€ä¸ªè¯·æ±‚ç‚¹åˆ‡å…¥çš„ç»Ÿè®¡éƒ½è¯•å›¾ä¿æŒæ’å®šçš„qpsï¼Œ è®¡ç®—æˆæœ¬é«˜ã€‚

### é‚£ä¸ºä»€ä¹ˆä¼šæœ‰æ¼æ¡¶å’Œä»¤ç‰Œæ¡¶ç®—æ³•ï¼Ÿ

ä¸Šé¢çš„å›ºå®šçª—å£å’Œæ»‘åŠ¨çª—å£ç®—æ³•ï¼Œä»–ä»¬éƒ½èšç„¦åœ¨â€œç»´æŒqpsâ€ï¼Œ å¯¹äºè¶…å‡ºqpsçš„æµé‡ä»–ä»¬ä¼šç›´æ¥æ‹’ç»ã€‚

æ¼æ¡¶ç®—æ³•å’Œä»¤ç‰Œæ¡¶ä¸ä»…èšç„¦â€œç»´æŒqpsâ€ï¼Œ åŒæ—¶ä¸å®Œå…¨æ— è„‘æ‹’ç»ï¼š

åœ¨çªå‘æµé‡æ—¶ï¼Œèƒ½ç»™å‡ºç­‰å¾…å¤„ç†/æœ‰æš‚å­˜ä»¤ç‰Œè¿…é€Ÿå¤„ç†çš„è¡Œä¸ºï¼Œ ä¹Ÿå°±æ˜¯èƒ½åº”å¯¹çªå‘çš„æµé‡æ³¢åŠ¨ã€‚

* * *

### â‘¢ æ¼æ¡¶é™é€Ÿ Leaky Bucket

æƒ³è±¡ä¸€ä¸ªåº•éƒ¨æœ‰å°å­”çš„æ°´æ¡¶ï¼Œè¯·æ±‚ï¼ˆæ°´ï¼‰è¢«æ·»åŠ åˆ°æ¡¶ä¸­ï¼Œå¹¶ä»¥ç¨³å®šçš„ â€œæ¼æ°´ â€é€Ÿåº¦è¿›è¡Œå¤„ç†ï¼Œä»è€Œé˜²æ­¢çªç„¶çš„æ´ªæ°´æ³›æ»¥ã€‚

![1_UioRG8-qID51i0rEOPVh-w.gif](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/5854a3b86b1748ae951ab6cd1bfbb919~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=aTj5SCDvfnE9%2BTUdJNO0GAbmZoU%3D)

UserCaseï¼š æ˜¯å¹³æ»‘æµé‡çš„ç†æƒ³é€‰æ‹©ï¼Œä¾‹å¦‚åœ¨æµåª’ä½“æœåŠ¡æˆ–æ”¯ä»˜å¤„ç†ä¸­ï¼Œå¯é¢„æµ‹çš„è¾“å‡ºæ˜¯è‡³å…³é‡è¦çš„ã€‚

egï¼š è§†é¢‘æµå¹³å°å¯¹å…¶å†…å®¹äº¤ä»˜ç½‘ç»œçš„ API è°ƒç”¨è¿›è¡Œç®¡ç†ï¼Œç¡®ä¿ä¸€è‡´çš„æ’­æ”¾è´¨é‡ã€‚

Drawbackï¼š ä¸é€‚åˆå¤„ç†çªå‘äº‹ä»¶ï¼Œå¦‚é—ªç”µé”€å”®æˆ–ä¿ƒé”€æ´»åŠ¨ã€‚

æ¼æ´ç®—æ³•åŸºäºâ€œç¨³å®šçš„æ¼æ°´æœºåˆ¶â€ï¼Œ**ä¹Ÿç»´æŒäº†ä¸¥æ ¼æ„ä¹‰çš„qpsè¯­ä¹‰ï¼Œä½†æ˜¯ä»–æœ‰æ¡¶ï¼ŒçŸ­æ—¶çš„æ³¢åŠ¨æµé‡å¯å‡­å€Ÿæ¡¶å®¹é‡æ’é˜Ÿä¾æ¬¡æ¼å‡º**ï¼Œ è¶…è¿‡æ¡¶å®¹é‡çš„è¯·æ±‚è¿˜æ˜¯ä¼šè¢«æ‹’ç»ã€‚

> ç‰©ç†å­¦æ„ä¹‰ï¼ˆå‹å¼º/é«˜åº¦å› ç´ ã€åŠ¨æ€å¹³è¡¡ï¼‰ä¸èƒ½ç»´æŒâ€ç¨³å®šçš„æ¼æ°´æœºåˆ¶â€œï¼Œ è¿™é‡Œçš„ç¨³å®šæ¼æ°´æœºåˆ¶æ˜¯éœ€è¦æŠ€æœ¯å¼ºåˆ¶å®ç°ã€‚

### â‘£ [ä»¤ç‰Œæ¡¶é™é€Ÿ](https://medium.com/@mojimich2015/token-bucket-algorithm-rate-limiting-explained-with-python-go-73a9f192fda3 "ä»¤ç‰Œæ¡¶é™é€Ÿå™¨")

ä»¤ç‰Œä»¥å›ºå®šé€Ÿç‡ç”Ÿæˆå¹¶å­˜å‚¨åœ¨ä¸€ä¸ªæ¡¶ä¸­ã€‚æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œï¼›æ”¯æŒçŸ­æ—¶é—´ç¬å‘ï¼ˆåªè¦æœ‰ä»¤ç‰Œï¼‰ã€‚ä»¤ç‰Œäº§ç”Ÿå¿«è¿‡å®é™…è¯·æ±‚ï¼Œæ¡¶æ»¡ä¼šè¢«ä¸¢å¼ƒã€‚

![1_7cDKq5yh5RD0ygvb3mVwfQ.gif](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/8a3f1a30e5104fa9af40e18ae8045615~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=U4P%2Fhj7a0anfaI8TNvH1GVpOsVc%3D)

UserCaseï¼š éå¸¸é€‚åˆéœ€è¦å¤„ç†å¶å°”å‡ºç°çš„æµé‡é«˜å³°ï¼ŒåŒæ—¶æ‰§è¡Œæ€»ä½“é™åˆ¶ï¼ˆå¦‚ç™»å½•å°è¯•æˆ–æœç´¢æŸ¥è¯¢ï¼‰çš„åº”ç”¨ç¨‹åºæ¥å£ã€‚

egï¼š æŸç”µå­å•†åŠ¡ç½‘ç«™åœ¨ç»“è´¦æ—¶å…è®¸æ¯ç§’æœ€å¤š 20 ä¸ªè¯·æ±‚çš„çªå‘æµé‡ï¼Œä½†å°†æ€»ä½“æµé‡é™åˆ¶åœ¨æ¯åˆ†é’Ÿ 100 ä¸ªè¯·æ±‚ï¼ˆr= 1.6, b=20ï¼‰ã€‚

Drawbackï¼š éœ€è¦å›ºå®šé€Ÿç‡è¡¥å……ä»¤ç‰Œï¼ŒæŠ€æœ¯ä¸Šæœ‰ç‚¹å¤æ‚ã€‚

ä»¤ç‰Œæ¡¶é€šè¿‡ç¨³å®šçš„æŠ•æ”¾ä»¤ç‰Œï¼Œä¹Ÿå°è¯•ç»´æŒäº†æ’å®šçš„qpsè¯­ä¹‰ï¼Œä¸¥æ ¼ä¸Šè®²ä»–ç»´æŒæ’å®šçš„qpsä¸æ˜¯ä¾é ç¨³å®šçš„æŠ•æ”¾ä»¤ç‰Œï¼Œ è€Œæ˜¯æ¶ˆè€—ä»¤ç‰Œã€‚

æ¶ˆè€—ä»¤ç‰Œçš„é€Ÿç‡æŸäº›æ—¶åˆ»å¯èƒ½å°±ä¸æ˜¯æ’å®šçš„ï¼šåœ¨çªå‘å¤§æµé‡æ—¶ï¼Œæ¡¶ä¸­æš‚å­˜çš„ä»¤ç‰Œå¯ä»¥è¿…é€Ÿç»™åˆ°è¯·æ±‚ç”¨(è¿™ä¸€ç¬é—´çªç ´qpsè¯­ä¹‰)ï¼Œè€Œä¸ç”¨åƒæ¼æ¡¶ä¸€æ ·æ’é˜Ÿç­‰å¾…è¢«å¤„ç†ï¼ˆå› æµé‡æ¼æ°´å¡‘å½¢ï¼‰ã€‚

### æ¼æ¡¶ç®—æ³•å’Œä»¤ç‰Œæ¡¶çš„åŒºåˆ«

æ¼æ¡¶ç®—æ³•èšç„¦äºâ€æµé‡å¡‘å½¢â€œï¼Œæœ‰ä¸€å®šé‡çš„çªå‘æµé‡å¯¹åº”èƒ½åŠ›ï¼Œä½†ä¸å¤šï¼›

ä»¤ç‰Œæ¡¶ç®—æ³• å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¼šäº§ç”Ÿâ€æµé‡å¡‘å½¢â€œçš„æ•ˆæœï¼Œèƒ½åº”å¯¹çªå‘å¤§æµé‡ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š  
å®¹é‡å‡ä¸º20çš„æ¼æ¡¶å’Œä»¤ç‰Œæ¡¶ï¼Œ åˆ†åˆ«ä»¥10/sçš„é€Ÿç‡æ¼æ°´ã€æŠ•æ”¾ä»¤ç‰Œã€‚

æ—¥å¸¸æµé‡æ°å¥½ç¨³å®šæ˜¯10/sï¼ŒæŸç¬é—´çªå‘æµé‡ï¼š æ¥äº†100ä¸ªè¯·æ±‚ã€‚

è¯·æ±‚è¿…é€Ÿå †æ»¡æ¼æ¡¶ï¼šå80ä¸ªè¯·æ±‚è¢«æ‹’ç»ï¼Œå‰20ä¸ªè¯·æ±‚è¢«å¤„ç†ï¼ˆç¬¬ä¸€ä¸ªè¯·æ±‚è¿…é€Ÿè¢«å¤„ç†ï¼Œç¬¬20ä¸ªåœ¨ç¬¬2sæœ«è¢«å¤„ç†å®Œï¼Œbeacuseæ¼æ°´å¡‘å½¢ï¼‰ã€‚

è€Œä»¤ç‰Œæ¡¶åœ¨è¿™ä¸€ç¬é—´ï¼Œå› ä¸ºæ¡¶ä¸­æœ‰æš‚å­˜ä»¤ç‰Œï¼Œ å¯è¿…é€Ÿç»™åˆ°è¯·æ±‚ä½¿ç”¨ï¼Œåœ¨è¿™ä¸€ç¬é—´èƒ½çªç ´10/s  
çš„qpsï¼ˆç¬¬1sæ”¾è¡Œ30ä¸ªè¯·æ±‚ï¼Œç¬¬2sä¾é ä»¤ç‰Œæ”¾è¡Œ10ä¸ªè¯·æ±‚ï¼Œåªè¦è¯·æ±‚ä¸è‡ªå·±å–æ¶ˆï¼Œè¿™çªå‘çš„æµé‡æœ€åéƒ½ä¼šè¢«æ¶ˆåŒ–æ‰ï¼‰ï¼Œ å› æ­¤ä»¤ç‰Œæ¡¶æ‰æˆä¸ºäº’è”ç½‘çªå‘æµé‡çš„ä¼˜è´¨é™é€Ÿç®—æ³•ã€‚

* * *

2\. ä»Šæ—¥å¿«é—ªï¼šåŸºäºginæ¡†æ¶çš„åŸç”Ÿapié™é€Ÿå™¨
-------------------------

golangå†…ç½®äº†ä¸€æ¬¾é™é€Ÿå™¨[golang/x/time/rate](https://github.com/golang/time/blob/master/rate/rate.go "golang/x/time/rate"), åŸºäº**ä»¤ç‰Œæ¡¶é™é€Ÿç®—æ³•**ã€‚

> ç»´åŸºç™¾ç§‘[ä»¤ç‰Œæ¡¶é™é€Ÿå™¨](https://en.wikipedia.org/wiki/Token_bucket "ä»¤ç‰Œæ¡¶é™é€Ÿå™¨")  
> Think in this way, someone put 1 candy per second(r) in your bucket, then you can eat only 1 candy per sec. If your bucket can hold 10(b) candies and if you haven't eaten any of them for a while, your bucket will be full then you can eat 10 candies as fast as you can eat at a time.

å°†è¯¥é™é€Ÿå™¨åº”ç”¨åˆ°ginæ¡†æ¶ä¸Šï¼š

    package main
    
    import (
    
        "github.com/gin-gonic/gin"
    
        "golang.org/x/time/rate"
    )
    
    func RateLimiter() gin.HandlerFunc {
        limiter := rate.NewLimiter(10, 30)
        return func(c *gin.Context) {
    
            if limiter.Allow() {
                c.Next()
            } else {
                c.JSON(http.StatusTooManyRequests, gin.H{
                    "message": "Limite exceed",
                })
            }
    
        }
    
    

`func NewLimiter(r Limit, b int) *Limiter` é™é€Ÿå™¨æ§åˆ¶äº‹ä»¶å‘ç”Ÿçš„é¢‘ç‡ã€‚  
å®ƒå®ç°äº†ä¸€ä¸ªå¤§å°ä¸º `b` çš„ â€œä»¤ç‰Œæ¡¶â€ï¼Œæœ€åˆæ˜¯æ»¡çš„ï¼Œå¹¶ä»¥æ¯ç§’ `r` ä¸ªä»¤ç‰Œçš„é€Ÿåº¦é‡æ–°è£…æ»¡ã€‚Limiterå¯¹å¤šä¸ªgoroutineåŒæ—¶ä½¿ç”¨æ˜¯å®‰å…¨çš„ã€‚

Limiterä¸»è¦æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œ`Allow`ã€`Reserve`ã€`Wait`,å¤§å¤šæ•°æ—¶å€™å¼€å‘è€…åº”è¯¥ä½¿ç”¨`Wait`ã€‚

è¿™ä¸‰ç§æ–¹æ³•éƒ½æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œ,å½“æ²¡æœ‰å¯ç”¨ä»¤ç‰Œæ—¶ï¼Œå®ƒä»¬çš„è¡Œä¸ºæœ‰æ‰€ä¸åŒã€‚

*   å¦‚æœæ²¡æœ‰å¯ç”¨çš„ä»¤ç‰Œï¼ŒAllow å°†è¿”å› falseã€‚
*   å¦‚æœæ²¡æœ‰å¯ç”¨çš„ä»¤ç‰Œï¼ŒReserve å°†è¿”å›æœªæ¥ä»¤ç‰Œçš„é¢„ç•™ä»¥åŠè°ƒç”¨è€…åœ¨ä½¿ç”¨å®ƒä¹‹å‰å¿…é¡»ç­‰å¾…çš„æ—¶é—´ã€‚
*   å¦‚æœæ²¡æœ‰å¯ç”¨çš„ä»¤ç‰Œï¼Œåˆ™ Wait ä¼šé˜»å¡ï¼Œç›´åˆ°å¯ä»¥è·å¾—ä»¤ç‰Œæˆ–å…¶å…³è”çš„ context.Context è¢«å–æ¶ˆã€‚

æ–¹æ³•AllowNã€ReserveN å’ŒWaitN æ¶ˆè€—n ä¸ªä»¤ç‰Œã€‚

### 2.1 ä½¿ç”¨[httpåŸºå‡†æµ‹è¯•å·¥å…·wrk](https://github.com/wg/wrk "httpåŸºå‡†æµ‹è¯•å·¥å…·wrk")å‹æµ‹

`wrk -t12 -c400 -d30s http://localhost:8080/themes/2`  
è¿è¡ŒåŸºå‡†æµ‹è¯• 30 ç§’ï¼Œä½¿ç”¨ 12 ä¸ªçº¿ç¨‹ï¼Œå¹¶ä¿æŒ 400 ä¸ª HTTP è¿æ¥æ‰“å¼€ã€‚

â‘  ä¸åŠ é™é€Ÿä¸­é—´ä»¶ï¼š

![](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/16020849966a45d98bc8389e4023530b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=Zja5ea0BUhwgKll1YJXeDmJXpC0%3D)  
åœ¨æ­¤å‹åŠ›ä¸‹ï¼Œå®è§‚çš„qpsï¼š250

â‘¡ å°†`RateLimiter`åº”ç”¨åˆ°å¯èƒ½è¢«åˆ·å•çš„API

r.GET("/themes/:id", RateLimiter(), func(c \*gin.Context) {  
......  
})

![](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/bc30c0a297e043c0b6e8fe2e80ccd87b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oCB5bqm55qE5LiL562J6ams:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ4MjU2NDc2NzI3NjYyIn0%3D&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1762761914&x-orig-sign=ZbjBPkxp6hUhXhgzMlc%2BS5FUceI%3D)

åœ¨r=10ï¼Œ b=30çš„ä»¤ç‰Œæ¡¶è®¾å®šä¸‹ï¼Œå¤§éƒ¨åˆ†è¯·æ±‚éƒ½è¢«è¿…é€Ÿæ‹’ç»äº†ï¼Œæ˜¾å¾—qpså¾ˆå¤§ã€‚

* * *

æœ€åä»‹ç»ä¸€ä¸ªä¼ä¸šçº§çš„[ulule/limiteré™é€Ÿå™¨](https://github.com/ulule/limiter/ "ulule/limiter")

*   Simple API
*   "Store" approach for backend
*   Redis support (but not tied too)
*   Middlewares: HTTP, FastHTTP and Gin

* * *

å°å°å¤–åŒ…ä»”ï¼Œ æ‹œæ‰˜ä¸€é”®ä¸‰è¿å“¦ã€‚ğŸ˜ğŸ˜ğŸ˜

* * *

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š{æœ‰æ€åº¦çš„é©¬ç”²}ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/JulianHuang/p/19187487](https://www.cnblogs.com/JulianHuang/p/19187487)

**æ¬¢è¿å…³æ³¨æˆ‘çš„åŸåˆ›æŠ€æœ¯ã€èŒåœºå…¬ä¼—å·ï¼Œ åŠ å¥½å‹è°ˆå¤©è¯´åœ°ï¼Œä¸€èµ·è¿›åŒ–**

![](https://blog-static.cnblogs.com/files/JulianHuang/QR.gif)