---
layout: post
title: 'é€šè¿‡ frp å®ç°å®‰å…¨è®¿é—®å®¶ä¸­ macOS çš„ SSH æœåŠ¡'
date: "2025-11-16T00:45:29Z"
---
é€šè¿‡ frp å®ç°å®‰å…¨è®¿é—®å®¶ä¸­ macOS çš„ SSH æœåŠ¡
==============================

æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ frp å·¥å…·ï¼Œé€šè¿‡ä¸€å°å…¬ç½‘ VPS å®‰å…¨ç©¿é€å†…ç½‘ï¼Œå®ç°ä»å¤–ç½‘ SSH è®¿é—®å®¶ä¸­ macOS è®¾å¤‡ï¼Œå¹¶åŒ…å«å¼‚å¸¸æ’æŸ¥ä¸ macOS å®¢æˆ·ç«¯è‡ªå¯åŠ¨é…ç½®æ–¹æ¡ˆã€‚

> ä½œè€…ä¹‹å‰æ²¡æŠ˜è…¾è¿‡frp, å€ŸåŠ©AIèŠ±äº†ä¸€ä¸‹åˆæ­å»ºå¥½äº†, åœ¨æ­¤è®°å½•ä¸‹å…³é”®ä¿¡æ¯ ^0^

1\. éœ€æ±‚åœºæ™¯
--------

æˆ‘æ‹¥æœ‰ä¸¤å°ç”µè„‘ï¼ˆA å’Œ Bï¼‰ï¼Œå‡è¿æ¥å®¶ä¸­åŒä¸€ Wi-Fi çƒ­ç‚¹ï¼Œå¯é€šè¿‡ **IPv6 åœ°å€ + SSH** äº’ç›¸è®¿é—®ã€‚ä½†å½“ç”¨æˆ·ç¦»å¼€å±€åŸŸç½‘åï¼Œ**æ— æ³•ä»å¤–ç½‘è¿æ¥å®¶ä¸­çš„ macOSï¼ˆç”µè„‘ Bï¼‰**ï¼Œæç¤º `Connection timed out`ã€‚

### æ ¸å¿ƒé—®é¢˜åˆ†æï¼š

*   å®¶ä¸­ macOS ä½¿ç”¨çš„æ˜¯ **æœ¬åœ°é“¾è·¯ IPv6 åœ°å€ï¼ˆå¦‚ `fe80::...`ï¼‰æˆ–å”¯ä¸€æœ¬åœ°åœ°å€ï¼ˆULAï¼Œå¦‚ `fdxx::...`ï¼‰**ï¼Œè¿™ç±»åœ°å€ **ä»…é™å±€åŸŸç½‘å†…é€šä¿¡**ï¼Œæ— æ³•è¢«å…¬ç½‘è·¯ç”±ã€‚
*   å³ä½¿ ISP åˆ†é…äº†å…¬ç½‘ IPv6 å‰ç¼€ï¼Œ**å®¶åº­è·¯ç”±å™¨é€šå¸¸é»˜è®¤é˜»æ­¢å¤–ç½‘ä¸»åŠ¨å…¥ç«™è¿æ¥**ï¼ˆå®‰å…¨ç­–ç•¥ï¼‰ã€‚
*   ç”¨æˆ·æ— å…¬ç½‘ IPv4ï¼Œä¸”ä¸å¸Œæœ›/æ— æ³•ä¿®æ”¹è·¯ç”±å™¨ç«¯å£è½¬å‘è§„åˆ™ã€‚

> âœ… **ç›®æ ‡**ï¼šå®ç° **ä»ä»»æ„å¤–ç½‘ä½ç½®ï¼Œå®‰å…¨ã€ç¨³å®šåœ° SSH ç™»å½•å®¶ä¸­çš„ macOS è®¾å¤‡**ã€‚

* * *

2\. è§£å†³æ€è·¯ä¸é€‰å‹
-----------

### å¯é€‰æ–¹æ¡ˆå¯¹æ¯”ï¼š

æ–¹æ¡ˆ

ä¼˜ç‚¹

ç¼ºç‚¹

é€‚ç”¨æ€§

**å…¬ç½‘ IPv6 + å¼€æ”¾é˜²ç«å¢™**

ç›´è¿ï¼Œå»¶è¿Ÿä½

éœ€è·¯ç”±å™¨æ”¯æŒ IPv6 ç«¯å£æ§åˆ¶ï¼Œå®‰å…¨é£é™©é«˜

ä½ï¼ˆå®¶ç”¨è·¯ç”±å™¨æ”¯æŒå·®ï¼‰

**SSH åå‘éš§é“**

æ— éœ€é¢å¤–å·¥å…·

éœ€å…¬ç½‘æœåŠ¡å™¨ï¼Œé…ç½®è¾ƒç¹ç

ä¸­

**Tailscale / ZeroTier**

é›¶é…ç½®ã€åŠ å¯†

ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œè‡ªå»ºå¤æ‚

ä¸­é«˜

**frpï¼ˆFast Reverse Proxyï¼‰**

å¼€æºã€è½»é‡ã€è·¨å¹³å°ã€æ”¯æŒ TCP/UDPã€é…ç½®çµæ´»

éœ€ä¸€å°å…¬ç½‘æœåŠ¡å™¨ï¼ˆVPSï¼‰

âœ… **æ¨è**

### æœ€ç»ˆé€‰å‹ï¼š**frp**

*   **åŸç†**ï¼šå®¢æˆ·ç«¯ï¼ˆfrpcï¼‰ä¸»åŠ¨è¿æ¥å…¬ç½‘æœåŠ¡å™¨ï¼ˆfrpsï¼‰ï¼Œå»ºç«‹åå‘ä»£ç†éš§é“ã€‚
*   **ä¼˜åŠ¿**ï¼š
    *   æ— éœ€å…¬ç½‘ IPï¼Œä»…éœ€ä¸€å° VPSï¼ˆå¯ä½è‡³ $3/æœˆï¼‰ã€‚
    *   æ”¯æŒ macOSï¼ˆIntel / Apple Siliconï¼‰ã€‚
    *   é…ç½®ç®€å•ï¼Œæ”¯æŒ Token è®¤è¯ï¼Œå®‰å…¨æ€§é«˜ã€‚
    *   å¯ä»£ç†ä»»æ„ TCP/UDP æœåŠ¡ï¼ˆSSHã€Webã€RDP ç­‰ï¼‰ã€‚

* * *

3\. frp è§£å†³æ­¥éª¤
------------

> **ç¯å¢ƒ**ï¼š
> 
> *   å…¬ç½‘æœåŠ¡å™¨ï¼ˆVPSï¼‰ï¼šUbuntu 22.04ï¼Œå…¬ç½‘ IP `203.0.113.10` (ä¸¾ä¾‹)
> *   å®¢æˆ·ç«¯ï¼ˆMacï¼‰ï¼šmacOS Sonomaï¼ŒApple Siliconï¼ˆM1/M2/M3ï¼‰

### æ­¥éª¤ 1ï¼šåœ¨ VPS ä¸Šéƒ¨ç½² frpsï¼ˆæœåŠ¡ç«¯ï¼‰

    # ä¸‹è½½ frpï¼ˆLinux 64 ä½ï¼‰
    wget https://github.com/fatedier/frp/releases/download/v0.65.0/frp_0.65.0_linux_amd64.tar.gz
    tar -zxvf frp_0.65.0_linux_amd64.tar.gz
    cd frp_0.65.0_linux_amd64
    

åˆ›å»ºé…ç½®æ–‡ä»¶ `frps.toml`ï¼ˆ**TOML æ ¼å¼ï¼Œv0.50+**ï¼‰ï¼š

    [common]
    bind_port = 7000
    token = "your_strong_secret_token_32_chars"
    

å¯åŠ¨æœåŠ¡ï¼š

    ./frps -c ./frps.toml
    

> ğŸ”’ **é˜²ç«å¢™**ï¼šå¼€æ”¾ `7000`ï¼ˆfrp æ§åˆ¶ï¼‰å’Œ `6000`ï¼ˆSSH éš§é“ï¼‰ç«¯å£ã€‚

* * *

### æ­¥éª¤ 2ï¼šåœ¨ macOS ä¸Šéƒ¨ç½² frpcï¼ˆå®¢æˆ·ç«¯ï¼‰

#### 2.1 ä¸‹è½½ frpï¼ˆApple Silicon ç¤ºä¾‹ï¼‰

    mkdir -p ~/frp && cd ~/frp
    curl -LO https://github.com/fatedier/frp/releases/download/v0.65.0/frp_0.65.0_darwin_arm64.tar.gz
    tar -zxvf frp_0.65.0_darwin_arm64.tar.gz
    

> ğŸ” Intel Mac ç”¨æˆ·è¯·ä¸‹è½½ `darwin_amd64` ç‰ˆæœ¬ã€‚

#### 2.2 é…ç½® `frpc.toml`

    [common]
    server_addr = "203.0.113.10"      # VPS å…¬ç½‘ IP
    server_port = 7000
    token = "your_strong_secret_token_32_chars"
    
    [ssh]
    type = tcp
    local_ip = "127.0.0.1"
    local_port = 22        # macOS SSH ç«¯å£
    remote_port = 6000     # VPS å¯¹å¤–æš´éœ²ç«¯å£
    

#### 2.3 å¼€å¯ macOS SSH æœåŠ¡

*   **ç³»ç»Ÿè®¾ç½® > é€šç”¨ > å…±äº« > å‹¾é€‰â€œè¿œç¨‹ç™»å½•â€**
*   ç¡®è®¤å½“å‰ç”¨æˆ·åœ¨å…è®¸åˆ—è¡¨ä¸­

#### 2.4 å¯åŠ¨ frpcï¼ˆä¸´æ—¶æµ‹è¯•ï¼‰

    cd ~/frp/frp_0.65.0_darwin_arm64
    ./frpc -c ~/frp/frpc.toml
    

çœ‹åˆ° `start proxy success` å³è¡¨ç¤ºéš§é“å»ºç«‹æˆåŠŸã€‚

* * *

### æ­¥éª¤ 3ï¼šå¤–ç½‘è®¿é—®éªŒè¯

ä»ä»»æ„å¤–ç½‘è®¾å¤‡æ‰§è¡Œï¼š

    ssh -p 6000 ä½ çš„Macç”¨æˆ·å@203.0.113.10
    

> âœ… æˆåŠŸç™»å½•å³è¡¨ç¤ºæ•´ä¸ªé“¾è·¯æ‰“é€šã€‚

* * *

4\. å¼‚å¸¸å¤„ç†
--------

### å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆï¼š

é—®é¢˜ç°è±¡

æ ¹æœ¬åŸå› 

è§£å†³æ–¹æ³•

`json: unknown field "token"`

frp ç‰ˆæœ¬ < v0.50ï¼Œä½†ç”¨äº† `token` å­—æ®µ

å‡çº§åˆ° v0.50+ï¼Œä½¿ç”¨ `.toml` æ ¼å¼ï¼›æˆ–æ—§ç‰ˆæ”¹ç”¨ `privilege_token`

`Connection refused`ï¼ˆå¤–ç½‘ï¼‰

1\. macOS SSH æœªå¼€å¯  
2\. frpc è¿›ç¨‹é€€å‡º  
3\. VPS é˜²ç«å¢™æœªå¼€æ”¾ `remote_port`

1\. æ£€æŸ¥â€œè¿œç¨‹ç™»å½•â€  
2\. åå°è¿è¡Œ frpc  
3\. å¼€æ”¾å®‰å…¨ç»„/ufw

`telnet 127.0.0.1 6000` å¤±è´¥ï¼ˆåœ¨ VPS ä¸Šï¼‰

frpc æœªè¿è¡Œæˆ–é…ç½®é”™è¯¯

æ£€æŸ¥ frpc æ—¥å¿—ï¼Œç¡®è®¤ `local_port=22`

`work connection closed`

ç½‘ç»œä¸ç¨³å®šå¯¼è‡´æ–­è¿

å¯ç”¨ `KeepAlive`ï¼ˆè§è‡ªå¯åŠ¨é…ç½®ï¼‰

### å…³é”®è¯Šæ–­å‘½ä»¤ï¼š

    # åœ¨ Mac ä¸Šæµ‹è¯•æœ¬åœ° SSH
    ssh localhost
    
    # åœ¨ VPS ä¸Šæµ‹è¯•éš§é“
    telnet 127.0.0.1 6000
    
    # åœ¨å¤–ç½‘æµ‹è¯•ç«¯å£è¿é€šæ€§
    telnet 203.0.113.10 6000
    

* * *

5\. client ç«¯ï¼ˆmacOSï¼‰frpc è‡ªå¯åŠ¨æ•™ç¨‹
-----------------------------

ä¸ºç¡®ä¿ frpc **å¼€æœºè‡ªå¯ã€å´©æºƒé‡å¯ã€åå°è¿è¡Œ**ï¼Œä½¿ç”¨ macOS åŸç”Ÿ `launchd` æœåŠ¡ã€‚

### æ­¥éª¤ 1ï¼šåˆ›å»º `plist` æ–‡ä»¶

    mkdir -p ~/Library/LaunchAgents
    nano ~/Library/LaunchAgents/com.user.frpc.plist
    

ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼ˆ**æ›¿æ¢ `ä½ çš„ç”¨æˆ·å` ä¸ºå®é™…è·¯å¾„**ï¼‰ï¼š

    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>Label</key>
        <string>com.user.frpc</string>
        <key>ProgramArguments</key>
        <array>
            <string>/Users/ä½ çš„ç”¨æˆ·å/frp/frp_0.65.0_darwin_arm64/frpc</string>
            <string>-c</string>
            <string>/Users/ä½ çš„ç”¨æˆ·å/frp/frpc.toml</string>
        </array>
        <key>WorkingDirectory</key>
        <string>/Users/ä½ çš„ç”¨æˆ·å/frp/frp_0.65.0_darwin_arm64</string>
        <key>StandardOutPath</key>
        <string>/Users/ä½ çš„ç”¨æˆ·å/frp/frpc.log</string>
        <key>StandardErrorPath</key>
        <string>/Users/ä½ çš„ç”¨æˆ·å/frp/frpc-error.log</string>
        <key>RunAtLoad</key>
        <true/>
        <key>KeepAlive</key>
        <true/>
        <key>AbandonProcessGroup</key>
        <true/>
        <key>NetworkState</key>
        <true/>
    </dict>
    </plist>
    

### æ­¥éª¤ 2ï¼šåŠ è½½å¹¶å¯åŠ¨æœåŠ¡

    # é¦–æ¬¡åŠ è½½
    launchctl load ~/Library/LaunchAgents/com.user.frpc.plist
    
    # å¯åŠ¨
    launchctl start com.user.frpc
    
    # éªŒè¯
    launchctl list | grep frpc
    

### æ­¥éª¤ 3ï¼šéªŒè¯è‡ªå¯åŠ¨

*   é‡å¯ Mac
*   ç™»å½•åæ‰§è¡Œ `ps aux | grep frpc`
*   æŸ¥çœ‹æ—¥å¿—ï¼š`tail -f ~/frp/frpc.log`

> âœ… æ­£å¸¸åº”çœ‹åˆ° `login to server success` å’Œ `start proxy success`ã€‚

### ç®¡ç†å‘½ä»¤ï¼š

    # é‡å¯
    launchctl stop com.user.frpc && launchctl start com.user.frpc
    
    # å¸è½½
    launchctl unload ~/Library/LaunchAgents/com.user.frpc.plist
    

* * *

âœ… æ€»ç»“
----

é€šè¿‡ **frp + VPS + launchd** ç»„åˆï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

*   **å®‰å…¨**ï¼šToken è®¤è¯ + SSH å¯†é’¥ç™»å½•
*   **ç¨³å®š**ï¼šå´©æºƒè‡ªåŠ¨é‡å¯ï¼Œå¼€æœºè‡ªå¯
*   **é€šç”¨**ï¼šé€‚ç”¨äºä»»ä½•å†…ç½‘ TCP/UDP æœåŠ¡ç©¿é€
*   **ä½æˆæœ¬**ï¼šä»…éœ€ä¸€å°ä½é… VPS

> ğŸ’¡ **åç»­æ‰©å±•**ï¼šå¯å¢åŠ  Web æœåŠ¡ã€VNCã€Home Assistant ç­‰ä»£ç†ï¼Œåªéœ€åœ¨ `frpc.toml` ä¸­æ·»åŠ æ–° proxy å³å¯ã€‚

å‚è€ƒ:  
frpå®˜æ–¹æŒ‡å¼•: [https://gofrp.org/zh-cn/docs/overview/](https://gofrp.org/zh-cn/docs/overview/)  
QWEN3: [https://chat.qwen.ai/](https://chat.qwen.ai/)