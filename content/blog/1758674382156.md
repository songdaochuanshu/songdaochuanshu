---
layout: post
title: '扣子Coze智能体实战：自动采集1000条小红书爆款笔记 ，自动写入飞书多维表格'
date: "2025-09-24T00:39:42Z"
---
扣子Coze智能体实战：自动采集1000条小红书爆款笔记 ，自动写入飞书多维表格
========================================

大家好，我是汤师爷，专注AI智能体分享，致力于帮助100W人用智能体创富~

想要抓取小红书热门笔记，但一个个复制太耗时？

需要批量获取热门笔记数据，进行分析，却苦于没有高效的工具？

今天，我将为大家介绍一个超强的解决方案，利用Coze工作流，只需5个步骤，就能一键批量抓取小红书热门关键词的笔记，并**自动写入飞书多维表格**！

这套方案对于想要批量学习优质内容的创作者来说，绝对是个效率神器。

我们先看下工作流的执行效果：

1.整体工作流
-------

1.跟进关键词获取小红书笔记

2.循环获取笔记详情

*   获取笔记详情
*   提取视频文案
*   将笔记数据整理成飞书多维表格格式
*   写入飞书多维表格

2.详细工作流节点
---------

### 2.1 开始节点

开始节点有3个输入变量。

*   输入：
    *   foldUrl：飞书多维表格链接
    *   cookie：小红书cookie
    *   keywords：关键词

### 2.2 如何获取小红书cookie？

**1.登陆[https://www.xiaohongshu.com/](https://www.xiaohongshu.com/)**

**2.在页面空白处右击鼠标，选择「检查」**

**3.在刚刚打开的面板中，点击「网络」选项卡**

**4.刷新当前页面**

**5.点击第一条记录，在右侧「标头」部分向下滚动，找到cookie一行，将其内容复制下，这就是我们需要的cookieStr**

### 2.3 获取博主所有小红书笔记

我们将使用【小红书】插件的xhs\_search\_notes功能。

通过这个功能，我们可以一键批量抓取热门关键词的笔记。

*   输入：
    *   cookieStr：开始 - cookie
    *   keywords：开始 - keywords
    *   noteType：1=视频
    *   sort：2=最热
    *   totalNumber：查询总数

### 2.4 批量获取笔记详情

**1.使用循环节点，批量批量获取笔记详情**

**2.获取单个笔记详情**

我们将使用【小红书】插件的xhs\_note\_detail功能。

通过这个功能，我们可以根据笔记链接获取笔记详情。

*   输入：
    *   cookieStr：开始 - cookie
    *   noteUrl：循环获取笔记详情-note\_url

### 2.4 使用「**字幕获取**」插件，提取视频文案

*   输入：
    *   url：获取笔记详情-video\_h264\_url

### 2.5 使用代码节点：将笔记数据整理成飞书多维表格格式

在这一步，我们会使用代码节点，将笔记数据整理成飞书多维表格格式。

*   输入：
    *   input：获取笔记详情-note
    *   data：提取视频文案-content

**Python代码如下：**

    async def main(args: Args) -> Output:
        input_data = args.params.get('input', {})  # 获取传入的 input 对象，如果不存在则返回空字典
        data = args.params.get('data', '')  # 直接从 args.params 中提取 data 参数
    
        records = []  # 初始化 records 列表
    
        # 提取 note 相关字段
        title = input_data.get('note_display_title', '')  # 标题
        desc = input_data.get('note_desc', '')  # 描述
        url = input_data.get('note_url', '')  # 链接
        nickname = input_data.get('auther_nick_name', '')  # 作者昵称
        likedCount = input_data.get('note_liked_count', '0')  # 点赞数
        videoUrl = input_data.get('video_h264_url', '')  # 视频地址
        collectedCount = input_data.get('collected_count', '0')  # 收藏数
        imageList = input_data.get('note_image_list', [])  # 图片列表
    
        # 构建记录对象
        record = {
            "fields": {
                "笔记链接": url,
                "标题": title,
                "内容": desc,
                "作者": nickname,
                "点赞数": likedCount,
                "链接": {
                    "link": url,
                    "text": title
                },
                "收藏数": collectedCount,
                "图片地址": '\n'.join(imageList),  # 将图片列表拼接成字符串
                "视频地址": videoUrl,
                "视频文案": data  # 将 data 放入 fields 中，定义为 "视频文案"
            }
        }
        records.append(record)  # 将记录对象添加到 records 列表中
    
        # 构建输出对象
        ret: Output = {
            "records": records
        }
        return ret
    

### 2.6 使用飞书多维表格节点：将笔记数据写入飞书多维表格

*   输入：
    *   app\_token：开始-foldUrl
    *   records：将笔记数据整理成飞书多维表格格式-records

### 2.7 结束节点

通过这套工作流，你可以轻松实现关键词笔记的批量抓取，并写入**飞书多维表格。**

整个过程只需简单配置，就能自动化完成繁琐的数据采集工作，为你节省大量时间。

> 本文已收录于，我的技术博客：[tangshiye.cn](https://tangshiye.cn) 里面有，AI 学习资料，Coze 智能体教程，算法 Leetcode 详解，BAT 面试真题，架构设计，等干货分享。

本文来自博客园，作者：[AI架构师汤师爷](https://www.cnblogs.com/tangshiye/)，转载请注明原文链接：[https://www.cnblogs.com/tangshiye/p/19107318](https://www.cnblogs.com/tangshiye/p/19107318)