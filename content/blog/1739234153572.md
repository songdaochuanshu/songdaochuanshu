---
layout: post
title: 'PC端自动化测试实战教程-1-pywinauto 环境搭建（详细教程）'
date: "2025-02-11T00:35:53Z"
---
PC端自动化测试实战教程-1-pywinauto 环境搭建（详细教程）
===================================

### 1.简介

之前总有人在群里或者私信留言问：Windows系统安装的软件如何自动化测试呢？因为没有接触过或者遇到过，所以说实话宏哥当时也不清楚怎么实现，怎么测试。然而在一次偶然的机会接触到了Python的一个模块说是它可以实现Microsoft Windows GUI自动化测试，宏哥就想试一下是不是可以实现了，于是就边学习边记录供小伙伴或者童鞋们学习参考。

目前流行的自动化就是web，app，接口算是目前最主流的测试内容了，那么如果让做安装windows上的客户端自动化呢？是不是一脸懵？今天宏哥就给大家讲解和分享一下啊！！！

### 2.pywinauto 

pywinauto 是一个用于 Windows [GUI](https://so.csdn.net/so/search?q=GUI&spm=1001.2101.3001.7020) 自动化的 [Python 库](https://so.csdn.net/so/search?q=Python%20%E5%BA%93&spm=1001.2101.3001.7020)。它允许你编写脚本来自动化 Windows 应用程序的操作，如点击按钮、输入文本、选择菜单项等。pywinauto 基于 pywin32 和 comtypes，提供了更高级和更易用的接口。

官网地址：https://pywinauto.readthedocs.io/en/latest/index.html

中文文档地址：https://www.kancloud.cn/gnefnuy/pywinauto\_doc/1193035

### 3.环境准备

#### 3.1操作系统

1.宏哥的环境是Windows 11版本 64位系统（32位的同学自己想办法哦，当然了现在32位的一般很少见），如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106135053305-542702628.png)

#### 3.2Python版本

Python版本：python:3.7.2，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106135154695-219450372.png)

### 4.环境搭建

Pywinauto是一个强大的Python库，用于自动化Windows应用程序的界面操作。无论是进行GUI测试、[数据采集](https://cloud.tencent.com/solution/data-collect-and-label-service?from_column=20065&from=20065)还是自动化任务，Pywinauto都能提供便捷的解决方案。

#### 4.1安装Python

首先我们要安装好Python，然后才能安装Pywinauto，原因就不用宏哥多说了吧！因为Pywinauto是Python的库，所有得现有父亲才有儿子。具体如何安装Python，宏哥在这里就不再赘述了，不会的小伙伴或者童鞋们可以看宏哥之前的文章：[传送门](https://www.cnblogs.com/du-hong/p/8330595.html) 。

#### 4.2安装Pywinauto

##### 4.2.1方法一（推荐）

 1.和安装其他依赖库一样，直接使用命令安装即可。可能要稍等一会....只需要一条命令，命令如下：

pip install pywinauto 

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106151826121-1884022976.png)

##### 4.2.2方法二（推荐）

1.确保你已经成功安装Python和Pycharm编辑器，点击"File" -> "Settings" -> "Project" -> "Python Interpreter"在"Project lnterpreter"下，点击"Add"并在搜索栏中输入要导入的模块名称搜索pywinauto，然后点击“install”即可，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106150705443-763926655.gif)

##### 4.2.3方法三（不推荐）

在网站：https://github.com/pywinauto/pywinauto/releases 中下载最新的pywinauto，解压后，进入对应的目录中，cmd，然后运行命令如下：

python setup.py install

#### 4.3验证是否安装成功Pywinauto

##### 4.3.1导入对应库

1.Docs命令窗口

直接打开docs命令窗口输入python，进行导入对应的库，看是否报错，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106151922915-2098706647.png)

2.Pycharm编辑器

打开Pycharm编辑器，在Python脚本中导入Pywinauto的必要模块，通常包括`Application`和`findwindows，看是否报错，如下图所示：`

安装前（红色报错），如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106145608475-381682835.png)

安装后（红色报错消失），如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106151255171-671060391.png)

##### 4.3.2通过pip查看

通过pip list命令查看，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106152027834-1266257102.png)

 到此，环境就搭建好了，是不是很简单哈，是不是so easy。其实很简单的，就是一句命令就可以了，今天说的有点多，有点啰嗦哈！！！

### 5.使用说明

安装好了之后，关于使用说明大家可以参照官方文档上的说明。

#### **5.1可访问性技术（backend）**

**就是说在我们安装好Pywinauto之后，在启动应用程序之前，首先要确定哪种可访问性技术（pywinauto的backend）可以用于我们的应用程序，在windows上受支持的辅助功能技术有两种：**

*   Win32 API (backend= “win32”) ，默认的backend, MFC、VB6、VCL、简单的 WinForms 控件和大多数旧的遗留应用程序
*   MS UI Automation (backend=”uia”) , WinForms、WPF、商店应用程序、Qt5、浏览器

那么如何知道程序到底适用于那种backend？ 可以借助于GUI对象检查工具来确定程序到底适用于那种backend。如果使用 inspect 的uia模式，可见的控件和属性更多的话，backend可选uia，反之，backend可选win32。

#### **5.2inspect 元素定位工具**

常用的一些元素定位工具： SPY++，用于WIN32 API。当SPY++可以显示所有的控件时，访问技术应该选择”win32”。 Inspect.exe：如果Inspect.exe的模式设置为UIA模式，可以比SPY++显示更多的控件，则访问技术应该选择”uia”。 py\_inspect：支持win32和uia两种访问技术，是SWAPY的替代。 UISPY：支持uia访问技术。 SWAPY：只支持win32访问技术。

1.inspect 教程：https://learn.microsoft.com/zh-cn/windows/win32/winauto/inspect-objects，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106162857035-1566400646.png)

2.inspect.exe 是windows SDK 的一个内置工具，可以通过先安装Windows SDK，下载地址：https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/ 如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106163106533-1090021227.png)

3.下载后在本机安装，Inspect.exe 位于 SDK 安装路径的 \\bin\\\\文件夹中。通常不需要以管理员身份运行它。如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106163224022-1195762374.png)

4.它可以单独复制出来，放在桌面使用。

##### 5.2.1“检查”窗口

“检查”窗口有多个主要部分：

*   标题栏。 显示“检查”窗口句柄 (HWND)。
*   菜单栏。 提供对“检查”功能的访问。
*   工具栏。 提供对“检查”功能的访问。
*   树状视图。 将 UI 元素的分层结构呈现为树视图控件，可用于在元素之间导航。
*   数据视图。 显示所选 UI 元素的所有公开辅助功能属性。

1.菜单栏中提供的命令也可以在工具栏中使用。 下图显示了“检查”查询记事本中的“编辑”菜单元素的 UI 自动化属性。如下图所示：

![Screenshot that shows the user interface of the Inspect tool.](https://learn.microsoft.com/zh-cn/windows/win32/winauto/images/inspect.png)

2.以下是宏哥操作微信时候，工具的一些展示和变化，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250108115653618-1231345361.png)

#### 5.3一些类似的工具

##### 5.3.1Python tools

*   PyAutoGui - 一个流行的跨平台库（具有基于图像的搜索，没有基于文本的控件操作）。
*   Lackey - Sikuli的纯Python替代品（基于图像模式匹配）。
*   AXUI - MS UI Automation API的一个包装器。
*   winGuiAuto - 另一个使用Win32 API的模块。

##### 5.3.2其他脚本语言工具

*   (Perl) Win32::GuiTest
*   (Ruby) Win32-Autogui - Win32 API的包装器。
*   (Ruby) RAutomation - 有3个适配器：Win32 API，UIA，AutoIt。

##### 5.3.3其他免费工具

*   (C#) Winium.Desktop - 一个年轻但很好的基于MS UI Automation的工具。
*   (C#) TestStack.White - 另一个很好的基于MS UI Automation的库，历史悠久。
*   AutoIt - 具有自己的类似Basic语言的免费工具（基于Win32 API，没有.NET计划）
*   AutoHotKey - 具有自己的脚本语言的原生C ++工具（.ahk）

##### 5.3.4商业工具

*   WinRunner (http://www.mercury.com/us/products/quality-center/functional-testing/winrunner/)
*   SilkTest (http://www.segue.com/products/functional-regressional-testing/silktest.asp)
*   Many Others (http://www.testingfaqs.org/t-gui.html)

#### 5.4gui inspect tool全家桶

1.官方文档中推荐使用spy++和inspect来检查。宏哥专门整理了一下，放在github上了，关注宏哥的公众号发送：inspect，即可获取下载地址。有的人不知道公众号如何发送获取下载地址，经常是发私信。宏哥在这里也顺便演示一下，关注宏哥公众号后，点击“发消息”，然后输入内容发送关键字，即可获取。如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250108113251846-1126119949.gif)

 2.下载解压后的各种工具，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106165134611-463629491.png)

Spy++ （定位元素工具（win32））

Inspect（定位元素工具（uia））

UI Spy （定位元素工具）

Swapy（可简单生成pywinauto代码）

#### 5.5如何判断程序的backend是’win32’还是’uia’呢？

目前大部分应用程序主窗口是“uia”，一般都是先用“uia',报错时再换成'win32'。这也是一种笨办法，二者选一，不是这个就是那个。

宏哥这里按官方推荐的介绍使用inspect来判断backend的类别，具体步骤如下：

1.下载上面github链接里的相关工具并打开，点击inspect左上角的下拉列表中切换到UI Automation，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106165349109-1769772221.png)

2.然后鼠标点一下你需要测试的程序窗体，inspect就会显示相关信息。 下图为点击window文件夹的结果，inspect中显示了相关的信息，如下图所示。说明backend为uia。如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250108114332294-1509556239.gif)

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106165824176-833645532.png)

3.相反，没有切换，点击任务管理器，拒绝访问，则为win32，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106173425873-236164185.png)

### 6.快速入门

宏哥这里以启动Windows自带的计算器为例，给各位小伙伴或者童鞋们来演示一下。

#### 6.1代码设计

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106161040670-1625255214.png)

#### 6.2参考代码

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-16
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-1-pywinauto 环境搭建（上）（详细教程）
'''

# 3.导入模块

from pywinauto import Application
from pywinauto import findwindows

#启动计算器
app = Application().start("calc.exe")

#### 6.3运行代码

1.运行代码，右键Run'Test'，就可以看到控制台输出，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106161330628-1797457348.png)

2.运行代码后电脑端的动作（启动计算器）。如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250106161318135-2071300095.gif)

### 7.小结

本文介绍了Pywinauto的基本使用方法，包括安装、导入模块、启动应用程序、如何判断程序的backend是’win32’还是’uia’。通过掌握这些基本概念和技巧，小伙伴或者童鞋们可以利用Pywinauto轻松实现自动化Windows界面操作，提高工作效率。希望本文对你入门Pywinauto有所帮助！

    为了方便大家在移动端也能看到我分享的博文，现已注册个人微信公众号，扫描左下方二维码即可，欢迎大家关注，有时间会及时分享相关技术博文。  
    为了方便大家互动讨论相关技术问题，现已组建专门的微信群，由于微信群满100，请您扫描右下方宏哥个人微信二维码拉你进群（请务必备注：已关注公众号进群）平时上班忙（和你一样），所以加好友不及时，请稍安勿躁~，欢迎大家加入这个大家庭，我们一起畅游知识的海洋。  
    感谢您花时间阅读此篇文章,如果您觉得这篇文章你学到了东西也是为了犒劳下博主的码字不易不妨打赏一下吧，让博主能喝上一杯咖啡，在此谢过了！  
    如果您觉得阅读本文对您有帮助，请点一下左下角“推荐”按钮，您的“推荐”将是我最大的写作动力！另外您也可以选择【**关注我**】，可以很方便找到我！  
    本文版权归作者和博客园共有，来源网址：[https://www.cnblogs.com/du-hong](https://www.cnblogs.com/du-hong) 欢迎各位转载，但是未经作者本人同意，转载文章之后必须在文章页面明显位置给出作者和原文连接，否则保留追究法律责任的权利！

公众号(关注宏哥)                                                                                 客服微信

![个人微信公众号](https://img2018.cnblogs.com/common/1741949/201911/1741949-20191119095948011-608816619.png) ![个人微信](https://img2018.cnblogs.com/common/1741949/201911/1741949-20191106101257091-849954564.png)