---
layout: post
title: 'å¸¸è§çš„ AI æ¨¡åž‹æ ¼å¼'
date: "2025-03-28T00:38:32Z"
---
å¸¸è§çš„ AI æ¨¡åž‹æ ¼å¼
===========

![](https://img-s2.andfun.cn/devrel/posts/2025/03/c39a030242264.png)

> **æ¥æº**ï¼š[åšå®¢é“¾æŽ¥](https://blog.ngxson.com/common-ai-model-formats)

è¿‡åŽ»ä¸¤å¹´ï¼Œå¼€æº AI ç¤¾åŒºä¸€ç›´åœ¨çƒ­çƒˆè®¨è®ºæ–° AI æ¨¡åž‹çš„å¼€å‘ã€‚æ¯å¤©éƒ½æœ‰è¶Šæ¥è¶Šå¤šçš„æ¨¡åž‹åœ¨ [Hugging Face](https://huggingface.co) ä¸Šå‘å¸ƒï¼Œå¹¶è¢«ç”¨äºŽå®žé™…åº”ç”¨ä¸­ã€‚ç„¶è€Œï¼Œå¼€å‘è€…åœ¨ä½¿ç”¨è¿™äº›æ¨¡åž‹æ—¶é¢ä¸´çš„ä¸€ä¸ªæŒ‘æˆ˜æ˜¯**æ¨¡åž‹æ ¼å¼çš„å¤šæ ·æ€§**ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æŽ¢è®¨å½“ä¸‹å¸¸è§çš„ AI æ¨¡åž‹æ ¼å¼ï¼ŒåŒ…æ‹¬ï¼š

*   **GGUF**
*   **PyTorch**
*   **Safetensors**
*   **ONNX**

æˆ‘ä»¬å°†åˆ†æžæ¯ç§æ ¼å¼çš„**ä¼˜ç¼ºç‚¹**ï¼Œå¹¶æä¾›**ä½¿ç”¨å»ºè®®**ï¼Œå¸®åŠ©ä½ é€‰æ‹©æœ€é€‚åˆçš„æ ¼å¼ã€‚

GGUF
----

GGUF æœ€åˆæ˜¯ä¸º [llama.cpp](https://github.com/ggml-org/llama.cpp) é¡¹ç›®å¼€å‘çš„ã€‚GGUF æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ—¨åœ¨å®žçŽ°å¿«é€Ÿçš„æ¨¡åž‹åŠ è½½å’Œä¿å­˜ï¼Œå¹¶æ˜“äºŽé˜…è¯»ã€‚æ¨¡åž‹é€šå¸¸ä½¿ç”¨ PyTorch æˆ–å…¶ä»–æ¡†æž¶å¼€å‘ï¼Œç„¶åŽè½¬æ¢ä¸º GGUF æ ¼å¼ä»¥ä¸Ž GGML ä¸€èµ·ä½¿ç”¨ã€‚

éšç€æ—¶é—´çš„æŽ¨ç§»ï¼ŒGGUF å·²æˆä¸ºå¼€æºç¤¾åŒºä¸­å…±äº« AI æ¨¡åž‹æœ€æµè¡Œçš„æ ¼å¼ä¹‹ä¸€ã€‚å®ƒå¾—åˆ°äº†è®¸å¤šçŸ¥åæŽ¨ç†è¿è¡Œæ—¶çš„æ”¯æŒï¼ŒåŒ…æ‹¬ [llama.cpp](https://github.com/ggml-org/llama.cpp)ã€[ollama](https://ollama.com/) å’Œ [vLLM](https://github.com/vllm-project/vllm)ã€‚

ç›®å‰ï¼ŒGGUF ä¸»è¦ç”¨äºŽè¯­è¨€æ¨¡åž‹ã€‚è™½ç„¶ä¹Ÿå¯ä»¥å°†å…¶ç”¨äºŽå…¶ä»–ç±»åž‹çš„æ¨¡åž‹ï¼Œä¾‹å¦‚é€šè¿‡ [stable-diffusion.cpp](https://github.com/leejet/stable-diffusion.cpp) å®žçŽ°çš„æ‰©æ•£æ¨¡åž‹ï¼Œä½†è¿™å¹¶ä¸åƒåœ¨è¯­è¨€æ¨¡åž‹ä¸­çš„åº”ç”¨é‚£æ ·æ™®éã€‚

GGUF æ–‡ä»¶åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

*   ä¸€ä¸ªä»¥é”®å€¼å¯¹ç»„ç»‡çš„å…ƒæ•°æ®éƒ¨åˆ†ã€‚è¯¥éƒ¨åˆ†åŒ…å«æœ‰å…³æ¨¡åž‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å…¶æž¶æž„ã€ç‰ˆæœ¬å’Œè¶…å‚æ•°ã€‚
*   ä¸€ä¸ªå¼ é‡å…ƒæ•°æ®éƒ¨åˆ†ã€‚è¯¥éƒ¨åˆ†åŒ…æ‹¬æ¨¡åž‹ä¸­å¼ é‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒä»¬çš„å½¢çŠ¶ã€æ•°æ®ç±»åž‹å’Œåç§°ã€‚
*   æœ€åŽï¼Œä¸€ä¸ªåŒ…å«å¼ é‡æ•°æ®æœ¬èº«çš„éƒ¨åˆ†ã€‚

![Diagram by @mishig25 (GGUF v3)](https://img-s2.andfun.cn/devrel/posts/2025/03/f48905b65c9ef.png)

GGUF æ ¼å¼å’Œ GGML åº“è¿˜æä¾›äº†çµæ´»çš„**é‡åŒ–æ–¹æ¡ˆ**ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒè‰¯å¥½ç²¾åº¦çš„åŒæ—¶å®žçŽ°é«˜æ•ˆçš„æ¨¡åž‹å­˜å‚¨ã€‚ä¸€äº›æœ€å¸¸è§çš„é‡åŒ–æ–¹æ¡ˆåŒ…æ‹¬ï¼š

*   `Q4_K_M`ï¼šå¤§å¤šæ•°å¼ é‡è¢«é‡åŒ–ä¸º 4 ä½ï¼Œéƒ¨åˆ†å¼ é‡è¢«é‡åŒ–ä¸º 6 ä½ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„é‡åŒ–æ–¹æ¡ˆã€‚
*   `IQ4_XS`ï¼šå‡ ä¹Žæ‰€æœ‰å¼ é‡éƒ½è¢«é‡åŒ–ä¸º 4 ä½ï¼Œä½†å€ŸåŠ©**é‡è¦æ€§çŸ©é˜µ**ã€‚è¯¥çŸ©é˜µç”¨äºŽæ ¡å‡†æ¯ä¸ªå¼ é‡çš„é‡åŒ–ï¼Œå¯èƒ½åœ¨ä¿æŒå­˜å‚¨æ•ˆçŽ‡çš„åŒæ—¶æé«˜ç²¾åº¦ã€‚
*   `IQ2_M`ï¼šç±»ä¼¼äºŽ `IQ4_XS`ï¼Œä½†ä½¿ç”¨ 2 ä½é‡åŒ–ã€‚è¿™æ˜¯æœ€æ¿€è¿›çš„é‡åŒ–æ–¹æ¡ˆï¼Œä½†åœ¨æŸäº›æ¨¡åž‹ä¸Šä»èƒ½å®žçŽ°è‰¯å¥½çš„ç²¾åº¦ã€‚å®ƒé€‚ç”¨äºŽå†…å­˜éžå¸¸æœ‰é™çš„ç¡¬ä»¶ã€‚
*   `Q8_0`ï¼šæ‰€æœ‰å¼ é‡éƒ½è¢«é‡åŒ–ä¸º 8 ä½ã€‚è¿™æ˜¯æœ€ä¸æ¿€è¿›çš„é‡åŒ–æ–¹æ¡ˆï¼Œæä¾›å‡ ä¹Žä¸ŽåŽŸå§‹æ¨¡åž‹ç›¸åŒçš„ç²¾åº¦ã€‚

![](https://img-s2.andfun.cn/devrel/posts/2025/03/968f7233b6621.png)

GGUF æ ¼å¼çš„ Llama-3.1 8B æ¨¡åž‹ç¤ºä¾‹ï¼Œé“¾æŽ¥[åœ¨æ­¤](https://huggingface.co/bartowski/Meta-Llama-3.1-8B-Instruct-GGUF/tree/main)

è®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹ GGUF çš„ä¼˜ç¼ºç‚¹ï¼š

*   **ä¼˜ç‚¹**ï¼š
    *   ç®€å•ï¼šå•æ–‡ä»¶æ ¼å¼æ˜“äºŽå…±äº«å’Œåˆ†å‘ã€‚
    *   å¿«é€Ÿï¼šé€šè¿‡ä¸Ž `mmap()` çš„å…¼å®¹æ€§å®žçŽ°æ¨¡åž‹çš„å¿«é€ŸåŠ è½½å’Œä¿å­˜ã€‚
    *   é«˜æ•ˆï¼šæä¾›çµæ´»çš„é‡åŒ–æ–¹æ¡ˆã€‚
    *   ä¾¿æºï¼šä½œä¸ºä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ— éœ€ç‰¹å®šåº“å³å¯è½»æ¾è¯»å–ã€‚
*   **ç¼ºç‚¹**ï¼š
    *   å¤§å¤šæ•°æ¨¡åž‹éœ€è¦ä»Žå…¶ä»–æ ¼å¼ï¼ˆå¦‚ PyTorchã€Safetensorsï¼‰è½¬æ¢ä¸º GGUFã€‚
    *   å¹¶éžæ‰€æœ‰æ¨¡åž‹éƒ½å¯è½¬æ¢ã€‚éƒ¨åˆ†æ¨¡åž‹ä¸å— llama.cpp æ”¯æŒã€‚
    *   æ¨¡åž‹ä¿å­˜ä¸º GGUF æ ¼å¼åŽï¼Œä¿®æ”¹æˆ–å¾®è°ƒå¹¶ä¸å®¹æ˜“ã€‚

GGUF ä¸»è¦ç”¨äºŽç”Ÿäº§çŽ¯å¢ƒä¸­çš„**æ¨¡åž‹æœåŠ¡**ï¼Œå…¶ä¸­å¿«é€ŸåŠ è½½æ—¶é—´è‡³å…³é‡è¦ã€‚å®ƒä¹Ÿç”¨äºŽå¼€æºç¤¾åŒºå†…çš„**æ¨¡åž‹å…±äº«**ï¼Œå› ä¸ºå…¶æ ¼å¼ç®€å•ï¼Œä¾¿äºŽåˆ†å‘ã€‚

**æœ‰ç”¨èµ„æºï¼š**

*   [llama.cpp](https://github.com/ggml-org/llama.cpp) é¡¹ç›®ï¼Œæä¾›äº†å°† HF æ¨¡åž‹è½¬æ¢ä¸º GGUF çš„è„šæœ¬ã€‚
*   [gguf-my-repo](https://huggingface.co/spaces/ggml-org/gguf-my-repo) ç©ºé—´å…è®¸åœ¨ä¸ä¸‹è½½åˆ°æœ¬åœ°çš„æƒ…å†µä¸‹å°†æ¨¡åž‹è½¬æ¢ä¸º GGUF æ ¼å¼ã€‚
*   [ollama](https://ollama.com/) å’Œ [HF-ollama é›†æˆ](https://huggingface.co/docs/hub/en/ollama) æ”¯æŒé€šè¿‡ `ollama run` å‘½ä»¤è¿è¡Œ HF Hub ä¸Šçš„ä»»ä½• GGUF æ¨¡åž‹ã€‚

PyTorch (.pt/.pth)
------------------

.pt/.pth æ‰©å±•åä»£è¡¨ PyTorch çš„é»˜è®¤åºåˆ—åŒ–æ ¼å¼ï¼Œå­˜å‚¨åŒ…å«å­¦ä¹ å‚æ•°ï¼ˆæƒé‡ã€åç½®ï¼‰ã€ä¼˜åŒ–å™¨çŠ¶æ€å’Œè®­ç»ƒå…ƒæ•°æ®çš„æ¨¡åž‹çŠ¶æ€å­—å…¸ã€‚

PyTorch æ¨¡åž‹å¯ä»¥ä¿å­˜ä¸ºä¸¤ç§æ ¼å¼ï¼š

*   **.pt**ï¼šæ­¤æ ¼å¼ä¿å­˜æ•´ä¸ªæ¨¡åž‹ï¼ŒåŒ…æ‹¬å…¶æž¶æž„å’Œå­¦ä¹ å‚æ•°ã€‚
*   **.pth**ï¼šæ­¤æ ¼å¼ä»…ä¿å­˜æ¨¡åž‹çš„çŠ¶æ€å­—å…¸ï¼Œå…¶ä¸­åŒ…æ‹¬æ¨¡åž‹çš„å­¦ä¹ å‚æ•°å’Œä¸€äº›å…ƒæ•°æ®ã€‚

PyTorch æ ¼å¼åŸºäºŽ Python çš„ [pickle](https://docs.python.org/3/library/pickle.html) æ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽåºåˆ—åŒ– Python å¯¹è±¡ã€‚ä¸ºäº†ç†è§£ `pickle` çš„å·¥ä½œåŽŸç†ï¼Œè®©æˆ‘ä»¬çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼š

    import pickle
    model_state_dict = { "layer1": "hello", "layer2": "world" }
    pickle.dump(model_state_dict, open("model.pkl", "wb"))
    

The `pickle.dump()` å‡½æ•°å°† `model_state_dict` å­—å…¸åºåˆ—åŒ–å¹¶ä¿å­˜åˆ°åä¸º `model.pkl`. çš„æ–‡ä»¶ä¸­ã€‚è¾“å‡ºæ–‡ä»¶çŽ°åœ¨åŒ…å«å­—å…¸çš„äºŒè¿›åˆ¶è¡¨ç¤º:

![model.pkl hex view](https://img-s2.andfun.cn/devrel/posts/2025/03/e455c0e57afdf.jpg)  
model.pkl hex view

è¦å°†åºåˆ—åŒ–çš„å­—å…¸åŠ è½½å›ž Pythonï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `pickle.load()` å‡½æ•°:

    import pickle
    model_state_dict = pickle.load(open("model.pkl", "rb"))
    print(model_state_dict)
    # Output: {'layer1': 'hello', 'layer2': 'world'}
    

å¦‚ä½ æ‰€è§ï¼Œ`pickle` æ¨¡å—æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥åºåˆ—åŒ– Python å¯¹è±¡ã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ï¼š

*   **å®‰å…¨æ€§**ï¼šä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥è¢« pickleï¼Œ**åŒ…æ‹¬æ¶æ„ä»£ç **ã€‚å¦‚æžœåºåˆ—åŒ–æ•°æ®æœªç»è¿‡é€‚å½“éªŒè¯ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´žã€‚ä¾‹å¦‚ï¼ŒSnyk çš„è¿™ç¯‡æ–‡ç« è§£é‡Šäº† [pickle æ–‡ä»¶å¦‚ä½•è¢«æ¤å…¥åŽé—¨](https://snyk.io/articles/python-pickle-poisoning-and-backdooring-pth-files/)ã€‚
*   **æ•ˆçŽ‡**ï¼šå®ƒä¸æ”¯æŒå»¶è¿ŸåŠ è½½æˆ–éƒ¨åˆ†æ•°æ®åŠ è½½ã€‚è¿™å¯èƒ½å¯¼è‡´åœ¨å¤„ç†å¤§åž‹æ¨¡åž‹æ—¶**åŠ è½½é€Ÿåº¦æ…¢**å’Œ**å†…å­˜ä½¿ç”¨çŽ‡é«˜**ã€‚
*   **å¯ç§»æ¤æ€§**ï¼šå®ƒæ˜¯ç‰¹å®šäºŽ Python çš„ï¼Œè¿™ä½¿å¾—ä¸Žå…¶ä»–è¯­è¨€å…±äº«æ¨¡åž‹å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚

å¦‚æžœä½ ä»…åœ¨ Python å’Œ PyTorch çŽ¯å¢ƒä¸­å·¥ä½œï¼ŒPyTorch æ ¼å¼å¯èƒ½æ˜¯ä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œè¿‘å¹´æ¥ï¼ŒAI ç¤¾åŒºä¸€ç›´åœ¨è½¬å‘æ›´é«˜æ•ˆå’Œå®‰å…¨çš„åºåˆ—åŒ–æ ¼å¼ï¼Œä¾‹å¦‚ GGUF å’Œ Safetensorsã€‚

**æœ‰ç”¨èµ„æºï¼š**

*   [PyTorch æ–‡æ¡£](https://pytorch.org/docs/stable/generated/torch.save.html) å…³äºŽä¿å­˜å’ŒåŠ è½½æ¨¡åž‹ã€‚
*   [executorch](https://github.com/pytorch/executorch) é¡¹ç›®ï¼Œæä¾›äº†ä¸€ç§å°† PyTorch æ¨¡åž‹è½¬æ¢ä¸º `.pte` çš„æ–¹æ³•ï¼Œè¿™äº›æ¨¡åž‹å¯åœ¨ç§»åŠ¨å’Œè¾¹ç¼˜è®¾å¤‡ä¸Šè¿è¡Œã€‚

Safetensors
-----------

ç”± Hugging Face å¼€å‘çš„ [safetensors](https://huggingface.co/docs/safetensors/en/index) è§£å†³äº†ä¼ ç»Ÿ Python åºåˆ—åŒ–æ–¹æ³•ï¼ˆå¦‚ PyTorch ä½¿ç”¨çš„ `pickle`ï¼‰ä¸­å­˜åœ¨çš„å®‰å…¨æ€§å’Œæ•ˆçŽ‡é—®é¢˜ã€‚è¯¥æ ¼å¼ä½¿ç”¨å—é™çš„ååºåˆ—åŒ–è¿‡ç¨‹æ¥é˜²æ­¢ä»£ç æ‰§è¡Œæ¼æ´žã€‚

ä¸€ä¸ª safetensors æ–‡ä»¶åŒ…å«ï¼š

*   ä»¥ JSON æ ¼å¼ä¿å­˜çš„å…ƒæ•°æ®éƒ¨åˆ†ã€‚è¯¥éƒ¨åˆ†åŒ…å«æ¨¡åž‹ä¸­æ‰€æœ‰å¼ é‡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒä»¬çš„å½¢çŠ¶ã€æ•°æ®ç±»åž‹å’Œåç§°ã€‚å®ƒè¿˜å¯ä»¥é€‰æ‹©æ€§åœ°åŒ…å«è‡ªå®šä¹‰å…ƒæ•°æ®ã€‚
    
*   å¼ é‡æ•°æ®éƒ¨åˆ†ã€‚
    
    ![Safetensors æ ¼å¼ç»“æž„å›¾](https://img-s2.andfun.cn/devrel/posts/2025/03/e84152827fe7e.jpg)  
    Safetensors æ ¼å¼ç»“æž„å›¾
    
*   **ä¼˜ç‚¹**ï¼š
    
    *   å®‰å…¨ï¼šSafetensors é‡‡ç”¨å—é™çš„ååºåˆ—åŒ–è¿‡ç¨‹æ¥é˜²æ­¢ä»£ç æ‰§è¡Œæ¼æ´žã€‚
    *   å¿«é€Ÿï¼šå®ƒæ”¯æŒå»¶è¿ŸåŠ è½½å’Œéƒ¨åˆ†æ•°æ®åŠ è½½ï¼Œä»Žè€Œå¯ä»¥åŠ å¿«åŠ è½½é€Ÿåº¦å¹¶é™ä½Žå†…å­˜ä½¿ç”¨çŽ‡ã€‚è¿™ä¸Ž GGUF ç±»ä¼¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ `mmap()` æ˜ å°„æ–‡ä»¶ã€‚
    *   é«˜æ•ˆï¼šæ”¯æŒé‡åŒ–å¼ é‡ã€‚
    *   å¯ç§»æ¤ï¼šå®ƒè®¾è®¡ä¸ºè·¨ç¼–ç¨‹è¯­è¨€å¯ç§»æ¤ï¼Œä½¿å¾—ä¸Žå…¶ä»–è¯­è¨€å…±äº«æ¨¡åž‹å˜å¾—å®¹æ˜“ã€‚
*   **ç¼ºç‚¹**ï¼š
    
    *   é‡åŒ–æ–¹æ¡ˆä¸å¦‚ GGUF çµæ´»ã€‚è¿™ä¸»è¦æ˜¯ç”±äºŽ PyTorch æä¾›çš„é‡åŒ–æ”¯æŒæœ‰é™ã€‚
    *   éœ€è¦ JSON è§£æžå™¨æ¥è¯»å–å…ƒæ•°æ®éƒ¨åˆ†ã€‚è¿™åœ¨å¤„ç†åƒ C++ è¿™æ ·çš„ä½Žçº§è¯­è¨€æ—¶å¯èƒ½ä¼šå‡ºçŽ°é—®é¢˜ï¼Œå› ä¸ºè¿™äº›è¯­è¨€æ²¡æœ‰å†…ç½®çš„ JSON æ”¯æŒã€‚

æ³¨æ„ï¼šè™½ç„¶åœ¨ç†è®ºä¸Šå…ƒæ•°æ®å¯ä»¥ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œä½†åœ¨å®žè·µä¸­ï¼Œæ¨¡åž‹å…ƒæ•°æ®é€šå¸¸å­˜å‚¨åœ¨ä¸€ä¸ªå•ç‹¬çš„ JSON æ–‡ä»¶ä¸­ã€‚è¿™æ—¢å¯èƒ½æ˜¯ä¼˜ç‚¹ä¹Ÿå¯èƒ½æ˜¯ç¼ºç‚¹ï¼Œå…·ä½“å–å†³äºŽä½¿ç”¨åœºæ™¯ã€‚

safetensors æ ¼å¼æ˜¯ Hugging Face çš„ [transformers](https://huggingface.co/docs/transformers/index) åº“ä½¿ç”¨çš„é»˜è®¤åºåˆ—åŒ–æ ¼å¼ã€‚å®ƒåœ¨å¼€æºç¤¾åŒºä¸­å¹¿æ³›ç”¨äºŽ**å…±äº«ã€è®­ç»ƒã€å¾®è°ƒå’Œéƒ¨ç½² AI æ¨¡åž‹**ã€‚Hugging Face ä¸Šå‘å¸ƒçš„æ–°æ¨¡åž‹éƒ½ä»¥ safetensors æ ¼å¼å­˜å‚¨ï¼ŒåŒ…æ‹¬ Llamaã€Gemmaã€Phiã€Stable-Diffusionã€Flux ç­‰è®¸å¤šæ¨¡åž‹ã€‚

**æœ‰ç”¨èµ„æºï¼š**

*   [transformers](https://huggingface.co/docs/transformers/quicktour) åº“å…³äºŽä¿å­˜å’ŒåŠ è½½æ¨¡åž‹çš„æ–‡æ¡£ã€‚
*   [bitsandbytes æŒ‡å—](https://huggingface.co/docs/transformers/en/quantization/bitsandbytes) å…³äºŽå¦‚ä½•é‡åŒ–æ¨¡åž‹å¹¶å°†å…¶ä¿å­˜ä¸º safetensors æ ¼å¼ã€‚
*   [mlx-community](https://huggingface.co/mlx-community) ç»„ç»‡åœ¨ HF ä¸Šæä¾›ä¸Ž MLX æ¡†æž¶ï¼ˆApple èŠ¯ç‰‡ï¼‰å…¼å®¹çš„æ¨¡åž‹ã€‚

ONNX
----

å¼€æ”¾ç¥žç»ç½‘ç»œäº¤æ¢ï¼ˆOpen Neural Network Exchangeï¼ŒONNXï¼‰æ ¼å¼æä¾›äº†ä¸€ç§ä¸Žä¾›åº”å•†æ— å…³çš„æœºå™¨å­¦ä¹ æ¨¡åž‹è¡¨ç¤ºæ–¹æ³•ã€‚å®ƒæ˜¯ [ONNX ç”Ÿæ€ç³»ç»Ÿ](https://onnx.ai/) çš„ä¸€éƒ¨åˆ†ï¼Œè¯¥ç”Ÿæ€ç³»ç»ŸåŒ…æ‹¬ç”¨äºŽä¸åŒæ¡†æž¶ï¼ˆå¦‚ PyTorchã€TensorFlow å’Œ MXNetï¼‰ä¹‹é—´äº’æ“ä½œçš„å·¥å…·å’Œåº“ã€‚

ONNX æ¨¡åž‹ä»¥ `.onnx` æ‰©å±•åçš„å•ä¸ªæ–‡ä»¶ä¿å­˜ã€‚ä¸Ž GGUF æˆ– Safetensors ä¸åŒï¼ŒONNX ä¸ä»…åŒ…å«æ¨¡åž‹çš„å¼ é‡å’Œå…ƒæ•°æ®ï¼Œè¿˜åŒ…å«æ¨¡åž‹çš„**è®¡ç®—å›¾**ã€‚

åœ¨æ¨¡åž‹æ–‡ä»¶ä¸­åŒ…å«è®¡ç®—å›¾ä½¿å¾—åœ¨å¤„ç†æ¨¡åž‹æ—¶å…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œå½“å‘å¸ƒæ–°æ¨¡åž‹æ—¶ï¼Œä½ å¯ä»¥è½»æ¾åœ°å°†å…¶è½¬æ¢ä¸º ONNX æ ¼å¼ï¼Œè€Œæ— éœ€æ‹…å¿ƒæ¨¡åž‹çš„æž¶æž„æˆ–æŽ¨ç†ä»£ç ï¼Œå› ä¸ºè®¡ç®—å›¾å·²ç»ä¿å­˜åœ¨æ–‡ä»¶ä¸­ã€‚

![ONNX æ ¼å¼çš„è®¡ç®—å›¾ç¤ºä¾‹ï¼Œç”± Netron ç”Ÿæˆ](https://img-s2.andfun.cn/devrel/posts/2025/03/081249b1deacd.jpg)

ONNX æ ¼å¼çš„è®¡ç®—å›¾ç¤ºä¾‹ï¼Œç”± [Netron](https://netron.app/) ç”Ÿæˆ

*   **ä¼˜ç‚¹**ï¼š
    *   çµæ´»æ€§ï¼šåœ¨æ¨¡åž‹æ–‡ä»¶ä¸­åŒ…å«è®¡ç®—å›¾ä½¿å¾—åœ¨ä¸åŒæ¡†æž¶ä¹‹é—´è½¬æ¢æ¨¡åž‹æ—¶æ›´åŠ çµæ´»ã€‚
    *   å¯ç§»æ¤æ€§ï¼šå¾—ç›ŠäºŽ ONNX ç”Ÿæ€ç³»ç»Ÿï¼ŒONNX æ ¼å¼å¯ä»¥è½»æ¾éƒ¨ç½²åœ¨å„ç§å¹³å°å’Œè®¾å¤‡ä¸Šï¼ŒåŒ…æ‹¬ç§»åŠ¨è®¾å¤‡å’Œè¾¹ç¼˜è®¾å¤‡ã€‚
*   **ç¼ºç‚¹**ï¼š
    *   å¯¹é‡åŒ–å¼ é‡çš„æ”¯æŒæœ‰é™ã€‚ONNX æœ¬èº«ä¸æ”¯æŒé‡åŒ–å¼ é‡ï¼Œè€Œæ˜¯å°†å®ƒä»¬åˆ†è§£ä¸ºæ•´æ•°å¼ é‡å’Œæ¯”ä¾‹å› å­å¼ é‡ã€‚è¿™å¯èƒ½å¯¼è‡´åœ¨å¤„ç†é‡åŒ–æ¨¡åž‹æ—¶è´¨é‡ä¸‹é™ã€‚
    *   å¤æ‚æž¶æž„å¯èƒ½éœ€è¦ä¸ºä¸æ”¯æŒçš„å±‚ä½¿ç”¨æ“ä½œç¬¦å›žé€€æˆ–è‡ªå®šä¹‰å®žçŽ°ã€‚è¿™å¯èƒ½ä¼šåœ¨å°†æ¨¡åž‹è½¬æ¢ä¸º ONNX æ ¼å¼æ—¶å¯¼è‡´æ€§èƒ½æŸå¤±ã€‚

æ€»ä½“è€Œè¨€ï¼Œå¦‚æžœä½ æ­£åœ¨å¤„ç†ç§»åŠ¨è®¾å¤‡æˆ–æµè§ˆå™¨å†…æŽ¨ç†ï¼ŒONNX æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

**æœ‰ç”¨èµ„æºï¼š**

*   [onnx-community](https://huggingface.co/onnx-community) ç»„ç»‡åœ¨ HF ä¸Šæä¾› ONNX æ ¼å¼çš„æ¨¡åž‹ä»¥åŠè½¬æ¢æŒ‡å—ã€‚
*   [transformer.js](https://github.com/huggingface/transformers.js) é¡¹ç›®ï¼Œå…è®¸åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ WebGPU æˆ– WebAssembly è¿è¡Œ ONNX æ¨¡åž‹ã€‚
*   [onnxruntime](https://onnxruntime.ai/) é¡¹ç›®ï¼Œæä¾›åœ¨å„ç§å¹³å°å’Œç¡¬ä»¶ä¸Šçš„é«˜æ€§èƒ½æŽ¨ç†å¼•æ“Žã€‚
*   [netron](https://netron.app/) é¡¹ç›®ï¼Œå…è®¸åœ¨æµè§ˆå™¨ä¸­å¯è§†åŒ– ONNX æ¨¡åž‹ã€‚

ç¡¬ä»¶æ”¯æŒ
----

åœ¨é€‰æ‹©æ¨¡åž‹æ ¼å¼æ—¶ï¼Œé‡è¦çš„æ˜¯è¦è€ƒè™‘æ¨¡åž‹å°†éƒ¨ç½²åœ¨å“ªç§ç¡¬ä»¶ä¸Šã€‚ä¸‹è¡¨æ˜¾ç¤ºäº†æ¯ç§æ ¼å¼çš„ç¡¬ä»¶æ”¯æŒå»ºè®®ï¼š

ç¡¬ä»¶

GGUF

PyTorch

Safetensors

ONNX

CPU

âœ… (æœ€ä½³)

ðŸŸ¡

ðŸŸ¡

âœ…

GPU

âœ…

âœ…

âœ…

âœ…

ç§»åŠ¨è®¾å¤‡éƒ¨ç½²

âœ…

ðŸŸ¡ (é€šè¿‡ executorch)

âŒ

âœ…

Apple èŠ¯ç‰‡

âœ…

ðŸŸ¡

âœ… (é€šè¿‡ MLX æ¡†æž¶)

âœ…

è¯´æ˜Žï¼š

*   âœ…: å®Œå…¨æ”¯æŒ
*   ðŸŸ¡: éƒ¨åˆ†æ”¯æŒæˆ–æ€§èƒ½è¾ƒä½Ž
*   âŒ: ä¸æ”¯æŒ

ç»“è®º
--

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æŽ¢è®¨äº†å½“ä»Šä½¿ç”¨çš„ä¸€äº›å¸¸è§ AI æ¨¡åž‹æ ¼å¼ï¼ŒåŒ…æ‹¬ GGUFã€PyTorchã€Safetensors å’Œ ONNXã€‚æ¯ç§æ ¼å¼éƒ½æœ‰å…¶è‡ªèº«çš„ä¼˜ç¼ºç‚¹ï¼Œå› æ­¤æ ¹æ®å…·ä½“çš„ç”¨ä¾‹å’Œç¡¬ä»¶éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ ¼å¼è‡³å…³é‡è¦ã€‚

è„šæ³¨
--

mmapï¼šå†…å­˜æ˜ å°„æ–‡ä»¶æ˜¯ä¸€ç§æ“ä½œç³»ç»ŸåŠŸèƒ½ï¼Œå…è®¸å°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ä¸­ã€‚è¿™å¯¹äºŽåœ¨ä¸å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­çš„æƒ…å†µä¸‹è¯»å†™å¤§æ–‡ä»¶éžå¸¸æœ‰ç›Šã€‚

å»¶è¿ŸåŠ è½½ï¼ˆlazy-loadingï¼‰ï¼šå»¶è¿ŸåŠ è½½æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå®ƒå°†æ•°æ®çš„åŠ è½½æŽ¨è¿Ÿåˆ°å®žé™…éœ€è¦æ—¶ã€‚è¿™æœ‰åŠ©äºŽåœ¨å¤„ç†å¤§åž‹æ¨¡åž‹æ—¶å‡å°‘å†…å­˜ä½¿ç”¨å¹¶æé«˜æ€§èƒ½ã€‚

è®¡ç®—å›¾ï¼ˆcomputation graphï¼‰ï¼šåœ¨æœºå™¨å­¦ä¹ çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè®¡ç®—å›¾æ˜¯ä¸€ç§æµç¨‹å›¾ï¼Œå±•ç¤ºäº†æ•°æ®å¦‚ä½•é€šè¿‡æ¨¡åž‹æµåŠ¨ä»¥åŠæ¯ä¸€æ­¥å¦‚ä½•æ‰§è¡Œä¸åŒçš„è®¡ç®—ï¼ˆä¾‹å¦‚åŠ æ³•ã€ä¹˜æ³•æˆ–æ¿€æ´»å‡½æ•°çš„åº”ç”¨ï¼‰ã€‚

* * *

> è‹±æ–‡åŽŸæ–‡: [https://blog.ngxson.com/common-ai-model-formats](https://blog.ngxson.com/common-ai-model-formats)
> 
> åŽŸæ–‡ä½œè€…: Xuan Son Nguyen
> 
> è¯‘è€…: Adeena