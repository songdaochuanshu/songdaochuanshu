---
layout: post
title: 'c++å•ä¾‹å®è·µ'
date: "2025-09-22T00:43:15Z"
---
c++å•ä¾‹å®è·µ
=======

è¿™ç¯‡æ–‡ç« ä¸ºå¤§å®¶ä»‹ç»\`static\` å…³é”®å­—ç›¸å…³çŸ¥è¯†ä»¥åŠå¦‚ä½•å®ç°è‡ªå·±çš„C++å•ä¾‹ç±»ã€‚

C++å•ä¾‹å®è·µ
=======

åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œè™½ç„¶å¤ªå¤šçš„å•ä¾‹è°ƒç”¨ä¼šè®©ä»£ç çš„è€¦åˆåº¦å˜é«˜ï¼Œä½†æ˜¯ä¾‹å¦‚æ—¥å¿—ç±»è¿™ç§ï¼Œå•ä¾‹æ¨¡å¼å°±å˜å¾—éå¸¸æœ‰ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸ºå¤§å®¶ä»‹ç»`static` å…³é”®å­—ç›¸å…³çŸ¥è¯†ä»¥åŠå¦‚ä½•å®ç°è‡ªå·±çš„C++å•ä¾‹ç±»ã€‚

staticå…³é”®å­—
---------

é¦–å…ˆè®©æˆ‘ä»¬è¯·å‡ºä»Šå¤©çš„ä¸»è§’: **static**ã€‚C++ä¸­æœ‰ä¸€ä¸ªå…³é”®å­—â€”â€”`static`ï¼Œç”¨staticä¿®é¥°çš„å˜é‡æˆ–è€…å‡½æ•°ï¼Œéƒ½ä¼šå˜å¾—ä¸åŒã€‚æ ¹æ®[cpp reference](https://en.cppreference.com/w/cpp/keyword/static)ä¸­å…³äº`static`çš„æè¿°ï¼Œ`static`ä¸»è¦æœ‰å‡ ä¸ªä½œç”¨ï¼š

1.  ä½¿å…¨å±€å˜é‡å˜ä¸ºå†…éƒ¨é“¾æ¥æ€§ã€‚
2.  ä¿®é¥°å—ä½œç”¨åŸŸå˜é‡ï¼Œå…¶é™æ€å­˜å‚¨æ—¶é—´è·Ÿéšç¨‹åºå¹¶ä¸”åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ã€‚
3.  ä¿®é¥°ç±»æˆå‘˜ï¼Œä½¿å…¶ä¸ç±»ç›¸å…³ï¼Œè€Œéå¯¹è±¡ã€‚

### ä¿®é¥°å…¨å±€å˜é‡

é¦–å…ˆè¡¥å……ä¸€ä¸‹å…¨å±€å˜é‡ç›¸å…³çš„åŸºç¡€ï¼š  
å‡è®¾ä½ åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œæ­¤æ—¶ä½ åœ¨å¤šä¸ªæ–‡ä»¶é‡Œéƒ½åŒ…å«äº†è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œå› ä¸ºä½ æƒ³åœ¨è¿™äº›åœ°æ–¹éƒ½å…±ç”¨è¿™ä¸ªå˜é‡ã€‚ç„¶åä½ ç¼–è¯‘ä»£ç ï¼Œå‘ç°ç¼–è¯‘å™¨æŠ¥é”™å¹¶æç¤ºä½ â€œxxxé‡å®šä¹‰â€ã€‚

    // 1.h
    int GlobalVar = 1;
    
    // 1.cpp
    #include "1.h"
    int LocalVar = GlobalVar;
    
    // main.cpp
    #include "1.h"
    
    int main()
    {
        int var = GlobalVar;
    
        return 0;
    }
    
    

é—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹é¢„å¤„ç†ç›¸å…³çš„çŸ¥è¯†ï¼ŒåŒ…å«ä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œç¼–è¯‘å™¨åœ¨é¢„å¤„ç†é˜¶æ®µå°±ä¼šå°†å¤´æ–‡ä»¶ä¸­çš„å†…å®¹å±•å¼€ã€‚å›åˆ°åˆšåˆšçš„é—®é¢˜ï¼Œä½ åœ¨å¤šä¸ªæ–‡ä»¶ä¸­éƒ½åŒ…å«è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨å‘ç°æœ‰å¤šä¸ªåœ°æ–¹éƒ½å£°æ˜å¹¶ä¸”å®šä¹‰äº†ä¸€ä¸ª`GlobalVar`ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™ã€‚é‚£ä¹ˆæ€æ ·èƒ½å¤Ÿåœ¨åˆ«çš„æ–‡ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªå˜é‡å‘¢ï¼Ÿåˆ«æ‹…å¿ƒï¼ŒC++æä¾›äº†`extern`å…³é”®å­—ï¼Œæ¥å¸®åŠ©ä½ ä½¿ç”¨å…¨å±€å˜é‡ï¼š

    // 1.h
    extern int GlobalVar;
    
    // 1.cpp
    #include "1.h"
    int GlobalVar = 1;
    int LocalVar = GlobalVar;
    
    // main.cpp
    #include "1.h"
    
    int main()
    {
        int var = GlobalVar;
    
        return 0;
    }
    

ä½ éœ€è¦åœ¨1.hä¸­ä½¿ç”¨extern**å£°æ˜**è¿™ä¸ªå˜é‡ï¼Œç„¶ååœ¨1.cppä¸­**å®šä¹‰**è¿™ä¸ªå…¨å±€å˜é‡ã€‚æ­¤æ—¶ä»»ä½•åŒ…å«1.hçš„åœ°æ–¹éƒ½èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨è¿™ä¸ªå…¨å±€å˜é‡äº†ã€‚  
å›åˆ°æ­£è½¨ï¼Œç”¨staticä¿®é¥°è¿™ä¸ªå…¨å±€å˜é‡ï¼Œä¼šæœ‰ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿç”¨staticä¿®é¥°å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°†ä¼šå˜æˆå†…éƒ¨é“¾æ¥æ€§ï¼Œä»€ä¹ˆå«å†…éƒ¨é“¾æ¥æ€§å‘¢ï¼Ÿå°±æ˜¯è¯´**è¿™ä¸ªå˜é‡åªåœ¨å½“å‰æºæ–‡ä»¶æ‰è¢«å¯è§ï¼Œå³ä½¿ç”¨**`extern`**ä¿®é¥°ä¹Ÿä¸è¡Œ**ã€‚

    // 1.h
    static int StaticGlobalVar = 2;
    void funct();
    
    // 1.cpp
    #include "1.h"
    int GlobalVar = StaticGlobalVar;
    void funct()
    {
        std::cout << "address of: " << std::addressof(StaticGlobalValue) << std::endl;
    }
    
    // main.cpp
    #include "1.h"
    
    int main()
    {
        funct();
        std::cout << "address of: " << std::addressof(StaticGlobalValue) << std::endl;
    
        return 0;
    }
    

è™½ç„¶è¿™é‡Œåœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ‰“å°å˜é‡çš„åœ°å€ä½ å°±ä¼šå‘ç°ï¼Œåœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œå®é™…ä¸Šå°±ç›¸å½“äºæ˜¯åˆ›å»ºäº†ä¸¤ä¸ªå˜é‡ã€‚

> address of: 00007FF6BABC16F8  
> address of: 00007FF6BABC16F0

æ‰€ä»¥ï¼Œè¿™ä¹Ÿå°±æ˜¯**å†…éƒ¨é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯å†…éƒ¨å¯è§æ€§ï¼Œå¤–éƒ¨ä¸å¯è§**ã€‚

### ä¿®é¥°å—å†…å±€éƒ¨å˜é‡

`static`ä¿®é¥°å±€éƒ¨å˜é‡ï¼Œå˜é‡çš„å­˜å‚¨å‘¨æœŸå°†ä¼šå‘ç”Ÿå˜åŒ–ï¼šä»ç¬¬ä¸€æ¬¡å®šä¹‰è¿™ä¸ªå˜é‡èµ·ï¼Œåˆ°ç¨‹åºç»“æŸã€‚

    #include <iostream>
    
    void func()
    {
        static int a = 0;
        int b = 0;
        a++;
        b++;
    
        std::cout << "a = " << a << "; b = " << b << std::endl;
    }
    
    int main()
    {
        func();
        func();
        
        return 0;
    }
    

ä¸Šé¢ä»£ç è¿è¡Œè¾“å‡ºä¸ºï¼š

> a = 1; b = 1;  
> a = 2; b = 1;

ä»è¿™æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œstaticä¿®é¥°å±€éƒ¨å˜é‡ä¹‹åï¼Œå…¶å­˜å‚¨ç©ºé—´å˜æˆäº†Static Storage Durationï¼Œä¹Ÿå°±æ˜¯éšç¨‹åºé€€å‡ºè€Œç»“æŸã€‚

### ä¿®é¥°ç±»æˆå‘˜

staticä¿®é¥°ç±»æˆå‘˜ï¼Œè¯¥æˆå‘˜å˜æˆç±»çš„é™æ€æˆå‘˜ï¼Œå±äºç±»ï¼Œè€Œéå±äºå¯¹è±¡ã€‚å½“`static`ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œç›¸æ¯”äºæˆå‘˜å˜é‡ä¼šæœ‰ä¸€äº›é™åˆ¶ï¼š**ç±»çš„é™æ€æˆå‘˜å‡½æ•°ï¼Œåªèƒ½è®¿é—®ç±»çš„é™æ€æˆå‘˜ï¼Œä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ã€‚** è¿™é‡Œä¸éš¾ç†è§£ï¼Œæ¯•ç«Ÿåœ¨æ²¡æœ‰å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œç±»çš„éé™æ€æˆå‘˜è¿˜æ²¡æœ‰åˆ›å»ºï¼Œæ­¤æ—¶é€šè¿‡é™æ€å‡½æ•°è®¿é—®éé™æ€æˆå‘˜å°±ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚

    #include <iostream>
    
    class MyClass
    {
    public:
        static void FuncStatic
        {
            std::cout << staticVar << std::endl;
    
            // error! é™æ€å‡½æ•°åªèƒ½è®¿é—®é™æ€æˆå‘˜
            //std::cout << var << std::endl;
        }
    
    
    private:
        static int staticVar;
        int var;
    };
    

åˆ›å»ºå±äºè‡ªå·±çš„å•ä¾‹ç±»
----------

é€šè¿‡å¯¹ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å·²ç»æ‹¥æœ‰äº†ä¸€æŠŠèƒ½å¤Ÿè§£å†³å•ä¾‹æ¨¡å¼çš„åˆ©å‰‘ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å•ä¾‹ç±»ã€‚æš‚ä¸”å°†è¿™ä¸ªç±»å‘½åä¸º`MyInstanceClass`ã€‚

### é¥¿æ±‰å¼å•ä¾‹

å®ç°ä¸€ä¸ªå•ä¾‹ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªç‚¹è¦æ±‚ï¼š

1.  å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹
2.  æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®è¯¥å®ä¾‹

è¦å®ç°å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ„å‘³ç€ä¸å…è®¸è‡ªå·±åˆ›å»ºå¯¹è±¡ï¼Œèªæ˜çš„ä½ å¯ä»¥æƒ³åˆ°ï¼Œ**å°†æ„é€ å‡½æ•°å£°æ˜æˆprivate**ï¼Œè¿™æ ·å¤–éƒ¨å°±æ²¡åŠæ³•è°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¹Ÿå°±è°ˆä¸ä¸Šåˆ›å»ºå¯¹è±¡äº†ã€‚

    class MyInstanceClass
    {
    private:
        MyInstanceClass();
    
    };
    

åˆ°è¿™é‡Œï¼Œæœ‰çš„åŒå­¦ä¼šé—®äº†ï¼šâ€œæ„é€ å‡½æ•°ç§æœ‰åŒ–äº†ï¼Œé‚£è¿˜æ€ä¹ˆåˆ›å»ºå”¯ä¸€å®ä¾‹å‘¢ï¼Ÿâ€ è¿˜è®°å¾—æˆ‘ä»¬å‰é¢ä»‹ç»è¿‡staticå˜é‡å—ï¼Ÿç°åœ¨è¯¥åˆ°ä»–å‡ºåœºçš„æ—¶å€™äº†ã€‚â˜ğŸ¤“æˆ‘ä»¬å¯ä»¥**å®šä¹‰ä¸€ä¸ªstaticæˆå‘˜å˜é‡**ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œç±»çš„é™æ€æˆå‘˜å±äºç±»ï¼Œè€Œä¸å±äºå¯¹è±¡ï¼Œè¿™ä¹Ÿå°±ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼š**å…¨å±€å”¯ä¸€å®ä¾‹ã€‚**

    class MyInstanceClass
    {
    private:
        MyInstanceClass();
    
    private:
        static MyInstanceClass instance;
    };
    

> PS: é¡ºå¸¦æ’ä¸€å¥ï¼šå…³äºä¸ºä»€ä¹ˆé™æ€æˆå‘˜å˜é‡èƒ½å¤Ÿè°ƒç”¨ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œç½‘ä¸Šè¯´çš„æ˜¯ï¼Œé™æ€æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œå¹¶ä¸”è¿™ä¸ªé™æ€æˆå‘˜å˜é‡æ˜¯**ç”±ç¼–è¯‘å™¨å»è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œè¿™ä¸ªæ“ä½œåœ¨mainå‡½æ•°è¿è¡Œä¹‹å‰æ‰§è¡Œ**ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯ç¼–è¯‘å™¨åšçš„ï¼‰ã€‚è¿™ä¸€å—å¯ä»¥çœ‹ä¸€æœ¬ç»å…¸çš„ä¹¦ï¼šã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€”â€”é“¾æ¥ã€è£…è½½ä¸åº“ã€‹ä¸­çš„11.4èŠ‚:  
>   
>   
> **å¯¹äºæ¯ä¸ªç¼–è¯‘å•å…ƒ(.cpp)ï¼ŒGCCç¼–è¯‘å™¨ä¼šéå†å…¶ä¸­æ‰€æœ‰çš„å…¨å±€å¯¹è±¡ï¼Œç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œè¿™ä¸ªç‰¹æ®Šå‡½æ•°çš„ä½œç”¨å°±æ˜¯å¯¹æœ¬ç¼–è¯‘å•å…ƒé‡Œçš„æ‰€æœ‰å…¨å±€å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æœ¬èŠ‚å¼€å¤´çš„ä»£ç è¿›è¡Œåæ±‡ç¼–å¾—åˆ°ä¸€äº›ç²—ç•¥çš„ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°GCCåœ¨ç›®æ ‡ä»£ç ä¸­ç”Ÿæˆäº†ä¸€ä¸ªåä¸º\_GLOBAL\_\_I\_Hwçš„å‡½æ•°ï¼Œç”±è¿™ä¸ªå‡½æ•°è´Ÿè´£æœ¬ç¼–è¯‘å•å…ƒæ‰€æœ‰çš„å…¨å±€\\é™æ€å¯¹è±¡çš„æ„é€ å’Œææ„**

ç°åœ¨ï¼Œæˆ‘ä»¬å®ç°ç¬¬äºŒä¸ªç‚¹ï¼š**æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®ã€‚**  
æˆ‘ä»¬é€šè¿‡å®šä¹‰ä¸€ä¸ª**publicçš„é™æ€æˆå‘˜å‡½æ•°**`GetInstance`æ¥è·å–è¿™ä¸ªå…¨å±€å®ä¾‹ã€‚ä¸ºä»€ä¹ˆè¦æ˜¯é™æ€æˆå‘˜å‡½æ•°å‘¢ï¼Ÿå…³äºè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªç‚¹ï¼Œé™æ€æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ã€‚å¦‚æœå£°æ˜çš„ä¸æ˜¯`static`å‡½æ•°ï¼Œé‚£ä¹ˆ**éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ‰èƒ½è°ƒç”¨ï¼Œè€Œç”±äºæ„é€ å‡½æ•°ç§æœ‰åŒ–åˆä¸èƒ½å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨é™æ€æˆå‘˜å‡½æ•°**ã€‚æ­¤å¤–staticæˆå‘˜å˜é‡ï¼Œéœ€è¦åœ¨cppæ–‡ä»¶é‡Œé¢è¿›è¡Œå®šä¹‰ã€‚

    // .h
    class MyInstanceClass
    {
    public:
        static MyInstanceClass* GetInstance()
        {
            return &instance;
        }
    
    private:
        MyInstanceClass();
    
    private:
        static MyInstanceClass instance;
    };
    
    //.cpp
    // å®šä¹‰
    MyInstanceClass MyInstanceClass::instance;
    

åŒæ—¶ä¸ºäº†é˜²æ­¢èƒ½å¤Ÿé€šè¿‡æ‹·è´æ„é€ å‡½æ•°æ¥ç”Ÿæˆå¯¹è±¡ï¼Œæˆ‘ä»¬**æ˜¾å¼çš„å°†æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦åˆ é™¤**ã€‚

    // .h
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            return instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static MyInstanceClass instance;
    };
    

é€šè¿‡è°ƒç”¨`MyInstanceClass::GetInstance()`æ¥è·å–è¿™ä¸ªå®ä¾‹ã€‚  
çœ‹åˆ°è¿™é‡Œï¼Œæ­å–œä½ **ğŸ¥³**ï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ª**é¥¿æ±‰å‹å•ä¾‹**ã€‚ä»€ä¹ˆå«â€œé¥¿æ±‰å‹å•ä¾‹â€å‘¢ï¼Ÿé¡¾åæ€ä¹‰ï¼Œé¥¿æ±‰é¥¿æ±‰ï¼Œå°±æ˜¯å¾ˆé¥¿äº†ï¼Œé©¬ä¸Šå°±è¦åƒä¸œè¥¿ï¼Œä¹Ÿå°±å¯¹åº”ç€**è¿™ä¸ªå•ä¾‹å®ä¾‹åœ¨è½¯ä»¶è¿è¡Œçš„æ—¶å€™å°±ä¼šåˆ›å»º**ã€‚

### æ‡’æ±‰å‹å•ä¾‹

ä¹Ÿè®¸ä½ æ˜¯ä¸€ä¸ªååˆ†çæƒœå†…å­˜çš„å¼€å‘è€…ï¼Œè¿™ä¸ªå•ä¾‹åœ¨ä½ ä¸éœ€è¦çš„æ—¶å€™ï¼Œå°±å ç”¨äº†å†…å­˜ç©ºé—´ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆä½ çš„æ€§æ ¼ã€‚ä¼˜åŒ–ï¼ä¸€å®šè¦ä¼˜åŒ–ğŸ¤¬ï¼èªæ˜çš„ä½ åˆæƒ³åˆ°äº†ä¸€ä¸ªåŠæ³•â˜ğŸ¤“ï¼Œ**å°†æˆå‘˜å˜é‡æ”¹æˆæŒ‡é’ˆï¼Œåœ¨éœ€è¦ç”¨çš„æ—¶å€™å†å»åˆ›å»ºä¸å°±å¥½äº†**ã€‚å¹¶ä¸”æä¾›ä¸€ä¸ªé”€æ¯å‡½æ•°ï¼Œåœ¨ç¨‹åºé€€å‡ºçš„æ—¶å€™ï¼Œè°ƒç”¨ææ„å‡½æ•°ï¼Œå°†å ç”¨çš„èµ„æºé€‚å½“ã€‚åƒä¸‹é¢è¿™æ ·ï¼š

    // .h
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            if (instance == nullptr)
            {
                instance = new MyInstanceClass;
            }
            
            return *instance;
        }
    
        void Destroy()
        {
            if (instance)
            {
                delete instance;
                instance = nullptr;
            }
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static MyInstanceClass* instance;
    };
    
    // .cpp
    MyInstanceClass* MyInstanceClass::instance = nullptr;
    

ä¸ºäº†é˜²æ­¢å¿˜è®°æ‰‹åŠ¨ææ„å˜é‡ï¼ˆä¸è¦ç›¸ä¿¡è‡ªå·±ä¸€å®šä¼šè®°å¾—ï¼‰ï¼Œä½ ç”¨ä¸Šæ™ºèƒ½æŒ‡é’ˆï¼Œè‡ªåŠ¨ç®¡ç†å†…å­˜ã€‚

    // .h
    #include <memory>
    
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            if (instance == nullptr)
            {
                instance.reset(new MyInstanceClass);
            }
        
            return *instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static std::unique_ptr<MyInstanceClass> instance;
    };
    
    // .cpp
    std::unique_ptr<MyInstanceClass> MyInstanceClass::instance;
    

æ­å–œä½ ï¼Œåˆ›å»ºäº†ä¸€ä¸ª**æ‡’æ±‰å‹å•ä¾‹**ï¼ˆåœ¨**ç¬¬ä¸€æ¬¡è°ƒç”¨å…¨å±€è®¿é—®æ¥å£çš„æ—¶å€™ï¼Œæ‰åˆå§‹åŒ–å•ä¾‹**ï¼‰ã€‚ç°åœ¨ä½ æ‹¿ç€ä½ çš„å•ä¾‹å»åº”ç”¨åˆ°ä½ çš„é¡¹ç›®é‡Œé¢ï¼Œå‘ç°ååˆ†çš„å¥½ç”¨ğŸ¤¤ï¼Œä½ å°è¯•åº”ç”¨åˆ°æ›´å¤šçš„åœºæ™¯ã€‚æ­£å¥½ä½ æœ‰ä¸€ä¸ªåº”ç”¨å¤šçº¿ç¨‹çš„é¡¹ç›®ï¼Œä½ ä¹Ÿæ‰“è’œç”¨ä½ çš„å•ä¾‹ï¼Œé—®é¢˜éšä¹‹è€Œæ¥ã€‚

### **Double Check Lock Patternï¼ˆDCLPï¼‰**

è€ƒè™‘ä¸€ä¸ªå¤šçº¿ç¨‹åœºæ™¯ï¼Œä¸¤ä¸ªçº¿ç¨‹Aã€Bï¼Œåœ¨Açº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨`GetInstance`ï¼Œå¹¶åˆ¤æ–­`instance == nullptr`ï¼Œæ»¡è¶³æ¡ä»¶å‡†å¤‡æ„é€ çš„æ—¶å€™ã€‚çº¿ç¨‹Bä¹Ÿè°ƒç”¨äº†`GetInstance`ï¼Œè€Œæ­¤æ—¶çº¿ç¨‹Aè°ƒç”¨çš„`instance = new MyInstanceClass;`è¿˜æ²¡æœ‰è¿”å›ï¼Œæ‰€ä»¥`instance == nullptr`ä»ç„¶æ˜¯æ»¡è¶³çš„ï¼Œæ­¤æ—¶åˆä¼šè°ƒç”¨ä¸€éæ„é€ å‡½æ•°ï¼Œæ­¤æ—¶å°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå› ä¸ºåˆ›å»ºäº†ä¸¤æ¬¡ï¼Œä½†æ˜¯åªä¿å­˜äº†ä¸€ä¸ªæŒ‡é’ˆçš„åœ°å€ï¼‰ã€‚  
![6f58dfea08f8075f8c56fd822868a853](https://img2024.cnblogs.com/blog/2343534/202509/2343534-20250921170607574-1706046186.png)  
  
ä¸ºäº†è§£å†³è¿™ç§å¤šçº¿ç¨‹é—®é¢˜ï¼Œä½ å¼•å…¥å¸¸è§çš„å¤„ç†å¤šçº¿ç¨‹åŒæ­¥çš„æœºåˆ¶â€”â€”é”ã€‚åœ¨åˆ¤æ–­instanceå˜é‡æ˜¯å¦ä¸ºnullptræ—¶ï¼ŒåŠ é”ã€‚

    // .h 
    #include <memory>
    #include <mutex>
    
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            std::lock_guard<std::mutex> locker(mutex_);
            if (instance == nullptr)
            {
                instance.reset(new MyInstanceClass);
            }
        
            return *instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static std::unique_ptr<MyInstanceClass> instance;
        static std::mutex mutex_;
    };
    
    // .cpp
    std::unique_ptr<MyInstanceClass> MyInstanceClass::instance;
    std::mutex MyInstanceClass::mutex_;
    

ä½†æ˜¯ç»†å¿ƒçš„åˆåŒå’æƒ³åˆ°äº†é—®é¢˜ï¼ˆç›²ç”Ÿï¼Œä½ å‘ç°äº†åç‚¹ğŸ•µï¼‰ï¼Œå…¶å®çœŸæ­£çš„å†…å­˜åˆ›å»ºåªä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œä½†æ¯ä¸€æ¬¡è°ƒç”¨**ä¸ç®¡å†…å­˜åˆ›å»ºæœ‰æ²¡æœ‰æ‰§è¡Œï¼Œéƒ½ä¼šæ‰§è¡ŒåŠ é”è§£é”çš„æ“ä½œ**ï¼Œè¿™æ˜¯ä¸å¿…è¦çš„æµªè´¹ã€‚ä½ åˆä¼šè¯´ï¼šä¼˜åŒ–ï¼ä¸€å®šè¦ä¼˜åŒ–ğŸ¤¬ï¼  
äºæ˜¯**ä½ é€‰æ‹©åœ¨åŠ é”ä¹‹å‰ï¼Œå†è¿›è¡Œä¸€æ¬¡åˆ¤ç©ºçš„æ“ä½œï¼Œå¦‚æœå·²ç»åˆå§‹åŒ–å®Œæˆï¼Œå°±ç›´æ¥è¿”å›instance**ã€‚å°±ä¸éœ€è¦æ¯ä¸€æ¬¡éƒ½è¿›è¡Œæ˜‚è´µçš„åŠ è§£é”æ“ä½œã€‚

    // .h 
    #include <memory>
    #include <mutex>
    
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            if (instance == nullptr)
            {
                std::lock_guard<std::mutex> locker(mutex_);
                if (instance == nullptr)
                {
                    instance.reset(new MyInstanceClass);
                }
            }
            
            return *instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static std::unique_ptr<MyInstanceClass> instance;
        static std::mutex mutex_;
    };
    
    // .cpp
    std::unique_ptr<MyInstanceClass> MyInstanceClass::instance;
    std::mutex MyInstanceClass::mutex_;
    

è¿™ç§åŒé‡æ£€æŸ¥çš„æ“ä½œï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºï¼š**Double Check Lock Patternï¼ˆDCLPï¼‰**ã€‚ç„¶è€Œï¼ŒDCLPä¹Ÿä¸åƒä½ æƒ³è±¡ä¸­çš„é‚£ä¹ˆç¨³å¦¥ï¼Œåœ¨å¤šçº¿ç¨‹åœºæ™¯ä¸‹ï¼Œä»ç„¶æ˜¯ä¼šæœ‰é—®é¢˜çš„ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼š  
`instance = new MyInstanceClass`  
è¿™å¥ä»£ç åˆ†æˆä¸‰ä¸ªæ­¥éª¤:

1.  åˆ›å†…å­˜
2.  è°ƒæ„é€ 
3.  èµ‹å˜é‡

ä½†æ˜¯å­˜åœ¨ä¸€ç§å†…å­˜reorderçš„æƒ…å†µï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šæŠŠç¬¬äºŒã€ç¬¬ä¸‰ä¸¤ä¸ªæ­¥éª¤è°ƒæ¢é¡ºåºï¼Œ**å¯¼è‡´å¦å¤–ä¸€ä¸ªçº¿ç¨‹è·å–çš„å˜é‡æ˜¯ä¸€ä¸ªæ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°çš„å˜é‡**ã€‚å…·ä½“åˆ†æå¯ä»¥çœ‹æ–‡æœ«å‚è€ƒä¸­çš„ç¬¬7æ¡é“¾æ¥ã€‚  
  
![6d55c39c30e3169483f60ca141dcebc6](https://img2024.cnblogs.com/blog/2343534/202509/2343534-20250921170736232-724585973.png)é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•èƒ½å¤Ÿè®©ä½ æ”¾å¿ƒå¤§èƒ†çš„åœ¨å„ç§åœºæ™¯å»ä½¿ç”¨è¿™ä¸ªå•ä¾‹å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰ï¼Œè€Œä¸”è¿˜ä¸æ­¢ä¸€ç§ã€‚

### std::call\_once

C++11æ–°å¢äº†ä¸€ä¸ªå‡½æ•°`std::call_once`ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹:

    template< class Callable, class... Args >
    void call_once( std::once_flag& flag, Callable&& f, Args&&... args );
    

è¿™ä¸ªå‡½æ•°ä¿è¯ä½ æ‰€ä¼ å…¥çš„`f`åªè°ƒç”¨ä¸€æ¬¡ï¼Œé‚£ä¹ˆæŠŠä½ çš„å•ä¾‹ç±»ç¨ä½œä¿®æ”¹ï¼Œå°±å¯ä»¥å®ç°åªæ„é€ ä¸€æ¬¡çš„éœ€æ±‚ã€‚

    // .h 
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            static std::once_flag s_flag;
            std::call_once(s_flag, [&]() {
                instance.reset(new Singleton);
            });
    
            return *instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    
    private:
        static std::unique_ptr<MyInstanceClass> instance;
    };
    
    // .cpp
    std::unique_ptr<MyInstanceClass> MyInstanceClass::instance;
    

### Meyer's Singleton

ç¬¬äºŒç§æ–¹æ³•é‡‡ç”¨åœ¨å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªé™æ€å±€éƒ¨å˜é‡çš„æ–¹å¼ï¼Œåˆ©ç”¨**å‡½æ•°å†…çš„é™æ€å˜é‡åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œæ‰ä¼šåˆå§‹åŒ–**çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥ä»¥ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚

    // .h 
    class MyInstanceClass
    {
    public:
        static MyInstanceClass& GetInstance()
        {
            static MyInstanceClass instance;
            return instance;
        }
    
    private:
        MyInstanceClass();
        MyInstanceClass(const MyInstanceClass&) = delete;
        MyInstanceClass& operator=(const MyInstanceClass&) = delete;
    };
    
    

> â—æ³¨æ„ï¼š  
> å¦‚æœMyInstanceClassä½äºä¸€ä¸ªé™æ€åº“ï¼Œä¸”è¿™ä¸ªé™æ€åº“è¢«å¤šä¸ªDLLæˆ–è€…å¯æ‰§è¡Œç¨‹åºé“¾æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹å°±å¤±æ•ˆäº†ï¼Œä½ åœ¨ä¸åŒç¼–è¯‘å•å…ƒè°ƒç”¨çš„GetInstanceè·å–åˆ°çš„éƒ½ä¸æ˜¯åŒä¸€ä¸ªã€‚åœ¨ C++ ä¸­ï¼Œstatic å±€éƒ¨å˜é‡ï¼ˆå¦‚ static Singleton instanceï¼‰å…·> æœ‰ï¼š
> 
> *   å†…éƒ¨é“¾æ¥æ€§ï¼ˆinternal linkageï¼‰æˆ–æ— é“¾æ¥æ€§ï¼ˆno linkageï¼‰ â€”â€” å®ƒä¸æ˜¯å…¨å±€ç¬¦å·ï¼Œä¸ä¼šè¢«å¯¼å‡ºã€‚
> *   å®ƒçš„â€œä½œç”¨åŸŸâ€ä»…é™äºå½“å‰ç¼–è¯‘å•å…ƒï¼ˆtranslation unitï¼‰ã€‚
> *   ä½†å®ƒçš„â€œå­˜å‚¨ä½ç½®â€æ˜¯åœ¨ .bss æˆ– .data æ®µï¼Œæ¯ä¸ªç›®æ ‡æ–‡ä»¶éƒ½æœ‰ä¸€ä»½ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´ã€‚
> 
> ğŸ‘‰ æ‰€ä»¥å½“å¤šä¸ªæ¨¡å—ï¼ˆå¦‚ pluginA.so å’Œ pluginB.soï¼‰å„è‡ªé“¾æ¥äº†åŒ…å«è¯¥å‡½æ•°çš„ç›®æ ‡æ–‡ä»¶æ—¶ï¼Œæ¯ä¸ªæ¨¡å—éƒ½ä¼šï¼š
> 
> *   æ‹¥æœ‰è¯¥å‡½æ•°çš„å‰¯æœ¬ï¼ˆå› ä¸ºå‡½æ•°ä»£ç è¢«å¤åˆ¶è¿›æ¨¡å—ï¼‰
> *   æ‹¥æœ‰è¯¥å‡½æ•°å†… static å˜é‡çš„ç‹¬ç«‹å‰¯æœ¬ï¼ˆå› ä¸ºå˜é‡åœ¨å„è‡ªçš„æ•°æ®æ®µï¼‰

æ‹“å±•ï¼š
---

### Storage Duration & Linkage

æ­¤éƒ¨åˆ†å†…å®¹å‚è€ƒ[Storage class specifiers - cppreference.com](https://en.cppreference.com/w/cpp/language/storage_duration)ï¼Œæƒ³è¦è¯¦ç»†äº†è§£çš„åŒå­¦è¯·åˆ°è¿™ä¸ªé“¾æ¥å»æŸ¥çœ‹ï¼Œæœ¬æ–‡åªåšç®€å•ä»‹ç»ã€‚

#### Storage Durationï¼ˆå­˜å‚¨å‘¨æœŸï¼‰

å­˜å‚¨å‘¨æœŸï¼Œä¹Ÿå°±æ˜¯å˜é‡ä»€ä¹ˆæ—¶å€™è¢«é”€æ¯ï¼Œæ ¹æ®ä¸åŒæƒ…å†µä¸»è¦åˆ†ä¸ºå››ç§ï¼š

1.  è‡ªåŠ¨å­˜å‚¨å‘¨æœŸï¼ˆAutomatic Storage Durationï¼‰
    
    è¿™ç§å­˜å‚¨å‘¨æœŸä¸€èˆ¬ç»“æŸäºå½“å‰çš„ç¨‹åºå—ã€‚ä¾‹å¦‚å—ä½œç”¨åŸŸä¸­çš„å±€éƒ¨å˜é‡åœ¨ç»“æŸå½“æ—¶å—æ—¶å°±è‡ªåŠ¨é”€æ¯ã€‚åˆæ¯”å¦‚å‡½æ•°ä¸­çš„å½¢å‚ï¼Œåœ¨å‡½æ•°ç»“æŸåï¼Œå°±è‡ªåŠ¨é”€æ¯ã€‚
    
2.  é™æ€å­˜å‚¨å‘¨æœŸï¼ˆStatic Storage Durationï¼‰
    
    æ­¤ç±»å­˜å‚¨å‘¨æœŸè·Ÿéšç¨‹åºçš„é€€å‡ºè€Œç»“æŸã€‚ä¾‹å¦‚å…¨å±€å˜é‡æˆ–è€…staticä¿®é¥°çš„å±€éƒ¨å˜é‡ã€‚
    
3.  çº¿ç¨‹å­˜å‚¨å‘¨æœŸï¼ˆThread Storage Durationï¼‰
    
    æ­¤ç±»å­˜å‚¨å‘¨æœŸè·Ÿéšçº¿ç¨‹çš„é€€å‡ºè€Œç»“æŸã€‚æ³¨æ„ï¼Œè¿™ä¸ª**ä»…åœ¨C++11åŠä¹‹åç‰ˆæœ¬**æ‰å­˜åœ¨ï¼Œå› ä¸ºC++11å¼•å…¥äº†thread\_localä¿®é¥°ç¬¦ã€‚
    
4.  åŠ¨æ€å­˜å‚¨å‘¨æœŸï¼ˆDynamic Storage Durationï¼‰
    
    æ­¤ç±»å­˜å‚¨å‘¨æœŸçš„å­˜å‚¨å‘¨æœŸå–å†³äºä½¿ç”¨è€…ã€‚ä¾‹å¦‚æ‰‹åŠ¨è°ƒç”¨newå’Œdeleteåˆ›å»ºçš„å¯¹è±¡ã€‚
    

#### Linkageï¼ˆé“¾æ¥æ€§ï¼‰

åŒæ ·ï¼Œé“¾æ¥æ€§ä¹Ÿåˆ†æˆä¸‰ç§ï¼š

1.  æ— é“¾æ¥æ€§ï¼ˆNo Linkageï¼‰
    
    æ­¤ç±»é“¾æ¥æ€§ä»£è¡¨ä»…ä»…åªèƒ½åœ¨åŒä¸€ä½œç”¨åŸŸæ‰èƒ½è®¿é—®ã€‚ä¾‹å¦‚å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ï¼ˆ**æ²¡æœ‰è¢«explicitä¿®é¥°**ï¼‰ï¼Œå±€éƒ¨ç±»å’Œå…¶æˆå‘˜å‡½æ•°ç­‰ã€‚
    
2.  å†…éƒ¨é“¾æ¥æ€§ï¼ˆInternal Linkageï¼‰
    
    èƒ½å¤Ÿè¢«å½“å‰ç¿»è¯‘å•å…ƒè®¿é—®ç§°ä¹‹ä¸ºå†…éƒ¨é“¾æ¥æ€§ã€‚ä¾‹å¦‚ç”¨`static`ä¿®é¥°çš„å˜é‡ã€å‡½æ•°ç­‰ï¼›
    
3.  å¤–éƒ¨é“¾æ¥æ€§ï¼ˆExternal Linkageï¼‰
    
    èƒ½å¤Ÿè¢«å…¶ä»–ç¿»è¯‘å•å…ƒè®¿é—®çš„ç§°ä¹‹ä¸ºå¤–éƒ¨é“¾æ¥æ€§ã€‚ä¾‹å¦‚æœ‰åå‘½åç©ºé—´ä¸‹çš„ç±»ã€æšä¸¾ç­‰ï¼Œä½¿ç”¨**extern**å£°æ˜çš„å˜é‡ç­‰éƒ½å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§ã€‚
    

### Static Members

åœ¨å£°æ˜ç±»æˆå‘˜ï¼ˆæˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼‰æ—¶ï¼Œåœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªstaticï¼Œå³å¯å°†æ­¤æˆå‘˜å®šä¹‰æˆä¸€ä¸ªç±»çš„é™æ€æˆå‘˜ã€‚é™æ€æˆå‘˜æ‹¥æœ‰é™æ€å­˜å‚¨å‘¨æœŸä»¥åŠå†…éƒ¨é“¾æ¥æ€§ã€‚

#### åŸºç¡€

å½“staticä¿®é¥°ç±»æˆå‘˜æ—¶ï¼Œè¿™ä¸ªç±»æˆå‘˜å°±ä¸å†ä¸ç±»çš„å¯¹è±¡ï¼ˆobjectï¼‰ç›¸å…³ï¼Œè€Œæ˜¯ä¸ç±»ç›¸å…³ã€‚ç›´ç™½ä¸€ç‚¹è¯´å°±æ˜¯ä¸ç®¡ä½ å®šä¹‰å¤šå°‘ä¸ªå¯¹è±¡ï¼Œç±»çš„é™æ€æˆå‘˜å§‹ç»ˆåªæœ‰ä¸€ä¸ªï¼Œå®ƒæ˜¯ä¸ç±»ç›¸å…³çš„ã€‚

    class MyStaticClass
    {
    public:
        static void StaticFunc()
        {
            
        }
    
    private:
        static int StaticVar;
    };
    

#### Static Data Members

å°†ç±»çš„æˆå‘˜å˜é‡ç”¨staticä¿®é¥°ï¼Œå®ƒå°±æˆä¸ºäº†ä¸€ä¸ªé™æ€æ•°æ®æˆå‘˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**é™æ€æ•°æ®æˆå‘˜ä¸èƒ½æ˜¯**`mutable`ã€‚

##### å¦‚ä½•å®šä¹‰ä»¥åŠåˆå§‹åŒ–é™æ€æˆå‘˜

æ ¹æ®ç»™å˜é‡æ·»åŠ çš„ä¸åŒçš„ä¿®é¥°ç¬¦ï¼ŒåŒæ ·ä¹Ÿåˆ†å‡ ç§æƒ…å†µï¼š

1.  æ™®é€šé™æ€æˆå‘˜
    
    è¿™ç§æˆå‘˜ä¸èƒ½åœ¨ç±»é‡Œè¿›è¡Œå®šä¹‰ï¼Œéœ€è¦åœ¨ç±»å¤–è¿›è¡Œå®šä¹‰ã€‚ä½†æ˜¯ä»**C++17å¼€å§‹**ï¼Œåœ¨`static`å‰é¢åŠ ä¸Š`inline`å³å¯å®ç°åœ¨ç±»å†…å®šä¹‰ã€‚åœ¨ç±»å¤–çš„å®šä¹‰è¯­æ³•ä¸ºï¼š  
    ç±»å‹ ç±»å::å˜é‡å;
    
        // .h
        class MyStaticClass
        {
        public:
            static void StaticFunc()
            {
                
            }
        
        private:
            static int StaticVar;
            inline static int InlineStaticVar = 1; 	// since C++17
        };
        
        //.cpp
        int MyStaticClass::StaticVar = 0;
        
    
2.  consté™æ€æˆå‘˜
    
    å¦‚æœä¸€ä¸ªæ•´å½¢å˜é‡æˆ–è€…æšä¸¾ç±»å‹å˜é‡ç”¨constè¿›è¡Œä¿®é¥°æ—¶ï¼Œå…¶èƒ½å¤Ÿç›´æ¥åœ¨ç±»ä¸­è¿›è¡Œå®šä¹‰ã€‚å¦‚æœ LiteralType çš„é™æ€æ•°æ®æˆå‘˜å£°æ˜ä¸º constexprï¼Œåˆ™å¿…é¡»åœ¨ç±»å®šä¹‰ä¸­ä½¿ç”¨åˆå§‹åŒ–å™¨å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆå§‹åŒ–å™¨ä¸­çš„æ¯ä¸ªè¡¨è¾¾å¼éƒ½æ˜¯å¸¸é‡è¡¨è¾¾å¼ã€‚
    
        struct X
        {
            const static int n = 1;
            const static int m{2}; // since C++11
            const static int k;
        };
        
    

##### å¦‚ä½•ä½¿ç”¨é™æ€æˆå‘˜

è®¿é—®ç±»çš„é™æ€æˆå‘˜æœ‰ä¸¤ç§æ–¹å¼ï¼š

1.  é€šè¿‡é™å®šç¬¦ï¼ˆqualifiedï¼‰
    
    `MyStaticClass::Func();`
    
2.  é€šè¿‡æˆå‘˜è®¿é—®è¡¨è¾¾å¼ï¼ˆ.ã€->ï¼‰
    
    `MyStaticClass().Func();`
    

æœ€å
--

é€šè¿‡ä¸€æ­¥ä¸€æ­¥çš„å¯¹æ‰€å†™çš„ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘ä»¬æœ€åå®ç°äº†æ¯”è¾ƒå®Œç¾çš„å•ä¾‹ï¼šä»£ç ç®€å•ã€çº¿ç¨‹å®‰å…¨ã€ç”¨æ—¶åˆå§‹åŒ–ï¼Œè¿™éƒ½æ˜¯è¿™ä¸ªå•ä¾‹çš„ä¼˜ç‚¹ã€‚å¸Œæœ›çœ‹åˆ°è¿™é‡Œï¼Œå„ä½çœ‹å®˜æœ‹å‹èƒ½å¤Ÿæœ‰æ‰€æ”¶è·ï¼Œè°¢è°¢ã€‚

> åˆ›ä½œä¸æ˜“ï¼Œå¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œçƒ¦è¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨æ”¯æŒä¸€ä¸‹ï¼Œä¹Ÿæ¬¢è¿å„ä½å¤§ä½¬æŒ‡ç‚¹ï¼Œè°¢è°¢ã€‚

å‚è€ƒ
--

1.  [Storage class specifiers - cppreference.com](https://en.cppreference.com/w/cpp/language/storage_duration)
2.  [static members - cppreference.com](https://en.cppreference.com/w/cpp/language/static)
3.  [ç±»çš„ç§æœ‰privateæ„é€ å‡½æ•° ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åš - onewayheaven - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/oneway1990/p/9015392.html)
4.  [c++ - How static function is accessing private member function(constructor) of a class - Stack Overflow](https://stackoverflow.com/questions/40721770/how-static-function-is-accessing-private-member-functionconstructor-of-a-class)
5.  [Initialization - cppreference.com](https://en.cppreference.com/w/cpp/language/initialization)
6.  [C++11å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼(ä½¿ç”¨std::call\_once)\_c++11 çº¿ç¨‹å®‰å…¨-CSDNåšå®¢](https://blog.csdn.net/u011726005/article/details/82356538)
7.  [C++å’ŒåŒé‡æ£€æŸ¥é”å®šæ¨¡å¼(DCLP)çš„é£é™©\_dclpè®¤è¯-CSDNåšå®¢](https://blog.csdn.net/nodeathphoenix/article/details/51657973)
8.  [Compiler Memory Re-Ordering-githubio](https://coffeebeforearch.github.io/2020/11/21/compiler-memory-ordering.html)
9.  [Understanding memory reordering](https://www.internalpointers.com/post/understanding-memory-ordering)