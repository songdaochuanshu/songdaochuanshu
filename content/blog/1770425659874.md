---
layout: post
title: 'ArcGIS授权管理器断网后自动停止'
date: "2026-02-07T00:54:19Z"
---
ArcGIS授权管理器断网后自动停止
==================

问题的由来
-----

系统重装win10 22h2，重新安装ArcGIS10.2.2版本，断网启动**许可服务器管理员（LicenseManager）** 的时候无法启动，联网时该软件自动启动了，断网时又自动停止了。

### 排查

查看lmgrd9.log没啥问题，->**授权**\->**机器ID**，得到以下的异常标识。

![image](https://img2024.cnblogs.com/blog/1410060/202602/1410060-20260206160653610-505996147.png)

*   异常的机器ID

    下面列出了此计算机的主机标识符:
    
    MAC 地址: xxxxxxxxx
    主机名: DESKTOP-7E9QMGD
    IP 地址: ::1
    域: DESKTOP-7E9QMGD
    UMN 2: xxxxxxxxxxxxxxxxxxxxxxx
    

重新连接WIFI后，查看到正常的表示：

*   正常的机器ID

    下面列出了此计算机的主机标识符:
    
    MAC 地址: xxxxxxxxx
    主机名: DESKTOP-7E9QMGD
    IP 地址: 192.168.9.56
    域: DESKTOP-7E9QMGD
    UMN 2: xxxxxxxxxxxxxxxxxxxxxxx
    

甄别与修复
-----

### 可能出现的异常及尝试

*   首先排查了Hosts文件，不存在localhost被解析到::1这个ipv6中内容
*   调整ipv4和ipv6顺序，使断网情况下有限回环到127.0.0.1，使得ip有可用值。调整后，许可服务器管理员断网状态获取的IP依旧是::1回环地址
*   自行组建局域网，使得有IP地址。

使用大模型进行检索：

    断网后ArcGIS License Manager获取IP时出现以下的log：下面列出了此计算机的主机标识符:
    
    MAC 地址: xxxxxxxxx
    主机名: DESKTOP-7E9QMGD
    IP 地址: ::1
    域: DESKTOP-7E9QMGD
    UMN 2: xxxxxxxxxxxxxxxxxxxxxxx
    
    

*   简单说：断网后，你的电脑没有真实的物理网络 IP，License Manager 只能检测到系统默认的本地回环地址 ::1，这会导致许可验证失败（因为许可文件绑定的是物理网卡的真实 IP/MAC）。

**断网时出现该问题的核心原因**

*   ArcGIS License Manager 验证许可时，会优先读取物理网卡的真实 IP 地址（如 192.168.1.100），但断网后：

1.  物理网卡（以太网、WiFi）处于「未连接」状态，系统不会分配真实 IP；
2.  系统会默认使用「回环适配器」的 IP（::1 或 127.0.0.1）作为本机唯一可用 IP；
3.  许可文件中绑定的是你联网时的物理网卡 IP/MAC，与断网时的回环地址不匹配，导致验证失败。

**解决方案：断网时让 License Manager 读取到「虚拟 IP」**\*  
要解决这个问题，核心是给电脑添加一个始终存在的「虚拟网卡」，让 License Manager 无论是否断网，都能读取到固定的真实 IP（而非回环地址）。

### 有效的解决办法

*   方法一：安装「Microsoft 环回适配器」

![image](https://img2024.cnblogs.com/blog/1410060/202602/1410060-20260206160628370-802218261.png)

1.  这是 Windows 自带的虚拟网卡工具，安装后会生成一个虚拟物理网卡，断网时也能分配固定 IP，完美适配 ArcGIS License Manager。
2.  操作步骤（Windows 10/11 通用）：
3.  打开「设备管理器」：按下 Win+X，选择「设备管理器」；
4.  添加过时硬件：点击设备管理器顶部的「操作」→「添加过时硬件」；
5.  启动硬件安装向导：
6.  选择「下一步」→ 选择「安装我手动从列表选择的硬件（高级）」→「下一步」；
7.  下拉列表找到「网络适配器」→「下一步」；
8.  选择环回适配器：
9.  左侧厂商选择「Microsoft」，右侧型号选择「Microsoft KM-TEST 环回适配器」→「下一步」；
10.  继续点击「下一步」，完成安装（等待几秒，系统会自动配置）；
11.  给虚拟网卡分配固定 IP：
12.  打开「控制面板→网络和共享中心→更改适配器设置」；
13.  找到刚安装的「以太网 2」（名称可能不同，带「环回」标识），右键「属性」；
14.  双击「Internet 协议版本 4 (TCP/IPv4)」；
15.  选择「使用下面的 IP 地址」，输入固定 IP（如 192.168.100.100），子网掩码填 255.255.255.0，网关留空；
16.  点击「确定」保存；
17.  重启 ArcGIS License Manager 服务：
18.  按下 Win+R，输入 services.msc 打开服务列表；
19.  找到「ArcGIS License Manager」，右键「重启」；
20.  验证效果：重新打开 License Server Administrator，查看主机标识符，IP 地址会显示为你设置的 192.168.100.100（而非 ::1），许可验证即可恢复正常。

*   方法二：临时启用「虚拟 WiFi / 热点」  
    断网状态下，无法通过\[热点\]图标、按钮开启热点，需要使用powershell命令，以管理员身份开启powershell命令行，键入：

    # 注册热点配置
    $connectionProfile = [Windows.Networking.Connectivity.NetworkInformation,Windows.Networking.Connectivity,ContentType=WindowsRuntime]::GetInternetConnectionProfile()
    $tetheringManager = [Windows.Networking.NetworkOperators.NetworkOperatorTetheringManager,Windows.Networking.NetworkOperators,ContentType=WindowsRuntime]::CreateFromConnectionProfile($connectionProfile)
    
    # 启动热点
    $tetheringManager.StartTetheringAsync()
    
    # 停止热点
    $tetheringManager.StopTetheringAsync()