---
layout: post
title: 'å…³äº MicroPython + ESP32-S3 çš„ä½¿ç”¨æµç¨‹'
date: "2026-02-22T00:58:35Z"
---
å…³äº MicroPython + ESP32-S3 çš„ä½¿ç”¨æµç¨‹
===============================

å¥½çš„ï¼æˆ‘æ¥å¸®ä½ ä»é›¶å¼€å§‹å®Œæ•´æ¢³ç† **MicroPython + ESP32-S3** çš„å¼€å‘æµç¨‹ã€‚

ğŸ“‹ **å®Œæ•´æ­å»ºæµç¨‹**
-------------

### **ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ**

#### 1.1 ç¡¬ä»¶å‡†å¤‡

*   âœ… ESP32-S3 å¼€å‘æ¿
*   âœ… USB æ•°æ®çº¿ï¼ˆæœ€å¥½å¸¦æ•°æ®ä¼ è¾“åŠŸèƒ½ï¼‰
*   âœ… Windowsç”µè„‘

#### 1.2 è½¯ä»¶å‡†å¤‡

    # 1. å®‰è£… Pythonï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
    # è®¿é—® https://www.python.org/downloads/ ä¸‹è½½å®‰è£…
    # å®‰è£…æ—¶å‹¾é€‰ "Add Python to PATH"
    
    # 2. éªŒè¯Pythonå®‰è£…
    python --version
    
    # 3. å®‰è£… esptoolï¼ˆåˆ·å†™å·¥å…·ï¼‰
    pip install esptool
    
    # 4. å®‰è£…ä¸²å£é©±åŠ¨ï¼ˆæ ¹æ®ä½ çš„å¼€å‘æ¿ï¼‰
    # CP210xé©±åŠ¨ï¼šhttps://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers
    # CH340é©±åŠ¨ï¼šhttp://www.wch.cn/download/CH341SER_EXE.html
    

### **ç¬¬äºŒæ­¥ï¼šä¸‹è½½å›ºä»¶**

#### 2.1 ä¸‹è½½ MicroPython å›ºä»¶

*   å®˜æ–¹ä¸‹è½½åœ°å€ï¼š[https://micropython.org/download/](https://micropython.org/download/)
*   é€‰æ‹© **ESP32S3** æˆ– **GENERIC\_S3**
*   ä¸‹è½½ `.bin` æ–‡ä»¶ï¼ˆä½ å·²ç»æœ‰ï¼š`ESP32_GENERIC_S3-20251209-v1.27.0.bin`ï¼‰

### **ç¬¬ä¸‰æ­¥ï¼šåˆ·å†™å›ºä»¶**

#### 3.1 è¿æ¥å¼€å‘æ¿

1.  ç”¨USBçº¿è¿æ¥ESP32-S3åˆ°ç”µè„‘
2.  æŒ‰ä½å¼€å‘æ¿ä¸Šçš„ **BOOT** æŒ‰é’®
3.  æŒ‰ä¸€ä¸‹ **RESET** æŒ‰é’®ï¼ˆæˆ–é‡æ–°æ’æ‹”USBï¼‰
4.  æ¾å¼€ **BOOT** æŒ‰é’®
5.  æ­¤æ—¶å¼€å‘æ¿è¿›å…¥åˆ·å†™æ¨¡å¼

#### 3.2 æŸ¥æ‰¾ä¸²å£å·

    # æŸ¥çœ‹å¯ç”¨çš„ä¸²å£
    python -m serial.tools.list_ports
    # æˆ–æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨æŸ¥çœ‹ "ç«¯å£(COMå’ŒLPT)"
    # é€šå¸¸æ˜¾ç¤ºä¸º COM3ã€COM4 ç­‰
    

#### 3.3 æ“¦é™¤Flashï¼ˆé‡è¦ï¼ï¼‰

    # æ›¿æ¢ COM4 ä¸ºä½ çš„å®é™…ç«¯å£
    python -m esptool --chip esp32s3 --port COM4 erase_flash
    

#### 3.4 åˆ·å†™å›ºä»¶

    # æ³¨æ„ä¿®æ”¹è·¯å¾„å’Œç«¯å£
    python -m esptool --chip esp32s3 --port COM4 write_flash 0x0 "C:\Users\16673\Desktop\ESP32_GENERIC_S3-20251209-v1.27.0.bin"
    

### **ç¬¬å››æ­¥ï¼šå®‰è£…å¼€å‘ç¯å¢ƒ**

#### 4.1 å®‰è£… Thonny IDEï¼ˆæ¨èæ–°æ‰‹ï¼‰

1.  ä¸‹è½½åœ°å€ï¼š[https://thonny.org/](https://thonny.org/)
2.  å®‰è£…åæ‰“å¼€
3.  é…ç½®ï¼š
    *   èœå•æ ï¼šè¿è¡Œ â†’ é€‰æ‹©è§£é‡Šå™¨
    *   é€‰æ‹© **MicroPython (ESP32)**
    *   ç«¯å£é€‰æ‹© **COM4**ï¼ˆæˆ–ä½ çš„ç«¯å£ï¼‰

#### 4.2 æˆ–å®‰è£…å‘½ä»¤è¡Œå·¥å…·

    # å®‰è£… ampyï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰
    pip install adafruit-ampy
    
    # å®‰è£… rshellï¼ˆäº¤äº’å¼shellï¼‰
    pip install rshell
    
    # å®‰è£… picocom/mRemoteNGï¼ˆä¸²å£å·¥å…·ï¼‰
    

### **ç¬¬äº”æ­¥ï¼šæµ‹è¯•è¿æ¥**

#### 5.1 ä½¿ç”¨ Thonny æµ‹è¯•

    # åœ¨Thonnyçš„Shellä¸­çœ‹åˆ° >>> æç¤ºç¬¦åè¾“å…¥ï¼š
    print("Hello ESP32-S3!")
    
    # æŸ¥çœ‹å›ºä»¶ä¿¡æ¯
    import sys
    print(sys.version)
    print(sys.implementation)
    

#### 5.2 ä½¿ç”¨å‘½ä»¤è¡Œæµ‹è¯•

    # ä½¿ç”¨ rshell è¿æ¥
    rshell -p COM4
    
    # æˆ–åœ¨Pythonä¸­ç›´æ¥è¿æ¥
    python
    >>> import serial
    >>> ser = serial.Serial('COM4', 115200)
    >>> ser.write(b'\r\n')
    >>> ser.readline()
    

### **ç¬¬å…­æ­¥ï¼šåŸºç¡€ç¤ºä¾‹ä»£ç **

#### 6.1 ç¬¬ä¸€ä¸ªç¨‹åºï¼šLEDé—ªçƒ

    # main.py - ä¿å­˜åˆ°ESP32ä¸Šä¼šè‡ªåŠ¨è¿è¡Œ
    from machine import Pin
    import time
    
    # ESP32-S3 æ¿è½½LEDé€šå¸¸åœ¨å¼•è„š 48ï¼ˆä¸åŒæ¿å­å¯èƒ½ä¸åŒï¼‰
    led = Pin(48, Pin.OUT)
    
    while True:
        led.value(1)  # ç‚¹äº®
        time.sleep(0.5)
        led.value(0)  # ç†„ç­
        time.sleep(0.5)
    

#### 6.2 ä¸Šä¼ ä»£ç åˆ°ESP32

    # ä½¿ç”¨ ampy ä¸Šä¼ 
    ampy --port COM4 put main.py
    
    # æˆ–ä½¿ç”¨ Thonnyï¼š
    # æ–‡ä»¶ â†’ ä¿å­˜ â†’ MicroPythonè®¾å¤‡
    

### **ç¬¬ä¸ƒæ­¥ï¼šè¿›é˜¶åŠŸèƒ½**

#### 7.1 WiFiè¿æ¥

    # wifi_connect.py
    import network
    import time
    
    def connect_wifi(ssid, password):
        wlan = network.WLAN(network.STA_IF)
        wlan.active(True)
        
        if not wlan.isconnected():
            print('æ­£åœ¨è¿æ¥WiFi...')
            wlan.connect(ssid, password)
            
            # ç­‰å¾…è¿æ¥
            timeout = 10
            while not wlan.isconnected() and timeout > 0:
                time.sleep(1)
                timeout -= 1
                print(f'ç­‰å¾…ä¸­... {timeout}s')
        
        if wlan.isconnected():
            print('WiFiè¿æ¥æˆåŠŸï¼')
            print('IPåœ°å€:', wlan.ifconfig()[0])
            return True
        else:
            print('WiFiè¿æ¥å¤±è´¥ï¼')
            return False
    
    # ä½¿ç”¨
    connect_wifi('ä½ çš„WiFiåç§°', 'ä½ çš„WiFiå¯†ç ')
    

#### 7.2 WebæœåŠ¡å™¨ç¤ºä¾‹

    # webserver.py
    import socket
    import network
    
    # è¿æ¥WiFiï¼ˆæ¥ä¸Šé¢çš„ä»£ç ï¼‰
    connect_wifi('ä½ çš„WiFi', 'ä½ çš„å¯†ç ')
    
    # åˆ›å»ºç®€å•çš„WebæœåŠ¡å™¨
    addr = socket.getaddrinfo('0.0.0.0', 80)[0][-1]
    s = socket.socket()
    s.bind(addr)
    s.listen(1)
    
    print('æœåŠ¡å™¨åœ°å€:', addr)
    
    while True:
        cl, addr = s.accept()
        print('å®¢æˆ·ç«¯è¿æ¥:', addr)
        
        request = cl.recv(1024)
        print('è¯·æ±‚å†…å®¹:', request)
        
        # å‘é€HTTPå“åº”
        response = """HTTP/1.1 200 OK
    Content-Type: text/html
    
    <html>
    <head><title>ESP32-S3</title></head>
    <body>
    <h1>Hello from ESP32-S3!</h1>
    <p>MicroPython Web Server</p>
    </body>
    </html>
    """
        cl.send(response)
        cl.close()
    

#### 7.3 è¯»å–ä¼ æ„Ÿå™¨

    # sensor.py
    from machine import Pin, ADC
    import time
    
    # è¯»å–æ¨¡æ‹Ÿå€¼ï¼ˆADCï¼‰
    adc = ADC(Pin(4))  # ä½¿ç”¨GPIO4ä½œä¸ºADC
    adc.atten(ADC.ATTN_11DB)  # è®¾ç½®é‡ç¨‹ 0-3.3V
    
    while True:
        # è¯»å–æ•°å­—å€¼ (0-4095)
        value = adc.read()
        
        # è½¬æ¢ä¸ºç”µå‹
        voltage = value * 3.3 / 4095
        
        print(f'ADCå€¼: {value}, ç”µå‹: {voltage:.2f}V')
        time.sleep(1)
    

### **ç¬¬å…«æ­¥ï¼šå®ç”¨æŠ€å·§**

#### 8.1 å¼€æœºè‡ªåŠ¨è¿è¡Œ

*   å°†ä¸»ç¨‹åºä¿å­˜ä¸º **main.py** åˆ°ESP32
*   é‡å¯å¼€å‘æ¿ä¼šè‡ªåŠ¨è¿è¡Œ

#### 8.2 é‡Šæ”¾å†…å­˜

    import gc
    gc.collect()  # æ‰‹åŠ¨åƒåœ¾å›æ”¶
    gc.mem_free()  # æŸ¥çœ‹å‰©ä½™å†…å­˜
    

#### 8.3 æ–‡ä»¶ç®¡ç†å‘½ä»¤

    # åˆ—å‡ºæ–‡ä»¶
    ampy --port COM4 ls
    
    # åˆ é™¤æ–‡ä»¶
    ampy --port COM4 rm main.py
    
    # ä¸‹è½½æ–‡ä»¶åˆ°ç”µè„‘
    ampy --port COM4 get main.py > backup_main.py
    

### **å¸¸è§é—®é¢˜è§£å†³**

1.  **æ— æ³•è¿æ¥COMå£**
    
    *   æ£€æŸ¥é©±åŠ¨æ˜¯å¦æ­£ç¡®å®‰è£…
    *   å°è¯•æ¢USBçº¿
    *   é‡æ–°æ’æ‹”å¼€å‘æ¿
2.  **åˆ·å†™å¤±è´¥**
    
    *   ç¡®ä¿æŒ‰ä½BOOTæŒ‰é’®
    *   å…ˆæ‰§è¡Œ erase\_flash
    *   æ£€æŸ¥ç«¯å£å·æ˜¯å¦æ­£ç¡®
3.  **ä¸Šä¼ æ–‡ä»¶å¤±è´¥**
    
    *   ç¡®ä¿å¼€å‘æ¿å·²ç»å¯åŠ¨å®Œæˆ
    *   ä¸è¦åŒæ—¶æ‰“å¼€å¤šä¸ªä¸²å£ç¨‹åº

éœ€è¦æˆ‘è¯¦ç»†è§£é‡ŠæŸä¸ªæ­¥éª¤ï¼Œæˆ–è€…æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ