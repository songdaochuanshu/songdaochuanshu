---
layout: post
title: 'æ€§èƒ½é£è·ƒï¼TensorRT-YOLO 6.0 å…¨é¢å‡çº§è§£æä¸å®æˆ˜æŒ‡å—'
date: "2025-01-29T00:35:27Z"
---
æ€§èƒ½é£è·ƒï¼TensorRT-YOLO 6.0 å…¨é¢å‡çº§è§£æä¸å®æˆ˜æŒ‡å—
==================================

**ç«‹å³ä½“éªŒ**ï¼š[GitHubä»“åº“](https://github.com/laugh12321/TensorRT-YOLO) | [ä½¿ç”¨ç¤ºä¾‹](https://github.com/laugh12321/TensorRT-YOLO/tree/main/examples) | [å¿«é€Ÿå¼€å§‹](https://github.com/laugh12321/TensorRT-YOLO/blob/main/README.md#quick-start)

### ä¸€ã€æ ¸å¿ƒå‡çº§äº®ç‚¹é€Ÿè§ˆ

#### ğŸš€ **å¤šContextå…±äº«å¼•æ“ï¼šé«˜æ•ˆæ¨ç†ï¼Œæœ€å¤§åŒ–ç¡¬ä»¶èµ„æºåˆ©ç”¨ç‡**

TensorRT-YOLO 6.0 å¼•å…¥äº†åˆ›æ–°çš„å¤šContextå…±äº«å¼•æ“æœºåˆ¶ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªEngineè¿›è¡Œæ¨ç†ï¼Œæœ€å¤§åŒ–ç¡¬ä»¶èµ„æºåˆ©ç”¨ç‡ï¼ŒåŒæ—¶æ˜¾è‘—é™ä½å†…å­˜å ç”¨ã€‚è¿™ä¸€è®¾è®¡ä½¿å¾—å¤šä»»åŠ¡å¹¶å‘æ¨ç†æ›´åŠ é«˜æ•ˆï¼Œå°¤å…¶é€‚åˆéœ€è¦åŒæ—¶å¤„ç†å¤šè·¯è§†é¢‘æµæˆ–å¤§è§„æ¨¡æ•°æ®æ¨ç†çš„åœºæ™¯ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š

*   **æƒé‡å…±äº«**ï¼šå¤šä¸ª Context å¯ä»¥å…±äº«åŒä¸€ä¸ª `ICudaEngine` çš„æ¨¡å‹æƒé‡å’Œå‚æ•°ï¼Œè¿™æ„å‘³ç€åœ¨å†…å­˜æˆ–æ˜¾å­˜ä¸­ä»…ä¿ç•™ä¸€ä»½å‰¯æœ¬ï¼Œå¤§å¤§å‡å°‘äº†å†…å­˜å ç”¨ã€‚
*   **æ˜¾å­˜ä¼˜åŒ–**ï¼šå°½ç®¡æ¯ä¸ª Context éœ€è¦ä¸ºè¾“å…¥è¾“å‡ºåˆ†é…ç‹¬ç«‹çš„æ˜¾å­˜ç¼“å†²åŒºï¼Œä½†æ•´ä½“æ˜¾å­˜å ç”¨å¹¶ä¸ä¼šçº¿æ€§å¢åŠ ï¼Œä»è€Œä¼˜åŒ–äº†èµ„æºåˆ©ç”¨ã€‚
*   **å¤šçº¿ç¨‹æ¨ç†**ï¼šå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶ä½¿ç”¨åŒä¸€ä¸ª `ICudaEngine`ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ›å»ºè‡ªå·±çš„ `IExecutionContext`ï¼Œç‹¬ç«‹åœ°è¿›è¡Œæ¨ç†ï¼Œå……åˆ†åˆ©ç”¨ GPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ã€‚

#### ğŸ“Š æ˜¾å­˜å ç”¨å¯¹æ¯”æµ‹è¯•

æ¨¡å‹å®ä¾‹æ•°

å…‹éš†æ¨¡å¼

åŸç”Ÿæ¨¡å¼

èµ„æºèŠ‚çœç‡

1

408MB

408MB

\-

2

536MB

716MB

25.1%

3

662MB

1092MB

39.4%

4

790MB

1470MB

46.3%

> **æµ‹è¯•ç¯å¢ƒ**ï¼šAMD Ryzen7 5700X + RTX2080Ti 22GB + YOLO11x

### ğŸ’¾ **æ˜¾å­˜ç®¡ç†ä¼˜åŒ–ï¼šä¸‰å¤§æ¨¡å¼ç²¾å‡†é€‚é…ï¼Œé‡Šæ”¾ç¡¬ä»¶æ½œèƒ½**

TensorRT-YOLO 6.0 åœ¨æ˜¾å­˜ç®¡ç†æ–¹é¢è¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ï¼ŒåŸºäº **BaseBuffer** åŸºç±»è®¾è®¡äº†ä¸‰ç§å†…å­˜ç®¡ç†æ¨¡å¼ï¼Œç²¾å‡†é€‚é…ä¸åŒç¡¬ä»¶å¹³å°å’Œåº”ç”¨åœºæ™¯ï¼Œæœ€å¤§åŒ–é‡Šæ”¾ç¡¬ä»¶æ€§èƒ½æ½œåŠ›ã€‚ç¨‹åºèƒ½å¤Ÿè‡ªåŠ¨åˆ¤æ–­ç¡¬ä»¶ç±»å‹ï¼Œé»˜è®¤é€‰æ‹©æœ€ä¼˜æ¨¡å¼ï¼ŒåŒæ—¶æ”¯æŒæ‰‹åŠ¨é…ç½®ï¼Œæ»¡è¶³å¤šæ ·åŒ–éœ€æ±‚ã€‚

#### ğŸ“Š ä¸‰å¤§æ˜¾å­˜ç®¡ç†æ¨¡å¼å¯¹æ¯”

DiscreteBuffer

MappedBuffer

UnifiedBuffer

**é€‚ç”¨åœºæ™¯**

ğŸ–¥ï¸ æ¡Œé¢GPU

ğŸ“± è¾¹ç¼˜è®¾å¤‡

âš™ï¸ ç”¨æˆ·æ˜¾å¼é…ç½®

**è§¦å‘æ¡ä»¶**

è‡ªåŠ¨é€‰æ‹©

è‡ªåŠ¨é€‰æ‹©

`enable_managed_memory()`

**æ ¸å¿ƒæŠ€æœ¯**

PCIeæ˜¾å¼æ‹·è´

Zero-Copy

CUDAç»Ÿä¸€å†…å­˜

**å†…å­˜æ•ˆç‡**

é«˜ååé‡

è¶…ä½å»¶è¿Ÿ

çµæ´»å¹³è¡¡

#### âš™ï¸ æ™ºèƒ½åˆ‡æ¢é€»è¾‘

graph TD A\[æ£€æµ‹ç¡¬ä»¶ç±»å‹\] --> B{GPUç±»å‹?} B -->|æ¡Œé¢GPU| C\[é»˜è®¤å¯ç”¨DiscreteBuffer\] B -->|åµŒå…¥å¼GPU| D\[é»˜è®¤å¯ç”¨MappedBuffer\] C --> E{ç”¨æˆ·å¼ºåˆ¶é…ç½®?} D --> E E -->|æ˜¯| F\[å¼ºåˆ¶åˆ‡æ¢UnifiedBuffer\] E -->|å¦| G\[ä¿æŒé»˜è®¤æ¨¡å¼\]

### ğŸ›ï¸ **æ¨ç†é…ç½®è‡ªç”±å®šåˆ¶ï¼šçµæ´»é€‚é…å¤šæ ·åŒ–åœºæ™¯**

TensorRT-YOLO 6.0 é€šè¿‡ **InferOption** ç»“æ„ä½“ä¸ºå¼€å‘è€…æä¾›é«˜åº¦çµæ´»çš„æ¨ç†é…ç½®èƒ½åŠ›ï¼Œæ”¯æŒå¤šç»´åº¦å‚æ•°è°ƒä¼˜ã€‚ä»¥ä¸‹é€šè¿‡ **å›¾æ–‡ç»“åˆ** å’Œ **ç»“æ„åŒ–å±•ç¤º** ç›´è§‚å‘ˆç°æ ¸å¿ƒåŠŸèƒ½ï¼š

åŠŸèƒ½åˆ†ç±»

é…ç½®é¡¹

ä½œç”¨æè¿°

**ç¡¬ä»¶èµ„æºç®¡ç†**

âš™ï¸ `set_device_id(id)`

æŒ‡å®šæ¨ç†ä»»åŠ¡è¿è¡Œçš„ GPU è®¾å¤‡ IDï¼Œç¡®ä¿ä»»åŠ¡åœ¨æŒ‡å®šè®¾å¤‡ä¸Šæ‰§è¡Œã€‚

**å†…å­˜ä¼˜åŒ–**

ğŸ’¾ `enable_cuda_memory()`

å½“æ¨ç†æ•°æ®å·²å­˜å‚¨åœ¨ CUDA å†…å­˜ä¸­æ—¶ï¼Œç›´æ¥å¤ç”¨æ•°æ®ï¼Œé¿å…é¢å¤–çš„æ•°æ®ä¼ è¾“å¼€é”€ï¼Œæå‡æ¨ç†æ•ˆç‡ã€‚

ğŸŒ `enable_managed_memory()`

å¯ç”¨ CUDA ç»Ÿä¸€å†…å­˜ç®¡ç†ï¼Œä¼˜åŒ–ä¸»æœºä¸æ˜¾å­˜é—´çš„æ•°æ®è®¿é—®æ•ˆç‡ï¼Œé™ä½å†…å­˜æ‹·è´å¼€é”€ã€‚

**æ•°æ®é¢„å¤„ç†**

ğŸ”„ `set_swap_rb()`

è‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ•°æ®çš„ RGB/BGR é€šé“é¡ºåºï¼Œé€‚é…ä¸åŒæ¡†æ¶çš„è¾“å…¥æ ¼å¼è¦æ±‚ã€‚

ğŸ“ `set_normalize_params(mean, std)`

è‡ªå®šä¹‰è¾“å…¥æ•°æ®çš„å‡å€¼ä¸æ–¹å·®å½’ä¸€åŒ–å‚æ•°ï¼Œé€‚é…éæ ‡å‡†åŒ–æ•°æ®é›†ã€‚

ğŸ–¼ï¸ `set_border_value(value)`

è®¾ç½®å›¾åƒå¡«å……çš„è¾¹ç•Œå€¼ï¼Œç¡®ä¿è¾“å…¥æ•°æ®å°ºå¯¸ç¬¦åˆæ¨¡å‹è¦æ±‚ã€‚

**æ€§èƒ½è°ƒä¼˜**

ğŸš€ `enable_performance_report()`

ç”Ÿæˆè¯¦ç»†çš„æ¨ç†è€—æ—¶æŠ¥å‘Šï¼Œä¾¿äºæ€§èƒ½åˆ†æä¸ä¼˜åŒ–ã€‚

**è¾“å…¥æ§åˆ¶**

ğŸ“ `set_input_dimensions(width, height)`

å¼ºåˆ¶æŒ‡å®šè¾“å…¥æ•°æ®çš„å®½é«˜ï¼Œé€‚ç”¨äºå›ºå®šåˆ†è¾¨ç‡ä»»åŠ¡ï¼ˆå¦‚æ¸¸æˆ AIã€ç›‘æ§è§†é¢‘åˆ†æï¼‰ã€‚

### ğŸ“¦ **æç®€éƒ¨ç½²æ¥å£ï¼šç»Ÿä¸€APIï¼Œå‘Šåˆ«é€‰æ‹©å›°éš¾ç—‡**

TensorRT-YOLO 6.0 å°†äº”å¤§ä»»åŠ¡æ¨¡å‹æ•´åˆä¸ºç›´è§‚çš„ API æ¥å£ï¼Œç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œæå‡å¼€å‘æ•ˆç‡ï¼š

ä»»åŠ¡ç±»å‹

æ–°ç‰ˆæ¥å£

æ—§ç‰ˆæ¥å£

ğŸ·ï¸ å›¾åƒåˆ†ç±»

`ClassifyModel`

`DeployCls`ã€`DeployCGyCls`

ğŸ¯ ç›®æ ‡æ£€æµ‹

`DetectModel`

`DeployDet`ã€`DeployCGDet`

ğŸŒ€ æ—‹è½¬ç›®æ ‡æ£€æµ‹

`OBBModel`

`DeployOBB`ã€`DeployCGOBB`

âœ‚ï¸ å®ä¾‹åˆ†å‰²

`SegmentModel`

`DeploySeg`ã€`DeployCGSeg`

ğŸ’ƒ å…³é”®ç‚¹æ£€æµ‹

`PoseModel`

`DeployPose`ã€`DeployCGPose`

### äºŒã€å®æˆ˜ä»£ç å…¨è§£æ

#### ğŸ Pythonç‰ˆDemo

    import cv2
    from tensorrt_yolo.infer import InferOption, DetectModel, generate_labels, visualize
    
    def main():
        # -------------------- åˆå§‹åŒ–é…ç½® --------------------
        # é…ç½®æ¨ç†è®¾ç½®
        option = InferOption()
        option.enable_swap_rb()  # å°†OpenCVé»˜è®¤çš„BGRæ ¼å¼è½¬ä¸ºRGBæ ¼å¼
        # ç‰¹æ®Šæ¨¡å‹é…ç½®ç¤ºä¾‹ï¼ˆå¦‚PP-YOLOEç³»åˆ—éœ€å–æ¶ˆä¸‹æ–¹æ³¨é‡Šï¼‰
        # option.set_normalize_params([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
    
        # -------------------- æ¨¡å‹åˆå§‹åŒ– --------------------
        # åŠ è½½TensorRTå¼•æ“æ–‡ä»¶ï¼ˆæ³¨æ„æ£€æŸ¥æ–‡ä»¶è·¯å¾„ï¼‰
        # æç¤ºï¼šé¦–æ¬¡åŠ è½½å¼•æ“å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´è¿›è¡Œä¼˜åŒ–
        model = DetectModel(engine_path="yolo11n-with-plugin.engine", 
                           option=option)
    
        # -------------------- æ•°æ®é¢„å¤„ç† --------------------
        # åŠ è½½æµ‹è¯•å›¾ç‰‡ï¼ˆå»ºè®®æ·»åŠ æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ï¼‰
        input_img = cv2.imread("test_image.jpg")
        if input_img is None:
            raise FileNotFoundError("æµ‹è¯•å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„")
    
        # -------------------- æ‰§è¡Œæ¨ç† --------------------
        # æ‰§è¡Œç›®æ ‡æ£€æµ‹ï¼ˆè¿”å›ç»“æœåŒ…å«è¾¹ç•Œæ¡†ã€ç½®ä¿¡åº¦ã€ç±»åˆ«ä¿¡æ¯ï¼‰
        detection_result = model.predict(input_img)
        print(f"==> detection_result: {detection_result}")
    
        # -------------------- ç»“æœå¯è§†åŒ– --------------------
        # åŠ è½½ç±»åˆ«æ ‡ç­¾ï¼ˆéœ€ç¡®ä¿labels.txtä¸æ¨¡å‹åŒ¹é…ï¼‰
        class_labels = generate_labels(labels_file="labels.txt")
        # ç”Ÿæˆå¯è§†åŒ–ç»“æœ
        visualized_img = visualize(
            image=input_img,
            result=detection_result,
            labels=class_labels,
        )
        cv2.imwrite("vis_image.jpg", visualized_img)
    
        # -------------------- æ¨¡å‹å…‹éš†æ¼”ç¤º --------------------
        # å…‹éš†æ¨¡å‹å®ä¾‹ï¼ˆé€‚ç”¨äºå¤šçº¿ç¨‹åœºæ™¯ï¼‰
        cloned_model = model.clone()  # åˆ›å»ºç‹¬ç«‹å‰¯æœ¬ï¼Œé¿å…èµ„æºç«äº‰
        # éªŒè¯å…‹éš†æ¨¡å‹æ¨ç†ä¸€è‡´æ€§
        cloned_result = cloned_model.predict(input_img)
        print(f"==> cloned_result: {cloned_result}")
    
    if __name__ == "__main__":
        main()
    

### âš™ï¸ C++ç‰ˆDemo

    #include <memory>
    #include <opencv2/opencv.hpp>
    
    // ä¸ºäº†æ–¹ä¾¿è°ƒç”¨ï¼Œæ¨¡å—é™¤ä½¿ç”¨CUDAã€TensorRTå¤–ï¼Œå…¶ä½™å‡ä½¿ç”¨æ ‡å‡†åº“å®ç°
    #include "deploy/model.hpp"  // åŒ…å«æ¨¡å‹æ¨ç†ç›¸å…³çš„ç±»å®šä¹‰
    #include "deploy/option.hpp"  // åŒ…å«æ¨ç†é€‰é¡¹çš„é…ç½®ç±»å®šä¹‰
    #include "deploy/result.hpp"  // åŒ…å«æ¨ç†ç»“æœçš„å®šä¹‰
    
    int main() {
        try {
            // -------------------- åˆå§‹åŒ–é…ç½® --------------------
            deploy::InferOption option;
            option.enableSwapRB();  // BGR->RGBè½¬æ¢
    
            // ç‰¹æ®Šæ¨¡å‹å‚æ•°è®¾ç½®ç¤ºä¾‹
            // const std::vector<float> mean{0.485f, 0.456f, 0.406f};
            // const std::vector<float> std{0.229f, 0.224f, 0.225f};
            // option.setNormalizeParams(mean, std);
    
            // -------------------- æ¨¡å‹åˆå§‹åŒ– --------------------
            auto detector = std::make_unique<deploy::DetectModel>(
                "yolo11n-with-plugin.engine",  // æ¨¡å‹è·¯å¾„
                option                         // æ¨ç†è®¾ç½®
            );
    
            // -------------------- æ•°æ®åŠ è½½ --------------------
            cv::Mat cv_image = cv::imread("test_image.jpg");
            if (cv_image.empty()) {
                throw std::runtime_error("æ— æ³•åŠ è½½æµ‹è¯•å›¾ç‰‡");
            }
    
            // å°è£…å›¾åƒæ•°æ®ï¼ˆä¸å¤åˆ¶åƒç´ æ•°æ®ï¼‰
            deploy::Image input_image(
                cv_image.data,     // åƒç´ æ•°æ®æŒ‡é’ˆ
                cv_image.cols,     // å›¾åƒå®½åº¦
                cv_image.rows,     // å›¾åƒé«˜åº¦
            );
    
            // -------------------- æ‰§è¡Œæ¨ç† --------------------
            deploy::DetResult result = detector->predict(input_image);
            std::cout << result << std::endl;
    
            // -------------------- ç»“æœå¯è§†åŒ–ï¼ˆç¤ºæ„ï¼‰ --------------------
            // å®é™…å¼€å‘éœ€å®ç°å¯è§†åŒ–é€»è¾‘ï¼Œç¤ºä¾‹ï¼š
            // cv::Mat vis_image = visualize_detections(cv_image, result);
            // cv::imwrite("vis_result.jpg", vis_image);
    
            // -------------------- æ¨¡å‹å…‹éš†æ¼”ç¤º --------------------
            auto cloned_detector = detector->clone();  // åˆ›å»ºç‹¬ç«‹å®ä¾‹
            deploy::DetResult cloned_result = cloned_detector->predict(input_image);
    
            // éªŒè¯ç»“æœä¸€è‡´æ€§
            std::cout << cloned_resul << std::endl;
    
        } catch (const std::exception& e) {
            std::cerr << "ç¨‹åºå¼‚å¸¸: " << e.what() << std::endl;
            return EXIT_FAILURE;
        }
        return EXIT_SUCCESS;
    }
    

### ä¸‰ã€åº”ç”¨åœºæ™¯å…¨æ™¯å±•æœ›

#### ğŸ­ å·¥ä¸šè´¨æ£€4.0è§£å†³æ–¹æ¡ˆ

*   å¾®ç§’çº§ç¼ºé™·æ£€æµ‹ï¼šåœ¨200m/sçš„äº§çº¿ä¸Šå®ç°0.1mmç²¾åº¦æ£€æµ‹
*   å¤šç›¸æœºåŒæ­¥å¤„ç†ï¼š8è·¯4Kç›¸æœºæ•°æ®å®æ—¶åˆ†æ

#### ğŸŒ† æ™ºæ…§åŸå¸‚ä¸­æ¢

*   400è·¯è§†é¢‘æµå®æ—¶åˆ†æï¼šæ”¯æŒåŸå¸‚çº§AIç›‘ç®¡
*   åŠ¨æ€èµ„æºè°ƒåº¦ï¼šæ—©æ™šé«˜å³°è‡ªåŠ¨è°ƒæ•´è®¡ç®—èµ„æº

#### ğŸš— è‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥å‡çº§

*   å¤šæ¨¡æ€æ•°æ®èåˆï¼šæ¿€å…‰é›·è¾¾+æ‘„åƒå¤´è”åˆæ¨ç†
*   å®‰å…¨å†—ä½™è®¾è®¡ï¼šåŒContextäº’éªŒæœºåˆ¶

### äº”ã€ç”Ÿæ€å»ºè®¾ï¼šå¼€å‘è€…èµ„æºå…¨æ™¯å›¾

èµ„æºç±»å‹

è·å–æ–¹å¼

åŒ…å«å†…å®¹

**æ”¯æŒæ¨¡å‹åˆ—è¡¨**

[æŸ¥çœ‹æ”¯æŒæ¨¡å‹](https://github.com/laugh12321/TensorRT-YOLO/blob/main/README.md#support-models)

æ”¯æŒ YOLOv3 è‡³ YOLOv11 å…¨ç³»åˆ—æ¨¡å‹ï¼Œä»¥åŠ PP-YOLOE å’Œ PP-YOLOE+ï¼Œæ¶µç›–ç›®æ ‡æ£€æµ‹ã€å®ä¾‹åˆ†å‰²ã€å›¾åƒåˆ†ç±»ã€å§¿æ€è¯†åˆ«ã€æ—‹è½¬ç›®æ ‡æ£€æµ‹ç­‰å¤šç§ä»»åŠ¡åœºæ™¯ã€‚

**å·¥å…·é“¾**

[è·å– Dockerfile](https://github.com/laugh12321/TensorRT-YOLO/blob/main/Dockerfile)

æä¾›ä¸€ä½“åŒ–å¼€å‘ç¯å¢ƒé•œåƒï¼Œç®€åŒ–ç¯å¢ƒé…ç½®ï¼ŒåŠ é€Ÿé¡¹ç›®å¯åŠ¨ã€‚

**ä¼ä¸šæ”¯æŒ**

é€šè¿‡é‚®ä»¶è”ç³»ï¼š[laugh12321@vip.qq.com](mailto:laugh12321@vip.qq.com)

æä¾›å®šåˆ¶åŒ– SDK ä¸æŠ€æœ¯ç™½çš®ä¹¦ï¼ŒåŠ©åŠ›ä¼ä¸šå¿«é€Ÿé›†æˆä¸éƒ¨ç½²ã€‚

**ç¤¾åŒºè®ºå›**

[åŠ å…¥è®¨è®º](https://github.com/laugh12321/TensorRT-YOLO/discussions)

å®æ—¶æŠ€æœ¯é—®ç­”ä¸æ¡ˆä¾‹åˆ†äº«ï¼Œå…±åŒè§£å†³éš¾é¢˜ï¼ŒåŠ é€Ÿé¡¹ç›®è¿›å±•ã€‚