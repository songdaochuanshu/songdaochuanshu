---
layout: post
title: 'Coze工作流实战：一键上传excel生成数据图表'
date: "2025-08-03T00:52:13Z"
---
Coze工作流实战：一键上传excel生成数据图表
=========================

### 导航

*   前言
*   工作流实现效果
*   操作步骤
*   调试
*   结语
*   Excel数据案例
*   参考

> 本文首发[《Coze工作流实战：一键上传excel生成数据图表》](https://www.52interview.com/solutions/99)，共计1500字，阅读时长3min。

前言
--

在日常工作中，数据统计是一个很常见的需求。

大部分人同学能把数据统计出来，按照各种维度汇总成为一个excel表格。

如果能再进一步，将这些数据，转化为图表，那就更加直观了。

这样的交付结果，一定也能让领导和同事眼前一亮。

今天，我们就尝试通过Coze工作流来实现excel生成数据图表!

欢迎点赞、收藏、关注。

工作流实现效果
-------

  

[![](https://img.zhikestreet.com/1754116924718-min.png)](https://img.zhikestreet.com/1754116924718-min.png)

  

### 工作流展示

  

[![](https://img.zhikestreet.com/2025-08-02_133950_185.png)](https://img.zhikestreet.com/2025-08-02_133950_185.png)

  

### 操作步骤

#### 1、创建工作流

登录扣子(coze)平台:[https://www.coze.cn/studio](https://www.coze.cn/studio)

*   选择"开发平台"->"快速开始"
*   在左侧选择"+",选择"创建应用"，给应用起一个名称，并选择"确认"
*   在左侧资源库页面右上角单击 +资源，并选择工作流。
*   设置工作流的名称与描述，并单击确认。

> 如果没有账户，可以先注册一个，coze空间已经全面开开放，免费使用。

  

[![](https://img.zhikestreet.com/20250614144143.png)](https://img.zhikestreet.com/20250614144143.png)

  

#### 2、开始节点

开始节点，作为入口。  
设置两个变量

*   input：用户输入excel表格,excel文件类型
*   chartType：期望的图表类型，支持柱状图、折线图、雷达图、饼图

> 这里的输入变量，都要求必填

  

[![](https://img.zhikestreet.com/2025-08-02_134224_353.png)](https://img.zhikestreet.com/2025-08-02_134224_353.png)

  

#### 3、Excel内容读取节点

> Notes: 这里使用的是ReadFile插件。[https://www.coze.cn/store/plugin/7379907202049572903](https://www.coze.cn/store/plugin/7379907202049572903)

*   url: Excel地址
*   sheetName: Excel的sheet页名称，不输入则读取第一个sheet页

  

[![](https://img.zhikestreet.com/2025-08-02_134808_401.png)](https://img.zhikestreet.com/2025-08-02_134808_401.png)

  

#### 4、条件判断节点

目前支持柱状图、折线图、雷达图、饼图四种类型，根据用户输入的chartType，进行判断，并输出对应的变量。

  

[![](https://img.zhikestreet.com/2025-08-02_135107_496.png)](https://img.zhikestreet.com/2025-08-02_135107_496.png)

  

Coze上的"图表大师"插件，用于生成图表，分别对应不同类型的图表生成。

#### 5、大模型\_excel转提示词节点

  

[![](https://img.zhikestreet.com/2025-08-02_135555_511.png)](https://img.zhikestreet.com/2025-08-02_135555_511.png)

  

这里分别对应：

*   大模型\_饼图数据转化
*   大模型\_柱状图数据转化
*   大模型\_折线图数据转化
*   大模型\_雷达图数据转化
*   大模型\_通用图表数据转化

这里以"大模型\_折线图数据转化"为例，输入为excel文件，输出为饼图数据提示词。

    
    ## 角色定义
    专业数据分析助手，专注于将结构化数据转化为可视化图表和可操作的业务洞察。
    
    ## 核心功能
    ### 1. 数据分析
    - **趋势分析**：识别增长/下降/波动模式
    - **关键指标**：
      - 计算月环比增长率
      - 标记峰值/谷值及出现时间
      - 统计平均值和中位数
    - **业务洞察**：提供3-5条基于数据的建议
    - **异常检测**：标注异常波动并提供可能解释
    
    ### 2. 输出结构
    - 输出符合“图表大师”标准折线图JSON结构，输出结果中要求legend=1
    {
      "data": "[45,52]",
      "legend": 1,
      "name": "营收",
      "title": "Q1-Q2营收增长15.6%",
      "xAxis": {
        "data": "[\"Q1\",\"Q2\"]",
        "name": "季度",
        "type": "category"
      },
      "yAxis": {
        "name": "营收（万元）",
        "type": "value"
      },
      "areaStyle": {
        "opacity": 1
      }
    }
    

#### 6、图表组件节点

  

[![](https://img.zhikestreet.com/2025-08-02_140546_961.png)](https://img.zhikestreet.com/2022025-08-02_140546_961.png)

  

接收大模型输出的json数据，并生成对应的图表。

#### 7、结束节点

  

[![](https://img.zhikestreet.com/2025-08-02_140832_567.png)](https://img.zhikestreet.com/2025-08-02_140832_567.png)

  

至此工作流搭建完毕。

### 调试

接下来，选择"试运行"，运行后，会生成对应的图表。  
  

[![](https://img.zhikestreet.com/202508021536.jpg)](https://img.zhikestreet.com/202508021536.jpg)

  

运行完成之后，可以从输出中查看结果。  
然后复制图片链接下即可。

### 结语

AI工作流适用于解决一些复杂问题。

这对于不会写程序的人来说，是一个可以落地的工具。

2025年，很多企业已经开始推送AI的落地应用，比如构建智能体，构建AI应用等。

当然，AI工作流还有很长的路要走，但已经可以解决很多实际问题了。

### Excel数据案例（仅供参考）

#### 饼图

渠道

销售额（万元）

天猫旗舰店

180

京东自营

120

拼多多

80

抖音直播

60

官网直销

40

#### 折线图

月份

销售额

1月

12000

2月

15000

3月

18000

4月

16000

5月

20000

6月

22000

7月

25000

8月

23000

9月

28000

10月

30000

11月

32000

12月

35000

#### 柱状图

季度

产品A

产品B

产品C

Q1

1200

800

1500

Q2

1500

950

1800

Q3

1800

1100

2000

Q4

2000

1300

2200

#### 雷达图

能力维度

员工A

员工B

员工C

满分值

沟通能力

85

90

70

100

技术能力

95

75

85

100

团队合作

80

85

90

100

创新能力

70

80

75

100

工作效率

90

70

95

100

### 参考

*   [《Coze官方文档》](https://www.coze.cn/open/docs/guides)
*   [《Coze插件商店》](https://www.coze.cn/store/plugin?cate_type=recommend&cate_value=recommend)

  

[![](https://img.zhikestreet.com/20210522-22216942.jpg)](https://www.52interview.com/solutions/99)