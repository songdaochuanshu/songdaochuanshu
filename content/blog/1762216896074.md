---
layout: post
title: 'Next.jsè·¯ç”±æ®µé…ç½®é€‰é¡¹ç¬”è®°'
date: "2025-11-04T00:41:36Z"
---
Next.jsè·¯ç”±æ®µé…ç½®é€‰é¡¹ç¬”è®°
================

å‰è¨€
--

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ›¦è¿œã€‚

æœ¬æ¥æ˜¯æƒ³å‘æ˜¨æ™šå†™å¥½çš„ starblog ç®¡ç†åå°é‡æ„æ–‡ç« çš„

ç»“æœæ‰“å¼€ blog æ‰å‘ç°å¿˜è®°æäº¤äº†ğŸ˜‚

æ‰€ä»¥å†™ä¸€ç¯‡æ–°çš„å§

æ­£å¥½æœ€è¿‘æ­£åœ¨å¤§é‡ä½¿ç”¨ Next.js

æˆ‘å‘ç°éƒ¨ç½²åçš„é¦–æ¬¡æ¸²æŸ“å¾ˆæ…¢ï¼Œæ‰æ„è¯†åˆ°ã€Œé¢„çƒ­ã€è¿™ä¸ªé—®é¢˜

å½“ç„¶è¿™æ˜¯åè¯äº†

è¿™ä¸ªæ¡†æ¶é‡Œæœ‰å¤§é‡çš„å®˜æ–¹çº¦å®š

è¿™äº›åœ¨å®˜æ–¹æ–‡æ¡£é‡Œéƒ½æœ‰çš„ï¼Œå°±æ˜¯æ¯”è¾ƒåˆ†æ•£ï¼Œæœ¬æ–‡ä¸»è¦æ˜¯æ¦‚æ‹¬ä¸€ä¸‹è¿™äº›çº¦å®š

Next.jsæ¡†æ¶æ›´æ–°å¾—å¾ˆå¿«ï¼Œä¸ä¸€æ ·çš„åœ°æ–¹ä»¥å®˜æ–¹æ–‡æ¡£ä¸ºä¸»ã€‚

ç¼“å­˜å’Œæ¸²æŸ“ç›¸å…³
-------

    // æ§åˆ¶é¡µé¢é‡æ–°éªŒè¯çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰
    export const revalidate = 60; // 60ç§’åé‡æ–°éªŒè¯
    export const revalidate = 0;  // ç¦ç”¨ç¼“å­˜
    export const revalidate = false; // æ°¸ä¹…ç¼“å­˜
    
    // æ§åˆ¶é¡µé¢çš„æ¸²æŸ“æ¨¡å¼
    export const dynamic = 'auto';          // é»˜è®¤ï¼Œè‡ªåŠ¨é€‰æ‹©
    export const dynamic = 'force-dynamic'; // å¼ºåˆ¶åŠ¨æ€æ¸²æŸ“
    export const dynamic = 'force-static';  // å¼ºåˆ¶é™æ€æ¸²æŸ“
    export const dynamic = 'error';         // å¦‚æœä½¿ç”¨åŠ¨æ€å‡½æ•°åˆ™æŠ¥é”™
    
    // æ§åˆ¶åŠ¨æ€æ®µçš„è¡Œä¸º
    export const dynamicParams = true;  // å…è®¸åŠ¨æ€å‚æ•°ï¼ˆé»˜è®¤ï¼‰
    export const dynamicParams = false; // ä¸å…è®¸åŠ¨æ€å‚æ•°
    

è¿è¡Œæ—¶é…ç½®
-----

    // æŒ‡å®šè¿è¡Œæ—¶ç¯å¢ƒ
    export const runtime = 'nodejs';    // Node.js è¿è¡Œæ—¶ï¼ˆé»˜è®¤ï¼‰
    export const runtime = 'edge';      // Edge è¿è¡Œæ—¶
    
    // è®¾ç½®æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
    export const maxDuration = 30; // æœ€å¤šæ‰§è¡Œ30ç§’
    

è·å–æ•°æ®ç›¸å…³
------

    // æ§åˆ¶ fetch è¯·æ±‚çš„ç¼“å­˜è¡Œä¸º
    export const fetchCache = 'auto';           // é»˜è®¤ç¼“å­˜è¡Œä¸º
    export const fetchCache = 'default-cache';  // é»˜è®¤ç¼“å­˜
    export const fetchCache = 'only-cache';     // åªä½¿ç”¨ç¼“å­˜
    export const fetchCache = 'force-cache';    // å¼ºåˆ¶ç¼“å­˜
    export const fetchCache = 'default-no-store'; // é»˜è®¤ä¸ç¼“å­˜
    export const fetchCache = 'only-no-store';  // åªå…è®¸ä¸ç¼“å­˜
    export const fetchCache = 'force-no-store'; // å¼ºåˆ¶ä¸ç¼“å­˜
    

å…ƒæ•°æ®å’ŒSEO
-------

### å…ƒæ•°æ®

åŠ¨æ€ç”Ÿæˆå…ƒæ•°æ®

    import type { Metadata } from 'next'
    
    export async function generateMetadata({ params }: { params: { slug: string } }): Promise<Metadata> {
      // æ ¹æ®åŠ¨æ€å‚æ•°è·å–æ•°æ®
      const post = await getPost(params.slug)
      
      return {
        title: post.title,
        description: post.description,
        openGraph: {
          title: post.title,
          description: post.description,
          images: [post.image],
        },
      }
    }
    

å®šä¹‰é™æ€å…ƒæ•°æ®

    // é™æ€å…ƒæ•°æ®
    export const metadata: Metadata = {
      title: 'My Page',
      description: 'This is my page description',
      keywords: ['next.js', 'react', 'typescript'],
      openGraph: {
        title: 'My Page',
        description: 'This is my page description',
      },
    }
    

#### ä½¿ç”¨åœºæ™¯

é™æ€ Metadata é€‚ç”¨äºï¼š

*   å†…å®¹å›ºå®šçš„é¡µé¢ï¼ˆå¦‚å…³äºæˆ‘ä»¬ã€è”ç³»æˆ‘ä»¬ï¼‰
*   ä¸éœ€è¦æ ¹æ®è·¯ç”±å‚æ•°å˜åŒ–çš„é¡µé¢
*   ç®€å•çš„é™æ€é¡µé¢

åŠ¨æ€ Metadata é€‚ç”¨äºï¼š

*   åšå®¢æ–‡ç« è¯¦æƒ…é¡µï¼ˆæ ¹æ®æ–‡ç«  slug è·å–æ ‡é¢˜ã€æè¿°ï¼‰
*   äº§å“è¯¦æƒ…é¡µï¼ˆæ ¹æ®äº§å“ ID è·å–ä¿¡æ¯ï¼‰
*   ç”¨æˆ·ä¸ªäººèµ„æ–™é¡µï¼ˆæ ¹æ®ç”¨æˆ· ID è·å–ä¿¡æ¯ï¼‰
*   ä»»ä½•éœ€è¦æ ¹æ®è·¯ç”±å‚æ•°æˆ–å¤–éƒ¨æ•°æ®åŠ¨æ€ç”Ÿæˆ metadata çš„é¡µé¢

### é™æ€å‚æ•°

    // ç”Ÿæˆé™æ€å‚æ•°ï¼ˆç”¨äºåŠ¨æ€è·¯ç”±ï¼‰
    export async function generateStaticParams() {
      return [
        { slug: 'post-1' },
        { slug: 'post-2' },
      ];
    }
    

å¸¸ç”¨ç»„åˆç¤ºä¾‹
------

### å®Œå…¨é™æ€é¡µé¢

    export const dynamic = 'force-static';
    export const revalidate = false;
    

### å®æ—¶åŠ¨æ€é¡µé¢

    export const dynamic = 'force-dynamic';
    export const revalidate = 0;
    

### å®šæ—¶æ›´æ–°é¡µé¢

    export const revalidate = 3600; // æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡
    

### Edge è¿è¡Œæ—¶ä¼˜åŒ–

    export const runtime = 'edge';
    export const dynamic = 'force-dynamic';
    

### API è·¯ç”±é…ç½®

    // åœ¨ API è·¯ç”±ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨
    export const runtime = 'edge';
    export const maxDuration = 10;
    

ä½¿ç”¨åœºæ™¯å»ºè®®
------

é…ç½®

**é€‚ç”¨åœºæ™¯**

revalidate = 0

å®æ—¶æ•°æ®å±•ç¤ºï¼Œå¦‚è‚¡ç¥¨ä»·æ ¼ã€èŠå¤©åº”ç”¨

revalidate = 60

å®šæœŸæ›´æ–°çš„å†…å®¹ï¼Œå¦‚æ–°é—»ã€åšå®¢

dynamic = 'force-static'

å®Œå…¨é™æ€çš„é¡µé¢ï¼Œå¦‚å…³äºæˆ‘ä»¬

dynamic = 'force-dynamic'

ä¸ªæ€§åŒ–å†…å®¹ï¼Œå¦‚ç”¨æˆ·ä»ªè¡¨æ¿

runtime = 'edge'

éœ€è¦ä½å»¶è¿Ÿçš„å…¨çƒåˆ†å‘

fetchCache = 'force-no-store'

æ•æ„Ÿæ•°æ®ï¼Œä¸å…è®¸ç¼“å­˜

æ³¨æ„äº‹é¡¹
----

1.  åªèƒ½åœ¨é¡µé¢æˆ–å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨ ï¼šè¿™äº›é…ç½®åªåœ¨ page.tsx ã€ layout.tsx æˆ– route.ts æ–‡ä»¶ä¸­æœ‰æ•ˆ
2.  è¿™äº›é…ç½®é€‰é¡¹åªèƒ½åœ¨ Server Component Pagesã€Layouts æˆ– Route Handlers ä¸­ä½¿ç”¨
3.  å¿…é¡»æ˜¯å…·åå¯¼å‡º ï¼šå¿…é¡»ä½¿ç”¨ export const è¯­æ³•
4.  é…ç½®å€¼å¿…é¡»æ˜¯ é™æ€å¯åˆ†æçš„ ï¼ˆä¾‹å¦‚ revalidate = 600 æœ‰æ•ˆï¼Œä½† revalidate = 60 \* 10 æ— æ•ˆï¼‰
5.  ç±»å‹å®‰å…¨ ï¼šTypeScript ä¼šæ£€æŸ¥è¿™äº›é…ç½®çš„ç±»å‹
6.  ä¼˜å…ˆçº§ ï¼šå­è·¯ç”±çš„é…ç½®ä¼šè¦†ç›–çˆ¶è·¯ç”±çš„é…ç½®

è¿™äº›é…ç½®é€‰é¡¹è®© Next.js èƒ½å¤Ÿç²¾ç¡®æ§åˆ¶æ¯ä¸ªé¡µé¢çš„æ¸²æŸ“å’Œç¼“å­˜è¡Œä¸ºï¼Œæ˜¯ App Router æ¶æ„çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€

å®˜æ–¹æ–‡æ¡£
----

Route Segment Configï¼ˆè·¯ç”±æ®µé…ç½®ï¼‰

*   æœ€æ–°ç‰ˆæœ¬ ï¼š [https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config](https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config)
*   Next.js 14 ç‰ˆæœ¬ ï¼š [https://nextjs.org/docs/14/app/api-reference/file-conventions/route-segment-config](https://nextjs.org/docs/14/app/api-reference/file-conventions/route-segment-config)

### ç›¸å…³æ–‡æ¡£é¡µé¢

1.  Dynamic Routesï¼ˆåŠ¨æ€è·¯ç”±ï¼‰
    
    *   [https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes](https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes)
2.  Data Fetching and Cachingï¼ˆæ•°æ®è·å–å’Œç¼“å­˜ï¼‰
    
    *   [https://nextjs.org/docs/app/building-your-application/data-fetching](https://nextjs.org/docs/app/building-your-application/data-fetching)
3.  Renderingï¼ˆæ¸²æŸ“ï¼‰
    
    *   [https://nextjs.org/docs/app/building-your-application/rendering](https://nextjs.org/docs/app/building-your-application/rendering)

å¾®ä¿¡å…¬ä¼—å·ï¼šã€Œç¨‹åºè®¾è®¡å®éªŒå®¤ã€ ä¸“æ³¨äºäº’è”ç½‘çƒ­é—¨æ–°æŠ€æœ¯æ¢ç´¢ä¸å›¢é˜Ÿæ•æ·å¼€å‘å®è·µï¼ŒåŒ…æ‹¬æ¶æ„è®¾è®¡ã€æœºå™¨å­¦ä¹ ä¸æ•°æ®åˆ†æç®—æ³•ã€ç§»åŠ¨ç«¯å¼€å‘ã€Linuxã€Webå‰åç«¯å¼€å‘ç­‰ï¼Œæ¬¢è¿ä¸€èµ·æ¢è®¨æŠ€æœ¯ï¼Œåˆ†äº«å­¦ä¹ å®è·µç»éªŒã€‚