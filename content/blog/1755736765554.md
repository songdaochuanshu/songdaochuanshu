---
layout: post
title: 'ã€æ¸²æŸ“æµæ°´çº¿ã€‘[é€ç‰‡å…ƒé˜¶æ®µ]-[è£å‰ªæµ‹è¯•]ä»¥UnityURPä¸ºä¾‹'
date: "2025-08-21T00:39:25Z"
---
ã€æ¸²æŸ“æµæ°´çº¿ã€‘\[é€ç‰‡å…ƒé˜¶æ®µ\]-\[è£å‰ªæµ‹è¯•\]ä»¥UnityURPä¸ºä¾‹
====================================

![ã€æ¸²æŸ“æµæ°´çº¿ã€‘[é€ç‰‡å…ƒé˜¶æ®µ]-[è£å‰ªæµ‹è¯•]ä»¥UnityURPä¸ºä¾‹](https://img2024.cnblogs.com/blog/3685400/202508/3685400-20250820151951523-2090148020.png) æ‘˜è¦ï¼šæ–‡ç« ä»‹ç»äº†Unityä¸­ä¸‰ç§å®ç°æ¸²æŸ“åŒºåŸŸè£å‰ªçš„æ–¹æ³•ï¼š1ï¼‰ä½¿ç”¨UGUIçš„RectMask2Dç»„ä»¶è‡ªåŠ¨è£å‰ªUIå…ƒç´ ï¼Œæ€§èƒ½æœ€ä¼˜ä½†ä»…æ”¯æŒçŸ©å½¢ï¼›2ï¼‰åœ¨Shaderä¸­é€šè¿‡ä»£ç æ‰‹åŠ¨æ£€æµ‹ç‰‡å…ƒä½ç½®å®ç°çµæ´»è£å‰ªï¼Œå¯æ”¯æŒä»»æ„å½¢çŠ¶ä½†æ€§èƒ½ä¸­ç­‰ï¼›3ï¼‰é€šè¿‡GL.ScissorTestå…¨å±€APIé«˜æ•ˆè®¾ç½®å±å¹•çŸ©å½¢è£å‰ªåŒºåŸŸï¼Œé€‚åˆå…¨å±ç‰¹æ•ˆä½†éœ€æ­£äº¤ç›¸æœºã€‚ä¸‰ç§æ–¹å¼å„å…·ç‰¹ç‚¹ï¼Œå¼€å‘è€…å¯æ ¹æ®UI/3Dæ¨¡å‹ç­‰ä¸åŒéœ€æ±‚é€‰æ‹©æœ€ä½³æ–¹æ¡ˆï¼Œå…¶ä¸­RectMask2Dæœ€é€‚åˆUIè£å‰ªï¼ŒShaderæ–¹æ¡ˆçµæ´»æ€§æœ€é«˜ã€‚

*   é€šè¿‡çŸ©å½¢åŒºåŸŸé™åˆ¶æ¸²æŸ“èŒƒå›´
*   å¯æœ‰æ•ˆå‡å°‘ä¸å¿…è¦çš„ç‰‡å…ƒå¤„ç†â€Œ

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

**è£å‰ªæµ‹è¯•æ‰§è¡Œæµç¨‹â€Œ**
=============

â€Œ**å®šä¹‰è£å‰ªçŸ©å½¢**â€Œ
------------

*   è®¾ç½®åŸºäºå±å¹•åæ ‡ç³»ï¼ˆå·¦ä¸‹è§’ä¸ºåŸç‚¹ï¼‰çš„çŸ©å½¢åŒºåŸŸï¼š`(x_min, y_min, width, height)`
*   åæ ‡ç³»å•ä½ä¸ºåƒç´ ï¼ŒçŸ©å½¢èŒƒå›´å¤–çš„ç‰‡å…ƒå°†è¢«ä¸¢å¼ƒâ€Œ1

â€Œ**ç‰‡å…ƒä½ç½®æ£€æµ‹**â€Œ
------------

*   è®¡ç®—å½“å‰ç‰‡å…ƒåœ¨å±å¹•ç©ºé—´çš„ä½ç½®åæ ‡Â `(frag_x, frag_y)`

**è¾¹ç•Œæ¡ä»¶åˆ¤æ–­**â€Œ
-----------

*   è‹¥Â `frag_x < x_min`Â æˆ–Â `frag_x > x_min + width`ï¼Œä¸¢å¼ƒç‰‡å…ƒ
*   è‹¥Â `frag_y < y_min`Â æˆ–Â `frag_y > y_min + height`ï¼Œä¸¢å¼ƒç‰‡å…ƒâ€Œ

â€Œ**é€šè¿‡æµ‹è¯•çš„ç‰‡å…ƒ**â€Œ
-------------

*   ä»…ä¿ç•™çŸ©å½¢åŒºåŸŸå†…çš„ç‰‡å…ƒï¼Œè¿›å…¥åç»­æ¨¡æ¿/æ·±åº¦æµ‹è¯•æµç¨‹

**â€Œé…ç½®æ–¹å¼â€Œ**
==========

**â€Œ1. UGUIç»„ä»¶é…ç½®ï¼ˆæ— éœ€ç¼–ç ï¼‰â€Œ**
-----------------------

*   â€Œ**RectMask2Dç»„ä»¶**â€Œ
    
    *   æ·»åŠ è‡³UIçˆ¶ç‰©ä½“ï¼ˆå¦‚Panelï¼‰ï¼Œè‡ªåŠ¨è®¡ç®—å­å…ƒç´ çš„åŒ…å›´ç›’ä½œä¸ºè£å‰ªåŒºåŸŸ
    *   ä»…æ”¯æŒçŸ©å½¢è£å‰ªï¼Œä½†æ€§èƒ½ä¼˜äºMaskç»„ä»¶ï¼ˆæ— æ¨¡æ¿ç¼“å†²å¼€é”€ï¼‰â€Œ
    
        csharp
        // ç¤ºä¾‹ï¼šä¸ºUIé¢æ¿æ·»åŠ è£å‰ª
        GameObject panel = GameObject.Find("UIPanel");
        panel.AddComponent<RectMask2D>();
        
    

**â€Œ2. Shaderè„šæœ¬é…ç½®ï¼ˆçµæ´»æ§åˆ¶ï¼‰â€Œ**
-------------------------

åœ¨Shaderä¸­å¯ç”¨è£å‰ªå¹¶å®šä¹‰åŒºåŸŸï¼š

    hlsl
    SubShader {
        Pass {
            // å¼€å¯GPUè£å‰ªæŒ‡ä»¤
            Cull Off
            ZTest Always
    
            CGPROGRAM
            #pragma vertex vert
            #pragma fragment frag
            // å£°æ˜è£å‰ªåŒºåŸŸï¼ˆéœ€åœ¨è„šæœ¬ä¸­åŠ¨æ€ä¼ å…¥ï¼‰
            uniform float4 _ScissorRect; // (x, y, width, height)
    
            fixed4 frag (v2f i) : SV_Target {
                // æ‰‹åŠ¨æ£€æµ‹ç‰‡å…ƒä½ç½®
                if (i.screenPos.x < _ScissorRect.x ||
                    i.screenPos.x > _ScissorRect.x + _ScissorRect.z ||
                    i.screenPos.y < _ScissorRect.y ||
                    i.screenPos.y > _ScissorRect.y + _ScissorRect.w) {
                    discard; // ä¸¢å¼ƒåŒºåŸŸå¤–ç‰‡å…ƒ
                }
                return fixed4(1,1,1,1);
            }
            ENDCG
        }
    }
    

**â€Œ3. C#è„šæœ¬å…¨å±€é…ç½®ï¼ˆé«˜æ•ˆAPIï¼‰â€Œ**
------------------------

é€šè¿‡`Screen.scissorRect`åŠ¨æ€è®¾ç½®ï¼š

    csharp
    // å®šä¹‰è£å‰ªåŒºåŸŸï¼ˆå·¦ä¸‹è§’åæ ‡100,100ï¼Œå®½é«˜å„300åƒç´ ï¼‰
    Rect scissorRect = new Rect(100, 100, 300, 300);
    // å¯ç”¨è£å‰ª
    GL.Enable(EnableCap.ScissorTest);
    GL.Scissor((int)scissorRect.x, (int)scissorRect.y,
               (int)scissorRect.width, (int)scissorRect.height);
    // æ¸²æŸ“æ“ä½œ...
    GL.Disable(EnableCap.ScissorTest);// ç»“æŸéœ€å…³é—­
    

> âš ï¸ æ³¨æ„ï¼šæ­¤æ–¹æ³•éœ€åœ¨OnPostRenderç­‰æ¸²æŸ“å›è°ƒä¸­è°ƒç”¨ï¼Œä¸”è¦æ±‚æ‘„åƒæœºä¸ºæ­£äº¤æ¨¡å¼ä»¥ä¿è¯åæ ‡ç³»åŒ¹é…â€Œ

**â€Œå…³é”®ç‰¹æ€§å¯¹æ¯”â€Œ**
============

é…ç½®æ–¹å¼

é€‚ç”¨å¯¹è±¡

å½¢çŠ¶æ”¯æŒ

æ€§èƒ½å¼€é”€

çµæ´»æ€§

â€Œ**RectMask2D**â€Œ

UGUIå…ƒç´ 

ä»…çŸ©å½¢

ä½

ä½

â€Œ**Shaderè„šæœ¬**â€Œ

3Dæ¨¡å‹/ç²’å­

ä»»æ„

ä¸­

é«˜

â€Œ**GL API**â€Œ

å…¨å±ç‰¹æ•ˆ

ä»…çŸ©å½¢

æœ€ä½

ä¸­

> å®é™…å¼€å‘ä¸­ï¼ŒUIè£å‰ªé¦–é€‰RectMask2Dï¼Œ3Då¯¹è±¡æˆ–è‡ªå®šä¹‰å½¢çŠ¶éœ€ç»“åˆShaderå®ç°ï¼›GLæ¥å£é€‚ç”¨äºå…¨å±åå¤„ç†ç‰¹æ•ˆçš„å±€éƒ¨æ¸²æŸ“ä¼˜åŒ–â€Œ

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰