---
layout: post
title: 'OpenClaw+OpenViking + NVIDIA API é…ç½®æ•™ç¨‹'
date: "2026-02-20T00:55:58Z"
---
OpenClaw+OpenViking + NVIDIA API é…ç½®æ•™ç¨‹
=====================================

> æœ¬æ•™ç¨‹ä»‹ç»å¦‚ä½•åœ¨ OpenClaw ç¯å¢ƒä¸­é…ç½® OpenVikingï¼Œä½¿ç”¨ NVIDIA NIM API ä½œä¸º Embedding å’Œ VLM åç«¯ã€‚

ä»€ä¹ˆæ˜¯ OpenVikingï¼Ÿ
---------------

OpenViking æ˜¯ç«å±±å¼•æ“å¼€æºçš„ **AI Agent ä¸Šä¸‹æ–‡æ•°æ®åº“**ã€‚å®ƒç”¨"è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ"çš„æ–¹å¼ç®¡ç† Agent çš„è®°å¿†ã€èµ„æºå’ŒæŠ€èƒ½ï¼Œæä¾›ï¼š

*   **åˆ†å±‚ä¸Šä¸‹æ–‡**ï¼šL0æ‘˜è¦ / L1æ¦‚è§ˆ / L2å…¨æ–‡ï¼ŒæŒ‰éœ€åŠ è½½èŠ‚çœ Token
*   **è¯­ä¹‰æœç´¢**ï¼šèåˆç›®å½•å®šä½ä¸å‘é‡æ£€ç´¢
*   **è‡ªåŠ¨æ‘˜è¦**ï¼šVLM è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£æ‘˜è¦å’Œæ¦‚è§ˆ
*   **ä¼šè¯è®°å¿†**ï¼šè‡ªåŠ¨æå–å¯¹è¯ä¸­çš„é•¿æœŸè®°å¿†

GitHub: [https://github.com/volcengine/OpenViking](https://github.com/volcengine/OpenViking)

å‰ç½®æ¡ä»¶
----

*   Python 3.9+
*   NVIDIA NIM API Keyï¼ˆ[å…è´¹æ³¨å†Œ](https://build.nvidia.com/)ï¼‰
*   ç¨³å®šçš„ç½‘ç»œè¿æ¥

* * *

ç¬¬ä¸€æ­¥ï¼šå®‰è£… OpenViking
-----------------

    pip install openviking
    

* * *

ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶
----------

åˆ›å»ºç›®å½•å’Œé…ç½®æ–‡ä»¶ï¼š

    mkdir -p ~/.openviking
    

ç¼–è¾‘ `~/.openviking/ov.conf`ï¼š

    {
      "embedding": {
        "dense": {
          "api_base": "https://integrate.api.nvidia.com/v1",
          "api_key": "ä½ çš„NVIDIA_API_KEY",
          "provider": "openai",
          "dimension": 4096,
          "model": "nvidia/nv-embed-v1"
        }
      },
      "vlm": {
        "api_base": "https://integrate.api.nvidia.com/v1",
        "api_key": "ä½ çš„NVIDIA_API_KEY",
        "provider": "openai",
        "model": "meta/llama-3.3-70b-instruct"
      }
    }
    

### é…ç½®è¯´æ˜

å‚æ•°

è¯´æ˜

`api_base`

NVIDIA NIM API ç«¯ç‚¹

`api_key`

ä» NVIDIA Build å¹³å°è·å–

`dimension`

Embedding ç»´åº¦ï¼Œnv-embed-v1 å›ºå®šä¸º 4096

`embedding.model`

æ¨èä½¿ç”¨ `nvidia/nv-embed-v1`ï¼ˆå¯¹ç§°æ¨¡å‹ï¼Œä¸éœ€è¦ input\_type å‚æ•°ï¼‰

`vlm.model`

ç”¨äºç”Ÿæˆæ‘˜è¦çš„è¯­è¨€æ¨¡å‹ï¼Œæ¨è `meta/llama-3.3-70b-instruct`

### ä¸ºä»€ä¹ˆä¸ç”¨ kimi-k2.5ï¼Ÿ

NVIDIA ä¸Šçš„æ¨ç†æ¨¡å‹ï¼ˆå¦‚ kimi-k2.5ï¼‰è¿”å›çš„ `content` å­—æ®µä¸ºç©ºï¼Œå†…å®¹åœ¨ `reasoning` å­—æ®µé‡Œã€‚OpenViking æœŸæœ›æ ‡å‡†çš„ `message.content` æ ¼å¼ï¼Œæ‰€ä»¥è¦ç”¨éæ¨ç†æ¨¡å‹ã€‚

### å¦‚ä½•è·å– NVIDIA API Key

1.  è®¿é—® [https://build.nvidia.com/](https://build.nvidia.com/)
2.  ç™»å½•/æ³¨å†Œè´¦å·
3.  ç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·å â†’ API Keys â†’ Generate Key
4.  å¤åˆ¶ä¿å­˜ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰

* * *

ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®ç¯å¢ƒå˜é‡
----------

    export OPENVIKING_CONFIG_FILE=~/.openviking/ov.conf
    

å»ºè®®æ·»åŠ åˆ° `~/.bashrc`ï¼š

    echo 'export OPENVIKING_CONFIG_FILE=~/.openviking/ov.conf' >> ~/.bashrc
    source ~/.bashrc
    

* * *

ç¬¬å››æ­¥ï¼šéªŒè¯å®‰è£…
--------

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_openviking.py`ï¼š

    import openviking as ov
    
    # åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼Œæ•°æ®å­˜å‚¨åœ¨å½“å‰ç›®å½•çš„ openviking_data æ–‡ä»¶å¤¹
    client = ov.SyncOpenViking(path="./openviking_data")
    
    try:
        client.initialize()
        print("âœ… OpenViking åˆå§‹åŒ–æˆåŠŸï¼")
        
        # æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶
        result = client.add_resource(path="./your_file.md")
        print(f"æ·»åŠ æ–‡ä»¶: {result}")
        
        # ç­‰å¾…å¤„ç†å®Œæˆ
        print("ç­‰å¾…å¤„ç†...")
        client.wait_processed()
        print("âœ… å¤„ç†å®Œæˆï¼")
        
        # æœç´¢æµ‹è¯•
        results = client.find("æµ‹è¯•å…³é”®è¯", limit=3)
        print(f"\næœç´¢ç»“æœ:")
        for r in results.resources:
            print(f"  {r.uri} (score: {r.score:.4f})")
        
        client.close()
        print("\nğŸ‰ OpenViking é…ç½®æˆåŠŸï¼")
    
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        import traceback
        traceback.print_exc()
    

è¿è¡Œï¼š

    python test_openviking.py
    

* * *

ç¬¬äº”æ­¥ï¼šæ ¸å¿ƒ API ç”¨æ³•
-------------

### æ·»åŠ èµ„æº

    # æ·»åŠ å•ä¸ªæ–‡ä»¶
    result = client.add_resource(path="./docs/readme.md")
    
    # æ·»åŠ  URL
    result = client.add_resource(path="https://example.com/article.html")
    

### ç›®å½•æµè§ˆ

    # åˆ—å‡ºæ ¹ç›®å½•
    ls_result = client.ls("viking://resources")
    
    # åˆ—å‡ºå­ç›®å½•
    ls_result = client.ls("viking://resources/my_project")
    

### è¯­ä¹‰æœç´¢

    # æœç´¢ç›¸å…³å†…å®¹
    results = client.find("å¦‚ä½•é…ç½® embedding", limit=5)
    
    for r in results.resources:
        print(f"URI: {r.uri}")
        print(f"Score: {r.score}")
        print(f"Content: {client.read(r.uri)[:200]}...")
    

### è·å–æ‘˜è¦/æ¦‚è§ˆ

    # L0 å±‚ï¼šä¸€å¥è¯æ‘˜è¦
    abstract = client.abstract("viking://resources/my_project")
    
    # L1 å±‚ï¼šè¯¦ç»†æ¦‚è§ˆ
    overview = client.overview("viking://resources/my_project")
    

### è¯»å–å†…å®¹

    # è¯»å–å®Œæ•´å†…å®¹ï¼ˆL2 å±‚ï¼‰
    content = client.read("viking://resources/my_project/readme.md")
    

* * *

å¸¸è§é—®é¢˜
----

### Q: Embedding ç»´åº¦ä¸åŒ¹é…

**é”™è¯¯**: `Dense vector dimension mismatch: expected 2048, got 4096`

**è§£å†³**: åœ¨é…ç½®æ–‡ä»¶ä¸­æ˜ç¡®æŒ‡å®š `dimension: 4096`ï¼ŒåŒ¹é… `nvidia/nv-embed-v1` çš„è¾“å‡ºç»´åº¦ã€‚

### Q: VLM è¿”å› NoneType é”™è¯¯

**é”™è¯¯**: `'NoneType' object is not subscriptable`

**åŸå› **: ä½¿ç”¨äº†æ¨ç†æ¨¡å‹ï¼ˆå¦‚ kimi-k2.5ï¼‰ï¼Œå…¶è¿”å›æ ¼å¼ä¸ OpenViking ä¸å…¼å®¹ã€‚

**è§£å†³**: æ¢ç”¨æ ‡å‡†æ¨¡å‹å¦‚ `meta/llama-3.3-70b-instruct`ã€‚

### Q: NVIDIA API æŠ¥é”™ input\_type required

**é”™è¯¯**: `'input_type' parameter is required for asymmetric models`

**åŸå› **: æŸäº› Embedding æ¨¡å‹ï¼ˆå¦‚ nv-embedqa-e5-v5ï¼‰æ˜¯éå¯¹ç§°æ¨¡å‹ï¼Œéœ€è¦æŒ‡å®š query æˆ– documentã€‚

**è§£å†³**: ä½¿ç”¨å¯¹ç§°æ¨¡å‹ `nvidia/nv-embed-v1`ï¼Œä¸éœ€è¦ input\_typeã€‚

### Q: æ–‡ä»¶åå†²çª

**é”™è¯¯**: `directory already exists: /resources/ç¬¬01ç« `

**åŸå› **: OpenViking ç”¨æ–‡ä»¶åï¼ˆä¸å«è·¯å¾„ï¼‰ä½œä¸º URIï¼Œä¸åŒç›®å½•ä¸‹çš„åŒåæ–‡ä»¶ä¼šå†²çªã€‚

**è§£å†³**:

*   æ–¹æ¡ˆä¸€ï¼šé‡å‘½åæ–‡ä»¶ï¼Œä½¿ç”¨å”¯ä¸€åç§°
*   æ–¹æ¡ˆäºŒï¼šåˆ†æ‰¹å¯¼å…¥ï¼Œé¿å…åŒæ—¶æ·»åŠ åŒåæ–‡ä»¶
*   æ–¹æ¡ˆä¸‰ï¼šç­‰å¾…å®˜æ–¹ä¿®å¤æ­¤è®¾è®¡é—®é¢˜

* * *

ä¸ºä»€ä¹ˆç”¨ OpenVikingï¼Ÿâ€”â€”æ›¿ä»£ OpenClaw é»˜è®¤çš„ qmd è®°å¿†åç«¯
------------------------------------------

### OpenClaw ç°æœ‰è®°å¿†æ–¹æ¡ˆçš„å±€é™

OpenClaw é»˜è®¤ä½¿ç”¨ `qmd` ä½œä¸ºè®°å¿†åç«¯ï¼Œé…åˆæ‰‹åŠ¨ç»´æŠ¤çš„ `MEMORY.md` å’Œ `memory/*.md` æ–‡ä»¶ã€‚è¿™å¥—æ–¹æ¡ˆå¤Ÿç”¨ï¼Œä½†æœ‰å‡ ä¸ªç—›ç‚¹ï¼š

1.  **æœç´¢ç²¾åº¦æœ‰é™** â€” qmd åŸºäºç®€å•å‘é‡åŒ¹é…ï¼Œç¼ºä¹å±‚æ¬¡åŒ–ç†è§£
2.  **æ‰‹åŠ¨ç»´æŠ¤æˆæœ¬é«˜** â€” è®°å¿†æ–‡ä»¶éœ€è¦äººå·¥æ•´ç†ï¼Œå®¹æ˜“é—æ¼
3.  **ç¼ºä¹è‡ªåŠ¨æ‘˜è¦** â€” Agent éœ€è¦è¯»å–æ•´ä¸ªæ–‡ä»¶æ‰èƒ½äº†è§£å†…å®¹
4.  **æ— æ³•ç®¡ç†å¤§é‡æ–‡æ¡£** â€” å½“ workspace æ–‡ä»¶å¾ˆå¤šæ—¶ï¼Œqmd ä¸å¤Ÿç”¨

### OpenViking çš„ä¼˜åŠ¿

èƒ½åŠ›

qmd

OpenViking

è¯­ä¹‰æœç´¢

âœ… åŸºç¡€

âœ… ç›®å½•é€’å½’ + è¯­ä¹‰èåˆ

è‡ªåŠ¨æ‘˜è¦

âŒ

âœ… L0/L1/L2 ä¸‰å±‚

ç»“æ„åŒ–æµè§ˆ

âŒ

âœ… è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ

Token èŠ‚çœ

âŒ

âœ… æŒ‰éœ€åŠ è½½

ä¼šè¯è®°å¿†è‡ªåŠ¨æå–

âŒ

âœ… è‡ªåŠ¨æå–é•¿æœŸè®°å¿†

### é›†æˆæ–¹å¼

#### æ–¹å¼ä¸€ï¼šä½œä¸º OpenClaw çš„è¡¥å……è®°å¿†ï¼ˆæ¨èï¼‰

ä¿ç•™ qmd ä½œä¸ºæ—¥å¸¸è½»é‡è®°å¿†ï¼Œç”¨ OpenViking ç®¡ç†å¤§å‹æ–‡æ¡£åº“ï¼š

    # æŠŠ workspace é‡Œçš„ä¹¦ç±ã€é¡¹ç›®æ–‡æ¡£ç­‰å¤§å‹èµ„æºå¯¼å…¥ OpenViking
    import glob, openviking as ov
    
    client = ov.SyncOpenViking(path="./openviking_data")
    client.initialize()
    
    for f in glob.glob("./books/**/*.md", recursive=True):
        client.add_resource(path=f)
    
    for f in glob.glob("./docs/**/*.md", recursive=True):
        client.add_resource(path=f)
    
    client.wait_processed()
    client.close()
    

Agent å·¥ä½œæµï¼š

1.  æ—¥å¸¸å¯¹è¯ â†’ qmd è®°å¿†ï¼ˆè½»é‡ã€å¿«é€Ÿï¼‰
2.  éœ€è¦æŸ¥é˜…æ–‡æ¡£ â†’ OpenViking è¯­ä¹‰æœç´¢ï¼ˆç²¾å‡†ã€åˆ†å±‚ï¼‰
3.  Sub-agent å†™ä½œ/ç ”ç©¶ â†’ OpenViking æä¾›ä¸Šä¸‹æ–‡ï¼ˆèŠ‚çœ Tokenï¼‰

#### æ–¹å¼äºŒï¼šå®Œå…¨æ›¿ä»£ qmd

å°† OpenClaw çš„æ‰€æœ‰è®°å¿†æ–‡ä»¶ä¹Ÿå¯¼å…¥ OpenVikingï¼š

    # å¯¼å…¥è®°å¿†æ–‡ä»¶
    for f in glob.glob("./memory/*.md"):
        client.add_resource(path=f)
    
    # å¯¼å…¥ workspace æ‰€æœ‰ markdown
    for f in glob.glob("./**/*.md", recursive=True):
        client.add_resource(path=f)
    

> âš ï¸ ç›®å‰ OpenViking è¿˜ä¸èƒ½ç›´æ¥ä½œä¸º OpenClaw çš„ `memory.backend` é…ç½®é¡¹ã€‚éœ€è¦é€šè¿‡ skill çš„ CLI å·¥å…·é—´æ¥è°ƒç”¨ã€‚æœªæ¥å¦‚æœ OpenClaw æ”¯æŒè‡ªå®šä¹‰è®°å¿†åç«¯æ’ä»¶ï¼Œå¯ä»¥æ›´æ·±åº¦é›†æˆã€‚

#### æ–¹å¼ä¸‰ï¼šç»™ Sub-agent æä¾›ä¸Šä¸‹æ–‡

å†™ä¹¦ã€åšç ”ç©¶ç­‰ä»»åŠ¡æ—¶ï¼Œsub-agent å¯ä»¥å…ˆæœç´¢ OpenViking è·å–ç›¸å…³ä¸Šä¸‹æ–‡ï¼Œè€Œä¸æ˜¯æŠŠæ•´æœ¬ä¹¦å¡è¿› promptï¼š

    # Sub-agent å…ˆæœç´¢ç›¸å…³å†…å®¹
    python3 scripts/viking.py search "æ­¦æ¾çš„æ€§æ ¼åˆ†æ" --limit 3
    
    # ç„¶ååªè¯»å–æœ€ç›¸å…³çš„æ®µè½
    python3 scripts/viking.py read viking://resources/ç¬¬01ç« /å¼ ä¸‰çš„å™äº‹.md
    

è¿™æ ·ä¸€ä¸ª sub-agent åªéœ€è¦åŠ è½½å‡ åƒ token çš„ç›¸å…³å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´æœ¬ä¹¦çš„ 10 ä¸‡+ tokenã€‚

### å·²å°è£…çš„ OpenClaw Skill

æˆ‘ä»¬å·²ç»æŠŠ OpenViking å°è£…ä¸º OpenClaw skillï¼Œå®‰è£…å Agent å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š

    # å®‰è£… skill
    git clone https://github.com/swizardlv/openclaw_openviking_skill.git
    cp -r openclaw_openviking_skill/openviking ~/.openclaw/workspace/skills/
    

Skill æä¾›çš„å‘½ä»¤ï¼š

å‘½ä»¤

åŠŸèƒ½

`viking.py add <file>`

ç´¢å¼•æ–‡ä»¶

`viking.py add-dir <dir>`

æ‰¹é‡ç´¢å¼•ç›®å½•

`viking.py search <query>`

è¯­ä¹‰æœç´¢

`viking.py ls [uri]`

æµè§ˆèµ„æº

`viking.py abstract <uri>`

è·å–æ‘˜è¦

`viking.py overview <uri>`

è·å–æ¦‚è§ˆ

`viking.py read <uri>`

è¯»å–å…¨æ–‡

`viking.py info`

æŸ¥çœ‹é…ç½®çŠ¶æ€

* * *

é™„å½•ï¼šå¯ç”¨çš„ NVIDIA Embedding æ¨¡å‹
--------------------------

æ¨¡å‹

ç»´åº¦

ç±»å‹

è¯´æ˜

`nvidia/nv-embed-v1`

4096

å¯¹ç§°

âœ… æ¨èï¼Œæ— éœ€ input\_type

`nvidia/nv-embedqa-e5-v5`

1024

éå¯¹ç§°

éœ€è¦ input\_type å‚æ•°

`nvidia/llama-3.2-nv-embedqa-1b-v2`

2048

éå¯¹ç§°

éœ€è¦ input\_type å‚æ•°

`nvidia/nv-embedcode-7b-v1`

4096

å¯¹ç§°

é€‚åˆä»£ç 

* * *

é™„å½•ï¼šå¯ç”¨çš„ NVIDIA Chat æ¨¡å‹ï¼ˆç”¨äº VLMï¼‰
-----------------------------

æ¨¡å‹

è¯´æ˜

`meta/llama-3.3-70b-instruct`

âœ… æ¨èï¼Œæ ‡å‡†æ ¼å¼

`meta/llama-3.1-70b-instruct`

ç¨³å®šç‰ˆæœ¬

`meta/llama-3.1-8b-instruct`

è½»é‡ç‰ˆ

`mistralai/mistral-large`

Mistral ç³»åˆ—

> âš ï¸ é¿å…ä½¿ç”¨æ¨ç†æ¨¡å‹ï¼ˆå¦‚ kimi-k2.5ã€deepseek-r1ï¼‰ï¼Œå®ƒä»¬è¿”å›çš„æ ¼å¼ä¸ OpenViking ä¸å…¼å®¹ã€‚

* * *

å‚è€ƒé“¾æ¥
----

*   OpenViking å®˜ç½‘: [https://www.openviking.ai](https://www.openviking.ai)
*   OpenViking GitHub: [https://github.com/volcengine/OpenViking](https://github.com/volcengine/OpenViking)
*   NVIDIA NIM API: [https://build.nvidia.com/](https://build.nvidia.com/)
*   NVIDIA API æ–‡æ¡£: [https://docs.api.nvidia.com/nim/](https://docs.api.nvidia.com/nim/)

* * *

_æœ¬æ•™ç¨‹åŸºäº OpenViking 0.1.17 å’Œ NVIDIA NIM API æµ‹è¯•é€šè¿‡ã€‚_