---
layout: post
title: 'FreeSWITCH开启silk编码及转码'
date: "2025-11-26T00:42:44Z"
---
FreeSWITCH开启silk编码及转码
=====================

操作系统：Debian 12.5\_x64

FreeSWITCH版本： 1.10.11

SILK编码由Skype设计，是一种用于VoIP的宽带音频编解码器，它支持8khz、12khz、16khz、24khz四种不同的采样率。今天整理下FreeSWITCH使用silk编码进行通话及转码的笔记，希望对你有帮助。

一、模块安装及配置
=========

1、添加模块编译项
---------

文件：源码根目录的modules.conf文件

添加（或取消注释）如下代码：

codecs/mod\_silk

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125222755838-1980692619.png)

2、编译及安装
-------

需要安装依赖：

[https://github.com/freeswitch/libsilk](https://github.com/freeswitch/libsilk)

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125222844725-72763859.png)

如果下载过慢，可从如下渠道获取：

关注微信公众号（聊聊博文，文末可扫码）后回复 20251125 获取。

libsilk库编译及加载命令如下：

./bootstrap.sh
./configure
make && make install 
cp /usr/local/lib/pkgconfig/silk.pc /usr/lib64/pkgconfig
ldd

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223045254-479940470.png)

源码目录执行如下命令：

autoreconf -fiv
make clean
./devel-bootstrap.sh && ./configure && make && make install

会编译mod\_silk模块并生成文件：

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223053940-2107176089.png)

3、加载mod\_silk模块
---------------

编辑 conf/autoload\_configs/modules.conf.xml 文件，添加如下内容：

<load module="mod\_silk"/>

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223130912-1235392348.png)

 重启FreeSWITCH或执行重新load操作：

load mod\_silk

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223201773-1697858851.png)

如果加载不报错，则添加mod\_silk 模块成功。

4、启用编码
------

 配置文件路径：

/usr/local/freeswitch/conf/vars.xml

配置文件内容如下（默认）：

<X-PRE-PROCESS cmd\="set" data\="global\_codec\_prefs=SILK,OPUS,G722,PCMU,PCMA,L16,H264,VP8"/>
<X-PRE-PROCESS cmd\="set" data\="outbound\_codec\_prefs=SILK,OPUS,G722,PCMU,PCMA,L16,H264,VP8"/>

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223259991-857656995.png)

 重启freeswitch生效。

二、使用silk编码通话
============

1、配置话机支持silk编码
--------------

配置分机只支持silk编码：

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223331621-14784.png)

2、验证silk编码通话
------------

添加测试拨号方案：

  <extension name\="playTest"\>
      <condition field\="destination\_number" expression\="^10087$"\>
        <action application\="answer"/>
        <action application\="playback" data\="$${hold\_music}"/>
      </condition\>
    </extension\>

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223405080-41136399.png)

拨打测试号码（比如10087）进行呼叫测试，效果如下：

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223419454-1752008600.png)

三、silk编码转换
==========

1、开启语音编码转换功能
------------

文件：conf/vars.xml

修改或添加内容：

<X-PRE-PROCESS cmd\="set" data\="global\_codec\_prefs=SILK,OPUS,G722,PCMU,PCMA,L16,H264,VP8"/>
  <X-PRE-PROCESS cmd\="set" data\="outbound\_codec\_prefs=SILK,OPUS,G722,PCMU,PCMA,L16,H264,VP8"/>
  <X-PRE-PROCESS cmd\="set"data\="media\_mix\_inbound\_outbound\_codecs=true"/>

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223504837-1715566736.png)

 文件：

sip\_profiles/internal.xml

修改或添加如下内容：

    <param name\="inbound-late-negotiation" value\="false"/>
    <param name\="disable-transcoding" value\="false"/>

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223600112-668923163.png)

重启freeswitch生效。

2、通话效果
------

分机1009 PCMU编码

分机1010 silk编码

通话效果如下：

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223625305-1184908003.png)

抓包效果如下：

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223644804-1433412686.png)

四、资源下载
======

本文相关资源及示例配置，可从如下渠道获取：

关注微信公众号（聊聊博文，文末可扫码）后回复 20251125 获取。

![image](https://img2024.cnblogs.com/blog/300959/202511/300959-20251125223725894-979207332.png)

【文件说明】

libsilk.tar.gz    ：  libsilk源码

libsilk-compiled.tar.gz  ： libsilk源码（已编译，so文件在源码的.libs目录）

fs\_mod\_silk.tar.gz ： mod\_silk二进制编译文件

如果你对该文章有疑问，可通过微信公众号（聊聊博文）向我提问：  
[![](https://files.cnblogs.com/files/MikeZhang/201804weixingongzhong1.gif)](https://files.cnblogs.com/files/MikeZhang/201804weixingongzhong1.gif)  
转载请注明出处，谢谢！