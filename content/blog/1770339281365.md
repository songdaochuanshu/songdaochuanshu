---
layout: post
title: 'Laravel AI SDK æ­£å¼å‘å¸ƒ'
date: "2026-02-06T00:54:41Z"
---
Laravel AI SDK æ­£å¼å‘å¸ƒ
===================

Laravel AI SDK æ­£å¼å‘å¸ƒ
===================

Laravel AI SDK ä»Šå¤©æ­£å¼å‘å¸ƒäº†ã€‚è¿™ä¸ªç”± Taylor Otwell å¼€å‘æ•°æœˆçš„å®˜æ–¹åŒ…ï¼Œä¸º Laravel åº”ç”¨æä¾›äº†ä¸€å¥—ç»Ÿä¸€çš„ AI äº¤äº’æ¥å£ï¼Œè¦†ç›–æ–‡æœ¬å¯¹è¯ã€å›¾åƒç”Ÿæˆã€è¯­éŸ³åˆæˆã€è¯­éŸ³è½¬å½•ã€å‘é‡åµŒå…¥ç­‰åœºæ™¯ï¼Œæ”¯æŒ OpenAIã€Anthropicã€Geminiã€Groqã€xAI ç­‰ä¸»æµæœåŠ¡å•†ã€‚

å®‰è£…æ–¹å¼å’Œå…¶ä»– Laravel å®˜æ–¹åŒ…ä¸€æ ·ç®€å•ï¼š

    composer require laravel/ai
    

Agentï¼šæ ¸å¿ƒäº¤äº’å•å…ƒ
------------

SDK çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ Agentã€‚æ¯ä¸ª Agent æ˜¯ä¸€ä¸ª PHP ç±»ï¼Œå°è£…äº†ç³»ç»ŸæŒ‡ä»¤ã€å¯¹è¯ä¸Šä¸‹æ–‡ã€å·¥å…·å’Œè¾“å‡ºæ ¼å¼ã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªä¸“ç”¨åŠ©æ‰‹â€”â€”é”€å”®æ•™ç»ƒã€æ–‡æ¡£åˆ†æå™¨ã€å®¢æœæœºå™¨äººâ€”â€”é…ç½®ä¸€æ¬¡ï¼Œéšå¤„è°ƒç”¨ã€‚

é€šè¿‡ Artisan å‘½ä»¤åˆ›å»ºï¼š

    php artisan make:agent SalesCoach
    

ç”Ÿæˆçš„ç±»å®ç° `Agent` æ¥å£ï¼Œå®šä¹‰ `instructions()` æ–¹æ³•æä¾›ç³»ç»Ÿæç¤ºè¯ï¼Œç„¶åè°ƒç”¨ `prompt()` å‘èµ·å¯¹è¯ï¼š

    $response = SalesCoach::make(user: $user)
        ->prompt('åˆ†æè¿™æ®µé”€å”®å½•éŸ³...');
    
    return (string) $response;
    

`prompt()` æ–¹æ³•æ”¯æŒåœ¨è°ƒç”¨æ—¶åˆ‡æ¢æœåŠ¡å•†å’Œæ¨¡å‹ï¼š

    $response = (new SalesCoach)->prompt(
        'åˆ†æè¿™æ®µé”€å”®å½•éŸ³...',
        provider: 'anthropic',
        model: 'claude-haiku-4-5-20251001',
        timeout: 120,
    );
    

å¦‚æœä¸æƒ³åˆ›å»ºä¸“é—¨çš„ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨åŒ¿å Agent å¿«é€Ÿè°ƒç”¨ï¼š

    use function Laravel\Ai\{agent};
    
    $response = agent(
        instructions: 'You are an expert at software development.',
    )->prompt('Tell me about Laravel');
    

ç»“æ„åŒ–è¾“å‡º
-----

Agent å¯ä»¥è¿”å›ç»“æ„åŒ–æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯çº¯æ–‡æœ¬ã€‚å®ç° `HasStructuredOutput` æ¥å£ï¼Œå®šä¹‰ `schema()` æ–¹æ³•å³å¯ï¼š

    public function schema(JsonSchema $schema): array
    {
        return [
            'feedback' => $schema->string()->required(),
            'score' => $schema->integer()->min(1)->max(10)->required(),
        ];
    }
    

è°ƒç”¨åç›´æ¥å½“æ•°ç»„ç”¨ï¼š

    $response = (new SalesCoach)->prompt('åˆ†æè¿™æ®µå½•éŸ³...');
    
    return $response['score']; // 8
    

å¯¹è¯è®°å¿†
----

Agent æ”¯æŒè‡ªåŠ¨æŒä¹…åŒ–å¯¹è¯å†å²ã€‚ä½¿ç”¨ `RemembersConversations` trait åï¼ŒSDK ä¼šè‡ªåŠ¨å°†å¯¹è¯å­˜å…¥æ•°æ®åº“ï¼Œåç»­å¯ä»¥é€šè¿‡ `continue()` æ–¹æ³•ç»§ç»­ä¹‹å‰çš„å¯¹è¯ï¼š

    // å¼€å§‹æ–°å¯¹è¯
    $response = (new SalesCoach)->forUser($user)->prompt('ä½ å¥½ï¼');
    $conversationId = $response->conversationId;
    
    // ç»§ç»­å¯¹è¯
    $response = (new SalesCoach)
        ->continue($conversationId, as: $user)
        ->prompt('æ¥ç€åˆšæ‰çš„è¯é¢˜...');
    

å·¥å…·ç³»ç»Ÿ
----

Agent å¯ä»¥ä½¿ç”¨å·¥å…·æ¥æ‰©å±•èƒ½åŠ›ã€‚é€šè¿‡ `make:tool` å‘½ä»¤åˆ›å»ºå·¥å…·ç±»ï¼Œå®šä¹‰è¾“å…¥ schema å’Œ `handle()` æ–¹æ³•ï¼š

    class RandomNumberGenerator implements Tool
    {
        public function description(): string
        {
            return 'ç”ŸæˆåŠ å¯†å®‰å…¨çš„éšæœºæ•°ã€‚';
        }
    
        public function handle(Request $request): string
        {
            return (string) random_int($request['min'], $request['max']);
        }
    
        public function schema(JsonSchema $schema): array
        {
            return [
                'min' => $schema->integer()->min(0)->required(),
                'max' => $schema->integer()->required(),
            ];
        }
    }
    

SDK è¿˜å†…ç½®äº†å‡ ä¸ªæœåŠ¡å•†çº§åˆ«çš„å·¥å…·ï¼š

*   **WebSearch** â€” è®© Agent æœç´¢ç½‘é¡µï¼Œæ”¯æŒ Anthropicã€OpenAIã€Gemini
*   **WebFetch** â€” è®© Agent æŠ“å–ç½‘é¡µå†…å®¹ï¼Œæ”¯æŒ Anthropicã€Gemini
*   **FileSearch** â€” åœ¨å‘é‡å­˜å‚¨ä¸­æœç´¢æ–‡ä»¶ï¼Œæ”¯æŒ OpenAIã€Gemini
*   **SimilaritySearch** â€” åŸºäº Eloquent æ¨¡å‹çš„å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œç”¨äº RAG åœºæ™¯

æµå¼å“åº”ä¸å¹¿æ’­
-------

å¯¹äºéœ€è¦å®æ—¶è¾“å‡ºçš„åœºæ™¯ï¼ŒAgent æ”¯æŒæµå¼å“åº”ã€‚è¿”å›å€¼å¯ä»¥ç›´æ¥ä½œä¸ºè·¯ç”±å“åº”ï¼Œè‡ªåŠ¨å‘é€ SSEï¼š

    Route::get('/coach', function () {
        return (new SalesCoach)->stream('åˆ†æè¿™æ®µå½•éŸ³...');
    });
    

æµå¼äº‹ä»¶è¿˜å¯ä»¥é€šè¿‡ Laravel Broadcasting å¹¿æ’­åˆ°å‰ç«¯é¢‘é“ï¼Œæˆ–è€…ä½¿ç”¨ Vercel AI SDK åè®®ä¸å‰ç«¯æ¡†æ¶å¯¹æ¥ï¼š

    return (new SalesCoach)
        ->stream('åˆ†æè¿™æ®µå½•éŸ³...')
        ->usingVercelDataProtocol();
    

é˜Ÿåˆ—å¤„ç†
----

è€—æ—¶çš„ AI è¯·æ±‚å¯ä»¥æ¨å…¥é˜Ÿåˆ—åœ¨åå°å¤„ç†ï¼š

    (new SalesCoach)
        ->queue($request->input('transcript'))
        ->then(function (AgentResponse $response) {
            // å¤„ç†å“åº”...
        })
        ->catch(function (Throwable $e) {
            // å¤„ç†å¼‚å¸¸...
        });
    

å›¾åƒç”Ÿæˆ
----

`Image` ç±»æä¾›äº†ç®€æ´çš„å›¾åƒç”Ÿæˆæ¥å£ï¼Œæ”¯æŒ OpenAIã€Gemini å’Œ xAIï¼š

    use Laravel\Ai\Image;
    
    $image = Image::of('å¨æˆ¿å°é¢ä¸Šçš„ç”œç”œåœˆ')
        ->quality('high')
        ->landscape()
        ->generate();
    
    $path = $image->store();
    

æ”¯æŒé™„åŠ å‚è€ƒå›¾åƒè¿›è¡Œé£æ ¼è¿ç§»ï¼Œä¹Ÿå¯ä»¥æ¨å…¥é˜Ÿåˆ—å¼‚æ­¥ç”Ÿæˆã€‚

éŸ³é¢‘ä¸è½¬å½•
-----

è¯­éŸ³åˆæˆï¼ˆTTSï¼‰å’Œè¯­éŸ³è½¬å½•ï¼ˆSTTï¼‰åŒæ ·è¢«çº³å…¥ SDKï¼š

    use Laravel\Ai\Audio;
    use Laravel\Ai\Transcription;
    
    // æ–‡å­—è½¬è¯­éŸ³
    $audio = Audio::of('I love coding with Laravel.')
        ->female()
        ->instructions('ç”¨æµ·ç›—çš„è¯­æ°”è¯´')
        ->generate();
    
    // è¯­éŸ³è½¬æ–‡å­—
    $transcript = Transcription::fromStorage('audio.mp3')
        ->diarize() // æŒ‰è¯´è¯äººåˆ†æ®µ
        ->generate();
    

TTS æ”¯æŒ OpenAI å’Œ ElevenLabsï¼ŒSTT åŒæ ·æ”¯æŒè¿™ä¸¤ä¸ªæœåŠ¡å•†ã€‚

Embeddings ä¸å‘é‡æœç´¢
----------------

ç”Ÿæˆå‘é‡åµŒå…¥å˜å¾—éå¸¸ç›´è§‚ã€‚Laravel çš„ `Stringable` ç±»æ–°å¢äº† `toEmbeddings()` æ–¹æ³•ï¼š

    $embeddings = Str::of('Napa Valley has great wine.')->toEmbeddings();
    

é…åˆ PostgreSQL çš„ pgvector æ‰©å±•ï¼Œå¯ä»¥åœ¨æ•°æ®åº“ä¸­ç›´æ¥è¿›è¡Œå‘é‡ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼š

    $documents = Document::query()
        ->whereVectorSimilarTo('embedding', 'çº³å¸•è°·æœ€å¥½çš„é…’åº„')
        ->limit(10)
        ->get();
    

ä¼ å…¥å­—ç¬¦ä¸²æ—¶ï¼ŒLaravel ä¼šè‡ªåŠ¨ç”ŸæˆåµŒå…¥å‘é‡å†è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸éœ€è¦æ‰‹åŠ¨å¤„ç†ã€‚Embedding è¿˜æ”¯æŒç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨ APIã€‚

Reranking
---------

Reranking å¯ä»¥å¯¹æœç´¢ç»“æœæŒ‰è¯­ä¹‰ç›¸å…³æ€§é‡æ–°æ’åºï¼Œæ”¯æŒ Cohere å’Œ Jinaï¼š

    $posts = Post::all()->rerank('body', 'Laravel æ•™ç¨‹');
    

è¿™ä¸ªåŠŸèƒ½ç›´æ¥ä»¥ Collection å®çš„å½¢å¼æä¾›ï¼Œå¯ä»¥å¯¹ Eloquent é›†åˆæŒ‰æŒ‡å®šå­—æ®µåšè¯­ä¹‰é‡æ’ã€‚

æ–‡ä»¶ä¸å‘é‡å­˜å‚¨
-------

SDK æä¾›äº†æ–‡ä»¶ç®¡ç†å’Œå‘é‡å­˜å‚¨çš„å®Œæ•´æ–¹æ¡ˆã€‚æ–‡ä»¶å¯ä»¥ä¸Šä¼ åˆ°æœåŠ¡å•†å­˜å‚¨ååå¤å¼•ç”¨ï¼Œå‘é‡å­˜å‚¨åˆ™ç”¨äº RAG åœºæ™¯ä¸‹çš„æ–‡ä»¶æ£€ç´¢ï¼š

    use Laravel\Ai\Files\Document;
    use Laravel\Ai\Stores;
    
    // ä¸Šä¼ æ–‡ä»¶
    $stored = Document::fromPath('/path/to/report.pdf')->put();
    
    // åˆ›å»ºå‘é‡å­˜å‚¨å¹¶æ·»åŠ æ–‡ä»¶
    $store = Stores::create('çŸ¥è¯†åº“');
    $store->add($stored);
    

Failover
--------

è°ƒç”¨æ—¶ä¼ å…¥æœåŠ¡å•†æ•°ç»„ï¼ŒSDK ä¼šåœ¨ä¸»æœåŠ¡å•†ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å•†ï¼š

    $response = (new SalesCoach)->prompt(
        'åˆ†æè¿™æ®µå½•éŸ³...',
        provider: ['openai', 'anthropic'],
    );
    

Agent é…ç½®
--------

Agent æ”¯æŒé€šè¿‡ PHP Attribute é…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬æœ€å¤§æ­¥æ•°ã€æœ€å¤§ token æ•°ã€æ¸©åº¦ã€è¶…æ—¶æ—¶é—´ç­‰ï¼š

    #[MaxSteps(10)]
    #[MaxTokens(4096)]
    #[Provider('anthropic')]
    #[Temperature(0.7)]
    #[Timeout(120)]
    class SalesCoach implements Agent
    {
        use Promptable;
    }
    

`UseCheapestModel` å’Œ `UseSmartestModel` ä¸¤ä¸ª Attribute å¯ä»¥è‡ªåŠ¨é€‰æ‹©æœåŠ¡å•†æœ€ä¾¿å®œæˆ–æœ€å¼ºçš„æ¨¡å‹ï¼Œä¸éœ€è¦è®°å…·ä½“çš„æ¨¡å‹åã€‚

ä¸­é—´ä»¶
---

Agent æ”¯æŒä¸­é—´ä»¶æœºåˆ¶ï¼Œå¯ä»¥åœ¨è¯·æ±‚å‘é€å‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ï¼š

    class LogPrompts
    {
        public function handle(AgentPrompt $prompt, Closure $next)
        {
            Log::info('Prompting agent', ['prompt' => $prompt->prompt]);
    
            return $next($prompt)->then(function (AgentResponse $response) {
                Log::info('Agent responded', ['text' => $response->text]);
            });
        }
    }
    

æµ‹è¯•æ”¯æŒ
----

SDK ä¸ºæ¯ä¸ªåŠŸèƒ½éƒ½æä¾›äº† `fake()` æ–¹æ³•å’Œæ–­è¨€ APIï¼Œæµ‹è¯•æ—¶ä¸éœ€è¦çœŸå®è°ƒç”¨ AI æœåŠ¡å•†ï¼š

    SalesCoach::fake(['ç¬¬ä¸€æ¡å“åº”', 'ç¬¬äºŒæ¡å“åº”']);
    
    // æ‰§è¡Œä¸šåŠ¡é€»è¾‘...
    
    SalesCoach::assertPrompted('åˆ†æè¿™æ®µ...');
    SalesCoach::assertNeverPrompted();
    

å›¾åƒã€éŸ³é¢‘ã€è½¬å½•ã€Embeddingsã€Rerankingã€æ–‡ä»¶æ“ä½œã€å‘é‡å­˜å‚¨éƒ½æœ‰å¯¹åº”çš„ fake å’Œæ–­è¨€æ–¹æ³•ã€‚

æœåŠ¡å•†æ”¯æŒä¸€è§ˆ
-------

åŠŸèƒ½

æ”¯æŒçš„æœåŠ¡å•†

æ–‡æœ¬å¯¹è¯

OpenAIã€Anthropicã€Geminiã€Groqã€xAI

å›¾åƒç”Ÿæˆ

OpenAIã€Geminiã€xAI

è¯­éŸ³åˆæˆ

OpenAIã€ElevenLabs

è¯­éŸ³è½¬å½•

OpenAIã€ElevenLabs

å‘é‡åµŒå…¥

OpenAIã€Geminiã€Cohereã€Jina

é‡æ’åº

Cohereã€Jina

æ–‡ä»¶ç®¡ç†

OpenAIã€Anthropicã€Gemini

å°ç»“
--

Laravel AI SDK æŠŠ AI é›†æˆåšæˆäº† Laravel å¼€å‘è€…ç†Ÿæ‚‰çš„æ ·å­ï¼šArtisan å‘½ä»¤ç”Ÿæˆç±»ã€æ¥å£çº¦æŸè¡Œä¸ºã€trait å¤ç”¨é€»è¾‘ã€é˜Ÿåˆ—å¼‚æ­¥å¤„ç†ã€fake æ–¹æ³•å†™æµ‹è¯•ã€‚å¦‚æœä½ çš„ Laravel é¡¹ç›®éœ€è¦æ¥å…¥ AI èƒ½åŠ›ï¼Œè¿™ä¸ªåŒ…å€¼å¾—å°è¯•ã€‚

[ğŸ‰Laravel AI SDK æ­£å¼å‘å¸ƒ](https://catchadmin.com/post/2026-02/laravel-ai-sdk-released)