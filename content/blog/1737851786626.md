---
layout: post
title: '99%的人不知道，桥接模式失败的真正原因是它！'
date: "2025-01-26T00:36:26Z"
---
99%的人不知道，桥接模式失败的真正原因是它！
=======================

前言
==

大家好，我是VoltCary

最近做一些基础设施的部署工作，以手上的kali linux作为集群的节点，因为用到的是虚拟机，且本机网络为无线wifi，现在希望虚拟机像正常独立主机存在网络中，因此不能像正常本地主机一样直接加入网段节点，虚拟机还需要进行网络的配置。

让虚拟机成为wifi无线网络中被搜索的独立机器，经过测试，都是要用到外置无线网卡，思路如下：

**思路 1**：虚拟机直接连接无线 WiFi

**思路 2**：配置桥接模式 桥接模式允许虚拟机直接连接到物理网络，就像它是一个独立的设备，此时虚拟机相当于公司局域网中的一台服务器，可以作为测试使用。

此刻会难住很多新手朋友，明明配置了桥接为什么还是无法桥接成功。 查阅相关文章时，也发现很多人不太懂桥接，他们分不清桥接网络是什么，如果连作者自己也弄不明白原由，非但解决不了问题，写出来的文章容易误导他人。

![](https://files.mdnice.com/user/80803/bf677ecc-d0d1-41ff-b3a3-fad5a944d284.png)

无线网卡简介
======

再谈到桥接之前，先来了解一下无线网卡的基本知识。

先给大家抛出一个疑问： 为什么桥接使用随身wifi能否可以作为虚拟机的无线网卡？为什么随身wifi不可以做到？随身wifi只是作为AP无线路由和给直连电脑共享网络的功能，有的随身wifi只支持作为无线网卡的接收wifi信号的功能，有的都不支持。

这里要结合我们使用无线网卡的场景用途来分析，你是想要做什么事情。如果是安全测试，无线网卡需要具备如下功能：接收wifi信号（部分随身wifi支持）、发送wifi信号（AP模式）、监听模式、注入模式。 所以不是随便一个上网卡、随身wifi都可以具备上述的功能，需要具备混杂模式的无线网卡。

**关于无线安全：** 既然提到了这些内容，顺便说一下无线安全中最基础的wifi破解，一次wifi破解并没有那么容易，这方面的文章中成功案例很多，但大家在实际场景中成功率极低。其实这里面很多问题涉及各种usb无线网卡的问题，要选择正确的无线网卡非常重要。通过本文的学习，想必大家对无线网卡有了初步的了解，对大家选择无线网卡提供一定的参考价值。

**混杂模式：** 这是无线监听和数据包捕获的核心功能，常用于网络分析、渗透测试等场景。 混杂模式通常在无线网卡的监听模式下使用。

下面介绍无线网卡的4个常用功能：

**1\. 接收wifi信号**

功能：无线网卡可以连接到现有的WiFi网络，使设备（如电脑）能够接入互联网。 场景：在Kali Linux中，无线网卡通常用于连接到目标网络，以便进行渗透测试、网络分析或数据包捕获。 解决了上面的思路1：虚拟机直接连接无线wifi。无线网卡支持接收wifi信号即可。 示例：如果你需要测试一个无线网络的安全性，无线网卡可以连接到该网络并捕获数据包。

**2\. 发送WiFi信号（AP模式）**

功能：无线网卡可以配置为“接入点”（Access Point, AP），从而发射WiFi信号，让其他设备连接。 场景：在Kali Linux中，AP模式常用于创建虚假的WiFi热点（Evil Twin攻击）、进行中间人攻击（Man-in-the-Middle, MITM）或测试网络设备的接入安全性。 示例：你可以使用工具如hostapd将无线网卡配置为AP，创建一个与目标网络同名的热点，诱骗用户连接。

**3\. 监听模式（Monitor Mode）**

功能：监听模式允许无线网卡捕获无线网络中的所有数据包，而无需连接到任何网络。 场景：这是Kali Linux中无线网卡的核心功能之一，用于无线安全测试、数据包分析和破解WiFi密码等。 示例：使用工具如Wireshark或airmon-ng，你可以捕获无线网络中的数据包，分析网络流量或寻找安全漏洞。

**4\. 注入模式（Injection Mode）**

功能：注入模式允许无线网卡发送自定义的数据包，用于测试网络的安全性或进行攻击。 场景：常用于WiFi破解（如使用aircrack-ng进行WPA/WPA2破解）或进行无线网络的拒绝服务攻击（DoS）。 示例：通过注入数据包，你可以向目标网络发送伪造的认证请求，以获取网络的响应信息。

桥接：有线与无线
========

首先配置桥接是区分有线网络、无线网络的，每种网络使用不同的桥接方式。先弄清楚一些基本知识，不然基础薄弱的朋友，到最后往往会找不到失败的具体原因。

根据上面2种不同的桥接方式，咱们具体情况具体分析吧。

桥接有线网络
------

本机连接有线网络时，虚拟机桥接有线网络会相对简单，因为有线网络可以直接通过物理接口共享。 注意：是否继续配置静态IP，与有线网络是否支持DHCP、以及虚拟机默认不会启动DHCP客户端有关。

桥接无线网络
------

本机连接无线wifi，桥接用到外置usb无线网卡。由于无线网卡的工作机制限制，无线网卡通常使用点对点协议（Point-to-Point Protocol）与无线接入点通信，每次只能维护一个连接，且不支持多个设备共享同一个物理接口。 因此，桥接模式在无线网卡环境下受到限制，虚拟机的数据包无法直接通过宿主机的无线网卡广播到网络中。不能像有线网卡那样直接支持多个设备共享同一物理接口。同时VMware 等虚拟化软件虽然支持桥接模式，但在无线网卡的场景下无法让虚拟机以独立设备的身份连接到无线网络。且桥接模式需要本机网卡支持混杂模式来监听所有的网络流量，而本机无线网卡为了性能和安全性，通常不允许此操作，因此需要专用的外置无线网卡。

原因分析： 无线网络的连接需要通过无线网卡与无线接入点（如路由器）进行通信，而虚拟机无法直接访问宿主机的无线网卡硬件。因此，桥接无线网络需要额外的配置和适配器支持。

下面是根据前面的桥接部分，进行实践配置。因为之前的无线网卡弄了，以后有机会在写桥接无线网络的内容，先以桥接有线网络做示例：

桥接有线网络：配置教程
===========

1、插入战损的随身wifi （没有有线网络，这里随身wifi只是充当替代有线网络） ![](https://files.mdnice.com/user/80803/0c9ab377-05eb-420a-8c85-c7bfd6cafaa3.jpg) 2、虚拟机桥接设置网卡 设置随身wifi的网卡 ![](https://files.mdnice.com/user/80803/c5b9d2e2-b8fa-4e92-8c83-5751fc446703.png)

3、linux执行ifconfig eth0没有ipv4地址

4、下一步

dhcp作用：在桥接中切换网卡时，自动获取ip

vim /etc/network/interfaces auto eth0 iface eth0 inet dhcp

![](https://files.mdnice.com/user/80803/1c3a3676-a663-45c5-9c04-66fa70732a83.png)

5、ifconfig

获取到了ip

![](https://files.mdnice.com/user/80803/b53996ff-51a7-4c0c-8d35-f4e5dc9ea285.png) 6、访问外网，配置成功

![](https://files.mdnice.com/user/80803/7ad46b49-3be2-45ee-b7d5-d6cbc7ed2dd0.png)

7、网络家庭、公司之间切换 重新设置虚拟机桥接网卡即可

总结
==

桥接模式可以让虚拟机像独立设备一样接入网络，但具体配置会因宿主机网络类型（有线或无线）而有所不同：

*   **有线网络环境**：桥接配置相对简单，只需检查 DHCP 设置和网络连接状态。
    
*   **无线网络环境**：受无线网卡工作机制限制，需要额外配置，建议使用支持接收 WiFi 信号的无线网卡或 USB 无线网卡。
    

通过理解桥接模式的工作原理以及无线网卡的功能，能够更高效地完成网络配置，避免常见的操作误区。如果你在实际操作中遇到问题，欢迎留言讨论！