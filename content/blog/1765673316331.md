---
layout: post
title: '10GB vs 600MB：我们弃用 GitLab，选择了这个轻量级神器'
date: "2025-12-14T00:48:36Z"
---
10GB vs 600MB：我们弃用 GitLab，选择了这个轻量级神器
====================================

最近在开发一个类似魔搭（ModelScope）的AI 模型托管平台，需要为每个项目提供独立的仓库服务。

最初的方案选择了业界熟知的 GitLab ，但很快就遇到了瓶颈：仅仅是基础的代码托管功能，GitLab全套服务（主进程、PostgreSQL 和 Redis ）在运行一段时间后，内存占用一度逼近 10GB。这对于我们的轻量级项目需求而言，无疑是一个难以承受的“资源黑洞”。

**最后我们选择了 Gitea 这个轻量级的自托管 Git 解决方案——它不仅将内存占用从10GB降低到 600MB左右，更重要的是提供了完整的API接口，让我们可以深度集成到自己的 AI 平台中。**

本文将带你快速使用 **Docker 部署 Gitea**，并演示如何创建仓库，以及如何通过 Gitea **REST API** 实现业务定制 。

1 部署前置准备
========

组件

是否必须

用途说明

**数据库（MySQL / PostgreSQL / SQLite）**

✅ 必须

存储核心业务数据：用户、仓库、Issue、PR、权限、LFS 元信息等

**S3 / MinIO（对象存储）**

➖ 可选

用于存储仓库附件、LFS 大文件；没有时使用本地磁盘

**Redis**

➖ 可选

用作缓存、Session、队列后台，提升性能

gitea 支持 sqlite 、mysql8 、pg12 ，因为 sqlite 只支持单进程/线程写，性能极差。

因为笔者使用 MySQL 最多也最熟悉，所以我们选择前置安装 MySQL 8 。安装完 MySQL 后 ，在数据库中新建数据库 gitea （此时，gitea 数据库并没有任何表）。

2 Docker 安装 Gitea
=================

接下来，运行如下命令，使用 Docker 安装 Gitea 。

    docker run -d --name gitea \
    -p 3000:3000 -p 222:22 \
    -v /Users/zhangyong/docker/gitea/data:/data \
    -v /etc/localtime:/etc/localtime:ro \
    -v /etc/timezone:/etc/timezone:ro \
    -e USER_UID=1000 \
    -e USER_GID=1000 \
    --restart always \
    gitea/gitea:latest
    

安装完后第一次访问页面 [http://localhost:3000](http://localhost:3000) :

如图，我们配置了 数据库 Gitea ，然后点击立即安装 。

> 配置选项将写入以下位置: /data/gitea/conf/app.ini

安装完成之后，界面如下：

注册完 root 账号后，进入首页：

3 新建仓库
======

如图，创建仓库的界面和 Github 类似，输入仓库名，即可创建成功：

当我们想克隆 或者 推送仓库时，需要创建用户的 pat （ Access Token ）。

创建成功后，界面如下：

我们将令牌保存好，在克隆仓库时，或者 push 仓库时，需要使用该令牌。

4 调用 API
========

如图，当我们访问：[http://localhost:3000/api/swagger#/repository](http://localhost:3000/api/swagger#/repository) , 可以查看所有的 Gitea 开发 API 。

如图，我们可以将所有的 Gitea API 封装成如下的 Java 服务：

5 总结
====

上图是笔者调研 Gitea 和 GItlab 的对比图，相比之下 ，Gitea 真是轻量级神器 ，能够完美适配公司业务的需求。