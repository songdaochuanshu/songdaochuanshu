---
layout: post
title: 'ã€è®¾è®¡æ¨¡å¼ã€‘å¤–è§‚æ¨¡å¼'
date: "2025-06-28T00:41:11Z"
---
ã€è®¾è®¡æ¨¡å¼ã€‘å¤–è§‚æ¨¡å¼
==========

å¤–è§‚æ¨¡å¼æ·±åº¦è§£æï¼šå¤æ‚ç³»ç»Ÿçš„ç»Ÿä¸€ä¹‹é—¨
------------------

### ä¸€ã€å¤–è§‚æ¨¡å¼æ ¸å¿ƒæ¦‚å¿µ

å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œ**ä¸ºå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€åŒ–çš„ç»Ÿä¸€æ¥å£**ã€‚å®ƒå……å½“ç³»ç»Ÿä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œéšè—ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæä¾›æ›´ç®€æ´ã€æ›´æ˜“ç”¨çš„æ“ä½œæ–¹å¼ã€‚

#### æ ¸å¿ƒä»·å€¼ï¼š

*   âœ… **ç®€åŒ–å¤æ‚ç³»ç»Ÿ**ï¼šæä¾›å•ä¸€å…¥å£ç‚¹ï¼Œé™ä½ä½¿ç”¨é—¨æ§›
*   âœ… **è§£è€¦å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿ**ï¼šå®¢æˆ·ç«¯åªéœ€ä¸å¤–è§‚ç±»äº¤äº’
*   âœ… **æé«˜å¯ç»´æŠ¤æ€§**ï¼šå­ç³»ç»Ÿå†…éƒ¨å˜åŒ–ä¸å½±å“å®¢æˆ·ç«¯
*   âœ… **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**ï¼šé›†ä¸­ç®¡ç†é”™è¯¯å¤„ç†é€»è¾‘

### äºŒã€ä¸ºä»€ä¹ˆéœ€è¦å¤–è§‚æ¨¡å¼ï¼Ÿ

å½“é¢ä¸´ä»¥ä¸‹åœºæ™¯æ—¶ï¼Œå¤–è§‚æ¨¡å¼æ˜¯ç†æƒ³è§£å†³æ–¹æ¡ˆï¼š

1.  **ç³»ç»Ÿè¿‡äºå¤æ‚**ï¼šå¤šä¸ªå­ç³»ç»Ÿç›¸äº’ä¾èµ–ï¼Œè°ƒç”¨æµç¨‹ç¹ç
2.  **å®¢æˆ·ç«¯éœ€è¦ç®€åŒ–æ“ä½œ**ï¼šç”¨æˆ·åªéœ€æ ¸å¿ƒåŠŸèƒ½ï¼Œæ— éœ€äº†è§£å†…éƒ¨ç»†èŠ‚
3.  **åˆ†å±‚æ¶æ„éœ€æ±‚**ï¼šéœ€è¦æ¸…æ™°çš„åˆ†ç•Œçº¿éš”ç¦»ä¸åŒå±‚çº§
4.  **é—ç•™ç³»ç»Ÿé›†æˆ**ï¼šåŒ…è£…æ—§ç³»ç»Ÿæä¾›ç°ä»£åŒ–æ¥å£

graph LR Client --> Facade\[å¤–è§‚ç±»\] Facade --> SubsystemA\[å­ç³»ç»ŸA\] Facade --> SubsystemB\[å­ç³»ç»ŸB\] Facade --> SubsystemC\[å­ç³»ç»ŸC\] SubsystemA --> SubsystemB SubsystemB --> SubsystemC

### ä¸‰ã€å¤–è§‚æ¨¡å¼å®ç°æ–¹å¼

#### 1\. åŸºç¡€å®ç°ï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰

    // å­ç³»ç»Ÿç±»ï¼šåº“å­˜ç®¡ç†
    class InventorySystem {
        public boolean checkStock(String productId, int quantity) {
            System.out.println("æ£€æŸ¥åº“å­˜: " + productId);
            // å®é™…åº“å­˜æ£€æŸ¥é€»è¾‘
            return Math.random() > 0.3; // æ¨¡æ‹Ÿ70%æœ‰è´§
        }
    }
    
    // å­ç³»ç»Ÿç±»ï¼šæ”¯ä»˜å¤„ç†
    class PaymentSystem {
        public boolean processPayment(String userId, double amount) {
            System.out.println("å¤„ç†æ”¯ä»˜: $" + amount);
            // å®é™…æ”¯ä»˜å¤„ç†é€»è¾‘
            return Math.random() > 0.2; // æ¨¡æ‹Ÿ80%æ”¯ä»˜æˆåŠŸ
        }
    }
    
    // å­ç³»ç»Ÿç±»ï¼šç‰©æµé…é€
    class ShippingSystem {
        public String scheduleDelivery(String address) {
            System.out.println("å®‰æ’é…é€è‡³: " + address);
            // å®é™…ç‰©æµè°ƒåº¦é€»è¾‘
            return "TRK-" + System.currentTimeMillis();
        }
    }
    
    // å¤–è§‚ç±»ï¼šç”µå•†å¹³å°æ¥å£
    class ECommerceFacade {
        private InventorySystem inventory = new InventorySystem();
        private PaymentSystem payment = new PaymentSystem();
        private ShippingSystem shipping = new ShippingSystem();
        
        public String placeOrder(String userId, String productId, 
                               int quantity, String address) {
            // æ­¥éª¤1ï¼šæ£€æŸ¥åº“å­˜
            if (!inventory.checkStock(productId, quantity)) {
                throw new RuntimeException("å•†å“åº“å­˜ä¸è¶³");
            }
            
            // æ­¥éª¤2ï¼šå¤„ç†æ”¯ä»˜
            double amount = quantity * 99.9; // è®¡ç®—é‡‘é¢
            if (!payment.processPayment(userId, amount)) {
                throw new RuntimeException("æ”¯ä»˜å¤±è´¥");
            }
            
            // æ­¥éª¤3ï¼šå®‰æ’é…é€
            String trackingId = shipping.scheduleDelivery(address);
            
            return "è®¢å•åˆ›å»ºæˆåŠŸ! è¿å•å·: " + trackingId;
        }
    }
    
    // å®¢æˆ·ç«¯ä½¿ç”¨
    public class Client {
        public static void main(String[] args) {
            ECommerceFacade facade = new ECommerceFacade();
            String result = facade.placeOrder("user123", "P1001", 2, "åŒ—äº¬å¸‚æœé˜³åŒº");
            System.out.println(result);
        }
    }
    

#### 2\. è¿›é˜¶å®ç°ï¼šå¸¦é…ç½®é€‰é¡¹çš„å¤–è§‚

    class SmartHomeFacade {
        private LightingSystem lighting;
        private ClimateSystem climate;
        private SecuritySystem security;
        
        // å¯é…ç½®çš„å­ç³»ç»Ÿ
        public SmartHomeFacade(LightingSystem lighting, 
                              ClimateSystem climate,
                              SecuritySystem security) {
            this.lighting = lighting;
            this.climate = climate;
            this.security = security;
        }
        
        // åœºæ™¯æ¨¡å¼ï¼šç¦»å®¶æ¨¡å¼
        public void awayMode() {
            security.armSystem();
            lighting.turnOffAll();
            climate.setEcoMode();
            System.out.println("ç¦»å®¶æ¨¡å¼å·²æ¿€æ´»");
        }
        
        // åœºæ™¯æ¨¡å¼ï¼šå›å®¶æ¨¡å¼
        public void homeMode() {
            security.disarmSystem();
            lighting.turnOnLivingRoom();
            climate.setComfortMode(22);
            System.out.println("æ¬¢è¿å›å®¶");
        }
    }
    

### å››ã€å¤–è§‚æ¨¡å¼åŸç†æ·±åº¦å‰–æ

#### ğŸ” æ ¸å¿ƒæœºåˆ¶ï¼šæ¥å£æœ€å°åŒ–åŸåˆ™

å¤–è§‚æ¨¡å¼çš„æ ¸å¿ƒæ˜¯éµå¾ª**æ¥å£æœ€å°åŒ–åŸåˆ™**ï¼ˆPrinciple of Least Knowledgeï¼‰ï¼š

> ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ï¼Œåªä¸ç›´æ¥æœ‹å‹é€šä¿¡

é€šè¿‡åˆ›å»ºå¤–è§‚ç±»ï¼š

1.  **å°è£…å¤æ‚äº¤äº’**ï¼šå°†å¤šä¸ªå­ç³»ç»Ÿè°ƒç”¨ç»„åˆä¸ºå•ä¸€æ“ä½œ
2.  **å‡å°‘ä¾èµ–å…³ç³»**ï¼šå®¢æˆ·ç«¯åªä¾èµ–å¤–è§‚ç±»ï¼Œä¸ç›´æ¥ä¾èµ–å­ç³»ç»Ÿ
3.  **ç»Ÿä¸€æ§åˆ¶æµç¨‹**ï¼šç®¡ç†è°ƒç”¨é¡ºåºã€é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

#### âœ¨ è®¾è®¡ä¼˜åŠ¿è§£æ

ç‰¹æ€§

ç›´æ¥è°ƒç”¨å­ç³»ç»Ÿ

å¤–è§‚æ¨¡å¼

**å®¢æˆ·ç«¯å¤æ‚åº¦**

é«˜ï¼ˆéœ€äº†è§£æ‰€æœ‰å­ç³»ç»Ÿï¼‰

ä½ï¼ˆä»…éœ€äº†è§£å¤–è§‚ï¼‰

**è€¦åˆåº¦**

ç´§è€¦åˆï¼ˆå®¢æˆ·ç«¯ä¾èµ–å…·ä½“å­ç³»ç»Ÿï¼‰

æ¾è€¦åˆï¼ˆå®¢æˆ·ç«¯ä»…ä¾èµ–å¤–è§‚ï¼‰

**ç³»ç»Ÿå˜æ›´å½±å“**

ç›´æ¥å½±å“æ‰€æœ‰å®¢æˆ·ç«¯

ä»…éœ€ä¿®æ”¹å¤–è§‚ç±»

**é”™è¯¯å¤„ç†**

åˆ†æ•£åœ¨å„å¤„

é›†ä¸­ç»Ÿä¸€å¤„ç†

### äº”ã€å¤–è§‚æ¨¡å¼é˜²æŠ¤æªæ–½

#### 1\. é˜²æ­¢è¿‡åº¦æš´éœ²å­ç³»ç»Ÿ

    class SecureFacade {
        // ç§æœ‰åŒ–å­ç³»ç»Ÿï¼Œé˜²æ­¢å¤–éƒ¨è®¿é—®
        private SubsystemA subsystemA = new SubsystemA();
        private SubsystemB subsystemB = new SubsystemB();
        
        // ä»…æš´éœ²å¿…è¦æ–¹æ³•
        public void performAction() {
            // ç»„åˆæ“ä½œ...
        }
        
        // ç¦æ­¢ç›´æ¥è®¿é—®å­ç³»ç»Ÿ
        public SubsystemA getSubsystemA() {
            throw new UnsupportedOperationException("ç¦æ­¢ç›´æ¥è®¿é—®å­ç³»ç»Ÿ");
        }
    }
    

#### 2\. æ·»åŠ è®¿é—®æ§åˆ¶å±‚

    class ControlledFacade {
        private Subsystem subsystem;
        private Logger logger = Logger.getLogger("Facade");
        
        public void executePrivilegedAction(User user) {
            if (!user.hasPermission("EXECUTE_ACTION")) {
                logger.warning("æœªæˆæƒè®¿é—®: " + user);
                throw new SecurityException("æƒé™ä¸è¶³");
            }
            
            // æ‰§è¡Œæ“ä½œ...
        }
    }
    

### å…­ã€æ¨¡å¼å¯¹æ¯”ä¸æœ€ä½³å®è·µ

#### å¤–è§‚æ¨¡å¼ vs é€‚é…å™¨æ¨¡å¼

ç‰¹æ€§

å¤–è§‚æ¨¡å¼

é€‚é…å™¨æ¨¡å¼

ç›®çš„

ç®€åŒ–æ¥å£

è½¬æ¢æ¥å£

å¯¹è±¡æ•°é‡

å¤šä¸ªå­ç³»ç»Ÿ

é€šå¸¸ä¸€ä¸ªå¯¹è±¡

æ¥å£å˜åŒ–

åˆ›å»ºæ–°æ¥å£

åŒ¹é…å·²æœ‰æ¥å£

å…¸å‹åœºæ™¯

å¤æ‚ç³»ç»Ÿå°è£…

å…¼å®¹æ—§ç³»ç»Ÿ

#### å¤–è§‚æ¨¡å¼ vs ä¸­ä»‹è€…æ¨¡å¼

ç‰¹æ€§

å¤–è§‚æ¨¡å¼

ä¸­ä»‹è€…æ¨¡å¼

å…³æ³¨ç‚¹

ç®€åŒ–æ¥å£

åè°ƒå¯¹è±¡äº¤äº’

æ–¹å‘æ€§

å•å‘ï¼ˆå®¢æˆ·ç«¯â†’å­ç³»ç»Ÿï¼‰

åŒå‘ï¼ˆå¯¹è±¡é—´é€šä¿¡ï¼‰

å…³ç³»

å±‚æ¬¡å…³ç³»

ç½‘çŠ¶å…³ç³»

ä½¿ç”¨åœºæ™¯

å°è£…å­ç³»ç»Ÿ

ç®¡ç†å¤æ‚å¯¹è±¡äº¤äº’

**æœ€ä½³å®è·µå»ºè®®**ï¼š

1.  **é€‚åº¦ä½¿ç”¨**ï¼šé¿å…åˆ›å»º"ä¸Šå¸å¯¹è±¡"ï¼ˆè¿‡åº¦åºå¤§çš„å¤–è§‚ç±»ï¼‰
2.  **åˆ†å±‚è®¾è®¡**ï¼šå¤šå±‚å¤–è§‚æ¨¡å¼æ„å»ºç³»ç»Ÿå±‚çº§
3.  **ä¸æŠ½è±¡å·¥å‚ç»“åˆ**ï¼šä½¿ç”¨å·¥å‚åˆ›å»ºå¤–è§‚å’Œå­ç³»ç»Ÿ
4.  **ä¿æŒç²¾ç®€**ï¼šå¤–è§‚ç±»ä¸åº”åŒ…å«ä¸šåŠ¡é€»è¾‘

### ä¸ƒã€å…¸å‹åº”ç”¨åœºæ™¯

#### 1\. é‡‘èç³»ç»Ÿäº¤æ˜“å¤„ç†

    class TradingFacade {
        private AccountService accountService;
        private RiskService riskService;
        private OrderService orderService;
        
        public TradeResult executeTrade(TradeRequest request) {
            // 1. éªŒè¯è´¦æˆ·
            if (!accountService.validate(request.accountId())) {
                throw new TradeException("è´¦æˆ·æ— æ•ˆ");
            }
            
            // 2. é£é™©è¯„ä¼°
            RiskRating rating = riskService.assess(request);
            if (rating == RiskRating.HIGH) {
                throw new TradeException("é£é™©è¿‡é«˜");
            }
            
            // 3. æ‰§è¡Œäº¤æ˜“
            return orderService.execute(request);
        }
    }
    

#### 2\. å¤šåª’ä½“å¤„ç†æ¡†æ¶

    class VideoProcessingFacade {
        public void convertVideo(String inputPath, String outputPath, 
                                Format format, Quality quality) {
            // 1. è§£ç è§†é¢‘
            VideoStream stream = VideoDecoder.decode(inputPath);
            
            // 2. å¤„ç†è§†é¢‘
            VideoProcessor.process(stream, 
                new ProcessingOptions(quality));
            
            // 3. ç¼–ç è¾“å‡º
            VideoEncoder.encode(stream, outputPath, format);
            
            // 4. æ¸…ç†èµ„æº
            ResourceManager.release(stream);
        }
    }
    

#### 3\. å¾®æœåŠ¡APIç½‘å…³

    class ApiGateway {
        private UserService userService;
        private ProductService productService;
        private OrderService orderService;
        
        // ç»„åˆAPI
        public UserDashboard getDashboard(String userId) {
            User user = userService.getUser(userId);
            List<Product> recommendations = productService.getRecommendations(userId);
            List<Order> recentOrders = orderService.getRecentOrders(userId, 5);
            
            return new UserDashboard(user, recommendations, recentOrders);
        }
    }
    

### å…«ã€æ€»ç»“

å¤–è§‚æ¨¡å¼æ˜¯ç®¡ç†å¤æ‚ç³»ç»Ÿçš„æœ‰æ•ˆå·¥å…·ï¼š

1.  **æ ¸å¿ƒä¼˜åŠ¿**ï¼š
    
    *   æ˜¾è‘—é™ä½ç³»ç»Ÿä½¿ç”¨å¤æ‚åº¦
    *   å‡å°‘å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿçš„è€¦åˆ
    *   æä¾›ç»Ÿä¸€å…¥å£ç‚¹ç®¡ç†æ“ä½œæµç¨‹
    *   å¢å¼ºç³»ç»Ÿå¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§
2.  **å®ç°è¦ç‚¹**ï¼š
    
    *   å¤–è§‚ç±»åº”ä¸“æ³¨äºç®€åŒ–æ¥å£ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
    *   åˆç†å°è£…å­ç³»ç»Ÿï¼Œé¿å…è¿‡åº¦æš´éœ²å®ç°ç»†èŠ‚
    *   ä½¿ç”¨ä¾èµ–æ³¨å…¥æé«˜å¯æµ‹è¯•æ€§
3.  **åº”ç”¨è­¦ç¤º**ï¼š
    
    *   é¿å…åˆ›å»º"å…¨èƒ½"å¤–è§‚ç±»ï¼ˆè¿åå•ä¸€èŒè´£åŸåˆ™ï¼‰
    *   ä¸è¦å®Œå…¨å±è”½å¿…è¦çš„å­ç³»ç»Ÿè®¿é—®
    *   æ³¨æ„æ€§èƒ½å½±å“ï¼ˆè¿‡åº¦å°è£…å¯èƒ½å¢åŠ è°ƒç”¨å¼€é”€ï¼‰

graph TD A\[ç³»ç»Ÿæ˜¯å¦å¤æ‚ï¼Ÿ\] --> B{å®¢æˆ·ç«¯æ˜¯å¦éœ€è¦ç®€åŒ–æ“ä½œï¼Ÿ} B -->|æ˜¯| C\[ä½¿ç”¨å¤–è§‚æ¨¡å¼\] B -->|å¦| D\[ç›´æ¥è®¿é—®å­ç³»ç»Ÿ\] C --> E\[å®šä¹‰ç»Ÿä¸€æ¥å£\] E --> F\[å°è£…å­ç³»ç»Ÿè°ƒç”¨\] F --> G\[æä¾›ç®€åŒ–æ–¹æ³•\]

> **è®¾è®¡æ ¼è¨€**ï¼šå¤–è§‚æ¨¡å¼ä¸æ˜¯ä¸ºéšè—ç³»ç»Ÿèƒ½åŠ›è€Œç”Ÿï¼Œè€Œæ˜¯ä¸ºæ­ç¤ºç³»ç»Ÿä»·å€¼è€Œå­˜åœ¨ã€‚å¥½çš„å¤–è§‚è®¾è®¡å¦‚åŒç²¾å¦™çš„ç”¨æˆ·ç•Œé¢ï¼Œè®©å¤æ‚æŠ€æœ¯å˜å¾—å¹³æ˜“è¿‘äººã€‚

å¤–è§‚æ¨¡å¼é€šè¿‡æ„å»º"ç³»ç»Ÿä¹‹é—¨"ï¼Œåœ¨ä¿æŒå†…éƒ¨å¤æ‚æ€§çš„åŒæ—¶æä¾›ç®€æ´çš„ä½¿ç”¨ä½“éªŒã€‚å½“æ‚¨çš„ç³»ç»Ÿå‘å±•åˆ°éœ€è¦ä¸ºä¸åŒç”¨æˆ·æä¾›ä¸åŒæŠ½è±¡å±‚çº§æ—¶ï¼Œå¤–è§‚æ¨¡å¼å°†æˆä¸ºæ¶æ„è®¾è®¡ä¸­ä¸å¯æˆ–ç¼ºçš„ç»„æˆéƒ¨åˆ†ã€‚