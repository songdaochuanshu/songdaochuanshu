---
layout: post
title: 'PC端自动化测试实战教程-3-pywinauto 启动PC端应用程序 - 下篇（详细教程）'
date: "2025-04-28T00:42:07Z"
---
PC端自动化测试实战教程-3-pywinauto 启动PC端应用程序 - 下篇（详细教程）
=============================================

### 1.简介

经过上一篇的学习、介绍和了解，pywinauto的强大，不言而喻吧！宏哥讲解和分享的是电脑自带和安装的应用程序。有些小伙伴或者童鞋们已经迫不及待地私信宏哥，如果在电脑中这个应用程序已经启用了，我如何去启动这个已经启动的应用程序呢？各位别急，宏哥今天就会讲解和分享如何启动PC端已经启动的应用程序。

### 2.启动已启动的应用程序

上一篇的例子细心的小伙伴或者童鞋们会发现都是程序没有运行起来的，那么想要启动已经运行起来的程序应该怎么做？

connect() 在要启动自动化应用程序时使用。 要指定已在运行的应用程序，您需要指定以下之一：

*   process：应用程序的进程ID，例如app = Application().connect(process=2341)
*   handle:应用程序窗口的窗口句柄，例如，app = Application().connect(handle=0x010f0c)
*   path:进程的可执行文件的路径（GetModuleFileNameEx用于查找每个进程的路径并与传入的值进行比较），例如：app = Application().connect(path=r"c:\\windows\\system32\\notepad.exe")
*   或者指定窗口的参数的任意组合，这些都被传递给pywinauto.findwindows.find\_elements() 函数。 例如：
*   app = Application().connect(title\_re=".\*Notepad", class\_name="Notepad") 
    

注意: 在使用connect\*()之前，应用程序必须准备好（已启动）。

#### 2.1通过进程号启动

宏哥今天这里以我们熟悉的大鹅QQ为例，进行演示！

1.如果我们想操作一个已经打开的应用程序，可以根据应用的进程号 PID 去操作，先查看应用进程PID，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109093440757-865707973.png)

2.通过connect()方法连接,process参数指定PID，PID是不固定的，每次启动都会变化。

##### 2.1.1代码设计

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109091333468-1213083132.png)

##### 2.1.2参考代码

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-20
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-2-pywinauto 启动PC端应用程序（详细教程）
'''

# 3.导入模块

from pywinauto.application import Application
# 启动QQ
app = Application(backend="uia").connect(process=19288)
print(app)

##### 2.1.3运行代码

1.运行代码，右键Run'Test'，就可以看到控制台输出，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109091245809-1147270947.png)

#### 2.2通过窗口句柄启动

通过窗口句柄的形式打开。问题来了？怎么查看窗口句柄？

1.通过Inspect.exe查看窗口句柄，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250108143301144-1080757887.png)

handle 句柄Inspect.exe查看是16进制的，每次启动也会变化。

因为进程PID和handle 句柄每次启动都会变化，所以我们应该用参数的组合。

2.还可以通过前面说的viewWizard工具进行查看（将放大镜拖到已启动的应用程序），通过下图可以看到窗口的句柄为133326，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109093520547-776488422.gif)

##### 2.2.1代码设计

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109092452371-678914905.png)

##### 2.2.2参考代码

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-20
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-2-pywinauto 启动PC端应用程序（详细教程）
'''

# 3.导入模块

from pywinauto.application import Application
# 启动QQ
app = Application(backend="uia").connect(process=10720,handle=0x1059C)
print(app)

##### 2.2.3运行代码

1.运行代码，右键Run'Test'，就可以看到控制台输出，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109092530580-733148820.png)

根据title 和 class 名称启动，根据title 和 class 名称连接也有缺点，必须窗口在桌面是开着的才行，挂后台的应用无法连上。

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109093925560-963975850.png)

 参考代码如下：

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-20
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-2-pywinauto 启动PC端应用程序（详细教程）
'''

# 3.导入模块

from pywinauto.application import Application
# 启动QQ
app = Application('uia').connect(title\_re="QQ", class\_name="TXGuiFoundation")
print(app)

#### 2.3应用程序路径

1.还可以根据exe应用程序的路径,路径是固定的，但是宏哥运行报错了。如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109094602306-740054501.png)

2.宏哥猜测可能需要配置环境变量，配置好了，就应该可以，宏哥这里由于时间的关系没有实际操作，只是给提供一种解决思路。 

##### 2.3.1代码设计

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109094950030-2013805729.png)

##### 2.3.2参考代码

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-20
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-2-pywinauto 启动PC端应用程序（详细教程）
'''

# 3.导入模块

from pywinauto.application import Application
# 启动QQ
app = Application('uia').connect(path=r'D:\\QQ\\Bin\\QQScLauncher.exe')
print(app)

#### 2.4Desktop() 方法

还有另外一种连接方式, 通过`Desktop` 方法更简单。通过标题的方式打开。以计算器为例演示，有兴趣的自己可以尝试QQ。

##### 2.4.1代码设计

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109100302636-418776889.png)

##### 2.4.2参考代码

# -\*- coding:utf-8 -\*-

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2025-01-20
@author: 北京-宏哥
北京宏哥（微信搜索：北京宏哥，关注宏哥，提前解锁更多测试干货！）
Project: Windows GUI自动化测试-2-pywinauto 启动PC端应用程序（详细教程）
'''

# 3.导入模块
import pywinauto

# 通过窗口打开
app = pywinauto.Desktop()
win \= app\['计算器'\]
print(win)

##### 2.4.3运行代码

1.运行代码，右键Run'Test'，就可以看到控制台输出，如下图所示：

![](https://img2024.cnblogs.com/blog/1232840/202501/1232840-20250109100337645-848464556.png)

### 3.小结

到此PC端自带和安装的应用程序启动，以及已启动的自带和安装的应用程序启动，宏哥讲解和分享就介绍到这里，非常简单就是一句代码搞定。 好了，时间不早了今天就分享到这里，感谢你耐心地阅读！

    为了方便大家在移动端也能看到我分享的博文，现已注册个人微信公众号，扫描左下方二维码即可，欢迎大家关注，有时间会及时分享相关技术博文。  
    为了方便大家互动讨论相关技术问题，现已组建专门的微信群，由于微信群满100，请您扫描右下方宏哥个人微信二维码拉你进群（请务必备注：已关注公众号进群）平时上班忙（和你一样），所以加好友不及时，请稍安勿躁~，欢迎大家加入这个大家庭，我们一起畅游知识的海洋。  
    感谢您花时间阅读此篇文章,如果您觉得这篇文章你学到了东西也是为了犒劳下博主的码字不易不妨打赏一下吧，让博主能喝上一杯咖啡，在此谢过了！  
    如果您觉得阅读本文对您有帮助，请点一下左下角“推荐”按钮，您的“推荐”将是我最大的写作动力！另外您也可以选择【**关注我**】，可以很方便找到我！  
    本文版权归作者和博客园共有，来源网址：[https://www.cnblogs.com/du-hong](https://www.cnblogs.com/du-hong) 欢迎各位转载，但是未经作者本人同意，转载文章之后必须在文章页面明显位置给出作者和原文连接，否则保留追究法律责任的权利！

公众号(关注宏哥)                                                                                 客服微信

![个人微信公众号](https://img2018.cnblogs.com/common/1741949/201911/1741949-20191119095948011-608816619.png) ![个人微信](https://img2018.cnblogs.com/common/1741949/201911/1741949-20191106101257091-849954564.png)