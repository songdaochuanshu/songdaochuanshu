---
layout: post
title: 'FastAPIç¼“å­˜æé€Ÿå®æˆ˜ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Redisä¸ºæ¥å£æ³¨å…¥â€œè®°å¿†â€'
date: "2026-01-16T00:46:27Z"
---
FastAPIç¼“å­˜æé€Ÿå®æˆ˜ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Redisä¸ºæ¥å£æ³¨å…¥â€œè®°å¿†â€
==================================

æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨FastAPIåº”ç”¨ä¸­é›†æˆRediså®ç°é«˜æ•ˆçš„æ•°æ®ç¼“å­˜ã€‚å†…å®¹æ¶µç›–Redisçš„æ ¸å¿ƒä½œç”¨ä¸ä¼˜åŠ¿ã€åœ¨ä¸»è¦æ“ä½œç³»ç»Ÿä¸Šçš„å®‰è£…ä¸é…ç½®æ­¥éª¤ã€å¿…é¡»æŒæ¡çš„å¸¸ç”¨å‘½ä»¤ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ç¼–å†™ä¸€ä¸ªå¯å¤ç”¨çš„ç¼“å­˜è£…é¥°å™¨æ¥æ˜¾è‘—æå‡æ¥å£æ€§èƒ½ï¼Œæœ€ååˆ†äº«ç¼“å­˜ç­–ç•¥çš„æ³¨æ„äº‹é¡¹ä¸è¿›é˜¶æ€è€ƒã€‚

ä½ çš„FastAPIæ¥å£æ˜¯ä¸æ˜¯åœ¨é«˜å¹¶å‘ä¸‹è¶Šæ¥è¶Šæ…¢ï¼Œæ•°æ®åº“é¢‘é¢‘å‘Šè­¦ï¼Ÿ

ä¸€ä¸ªæ¡ˆä¾‹ï¼Œä¸€ä¸ªæ ¸å¿ƒæŸ¥è¯¢æ¥å£ï¼Œåœ¨æ—¥æ´»ä»…5ä¸‡æ—¶ï¼Œå¹³å‡å“åº”æ—¶é—´å°±é£™å‡åˆ°äº†1.2ç§’ã€‚æ’æŸ¥åå‘ç°ï¼Œè¶…è¿‡80%çš„è¯·æ±‚éƒ½åœ¨é‡å¤æŸ¥è¯¢æ•°æ®åº“é‡Œé‚£å‡ æ¡å‡ ä¹ä¸å˜çš„çƒ­ç‚¹æ•°æ®ã€‚åœ¨å¼•å…¥Redisç¼“å­˜åï¼Œè¿™ä¸ªæ¥å£çš„**å¹³å‡å“åº”æ—¶é—´ç›´æ¥é™åˆ°äº†0.2ç§’ä»¥å†…**ï¼Œæ•°æ®åº“è´Ÿè½½ä¸‹é™äº†70%ã€‚è¿™ï¼Œå°±æ˜¯ç¼“å­˜çš„é­”åŠ›ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠå¦‚ä½•ä¸ºä½ FastAPIé¡¹ç›®è£…ä¸ŠRedisè¿™ä¸ªâ€œé«˜é€Ÿç¼“å­˜â€ï¼Œè®©å®ƒæ‹¥æœ‰â€œè®°å¿†â€ï¼Œä¸å†æ¯æ¬¡éƒ½å‚»å‚»åœ°é‡å¤åŠ³åŠ¨ã€‚

ğŸ“– æœ¬æ–‡ä½ å°†å­¦åˆ°ï¼š
----------

ğŸ¯ 1. Redisæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå®ƒæ˜¯ç¼“å­˜çš„é¦–é€‰ï¼Ÿ

ğŸ¯ 2. å¦‚ä½•å¿«é€Ÿå®‰è£…ã€é…ç½®Redisã€‚

ğŸ¯ 3. å¿…é¡»æŒæ¡çš„Redisæ ¸å¿ƒå‘½ä»¤ã€‚

ğŸ¯ 4. ç¼–å†™ä¸€ä¸ªé€šç”¨çš„FastAPIç¼“å­˜è£…é¥°å™¨ï¼Œä¸€åŠ³æ°¸é€¸ã€‚

* * *

ğŸ”§ ç¬¬ä¸€éƒ¨åˆ†ï¼šé—®é¢˜ä¸èƒŒæ™¯ - ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜ï¼Ÿ
------------------------

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯é¤å…ï¼ˆä½ çš„WebæœåŠ¡ï¼‰çš„æœåŠ¡å‘˜ï¼ˆAPIæ¥å£ï¼‰ã€‚æ¯æ¬¡å®¢äººï¼ˆå®¢æˆ·ç«¯ï¼‰ç‚¹ä¸€ä»½â€œä»Šæ—¥ç‰¹è‰²èœâ€ï¼ˆçƒ­é—¨æ•°æ®ï¼‰ï¼Œä½ éƒ½éå¾—è·‘å›åå¨ï¼ˆæ•°æ®åº“ï¼‰é—®å¨å¸ˆä¸€éï¼Œå°½ç®¡è¿™é“èœä¸€å¤©éƒ½ä¸ä¼šå˜ã€‚ç»“æœå°±æ˜¯ï¼Œä½ ç´¯è¶´äº†ï¼Œåå¨ä¹Ÿè¢«ä½ é—®çƒ¦äº†ï¼Œå®¢äººè¿˜å«Œä¸Šèœæ…¢ã€‚

ç¼“å­˜ï¼Œå°±åƒæ˜¯ä½ åœ¨å‰å…æ”¾äº†ä¸ªå°æœ¬å­ï¼ˆRedisï¼‰ã€‚ç¬¬ä¸€æ¬¡æœ‰å®¢äººç‚¹â€œä»Šæ—¥ç‰¹è‰²èœâ€ï¼Œä½ å»åå¨é—®äº†ï¼Œç„¶å**æŠŠèœåå’Œä»·æ ¼è®°åœ¨æœ¬å­ä¸Š**ã€‚æ¥ä¸‹æ¥å†æœ‰å®¢äººç‚¹ï¼Œä½ ç›´æ¥çœ‹ä¸€çœ¼æœ¬å­å°±å‘Šè¯‰ä»–ï¼Œé€Ÿåº¦å¿«äº†åå€ã€‚åªæœ‰å½“ç‰¹è‰²èœæ›´æ¢äº†ï¼ˆæ•°æ®å˜æ›´ï¼‰ï¼Œä½ æ‰éœ€è¦å»æ›´æ–°å°æœ¬å­ã€‚

åœ¨æŠ€æœ¯å±‚é¢ï¼Œç¼“å­˜ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š**1\. æå‡æ•°æ®è¯»å–é€Ÿåº¦**ï¼ˆå†…å­˜è¿œå¿«äºç£ç›˜/ç½‘ç»œï¼‰ï¼›**2\. å‡è½»åç«¯æ•°æ®åº“å‹åŠ›**ã€‚

âš™ï¸ ç¬¬äºŒéƒ¨åˆ†ï¼šRedisæ ¸å¿ƒä¸å®‰è£…é…ç½®
--------------------

### ğŸ¯ Redisæ˜¯ä»€ä¹ˆï¼Ÿ

Redisæ˜¯ä¸€ä¸ªå¼€æºã€åŸºäºå†…å­˜ã€å¯æŒä¹…åŒ–çš„`é”®å€¼å¯¹(Key-Value)`å­˜å‚¨ç³»ç»Ÿã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼ˆå­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆç­‰ï¼‰ï¼Œæ€§èƒ½æé«˜ï¼Œå¸¸è¢«ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚å¯¹äºç¼“å­˜åœºæ™¯ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹ä¸­å®ƒï¼š**å†…å­˜å­˜å‚¨é€Ÿåº¦æå¿«**ã€**æ•°æ®ç»“æ„ä¸°å¯Œ**ã€**æ”¯æŒè®¾ç½®è¿‡æœŸæ—¶é—´**ã€‚

### ğŸ¯ å®‰è£…Redisï¼ˆå„å¹³å°é€šç”¨æ­¥éª¤ï¼‰

**1\. macOS (ä½¿ç”¨Homebrew):**

\- æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œï¼š`brew install redis`

\- å¯åŠ¨æœåŠ¡ï¼š`brew services start redis`

**2\. Linux (ä»¥Ubuntuä¸ºä¾‹):**

\- æ›´æ–°åŒ…ç®¡ç†å™¨ï¼š`sudo apt update`

\- å®‰è£…Redisï¼š`sudo apt install redis-server`

\- å¯åŠ¨æœåŠ¡ï¼š`sudo systemctl start redis`

**3\. Windows:**

å®˜æ–¹ä¸æ”¯æŒWindowsåŸç”Ÿå®‰è£…ï¼Œä½†å¯ä»¥é€šè¿‡ï¼š

\- ä½¿ç”¨WSL2ï¼ˆæ¨èï¼Œåœ¨WSLçš„Ubuntuä¸­æŒ‰Linuxæ–¹æ³•å®‰è£…ï¼‰ã€‚

\- æˆ–ä¸‹è½½å¾®è½¯ç»´æŠ¤çš„æ—§ç‰ˆæœ¬Windowsç§»æ¤ç‰ˆï¼ˆä¸æ¨èç”¨äºç”Ÿäº§ï¼‰ã€‚

å®‰è£…å®Œæˆåï¼Œåœ¨ç»ˆç«¯è¾“å…¥ `redis-cli ping`ï¼Œå¦‚æœè¿”å› `PONG`ï¼Œæ­å–œä½ ï¼ŒRedisæœåŠ¡å·²æˆåŠŸè¿è¡Œï¼

### ğŸ¯ ä½ å¿…é¡»æŒæ¡çš„5ä¸ªRedisç¼“å­˜æ ¸å¿ƒå‘½ä»¤

**1\. SETï¼š è®¾ç½®é”®å€¼å¯¹**

    SET user:1001 '{"name": "Alice", "age": 30}' EX 60
    # é”®ï¼šuser:1001ï¼Œ å€¼ï¼šJSONå­—ç¬¦ä¸²ï¼Œ EX 60è¡¨ç¤º60ç§’åè¿‡æœŸ

**2\. GETï¼š è·å–é”®å¯¹åº”çš„å€¼**

    GET user:1001

**3\. EXISTSï¼š æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨**

    EXISTS user:1001 # è¿”å›1(å­˜åœ¨)æˆ–0(ä¸å­˜åœ¨)

**4\. DELï¼š åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé”®**

    DEL user:1001 user:1002

**5\. TTLï¼š æŸ¥çœ‹é”®çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´(ç§’)**

    TTL user:1001 # è¿”å›å‰©ä½™ç§’æ•°ï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºé”®ä¸å­˜åœ¨

ğŸš€ ç¬¬ä¸‰éƒ¨åˆ†ï¼šFastAPIæ•´åˆRediså®æˆ˜æ¼”ç¤º
--------------------------

ç†è®ºè¯´å†å¤šï¼Œä¸å¦‚ä¸€è¡Œä»£ç ã€‚è®©æˆ‘ä»¬å¼€å§‹å®æˆ˜ï¼Œæ„å»ºä¸€ä¸ªå¸¦ç¼“å­˜çš„FastAPIåº”ç”¨ã€‚

### ğŸ¯ ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

    pip install fastapi uvicorn redis python-dotenv

### ğŸ¯ ç¬¬äºŒæ­¥ï¼šé¡¹ç›®ç»“æ„ä¸é…ç½®

    your_project/
    â”œâ”€â”€ main.py
    â”œâ”€â”€ cache.py
    â”œâ”€â”€ .env
    â””â”€â”€ requirements.txt

åœ¨`.env`æ–‡ä»¶ä¸­é…ç½®Redisè¿æ¥ï¼š

    REDIS_HOST=localhost
    REDIS_PORT=6379
    REDIS_DB=0
    REDIS_PASSWORD=  # é»˜è®¤æ— å¯†ç ï¼Œç”Ÿäº§ç¯å¢ƒä¸€å®šè¦è®¾ï¼
    CACHE_DEFAULT_TTL=3600  # é»˜è®¤ç¼“å­˜è¿‡æœŸæ—¶é—´1å°æ—¶

### ğŸ¯ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºRedisè¿æ¥ä¸ç¼“å­˜å·¥å…·ç±» (cache.py)

    import redis.asyncio as redis  # ä½¿ç”¨å¼‚æ­¥å®¢æˆ·ç«¯
    import json
    from functools import wraps
    from typing import Any, Optional
    import os
    from dotenv import load_dotenv
    
    load_dotenv()
    
    class RedisCache:
        def __init__(self):
            self.redis_client: Optional[redis.Redis] = None
            self.default_ttl = int(os.getenv(â€œCACHE_DEFAULT_TTLâ€, 3600))
    
        async def connect(self):
            """è¿æ¥Redis"""
            if not self.redis_client:
                self.redis_client = redis.Redis(
                    host=os.getenv(â€œREDIS_HOSTâ€, â€œlocalhostâ€),
                    port=int(os.getenv(â€œREDIS_PORTâ€, 6379)),
                    db=int(os.getenv(â€œREDIS_DBâ€, 0)),
                    password=os.getenv(â€œREDIS_PASSWORDâ€),
                    decode_responses=True  # è‡ªåŠ¨è§£ç è¿”å›å­—ç¬¦ä¸²
                )
            return self.redis_client
    
        async def disconnect(self):
            """å…³é—­è¿æ¥"""
            if self.redis_client:
                await self.redis_client.close()
    
        def cache_key(self, func_name: str, *args, **kwargs) -> str:
            """ç”Ÿæˆå”¯ä¸€çš„ç¼“å­˜é”®"""
            # ç®€å•ç¤ºä¾‹ï¼šå°†å‡½æ•°åå’Œå‚æ•°åºåˆ—åŒ–åæ‹¼æ¥
            arg_str = â€œ_â€.join([str(arg) for arg in args])
            kwarg_str = â€œ_â€.join([fâ€œ{k}_{v}â€ for k, v in sorted(kwargs.items())])
            return fâ€œfastapi_cache:{func_name}:{arg_str}:{kwarg_str}â€.strip(â€œ:â€)
    
        async def get(self, key: str) -> Any:
            """ä»ç¼“å­˜è·å–æ•°æ®"""
            if not self.redis_client:
                await self.connect()
            data = await self.redis_client.get(key)
            if data:
                try:
                    return json.loads(data)  # ååºåˆ—åŒ–JSON
                except json.JSONDecodeError:
                    return data  # å¦‚æœä¸æ˜¯JSONï¼Œè¿”å›åŸå§‹å­—ç¬¦ä¸²
            return None
    
        async def set(self, key: str, value: Any, ttl: Optional[int] = None) -> bool:
            """è®¾ç½®ç¼“å­˜"""
            if not self.redis_client:
                await self.connect()
            if isinstance(value, (dict, list)):
                value = json.dumps(value)  # åºåˆ—åŒ–å¤æ‚å¯¹è±¡
            expire_time = ttl if ttl is not None else self.default_ttl
            return await self.redis_client.setex(key, expire_time, value)
    
        async def delete(self, key: str) -> int:
            """åˆ é™¤ç¼“å­˜"""
            if not self.redis_client:
                await self.connect()
            return await self.redis_client.delete(key)
    
    # å…¨å±€ç¼“å­˜å®ä¾‹
    cache = RedisCache()
    
    def cached(ttl: Optional[int] = None):
        """ç¼“å­˜è£…é¥°å™¨ï¼šå¯å¤ç”¨äºä»»ä½•å¼‚æ­¥å‡½æ•°"""
        def decorator(func):
            @wraps(func)
            async def wrapper(*args, **kwargs):
                # ç”Ÿæˆç¼“å­˜é”®
                key = cache.cache_key(func.__name__, *args, **kwargs)
                # å°è¯•ä»ç¼“å­˜è·å–
                cached_result = await cache.get(key)
                if cached_result is not None:
                    print(fâ€œCache HIT for key: {key}â€)
                    return cached_result
                # ç¼“å­˜æœªå‘½ä¸­ï¼Œæ‰§è¡ŒåŸå‡½æ•°
                print(fâ€œCache MISS for key: {key}â€)
                result = await func(*args, **kwargs)
                # å°†ç»“æœå­˜å…¥ç¼“å­˜
                await cache.set(key, result, ttl)
                return result
            return wrapper
        return decorator

### ğŸ¯ ç¬¬å››æ­¥ï¼šåœ¨FastAPIåº”ç”¨ä¸­ä½¿ç”¨ (main.py)

    from fastapi import FastAPI, Depends, HTTPException
    from cache import cache, cached
    import asyncio
    
    app = FastAPI(title=â€œFastAPI Redisç¼“å­˜æ¼”ç¤ºâ€)
    
    # åº”ç”¨å¯åŠ¨å’Œå…³é—­äº‹ä»¶
    @app.on_event(â€œstartupâ€)
    async def startup_event():
        await cache.connect()
        print(â€œâœ… Redis connectedâ€)
    
    @app.on_event(â€œshutdownâ€)
    async def shutdown_event():
        await cache.disconnect()
        print(â€œğŸ‘‹ Redis disconnectedâ€)
    
    # --- æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶çš„æ•°æ®æŸ¥è¯¢å‡½æ•° ---
    async def fetch_user_data_from_db(user_id: int):
        """æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·æ•°æ®ï¼ˆè€—æ—¶æ“ä½œï¼‰"""
        await asyncio.sleep(2)  # æ¨¡æ‹Ÿ2ç§’çš„IOå»¶è¿Ÿ
        return {â€œidâ€: user_id, â€œnameâ€: fâ€œç”¨æˆ·_{user_id}â€, â€œscoreâ€: user_id * 10}
    
    # --- åº”ç”¨ç¼“å­˜çš„æ¥å£ ---
    @app.get(â€œ/user/{user_id}â€)
    @cached(ttl=30)  # ä¸ºæ­¤æ¥å£å•ç‹¬è®¾ç½®30ç§’ç¼“å­˜
    async def get_user(user_id: int):
        """è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¸¦ç¼“å­˜ï¼‰"""
        data = await fetch_user_data_from_db(user_id)
        return {â€œsourceâ€: â€œdatabase (cached later)â€, â€œdataâ€: data}
    
    @app.get(â€œ/user/{user_id}/freshâ€)
    async def get_user_fresh(user_id: int):
        """è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¼ºåˆ¶æŸ¥æ•°æ®åº“ï¼Œä¸ç¼“å­˜ï¼‰"""
        data = await fetch_user_data_from_db(user_id)
        return {â€œsourceâ€: â€œdatabase (fresh)â€, â€œdataâ€: data}
    
    @app.delete(â€œ/cache/user/{user_id}â€)
    async def delete_user_cache(user_id: int):
        """æ‰‹åŠ¨åˆ é™¤æŸä¸ªç”¨æˆ·çš„ç¼“å­˜"""
        # æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ¨¡æ‹Ÿç”Ÿæˆå’Œæ¥å£ä¸€è‡´çš„ç¼“å­˜é”®ï¼Œå®æˆ˜ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é”®ç®¡ç†
        key_pattern = fâ€œfastapi_cache:get_user:{user_id}â€
        deleted = await cache.delete(key_pattern)
        if deleted:
            return {â€œmessageâ€: fâ€Cache for user {user_id} deleted.â€}
        raise HTTPException(status_code=404, detail=â€œCache key not foundâ€)
    
    if __name__ == â€œ__main__â€:
        import uvicorn
        uvicorn.run(â€œmain:appâ€, host=â€œ0.0.0.0â€, port=8000, reload=True)

ç°åœ¨ï¼Œè¿è¡Œ`python main.py`å¹¶è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„APIæ–‡æ¡£ã€‚

**æµ‹è¯•æ•ˆæœï¼š**

\- é¦–æ¬¡è®¿é—® `/user/1`ï¼Œä¼šç­‰å¾…çº¦2ç§’ï¼Œè¿”å›æ¥æºä¸º`database`ã€‚

\- **30ç§’å†…**å†æ¬¡è®¿é—® `/user/1`ï¼Œç¬é—´è¿”å›ï¼Œæ¥æºæ•°æ®æ¥è‡ªç¼“å­˜ï¼Œæ§åˆ¶å°ä¼šæ‰“å°`Cache HIT`ã€‚

\- è®¿é—® `/user/1/fresh` åˆ™æ€»æ˜¯è®¿é—®â€œæ•°æ®åº“â€ã€‚

\- è°ƒç”¨ `DELETE /cache/user/1` å¯ä»¥æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ã€‚

ğŸ’¡ ç¬¬å››éƒ¨åˆ†ï¼šæ³¨æ„äº‹é¡¹ä¸è¿›é˜¶æ€è€ƒ
-----------------

**1\. ç¼“å­˜ç©¿é€ï¼š** æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®ï¼ˆå¦‚`user_id=-1`ï¼‰ï¼Œç¼“å­˜æ°¸è¿œä¸ä¼šå‘½ä¸­ï¼Œè¯·æ±‚æ¯æ¬¡éƒ½æ‰“åˆ°æ•°æ®åº“ã€‚

\- **è§£å†³æ–¹æ¡ˆï¼š** å³ä½¿æ²¡æŸ¥åˆ°æ•°æ®ï¼Œä¹Ÿç¼“å­˜ä¸€ä¸ªç©ºå€¼æˆ–ç‰¹æ®Šæ ‡è®°ï¼ˆå¦‚`NULL`ï¼‰ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ã€‚

**2\. ç¼“å­˜é›ªå´©ï¼š** å¤§é‡ç¼“å­˜é”®åœ¨åŒä¸€æ—¶åˆ»è¿‡æœŸï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚ç¬é—´æ¶Œå‘æ•°æ®åº“ã€‚

\- **è§£å†³æ–¹æ¡ˆï¼š** ä¸ºç¼“å­˜è¿‡æœŸæ—¶é—´æ·»åŠ ä¸€ä¸ªéšæœºå€¼ï¼ˆå¦‚`åŸºç¡€TTL + random.randint(0, 300)`ï¼‰ï¼Œé¿å…é›†ä½“å¤±æ•ˆã€‚

**3\. ç¼“å­˜æ›´æ–°ç­–ç•¥ï¼š** æ•°æ®å˜æ›´æ—¶ï¼Œå¦‚ä½•åŒæ­¥æ›´æ–°ç¼“å­˜ï¼Ÿå¸¸ç”¨â€œå†™æ—¶åˆ é™¤â€ï¼ˆCache-Asideï¼‰ã€‚

\- æ›´æ–°æ•°æ®åº“åï¼Œ**ç«‹å³åˆ é™¤**å¯¹åº”çš„ç¼“å­˜é”®ã€‚ä¸‹æ¬¡è¯»å–æ—¶è‡ªç„¶å›æºå¹¶é‡æ–°ç¼“å­˜ã€‚

**4\. åºåˆ—åŒ–ï¼š** ç¼“å­˜å¤æ‚å¯¹è±¡ï¼ˆå¦‚Pydanticæ¨¡å‹ï¼‰æ—¶ï¼Œè¦ç¡®ä¿å®ƒä»¬èƒ½è¢«JSONåºåˆ—åŒ–ã€‚å¯ä»¥ä½¿ç”¨`.dict()`æ–¹æ³•å°†å…¶è½¬ä¸ºå­—å…¸ã€‚

**5\. é”®çš„è®¾è®¡ï¼š** æ¸…æ™°çš„é”®å‘½åç©ºé—´ï¼ˆå¦‚`app:entity:id`ï¼‰ä¾¿äºç®¡ç†å’Œæ‰¹é‡æ“ä½œï¼ˆä½¿ç”¨`KEYS`æˆ–`SCAN`å‘½ä»¤ï¼Œç”Ÿäº§ç¯å¢ƒæ…ç”¨`KEYS`ï¼‰ã€‚

**6\. æœ€é‡è¦çš„ä¸€ç‚¹ï¼š** **ç¼“å­˜ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨ç©ºé—´æ¢æ—¶é—´çš„æƒè¡¡ã€‚** ä¸è¦ç¼“å­˜é¢‘ç¹å˜åŒ–çš„æ•°æ®ã€æå°ç»“æœé›†æˆ–å·²ç»å¾ˆå¿«çš„æŸ¥è¯¢ã€‚å§‹ç»ˆç›‘æ§ç¼“å­˜å‘½ä¸­ç‡ï¼Œå®ƒæ˜¯è¡¡é‡ç¼“å­˜æ•ˆç›Šçš„å…³é”®æŒ‡æ ‡ã€‚

* * *

\---**å†™åœ¨æœ€å**\---  
å¸Œæœ›è¿™ä»½æ€»ç»“èƒ½å¸®ä½ é¿å¼€ä¸€äº›å‘ã€‚å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œä¸å¦¨ç‚¹ä¸ª èµğŸ‘ æˆ– æ”¶è—â­ æ ‡è®°ä¸€ä¸‹ï¼Œæ–¹ä¾¿éšæ—¶å›é¡¾ã€‚ä¹Ÿæ¬¢è¿å…³æ³¨æˆ‘ï¼Œåç»­ä¸ºä½ å¸¦æ¥æ›´å¤šç±»ä¼¼çš„å®æˆ˜è§£æã€‚æœ‰ä»»ä½•ç–‘é—®æˆ–æƒ³æ³•ï¼Œæˆ‘ä»¬è¯„è®ºåŒºè§ï¼Œä¸€èµ·äº¤æµå¼€å‘ä¸­çš„å„ç§å¿ƒå¾—ä¸é—®é¢˜ã€‚