---
layout: post
title: 'ä¸–äº‹æ´æ˜çš†å­¦é—® â€” å¦‚ä½•ç†è§£ OB 4.x ç‰ˆæœ¬ä¸­çš„æ—¥å¿—æµï¼Ÿ'
date: "2025-06-17T00:42:21Z"
---
ä¸–äº‹æ´æ˜çš†å­¦é—® â€” å¦‚ä½•ç†è§£ OB 4.x ç‰ˆæœ¬ä¸­çš„æ—¥å¿—æµï¼Ÿ
------------------------------

è‡ª OB V4 ç‰ˆæœ¬æ¨å‡º â€œå•æœºåˆ†å¸ƒå¼ä¸€ä½“åŒ–â€ æ¶æ„åï¼Œæå‡ºä¸€ä¸ªæ–°æ¦‚å¿µâ€œæ—¥å¿—æµâ€ï¼Œè¿™ä¸ªä¼°è®¡æ˜¯ V4 ç‰ˆæœ¬é‡Œæœ€éš¾ç†è§£çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå³ä½¿ OB V4 ä»¥å‰ç‰ˆæœ¬çš„ç”¨æˆ·ä¹Ÿéš¾å…å›°æƒ‘ã€‚æœ¬æ–‡å°±åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹è¿™ä¸ªè®¾è®¡çš„ç†è§£ã€‚

é¦–å…ˆä¸ºå¤§å®¶æ¨èè¿™ä¸ª OceanBase å¼€æºè´Ÿè´£äººè€çºªçš„å…¬ä¼—å· â€œè€çºªçš„æŠ€æœ¯å” å—‘å±€â€ï¼Œä¼šæŒç»­æ›´æ–°å’Œ #**æ•°æ®åº“**ã€#**AI**ã€**#æŠ€æœ¯æ¶æ„** ç›¸å…³çš„å„ç§æŠ€æœ¯å†…å®¹ã€‚æ¬¢è¿æ„Ÿå…´è¶£çš„æœ‹å‹ä»¬å…³æ³¨ï¼

> æœ€è¿‘ä¸ DBA è¿›é˜¶æ•™ç¨‹ç¾¤å’Œç¤¾åŒºè®ºå›çš„å°ä¼™ä¼´äº¤æµæ—¶ï¼Œå¾ˆå¤šäººéƒ½çº·çº·æå‡ºåŒä¸€ä¸ªé—®é¢˜ï¼šè°èƒ½å‘Šè¯‰æˆ‘åˆ°åº•ä»€ä¹ˆå« â€œæ—¥å¿—æµâ€ ï¼Ÿ
> 
> ä»Šå¤©å°±ä¸ºå¤§å®¶åˆ†äº«ä¸€ç¯‡åº†æ¶›å¤§ä½¬æœ€è¿‘çš„åšå®¢æ–‡ç« ï¼Œæ¥ä¸ºå¤§å®¶è§£é‡Š OceanBase ä¸­è¿™ä¸ªæœ€éš¾ç†è§£çš„ â€œæ—¥å¿—æµâ€ æ¦‚å¿µã€‚
> 
> æœ¬ç¯‡å†…å®¹å¹²è´§è¾ƒå¤šï¼Œå¤§å®¶å¯ä»¥é€‰æ‹©æ„Ÿå…´è¶£çš„éƒ¨åˆ†è¿›è¡Œé˜…è¯»ã€‚å¦‚æœå¸Œæœ›ç›´å¥”ä¸»é¢˜ï¼Œå¯ä»¥ç›´æ¥ä»æ–‡ä¸­ â€œå¤šå‰¯æœ¬åŒæ­¥çš„ç²’åº¦â€ å¼€å§‹é˜…è¯»ã€‚

è‡ª OB V4 ç‰ˆæœ¬æ¨å‡º â€œå•æœºåˆ†å¸ƒå¼ä¸€ä½“åŒ–â€ æ¶æ„åï¼Œæå‡ºä¸€ä¸ªæ–°æ¦‚å¿µâ€œæ—¥å¿—æµâ€ï¼Œè¿™ä¸ªä¼°è®¡æ˜¯ V4 ç‰ˆæœ¬é‡Œæœ€éš¾ç†è§£çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå³ä½¿ OB V4 ä»¥å‰ç‰ˆæœ¬çš„ç”¨æˆ·ä¹Ÿéš¾å…å›°æƒ‘ã€‚æœ¬æ–‡å°±åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹è¿™ä¸ªè®¾è®¡çš„ç†è§£ã€‚

æ—¥å¿—æµè™½ç„¶æ˜¯æ–°åè¯ï¼Œä½†å®ƒè¦è§£å†³çš„é—®é¢˜å´æ˜¯æ•°æ®åº“æœ€åŸºæœ¬çš„ä¹Ÿæ˜¯æ ¸å¿ƒçš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯ä»€ä¹ˆæ–°çš„é—®é¢˜ã€‚æ‰€ä»¥æˆ‘å…ˆä»æ•°æ®åº“åŸºæœ¬åŸç†è¯´èµ·ã€‚

æ•°æ®åº“äº‹åŠ¡æ—¥å¿—
=======

æ•°æ®åº“æ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½†å¹¶ä¸æ˜¯å­˜å‚¨æ•°æ®çš„å”¯ä¸€é€‰é¡¹ã€‚åœ¨æ•°æ®åº“è¯ç”Ÿä¹‹å‰ï¼Œæ–‡ä»¶ä¹Ÿå¯ä»¥å­˜å‚¨æ•°æ®ã€‚

åªæ˜¯ç°åœ¨å¤§å®¶ä¹‹æ‰€ä»¥æŠŠæ•°æ®æ”¾åœ¨æ•°æ®åº“é‡Œè€Œä¸æ˜¯æ”¾åœ¨æ–‡ä»¶é‡Œæœ‰å¾ˆå¤šåŸå› ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯æ–‡ä»¶å¦‚æœæŸåäº†å¯èƒ½å°±æ‰“ä¸å¼€äº†ï¼Œé‚£æ•°æ®å°±ä¸¢äº†ã€‚åŸå› ä¹‹äºŒæ˜¯ä¹Ÿæ”¾ä¸äº†å¤ªå¤šçš„æ•°æ®ï¼Œæ•°æ®å¤ªå¤šçš„æ—¶å€™å‡ºæ•…éšœçš„æ¦‚ç‡æ›´å¤§ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–æ›´é‡è¦çš„åŸå› å°±æ˜¯æ•°æ®åº“å…³ç³»æ¨¡å‹å’ŒSQLè¯­è¨€çš„æˆåŠŸã€‚é‚£äº›åœ¨è¿™é‡Œå€’ä¸æ˜¯é‡ç‚¹ã€‚

æ–‡ä»¶æ˜¯æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œï¼Œæ–‡ä»¶æŸåçš„ä¸€ç±»åŸå› å¾€å¾€æ˜¯æ–‡ä»¶ç³»ç»ŸæŸåã€‚å¦‚æœºå™¨å®•æœºé‡å¯ï¼Œæ–‡ä»¶çš„å†…å®¹è¿˜åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜é‡Œï¼Œå¿½ç„¶æ‰ç”µä¸€ä¸‹å­å°±æ²¡äº†ã€‚æ–‡ä»¶ç³»ç»Ÿå¯¹æ­¤ä¹Ÿæœ‰ä¸€äº›è®¾è®¡ï¼Œæ¯”å¦‚è¯´å†™å…ƒæ•°æ®ï¼Œå†™æ–‡ä»¶ç³»ç»Ÿè‡ªå·±çš„æ—¥å¿—ã€‚æœºå™¨é‡å¯åæ–‡ä»¶ç³»ç»Ÿå¯ä»¥è‡ªå·±æ‰«ææ—¥å¿—ï¼Œåšä¸€äº›æ•°æ®æ¢å¤é€»è¾‘ã€‚è¿™ä¸ªæœ‰ä¸€å®šä½œç”¨ä½†å¹¶ä¸æ¯æ¬¡éƒ½æœ‰ç”¨ã€‚å¶å°”æˆ‘ä»¬è¿˜æ˜¯èƒ½å‘ç°æ–‡ä»¶æŸåï¼Œè¿™ä¾èµ–æ–‡ä»¶ç³»ç»Ÿçš„èƒ½åŠ›ã€‚æ•°æ®åº“çš„æ–‡ä»¶å¤§éƒ¨åˆ†ä¹Ÿåœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œï¼ˆORACLE åœ¨ AIX ç³»ç»Ÿé‡Œæ•°æ®æ–‡ä»¶ç”¨è£¸è®¾å¤‡ä¾‹å¤–ï¼‰ï¼Œæ•°æ®åº“çš„æ•°æ®éå¸¸é‡è¦ï¼Œæ˜¾ç„¶ä¸èƒ½é æ–‡ä»¶ç³»ç»Ÿé‚£ç‚¹æ¢å¤èƒ½åŠ›ã€‚

æ‰€ä»¥æ•°æ®åº“åœ¨å†™æ•°æ®æ–‡ä»¶ä¹‹å‰è¿˜ä¼šåŒæ­¥å†™ä¸€ä»½æ•°æ®çš„ä¿®æ”¹æ—¥å¿—ï¼Œä¹Ÿå°±æ˜¯ REDO æ—¥å¿—ã€‚è¿™ä¸ªæŠ€æœ¯å« `Write Ahead Logging` æŠ€æœ¯ã€‚å¯ä»¥è¯´æ‰€æœ‰çš„å…³ç³»æ•°æ®åº“éƒ½æœ‰è¿™ä¸ªè®¾è®¡ã€‚ORACLE å« REDO æ—¥å¿—ï¼ŒPostgreSQL å« `pg_log`ï¼ŒMySQL å« `Innodb REDO` æ—¥å¿— å’Œ `Binary` æ—¥å¿—ï¼ŒSQLServer å« `ldf` æ–‡ä»¶ã€‚ è¿™ä»½äº‹åŠ¡æ—¥å¿—å¯¹æ•°æ®åº“éå¸¸é‡è¦ï¼Œæ‰€ä»¥æœ‰äº›æ•°æ®åº“å¤‡ä»½è¿˜è¦å¤‡ä»½è¿™ä¸ªæ—¥å¿—ã€‚ORACLE çš„å½’æ¡£æ—¥å¿—å°±æ˜¯å¯¹ REDO æ—¥å¿—çš„å¤‡ä»½ï¼ˆç„¶å DBA å†äºŒæ¬¡å¤‡ä»½å½’æ¡£æ—¥å¿—ï¼‰ï¼ŒMySQL çš„ Binary æ—¥å¿—ä¹Ÿæœ‰å½’æ¡£è®¾è®¡ã€‚

ä¼ ç»Ÿæ•°æ®åº“ä¸»å¤‡åŒæ­¥
=========

äº‹åŠ¡æ—¥å¿—çš„å¯é æ€§å†³å®šäº†æ•°æ®åº“çš„å¯é æ€§ã€‚äº‹åŠ¡æ—¥å¿—ä¸€èˆ¬éƒ½æ˜¯å®æ—¶è½ç›˜ï¼ˆå†™åˆ°ç£ç›˜å†…è€Œä¸æ˜¯ç¼“å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿé‡Œã€‚MySQL çš„é»˜è®¤è®¾ç½®ä¸ºä»€ä¹ˆä¸é‚£ä¹ˆå¯é å°±æ˜¯å› ä¸ºå®ƒè¿èƒŒäº†è¿™ä¸ªåŸåˆ™ï¼‰ã€‚

ä½†æ˜¯å¦‚æœç£ç›˜æŸåäº†ï¼Œè¿˜æ˜¯æœ‰å¯èƒ½å¯¼è‡´äº‹åŠ¡æ—¥å¿—ä¹Ÿåäº†ï¼Œå¼ºåˆ¶æ‰“å¼€æ•°æ®åº“å¯èƒ½ä¼šä¸¢ä¸€ç‚¹ç‚¹æ•°æ®ã€‚æ‰€ä»¥æ•°æ®åº“è¿˜æ˜¯æœ‰é‚£ä¹ˆä¸€ç‚¹é£é™©ã€‚åº”å¯¹è¿™ä¸ªé£é™©çš„æ–¹æ³•å°±æ˜¯å¦å¤–æ‰¾ä¸€å°æœåŠ¡å™¨å†åšä¸€ä¸ªæ•°æ®åº“çš„å‰¯æœ¬ã€‚æ‰€è°“å‰¯æœ¬å°±æ˜¯æ•°æ®å®Œå…¨ä¸€è‡´çš„ã€‚è¦ä¿éšœå‰¯æœ¬æ•°æ®ä¸€è‡´å°±è¦ç”¨åˆ°æ•°æ®åŒæ­¥æŠ€æœ¯ã€‚å½“æ–°å¢äº†ä¸€ä¸ªå‰¯æœ¬çš„æ—¶å€™ï¼Œä¸å¦¨æŠŠåŸæ¥çš„æ•°æ®ç§°ä½œä¸ºä¸»å‰¯æœ¬ï¼Œæ–°çš„æ•°æ®ç§°ä¸ºå¤‡å‰¯æœ¬ã€‚ä¸»å¤‡å‰¯æœ¬é—´æ•°æ®åŒæ­¥å°±æ˜¯ä¿è¯å¤‡å‰¯æœ¬æ•°æ®ä¸€è‡´çš„æŠ€æœ¯ã€‚è¿™ä¸ªåŒæ­¥å®é™…ä¸Šå¹¶ä¸æ˜¯æ•°æ®åŒå†™ï¼Œè€Œæ˜¯åŒæ­¥ä¸»å‰¯æœ¬ä¸Šçš„äº‹åŠ¡æ—¥å¿—åˆ°å¤‡å‰¯æœ¬ä¸Šå¹¶åœ¨å¤‡å‰¯æœ¬ä¸Šåº”ç”¨è¿™ä¸ªæ—¥å¿—ã€‚

ORACLE çš„ `Dataguard` æŠ€æœ¯ï¼ŒSQLServer çš„ `Mirror` å¤åˆ¶æŠ€æœ¯éƒ½æ˜¯ä¸»å¤‡åŒæ­¥ã€‚ä»–ä»¬çš„ç‰¹ç‚¹æ˜¯æ•´ä¸ªæ•°æ®åº“åšä¸»å¤‡åŒæ­¥ï¼Œå¤‡åº“ï¼ˆä¹Ÿå°±æ˜¯å¤‡å‰¯æœ¬ï¼‰è·Ÿä¸»åº“çš„æ•°æ®åªå¯èƒ½æœ‰å»¶æ—¶ä¸ä¼šæœ‰ä¸¢å¤±ã€‚é€šä¿—ä¸€ç‚¹è¯´æ‰€æœ‰è¡¨éƒ½åŒæ­¥ã€‚MySQL çš„ä¸»ä»å¤åˆ¶ä¹Ÿå±äºè¿™ä¸€ç±»æŠ€æœ¯ï¼Œä½†æ˜¯ MySQL ç©äº†ä¸€ç‚¹èŠ±æ ·ï¼Œå¯ä»¥å®šåˆ¶è¡¨çš„åŒæ­¥ã€‚æ­¤å¤– MySQL çš„ `Binary Log` é‡Œè®°å½•çš„æ˜¯æ•°æ®å˜åŒ–çš„ SQLæˆ–è€…æ•°æ®è¡Œå˜åŒ–çš„SQLï¼Œè¿™å¯¼è‡´ MySQL çš„å¤‡åº“æœ‰ä¸€å®šæ¦‚ç‡è·Ÿä¸»åº“å¹¶ä¸å®Œå…¨ä¸€è‡´ã€‚çµæ´»å€’æ˜¯çµæ´»ï¼Œå¯é æ€§å°±ä¸‹é™äº†ã€‚ä¸è¿‡è¿™é‡Œè¯´çš„è¿˜æ˜¯åŒæ­¥çš„ç²’åº¦ï¼ŒORACLE æœ€å°ç²’åº¦æ˜¯æ•°æ®åº“å®ä¾‹çº§åˆ«çš„åŒæ­¥ï¼ˆORACLE æ²¡æœ‰ç»†åˆ†æ•°æ®åº“çš„æ¦‚å¿µï¼‰ï¼ŒSQLServer æœ€å°ç²’åº¦æ˜¯æ•°æ®åº“çº§åˆ«çš„åŒæ­¥ã€‚MySQL æœ€å°æ˜¯æ•°æ®åº“çº§åˆ«çš„åŒæ­¥ï¼ˆåªæ˜¯å¯ä»¥è®¾ç½®å“ªäº›è¡¨åŒæ­¥æˆ–è€…ä¸åŒæ­¥ï¼‰ã€‚

æ•°æ®åŒæ­¥è¿˜æœ‰ä¸ªæ–¹å‘é—®é¢˜ã€‚ORACLE å’Œ SQLServer çš„æ•°æ®åŒæ­¥éƒ½æ˜¯ä¸»å¤‡åŒæ­¥ï¼Œæ˜¯å•å‘çš„ã€‚SQLServer æ˜¯å®ä¾‹é‡ŒåŒ…å«å¤šä¸ªæ•°æ®åº“ï¼Œä¸¤ä¸ªå®ä¾‹ä¹‹é—´ä¸åŒæ•°æ®åº“çš„åŒæ­¥æ–¹å‘å¯ä»¥æœ‰ä¸åŒæ–¹å‘ã€‚æ‰€ä»¥æ•°æ®åº“çº§åˆ«æ˜¯å•å‘çš„ï¼Œå®ä¾‹çº§åˆ«æœ‰å¯èƒ½æ˜¯åŒå‘çš„ã€‚MySQL æœ€çµæ´»ï¼Œæ•°æ®åº“çº§åˆ«éƒ½å¯ä»¥**åŒå‘åŒæ­¥**ï¼ˆä¹Ÿå°±æ˜¯é€šå¸¸è¯´çš„ `Master-Master` åŒæ­¥ã€‚å“ªæ€•æ˜¯åŒä¸€ä¸ªè¡¨éƒ½èƒ½å¤ŸåŒå‘åŒæ­¥ã€‚åŒä¸€ä¸ªè¡¨åŒå‘åŒæ­¥æœ€å¤§çš„é£é™©å°±æ˜¯æ•°æ®äº¤å‰è¦†ç›–ï¼Œè¿™ä¸ªå¯¹ä¸šåŠ¡æ˜¯ä¸€ä¸ªç¾éš¾ã€‚DBA å¦‚æœæ§åˆ¶ä¸äº†è¿™ç§é£é™©é‚£è¿˜æ˜¯åˆ«ç”¨åŒå‘åŒæ­¥ã€‚

MySQL åŒå‘åŒæ­¥çš„èƒ½åŠ›åœ¨ç‰¹æ®Šçš„åœºæ™¯ä¸‹æœ‰å¾ˆå¤§ä½œç”¨ã€‚å¦‚é˜¿é‡Œå·´å·´ç”µå•†ä¸šåŠ¡æ•°æ®ä¸‰åœ°å¤šä¸­å¿ƒå•å…ƒåŒ–å¤šæ´»æ¶æ„ä¸­å°±å¤§é‡ä½¿ç”¨ï¼Œé‚£æ˜¯å› ä¸ºä¸šåŠ¡èƒ½ä¿è¯æ¯ä¸ªåœ°åŒºï¼ˆå•å…ƒï¼‰å†™å…¥çš„æ•°æ®äº’ä¸å†²çªã€‚æ¯”å¦‚è¯´ç”¨æˆ·æ•°æ®ï¼Œæ¯ä¸ªæ·˜å®ç”¨æˆ·è¯»å†™æ•°æ®æ—¶å¯èƒ½éƒ½è¢«è·¯ç”±åˆ°ä¸åŒçš„å•å…ƒä¸­å¿ƒæœºæˆ¿é‡Œçš„æ•°æ®åº“ã€‚å®ƒåšåˆ°äº†åŒä¸€ä¸ªè¡¨çš„åŒä¸€è®°å½•å†™å…¥ç‚¹æ˜¯å•ä¸€çš„ï¼Œè¡¨çº§åˆ«å‘ˆç°çš„æ˜¯å¤šç‚¹å†™å…¥èƒ½åŠ›ã€‚ORACLE å’Œ SQLServer çš„ä¸»å¤‡åº“éƒ½æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›ã€‚ä½†æ˜¯ä»–ä»¬æœ‰è‡ªå·±çš„é›†ç¾¤äº§å“ï¼Œæ•°æ®è¯»å†™ä¹Ÿæ˜¯å¯ä»¥å¤šèŠ‚ç‚¹è¯»å†™ï¼Œåªä¸è¿‡æ•°æ®å­˜å‚¨æ˜¯åŒä¸€ä»½ï¼ˆå…±äº«å­˜å‚¨ï¼‰ã€‚è¿™æ˜¯å¦å¤–ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚

å¤šå‰¯æœ¬çš„å‰¯æœ¬
======

ç°åœ¨å›åˆ°åˆ†å¸ƒå¼æ•°æ®åº“ã€‚æ‰€æœ‰åˆ†å¸ƒå¼æ•°æ®åº“éƒ½æœ‰ä¸¤ä¸ªå…±åŒç‚¹ã€‚ä¸€æ˜¯æ•°æ®å­˜å‚¨ä½¿ç”¨åˆ†å¸ƒå¼æŠ€æœ¯æ‹†åˆ†ï¼ŒäºŒæ˜¯æ•°æ®æœ‰å¤šå‰¯æœ¬ã€‚å‰è€…æ•°æ®æ‹†åˆ†åä¼šæœ‰å¤šä¸ªåˆ†ç‰‡ã€‚è¿™é‡Œé¢å¤–è¯´ä¸€ä¸‹å‰¯æœ¬æ¦‚å¿µå’Œåˆ†ç‰‡æ¦‚å¿µçš„åŒºåˆ«ï¼Œå‰¯æœ¬æ˜¯ `replica`ï¼Œåˆ†ç‰‡æ˜¯`partition`ã€‚MySQL çš„åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆä¸­åˆ†è¡¨ï¼Œå¯¹åº”è¿™é‡Œçš„åˆ†ç‰‡æ¦‚å¿µã€‚ORACLE çš„åˆ†åŒºè¡¨çš„åˆ†åŒºå¯¹åº”ä¹Ÿæ˜¯åˆ†ç‰‡çš„æ¦‚å¿µã€‚åˆ†ç‰‡æ¦‚å¿µæ˜¯å±äºåˆ†å¸ƒå¼æŠ€æœ¯ï¼Œæœ¬æ–‡ä¸è®¨è®ºåˆ†ç‰‡æ¦‚å¿µï¼Œåªæ˜¯å›´ç»•å‰¯æœ¬æ¦‚å¿µè§£é‡Šã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ä¸€èˆ¬åˆ†å¸ƒå¼æ•°æ®åº“çš„å¤šå‰¯æœ¬æ˜¯æ”¾åœ¨ä¸€ä¸ªé›†ç¾¤èŒƒç•´é‡Œçš„ã€‚ORACLE çš„ Dataguard éƒ¨ç½²çš„ä¸»å¤‡åº“é€šå¸¸ä¸ä¼šç§°ä¸ºä¸€ä¸ªé›†ç¾¤ï¼Œå› ä¸ºä¸»åº“å’Œå¤‡åº“å¯ä»¥ç‹¬ç«‹è¿ç»´ï¼Œå¹¶ä¸”å¤‡åº“å¯ä»¥ä¸´æ—¶ä¸å¯ç”¨ã€‚ä¸»å¤‡ä¹‹é—´æ˜¯æ¾è€¦åˆçš„ã€‚è€Œåˆ†å¸ƒå¼æ•°æ®åº“é‡Œçš„ä¸»å¤‡æ˜¯æ”¾åˆ°ä¸€ä¸ªé›†ç¾¤é‡Œè¯´ã€‚æ¯”å¦‚è¯´ OB é›†ç¾¤æ•°æ®é»˜è®¤æœ‰ä¸‰å‰¯æœ¬ï¼ˆå‰ææ˜¯ä¸‰èŠ‚ç‚¹éƒ¨ç½²ï¼‰ã€‚æ•´ä¸ª OB é›†ç¾¤é‡Œé¢ä¸å†åˆ†ä¸»å¤‡å®ä¾‹æˆ–ä¸»å¤‡åº“ï¼Œæ²¡æœ‰è¿™ç§æ¦‚å¿µã€‚ ä½†æ˜¯ OB é›†ç¾¤é‡Œçš„æ•°æ®ä¼šæœ‰ä¸»å¤‡å‰¯æœ¬çš„æ¦‚å¿µï¼Œè¿™ä¸€èˆ¬æ˜¯è®²è¿° OB å¤šå‰¯æœ¬åŸç†çš„æ—¶å€™ä¼šè¯´ã€‚è¿™é‡Œçš„é—®é¢˜å°±æ˜¯è¿™ä¸ªå‰¯æœ¬åˆ°åº•å¯¹åº”äº†ä»€ä¹ˆã€‚è¿™æ˜¯ç†è§£æ—¥å¿—æµçš„ç¬¬ä¸€ä¸ªå…³é”®ç‚¹ã€‚è¿™ä¸ªæ”¾åˆ°åé¢è¯´ã€‚

OB ä» V3 ç‰ˆæœ¬è®©äººç»å¸¸å›°æƒ‘çš„æ˜¯ OB åœ¨ä¸»é›†ç¾¤é‡Œæœ‰å¤šå‰¯æœ¬ä¹‹å¤–è¿˜æå‡ºäº†ä¸€ä¸ªå¤‡é›†ç¾¤çš„æ¦‚å¿µï¼Œä¸»å¤‡é›†ç¾¤çš„å…³ç³»å°±ç±»ä¼¼ ORACLE ä¸»å¤‡åº“çš„å…³ç³»ã€‚è¿™ä¸ªæ—¶å€™ä¸»å¤‡é›†ç¾¤çš„åŒæ­¥å°±è·Ÿ ORACLE Dataguard ä¸€æ ·æ˜¯æ•´ä½“çš„é›†ç¾¤çº§åˆ«ã€‚ç”±äºåˆ†å¸ƒå¼æ•°æ®åº“è§„æ¨¡å¯èƒ½éå¸¸åºå¤§ï¼ŒOB ä» V4 ç‰ˆæœ¬å¼€å§‹æŠŠè¿™ä¸ªåŒæ­¥ç²’åº¦ç»†åŒ–åˆ°ç§Ÿæˆ·çº§åˆ«ï¼Œæå‡ºäº†ä¸»å¤‡ç§Ÿæˆ·çš„æ¦‚å¿µã€‚ä¸»å¤‡ç§Ÿæˆ·å¯ä»¥åœ¨åŒä¸€ä¸ªé›†ç¾¤ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒé›†ç¾¤ï¼ˆæ›´å€¾å‘äºåè€…ï¼‰ã€‚æ‰€ä»¥ OB V4 é›†ç¾¤ä¸å†æœ‰ä¸»å¤‡ä¹‹è¯´ï¼Œåªæœ‰ç§Ÿæˆ·æœ‰ä¸»å¤‡ä¹‹è¯´ã€‚å¤‡ç§Ÿæˆ·åªèƒ½è¯»ä¸å¯ä»¥å†™ï¼Œç±»ä¼¼ `ORACLE Active Standby`ã€‚ä¸»å¤‡ç§Ÿæˆ·åŒæ­¥æ˜¯å•å‘åŒæ­¥ï¼Œæ²¡æœ‰åŒå‘åŒæ­¥ã€‚å¤‡é›†ç¾¤æˆ–å¤‡ç§Ÿæˆ·æ˜¯å®¢æˆ·é«˜å¯ç”¨å®¹ç¾åœºæ™¯çš„éœ€è¦ï¼ˆç‰¹åˆ«æ˜¯é‡‘èè¡Œä¸šï¼‰ï¼Œæ‰€ä»¥ TiDB é›†ç¾¤å°±æ²¡æœ‰å¤‡é›†ç¾¤æˆ–å¤‡åº“çš„æ¦‚å¿µã€‚OBV3 ä¸»å¤‡é›†ç¾¤ä¹‹é—´å¹³æ—¶æ˜¯æ¾è€¦åˆçš„ï¼Œæ˜¯å¯ä»¥å¼‚æ„çš„ï¼ˆæœºå™¨ç±»å‹å¼‚æ„ã€æœºå™¨èµ„æºå¼‚æ„ï¼‰ã€‚åˆ° OBV4 åä¸»å¤‡ç§Ÿæˆ·ä¹‹é—´ä¹Ÿæ˜¯æ¾è€¦åˆï¼Œå¯ä»¥å¼‚æ„çš„ã€‚æ—¥å¿—æµæ¦‚å¿µçš„è§£é‡Šå°±æ˜¯ä¸»ç§Ÿæˆ·å†…éƒ¨çš„ï¼Œå¤‡ç§Ÿæˆ·å†…çš„æ—¥å¿—æµä¸ç”¨å…³æ³¨ï¼Œè·Ÿä¸»ç§Ÿæˆ·åŒç†å§ã€‚æ‰€ä»¥åé¢å°±ä¸å†è®¨è®º OB å¤‡é›†ç¾¤æˆ–å¤‡ç§Ÿæˆ·ã€‚

OB ä¸»å¤‡ç§Ÿæˆ·
=======

![](https://i-blog.csdnimg.cn/img_convert/9df3c6b8c92592003dcaf70498a97b9d.png)

OB é›†ç¾¤ä¸‰èŠ‚ç‚¹éƒ¨ç½²çš„æ—¶å€™ï¼ŒOB ç§Ÿæˆ·ä¸€èˆ¬ä¹Ÿé€‰æ‹©ä¸‰å‰¯æœ¬éƒ¨ç½²ï¼Œå³éƒ½æœ‰ä¸‰ä¸ª Zone ã€‚TiDB æ²¡æœ‰ç§Ÿæˆ·æ¦‚å¿µï¼Œå¯ä»¥æŠŠ TiDB çš„å®ä¾‹ç±»æ¯”ä¸º OB çš„ç§Ÿæˆ·ã€‚OB å’Œ TiDB çš„å¤šå‰¯æœ¬éƒ½æœ‰ä¸ªå…±åŒçš„ç‰¹å¾å°±æ˜¯åªæœ‰ä¸€ä¸ªä¸»å‰¯æœ¬ï¼Œå…¶ä»–å…¨æ˜¯å¤‡å‰¯æœ¬ã€‚å¹¶ä¸”æ€»çš„å‰¯æœ¬æ•°ï¼ˆåŒ…æ‹¬ä¸»å‰¯æœ¬ï¼‰å°½å¯èƒ½æ˜¯å¥‡æ•°ã€‚è™½ç„¶å¶æ•°ä¹Ÿè¡Œï¼Œåªæ˜¯æ„ä¹‰ä¸å¤§ï¼Œè¿™æ˜¯ç”± OB å’Œ Paxos çš„å¤šå‰¯æœ¬åŒæ­¥é€‰ä¸¾åè®®å†³å®šçš„ï¼Œéƒ½å±äºå¤šæ•°æ´¾é€‰ä¸¾åè®®ã€‚

OB ç”¨çš„ `MultiPaxos`ï¼ŒTiDB ç”¨çš„æ˜¯ `MultiRaft` åè®®ï¼Œè¿™ä¸¤ä¸ªåè®®ä¸€ä¸ªç¥–å®—ï¼Œéƒ½æ˜¯ Paxos åè®®ï¼ŒRaft æ˜¯ Paxos çš„ç®€åŒ–ç‰ˆã€‚

å¤šå‰¯æœ¬åŒæ­¥çš„äº‹æƒ…æ˜¯è‡ªå¤å°±æœ‰ï¼Œåªæ˜¯ç”¨åè®®æ¦‚å¿µæå‡ºæ¥æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“è®²çš„æ¯”è¾ƒå¤šã€‚MySQL çš„ä¸»ä»åŒæ­¥æœºåˆ¶ä¹Ÿå¯ä»¥ç§°ä¸ºåè®®ï¼Œåªæ˜¯æ²¡æœ‰ä¸€ä¸ªä¸“é—¨çš„åå­—ï¼Œæˆ–è€…å«å¼‚æ­¥åŒæ­¥æ¯”è¾ƒæ¥è¿‘ã€‚MySQL åæ¥è¿˜æå‡ºäº†**åŠåŒæ­¥**ã€‚ORACLE ä¸»å¤‡åŒæ­¥æœ‰æœ€å¤§æ€§èƒ½ã€æœ€å¤§ä¿æŠ¤ã€æœ€å¤§å¯ç”¨ç­‰ç­‰ã€‚ä¹‹æ‰€ä»¥æœ‰è¿™ä¹ˆå¤šåå ‚éƒ½æ˜¯ä¸ºäº†å°½å¯èƒ½ä¿è¯å¤‡å‰¯æœ¬æ•°æ®è·Ÿä¸»å‰¯æœ¬ä¸€è‡´ã€‚

ä¸ºä»€ä¹ˆä¸èƒ½å•ä¸€çš„é€‰æ‹©å¼ºåˆ¶ä¿è¯æ‰€æœ‰å¤‡å‰¯æœ¬æ•°æ®è·Ÿä¸»å‰¯æœ¬ä¸€è‡´å‘¢ï¼Œé‚£æ ·å²‚ä¸æ˜¯æœ€å®‰å…¨ã€‚æ˜¯çš„ã€‚è™½ç„¶å®‰å…¨ï¼Œä½†æ˜¯æ€§èƒ½æœ€å·®ï¼Œæ‰©å±•æ€§ä¹Ÿæœ€å·®ã€‚å¼‚æ­¥åŒæ­¥æˆ–æœ€å¤§æ€§èƒ½æ˜¯æœ€ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ€§èƒ½æœ€å¥½ã€‚æœ€å¤§ä¿æŠ¤å’ŒåŠåŒæ­¥éƒ½å±äºåªè¦æœ‰ä¸€ä¸ªå¤‡å‰¯æœ¬è·Ÿä¸»å‰¯æœ¬ä¸€è‡´äº†å°±è®¤ä¸ºå®‰å…¨çš„ï¼ŒPaxoså’ŒRaft å¤šæ•°æ´¾åŒæ­¥åè®®æ˜¯è®¤ä¸ºåŠæ•°ä»¥ä¸Šå‰¯æœ¬æˆå‘˜æ•°æ®ä¸€è‡´äº†æ‰æ˜¯æœ€å®‰å…¨çš„ã€‚å¯ä»¥ç®€å•çš„ç†è§£ä¸ºç†è®ºä¸Šæ€§èƒ½è·Ÿå®‰å…¨æ˜¯åç€æ¥çš„ã€‚

æ‰€ä»¥ç†è®ºä¸ŠåŒç­‰è§„æ ¼åŒç­‰æµ‹è¯•åœºæ™¯ä¸‹ï¼ŒOB æˆ– TiDB çš„ä¸‰å‰¯æœ¬æ¶æ„ä¸‹ OLTP æ€§èƒ½å¾ˆéš¾è¶…è¿‡ MySQL çš„ä¸€ä¸»ä¸¤ä»çš„åŠåŒæ­¥åè®®ä¸‹çš„æ€§èƒ½ã€‚å½“ç„¶å®é™…ä¸Šè¿˜æ˜¯æœ‰å¾ˆå¤šå˜æ•°ï¼Œå–å†³äºå„ä¸ªæ•°æ®åº“çš„SQLã€äº‹åŠ¡ã€å­˜å‚¨å¼•æ“çš„å·¥ç¨‹å®ç°èƒ½åŠ›å’Œæ•ˆæœã€‚ä¸ºä»€ä¹ˆæœ‰äº›å›½äº§æ•°æ®åº“å‚å•†æ€§èƒ½ PK ä¸­æ”¹ä¸ªé…ç½®å°±èƒ½æ€§èƒ½å¾ˆå¤§æå‡å‘¢ï¼Œå¾ˆå¯èƒ½æ”¹çš„å°±æ˜¯è¿™ä¸ªåŒæ­¥è®¾ç½®ï¼ˆæ­¤å¤–è¿˜æœ‰äº‹åŠ¡æ—¥å¿—æ˜¯å¦å¼ºåˆ¶è½ç›˜ï¼‰ã€‚

è‡³æ­¤è¯´æ¸…æ¥šäº†å¤šå‰¯æœ¬åŒæ­¥æœºåˆ¶çš„åŸç†ï¼Œå‰©ä¸‹å°±å¯ä»¥è¯´è¿™ä¸ªå‰¯æœ¬çš„ç²’åº¦äº†ã€‚

å¤šå‰¯æœ¬åŒæ­¥çš„ç²’åº¦
========

è¿™ä¸ªå‰¯æœ¬æŒ‡å‘å¯å¤§å¯å°ã€‚åœ¨ OBV4 ç‰ˆæœ¬ä»¥å‰ï¼Œå‰¯æœ¬æœ€å¤§å¯ä»¥æ˜¯ä¸€ä¸ª ZONE å†…æ‰€æœ‰æ•°æ®ã€‚é›†ç¾¤æœ‰ä¸‰ä¸ª ZONEï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºæ‰€æœ‰ä¸šåŠ¡æ•°æ®æœ‰ä¸‰å‰¯æœ¬ï¼ˆå‰ææ˜¯æ‰€æœ‰ç§Ÿæˆ·ä¹Ÿæ²¿ç”¨ä¸‰å‰¯æœ¬ï¼‰ã€‚å‰¯æœ¬æœ€å°å¯ä»¥æ˜¯è¡¨çš„åˆ†åŒºï¼ˆå³åè¯`partition`ï¼‰ã€‚OB çš„åˆ†åŒºè¡¨è·Ÿ ORACLE å’Œ MySQL åˆ†åŒºè¡¨æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚

åˆ†åŒºæ˜¯æ¯”è¡¨è¿˜è¦ç»†çš„ç²’åº¦ã€‚æ™®é€šè¡¨å¯ä»¥çœ‹æˆå•åˆ†åŒºï¼Œåˆ†åŒºè¡¨å°±æ˜¯å¤šåˆ†åŒºã€‚æ¯ä¸ªåˆ†åŒºåªèƒ½åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥æ™®é€šè¡¨ï¼ˆå•åˆ†åŒºï¼‰çš„ç†è®ºé£é™©æ˜¯å…¶å®¹é‡å¯èƒ½ä¼šè¶…å‡ºå•æœºå­˜å‚¨å®¹é‡ã€‚è¿™å°±æ˜¯ OB é‡Œè¶…çº§å¤§çš„è¡¨ä¸€å®šè¦åšåˆ†åŒºçš„å…¶ä¸­ä¸€ä¸ªåŸå› ã€‚

å‰¯æœ¬çš„ç²’åº¦ä¹Ÿä»£è¡¨äº†å¤šå‰¯æœ¬åŒæ­¥çš„ç²’åº¦ï¼Œæˆ–è€…è¯´æ•°æ®åŒæ­¥çš„ç²’åº¦ã€‚OBV4 ç‰ˆæœ¬ä»¥å‰å¯ä»¥é’ˆå¯¹ç§Ÿæˆ·ã€è¡¨è®¾ç½® `PRIMARY_ZONE`ï¼Œå³è®¾ç½®ä¸»å‰¯æœ¬çš„ä½ç½®ã€‚å¦‚æœæ˜¯ç§Ÿæˆ·çº§åˆ«è®¾ç½®ï¼Œé‚£ä¹ˆç§Ÿæˆ·å†…æ‰€æœ‰è¡¨çš„ `PRIMARY_ZONE` éƒ½æ²¿ç”¨è¿™ä¸ªè®¾ç½®ã€‚ä¸€èˆ¬è®¾ç½®ä¸ºå•ä¸ª Zone çš„æ—¶å€™ï¼Œå°±æ˜¯æ‰€æœ‰ä¸šåŠ¡è¡¨æ•°æ®åˆ†åŒºçš„ä¸»å‰¯æœ¬éƒ½åœ¨è¿™ä¸ª Zone çš„èŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªå°±è·Ÿä¼ ç»Ÿä¸»å¤‡åº“ç‰¹å¾ç±»ä¼¼ã€‚ä½†æ˜¯ `PRIMARY_ZONE` è®¾ç½®ä¸ºä¸¤ä¸ªæˆ–å¤šä¸ª Zone çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰éƒ¨åˆ†æ•°æ®åˆ†åŒºçš„ä¸»å‰¯æœ¬å˜æ¢åˆ°å…¶ä»– Zone ä¸Šã€‚è¿™ç§å˜æ¢æ˜¯åˆ†åŒºç²’åº¦çš„ä¸»å¤‡å‰¯æœ¬è§’è‰²åˆ‡æ¢ï¼Œæ˜¯ OB é«˜å¯ç”¨èƒ½åŠ›çš„å¾®è§‚ä½“ç°ã€‚é€šä¿—ä¸€ç‚¹è¯´ OB ä¸»å¤‡åˆ‡æ¢æ˜¯åˆ†åŒºç²’åº¦åšçš„ï¼Œå¯ä»¥å¾ˆå¤šåˆ†åŒºä¸€èµ·åˆ‡æ¢ã€‚è¿™ä¸ªå‘ˆç°ç»™ä¸šåŠ¡çš„æ„Ÿå—å°±æ˜¯ OB æ•…éšœåˆ‡æ¢çš„æ—¶å€™æœ‰äº›è¡¨å…ˆæ¢å¤æœ‰äº›è¡¨åæ¢å¤ï¼Œè€Œä¼ ç»Ÿä¸»å¤‡åˆ‡æ¢æ˜¯åŒæ—¶æ¢å¤ã€‚OB è¿™ç§åˆ‡æ¢æ„Ÿå—å¯èƒ½è¦å¥½å¾ˆå¤šã€‚ä¸è¿‡å¼Šç«¯ä¹Ÿæœ‰ã€‚åˆ‡æ¢ç²’åº¦å¤ªç»†å¤ªè´¹ CPU èµ„æºï¼Œä¾‹å¦‚ OB V3 ç‰ˆæœ¬çš„ RTO å¯èƒ½åœ¨ `10s~30s` å·¦å³ï¼ˆè¿™ä¸ªæ¯”ä¼ ç»Ÿä¸»å¤‡åˆ‡æ¢åˆ†é’Ÿçº§åˆ«çš„ RTO è¿˜æ˜¯è¦å¥½å¾ˆå¤šï¼‰ã€‚

![](https://i-blog.csdnimg.cn/img_convert/223b93f2fe2b2b7fc43dc0c49a955cbf.png)

OBV4 ç‰ˆæœ¬çš„æ”¹è¿›å°±æ˜¯å‰¯æœ¬çš„æ¦‚å¿µè¿˜æ˜¯ä¸å˜ï¼Œä½†æ˜¯å¤šå‰¯æœ¬åŒæ­¥çš„ç²’åº¦å˜ç²—äº†ï¼Œåšæˆä¸€æ‰¹æ•°æ®å‰¯æœ¬çš„åŒæ­¥é›†ä¸­ç®¡ç†ã€‚é‚£è¿™ä¸€æ‰¹å‰¯æœ¬åˆ°åº•æ˜¯å¤šå°‘æ•°æ®å‘¢ï¼Ÿå–å†³äºç§Ÿæˆ·çš„ `PRIMARY_ZONE` è®¾ç½®ã€‚

å¦‚æœ `PRIMARY_ZONE` è®¾ç½®ä¸ºå•ä¸ª `ZONE`ï¼Œé‚£ä¹ˆè¿™ä¸€æ‰¹æ•°æ®å‰¯æœ¬å°±æŒ‡ä»£å…¨éƒ¨ä¸šåŠ¡æ•°æ®ã€‚

å¦‚æœ `PRIMARY_ZONE` è®¾ç½®ä¸ºä¸¤ä¸ª `ZONE`ï¼Œé‚£è¿™ä¸€æ‰¹æ•°æ®å‰¯æœ¬å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€éƒ¨åˆ†æ•°æ®ã€‚

æ¯”å¦‚è¯´ç§Ÿæˆ·æ•°æ®åˆ†å¸ƒåœ¨ `ZONE1,ZONE2,ZONE3` ï¼Œ`PRIMARY_ZONE` è®¾ç½®ä¸º `ZONE1,ZONE2;ZONE3`æ—¶ï¼Œåˆ™ä¸€éƒ¨åˆ†æ•°æ®åŒæ­¥æ–¹å‘æ˜¯ `ZONE1 -> ZONE2, ZONE1 -> ZONE3`,å¦ä¸€éƒ¨åˆ†æ•°æ®åŒæ­¥æ–¹å‘æ˜¯ `ZONE2 -> ZONE1, ZONE2 -> ZONE3` ã€‚

**å‰é¢è¯´è¿‡å¤šå‰¯æœ¬åŒæ­¥å®é™…ä¸ŠåŒæ­¥çš„æ˜¯äº‹åŠ¡æ—¥å¿—ï¼ŒOBV4 ç®¡ç†æ—¥å¿—åŒæ­¥æ–¹å‘å°±æ˜¯ç”¨æ—¥å¿—æµè¿™ä¸ªæ¦‚å¿µã€‚æ—¥å¿—æµä¹Ÿå¯ä»¥æœ‰å¤šå‰¯æœ¬ï¼Œä¸»å‰¯æœ¬åˆ°å¤‡å‰¯æœ¬çš„åŒæ­¥æ–¹å‘å°±æ˜¯æ—¥å¿—æµçš„åŒæ­¥æ–¹å‘ã€‚æ•°æ®åˆ†åŒºçš„æ—¥å¿—éƒ½ä¼šå½’å±åˆ°æ—¥å¿—æµã€‚ä¸€ä¸ªæ—¥å¿—æµæ‰€è¾–çš„æ‰€æœ‰æ•°æ®åˆ†åŒºçš„åŒæ­¥æ–¹å‘éƒ½è·Ÿæ—¥å¿—æµçš„åŒæ­¥æ–¹å‘ä¿æŒä¸€è‡´ï¼Œä»¥åŠæ—¥å¿—æµä¸»å‰¯æœ¬æ‰€åœ¨çš„èŠ‚ç‚¹å°±æ˜¯æ—¥å¿—æµæ‰€è¾–çš„æ‰€æœ‰æ•°æ®åˆ†åŒºçš„ä¸»å‰¯æœ¬æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚**

æ—¥å¿—æµ
===

å½“ç§Ÿæˆ·çš„ `PRIMARY_ZONE` è®¾ç½®çš„æ˜¯å• Zoneï¼Œé‚£æ˜¾ç„¶å°±åªåº”è¯¥æœ‰ä¸€ä¸ªæ—¥å¿—æµï¼ˆæœ‰ä¸¤ä¸ªå°±æ˜¯é‡å¤ï¼Œç›®å‰çœ‹ OB æ— æ„è¿™æ ·è®¾è®¡ï¼‰ã€‚

ä½†æ˜¯å®é™…ä¸Šç”¨æˆ·çœŸçš„çœ‹åˆ°äº†ä¸¤ä¸ªæ—¥å¿—æµå¹¶ä¸”æ–¹å‘è¿˜æ˜¯ä¸€æ ·çš„ï¼Œé‚£æ˜¯å› ä¸º OB ä¸“é—¨æŠŠä¸šåŠ¡ç§Ÿæˆ·çš„ OB å…ƒæ•°æ®æŠ½å‡ºæ¥å•ç‹¬æ”¾ä¸€ä¸ªæ—¥å¿—æµé‡Œè¿›è¡Œç®¡ç†ï¼Œè¿™ä¸ªæ—¥å¿—æµ ID æ˜¯ 1 ï¼Œè€Œä¸šåŠ¡æ—¥å¿—æµ ID æ˜¯ä» 1001 å¼€å§‹ã€‚

å½“ç§Ÿæˆ· `PRIMARY_ZONE` è®¾ç½®çš„æ˜¯å¤šä¸ª Zone æ—¶ï¼Œå…¶ç”¨æ„ä¹Ÿæ˜¯æ•°æ®ä¸»å‰¯æœ¬åˆ†æ•£å¼€ï¼Œåˆ†æ•£åè‡ªç„¶å°±æœ‰å¤šä¸ªåŒæ­¥æ–¹å‘äº†ï¼Œé‚£ä¹ˆå°±æœ‰äº†å¤šä¸ªæ—¥å¿—æµã€‚æ¢å¥è¯è¯´ç§Ÿæˆ·æŸä¸ªèŠ‚ç‚¹ä¸Šåªè¦æœ‰ä¸šåŠ¡æ•°æ®çš„ä¸»å‰¯æœ¬ï¼Œé‚£ä¹ˆä¸Šé¢å¿…ç„¶æœ‰ä¸€ä¸ªä¸šåŠ¡æ—¥å¿—æµçš„ä¸»å‰¯æœ¬ï¼Œè¿™æ ·æœ‰å¤šå°‘ä¸ªæ—¥å¿—æµå°±èƒ½ç®—å‡ºæ¥äº†ã€‚

å¾ˆå¤šäººå›°æƒ‘äºå®˜ç½‘é‡Œæ—¥å¿—æµæ•°é‡è®¡ç®—æ–¹æ³•ï¼Œè¢«ä¸Šé¢æ–‡å­—è®¡ç®—é€»è¾‘ææ™•ï¼Œå°±æ˜¯å› ä¸ºæ²¡æœ‰ç†è§£è¿™ç‚¹ã€‚æ—¥å¿—æµæ˜¯ä¸ºäº†ç®¡ç†æ•°æ®å¤šå‰¯æœ¬åŒæ­¥æ–¹å‘ç”¨çš„ï¼Œåœ¨å®ç°ä¸Šæ˜¯å…ˆè¦è®¡ç®—å¥½æ—¥å¿—æµçš„æ•°é‡ç„¶åå†éšæœºåˆ†ç‰‡æ•°æ®åˆ†åŒºå½’å±äºè¿™ä¸ªæ—¥å¿—æµã€‚è¿™æ˜¯ä»£ç å®ç°é€»è¾‘ï¼Œå®˜ç½‘ä¸Šé‚£æ®µè§£é‡Šæ°å¥½æ˜¯ä»£ç é€»è¾‘ï¼Œæ‰€ä»¥ä¸ä¾¿äºç”¨æˆ·åˆæ¬¡ç†è§£ã€‚

![](https://i-blog.csdnimg.cn/img_convert/6964146033ed2c5080b2db2718e4223c.png)

OB è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ä¸šåŠ¡åœºæ™¯ï¼Œèƒ½åŠ æ·±å¯¹æ—¥å¿—æµçš„ç†è§£ã€‚**OB çš„å¤åˆ¶è¡¨**ï¼Œå…¶ç”¨æ„æ˜¯ä¸ºäº†é¿å…è¡¨è¿æ¥ä¸­å‡ºç°è·¨èŠ‚ç‚¹çš„è¿æ¥ã€‚ä¸€èˆ¬åŸºç¡€é…ç½®è¡¨ã€é™æ€è¡¨é€‚åˆè®¾ç½®ä¸ºå¤åˆ¶è¡¨ï¼Œè¿™æ ·åœ¨ç§Ÿæˆ·çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½ä¼šæœ‰è¿™ä¸ªè¡¨çš„å‰¯æœ¬ã€‚å¦‚æœç§Ÿæˆ·çš„æ‹“æ‰‘æ˜¯ `2-2-2`,ä¸€å…± 6 ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¤åˆ¶è¡¨å°±æœ‰ 6 ä¸ªå‰¯æœ¬ï¼Œå…¶ä¸­ 1 ä¸ªä¸»å‰¯æœ¬ 5 ä¸ªå¤‡å‰¯æœ¬ï¼Œé‚£ä¹ˆä»ä¸»å‰¯æœ¬ä¼šæœ‰ 5 ä¸ªåŒæ­¥é“¾è·¯åˆ°å¤‡å‰¯æœ¬ã€‚è¿™ä¸ªåŒæ­¥åè®®å«å…¨åŒæ­¥åè®®ï¼Œæ‰€æœ‰å‰¯æœ¬éƒ½è¦åŒæ­¥æˆåŠŸï¼ˆå¦‚æœæŸä¸ªå‰¯æœ¬æ•…éšœäº†ï¼ŒOB ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ç„¶åå°±è¶…æ—¶é€€å‡ºï¼Œå°†æ•…éšœå‰¯æœ¬æå‡ºäº†æŠ•ç¥¨çš„ç¾¤ä½“ã€‚å½“ç„¶ï¼Œå¦‚æœåæœŸæ•…éšœå‰¯æœ¬æ¢å¤äº†ï¼Œä¹Ÿæ˜¯èƒ½è‡ªåŠ¨è¯·å›æ¡Œé¢ä¸Šï¼‰ã€‚å¤åˆ¶è¡¨çš„åŒæ­¥æ˜¾ç„¶è·Ÿå‰é¢çš„ä¸‰å‰¯æœ¬å¤šæ•°æ´¾åŒæ­¥ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ OB ä¼šå•ç‹¬é…ç½®ä¸€ä¸ªæ—¥å¿—æµã€‚

è¿™ä¸ªå¬èµ·æ¥åˆè®©æ—¥å¿—æµæ•°é‡è®¡ç®—å¤æ‚ä¸€ç‚¹ã€‚å®é™…ä¸Šè¿ç»´äººå‘˜æ ¹æœ¬ä¸éœ€è¦å…³å¿ƒæœ‰å¤šå°‘ä¸ªæ—¥å¿—æµã€‚è¿ç»´äººå‘˜åªè¦ç€çœ¼äº `PRIMARY_ZONE` çš„è®¾ç½®å³å¯ï¼Œæˆ–è€…ç€çœ¼äºä½ æ˜¯å¦éœ€è¦æ•°æ®çš„è¯»å†™å…¥å£åˆ†æ•£åˆ°ä¸¤ä¸ª ZONE æˆ–è€…å¤šä¸ª ZONE ä¸Šã€‚

è¿ç»´äººå‘˜ä¸éœ€è¦å…³å¿ƒå“ªäº›è¡¨å½’å±äºå“ªä¸ªæ—¥å¿—æµ å°±åƒä¸éœ€è¦å…³å¿ƒæ•°æ®æ‰“æ•£çš„æ—¶å€™å“ªäº›è¡¨çš„ä¸»å‰¯æœ¬åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šã€‚å› ä¸ºåˆ†æ•£ä½ç½®æ˜¯æ— æ³•å¹²é¢„çš„ï¼Œä¹Ÿä¸éœ€è¦å¹²é¢„ã€‚å¦‚æœè¦å¹²é¢„ï¼Œåªæœ‰ä¸€ä¸ªç‰¹æ®Šåœºæ™¯å°±æ˜¯æœŸæœ›æŸäº›è¡¨çš„åˆ†åŒºä¸»å‰¯æœ¬èƒ½åœ¨ä¸€èµ·ï¼Œé‚£å°±ä½¿ç”¨**è¡¨åˆ†ç»„æŠ€æœ¯**ã€‚è¡¨åˆ†ç»„ä¸ä¼šæ”¹å˜æ—¥å¿—æµçš„æ•°é‡ï¼Œåªä¼šå½±å“éƒ¨åˆ†æ•°æ®åˆ†åŒºæ˜¯å¦å½’å±äºåŒä¸€ä¸ªæ—¥å¿—æµã€‚è¡¨åˆ†ç»„çš„è§„åˆ™ä¹Ÿå¾ˆå¤æ‚ï¼Œè¿™æ˜¯å› ä¸ºå®é™…ä¸šåŠ¡è¡¨çš„æƒ…å½¢æ¯”è¾ƒå¤æ‚ï¼ˆæœ‰äº›åˆ†åŒºæœ‰äº›ä¸åˆ†åŒºï¼Œåˆ†åŒºçš„è¡¨æœ‰äº›åˆ†åŒºç­–ç•¥ä¹Ÿä¸å®Œå…¨ä¸€è‡´ï¼Œåˆ†åŒºè¿˜æœ‰ä¸€çº§åˆ†åŒºäºŒçº§åˆ†åŒºçš„åŒºåˆ«ã€‚è¿™é‡Œé¢æƒ…å†µå¤æ‚çš„å¾ˆï¼‰ã€‚

OB è®ºå›ä¸Šè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå•å‰¯æœ¬ä¸ºä»€ä¹ˆè¦æœ‰æ—¥å¿—æµï¼Ÿå…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå¤šå‰¯æœ¬æ—¥å¿—åŒæ­¥æŒ‡çš„æ˜¯äº‹åŠ¡æ—¥å¿—åœ¨æ‰€æœ‰å‰¯æœ¬çš„åŒæ­¥å’Œè½ç›˜ï¼Œä¸»å‰¯æœ¬æ‰€åœ¨èŠ‚ç‚¹çš„æ—¥å¿—åŒæ­¥ç»™è‡ªå·±æ˜¯çœäº†ï¼Œè½ç›˜è¿˜æ˜¯è¦åšçš„ã€‚æ—¥å¿—æµæ˜¯ OB è¿™ä¸ªæ—¥å¿—åŒæ­¥é€»è¾‘å·¥ç¨‹å®ç°çš„è®¾è®¡ï¼Œæ‰€ä»¥å•å‰¯æœ¬ä¾ç„¶ä¼šçœ‹åˆ°æ—¥å¿—æµã€‚

æ€»ç»“
==

OKï¼Œåˆ°è¿™é‡Œæ—¥å¿—æµå°±è§£é‡Šæ¸…æ¥šäº†ã€‚ç®€å•æ€»ç»“ä¸€ä¸‹ï¼š

*   å°†æ—¥å¿—æµç†è§£ä¸ºç§Ÿæˆ·æ•°æ®çš„æ—¥å¿—åŒæ­¥æ–¹å‘ç®¡ç†çš„å·¥ç¨‹å®ç°æ–¹æ¡ˆå³å¯ã€‚
*   æ—¥å¿—æµçš„æ•°é‡ä¸ç”¨å»è®¡ç®—ï¼Œè¿ç»´åªè¦è¿ç”¨å¥½ç§Ÿæˆ·çš„ `PRIMARY_ZONE`ã€è¡¨åˆ†ç»„å’Œå¤åˆ¶è¡¨æŠ€æœ¯å³å¯ã€‚
*   æ—¥å¿—æµæ˜¯ OB V4 ç‰ˆæœ¬å•æœºåˆ†å¸ƒå¼ä¸€ä½“åŒ–èƒ½åŠ›çš„å…³é”®ï¼Œä¹Ÿæ˜¯é«˜å¯ç”¨ RTO æ—¶é—´èƒ½ç¼©çŸ­åˆ° 8s å·¦å³çš„å…³é”®ã€‚

ğŸ’Œ

> è€çºªçš„æŠ€æœ¯å” å—‘å±€ ä¸ä»…å¸Œæœ›èƒ½æŒç»­ç»™å¤§å®¶å¸¦æ¥æœ‰ä»·å€¼çš„æŠ€æœ¯åˆ†äº«ï¼Œä¹Ÿå¸Œæœ›èƒ½å’Œå¤§å®¶ä¸€èµ·ä¸ºå¼€æºç¤¾åŒºè´¡çŒ®åŠ›é‡ã€‚å¦‚æœä½ å¯¹ OceanBase å¼€æºç¤¾åŒºè®¤å¯ï¼Œç‚¹äº®ä¸€é¢—å°æ˜Ÿæ˜Ÿ âœ¨ å§ï¼ä½ çš„æ¯ä¸€ä¸ªStarï¼Œéƒ½æ˜¯æˆ‘ä»¬åŠªåŠ›çš„åŠ¨åŠ›ï½ğŸ’•  
> [https://github.com/oceanbase/oceanbase](https://github.com/oceanbase/oceanbase)

posted on 2025-06-16 14:07Â  [è€çºªçš„æŠ€æœ¯å” å—‘å±€](https://www.cnblogs.com/OBCE666)Â  é˜…è¯»(52)Â  è¯„è®º(0)Â  Â  [æ”¶è—](javascript:void\(0\))Â  [ä¸¾æŠ¥](javascript:void\(0\))