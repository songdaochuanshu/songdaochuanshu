---
layout: post
title: 'ã€æ¸²æŸ“æµæ°´çº¿ã€‘[å…‰æ …é˜¶æ®µ]-[å…‰æ …æ’å€¼]ä»¥UnityURPä¸ºä¾‹'
date: "2025-08-19T00:42:02Z"
---
ã€æ¸²æŸ“æµæ°´çº¿ã€‘\[å…‰æ …é˜¶æ®µ\]-\[å…‰æ …æ’å€¼\]ä»¥UnityURPä¸ºä¾‹
===================================

![ã€æ¸²æŸ“æµæ°´çº¿ã€‘[å…‰æ …é˜¶æ®µ]-[å…‰æ …æ’å€¼]ä»¥UnityURPä¸ºä¾‹](https://img2024.cnblogs.com/blog/3685400/202508/3685400-20250818165210465-1069539902.png) æœ¬æ–‡æ¢è®¨äº†Unity URPæ¸²æŸ“ç®¡çº¿ä¸­çš„å…‰æ …åŒ–è¿‡ç¨‹ã€‚é‡ç‚¹è§£æäº†ä¸‰è§’å½¢è®¾ç½®é˜¶æ®µï¼ˆè®¡ç®—è¾¹ç•Œæ¡†ã€é¢„è®¡ç®—é‡å¿ƒåæ ‡åˆ†æ¯ï¼‰å’Œéå†é˜¶æ®µï¼ˆé€šè¿‡é‡å¿ƒåæ ‡åˆ¤æ–­åƒç´ è¦†ç›–ï¼Œç”ŸæˆåŒ…å«æ’å€¼å±æ€§çš„ç‰‡å…ƒï¼‰ã€‚æ–‡ç« è¯¦ç»†ä»‹ç»äº†é€è§†æ ¡æ­£æ’å€¼å…¬å¼ï¼Œå¹¶ä¸¾ä¾‹è¯´æ˜é¢œè‰²å’Œçº¹ç†åæ ‡çš„æ’å€¼è®¡ç®—ã€‚åŒæ—¶æŒ‡å‡ºURPä¸­å…‰æ …åŒ–ç”±UniversalRendererç±»ç»„ç»‡ï¼Œåº•å±‚ç”±GPUå›ºå®šåŠŸèƒ½å•å…ƒåŠ é€Ÿå®ç°ï¼Œé€šè¿‡å¹¶è¡Œå¤„ç†ä¼˜åŒ–æ€§èƒ½ã€‚æ–‡æœ«é‚€è¯·è¯»è€…å‚ä¸è®¨è®ºï¼Œå…±åŒå®Œå–„æ¸²æŸ“çŸ¥è¯†ä½“ç³»ã€‚

*   **ä½œç”¨**â€Œï¼šå°†å‡ ä½•å›¾å…ƒï¼ˆä¸‰è§’å½¢ï¼‰è½¬æ¢ä¸ºç‰‡å…ƒï¼ˆFragmentï¼‰ï¼Œå¹¶æ’å€¼é¡¶ç‚¹å±æ€§ï¼ˆå¦‚çº¹ç†åæ ‡ï¼‰
*   â€Œ**å¯é…ç½®**â€Œï¼šé€šè¿‡Â `Cull`Â æŒ‡ä»¤æ§åˆ¶é¢ç‰‡å‰”é™¤æ¨¡å¼ï¼ˆ`Back`/`Front`/`Off`ï¼‰ã€‚

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ä¸‰è§’å½¢è®¾ç½® **Triangle Setup**
========================

é¢„å…ˆè®¡ç®—**å…¨å±€ç³»æ•°**â€Œ
-------------

*   ä¼˜åŒ–éå†æ•ˆç‡ï¼›å®æ—¶è®¡ç®—åˆ™ç»“åˆåƒç´ ä½ç½®å®Œæˆâ€Œ**åŠ¨æ€æ’å€¼**â€Œï¼Œç¡®ä¿é€è§†æ­£ç¡®æ€§â€Œã€‚

è¾“å…¥ï¼š
---

*   å±å¹•åæ ‡ç³»ä¸‹çš„ä¸‰è§’å½¢é¡¶ç‚¹åæ ‡ï¼ˆåŒ…å«æ·±åº¦å€¼Â `z`ï¼‰
*   å…³è”å±æ€§ï¼šæ³•çº¿ã€çº¹ç†åæ ‡ã€é¡¶ç‚¹é¢œè‰²ç­‰â€Œ

ç”Ÿæˆï¼š
---

*   **è®¡ç®—è¾¹ç•Œæ¡†**â€Œï¼šç¡®å®šä¸‰è§’å½¢åœ¨å±å¹•ä¸Šçš„æœ€å°/æœ€å¤§åƒç´ èŒƒå›´ï¼ˆ`x_min`,Â `y_min`Â è‡³Â `x_max`,Â `y_max`ï¼‰ï¼Œé™å®šåç»­éå†åŒºåŸŸâ€Œã€‚
*   ç”Ÿæˆè¾¹æ–¹ç¨‹ï¼ˆæ•ˆç‡ä½ï¼Œç”¨ç‚¹ç§¯æ±‚é‡å¿ƒæ–¹å¼åˆ¤æ–­æ›¿ä»£çš„è¯è¿™é‡Œä¸ç”¨æ±‚è§£è¿™ä¸ªï¼‰:æ„å»ºä¸‰è§’å½¢ä¸‰æ¡è¾¹çš„çº¿æ€§æ–¹ç¨‹ï¼ˆå¦‚Â `Ax+By+C=0`ï¼‰ï¼Œç”¨äºåç»­åƒç´ è¦†ç›–åˆ¤æ–­â€Œ
*   **é‡å¿ƒåæ ‡åˆ†æ¯é¡¹**â€Œï¼šé¢„è®¡ç®—é‡å¿ƒåæ ‡æ’å€¼æ‰€éœ€çš„å…¬å…±åˆ†æ¯ï¼ˆå¦‚Â `1/(w0Â·Î± + w1Â·Î² + w2Â·Î³)`ï¼‰ï¼Œé¿å…éå†é˜¶æ®µé‡å¤è®¡ç®—â€Œï¼ˆç”±äºä½¿ç”¨ç‚¹ç§¯é‡å¿ƒåæ ‡æ±‚è§£é‡å¿ƒå’Œåƒç´ åˆ¤æ–­ï¼Œå…¶ä¸­è§£æ–¹ç¨‹ç»„æ—¶æœ‰ä¸€ä¸ªå…±åŒçš„è¡Œåˆ—å¼åˆ†æ¯éœ€è¦ç‚¹ç§¯è®¡ç®—ï¼Œè¿™é‡Œå¯ä»¥æŠŠåˆ†æ¯é¢„è®¡ç®—ï¼Œä¸‹é¢é˜¶æ®µå°±å¯ä»¥ç›´æ¥ç”¨ã€‚ ç‚¹ç§¯é‡å¿ƒæ±‚è§£åæ ‡ä¸‹é¢çš„ä¸‰è§’å½¢éå†é˜¶æ®µæœ‰è§£é‡Šã€‚ï¼‰
*   ä¸åƒç´ ä½ç½®æ— å…³çš„æ•°å­¦ç³»æ•°ï¼Œä¾›éå†é˜¶æ®µå¤ç”¨ã€‚

ä¸‰è§’å½¢éå† **Triangle Traversal ï¼ˆæ‰«æå˜æ¢ ScanConversionï¼‰**
==================================================

**è¾“å…¥æ•°æ®**
--------

*   ä¸‰è§’å½¢è®¾ç½®é˜¶æ®µè¾“å‡ºçš„ç½‘æ ¼è¡¨ç¤ºæ•°æ®â€Œ

è¾“å‡ºæ•°æ®
----

### **åƒç´ è¦†ç›–æ£€æµ‹**â€Œ

*   éå†è¾¹ç•Œæ¡†å†…æ‰€æœ‰åƒç´ ï¼Œé€šè¿‡è¾¹æ–¹ç¨‹æˆ–**é‡å¿ƒåæ ‡åˆ¤æ–­ï¼ˆç‚¹ç§¯é‡å¿ƒåæ ‡**æ±‚è§£ä»£æ›¿**å‰ä¹˜é¢ç§¯**æ±‚è§£åŠ é€Ÿä¼˜åŒ–è¿ç®—ï¼‰ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…éƒ¨â€Œ

### **ç‰‡å…ƒç”Ÿæˆ**

å¯¹è¦†ç›–çš„åƒç´ åˆ›å»ºç‰‡å…ƒï¼ˆFragmentï¼‰ï¼ŒåŒ…å«ä»¥ä¸‹çŠ¶æ€ï¼š

*   å±å¹•åæ ‡Â `(x, y)`
*   æ’å€¼åçš„æ·±åº¦å€¼Â `z`
*   æ’å€¼åçš„å±æ€§ï¼šæ³•çº¿ã€çº¹ç†åæ ‡ã€é¢œè‰²ç­‰â€Œ

### **æ·±åº¦åˆç­›**â€Œ

*   åˆæ­¥è®¡ç®—ç‰‡å…ƒæ·±åº¦ï¼Œä¾›åç»­æ·±åº¦æµ‹è¯•ä½¿ç”¨â€Œ

è¾“å‡º ç‰‡å…ƒåºåˆ—ï¼ˆæ¯ä¸ªç‰‡å…ƒåŒ…å«åƒç´ ä½ç½®ã€æ·±åº¦åŠæ’å€¼å±æ€§ï¼‰ï¼Œä¼ é€’è‡³ç‰‡å…ƒç€è‰²å™¨â€Œ

åˆ©ç”¨é‡å¿ƒåæ ‡æƒé‡æ··åˆé¡¶ç‚¹å±æ€§ï¼Œç¡®ä¿çº¹ç†ã€é¢œè‰²ç­‰å¹³æ»‘è¿‡æ¸¡â€Œï¼š

$å±æ€§pixel=Î±â‹…å±æ€§A+Î²â‹…å±æ€§B+Î³â‹…å±æ€§C$

### **ç‚¹ç§¯æ³•é‡å¿ƒåæ ‡å…¬å¼è§£æ**

URPä¸­å…‰æ …åŒ–çš„å…·ä½“è¿‡ç¨‹ä¸¾ä¾‹
==============

Unity URPçš„å…‰æ …åŒ–é˜¶æ®µï¼Œå‡ ä½•å›¾å…ƒé€šè¿‡é‡å¿ƒåæ ‡å…¬å¼è½¬åŒ–ä¸ºç‰‡å…ƒçš„è¿‡ç¨‹ï¼š

â€Œ**ä¸‰è§’å½¢è®¾ç½®é˜¶æ®µ**â€Œ
-------------

*   é¦–å…ˆè®¡ç®—ä¸‰è§’å½¢åœ¨å±å¹•ç©ºé—´çš„åŒ…å›´ç›’ï¼Œç¡®å®šæ½œåœ¨è¦†ç›–çš„åƒç´ èŒƒå›´ã€‚
*   ä¾‹å¦‚ä¸€ä¸ªä¸‰è§’å½¢é¡¶ç‚¹åæ ‡ä¸º(100,200)ã€(300,400)ã€(200,500)ï¼Œå…¶åŒ…å›´ç›’èŒƒå›´ä¸ºxâˆˆ\[100,300\]ï¼Œyâˆˆ\[200,500\]ã€‚

â€Œ**ä¸‰è§’å½¢éå†ä¸ç‰‡å…ƒç”Ÿæˆ**â€Œ
----------------

*   éå†åŒ…å›´ç›’å†…æ‰€æœ‰åƒç´ ï¼Œé€šè¿‡é‡å¿ƒåæ ‡åˆ¤æ–­æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ã€‚é‡å¿ƒåæ ‡å…¬å¼ä¸ºï¼š
*   $Î± + Î² + Î³ = 1 (Î±,Î²,Î³ â‰¥ 0)$
*   è‹¥åƒç´ (150,300)çš„é‡å¿ƒåæ ‡è®¡ç®—ç»“æœä¸ºÎ±=0.4, Î²=0.3, Î³=0.3ï¼Œåˆ™è¯¥åƒç´ å±äºä¸‰è§’å½¢ã€‚

â€Œ**é€è§†æ ¡æ­£æ’å€¼**â€Œ
------------

*   ä½¿ç”¨å…¬å¼å¯¹é¡¶ç‚¹å±æ€§è¿›è¡Œæ’å€¼ï¼š
*   $f = (Î±fâ‚€/wâ‚€ + Î²fâ‚/wâ‚ + Î³fâ‚‚/wâ‚‚) / (Î±/wâ‚€ + Î²/wâ‚ + Î³/wâ‚‚)$
*   ä¾‹å¦‚æ’å€¼çº¹ç†åæ ‡æ—¶ï¼Œè‹¥ä¸‰ä¸ªé¡¶ç‚¹çš„wå€¼ä¸º1.0ã€1.2ã€1.1ï¼ŒUVä¸º(0,0)ã€(1,0)ã€(0,1)ï¼Œåˆ™åƒç´ (150,300)çš„UVæ’å€¼ç»“æœä¸º(0.28, 0.23)45ã€‚

å…·ä½“æ¡ˆä¾‹ï¼š
-----

*   ä¸€ä¸ªçº¢è‰²æ¸å˜ä¸‰è§’å½¢ï¼Œé¡¶ç‚¹é¢œè‰²åˆ†åˆ«ä¸ºçº¢(1,0,0)ã€ç»¿(0,1,0)ã€è“(0,0,1)ã€‚
*   ç‰‡å…ƒ(200,350)çš„é‡å¿ƒåæ ‡ä¸º(0.5,0.3,0.2)ï¼Œæ’å€¼åé¢œè‰²ä¸º(0.5,0.3,0.2)ã€‚

å…‰æ …åŒ–åœ¨URPä¸­çš„å…·ä½“å®ç°
=============

**æ ¸å¿ƒç±»ä¸æ–¹æ³•**â€Œ
-----------

åœ¨URPç®¡çº¿ä¸­ï¼Œç›¸å…³é€»è¾‘ç”±ä»¥ä¸‹éƒ¨åˆ†å®ç°ï¼š

*   â€Œ**UniversalRendererç±»**â€Œï¼šè´Ÿè´£ç»„ç»‡æ¸²æŸ“æµç¨‹ï¼Œé€šè¿‡`RenderOpaqueGeometry`ç­‰æ–¹æ³•è§¦å‘å…‰æ …åŒ–
*   â€Œ**ShaderLibrary/Core.hlsl**â€Œï¼šåŒ…å«æ’å€¼è®¡ç®—çš„åº•å±‚å®ç°ï¼Œå¦‚`InterpolateBarycentricCoords`ç­‰å·¥å…·å‡½æ•°
*   â€Œ**GPUå›ºå®šåŠŸèƒ½å•å…ƒ**â€Œï¼šå®é™…è®¡ç®—ç”±ç¡¬ä»¶å…‰æ …åŒ–å™¨å®Œæˆï¼ŒUnityé€šè¿‡`CommandBuffer.DrawProcedural`ç­‰æ¥å£è§¦å‘

â€Œ**GPUåŠ é€Ÿæœºåˆ¶**â€Œ
-------------

**é‡å¿ƒåæ ‡è®¡ç®—é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ç¡¬ä»¶åŠ é€Ÿï¼š**

*   ç”±GPUçš„â€Œ**å…‰æ …åŒ–å¼•æ“**(Rasterizer Engine)è‡ªåŠ¨æ‰§è¡Œï¼Œå±äºå›ºå®šç®¡çº¿åŠŸèƒ½
*   Unityé€šè¿‡`ShaderPass`ä¸­çš„`HLSLPROGRAM`å£°æ˜æ’å€¼å˜é‡ï¼ˆå¦‚`Varyings`ç»“æ„ä½“ï¼‰ï¼Œé©±åŠ¨GPUå®Œæˆæ’å€¼
*   è®¡ç®—è¿‡ç¨‹ä¼˜åŒ–ä¸ºå¹¶è¡Œå¤„ç†ï¼Œæ¯ä¸ªæµå¤„ç†å™¨(SM)åŒæ—¶å¤„ç†å¤šä¸ªåƒç´ çš„é‡å¿ƒåæ ‡

**å…¸å‹æ•°æ®æµè·¯å¾„ä¸ºï¼š**  
`UniversalRenderer`Â â†’Â `Shader.Draw`Â â†’ GPUå…‰æ …åŒ–å™¨ â†’ ç‰‡å…ƒç€è‰²å™¨ï¼ˆæ¥æ”¶æ’å€¼åæ•°æ®

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰