---
layout: post
title: 'Manim实现阴影特效'
date: "2025-09-23T00:38:36Z"
---
Manim实现阴影特效
===========

本文将详细介绍如何在`Manim`中实现`2D`和`3D`阴影特效，提升动画的视觉层次感和真实感。

1\. 实现原理
========

`Manim`中的阴影特效主要通过创建对象副本、调整透明度、应用变换和模糊效果来实现。

下面我们将结合代码详细解析其实现原理。

1.1. 3D阴影实现原理
-------------

3D阴影效果更加复杂，需要考虑空间感和光影关系。

代码中提供了两种3D阴影实现：基础版`Shadow3D`和增强版`RealisticShadow3D`。

    class Shadow3D(Animation):
        def __init__(
            self,
            mobject,
            shadow_color=BLACK,
            shadow_opacity=0.3,
            blur_radius=0.1,
            direction=DOWN + RIGHT,
            distance=0.5,
            sharpness=1.0,
            **kwargs
        ):
            # 创建阴影对象
            self.shadow = mobject.copy()
            self.shadow.set_color(shadow_color)
            self.shadow.set_fill(opacity=shadow_opacity)
            self.shadow.set_stroke(opacity=shadow_opacity)
            
            # 设置阴影位置
            shadow_offset = direction * distance
            self.shadow.shift(shadow_offset)
            
            # 使用单个对象和变换创建模糊效果
            self.shadow_blur = None
            if blur_radius > 0:
                self.shadow_blur = self.shadow.copy()
                scale_factor = 1.0 + (1.0 - sharpness) * 0.1
                opacity_factor = 0.5 + (1.0 - sharpness) * 0.3
                self.shadow_blur.scale(scale_factor)
                self.shadow_blur.set_fill(opacity=shadow_opacity * opacity_factor)
                self.shadow_blur.set_stroke(opacity=shadow_opacity * opacity_factor)
            
            # 创建对象组
            if self.shadow_blur:
                self.shadow_group = VGroup(self.shadow_blur, self.shadow, mobject)
            else:
                self.shadow_group = VGroup(self.shadow, mobject)
            
            super().__init__(self.shadow_group, **kwargs)
    

`Shadow3D`类在2D阴影的基础上增加了锐度参数(`sharpness`)和模糊处理，通过调整缩放因子和透明度来模拟不同锐度的阴影效果。

值得**注意**的是，为了优化性能，代码采用了单个对象和变换来创建模糊效果，而不是多个副本，大大减少了渲染开销。

1.2. 增强版3D阴影实现
--------------

    class RealisticShadow3D(Animation):
        def __init__(
            self,
            mobject,
            shadow_color=BLACK,
            shadow_opacity=0.4,
            blur_radius=0.2,
            direction=DOWN + RIGHT,
            distance=0.5,
            light_source=3 * UP + 3 * RIGHT + 3 * OUT,
            **kwargs
        ):
            # 存储光源位置
            self.light_source = light_source
            
            # 创建阴影对象和位置设置
            self.shadow = mobject.copy()
            self.shadow.set_color(shadow_color)
            self.shadow.set_fill(opacity=shadow_opacity)
            self.shadow.set_stroke(opacity=shadow_opacity)
            
            shadow_offset = direction * distance
            self.shadow.shift(shadow_offset)
            
            # 模糊效果处理
            self.shadow_blur = None
            if blur_radius > 0:
                self.shadow_blur = self.shadow.copy()
                self.shadow_blur.scale(1.05)  # 轻微放大
                self.shadow_blur.set_fill(opacity=shadow_opacity * 0.7)
                self.shadow_blur.set_stroke(opacity=shadow_opacity * 0.7)
            
            # 创建对象组
            if self.shadow_blur:
                self.shadow_group = VGroup(self.shadow_blur, self.shadow, mobject)
            else:
                self.shadow_group = VGroup(self.shadow, mobject)
            
            super().__init__(self.shadow_group, **kwargs)
    

`RealisticShadow3D`类进一步增强了3D阴影的真实感，主要特点是加入了光源位置参数(`light_source`)，允许用户更精确地控制阴影的投射方向和形状，从而模拟出更真实的光照效果。

2\. 使用示例
========

下面我们通过几个具体场景来展示如何使用这些阴影特效。

2.1. 3D阴影效果示例
-------------

    class Shadow3DExample(ThreeDScene):
        def construct(self):
            # 创建3D对象
            cube = Cube(side_length=2, fill_opacity=0.8, fill_color=BLUE)
            sphere = Sphere(radius=1, fill_opacity=0.8, fill_color=RED)
            
            # 设置相机位置
            self.set_camera_orientation(phi=75 * DEGREES, theta=-45 * DEGREES)
            
            # 为3D对象添加阴影
            cube_shadow = Shadow3D(
                cube,
                shadow_color=GRAY,
                shadow_opacity=0.4,
                blur_radius=0.1,
                direction=DOWN + RIGHT,
                distance=0.3,
            )
            
            sphere_shadow = Shadow3D(
                sphere,
                shadow_color=GRAY,
                shadow_opacity=0.3,
                blur_radius=0.15,
                direction=DOWN + RIGHT,
                distance=0.4,
            )
            
            # 添加到场景并播放动画
            self.add(cube_shadow.shadow_group)
            self.add(sphere_shadow.shadow_group)
            
            cube.shift(2 * LEFT)
            sphere.shift(2 * RIGHT)
            
            self.play(FadeIn(cube_shadow.shadow_group), FadeIn(sphere_shadow.shadow_group))
            
            # 添加旋转和移动动画
            self.play(
                Rotate(cube_shadow.shadow_group, PI, axis=UP),
                Rotate(sphere_shadow.shadow_group, PI, axis=RIGHT),
                run_time=3,
            )
            
            self.play(
                cube_shadow.shadow_group.animate.shift(UP),
                sphere_shadow.shadow_group.animate.shift(DOWN),
                run_time=2,
            )
            
            self.wait()
    

![](https://img2024.cnblogs.com/blog/83005/202509/83005-20250922153953500-53316553.gif)

这个示例展示了如何在3D场景中使用阴影效果。通过设置相机位置和调整各种参数，可以创建出具有空间感的阴影效果。

代码还演示了如何将阴影效果与其他动画（如旋转和移动）结合使用。

2.2. 真实感3D阴影效果示例
----------------

    class RealisticShadow3DExample(ThreeDScene):
        def construct(self):
            # 创建3D对象
            cone = Cone(base_radius=1, height=2, fill_opacity=0.8, fill_color=GREEN)
            cylinder = Cylinder(radius=1, height=2, fill_opacity=0.8, fill_color=YELLOW)
            
            # 设置相机位置
            self.set_camera_orientation(phi=75 * DEGREES, theta=-45 * DEGREES)
            
            # 为对象添加真实感3D阴影
            cone_shadow = RealisticShadow3D(
                cone,
                shadow_color=GRAY,
                shadow_opacity=0.5,
                blur_radius=0.2,
                direction=DOWN + RIGHT,
                distance=0.4,
                light_source=3 * UP + 3 * RIGHT + 3 * OUT,
            )
            
            cylinder_shadow = RealisticShadow3D(
                cylinder,
                shadow_color=GRAY,
                shadow_opacity=0.4,
                blur_radius=0.25,
                direction=DOWN + 0.5 * RIGHT,
                distance=0.5,
                light_source=3 * UP + 2 * LEFT + 2 * OUT,
            )
            
            # 添加到场景并播放动画
            self.add(cone_shadow.shadow_group)
            self.add(cylinder_shadow.shadow_group)
            
            cone.shift(2 * LEFT)
            cylinder.shift(2 * RIGHT)
            
            self.play(
                FadeIn(cone_shadow.shadow_group), FadeIn(cylinder_shadow.shadow_group)
            )
            
            # 添加旋转和移动动画
            self.play(
                Rotate(cone_shadow.shadow_group, PI, axis=UP),
                Rotate(cylinder_shadow.shadow_group, PI, axis=RIGHT),
                run_time=3,
            )
            
            self.play(
                cone_shadow.shadow_group.animate.shift(UP),
                cylinder_shadow.shadow_group.animate.shift(DOWN),
                run_time=2,
            )
            
            self.wait()
    

![](https://img2024.cnblogs.com/blog/83005/202509/83005-20250922153953474-366401753.gif)

这个示例展示了如何使用`RealisticShadow3D`类创建更真实的3D阴影效果。

通过设置不同的光源位置(`light_source`)，可以为不同的3D对象创建符合物理规律的阴影效果。

3\. 总结
======

3.1. 阴影特效的特点
------------

1.  **多层次实现**：提供了从简单到复杂的多种阴影实现方式，适应不同场景需求。
2.  **参数化控制**：所有阴影效果都提供了丰富的参数，如颜色、透明度、模糊半径、方向、距离等，方便精细调整。
3.  **性能优化**：通过使用单个对象和变换来创建模糊效果，而不是多个副本，大大提高了渲染效率。
4.  **3D支持**：专门提供了3D阴影实现，支持在3D场景中创建具有空间感的阴影效果。
5.  **真实感增强**：增强版的`RealisticShadow3D`类考虑了光源位置，能够创建更符合物理规律的阴影效果。

3.2. 使用场景
---------

1.  **数学可视化**：为几何图形添加阴影，增强视觉层次感，帮助观众更好地理解空间关系。
2.  **文字动画**：为标题和重点文字添加阴影效果，提高视觉冲击力。
3.  **图表展示**：为数据图表添加阴影，增强立体感和可读性。
4.  **物理演示**：模拟真实世界的光照和阴影效果，用于物理概念的讲解。
5.  **艺术创作**：利用多层阴影和不同参数组合，创建独特的艺术效果。

通过本文介绍的阴影特效实现方法，您可以为`Manim`动画添加更加生动、立体的视觉效果，提升动画的专业度和观赏性。

无论是教学演示、学术报告还是艺术创作，这些阴影特效都能为您的作品增添亮点。