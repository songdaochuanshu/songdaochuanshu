---
layout: post
title: '新能源电池壳冲压车间看板实施'
date: "2025-05-29T00:41:36Z"
---
新能源电池壳冲压车间看板实施
==============

出发
==

我和一个老同事周六从苏州出发，做了5个小时动车，下午到达了江西的一家新能源厂。出发前我只知道这里是制造电池壳的，上一家是制造盖板，两个合起来刚好是一个完整的电池外壳。到了后一看才知道，原来制造的也是`71173`型号电池的零件。更绝的是，连车间设备都贴着我们公司的标志，一时间我分不清楚这里是哪里。

车间漫游
====

这个厂区就一个车间，面积还好，但是被机器和仓库区的产品塞得满满当当。我观察车间布局，为了出货方便，仓库区就在大门旁，叉车到门口货车的转运很快速方便。到车间后，对接人还没来，我们联系上了前一周到达这里的电气工程师，他提前在这边调试PLC程序。等了一会儿，公司在这边的对接人来了，带我们走了一遍车间，看了下流程。

![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528165733242-800516880.png)

*   **首先引入眼帘的是楼房一般的冲杯机**。冲杯机很高，有两层楼，5-6米高，运行起来的动静也很大。声音穿透鼓膜。几台解卷上料机将铝卷不断解开送入冲杯机，冲杯机一下下向下冲击，然后一个个冲杯叮叮当当地掉到传送带上。
    
*   **冲床**。继续走到冲床处，两个传送带从对立的两个方向将冲杯依次送入冲床，随着一声撞击声，一个个电池方壳排成两列从中间出来，传送带将他们继续往下送。到了传送带尽头，一个翻转机构将方壳倒转过来，突出的一面向上，不知道为什么？然后一个灵巧的上料机械臂机器人的众多抓手抓起一排产品，放入清洗线。清洗线里面传出了很大的噪音，有喷淋，超声波清洗，漂洗，风切，烘干，产品洗去润滑油后，从清洗线中出来。在尽头，同样是一个机械臂，利用章鱼一样多的真空吸附盘，吸起产品，一边移动，一边在空中旋转产品朝向，放入传送带，等待工人目检产品。
    
*   **最让我吃惊的自动化产线输送系统**。传送带布满整个车间，就像连接人体的血管。半成品流入眼花缭乱的传送带，机械手、翻转机构等把冲杯从一条传送带分流到另一条传送带。传送带还在电气柜的控制下时不时停顿，还有气动机构有时也会突然启动，挡住多余的半成品。一会儿缓冲区满，机械手抓住冲杯停在了落点上方，联动控制下冲杯机也悬在了半空，红色的故障灯亮起，停了下来，有人去检查，不一会儿，他回来了，在控制台上按下了某个按钮，故障灯熄灭，只剩下了绿色的启动灯，冲杯机又开始一下下压下来，连带着地面震动，捂住耳朵，但是身体还是在震动。
    
*   **目检房**中相比湿热的车间，就凉爽多了，因此还有一个自动门，在人员穿过前升起，通过后落下，防止跑气。里面做了很多排，好几十个工人，非常繁忙。
    

网络问题
====

原先车间是没有网络的，虽然对于我们来说，没有网络简直就无法呼吸。我们来的时候，车间接入了互联网，但是我始终没搞懂，其中有两个无线网络A、B，两个有线网络a,b。四个网络都接入了互联网，但是A、B、a能互相访问，但是b却和其他三个网络隔绝。恰巧机房的网络是a,而工控机的网络是b,于是内网中工控机就连不上服务器，最后要从互联网绕一圈的奇怪景象。很想说，这是什么鬼。  
**举例来说**  
![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528150218336-551617088.png)  
这是最后搞明白情况我画的一个示意图，出现了A类私有地址和C类私有地址。最开始是一脸懵逼，嗯嗯啊嗯的过去的。同事还提到了mesh组网，他一描述，我才觉得，有一个网络工程师还是挺重要的。

最后，还是暂时所有数据都通过采集盒子，通过WIFI传输

现在才真正开始的业务
==========

![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528173046118-253294314.png)

*   **数据怎么取**  
    我这一次负责的设备数据到web看板的展示，就是产量，状态之类的。在出发之前，看板就已经写完了，到了现场，只是调试，但是怎么调试，我还是一头雾水。因为出发之前我还没有拿到数据。开始我以为，像上班次产量数据这种，是只能通过后端自己查询数据库，自己计算出来的，然后设备的状态，产量之类的则是实时的取，也就自己启动了一个redis服务（实际上有同事从MQ取数据放到redis），在里面新建了几个键值对作为模拟数据。  
    ![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528160905358-1332712188.png)
    
*   **数据怎么对接**  
    我只知道这些数据最开始来自采集软件和MQ，采集软件的数据来自PLC我知道，但是MQ的数据来自哪里？我很迷糊。总之这不影响我完成后端和前端。  
    网络通了之后，看板数据出来了。但是点位复制时我把空格也复制进去了，所以redis里面点位名称和数据库配置中名称对不上，需要改数据库配置。这下所有设备的数据都取到了，看板上的东西都闪烁了起来。然后又发现现场一些设备中，有些点位没有，看板上有东西是多余的，我又改看板，去掉这些。  
    ![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528161507833-1722542209.png)  
    我跟着电气工程师，问数据的传输流程，他打开了一个输送带设备的电气控制柜，给我展示了PLC安装的位置，指了指一个黑盒子说，这是汇川最新的PLC，型号是8，一两万吧。我张了张嘴，脱口而出，好贵！然后他指着一个连着网线的小盒子，说这就是消息盒子，这跟网线连到了PLC，PLC通过TCP将数据发送到这个盒子。所以这个盒子和PLC在同一个网络咯？我问。他说是的，就在`61`那个网络下。但那是内网，没法把消息传回来。所以这个盒子有第二个网卡，能连WIFI，通过WIFI把数据发送到总部的MQ中。这样，数据从PLC到网页的整个流程我都清楚了。
    
*   **数据怎么从设备到PLC**  
    根据我之前买的设备实验看，一般也是网线，设备传感器那边有个单片机，采集数据并暂存，然后PLC通过网络协议，比如`Modbus`取到。但其实也可以电脑直接连接传感器取到。姑且认为PLC也是通过modbus取数据吧  
    ![image](https://img2024.cnblogs.com/blog/1494271/202505/1494271-20250528163630224-778664221.png)
    
*   **点位数据格式变化**  
    或许是由于沟通问题，最开始商量的状态取值是1、2、3，对应运行、故障、待机。后来改成了1、2、4，电气工程师指了指他的程序给我看（我不知道这叫梯形图还是什么），这不是相当于编码的数据解码后传输吗，我想起了3-8解码器。于是我又改了后端。这些看板状态都显示正确了，我站在冲杯机控制台旁边看，冲杯机冲压一下，控制台上的数字就+1，看板上的数字也+1，冲压机故障，红灯亮起，看板也变红，故障解除，绿灯亮起，看板绿灯也亮起。
    

收获与看法
=====

*   这次我问了电气工程师，实地看了设备和线路连接，才知道数据从源头到终点的整个流程，以前只零零散散知道中间的几个流程片段。
*   还知道了车间如繁星般的`三色塔灯`，红黄绿传递出的是可采集到的设备状态数据。
*   实际看到了生产线上，一个机构是如何与另一个机构配合，产品如何被一个机构加工和转移到另一个机构，从原料进入车间到最后走出车间。我觉得用图数据结构来描述产线在合适不过。量入为出，量出为入都很方便。