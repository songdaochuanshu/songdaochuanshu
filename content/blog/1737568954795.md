---
layout: post
title: 'ã€Œyoulai-bootã€è¿›é˜¶ç¯‡ï¼šJava & Spring Boot ä¼ä¸šçº§æƒé™ç®¡ç†ç³»ç»Ÿå®æˆ˜æŒ‡å—ï¼ˆå…¨åŠŸèƒ½è¯¦è§£ï¼‰'
date: "2025-01-22T18:02:34Z"
---
ã€Œyoulai-bootã€è¿›é˜¶ç¯‡ï¼šJava & Spring Boot ä¼ä¸šçº§æƒé™ç®¡ç†ç³»ç»Ÿå®æˆ˜æŒ‡å—ï¼ˆå…¨åŠŸèƒ½è¯¦è§£ï¼‰
========================================================

![ã€Œyoulai-bootã€è¿›é˜¶ç¯‡ï¼šJava &amp; Spring Boot ä¼ä¸šçº§æƒé™ç®¡ç†ç³»ç»Ÿå®æˆ˜æŒ‡å—ï¼ˆå…¨åŠŸèƒ½è¯¦è§£ï¼‰](https://img2024.cnblogs.com/blog/675291/202501/675291-20250121102125562-241809167.png) æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¼€æºçš„ youlai-boot é¡¹ç›®ï¼ŒåŒ…æ‹¬é¡¹ç›®å¯åŠ¨ã€ç¯å¢ƒé…ç½®ã€ä»£ç ç”Ÿæˆã€æ¥å£æ–‡æ¡£ç®¡ç†ã€æ–‡ä»¶ä¸Šä¼ ã€å®šæ—¶ä»»åŠ¡ç­‰åŠŸèƒ½ã€‚è¿˜æ¶µç›–äº†æ•°æ®æƒé™æ§åˆ¶ã€é˜²é‡æäº¤ã€IP é™æµã€å¤šæ•°æ®æºæ”¯æŒå’Œç™»å½•æ–¹å¼æ‰©å±•ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æä¾›åŸºäº Docker Compose å’Œ IntelliJ IDEA çš„ä¸€é”®éƒ¨ç½²æ–¹æ¡ˆã€‚

> ğŸš€ ä½œè€…ä¸»é¡µï¼š [æœ‰æ¥æŠ€æœ¯](https://www.youlai.tech)  
> ğŸ”¥ å¼€æºé¡¹ç›®ï¼š [youlai-mall](https://gitee.com/youlaitech/youlai-mall) ï¸±[vue3-element-admin](https://gitee.com/youlaiorg/vue3-element-admin)ï¸±[youlai-boot](https://gitee.com/youlaiorg/youlai-boot)ï¸±[vue-uniapp-template](https://gitee.com/youlaiorg/vue-uniapp-template)  
> ğŸŒº ä»“åº“ä¸»é¡µï¼š [GitCode](https://gitcode.com/org/youlai)ï¸± [Gitee](https://gitee.com/haoxr) ï¸± [Github](https://github.com/haoxianrui)  
> ğŸ’– æ¬¢è¿ç‚¹èµ ğŸ‘ æ”¶è— â­è¯„è®º ğŸ“ å¦‚æœ‰é”™è¯¯æ•¬è¯·çº æ­£ï¼

å‰è¨€
--

æœ¬æ–‡æ¡£æ—¨åœ¨ä¸ºå¼€å‘è€…æä¾›å…¨é¢çš„ [youlai-boot](https://gitee.com/youlaiorg/youlai-boot) é¡¹ç›®ä½¿ç”¨æŒ‡å—ï¼Œæ¶µç›–é¡¹ç›®ä»‹ç»ã€å¿«é€Ÿå¯åŠ¨ã€ç¯å¢ƒé…ç½®ã€åŠŸèƒ½æ“ä½œå’Œæ‰©å±•å®ç°ç­‰å¤šæ–¹é¢å†…å®¹ã€‚[youlai-boot](https://gitee.com/youlaiorg/youlai-boot) æ˜¯ä¸€æ¬¾åŸºäº Java 17 å’Œ Spring Boot 3 çš„ä¼ä¸šçº§æƒé™ç®¡ç†ç³»ç»Ÿï¼Œé›†æˆäº†å¤šç§ä¸»æµæŠ€æœ¯æ ˆï¼Œé€‚ç”¨äºå¤æ‚çš„ä¼ä¸šä¸šåŠ¡åœºæ™¯ã€‚é€šè¿‡æœ¬æ‰‹å†Œï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®ï¼Œå¹¶æ·±å…¥æŒæ¡å„æ¨¡å—çš„å®ç°ç»†èŠ‚å’Œæœ€ä½³å®è·µã€‚

é¡¹ç›®ä»‹ç»
----

[youlai-boot](https://gitee.com/youlaiorg/youlai-boot) æ˜¯ä¸€ä¸ªä¼ä¸šçº§ RBAC æƒé™ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ **Java 17**ã€**Spring Boot 3**ã€**Spring Security 6**ã€**MyBatis-Plus**ã€**Redis** å’Œ **XXL-Job** ç­‰ä¸»æµåç«¯æŠ€æœ¯æ ˆæ„å»ºï¼Œä½œä¸º [vue3-element-admin](https://gitee.com/youlaiorg/vue3-element-admin)ï¼ˆWeb ç«¯ï¼‰å’Œ [vue-uniapp-template](https://gitee.com/youlaiorg/vue-uniapp-template)ï¼ˆç§»åŠ¨ç«¯ï¼‰çš„åç«¯æœåŠ¡ï¼Œæ”¯æŒç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€éƒ¨é—¨ã€å­—å…¸ã€é…ç½®ç­‰å¤šç§åŠŸèƒ½ï¼Œæ»¡è¶³ä¼ä¸šçº§æƒé™ç®¡ç†éœ€æ±‚ã€‚

**é¡¹ç›®ç‰¹è‰²**

*   **å®Œå–„çš„æƒé™ç®¡ç†**ï¼šæ”¯æŒç²¾ç»†åŒ–çš„ç”¨æˆ·ã€è§’è‰²ã€èœå•å’Œæ•°æ®æƒé™æ§åˆ¶ã€‚
*   **é«˜æ•ˆçš„å¼€å‘å·¥å…·**ï¼šå†…ç½®å‰åç«¯ä»£ç ç”Ÿæˆå™¨ï¼Œå¿«é€Ÿæ­å»ºä¸šåŠ¡æ¨¡å—ã€‚
*   **å®æ—¶é€šä¿¡æ”¯æŒ**ï¼šåŸºäº WebSocket å®ç°åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡ä¸æ¶ˆæ¯æ¨é€ã€‚
*   **ç³»ç»Ÿå®‰å…¨æœºåˆ¶**ï¼šæä¾›é˜²é‡æäº¤ã€åˆ†å¸ƒå¼é”ç­‰ä¿éšœæ•°æ®å®‰å…¨çš„èƒ½åŠ›ã€‚
*   **çµæ´»çš„å®šæ—¶ä»»åŠ¡**ï¼šé›†æˆ XXL-Jobï¼Œæ”¯æŒå¤æ‚çš„ä»»åŠ¡è°ƒåº¦åœºæ™¯ã€‚

å¯åŠ¨é¡¹ç›®
----

ä»¥ä¸‹æ˜¯å¿«é€Ÿå¯åŠ¨ [youlai-boot é¡¹ç›®](https://gitee.com/youlaiorg/youlai-boot.git) çš„å®Œæ•´æ­¥éª¤ï¼Œä»å…‹éš†é¡¹ç›®åˆ°è¿è¡ŒæœåŠ¡ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹ã€‚

### å…‹éš†ä»£ç 

æ‰“å¼€ **IntelliJ IDEA**ï¼Œä¾æ¬¡ç‚¹å‡»ï¼š**File â†’ New â†’ Project from Version Control**

åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥é¡¹ç›®åœ°å€ï¼š[https://gitee.com/youlaiorg/youlai-boot.git](https://gitee.com/youlaiorg/youlai-boot.git) ï¼Œç„¶åç‚¹å‡» Cloneã€‚

![å…‹éš† youlai-boot](https://www.youlai.tech/storage/blog/image-20241226105842895.png)

ç¨ç­‰ç‰‡åˆ»ï¼Œç­‰å¾…é¡¹ç›®åŠ è½½å®Œæˆåï¼Œé¡¹ç›®ç»“æ„å°†å¦‚ä¸‹æ‰€ç¤ºï¼š

![åŠ è½½å®Œæˆ](https://www.youlai.tech/storage/blog/image-20241226111800309.png)

### é…ç½®ç¯å¢ƒ

å¯åŠ¨é¡¹ç›®å‰ï¼Œéœ€è¦ç¡®ä¿å¼€å‘ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š**å·²å®‰è£…å¹¶é…ç½® JDK å’Œ Maven**ã€‚

**é…ç½® JDK**

æ‰“å¼€é¡¹ç›®ç»“æ„é…ç½®é¢æ¿ **File â†’ Project Structure**ï¼ˆå¿«æ·é”® **Ctrl + Alt + Shift + S**ï¼‰æ‰“å¼€é¡¹ç›®ç»“æ„é…ç½®é¢æ¿ï¼Œç¡®ä¿ **SDK** è®¾ç½®ä¸ºå®‰è£…çš„ **JDK 17**ã€‚

![](https://www.youlai.tech/storage/blog/image-20241128164048566.png)

**é…ç½® Maven**

æ‰“å¼€ IDE è®¾ç½®é¢æ¿ï¼š**File â†’ Settings**ï¼ˆå¿«æ·é”® **Ctrl + Alt + S**ï¼‰ï¼Œåœ¨ **Build, Execution, Deployment â†’ Build Tools â†’ Maven** ä¸­ï¼Œé…ç½® Maven ä½¿ç”¨æœ¬åœ°å®‰è£…çš„ç‰ˆæœ¬ã€‚

![](https://www.youlai.tech/storage/blog/image-20241128164823123.png)

éªŒè¯ Maven é…ç½®ï¼šæ‰“å¼€ **IDEA ç»ˆç«¯**ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç¡®ä¿ Maven ä½¿ç”¨çš„æ˜¯ **JDK 17**ã€‚

    mvn -v
    

æ­£ç¡®è¾“å‡ºç¤ºä¾‹ï¼š

![](https://www.youlai.tech/storage/blog/image-20241129130035208.png)

### å¯åŠ¨é¡¹ç›®

æ‰“å¼€é¡¹ç›®çš„ä¸»å¯åŠ¨ç±» `YouLaiBootApplication`ã€‚å³é”®ç‚¹å‡» **main æ–¹æ³•**ï¼Œé€‰æ‹© `Debug YouLaiBootApplication.main()` å¯åŠ¨é¡¹ç›®ã€‚

![](https://www.youlai.tech/storage/blog/image-20241226115651975.png)

### æµ‹è¯•å¯åŠ¨

é¡¹ç›®å¯åŠ¨æˆåŠŸåï¼Œå¯é€šè¿‡è®¿é—®æ¥å£æ–‡æ¡£éªŒè¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š

è®¿é—® Knife4j æ¥å£æ–‡æ¡£ï¼š[http://localhost:8989/doc.html](http://localhost:8989/doc.html)

![](https://www.youlai.tech/storage/blog/image-20241226150912842.png)

è®¿é—® Swagger æ¥å£æ–‡æ¡£ï¼š [http://localhost:8989/swagger-ui.html](http://localhost:8989/swagger-ui.html)

![](https://www.youlai.tech/storage/blog/image-20241226151658453.png)

åˆ‡æ¢æœ¬åœ°ç¯å¢ƒ
------

### å®‰è£… Docker

é¡¹ç›®ä¸­çš„ MySQLã€Redisã€MinIO ç­‰ä¸­é—´ä»¶é»˜è®¤ä½¿ç”¨çº¿ä¸Šç¯å¢ƒï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç¦æ­¢å¢åˆ æ”¹æ“ä½œã€‚å¦‚æœéœ€è¦æ›´å¥½åœ°ä½“éªŒç³»ç»Ÿï¼Œå»ºè®®åœ¨æœ¬åœ°æ­å»º MySQLã€Redis ç­‰ä¸­é—´ä»¶ï¼Œå¹¶åˆ‡æ¢åˆ°æœ¬åœ°ç¯å¢ƒã€‚

æ‰‹åŠ¨æ­å»º MySQLã€Redis ç­‰ä¸­é—´ä»¶åŠåˆå§‹åŒ–æ•°æ®åº“è„šæœ¬å¯èƒ½è¾ƒä¸ºè€—æ—¶ã€‚æ¨èä½¿ç”¨ Docker å’Œ Docker Composeï¼Œé€šè¿‡é¡¹ç›®æä¾›çš„ `docker-compose` è„šæœ¬ä¸€é”®æ­å»º MySQLã€Redis å¹¶åˆå§‹åŒ–æ•°æ®åº“ã€‚

é¦–å…ˆï¼Œç¡®ä¿å·²å®‰è£… Dockerï¼Œå®‰è£…æ•™ç¨‹å¦‚ä¸‹ï¼š

*   [Windows å®‰è£… Docker å’Œ Docker Compose](https://youlai.blog.csdn.net/article/details/145053548)
*   [Linux (CentOS) å®‰è£… Docker å’Œ Docker Compose](https://youlai.blog.csdn.net/article/details/145055134)

### å®‰è£…ä¸­é—´ä»¶

å®‰è£…å¥½ Docker å’Œ Docker Compose åï¼ŒæŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ `docker-compose.yml` è„šæœ¬å†…å®¹ã€‚

è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œè¿è¡Œ`docker/run.md` å®Œæˆ MySQLã€Redisã€MinIO å’Œ XXL-Job çš„å®‰è£…ä¸é…ç½®ã€‚

![](https://www.youlai.tech/storage/blog/image-20241226171722942.png)

è¿è¡Œåï¼Œæ‰“å¼€ Docker Desktopï¼Œç¡®è®¤ä¸­é—´ä»¶å·²æˆåŠŸå®‰è£…ï¼š

![](https://www.youlai.tech/storage/blog/image-20241227114725749.png)

ä½¿ç”¨æ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼ˆå¦‚ Navicatï¼‰ï¼Œå¯ä»¥çœ‹åˆ° `youlai-boot` æ•°æ®åº“å·²æˆåŠŸåˆ›å»ºã€‚è¿™æ˜¯å› ä¸º `docker-compose.yml` æŒ‡å®šäº†åˆå§‹åŒ– SQL è„šæœ¬çš„è·¯å¾„ï¼š

    - ../sql/mysql8:/docker-entrypoint-initdb.d
    

ä»¥ä¸‹æ˜¯ä¸­é—´ä»¶çš„é»˜è®¤é…ç½®ã€‚å¦‚æœç«¯å£å·ä¸æœ¬åœ°åº”ç”¨å†²çªï¼Œè¯·ä¿®æ”¹ `docker-compose.yml` ä¸­å¯¹åº”çš„ç«¯å£è®¾ç½®ï¼š

ä¸­é—´ä»¶

ç«¯å£

ç”¨æˆ·å

å¯†ç 

æ§åˆ¶å°

MySQL

3306

root

123456

/

Redis

6379

/

123456

/

MinIO

9000

minioadmin

minioadmin

[http://lcalhost:9090](http://lcalhost:9090)

xxl-job-admin

8080

admin

admin

[http://lcalhost:8080](http://lcalhost:8080)

### ä¿®æ”¹æœ¬åœ°é…ç½®

#### é…ç½® MySQL

åœ¨ `application-dev.yml` æ–‡ä»¶ä¸­ï¼Œå°† MySQL çš„è¿æ¥ä¿¡æ¯æ›¿æ¢ä¸ºæœ¬åœ°ç¯å¢ƒé…ç½®ï¼Œä¾‹å¦‚æ•°æ®åº“åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ã€‚é»˜è®¤ç«¯å£æ˜¯ `3306`ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯ `root/123456`ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ã€‚

![](https://www.youlai.tech/storage/blog/image-20241227095944013.png)

* * *

#### é…ç½® Redis

åœ¨ `application-dev.yml` æ–‡ä»¶ä¸­ï¼Œå°† Redis çš„åœ°å€å’Œå¯†ç æ›¿æ¢ä¸ºæœ¬åœ°ç¯å¢ƒé…ç½®ã€‚å¦‚æœæœ¬åœ° Redis æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œç›´æ¥åˆ é™¤æˆ–æ³¨é‡Šæ‰ `password` é…ç½®ï¼Œé¿å…è¿æ¥å¤±è´¥ã€‚

![](https://www.youlai.tech/storage/blog/image-20241227111454206.png)

#### é…ç½® MinIO (å¯é€‰)

å¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨äº†æ–‡ä»¶ä¸Šä¼ æœåŠ¡ï¼Œè¯·åœ¨ `application-dev.yml` æ–‡ä»¶ä¸­ä¿®æ”¹ MinIO çš„è¿æ¥ä¿¡æ¯ä¸ºæœ¬åœ°ç¯å¢ƒé…ç½®ï¼ŒåŒ…æ‹¬åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤ç«¯å£ä¸º `9000`ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸º `minioadmin/minioadmin`ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ã€‚

![](https://www.youlai.tech/storage/blog/image-20241227144710796.png)

* * *

#### é…ç½® Xxl-Job (å¯é€‰)

å¦‚æœé¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨ XXL-Jobï¼Œè¯·åœ¨ `application-dev.yml` æ–‡ä»¶ä¸­å¼€å¯é…ç½®ï¼š

![](https://www.youlai.tech/storage/blog/image-20241227155953883.png)

æ“ä½œæŒ‡å—
----

### ä¿®æ”¹åŒ…å

é»˜è®¤åŒ…åä¸º `com.youlai.boot`ï¼Œå¦‚éœ€ä¿®æ”¹ä¸º `com.wuhui.boot`ï¼Œéœ€è¦åšä»¥ä¸‹æ”¹åŠ¨ï¼š

*   ä¿®æ”¹å¯åŠ¨ç±»åç§°
    
    å°†å¯åŠ¨ç±»ä» `YoulaiBootApplication` æ”¹ä¸º `WuhuiBootApplication`ã€‚
    
*   ä¿®æ”¹åº”ç”¨åç§°
    
    åœ¨ `application.yml` ä¸­å°† `spring.application.name` çš„å€¼ä» `youlai-boot` ä¿®æ”¹ä¸º `wuhui-boot`ï¼›åœ¨ `pom.xml` ä¸­å°† `<groupId>` å€¼ä» `com.youlai` æ”¹ä¸º `com.wuhui`
    
*   ä¿®æ”¹æ¥å£æ–‡æ¡£åŒ…è·¯å¾„ï¼Œå¦åˆ™æ¥å£æ–‡æ¡£ä¸æ˜¾ç¤ºæ¥å£æè¿°
    
    `application-*.yml` ä¿®æ”¹æ¥å£æ–‡æ¡£æ‰«æåŒ…è·¯å¾„
    
    ![](https://www.youlai.tech/storage/blog/image-20241229114630988.png)
    
*   ä»£ç ç”Ÿæˆçš„é¡¹ç›®åç§°
    
    `codegen.yml` é‡Œä¿®æ”¹åç«¯é¡¹ç›®åç§° `codegen.backendAppName` æ›¿æ¢ youlai-boot ä¸º wuhui-boot
    

### ä»£ç ç”Ÿæˆ

è¿™é‡Œä»¥ä¼šå‘˜ç®¡ç†æ¨¡å—ä¸ºä¾‹ï¼Œæ¥è®²è§£å¦‚ä½•ç”Ÿæˆå‰åç«¯ä»£ç ä»¥åŠåœ¨é¡¹ç›®ä¸­æ–°å¢ä¸€ä¸ªæ¨¡å—æ—¶è‡ªåŠ¨ç”Ÿæˆèœå•è·¯ç”±ã€‚

#### åˆ›å»ºæ•°æ®è¡¨

åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œä»¥ä¸‹ SQL è„šæœ¬ä»¥åˆ›å»º **ä¼šå‘˜ä¿¡æ¯è¡¨**ï¼š

    CREATE TABLE `member` (
            `id` int NOT NULL AUTO_INCREMENT COMMENT 'ä¼šå‘˜ç¼–å·',
            `name` varchar(50)  DEFAULT NULL COMMENT 'ä¼šå‘˜å§“å',
            `mobile` varchar(20) DEFAULT NULL COMMENT 'ä¼šå‘˜æ‰‹æœºå·',
            `gender` tinyint DEFAULT NULL COMMENT 'æ€§åˆ«',
            `age` int DEFAULT NULL COMMENT 'ä¼šå‘˜å¹´é¾„',
            `create_time` timestamp NULL DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
            `update_time` timestamp NULL DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',
            `is_deleted` tinyint(1) DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤(1:å·²åˆ é™¤;0:æœªåˆ é™¤)',
    PRIMARY KEY (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT='ä¼šå‘˜ä¿¡æ¯è¡¨';
    

#### å¯åŠ¨é¡¹ç›®

*   **å¯åŠ¨åç«¯é¡¹ç›®**ï¼š[youlai-boot](https://gitee.com/youlaiorg/youlai-boot)ã€‚
    
*   **å¯åŠ¨å‰ç«¯é¡¹ç›®**ï¼š[vue3-element-admin](https://gitee.com/youlaiorg/vue3-element-admin)ã€‚
    
    *   åœ¨å¯åŠ¨å‰ç«¯é¡¹ç›®ä¹‹å‰ï¼Œéœ€è¦ä¿®æ”¹ `.env.development` æ–‡ä»¶ä¸­çš„æ¥å£åœ°å€ä¸ºæœ¬åœ°å¼€å‘ç¯å¢ƒçš„åç«¯æœåŠ¡åœ°å€ã€‚

#### ç”Ÿæˆä»£ç 

**è¿›å…¥å‰ç«¯é¡µé¢çš„ä»£ç ç”Ÿæˆå™¨** åœ¨å‰ç«¯é¡¹ç›®ä¸­æ‰¾åˆ° `ä»£ç ç”Ÿæˆ` èœå•ï¼Œé€‰æ‹© `member` è¡¨ï¼Œç‚¹å‡»ç”Ÿæˆä»£ç ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101154026661.png)

**å¡«å†™åŸºç¡€é…ç½®ä¿¡æ¯**

*   **ä¸šåŠ¡å**ï¼šä¼šå‘˜ä¿¡æ¯
*   **ä¸»åŒ…å**ï¼šcom.youlai.boot
*   **æ¨¡å—å**ï¼šmember
*   **å®ä½“å**ï¼šMember
*   å¦‚æœéœ€è¦è‡ªåŠ¨ç”Ÿæˆä¼šå‘˜æ¨¡å—çš„èœå•å’ŒæŒ‰é’®æƒé™ï¼Œè¯·é€‰æ‹©å¯¹åº”çš„ä¸Šçº§èœå•ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101230553550.png)

**é…ç½®å­—æ®µä¿¡æ¯**

*   é…ç½®ç­›é€‰ã€åˆ—è¡¨å’Œè¡¨å•çš„å­—æ®µã€‚
*   å¯é€‰æ‹©å­—æ®µç±»å‹ï¼Œä¾‹å¦‚æ–‡æœ¬æ¡†ã€ä¸‹æ‹‰æ¡†ç­‰ã€‚
*   å¦‚æœå­—æ®µéœ€è¦å­—å…¸æ”¯æŒï¼Œå¯ä»¥é…ç½®å­—å…¸ä¿¡æ¯ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/02/image-20250102004837809.png)

**åœ¨çº¿é¢„è§ˆå’Œä¸‹è½½ä»£ç **

*   é…ç½®å®Œæˆåï¼Œå¯ä»¥åœ¨çº¿é¢„è§ˆç”Ÿæˆçš„å‰åç«¯ä»£ç ã€‚
*   ä¸‹è½½ç”Ÿæˆçš„ä»£ç å‹ç¼©åŒ…åˆ°æœ¬åœ°ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101162925374.png)

#### é›†æˆä»£ç 

ä¸‹è½½ä»£ç ï¼Œè§£å‹å¾—åˆ°å‰åç«¯ä»£ç 

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101195557920.png)

**åç«¯ä»£ç é›†æˆ**

*   è§£å‹ä¸‹è½½çš„ä»£ç åŒ…ï¼Œå°†åç«¯ä»£ç å¤åˆ¶åˆ° `youlai-boot` é¡¹ç›®å¯¹åº”çš„ç›®å½•ä¸­ã€‚
*   ç¡®ä¿é¡¹ç›®é‡æ–°åŠ è½½æ–°ä»£ç ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„æ„å»ºå’Œå¯åŠ¨æ“ä½œã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/PixPin_2025-01-01_23-34-38.gif)

**å‰ç«¯ä»£ç é›†æˆ**

*   åŒæ ·å°†å‰ç«¯ä»£ç å¤åˆ¶åˆ°å‰ç«¯é¡¹ç›®ä¸­å¯¹åº”çš„ç›®å½•ã€‚

#### åŠŸèƒ½æµ‹è¯•

è¿›å…¥ **è§’è‰²ç®¡ç†** æ¨¡å—ï¼Œä¸ºå½“å‰ç”¨æˆ·çš„è§’è‰²åˆ†é…æ–°ç”Ÿæˆçš„ **ä¼šå‘˜ç®¡ç†** èœå•æƒé™ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101234621001.png)

å‹¾é€‰èœå•ä¸­çš„ **ä¼šå‘˜ä¿¡æ¯** é€‰é¡¹ã€‚å®Œæˆæƒé™åˆ†é…åï¼Œåˆ·æ–°é¡µé¢ã€‚å¦‚æœå·¦ä¾§èœå•æ æœªæ˜¾ç¤º **ä¼šå‘˜ä¿¡æ¯** èœå•ï¼Œè¯·å°è¯•é‡æ–°ç™»å½•ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/01/image-20250101235252287.png)

è¿›å…¥ **ä¼šå‘˜ç®¡ç†** æ¨¡å—ï¼Œæ–°å¢ä¼šå‘˜ä¿¡æ¯ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/02/image-20250102005025892.png)

æ–°å¢æˆåŠŸåï¼Œåœ¨ä¼šå‘˜åˆ—è¡¨ä¸­å¯ä»¥æŸ¥çœ‹åˆ°åˆšæ·»åŠ çš„ä¼šå‘˜æ•°æ®ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/02/image-20250102010855745.png)

### æ¥å£æ–‡æ¡£

æ¥å£æ–‡æ¡£çš„è®¿é—®è·¯å¾„ä¸º **åº”ç”¨åœ°å€/doc.html**ã€‚åœ¨æœ¬åœ°ç¯å¢ƒä¸­ï¼Œyouai-boot é¡¹ç›®çš„æ¥å£æ–‡æ¡£åœ°å€ä¸ºï¼š[http://localhost:8989/doc.htmlã€‚](http://localhost:8989/doc.html%E3%80%82)

#### ç™»å½•æ¥å£

ç”±äºå¤§éƒ¨åˆ†æ¥å£éœ€è¦è®¿é—®ä»¤ç‰Œï¼ˆTokenï¼‰è¿›è¡Œèº«ä»½è®¤è¯ï¼Œç™»å½•æ¥å£æ˜¯ä½¿ç”¨æ¥å£æ–‡æ¡£çš„åŸºç¡€ã€‚é€šè¿‡ç™»å½•æ¥å£è·å–æˆåŠŸè¿”å›çš„è®¿é—®ä»¤ç‰Œåï¼Œå¯ä»¥å°†å…¶è®¾ç½®åˆ°æ¥å£æ–‡æ¡£çš„å…¨å±€å˜é‡ä¸­ï¼Œæ–¹ä¾¿åç»­æ¥å£çš„æµ‹è¯•ã€‚

![ç™»å½•æ¥å£](https://www.youlai.tech/storage/blog/2025/01/11/image-20250111003635179.png)

#### è®¾ç½®å…¨å±€ Token

å°†ç™»å½•æ¥å£è¿”å›çš„è®¿é—®ä»¤ç‰Œè®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼šåœ¨æ¥å£æ–‡æ¡£å³ä¸Šè§’æ‰¾åˆ°å…¨å±€å˜é‡é…ç½®é€‰é¡¹ï¼Œè¾“å…¥ä»¤ç‰Œå€¼åä¿å­˜ã€‚

![è®¾ç½®å…¨å±€ Token](https://www.youlai.tech/storage/blog/2025/01/11/image-20250111003840987.png)

#### æ¥å£æµ‹è¯•

è®¾ç½®å¥½å…¨å±€è®¿é—®ä»¤ç‰Œåï¼Œæ‰“å¼€å…¶ä»–æ¥å£æ—¶ä¼šå‘ç°ä»¤ç‰Œå·²è‡ªåŠ¨å¡«å……ï¼Œæ— éœ€æ‰‹åŠ¨ä¸ºæ¯ä¸ªæ¥å£å•ç‹¬è®¾ç½®ä»¤ç‰Œï¼Œæå¤§ç®€åŒ–äº†æµ‹è¯•æµç¨‹ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/11/image-20250111003956347.png)

### å®šæ—¶ä»»åŠ¡

åœ¨ä¹‹å‰çš„ **åˆ‡æ¢æœ¬åœ°ç¯å¢ƒ** å’Œ **å®‰è£…ä¸­é—´ä»¶** éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Docker Compose ä¸€é”®å®‰è£…äº† XXL-JOBã€‚æœ¬èŠ‚ä¸»è¦ä»‹ç»å¦‚ä½•é…ç½®å’Œä½¿ç”¨ XXL-JOBã€‚å¦‚æœæ‚¨å°šæœªå®‰è£… XXL-JOBï¼Œæˆ–è€…éœ€è¦ä»é›¶å¼€å§‹äº†è§£å®‰è£…è¿‡ç¨‹ï¼Œè¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š[Spring Boot 3 æ•´åˆ XXL-JOB å®ç°åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡è°ƒåº¦](https://youlai.blog.csdn.net/article/details/134159913)ã€‚

XXL-JOB åŒ…å«ä¸¤ä¸ªä¸»è¦è§’è‰²ï¼š**è°ƒåº¦å™¨** å’Œ **æ‰§è¡Œå™¨**ã€‚è°ƒåº¦å™¨æ˜¯æœåŠ¡ç«¯ï¼Œç”¨äºç®¡ç†ä»»åŠ¡è°ƒåº¦ï¼›æ‰§è¡Œå™¨æ˜¯åº”ç”¨ç«¯ï¼Œç”¨äºæ‰§è¡Œä»»åŠ¡çš„å…·ä½“é€»è¾‘ã€‚

*   `XXL-JOB` æ§åˆ¶å°åœ°å€ï¼š [http://localhost:8080/xxl-job-admin](http://localhost:8080/xxl-job-admin)
*   ç”¨æˆ·å/å¯†ç ï¼š admin/123456

![XXL-JOB æ§åˆ¶å°](https://www.youlai.tech/storage/blog/image-20250114103049630.png)

#### ä¿®æ”¹é…ç½®

XXL-JOB çš„å®šæ—¶ä»»åŠ¡é»˜è®¤æ˜¯å…³é—­çš„ã€‚è¯·æ ¹æ®ä¸‹å›¾ä¿®æ”¹é…ç½®ï¼š

1.  å°† `xxl.job.enabled` è®¾ç½®ä¸º `true`ã€‚
2.  è°ƒæ•´è°ƒåº¦ä¸­å¿ƒåœ°å€ä¸ºå®é™…å®‰è£…åœ°å€ï¼Œå…¶å®ƒé…ç½®å¯ä¿æŒé»˜è®¤ã€‚

![](https://www.youlai.tech/storage/blog/image-20241227155953883.png)

#### æ·»åŠ æ‰§è¡Œå™¨

åœ¨ `application-dev.yml` ä¸­ï¼Œæ‰§è¡Œå™¨çš„åº”ç”¨åç§° (`xxl.job.executor.appname`) é»˜è®¤é…ç½®ä¸ºï¼š  
`xxl-job-executor-${spring.application.name}`ï¼Œå…¶ä¸­ `${spring.application.name}` ä¼šè§£æä¸ºå½“å‰åº”ç”¨åç§°ã€‚ä¾‹å¦‚ï¼Œåœ¨ `youlai-boot` é¡¹ç›®ä¸­ï¼Œ`appname` å°†è§£æä¸º `xxl-job-executor-youlai-boot`ã€‚

**æ“ä½œæ­¥éª¤**ï¼š

1.  åœ¨ XXL-JOB æ§åˆ¶å°ä¸­ï¼Œæ·»åŠ æ‰§è¡Œå™¨ï¼Œ`appname` é…ç½®ä¸º `xxl-job-executor-youlai-boot`ã€‚
    
    ![](https://www.youlai.tech/storage/blog/image-20250114124557381.png)
    
2.  å› ä¸ºé‡‡ç”¨çš„æ˜¯**è‡ªåŠ¨æ³¨å†Œ**æ–¹å¼ï¼Œé‡å¯ `youlai-boot` åº”ç”¨åï¼Œå†åˆ·æ–°æ‰§è¡Œå™¨åˆ—è¡¨ï¼Œå¯ä»¥çœ‹åˆ°æœºå™¨å·²æˆåŠŸæ³¨å†Œã€‚![](https://www.youlai.tech/storage/blog/image-20250114125114677.png)
    

#### æ·»åŠ ä»»åŠ¡

åœ¨ `youlai-boot` åº”ç”¨ä¸­ï¼Œæ·»åŠ ä»»åŠ¡æ‰§è¡Œé€»è¾‘ã€‚ä»¥ä¸‹æ˜¯ç¤ºä¾‹ä»£ç ï¼š

    package com.youlai.boot.system.handler;
    
    /**
     * xxl-job æµ‹è¯•ç¤ºä¾‹ï¼ˆBeanæ¨¡å¼ï¼‰
     */
    @Component
    @Slf4j
    public class XxlJobSampleHandler {
    
        @XxlJob("demoJobHandler")
        public void demoJobHandler() {
            log.info("XXL-JOB, Hello World.");
        }
        
    }
    

**é…ç½®ä»»åŠ¡**ï¼š

1.  åœ¨ XXL-JOB æ§åˆ¶å°ä¸­ï¼Œè¿›å…¥â€œä»»åŠ¡ç®¡ç†â€é¡µé¢ï¼Œé€‰æ‹©æ–°å¢ä»»åŠ¡ã€‚
2.  é€‰æ‹©åˆšåˆšåˆ›å»ºçš„ `youlai-boot` åº”ç”¨å¯¹åº”çš„**æ‰§è¡Œå™¨**ã€‚
3.  é…ç½® Cron è¡¨è¾¾å¼æ¥è®¾å®šä»»åŠ¡æ‰§è¡Œæ—¶é—´å’Œé¢‘ç‡ã€‚
4.  è®¾ç½®ä»»åŠ¡æ¨¡å¼ä¸º **Bean æ¨¡å¼**ï¼Œè°ƒç”¨ Spring å®¹å™¨ä¸­çš„ Beanï¼Œå…¶ä¸­ Bean åç§°ä¸º `@XxlJob("demoJobHandler")` ä¸­å®šä¹‰çš„ `demoJobHandler`ã€‚

![é…ç½®ä»»åŠ¡](https://www.youlai.tech/storage/blog/image-20250114134053154.png)

#### å®šæ—¶ä»»åŠ¡æµ‹è¯•

ä»»åŠ¡åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥åœ¨â€œæ“ä½œâ€åˆ—ä¸­é€‰æ‹©**å¯åŠ¨**è¿›è¡Œæµ‹è¯•ã€‚

**æ³¨æ„äº‹é¡¹**ï¼š  
è°ƒåº¦å™¨å’Œæ‰§è¡Œå™¨éœ€è¦åœ¨ç½‘ç»œä¸Šäº’é€šã€‚å¦‚æœè°ƒåº¦å™¨éƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ä¸Šï¼Œè€Œæ‰§è¡Œå™¨è¿è¡Œåœ¨æœ¬åœ°ï¼Œåˆ™æ— æ³•æ­£å¸¸è¿è¡Œã€‚å»ºè®®å°†åº”ç”¨ä¹Ÿéƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ã€‚

![](https://www.youlai.tech/storage/blog/image-20250114151007837.png)

å¯åŠ¨ä»»åŠ¡åï¼Œå¯ä»¥æŸ¥çœ‹åº”ç”¨æ§åˆ¶å°æ—¥å¿—ï¼ŒéªŒè¯ä»»åŠ¡æ˜¯å¦æ­£ç¡®æ‰§è¡Œã€‚

![](https://www.youlai.tech/storage/blog/image-20250114151336195.png)

### æ–‡ä»¶ä¸Šä¼ 

[youlai-boot](https://gitee.com/youlaiorg/youlai-boot) ç›®å‰æ”¯æŒ `MinIO`ã€é˜¿é‡Œäº‘ä»¥åŠæœ¬åœ°æ–‡ä»¶å­˜å‚¨æ–¹å¼ã€‚ä»¥ä¸‹ä»¥å¸¸ç”¨çš„ MinIO ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚

#### åˆ›å»ºå­˜å‚¨æ¡¶

åœ¨ä¸Šä¸€ç« èŠ‚ **åˆ‡æ¢æœ¬åœ°ç¯å¢ƒ** å’Œ **å®‰è£…ä¸­é—´ä»¶** ä¸­ï¼Œæˆ‘ä»¬å·²é€šè¿‡ Docker Compose å¿«é€Ÿå®‰è£…äº† MinIOã€‚å¦‚æœå°šæœªå®‰è£…ï¼Œå¯å‚è€ƒï¼š[Docker éƒ¨ç½² MinIO å¯¹è±¡å­˜å‚¨ç³»ç»Ÿ](https://youlai.blog.csdn.net/article/details/130439396)ã€‚

*   **MinIO æ§åˆ¶å°åœ°å€**ï¼š[http://localhost:9090/](http://localhost:9090/)
*   **é»˜è®¤ç”¨æˆ·å/å¯†ç **ï¼š`minioadmin`/`minioadmin`

ç™»å½•æ§åˆ¶å°ï¼Œè®¿é—® [http://localhost:9090/buckets/add-bucket](http://localhost:9090/buckets/add-bucket) é¡µé¢ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `youlai` çš„å­˜å‚¨æ¡¶ã€‚

![youlai minio bucket](https://www.youlai.tech/storage/blog/2025/01/10/image-20250110224601121.png)

è®¾ç½®å­˜å‚¨æ¡¶çš„è®¿é—®æƒé™ï¼ˆ**Access Policy**ï¼‰ä¸º **public**ã€‚

![youlai minio bucket access policy](https://www.youlai.tech/storage/blog/2025/01/10/20250110224924.gif)

#### ä¿®æ”¹åº”ç”¨é…ç½®

æ‰“å¼€é¡¹ç›®çš„ `application-dev.yml` æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶å­˜å‚¨ç›¸å…³å‚æ•°ï¼š

*   æŒ‡å®š `oss.type` ä¸º `minio`
*   è®¾ç½®æœåŠ¡åœ°å€ä¸º [http://localhost:9000](http://localhost:9000)
*   ä½¿ç”¨é»˜è®¤è®¿é—®å‡­æ®ï¼šç”¨æˆ·å `minioadmin`ï¼Œè®¿é—®å¯†é’¥ `minioadmin`
*   å­˜å‚¨æ¡¶åç§°ä¸º `youlai`ï¼ˆå‰æ–‡åˆ›å»ºçš„å­˜å‚¨æ¡¶ï¼‰

é…ç½®ç¤ºä¾‹ï¼š

![](https://www.youlai.tech/storage/blog/2025/01/10/image-20250110232006970.png)

#### æ–‡ä»¶ä¸Šä¼ æµ‹è¯•

å¯åŠ¨é¡¹ç›®åï¼Œè®¿é—®æ¥å£æ–‡æ¡£ [http://localhost:8989/doc.htmlã€‚é€‰æ‹©æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œä¸Šä¼ æ–‡ä»¶åä¼šè¿”å›å¯¹åº”çš„æ–‡ä»¶](http://localhost:8989/doc.html%E3%80%82%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3%EF%BC%8C%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%90%8E%E4%BC%9A%E8%BF%94%E5%9B%9E%E5%AF%B9%E5%BA%94%E7%9A%84%E6%96%87%E4%BB%B6) URLã€‚å°†è¿”å›çš„ URL ç²˜è´´åˆ°æµè§ˆå™¨ä¸­ï¼Œå³å¯é¢„è§ˆä¸Šä¼ çš„æ–‡ä»¶ã€‚

![](https://www.youlai.tech/storage/blog/2025/01/11/image-20250111004334134.png)

é¡¹ç›®åŠŸèƒ½
----

### æ•°æ®æƒé™

ä¸ºäº†å®ç°å¤šç§Ÿæˆ·å’Œæƒé™æ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ MyBatis-Plus è‡ªå®šä¹‰æ•°æ®æƒé™æ³¨è§£å’Œå¤„ç†å™¨ï¼ŒåŠ¨æ€è¿‡æ»¤æ•°æ®ã€‚ä»¥ä¸‹æ˜¯å®ç°æ–¹å¼ï¼š

#### å®ç°åŸç†

é€šè¿‡è‡ªå®šä¹‰æ‹¦æˆªå™¨å®ç° `DataPermissionHandler` æ¥å£ã€‚åœ¨ youlai-boot ä¸­ï¼Œ`MyDataPermissionHandler` æ˜¯å…¶å…·ä½“å®ç°ç±»ï¼Œç”¨äºåœ¨ SQL æ‰§è¡Œå‰åŠ¨æ€æ‹¼æ¥æƒé™è¿‡æ»¤æ¡ä»¶ã€‚  
å¤„ç†é€»è¾‘å¦‚ä¸‹ï¼š

*   è·å–ç”¨æˆ·æƒé™èŒƒå›´ï¼ˆå¦‚éƒ¨é—¨æˆ–ç”¨æˆ·ï¼‰ã€‚
*   åŠ¨æ€ç”Ÿæˆç­›é€‰æ¡ä»¶ï¼šå¦‚éƒ¨é—¨åŠä»¥ä¸‹çš„ `dept_id IN (...)` æˆ–ä¸ªäººåˆ›å»ºçš„ `create_by = ...`ã€‚
*   å°†æ¡ä»¶è¿½åŠ åˆ°åŸå§‹ SQL çš„ `WHERE` å­å¥ã€‚

#### ä½¿ç”¨ç¤ºä¾‹

åœ¨æ•°æ®æŒä¹…å±‚çš„æ–¹æ³•ä¸­ï¼Œå¦‚æœéœ€è¦å®ç°æ•°æ®æƒé™æ§åˆ¶ï¼Œå¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸Šæ·»åŠ  `@DataPermission` æ³¨è§£ã€‚

**UserMapper.java**

    @Mapper
    public interface UserMapper {
    
        @DataPermission(
            deptAlias = "u", // éƒ¨é—¨å­—æ®µçš„è¡¨åˆ«åï¼Œç”¨äºæ ‡è®° SQL ä¸­éƒ¨é—¨å­—æ®µçš„æ¥æºè¡¨
            deptIdColumnName = "dept_id", // éƒ¨é—¨å­—æ®µçš„åˆ—åï¼Œé»˜è®¤ä¸º dept_id
            userAlias = "u", // ç”¨æˆ·å­—æ®µçš„è¡¨åˆ«åï¼Œç”¨äºæ ‡è®° SQL ä¸­ç”¨æˆ·å­—æ®µçš„æ¥æºè¡¨
            userIdColumnName = "create_by" // ç”¨æˆ·å­—æ®µçš„åˆ—åï¼Œé»˜è®¤ä¸º create_by
        )
        Page<UserBO> getUserPage(Page<UserBO> page, UserPageQuery queryParams);
    }
    

**UserMapper.xml**

    <select id="getUserPage">
        SELECT
            u.id,
            u.username,
            u.nickname,
            u.dept_id
        FROM
            sys_user u
        WHERE
            u.is_deleted = 0
    </select>
    

åŠ¨æ€ SQL ç¤ºä¾‹ï¼š

*   **æƒé™èŒƒå›´ï¼šéƒ¨é—¨åŠä»¥ä¸‹**
    
        SELECT u.id, u.username, u.nickname, u.dept_id 
        FROM sys_user u 
        WHERE u.is_deleted = 0 
          AND u.dept_id IN (SELECT id FROM sys_dept WHERE id = 3 OR FIND_IN_SET(3, tree_path));
        
    
    å…¶ä¸­`AND u.dept_id IN (SELECT id FROM sys_dept WHERE id = 3 OR FIND_IN_SET(3, tree_path))`æ˜¯ `MyDataPermissionHandler` æ ¹æ®ç”¨æˆ·æƒé™ä¸ºâ€œéƒ¨é—¨åŠä»¥ä¸‹â€åŠ¨æ€è¿½åŠ çš„ç­›é€‰æ¡ä»¶ã€‚
    
*   **æƒé™èŒƒå›´ï¼šæœ¬äººåˆ›å»º**
    
        SELECT u.id, u.username, u.nickname, u.dept_id 
        FROM sys_user u 
        WHERE u.is_deleted = 0 
          AND u.create_by = 2;
        
    
    å…¶ä¸­ï¼š`AND u.create_by = 2`æ˜¯ `MyDataPermissionHandler` æ ¹æ®ç”¨æˆ·æƒé™ä¸ºâ€œæœ¬äººåˆ›å»ºâ€åŠ¨æ€è¿½åŠ çš„ç­›é€‰æ¡ä»¶ã€‚
    

### é˜²é‡æäº¤

ä¸ºé˜²æ­¢ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡æäº¤ç›¸åŒè¯·æ±‚ï¼Œç³»ç»Ÿæä¾›äº†é˜²é‡å¤æäº¤åŠŸèƒ½ã€‚é€šè¿‡ç®€å•çš„æ³¨è§£é…ç½®ï¼Œå³å¯å®ç°æ­¤åŠŸèƒ½ã€‚

#### ä½¿ç”¨é˜²é‡æäº¤

åœ¨éœ€è¦é˜²é‡å¤æäº¤çš„æ¥å£ä¸Šæ·»åŠ  `@RepeatSubmit` æ³¨è§£å³å¯ã€‚é€šè¿‡æ³¨è§£å‚æ•° `expire`ï¼Œå¯ä»¥çµæ´»æ§åˆ¶é‡å¤æäº¤çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚å¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤æ—¶é—´ä¸º 5 ç§’ã€‚

ç¤ºä¾‹ï¼š

    @Operation(summary = "æ–°å¢ç”¨æˆ·")
    @PostMapping
    @RepeatSubmit(expire = 3) // 3 ç§’å†…ç¦æ­¢é‡å¤æäº¤
    public Result<?> saveUser(
        @RequestBody @Valid UserForm userForm
    ) {
        // TODO æ–°å¢ç”¨æˆ·é€»è¾‘
        return Result.success();
    }
    

* * *

#### æµ‹è¯•é˜²é‡æäº¤

æ¨¡æ‹ŸçŸ­æ—¶é—´å†…çš„å¤šæ¬¡è¯·æ±‚æ¥éªŒè¯é˜²é‡å¤æäº¤æ•ˆæœã€‚ä¾‹å¦‚ï¼Œé¢‘ç¹è°ƒç”¨æ–°å¢ç”¨æˆ·æ¥å£ã€‚

ä»¥ä¸‹æ˜¯æµ‹è¯•è¯·æ±‚çš„æ•ˆæœæ¼”ç¤ºï¼š

![](https://www.youlai.tech/storage/blog/20250107165213.gif)

é€šè¿‡ç®€å•é…ç½®ï¼Œå³å¯æœ‰æ•ˆé˜²æ­¢é‡å¤æäº¤ï¼Œç¡®ä¿æ¥å£çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚

### IP é™æµ

ä¸ºé˜²æ­¢æ¥å£è¢«æ¶æ„åˆ·å–ï¼Œç³»ç»Ÿå†…ç½®äº† IP é™æµæœºåˆ¶ã€‚å½“åŒä¸€ IP åœ¨å•ä½æ—¶é—´å†…çš„è¯·æ±‚æ¬¡æ•°è¶…è¿‡é™åˆ¶æ—¶ï¼Œç³»ç»Ÿå°†å¯¹è¯¥ IP è¿›è¡Œè®¿é—®é™åˆ¶ã€‚

#### é…ç½® QPS

å¯é€šè¿‡è®¿é—®ç®¡ç†åå°çš„ **ç³»ç»Ÿç®¡ç† â†’ ç³»ç»Ÿé…ç½®** èœå•è®¾ç½® QPS é˜ˆå€¼ï¼ˆå•ä½æ—¶é—´æœ€å¤§è¯·æ±‚æ•°ï¼‰ã€‚

*   è‹¥æœªé…ç½®æˆ–ç¦ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™è¡¨ç¤ºå…³é—­ `IP` é™æµåŠŸèƒ½ã€‚

![](https://www.youlai.tech/storage/blog/image-20250114163544114.png)

#### é™æµæµ‹è¯•

ä»¥ä¸‹ä¸ºæ¨¡æ‹Ÿæµ‹è¯•ï¼š20 ä¸ªçº¿ç¨‹åŒæ—¶å‘èµ·è¯·æ±‚ï¼Œå½“ QPS é…ç½®ä¸º 10 æ—¶ï¼Œéƒ¨åˆ†è¯·æ±‚å°†å› é™æµè€Œå¤±è´¥ã€‚

![](https://www.youlai.tech/storage/blog/image-20250114173151013.png)

éƒ¨åˆ†å¤±è´¥çš„è¯·æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼š  
![](https://www.youlai.tech/storage/blog/image-20250114173526680.png)

é¡¹ç›®æ‰©å±•
----

### å¤šæ•°æ®æºæ”¯æŒ

éšç€ä¸šåŠ¡çš„å¤æ‚æ€§å¢åŠ ï¼Œå•ä¸€æ•°æ®æºå¯èƒ½æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œä¾‹å¦‚è¯»å†™åˆ†ç¦»ã€å¤šç§Ÿæˆ·ç‹¬ç«‹æ•°æ®åº“æˆ–ç‹¬ç«‹ Schema æ¨¡å¼ç­‰ã€‚æœ¬èŠ‚ä»‹ç»å¦‚ä½•åŸºäº [youlai-boot](https://gitee.com/youlaiorg/youlai-boot) ä½¿ç”¨ `dynamic-datasource` è½»æ¾å®ç°å¤šæ•°æ®æºæ”¯æŒã€‚è¯¦ç»†å†…å®¹è¯·å‚è€ƒï¼š[Spring Boot3 å¤šæ•°æ®æº](https://youlai.blog.csdn.net/article/details/134888348)ã€‚[https://youlai.blog.csdn.net/article/details/134888348](https://youlai.blog.csdn.net/article/details/134888348))

#### æ·»åŠ ä¾èµ–

åœ¨ `pom.xml` ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š

    <dependency>
        <groupId>com.baomidou</groupId>
        <artifactId>dynamic-datasource-spring-boot3-starter</artifactId>
        <version>4.3.1</version>
    </dependency>
    
    

#### é…ç½®å¤šæ•°æ®æº

ä¿®æ”¹ `application-dev.yml` æ–‡ä»¶ï¼Œé…ç½®ä¸»åº“å’Œä»åº“çš„æ•°æ®æºï¼š

    spring:
      datasource:
        dynamic:
          primary: master # è®¾ç½®é»˜è®¤æ•°æ®æº
          strict: false # æ•°æ®æºæ‰¾ä¸åˆ°æ—¶æ˜¯å¦æŠ›å‡ºå¼‚å¸¸
          datasource:
            master: # ä¸»åº“
              type: com.alibaba.druid.pool.DruidDataSource
              url: jdbc:mysql://localhost:3306/youlai_boot?zeroDateTimeBehavior=convertToNull&useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai&autoReconnect=true&allowMultiQueries=true
              username: root
              password: 123456
            slave: # ä»åº“
              type: com.alibaba.druid.pool.DruidDataSource
              url: jdbc:mysql://localhost:3306/youlai_boot_salve?zeroDateTimeBehavior=convertToNull&useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai&autoReconnect=true&allowMultiQueries=true
              username: root
              password: 123456
    
    

#### å¤šæ•°æ®æºæµ‹è¯•

ç¤ºä¾‹ä»£ç ï¼š

*   **Mapper å±‚**ï¼šé€šè¿‡æ³¨è§£ `@DS` æŒ‡å®šä½¿ç”¨çš„æ•°æ®æºã€‚

    /**
     * ä¸»åº“æŸ¥è¯¢
     */
    @DS("master")
    @Select("select * from sys_user where id = #{userId}")
    SysUser getUserFromMaster(Long userId);
    
    /**
     * ä»åº“æŸ¥è¯¢
     */
    @DS("slave")
    @Select("select * from sys_user where id = #{userId}")
    SysUser getUserFromSlave(Long userId);
    
    

*   **å•å…ƒæµ‹è¯•ç±»**ï¼š

    @SpringBootTest
    @Slf4j
    class SysUserMapperTest {
    
        @Autowired
        private SysUserMapper userMapper;
    
        private final Long userId = 1L;
    
        @Test
        void testSwitchDataSourceByAnnotation() {
            SysUser masterUser = userMapper.getUserFromMaster(userId);
            log.info("ç”¨æˆ·IDï¼š{} ä¸»åº“å§“åï¼š{}", userId, masterUser.getNickname());
            SysUser slaveUser = userMapper.getUserFromSlave(userId);
            log.info("ç”¨æˆ·IDï¼š{} ä»åº“å§“åï¼š{}", userId, slaveUser.getNickname());
        }
    }
    
    

æµ‹è¯•ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/1e2e563aa0810deb65258404c94d0a37.png)

### ç™»å½•æ–¹å¼æ‰©å±•

ä»¥ä¸‹å°†ä»¥çŸ­ä¿¡éªŒè¯ç ç™»å½•è¿™ä¸ªå¸¸è§åœºæ™¯ä¸ºä¾‹ï¼Œè¯¦ç»†è¯´æ˜å¦‚ä½•æ‰©å±• Spring Security çš„è®¤è¯æœºåˆ¶ã€‚

#### è‡ªå®šä¹‰è®¤è¯ Token

`SmsAuthenticationToken` ç»§æ‰¿è‡ª `AbstractAuthenticationToken`ï¼Œé€šè¿‡ç­–ç•¥æ¨¡å¼ç”± `AuthenticationManager` æ ¹æ®è¯¥ token ç±»å‹åŒ¹é…ç›¸åº”çš„ Provider è¿›è¡Œè®¤è¯ï¼Œå…¶ä¸­ Provider è´Ÿè´£å…·ä½“çš„éªŒè¯é€»è¾‘ã€‚

    /**
     * çŸ­ä¿¡éªŒè¯ç è®¤è¯ Token
     *
     * @author youlai
     */
    public class SmsAuthenticationToken extends AbstractAuthenticationToken {
        @Serial
        private static final long serialVersionUID = 621L;
    
        /**
         * è®¤è¯ä¿¡æ¯ (æ‰‹æœºå·)
         */
        private final Object principal;
    
        /**
         * å‡­è¯ä¿¡æ¯ (çŸ­ä¿¡éªŒè¯ç )
         */
        private final Object credentials;
    
        /**
         * çŸ­ä¿¡éªŒè¯ç è®¤è¯ Token (æœªè®¤è¯)
         *
         * @param principal å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯
         */
        public SmsAuthenticationToken(Object principal, Object credentials) {
            super(null);
            this.principal = principal;
            this.credentials = credentials;
            this.setAuthenticated(false);
        }
    
        /**
         * çŸ­ä¿¡éªŒè¯ç è®¤è¯ Token (å·²è®¤è¯)
         *
         * @param principal   ç”¨æˆ·ä¿¡æ¯
         * @param authorities æˆæƒä¿¡æ¯
         */
        public SmsAuthenticationToken(Object principal, Collection<? extends GrantedAuthority> authorities) {
            super(authorities);
            this.principal = principal;
            this.credentials = null;
            // è®¤è¯é€šè¿‡
            super.setAuthenticated(true);
        }
    
    
        /**
         * è®¤è¯é€šè¿‡
         *
         * @param principal   ç”¨æˆ·ä¿¡æ¯
         * @param authorities æˆæƒä¿¡æ¯
         * @return SmsAuthenticationToken
         */
        public static SmsAuthenticationToken authenticated(Object principal, Collection<? extends GrantedAuthority> authorities) {
            return new SmsAuthenticationToken(principal, authorities);
        }
    
        @Override
        public Object getCredentials() {
            return this.credentials;
        }
    
        @Override
        public Object getPrincipal() {
            return this.principal;
        }
    }
    
    

#### è‡ªå®šä¹‰è®¤è¯ Provider

Provider çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰§è¡ŒéªŒè¯é€»è¾‘ã€‚åœ¨çŸ­ä¿¡éªŒè¯ç ç™»å½•ä¸­ï¼Œæ ¸å¿ƒä»»åŠ¡æ˜¯æ ¡éªŒéªŒè¯ç æ˜¯å¦æ­£ç¡®ã€‚`SmsAuthenticationProvider` ä¸“é—¨è´Ÿè´£å¤„ç†çŸ­ä¿¡éªŒè¯ç çš„æ ¡éªŒé€»è¾‘ï¼Œç¡®ä¿ç™»å½•æµç¨‹çš„å®‰å…¨æ€§å’Œå‡†ç¡®æ€§ã€‚

    /**
     * çŸ­ä¿¡éªŒè¯ç è®¤è¯ Provider
     *
     * @author youlai
     */
    @Slf4j
    public class SmsAuthenticationProvider implements AuthenticationProvider {
    
        private final UserService userService;
    
        private final RedisTemplate<String, Object> redisTemplate;
    
    
        public SmsAuthenticationProvider(UserService userService, RedisTemplate<String, Object> redisTemplate) {
            this.userService = userService;
            this.redisTemplate = redisTemplate;
        }
    
        /**
         * çŸ­ä¿¡éªŒè¯ç è®¤è¯é€»è¾‘ï¼Œå‚è€ƒ Spring Security è®¤è¯å¯†ç æ ¡éªŒæµç¨‹
         *
         * @param authentication è®¤è¯å¯¹è±¡
         * @return è®¤è¯åçš„ Authentication å¯¹è±¡
         * @throws AuthenticationException è®¤è¯å¼‚å¸¸
         * @see org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider#authenticate(Authentication)
         */
        @Override
        public Authentication authenticate(Authentication authentication) throws AuthenticationException {
            String mobile = (String) authentication.getPrincipal();
            String inputVerifyCode = (String) authentication.getCredentials();
    
            // æ ¹æ®æ‰‹æœºå·è·å–ç”¨æˆ·ä¿¡æ¯
            UserAuthInfo userAuthInfo = userService.getUserAuthInfoByMobile(mobile);
    
            if (userAuthInfo == null) {
                throw new UsernameNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
            }
    
            // æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦æœ‰æ•ˆ
            if (ObjectUtil.notEqual(userAuthInfo.getStatus(), 1)) {
                throw new DisabledException("ç”¨æˆ·å·²è¢«ç¦ç”¨");
            }
    
            // æ ¡éªŒå‘é€çŸ­ä¿¡éªŒè¯ç çš„æ‰‹æœºå·æ˜¯å¦ä¸å½“å‰ç™»å½•ç”¨æˆ·ä¸€è‡´
            String cachedVerifyCode = (String) redisTemplate.opsForValue().get(RedisConstants.SMS_LOGIN_CODE_PREFIX + mobile);
    
            if (!StrUtil.equals(inputVerifyCode, cachedVerifyCode)) {
                throw new BadCredentialsException("éªŒè¯ç é”™è¯¯");
            } else {
                // éªŒè¯æˆåŠŸååˆ é™¤éªŒè¯ç 
                redisTemplate.delete(RedisConstants.SMS_LOGIN_CODE_PREFIX + mobile);
            }
    
            // æ„å»ºè®¤è¯åçš„ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯
            SysUserDetails userDetails = new SysUserDetails(userAuthInfo);
    
            // åˆ›å»ºå·²è®¤è¯çš„ SmsAuthenticationToken
            return SmsAuthenticationToken.authenticated(
                    userDetails,
                    userDetails.getAuthorities()
            );
        }
    
        @Override
        public boolean supports(Class<?> authentication) {
            return SmsAuthenticationToken.class.isAssignableFrom(authentication);
        }
    }
    

#### Spring Security é…ç½®

åœ¨ `SecurityConfig` ä¸­æ³¨å†Œè‡ªå®šä¹‰çš„ `SmsAuthenticationProvider`ï¼Œå®ç°çŸ­ä¿¡éªŒè¯ç ç™»å½•è®¤è¯é€»è¾‘ï¼š

    /**
     * Spring Security é…ç½®ç±»
     *
     * @author youlai
     */
    @Configuration
    @EnableWebSecurity
    @EnableMethodSecurity
    @RequiredArgsConstructor
    public class SecurityConfig {
    
        private final RedisTemplate<String, Object> redisTemplate;
        private final UserService userService;
        
        // ....
        
        /**
         * é»˜è®¤è´¦å·å¯†ç è®¤è¯çš„ Provider
         */
        @Bean
        public DaoAuthenticationProvider daoAuthenticationProvider() {
            DaoAuthenticationProvider daoAuthenticationProvider = new DaoAuthenticationProvider();
            daoAuthenticationProvider.setPasswordEncoder(passwordEncoder);
            daoAuthenticationProvider.setUserDetailsService(userDetailsService);
            return daoAuthenticationProvider;
        }
    
        /**
         * çŸ­ä¿¡éªŒè¯ç è®¤è¯ Provider
         */
        @Bean
        public SmsAuthenticationProvider smsAuthenticationProvider() {
            return new SmsAuthenticationProvider(userService, redisTemplate);
        }
    
        /**
         * è®¤è¯ç®¡ç†å™¨
         */
        @Bean
        public AuthenticationManager authenticationManager(
                DaoAuthenticationProvider daoAuthenticationProvider,
                SmsAuthenticationProvider smsAuthenticationProvider
        ) {
            return new ProviderManager(
                    daoAuthenticationProvider,
                    smsAuthenticationProvider
            );
        }
    }
    
    

#### å‘é€éªŒè¯ç 

**æ§åˆ¶å±‚å®ç°**

    @Operation(summary = "å‘é€ç™»å½•çŸ­ä¿¡éªŒè¯ç ")
    @PostMapping("/login/sms/code")
    public Result<?> sendLoginVerifyCode(
            @Parameter(description = "æ‰‹æœºå·", example = "18812345678") @RequestParam String mobile
    ) {
        authService.sendSmsLoginCode(mobile);
        return Result.success();
    }
    

**æœåŠ¡å±‚å®ç°**

    @Service
    @RequiredArgsConstructor
    @Slf4j
    public class AuthServiceImpl implements AuthService {
    	
        private final SmsService smsService;
        private final RedisTemplate<String, Object> redisTemplate;
    	
    	/**
         * å‘é€ç™»å½•çŸ­ä¿¡éªŒè¯ç 
         *
         * @param mobile æ‰‹æœºå·
         */
        @Override
        public void sendSmsLoginCode(String mobile) {
    
            // éšæœºç”Ÿæˆ4ä½éªŒè¯ç 
            // String code = String.valueOf((int) ((Math.random() * 9 + 1) * 1000));
            // TODO ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼ŒéªŒè¯ç å›ºå®šä¸º 1234ï¼Œå®é™…å¼€å‘ä¸­åœ¨é…ç½®äº†å‚å•†çŸ­ä¿¡æœåŠ¡åï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„éšæœºéªŒè¯ç 
            String code = "1234";
    
            // å‘é€çŸ­ä¿¡éªŒè¯ç 
            Map<String, String> templateParams = new HashMap<>();
            templateParams.put("code", code);
            try {
                smsService.sendSms(mobile, SmsTypeEnum.LOGIN, templateParams);
            } catch (Exception e) {
                log.error("å‘é€çŸ­ä¿¡éªŒè¯ç å¤±è´¥", e);
            }
            // ç¼“å­˜éªŒè¯ç è‡³Redisï¼Œç”¨äºç™»å½•æ ¡éªŒ
            redisTemplate.opsForValue().set(RedisConstants.SMS_LOGIN_CODE_PREFIX + mobile, code, 5, TimeUnit.MINUTES);
        }
    }
    

#### ç™»å½•æ¥å£

**æ§åˆ¶å±‚å®ç°**

    /**
     * è®¤è¯æ§åˆ¶å±‚
     *
     * @author youlai
     */
    @RestController
    @RequestMapping("/api/v1/auth")
    @RequiredArgsConstructor
    public class AuthController {
    
        private final AuthService authService;
    
        // ...
        
        @Operation(summary = "çŸ­ä¿¡éªŒè¯ç ç™»å½•")
        @PostMapping("/login/sms")
        @Log(value = "çŸ­ä¿¡éªŒè¯ç ç™»å½•", module = LogModuleEnum.LOGIN)
        public Result<AuthenticationToken> loginBySms(
                @Parameter(description = "æ‰‹æœºå·", example = "18812345678") @RequestParam String mobile,
                @Parameter(description = "éªŒè¯ç ", example = "1234") @RequestParam String code
        ) {
            AuthenticationToken loginResult = authService.loginBySms(mobile, code);
            return Result.success(loginResult);
        }
    }
    
    

**æœåŠ¡å±‚å®ç°**

    /**
     * è®¤è¯æœåŠ¡å®ç°ç±»
     *
     * @author youlai
     */
    @Service
    @RequiredArgsConstructor
    @Slf4j
    public class AuthServiceImpl implements AuthService {
    	
        private final SmsService smsService;
        private final RedisTemplate<String, Object> redisTemplate;
    	
        /**
         * çŸ­ä¿¡éªŒè¯ç ç™»å½•
         *
         * @param mobile æ‰‹æœºå·
         * @param code   éªŒè¯ç 
         * @return è®¿é—®ä»¤ç‰Œ
         */
        @Override
        public AuthenticationToken loginBySms(String mobile, String code) {
            // 1. åˆ›å»ºç”¨æˆ·çŸ­ä¿¡éªŒè¯ç è®¤è¯çš„ä»¤ç‰Œï¼ˆæœªè®¤è¯ï¼‰
            SmsAuthenticationToken smsAuthenticationToken = new SmsAuthenticationToken(mobile, code);
    
            // 2. æ‰§è¡Œè®¤è¯ï¼ˆè®¤è¯ä¸­ï¼‰
            Authentication authentication = authenticationManager.authenticate(smsAuthenticationToken);
    
            // 3. è®¤è¯æˆåŠŸåç”Ÿæˆ JWT ä»¤ç‰Œï¼Œå¹¶å­˜å…¥ Security ä¸Šä¸‹æ–‡ï¼Œä¾›ç™»å½•æ—¥å¿— AOP ä½¿ç”¨ï¼ˆå·²è®¤è¯ï¼‰
            AuthenticationToken authenticationToken = tokenManager.generateToken(authentication);
            SecurityContextHolder.getContext().setAuthentication(authentication);
    
            return authenticationToken;
        }
    
    }
    

#### æ¥å£æµ‹è¯•

è®¿é—®æ¥å£æ–‡æ¡£ [http://localhost:8989/doc.htmlï¼Œè°ƒç”¨å‘é€çŸ­ä¿¡éªŒè¯ç æ¥å£ï¼Œè¾“å…¥æ‰‹æœºå·ã€‚](http://localhost:8989/doc.html%EF%BC%8C%E8%B0%83%E7%94%A8%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81%E7%A0%81%E6%8E%A5%E5%8F%A3%EF%BC%8C%E8%BE%93%E5%85%A5%E6%89%8B%E6%9C%BA%E5%8F%B7%E3%80%82)

![](https://www.youlai.tech/storage/blog/2025/01/13/image-20250113233419129.png)

æ¨¡æ‹Ÿæ¥æ”¶çŸ­ä¿¡éªŒè¯ç ï¼ˆå›ºå®šä¸º `1234`ï¼‰ï¼Œè°ƒç”¨çŸ­ä¿¡éªŒè¯ç ç™»å½•æ¥å£ï¼Œè¾“å…¥æ‰‹æœºå·å’ŒéªŒè¯ç å³å¯æˆåŠŸç™»å½•å¹¶è¿”å›è®¿é—®ä»¤ç‰Œã€‚

![](https://www.youlai.tech/storage/blog/2025/01/13/image-20250113233616340.png)

é¡¹ç›®éƒ¨ç½²
----

### å®‰è£…è™šæ‹Ÿæœº

å¦‚æœæ²¡æœ‰äº‘æœåŠ¡å™¨ï¼Œå¯åœ¨æœ¬åœ°å®‰è£…è™šæ‹Ÿæœºï¼Œå‚è€ƒï¼š[VMware æ­å»º Linux è™šæ‹Ÿæœºç¯å¢ƒ (CentOS 7.9)](https://juejin.cn/post/7250009145915719740)ã€‚

å®‰è£…å¹¶å¯åŠ¨ FinalShell: [ä¸‹è½½åœ°å€](https://www.hostbuf.com/t/988.html)ã€‚æ–°å»ºè¿æ¥ï¼Œè¿æ¥åˆ°å·²å®‰è£…çš„è™šæ‹Ÿæœºã€‚

![](https://www.youlai.tech/storage/blog/image-20250103180057674.png)

### å®‰è£… Docker

å‚è€ƒæ–‡æ¡£ï¼š[Linux (CentOS) å®‰è£… Docker å’Œ Docker Compose](https://youlai.blog.csdn.net/article/details/145055134)ã€‚

### å®‰è£…ä¸­é—´ä»¶

#### ä¸Šä¼ è„šæœ¬

å°†é¡¹ç›®çš„ `docker` å’Œ `sql` ç›®å½•å¤åˆ¶åˆ°æœåŠ¡å™¨çš„ `/opt` ç›®å½•ä¸‹ï¼š

![](https://www.youlai.tech/storage/blog/image-20250105010107314.png)

æˆäºˆæ‰§è¡Œæƒé™

    sudo chmod +x /opt/docker/docker-compose.yml
    

#### å¯åŠ¨æœåŠ¡

åˆ‡æ¢åˆ° `/opt/docker` ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å®¹å™¨ï¼š

    cd  /opt/docker
    # å¯åŠ¨æœåŠ¡
    docker-compose up -d
    

ç­‰å¾…ç‰‡åˆ»ï¼Œå®¹å™¨å¯åŠ¨å®Œæˆåå¦‚ä¸‹ï¼š

![](https://www.youlai.tech/storage/blog/image-20250105182838794.png)

#### éªŒè¯å®‰è£…

\*\*MySQL \*\*

å¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ï¼š

![](https://www.youlai.tech/storage/blog/image-20250105184229895.png)

**Redis**

Redis å¯åŠ¨æ­£å¸¸ï¼š

![](https://www.youlai.tech/storage/blog/image-20250105220506851.png)

MinIO

æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://192.168.179.21:9090](http://192.168.179.21:9090)ï¼ˆæ ¹æ®å®é™… IP ä¿®æ”¹ï¼‰ï¼Œä½¿ç”¨é»˜è®¤ç”¨æˆ·åå¯†ç  `minioadmin/minioadmin` ç™»å½•ã€‚

![](https://www.youlai.tech/storage/blog/image-20250105231649894.png)

**XXL-JOB**

æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://192.168.179.21:8080/xxl-job-adminï¼ˆæ ¹æ®å®é™…](http://192.168.179.21:8080/xxl-job-admin%EF%BC%88%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85) IP ä¿®æ”¹ï¼‰ï¼Œè¾“å…¥é»˜è®¤ç”¨æˆ·åå¯†ç  `admin/123456` ç™»å½•ã€‚

![](https://www.youlai.tech/storage/blog/image-20250105232254574.png)

### éƒ¨ç½²åº”ç”¨

#### å®‰è£…æ’ä»¶

åœ¨ IDEA èœå•æ é€‰æ‹© `File â†’ Settings â†’ Plugins`ï¼Œæœç´¢ `Docker` æ’ä»¶å¹¶å®‰è£…ï¼Œå®‰è£…åé‡å¯ IDEAã€‚

![](https://www.youlai.tech/storage/blog/image-20250106004610271.png)

#### é…ç½®æœåŠ¡å™¨

åœ¨ IDEA èœå•æ é€‰æ‹© `File â†’ Settings â†’ Build, Execution, Deployment â†’ Docker`ï¼Œæ·»åŠ è¿œç¨‹æœåŠ¡å™¨çš„è¿æ¥ä¿¡æ¯ï¼š

![](https://www.youlai.tech/storage/blog/image-20250106112935466.png)

è¿æ¥æˆåŠŸåï¼Œæ˜¾ç¤º `Connection successful`ï¼š

![image-20250106113054626](https://www.youlai.tech/storage/blog/image-20250106113054626.png)

![](https://www.youlai.tech/storage/blog/image-20250106111043701.png)

#### éƒ¨ç½²é…ç½®

åœ¨ IDEA é¡¶éƒ¨èœå•é€‰æ‹© `Edit Configurations` æ‰“å¼€é…ç½®ç•Œé¢ï¼š

![](https://www.youlai.tech/storage/blog/image-20250106113223291.png)

é€‰æ‹© `Dockerfile`ï¼Œè®¾ç½®éƒ¨ç½²ç›¸å…³å‚æ•°ï¼š

![](https://www.youlai.tech/storage/blog/image-20250106113336161.png)

![](https://www.youlai.tech/storage/blog/image-20250106115815350.png)

#### ä¸€é”®éƒ¨ç½²

é…ç½®å®Œæˆåï¼Œé€‰æ‹©å¯¹åº”é…ç½®ç‚¹å‡»å¯åŠ¨ï¼Œå°†è‡ªåŠ¨å®Œæˆç¼–è¯‘ã€æ‰“åŒ…ã€é•œåƒæ„å»ºã€é•œåƒæ¨é€å’Œå®¹å™¨å¯åŠ¨ã€‚![image-20250106124819744](https://www.youlai.tech/storage/blog/image-20250106124819744.png)

![](https://www.youlai.tech/storage/blog/image-20250106134141189.png)

å¯åŠ¨æˆåŠŸåå¦‚ä¸‹ï¼š

![](https://www.youlai.tech/storage/blog/image-20250106134341913.png)

æµè§ˆå™¨è®¿é—® [http://192.168.179.21:8989/doc.html](http://192.168.179.21:8989/doc.html)ï¼ˆæ ¹æ®å®é™… IP ä¿®æ”¹ï¼‰æŸ¥çœ‹æ¥å£æ–‡æ¡£ï¼ŒéªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸã€‚

![](https://www.youlai.tech/storage/blog/image-20250106140027941.png)

ç»“è¯­
--

æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ–‡æ¡£ï¼Œ[youlai-boot](https://gitee.com/youlaiorg/youlai-boot) é¡¹ç›®æä¾›é«˜æ•ˆã€çµæ´»ä¸”å¯æ‰©å±•çš„ä¼ä¸šçº§æƒé™ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚æœ¬æ‰‹å†Œä»åŸºç¡€åˆ°æ‰©å±•ï¼Œä¸ºå¼€å‘è€…æä¾›äº†è¯¦ç»†çš„å‚è€ƒæŒ‡å—ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿæ­å»ºé¡¹ç›®å¹¶åº”å¯¹å¤æ‚ä¸šåŠ¡éœ€æ±‚ã€‚å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿æ·»åŠ å¾®ä¿¡ï¼ˆå¾®ä¿¡å·ï¼šhaoxianruiï¼‰äº¤æµæˆ–è®¿é—®å¼€æºé¡¹ç›®ï¼š[https://gitee.com/youlaiorg](https://gitee.com/youlaiorg)ã€‚