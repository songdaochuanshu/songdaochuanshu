---
layout: post
title: 'Javaç¨‹åºå‘˜çš„Goå…¥é—¨ç¬”è®°'
date: "2025-04-17T00:39:41Z"
---
Javaç¨‹åºå‘˜çš„Goå…¥é—¨ç¬”è®°
==============

[ç³»åˆ—æ–‡ç« ç›®å½•å’Œå…³äºæˆ‘](https://www.cnblogs.com/cuzzz/p/16609728.html)

0.èƒŒæ™¯
====

3å¹´javaå¼€å‘èƒŒæ™¯ï¼ˆå› æ­¤è¿™ç¯‡æ–‡ç« çš„ç‰¹ç‚¹æ˜¯ï¼šæ¯”è¾ƒé€‚åˆjavaç¨‹åºå‘˜dogeï¼‰ï¼Œä¸šä½™æ—¶é—´æœ‰äº†è§£è¿‡ä¸€äº›goï¼Œå¦‚ä»Šä¸»è¦æŠ€æœ¯æ ˆæ˜¯goï¼Œæ­¤ç¯‡ä¸»è¦ç»“åˆ[goè¯­è¨€åœ£ç»](https://www.gopl.io/)å’Œå›¢é˜Ÿå†…goé¡¹ç›®ï¼Œæ€»ç»“ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚

å¦å¤–æ–‡ç« ä¸­æ²¡æœ‰å¯¹ifï¼Œswitch ï¼Œforè¿›è¡Œè¯´æ˜ï¼Œçœ‹å¤šäº†æ–‡ä¸­çš„ä¾‹å­ï¼Œè‡ªç„¶å°±ä¼šè¿™éƒ¨åˆ†äº†

1.ç¨‹åºç»“æ„
======

1.1.å£°æ˜ã€èµ‹å€¼å’Œç±»å‹
------------

Goè¯­è¨€ä¸»è¦æœ‰å››ç§ç±»å‹çš„å£°æ˜è¯­å¥ï¼švarã€constã€typeå’Œfuncï¼Œåˆ†åˆ«å¯¹åº”å˜é‡ã€å¸¸é‡ã€ç±»å‹å’Œå‡½æ•°å®ä½“å¯¹è±¡çš„å£°æ˜

ä»¥ä¸‹æ˜¯ä¸€ä¸ª Go è¯­è¨€ç¨‹åºç»“æ„çš„ä»£ç ç¤ºä¾‹ï¼š

    // ç»“æ„ä½“å£°æ˜
    type MyStruct struct {
        name     string
        age      int8
        sex      bool
        userType UserType
        sub      *MyStruct
        keys     []string
        feature  map[string]any
    }
    
    // ç±»å‹ 
    type UserType int64
    // å¸¸é‡å£°æ˜
    const (
        SUPER UserType = 1
    )
    
    func main() {
    
        // å¸¸é‡å£°æ˜
        const sexBool bool = false
        // å˜é‡
        var userName string
        // å˜é‡èµ‹å€¼
        userName = "username"
    
        //ç®€çŸ­å˜é‡å£°æ˜å¹¶èµ‹å€¼
        userAge := 1
        // mapç±»å‹
        userFeature := make(map[string]any)
        // mapèµ‹å€¼
        userFeature["key"] = "value"
        // æ•°ç»„ç±»å‹
        var keys []string = make([]string, 20)
        //æ•°ç»„ç±»å‹èµ‹å€¼
        keys[0] = "!"
        // ç»“æ„ä½“
        var subStruct = MyStruct{age: 1, userType: 1, sex: false, name: "1"}
        myStruct := MyStruct{age: int8(userAge), userType: SUPER, sex: sexBool, 
        name: userName, feature: userFeature, sub: &subStruct, keys: keys}
        
    }
    

1.2.åŒ…å’Œæ–‡ä»¶
--------

åŒ…çš„æ¦‚å¿µå’Œjavaä¸­çš„åŒ…ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å¯¼å…¥åŒ…è·¯å¾„ä½¿ç”¨çš„æ˜¯â€œ/â€è¿›è¡Œåˆ†å‰²

    package main
    
    import (
        "errors"
        "fmt"
    )
    import "code.byted.org/life_service/chenxinglandingdemo/compare" // å¯¼å…¥è‡ªå®šä¹‰çš„åŒ…
    

è¯¥åŒ…ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶int\_comparator.goï¼Œå®šä¹‰äº†ä¸€ä¸ªCompareå‡½æ•°

    type IntPriority interface {
        GetPriority() int
    }
    
    func Compare(first IntPriority, second IntPriority) (int, error) {
        if first == nil || second == nil {
           return 0, errors.New("null input")
        }
        firstPriority := first.GetPriority()
        secondPriority := second.GetPriority()
        if firstPriority == secondPriority {
           return 0, nil
        }
        if firstPriority > secondPriority {
           return 1, nil
        }
        return -1, nil
    }
    

å¼•å…¥åŒ…åçš„ä½¿ç”¨ä¾‹å­

    compare.Compare(&myStruct, &subStruct)
    

å…¶ä¸­å¤§å†™å¼€å¤´çš„æ–¹æ³•æ‰è¢«è§†ä¸ºæ˜¯publicçš„ï¼Œè¿™ç‚¹ä¸€å¼€å§‹è®©æˆ‘è§‰å¾—æœ‰ç‚¹è‰ç‡ï¼Œä½†æ˜¯ä¼¼ä¹ç¡®å®æ¯”javaçš„privateï¼Œprotectedï¼Œpublicç”¨èµ·æ¥æ›´çˆ½ä¸€ç‚¹

ä½¿ç”¨initæ–¹æ³•å¯ä»¥å¯¹åŒ…æ–‡ä»¶çš„åˆå§‹åŒ–ï¼Œæœ‰ç‚¹ç±»ä¼¼javaç±»ä¸­çš„staticé™æ€ä»£ç å—ï¼Œä½†æ˜¯æ— è®ºè¯¥æ–‡ä»¶æ˜¯å¦è¢«ä½¿ç”¨ï¼Œéƒ½ä¼šæ‰§è¡Œinitï¼Œä¸åƒjavaåªæœ‰ä½¿ç”¨åˆ°è¿™ä¸ªç±»æ‰§è¡Œç±»çš„åˆå§‹åŒ–åæ‰ä¼šæ‰§è¡Œstatic

    package compare
    
    import "fmt"
    
    func init() {
        fmt.Println("init_method_learn.go")
    }
    

initæ–¹æ³•çš„æ‰§è¡Œæ˜¯ä¾èµ–æ–‡ä»¶åç§°é¡ºåºçš„ï¼Œå› æ­¤å¦‚æœAæ–‡ä»¶ä½¿ç”¨Bæ–‡ä»¶ä¸­çš„æ–¹æ³•æ˜¯ï¼Œä¹Ÿè®¸Bæ–‡ä»¶è¿˜æ²¡æœ‰è°ƒç”¨init

2.åŸºæœ¬æ•°æ®ç±»å‹
========

2.1 æ•´å½¢
------

Goè¯­è¨€åŒæ—¶æä¾›äº†æœ‰ç¬¦å·å’Œæ— ç¬¦å·ç±»å‹çš„æ•´æ•°è¿ç®—ã€‚è¿™é‡Œæœ‰int8ã€int16ã€int32å’Œint64å››ç§æˆªç„¶ä¸åŒå¤§å°çš„æœ‰ç¬¦å·æ•´æ•°ç±»å‹ï¼Œåˆ†åˆ«å¯¹åº”8ã€16ã€32ã€64bitå¤§å°çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä¸æ­¤å¯¹åº”çš„æ˜¯uint8ã€uint16ã€uint32å’Œuint64å››ç§æ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`int` å’Œ `uint` ç±»å‹çš„å¤§å°å–å†³äºæ“ä½œç³»ç»Ÿçš„ä½æ•°ã€‚åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œ`int` å’Œ `uint` ç±»å‹çš„å¤§å°é€šå¸¸ä¸º4å­—èŠ‚ï¼ˆ32ä½ï¼‰ï¼›åœ¨64ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå®ƒä»¬çš„å¤§å°é€šå¸¸ä¸º8å­—èŠ‚ï¼ˆ64ä½ï¼‰ã€‚æˆ‘çœ‹æˆ‘ä»¬ç³»ç»Ÿä¸­ä¸€èˆ¬æ˜¯æ²¡æœ‰ç›´æ¥ä½¿ç”¨intå’Œunitçš„ã€‚

2.2 æµ®ç‚¹æ•°
-------

Goè¯­è¨€æä¾›äº†ä¸¤ç§ç²¾åº¦çš„æµ®ç‚¹æ•°ï¼Œfloat32å’Œfloat64ã€‚å®ƒä»¬çš„ç®—æœ¯è§„èŒƒç”±IEEE754æµ®ç‚¹æ•°å›½é™…æ ‡å‡†å®šä¹‰ï¼Œè¯¥æµ®ç‚¹æ•°è§„èŒƒè¢«æ‰€æœ‰ç°ä»£çš„CPUæ”¯æŒã€‚

å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œfloat32å’Œfloat64éƒ½æœ‰ä¸€å®šç²¾åº¦è¯¯å·®

    var f float32 = 16777216
    // true
    fmt.Println(f+1 == f)
    
    var f64 float64 = 16777216
    // true
    fmt.Println(f64+0.000000000000001 == f64)
    

åœ¨ IEEE 754 æ ‡å‡†ä¸­ï¼Œfloat32 ç±»å‹çš„æµ®ç‚¹æ•°ä½¿ç”¨ 32 ä½æ¥å­˜å‚¨ï¼Œå…¶ä¸­åŒ…æ‹¬ 1 ä½ç¬¦å·ä½ï¼ˆSï¼‰ã€8 ä½æŒ‡æ•°ä½ï¼ˆEï¼‰å’Œ 23 ä½å°¾æ•°ä½ï¼ˆMï¼‰ã€‚å¯¹äºæ•°å­— 16777216ï¼Œå°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºä¸º 1000000000000000000000000ã€‚å°†å…¶è½¬æ¢ä¸º IEEE 754 æ ¼å¼çš„ float32 ç±»å‹ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¬¦å·ä½ S**ï¼š16777216 æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥ç¬¦å·ä½ S ä¸º 0ã€‚
2.  **æŒ‡æ•°ä½ E**ï¼šå°†äºŒè¿›åˆ¶æ•° 1000000000000000000000000 å³ç§» 23 ä½ï¼Œå¾—åˆ°æŒ‡æ•°ä¸º 24ã€‚ç”±äºæŒ‡æ•°ä½çš„åç§»é‡ä¸º 127ï¼Œæ‰€ä»¥å®é™…çš„æŒ‡æ•°å€¼ä¸º 24 - 127 = -103ã€‚
3.  **å°¾æ•°ä½ M**ï¼šå–äºŒè¿›åˆ¶æ•° 1000000000000000000000000 çš„å 23 ä½ï¼Œå³ 00000000000000000000000ï¼Œçœç•¥æ‰å¼€å¤´çš„ 1ã€‚

å› æ­¤ï¼Œ16777216 åœ¨ IEEE 754 å­˜å‚¨ä¸­çš„è¡¨ç¤ºä¸ºï¼š0 10000001 00000000000000000000000ã€‚

å¯¹äºæ•°å­— 16777217ï¼ŒæŒ‰ç…§åŒæ ·çš„æ­¥éª¤è½¬æ¢ä¸º IEEE 754 æ ¼å¼çš„ float32 ç±»å‹ï¼š

1.  **ç¬¦å·ä½ S**ï¼š16777217 æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥ç¬¦å·ä½ S ä¸º 0ã€‚
2.  **æŒ‡æ•°ä½ E**ï¼šå°†äºŒè¿›åˆ¶æ•° 1000000000000000000000001 å³ç§» 23 ä½ï¼Œå¾—åˆ°æŒ‡æ•°ä¸º 24ã€‚ç”±äºæŒ‡æ•°ä½çš„åç§»é‡ä¸º 127ï¼Œæ‰€ä»¥å®é™…çš„æŒ‡æ•°å€¼ä¸º 24 - 127 = -103ã€‚
3.  **å°¾æ•°ä½ M**ï¼šå–äºŒè¿›åˆ¶æ•° 1000000000000000000000001 çš„å 23 ä½ï¼Œå³ 000000000000000000000001ï¼Œçœç•¥æ‰å¼€å¤´çš„ 1ã€‚

æ‰€ä»¥ï¼Œ16777217 åœ¨ IEEE 754 å­˜å‚¨ä¸­çš„è¡¨ç¤ºä¹Ÿæ˜¯ï¼š0 10000001 00000000000000000000000ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ 16777216 å’Œ 16777217 åœ¨ IEEE 754 å­˜å‚¨ä¸­çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„åŸå› ï¼Œå®ƒä»¬çš„å°¾æ•°ä½ç›¸åŒï¼Œè€ŒæŒ‡æ•°ä½ä¹Ÿç›¸åŒï¼Œåªæ˜¯åœ¨è½¬æ¢ä¸ºåè¿›åˆ¶æ—¶ï¼Œç”±äºç²¾åº¦é™åˆ¶ï¼Œä¼šå‡ºç°èˆå…¥è¯¯å·®ï¼Œå¯¼è‡´ç»“æœç•¥æœ‰ä¸åŒã€‚

å’Œjavaä¸€æ ·goä¹Ÿæä¾›bigæ¥è§£å†³è¿™ä¸ªé—®é¢˜

    // ä½¿ç”¨ math/big åŒ…è¿›è¡Œé«˜ç²¾åº¦è®¡ç®—
    a := new(big.Float).SetPrec(128).SetFloat64(0.000000000000001)
    b := new(big.Float).SetPrec(128).SetFloat64(16777216)
    c := new(big.Float).Add(a, b)
    
    // è¾“å‡º1ï¼Œè¡¨ç¤ºcå¤§äºbï¼Œç¬¦åˆé¢„æœŸ
    fmt.Println(c.Cmp(b))
    

2.3 bool å¸ƒå°”
-----------

ç±»ä¼¼äºjavaä¸­çš„booleanï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œå¸ƒå°”å‹æ•°æ®åªæœ‰`true`å’Œ`false`ä¸¤ä¸ªå€¼ï¼Œæ²¡æœ‰åƒ Java ä¸­é‚£æ ·çš„`Boolean`ç±»å‹ã€‚

2.4 å­—ç¬¦ä¸²
-------

    func main() {
    
        str := "testStræµ‹è¯•å­—ç¬¦ä¸²"
    
        // è¾“å‡º22 ===>7+15(æ±‰å­3ä¸ªå­—ç¬¦)
        fmt.Println(len(str))
        // è¾“å‡º116 utf8ç¼–ç 
        var u uint8 = str[0]
        fmt.Println(u)
        // è¾“å‡º116 utf8ç¼–ç 
        fmt.Println(str[0])
    
        // testStr
        fmt.Println(str[0:7])
        // testStr
        fmt.Println(str[:7])
        //æµ‹è¯•å­—ç¬¦ä¸²
        fmt.Println(str[7:])
        // æµ‹è¯•å­—ç¬¦ä¸²
        fmt.Println(str[7:len(str)])
        
        // å­—ç¬¦ä¸²å¾ªç¯
        for i := range str {
           fmt.Println(string(str[i]))
        }
        
    }
    

å¦‚ä¸Šæ˜¯å­—ç¬¦ä¸²å¸¸ç”¨çš„ä¸€äº›æ“ä½œï¼Œgoä¸­çš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸å¯å˜çš„

è®©æˆ‘æ¯”è¾ƒè¿·æƒ‘çš„æ˜¯str\[7:\]è¿™ç§å­—ç¬¦ä¸²çš„æ“ä½œä¼¼ä¹æ˜¯æ·±æ‹·è´ï¼Œä½†æ˜¯æœ‰ä¸€äº›æ–‡æ¡£ä¹Ÿè¯´æ˜¯æµ…æ‹·è´

3.å¤åˆæ•°æ®ç±»å‹
========

3.1 æ•°ç»„
------

    // å£°æ˜ï¼Œç„¶åèµ‹å€¼
    ints := [10]int{}
    ints[1] = 1
    // å£°æ˜å¹¶èµ‹å€¼ï¼Œæ²¡æœ‰èµ‹å€¼çš„indexä½¿ç”¨åˆå€¼0
    var ints2 [20]int = [20]int{1, 2, 3, 4, 5}
    fmt.Println(ints2[19])
    fmt.Println(len(ints2))
    
    // æ ¹æ®å…ƒç´ çš„ä¸ªæ•°æ¥è‡ªåŠ¨è®¾ç½®é•¿åº¦
    ints3 := [...]int{1, 2, 3, 4, 5}
    fmt.Println(len(ints3))
    
    ints4 := [...]int{99: -1}
    
    // é•¿åº¦ä¸º100 = 99+1
    fmt.Println(len(ints4))
    
    ints5 := [5]int{1, 2, 3, 4, 5}
    // true
    fmt.Println(ints3 == ints5)
    

å…¶ä¸­æˆ‘è§‰å¾—æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯

*   æ•°ç»„çš„æ¯”è¾ƒï¼š

å¦‚æœä¸€ä¸ªæ•°ç»„çš„å…ƒç´ ç±»å‹æ˜¯å¯ä»¥ç›¸äº’æ¯”è¾ƒçš„ï¼Œé‚£ä¹ˆæ•°ç»„ç±»å‹ä¹Ÿæ˜¯å¯ä»¥ç›¸äº’æ¯”è¾ƒçš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡==æ¯”è¾ƒè¿ç®—ç¬¦æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„ï¼Œåªæœ‰å½“ä¸¤ä¸ªæ•°ç»„çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ç›¸ç­‰çš„æ—¶å€™æ•°ç»„æ‰æ˜¯ç›¸ç­‰çš„ã€‚ä¸ç›¸ç­‰æ¯”è¾ƒè¿ç®—ç¬¦!=éµå¾ªåŒæ ·çš„è§„åˆ™ã€‚

*   æ•°ç»„ç±»å‹

\[5\]intå’Œ\[20\]intæ˜¯ä¸åŒçš„ç±»å‹

å› æ­¤ä¸¤ä¸ªä¸å¤ªç±»å‹çš„æ•°ç»„æ˜¯ä¸å¯ä»¥æ¯”è¾ƒçš„

![](https://img2024.cnblogs.com/blog/2605549/202504/2605549-20250416210358074-660528300.png)

ä»¥åŠä¹Ÿä¸èƒ½æŠŠ\[5\]intç±»å‹çš„å˜é‡ä½¿ç”¨=èµ‹å€¼ä¸€ä¸ª\[20\]int ç±»å‹çš„å˜é‡

![](https://img2024.cnblogs.com/blog/2605549/202504/2605549-20250416210405985-264269771.png)

*   æ•°ç»„ä½œä¸ºå‚æ•°
    *   æ•°ç»„ä½œä¸ºå‚æ•°æ˜¯å€¼ä¼ é€’ï¼Œè¿™æ„å‘³ç€ä¸‹é¢clearArray1æ–¹æ³•æ˜¯æ— æ³•æ¸…ç©ºæ•°ç»„å†…å®¹çš„ï¼Œä½¿ç”¨æŒ‡é’ˆçš„clearArray2æ˜¯å¯ä»¥æ¸…ç©ºçš„ï¼ˆè¿™ä¹Ÿå¯å‘æˆ‘ä»¬ï¼Œæ¯”è¾ƒå ç”¨å†…å­˜çš„å˜é‡åº”è¯¥ä½¿ç”¨æŒ‡é’ˆï¼Œå› ä¸ºæŒ‡é’ˆä½œä¸ºå‚æ•°å€¼æ‹·è´æµªè´¹çš„å†…å­˜å°‘ï¼Œæ‹·è´çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ï¼ï¼‰
        *       func clearArray1(array [5]int) {
                    for i := range array {
                       array[i] = 0
                    }
                }
                
                func clearArray(array *[5]int) {
                    for i := range array {
                       array[i] = 0
                    }
                }
                
            
    *   å› ä¸º\[5\]intå’Œ\[20\]intæ˜¯ä¸å¤ªåŒçš„æ•°ç»„ç±»å‹ï¼Œå› æ­¤ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ï¼Œéƒ½åªèƒ½ç©¿å…¥é•¿åº¦ä¸º5çš„æ•°ç»„ï¼Œè¿™ä¸€ç‚¹è®©æˆ‘è§‰å¾—æœ‰ç‚¹æ¶å¿ƒğŸ¤¢

3.2 Slice åˆ‡ç‰‡
------------

Sliceï¼ˆåˆ‡ç‰‡ï¼‰ä»£è¡¨å˜é•¿çš„åºåˆ—ï¼Œåºåˆ—ä¸­æ¯ä¸ªå…ƒç´ éƒ½æœ‰ç›¸åŒçš„ç±»å‹ã€‚ä¸€ä¸ªsliceç±»å‹ä¸€èˆ¬å†™ä½œ\[\]Tï¼Œå…¶ä¸­Tä»£è¡¨sliceä¸­å…ƒç´ çš„ç±»å‹ï¼›sliceçš„è¯­æ³•å’Œæ•°ç»„å¾ˆåƒï¼Œåªæ˜¯æ²¡æœ‰å›ºå®šé•¿åº¦è€Œå·²ã€‚

æ•°ç»„æ˜¯ä¸€ä¸ªç”±å›ºå®šé•¿åº¦çš„ç‰¹å®šç±»å‹å…ƒç´ ç»„æˆçš„åºåˆ—ï¼Œä¸€ä¸ªæ•°ç»„å¯ä»¥ç”±é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ç»„æˆã€‚å› ä¸ºæ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå› æ­¤åœ¨Goè¯­è¨€ä¸­å¾ˆå°‘ç›´æ¥ä½¿ç”¨æ•°ç»„ã€‚

*   åˆ‡ç‰‡æä¾›äº†è®¿é—®æ•°ç»„å­åºåˆ—ï¼ˆæˆ–è€…å…¨éƒ¨ï¼‰å…ƒç´ çš„åŠŸèƒ½
    *   è¿™ä¸€ç‚¹æœ‰ç‚¹åƒjavaä¸­Listçš„subList
        
    *       months := [...]string{"", "January", "February",
                "March", "April", "May", "June", "July",
                "August", "September", "October",
                "November", "December"}
            // slice å¯ä»¥è®¿é—®æ‰€æœ‰å…ƒç´ ï¼Œä¿®æ”¹months[x:y]ä¸­çš„xyä»è€Œä¿®æ”¹éƒ¨åˆ†å…ƒç´ 
            slice := months[1:13]
            
        
*   sliceçš„åº•å±‚å¼•ç”¨ä¸€ä¸ªæ•°ç»„å¯¹è±¡

è¿™æ„å‘³ç€ä¿®æ”¹åˆ‡ç‰‡å†…å®¹ä¼šå½±å“åˆ°æ•°ç»„åŸæœ¬å†…å®¹ï¼Œè¿™ä¸€ç‚¹ä¹Ÿåƒjavaä¸­ArrayListçš„subListï¼Œå¤šä¸ªåˆ‡ç‰‡ç›´æ¥åˆ°ä¿®æ”¹ä¼šå½±å“åˆ°å¯¹æ–¹ï¼Œå¦‚ä¸‹clearæ–¹æ³•ä¼šå½±å“åˆ°åŸæ•°ç»„å†…å®¹

    fmt.Println(months[1] == "")
    clear(slice)
    // true ä¿®æ”¹åˆ‡ç‰‡ä¼šä¿®æ”¹æ•°ç»„å†…å®¹
    fmt.Println(months[1] == "")
    
    // è¿™é‡Œå‚æ•°æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ç±»å‹
    func clear(array []string) {
        for i := range array {
           array[i] = ""
        }
    }
    func clearArray(array [5]string) {
        for i := range array {
           array[i] = ""
        }
    }
    

è¿˜æœ‰ä¸€ç‚¹æ¯”è¾ƒæœ‰æ„æ€ï¼ŒclearArrayå‚æ•°ç±»å‹æ˜¯æ•°ç»„ï¼Œclearå‚æ•°ç±»å‹æ˜¯åˆ‡ç‰‡ğŸ˜‚

è¿™æ ·çœ‹æ¥æ•°ç»„æœ‰ç‚¹é¸¡è‚‹ï¼Œæ•°ç»„ä¸åŒé•¿åº¦æ˜¯ä¸åŒçš„ç±»å‹ï¼Œç›®å‰æˆ‘æ„Ÿè§‰è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ï¼š

ä¸åŒé•¿åº¦çš„æ•°ç»„åœ¨å†…å­˜ä¸­å ç”¨çš„ç©ºé—´å¤§å°ä¹Ÿä¸åŒã€‚å°†å®ƒä»¬è§†ä¸ºä¸åŒçš„ç±»å‹å¯ä»¥è®©ç¼–è¯‘å™¨æ›´å¥½åœ°è¿›è¡Œå†…å­˜ç®¡ç†å’Œä¼˜åŒ–ï¼Œä¾‹å¦‚åœ¨åˆ†é…å†…å­˜æ—¶å¯ä»¥æ ¹æ®æ•°ç»„çš„é•¿åº¦è¿›è¡Œæ›´ç²¾ç¡®çš„è®¡ç®—

*   ä¸€ä¸ªsliceç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆï¼šæŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ã€‚æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªsliceå…ƒç´ å¯¹åº”çš„åº•å±‚æ•°ç»„å…ƒç´ çš„åœ°å€ï¼Œé•¿åº¦å¯¹åº”sliceä¸­å…ƒç´ çš„æ•°ç›®ï¼›é•¿åº¦ä¸èƒ½è¶…è¿‡å®¹é‡ï¼Œå®¹é‡ä¸€èˆ¬æ˜¯ä»sliceçš„å¼€å§‹ä½ç½®åˆ°åº•å±‚æ•°æ®çš„ç»“å°¾ä½ç½®ã€‚å†…ç½®çš„lenå’Œcapå‡½æ•°åˆ†åˆ«è¿”å›sliceçš„é•¿åº¦å’Œå®¹é‡ï¼Œä½¿ç”¨appendæ–¹æ³•ï¼Œåˆ‡ç‰‡ä¼šè‡ªåŠ¨æ‰©å®¹
    *       func appendSlice() {
                slice := make([]int, 3, 5)
                slice[0] = 1
                slice[1] = 2
                slice[2] = 3
                //åˆå§‹åˆ‡ç‰‡: [1 2 3], é•¿åº¦: 3, å®¹é‡: 5
                fmt.Printf("åˆå§‹åˆ‡ç‰‡: %v, é•¿åº¦: %d, å®¹é‡: %d\n", slice, len(slice), cap(slice))
            
                slice = append(slice, 4)
                slice = append(slice, 5)
                //æ·»åŠ 4ï¼Œ5: [1 2 3 4 5], é•¿åº¦: 5, å®¹é‡: 5
                fmt.Printf("æ·»åŠ 4ï¼Œ5: %v, é•¿åº¦: %d, å®¹é‡: %d\n", slice, len(slice), cap(slice))
            
                slice = append(slice, 6)
                //æ·»åŠ 6ä½ç½®æ‰©å®¹ååˆ‡ç‰‡: [1 2 3 4 5 6], é•¿åº¦: 6, å®¹é‡: 10
                fmt.Printf("æ·»åŠ 6ä½ç½®æ‰©å®¹ååˆ‡ç‰‡: %v, é•¿åº¦: %d, å®¹é‡: %d\n", slice, len(slice), cap(slice))
            }
            
        
*   ä½¿ç”¨makeï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåªå¯ä»¥é€šè¿‡åˆ‡ç‰‡è®¿é—®çš„æ•°ç»„
    *       // å…ƒç´ ç±»å‹ã€é•¿åº¦ï¼Œé»˜è®¤å®¹é‡=é•¿åº¦
            make([]T, len)
            // æŒ‡å®šå®¹é‡ï¼Œå¯ç”¨æ¥é¿å…é‡å¤æ‰©å®¹
            make([]T, len, cap)
            
        

æŒ‡å®šå®¹é‡çš„æ–¹å¼è®©æˆ‘è§‰å¾—æœ‰ç‚¹é¸¡è‚‹ï¼Œæˆ‘ç”¨ArrayListçš„æ—¶å€™è¾ƒå°‘å…³æ³¨å®¹é‡ï¼ˆä¸€èˆ¬å°±åˆå§‹åŒ–çš„æ—¶å€™æŒ‡å®šé•¿åº¦ï¼‰ï¼ŒArrayListä¹Ÿå¯ä»¥æœ‰å®¹é‡çš„æ¦‚å¿µï¼Œè¿™ä¸€å®šæˆ‘è§‰å¾—javaå°è£…çš„æ›´å¥½ã€‚

3.3 map
-------

ä¸‹é¢æ˜¯åˆ›å»ºmapä»¥åŠå†™å…¥æ•°æ®çš„æ–¹å¼

    map1 := make(map[string]int)
    map1["name"] = 1
    map2 := map[string]int{
        "name": 1,
    }
    //ä¸¤ç§æ–¹æ³•ç­‰ä»·
    

mapç±»ä¼¼äºjavaä¸­çš„HashMapï¼Œä½†æ˜¯ä¹Ÿæœ‰æ‰€ä¸åŒ

*   å¯ä»¥å­˜å‚¨åŸºæœ¬ç±»å‹ï¼Œå¹¶ä¸”åŸºæœ¬ç±»å‹ä½œä¸ºvalueæœ‰åˆå§‹å€¼
    *       map1 := make(map[string]int)
            
            // è¾“å‡º0ï¼Œå› ä¸ºintç±»å‹åˆå§‹å€¼æ˜¯0
            valueOfChenxing := map1["chenxing"]
            fmt.Println(valueOfChenxing)
            // map[xxx]ç¬¬äºŒä¸ªè¿”å›å€¼æ˜¯æ˜¯å¦å­˜åœ¨æ­¤key
            _, exists := map1["chenxing"]
            fmt.Println(exists)
            
        
*   å¦‚æœæ˜¯åŸºç¡€ç±»å‹ï¼Œå¯ä»¥ç›´æ¥å¯¹valueè¿›è¡Œæ“ä½œï¼Œå³ä½¿mapä¸­ä¸å­˜åœ¨æ­¤key
    *       // æ“ä½œåï¼Œmap1ä¸­å†™å…¥test=1è¿™æ ·çš„é”®å€¼å¯¹
            map1["test"]++
            // æ“ä½œåï¼Œtest2ä¸­å†™å…¥test2=1è¿™æ ·çš„é”®å€¼å¯¹
            map1["test2"] = map1["test2"] + 1
            
        

åœ¨javaä¸­éœ€è¦ä½¿ç”¨computeæ–¹æ³•å®ç°ç±»ä¼¼æ•ˆæœ

*   mapçš„éå†
    *       for key, value := range map1 {
                fmt.Println(key, value)
            }
            
        
*   å¤æ‚ç±»å‹æ²¡æœ‰é»˜è®¤å€¼
    *       newMap := make(map[string]map[string]bool)
            value := newMap["name"]
            // true
            fmt.Println(value == nil)
            
        

ä¸ªäººæ„Ÿè§‰goä¸­è¿™ç§mapå¥—mapè¡¨è¾¾èµ·æ¥æœ‰ç‚¹åƒµç¡¬ï¼Œä¹Ÿæ˜¯æˆ‘å¯¹javaçš„å°–æ‹¬å·æ¯”è¾ƒä¸­æ„

3.4 ç»“æ„ä½“
-------

ç»“æ„ä½“ç±»ä¼¼äºjavaçš„ç±»

    type Animal struct {
        age int
        color string
    }
    

å¦‚ä¸Šå®šä¹‰é‡ŒAnimalç±»å‹ï¼Œå’Œjavaç±»ä¸åŒçš„æ˜¯

*   ä¸€ä¸ªå±æ€§æ˜¯å¦å¯¼å‡ºå–å†³äºå­—æ®µæ˜¯å¦å¤§å†™ï¼Œè¿™æ„å‘³ç€å¦å¤–ä¸€ä¸ªåŒ…è®¿é—®Animalæ—¶ï¼Œæ˜¯æ— æ³•Animal.age,å› ä¸ºageæ˜¯å¾®å¯¼å‡ºçš„ï¼Œä¿®æ”¹ä¸ºAgeåˆ™æ˜¯å¯¼å‡ºçš„
*   ç»“æ„ä½“å®šä¹‰ä¸€ä¸ªç»“æ„ä½“å±æ€§ï¼Œéœ€è¦ä½¿ç”¨æŒ‡é’ˆ
    *       type Animal struct {
                age        int
                color      string
                // è¿™æ˜¯ä¸è¢«å…è®¸çš„ï¼Œåº”è¯¥*Animal
                descendant Animal
            }
            
        

ä¸€ä¸ªå‘½åä¸ºSçš„ç»“æ„ä½“ç±»å‹å°†ä¸èƒ½å†åŒ…å«Sç±»å‹çš„æˆå‘˜ï¼šå› ä¸ºä¸€ä¸ªèšåˆçš„å€¼ä¸èƒ½åŒ…å«å®ƒè‡ªèº«ã€‚ï¼ˆè¯¥é™åˆ¶åŒæ ·é€‚ç”¨äºæ•°ç»„ã€‚ï¼‰ä½†æ˜¯Sç±»å‹çš„ç»“æ„ä½“å¯ä»¥åŒ…å«\*SæŒ‡é’ˆç±»å‹çš„æˆå‘˜ï¼š

*   å¦‚æœç»“æ„ä½“çš„å…¨éƒ¨æˆå‘˜éƒ½æ˜¯å¯ä»¥æ¯”è¾ƒçš„ï¼Œé‚£ä¹ˆç»“æ„ä½“ä¹Ÿæ˜¯å¯ä»¥æ¯”è¾ƒçš„ï¼Œé‚£æ ·çš„è¯ä¸¤ä¸ªç»“æ„ä½“å°†å¯ä»¥ä½¿ç”¨æˆ–!=è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚ç›¸ç­‰æ¯”è¾ƒè¿ç®—ç¬¦å°†æ¯”è¾ƒä¸¤ä¸ªç»“æ„ä½“çš„æ¯ä¸ªæˆå‘˜

ç›¸å½“äºæ¯”è¾ƒä¸¤ä¸ªç»“æ„ä½“æ‰€æœ‰çš„æˆå‘˜å˜é‡å€¼

*   ç»“æ„ä½“çš„æ–¹æ³•ä¸æ˜¯å®šä¹‰åœ¨ç»“æ„ä½“ä¸­çš„
    *       type Animal struct {
                age        int
                color      string
                descendant *Animal
                spark      string
            }
            
            func (animal *Animal) Spark() (string, error) {
                if animal == nil {
                   return "", errors.New("null input")
                }
                return animal.spark, nil
            }
            
        

å¦‚ä¸Šå®šä¹‰é‡Œä¸€ä¸ªSparkæ–¹æ³•ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥

    animal2 := Animal{age: 10}
    fmt.Println(animal2.Spark())
    

*   ç»“æ„ä½“çš„åµŒå¥—
    *       type Cat struct {
                Animal
                kind string
            }
            
        
    *       func main() {
            
                animal := Animal{age: 10}
                cat := Cat{kind: "1"}
                cat.Animal.age = 10
            
                // åµŒå¥—ç»“æ„å¦‚ä½•åˆå§‹åŒ–
                cat2 := Cat{kind: "1", Animal: Animal{age: 10}}
                fmt.Println(cat2)
                fmt.Println(cat)
                fmt.Println(animal)
            
                // å¯ä»¥ç›´æ¥ä½¿ç”¨Animalçš„å±æ€§
                fmt.Println(cat.age)
                // ä¹Ÿå¯ä»¥..çš„è·å–
                fmt.Println(cat.Animal.age)
                
                fmt.Println(cat2 == cat)
            }
            
        

â€‹ è¿™ä¸€ç‚¹å¦‚åŒjavaä¸­çš„ç»§æ‰¿

å¤–å±‚çš„ç»“æ„ä½“ä¸ä»…ä»…æ˜¯è·å¾—äº†åŒ¿åæˆå‘˜ç±»å‹çš„æ‰€æœ‰æˆå‘˜ï¼Œè€Œä¸”ä¹Ÿè·å¾—äº†è¯¥ç±»å‹å¯¼å‡ºçš„å…¨éƒ¨çš„æ–¹æ³•ã€‚è¿™ä¸ªæœºåˆ¶å¯ä»¥ç”¨äºå°†ä¸€äº›æœ‰ç®€å•è¡Œä¸ºçš„å¯¹è±¡ç»„åˆæˆæœ‰å¤æ‚è¡Œä¸ºçš„å¯¹è±¡ã€‚ç»„åˆæ˜¯Goè¯­è¨€ä¸­é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒ

â€‹ è¿™æ„å‘³ç€Animalçš„Sparkæ–¹æ³•å¯ä»¥è®©catä½¿ç”¨

    cat := Cat{kind: "1"}
    fmt.Println(cat.Spark())
    

4.å‡½æ•°
====

å‡½æ•°å£°æ˜åŒ…æ‹¬å‡½æ•°åã€å½¢å¼å‚æ•°åˆ—è¡¨ã€è¿”å›å€¼åˆ—è¡¨ï¼ˆå¯çœç•¥ï¼‰ä»¥åŠå‡½æ•°ä½“ã€‚

    func å‡½æ•°å(å½¢å‚åˆ—è¡¨) (è¿”å›å€¼åˆ—è¡¨) {
        body
    }
    

é™¤äº†å£°æ˜æ–¹å¼ä¸åŒä¹‹å¤–ï¼Œä¸‹é¢è¯´æ˜ä¸€äº›javaä¸­æ–¹æ³•ä¸åŒçš„ç‚¹

4.1 ç›¸åŒå½¢å‚å¯ä»¥åˆå¹¶
------------

    func add(x, y int) int {
        return x+y;
    }
    
    // add å’Œadd1ç­‰ä»·
    func add1(x int, y int) int {
        return x + y
    }
    

â€‹ å½“å‚æ•°ä¸å¤šçš„æ—¶å€™ï¼Œçœ‹èµ·æ¥æ˜¯è¦ç®€æ´ä¸€äº›ï¼Œä½†æ˜¯å¦‚æœå‚æ•°å¾ˆå¤šç±»å‹å¾ˆæ‚çš„æ—¶å€™ï¼Œå°±æœ‰ç‚¹ä¸åˆ©äºé˜…è¯»äº†

4.2 å‡½æ•°å¯ä»¥å…·å¤‡å¤šè¿”å›å€¼
--------------

â€‹ è¿™ä¸€ç‚¹å¸¸è¢«ç”¨åœ¨è¿”å›æ­£ç¡®ç»“æœorå¼‚å¸¸çš„æƒ…å†µ

    func div(x int, y int) (int, error) {
        if y == 0 {
           return 0, errors.New("division by zero")
        }
        return x / y, nil
    }
    

4.3 å‡½æ•°æ˜¯ä¸€çº§å…¬æ°‘
-----------

*   å¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼šå‡½æ•°å¯ä»¥åƒæ™®é€šçš„å€¼ä¸€æ ·è¢«èµ‹å€¼ç»™å˜é‡ã€‚
*   å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ï¼šèƒ½å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ã€‚
    *   å’Œjavaä¸­çš„FunctionInterfaceä¸€æ ·ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œå›è°ƒç­‰ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„ä½¿ç”¨ä¾‹å­
    *       func main() {
            
                ints := make([]int, 3, 10)
                ints[2] = 1
                // [0 0 1]
                fmt.Println(ints)
                ints = filter(&ints, func(i int) bool {
                   return i > 0
                })
                // [1]
                fmt.Println(ints)
            }
            
            func filter(array *[]int, filter func(int) bool) []int {
                newArray := []int{}
                for _, i := range *array {
                   filterFlag := filter(i)
                   if !filterFlag {
                      continue
                   }
                   newArray = append(newArray, i)
                }
                return newArray
            }
            
        
*   å¯ä»¥ä»å‡½æ•°è¿”å›ï¼šå‡½æ•°æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ã€‚
    *   â€‹ å¯ä»¥åšä¸€äº›æƒ°æ€§æ±‚å€¼
        
    *   â€‹ ä¾‹å¦‚éœ€è¦é€šè¿‡rpcæ‹‰å–ä¸‰ä¸ªç³»ç»Ÿçš„å†…å®¹ï¼Œç„¶åå­˜å‚¨åˆ°æ•°æ®ï¼Œå¯ä»¥è¿”å›ä¸‰ä¸ªå…¥åº“çš„funcï¼Œç„¶ååœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œ
        

4.4 åŒ¿åå‡½æ•°
--------

â€‹ è¿™ä¸€ç‚¹åœ¨å›¢é˜Ÿé¡¹ç›®ä¸­å¸¸è§äºmysqläº‹åŠ¡æäº¤å’Œå›æ»š

    // è®°å½•å¼‚å¸¸
    var err error
    // transaction := mysql.GetTransaction(ctx) è·å–äº‹ç‰© 
    // deferç±»ä¼¼äºjavaä¸­çš„finally
    if t := mysql.GetTransaction(ctx); t == nil {
    // å¦‚æœtransaction==null è¯´æ˜ä¹‹å‰æ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Œä¸‹é¢è¿™ä¸€è¡Œå¼€å¯äº‹åŠ¡
        ctx = mysql.Begin(ctx).Ctx
        // åŒ¿åå‡½æ•°ï¼Œä½¿ç”¨defer ç±»ä¼¼äºjava finnally
        defer func() {
        // æœ‰å¼‚å¸¸é‚£ä¹ˆå›æ»šäº‹åŠ¡
           if err != nil {
              _ = mysql.Rollback(ctx)
           } else {
           // å¦åˆ™å›æ»šäº‹åŠ¡
              _ = mysql.Commit(ctx)
           }
        }()
    }
    

ctx ç±»ä¼¼javaçš„threadLocalï¼Œç±»ä¼¼äºspringä¸­çš„TransationSynchoronzationManagerã€‚

deferç±»ä¼¼äºjavaä¸­çš„finally

è¿™é‡Œå…¶å®ç±»ä¼¼äºjavaä¸­try catchï¼Œåœ¨catchä¸­å›æ»šï¼Œå¦‚æœæ²¡æœ‰å¼‚å¸¸é‚£ä¹ˆæäº¤

å¯ä»¥çœ‹åˆ°åŒ¿åå‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸå®šä¹‰çš„å˜é‡

4.5 defer
---------

deferè¯­å¥ç»å¸¸è¢«ç”¨äºå¤„ç†æˆå¯¹çš„æ“ä½œï¼Œå¦‚æ‰“å¼€ã€å…³é—­ã€è¿æ¥ã€æ–­å¼€è¿æ¥ã€åŠ é”ã€é‡Šæ”¾é”ã€‚é€šè¿‡deferæœºåˆ¶ï¼Œä¸è®ºå‡½æ•°é€»è¾‘å¤šå¤æ‚ï¼Œéƒ½èƒ½ä¿è¯åœ¨ä»»ä½•æ‰§è¡Œè·¯å¾„ä¸‹ï¼Œèµ„æºè¢«é‡Šæ”¾ã€‚

ç±»ä¼¼äºjavaä¸­çš„finaly

    var i int
    
    func main() {
        r := invoke()
        fmt.Println("invoke return,", r)
        fmt.Println("invokedï¼Œ", i)
    }
    
    func invoke() int {
        i = 1
        defer deferAdd(&i)
        defer deferPrint()
        return i
    }
    
    func deferAdd(num *int) {
        *num = *num + 10
        fmt.Println("deferAdd")
    }
    func deferPrint() {
        fmt.Println("deferPrint")
    }
    

æ‰“å°ç»“æœæ˜¯

deferPrint

deferAdd

invoke return, 1

invokedï¼Œ 11

è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡º

*   deferçš„æ‰§è¡Œå’Œä»£ç ä¹¦å†™é¡ºåºæ˜¯ç›¸åçš„

4.6 é”™è¯¯ï¼Œpanicå¼‚å¸¸ï¼Œä»¥åŠä½¿ç”¨recover æ¢å¤
-----------------------------

*   errorï¼šå®ƒæ˜¯ä¸€ç§è¡¨ç¤ºé”™è¯¯çŠ¶æ€çš„ç±»å‹ã€‚åœ¨ Go ä¸­å‡½æ•°ç»å¸¸è¿”å›ä¸€ä¸ª error å¯¹è±¡æ¥è¡¨ç¤ºå¯èƒ½å‡ºç°çš„é”™è¯¯æƒ…å†µã€‚å®ƒå’Œ Java ä¸­çš„ Exception æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œéƒ½æ˜¯ç”¨äºå¤„ç†ç¨‹åºè¿è¡Œä¸­çš„éæ­£å¸¸æƒ…å†µã€‚
*   panicï¼šå®ƒç”¨äºè¡¨ç¤ºéå¸¸ä¸¥é‡çš„ã€ä¸å¯æ¢å¤çš„é”™è¯¯æƒ…å†µï¼Œå¯¼è‡´ç¨‹åºç«‹å³åœæ­¢æ‰§è¡Œå¹¶å¼€å§‹å±•å¼€è°ƒç”¨æ ˆã€‚å®ƒæœ‰ç‚¹ç±»ä¼¼äº Java ä¸­çš„æŸäº›ä¸¥é‡çš„ç³»ç»Ÿçº§é”™è¯¯ï¼Œä½†ä¹Ÿä¸å®Œå…¨ç›¸åŒã€‚

    func main() {
        fmt.Println(Parse("!"))
        fmt.Println("main end")
    }
    
    func Parse(input string) (r int, err error) {
        r = 2
        defer func() {
           if p := recover(); p != nil {
              r = 3
              err = fmt.Errorf("internal error: %v", p)
           }
        }()
        makePanic()
        r = 1
        return
    }
    
    func makePanic() {
        fmt.Println("makePanic before")
        panic("makePanic")
        fmt.Println("makePanic after")
    }
    

ä¸‹é¢ä»£ç çš„è¾“å‡ºï¼š

makePanic before // æ²¡æœ‰è¾“å‡º makePanic afterï¼Œè¯´æ˜panicä¼šç»ˆæ­¢åç»­é€»è¾‘

3 internal error: makePanic // è¾“å‡ºçš„æ˜¯3ï¼Œæ˜¯deferè¿™ä¸ªåˆ†æ”¯æ”¹äº†è¿”å›çš„r

main end // è¯´æ˜æˆ‘ä»¬ä»panicä¸­æ¢å¤äº†

5.æ–¹æ³•
====

ä¸€ä¸ªå¯¹è±¡å…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªç®€å•çš„å€¼æˆ–è€…ä¸€ä¸ªå˜é‡ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ä¼šåŒ…å«ä¸€äº›æ–¹æ³•ï¼Œè€Œä¸€ä¸ªæ–¹æ³•åˆ™æ˜¯ä¸€ä¸ªå’Œç‰¹æ®Šç±»å‹å…³è”çš„å‡½æ•°ã€‚ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç¨‹åºä¼šç”¨æ–¹æ³•æ¥è¡¨è¾¾å…¶å±æ€§å’Œå¯¹åº”çš„æ“ä½œï¼Œè¿™æ ·ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„ç”¨æˆ·å°±ä¸éœ€è¦ç›´æ¥å»æ“ä½œå¯¹è±¡ï¼Œè€Œæ˜¯å€ŸåŠ©æ–¹æ³•æ¥åšè¿™äº›äº‹æƒ…ã€‚

å’Œjavaä¸­çš„æ–¹æ³•ç±»ä¼¼ï¼Œæ”¯æŒå¯¹è±¡.æ–¹æ³•è¿›è¡Œè°ƒç”¨

åœ¨ç»“æ„ä½“è¿™ä¸€èŠ‚ä¸­æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªAnimalç»“æ„ä½“ï¼Œå’ŒAnimalå¯¹åº”çš„Sparkæ–¹æ³•

    type Animal struct {
        age   int
        color string
        spark string
    }
    func (animal Animal) Spark() (string, error) {
        if animal == nil {
           return "", errors.New("null input")
        }
        return animal.spark, nil
    }
    

ä¸Šé¢çš„ä»£ç é‡Œé‚£ä¸ªé™„åŠ çš„å‚æ•°animalï¼Œå«åšæ–¹æ³•çš„æ¥æ”¶å™¨ï¼ˆreceiverï¼‰ï¼Œæ—©æœŸçš„é¢å‘å¯¹è±¡è¯­è¨€ç•™ä¸‹çš„é—äº§å°†è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ç§°ä¸ºâ€œå‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯â€ã€‚è¿™æ ·å†™å°±å¯ä»¥ä½¿ç”¨Animal.Spark()è¿›è¡Œè°ƒç”¨äº†

5.1 ä½¿ç”¨åŸºäºæŒ‡é’ˆçš„æ–¹æ³•
-------------

    func (animal *Animal) slienceWithPoint() {
        animal.spark = ""
    }
    func (animal Animal) slience() {
        animal.spark = ""
    }
    

å¦‚ä¸Šå®šä¹‰ä¸¤ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­slienceWithPointæ˜¯å¯ä»¥å°†animalçš„å±æ€§çœŸæ­£è¿›è¡Œæ›´æ”¹çš„ï¼Œslienceåªèƒ½æ”¹å˜ä¼ å…¥çš„å­—é¢å€¼ï¼Œåªèƒ½æ”¹å˜å‰¯æœ¬ï¼ˆgoæ˜¯å€¼ä¼ é€’çš„ï¼Œä¼ å…¥æŒ‡é’ˆçš„æ—¶å€™ä¹Ÿæ˜¯å€¼ä¼ é€’ï¼Œä½†æ˜¯æŒ‡é’ˆæŒ‡å‘çš„åœ°å€æ˜¯åŸå§‹å˜é‡ï¼ï¼‰

ç»“åˆä¸‹é¢è¿™æ®µä»£ç å¯ä»¥æ›´å¥½çš„ç†è§£ï¼Œè¿™ä¹Ÿæ˜¯goæ–¹æ³•å’Œjavaæ–¹æ³•ä¸€ä¸ªè¾ƒå¤§çš„ä¸åŒ

    func main() {
    
        animal := Animal{spark: "wangwang"}
        // wangwang <nil>
        fmt.Println(animal.Spark())
    
        animal.slience()
        // wangwang ===>åªæ”¹å˜è„¸ä¼ å…¥çš„å‰¯æœ¬ï¼Œè€Œæ²¡æœ‰æ”¹å˜åŸå˜é‡
        fmt.Println(animal.spark)
        // ä½¿ç”¨åŸºäºæŒ‡é’ˆçš„æ–¹æ³• 
        animal.slienceWithPoint()
        // true ==> è¯´æ˜æ”¹å˜è„¸åŸå¯¹è±¡
        fmt.Println(animal.spark == "")
        
      }
    

åœ¨æˆ‘ä»¬ç³»ç»Ÿçš„ä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†æ–¹æ³•éƒ½æ˜¯åŸºäºæŒ‡é’ˆçš„

5.2 nilä¹Ÿå¯ä»¥è°ƒç”¨æ–¹æ³•
--------------

    var nilAnimal Animal
    // è¾“å‡ºçš„æ˜¯true
    fmt.Println(nilAnimal.SparkWithOutCheck() == "")
    fmt.Println("end")
    
    func (animal *Animal) SparkWithOutCheck() string {
        return animal.spark
    }
    

å¦‚ä¸Š ä½¿ç”¨nilè°ƒç”¨SparkWithOutCheckï¼Œè¿”å›çš„æ˜¯ç©ºç™½å­—ç¬¦ä¸²ï¼ŒNPEæ²¡äº†ï¼Œç¬‘æ­»

5.3 é€šè¿‡åµŒå…¥ç»“æ„ä½“æ¥å®ç°æ–¹æ³•çš„ç»§æ‰¿
-------------------

å¦‚ç»“æ„ä½“è¿™ä¸€èŠ‚ä¸­è¯´åˆ°çš„ï¼Œgoä¸­çš„ç»§æ‰¿æ˜¯é€šè¿‡ç»„åˆæ¥å®ç°çš„

    type Cat struct {
        Animal // catç»§æ‰¿Animal
        kind string
    }
    
    cat :=Cat{
        kind: "1",
        Animal: Animal{
           spark: "miaomiao",
        },
    }
    // catå…·å¤‡Animalä¸­çš„æ–¹æ³•
    // è¾“å‡º miaomiao
    fmt.Println(cat.SparkWithOutCheck())
    

å½“ç„¶catä¹Ÿå¯ä»¥å¤å†™Animalä¸­çš„æ–¹æ³•

    func (c Cat) SparkWithOutCheck() string {
        return "kuakua"
    }
    

å†æ¬¡ä½¿ç”¨cat.SparkWithOutCheck()å°†æ‰“å°kuakua

6.æ¥å£
====

å¦‚ä¸‹æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªä½¿ç”¨æ”¹æ¥å£ç±»å‹çš„æ–¹æ³•

    type IntPriority interface {
        GetPriority() int
        GetPriority2(int) int
    }
    
    // ä½¿ç”¨æ¥å£ä½œä¸ºå‚æ•°è¿›è¡Œæ¯”è¾ƒ
    func Compare(first IntPriority, second IntPriority) (int, error) {
        if first == nil || second == nil {
           return 0, errors.New("null input")
        }
        firstPriority := first.GetPriority()
        secondPriority := second.GetPriority()
        if firstPriority == secondPriority {
           return 0, nil
        }
        if firstPriority > secondPriority {
           return 1, nil
        }
        return -1, nil
    }
    

6.1 åªæœ‰å®ç°äº†æ¥å£çš„æ‰€æœ‰æ–¹æ³•æ‰ç®—å®ç°äº†æ¥å£
-----------------------

è¿™ä¸€ç‚¹å’Œjavaå¾ˆç±»å‹ï¼Œä½†æ˜¯goæ²¡æœ‰implementå…³é”®å­—ï¼Œå¥½åœ¨Golandå®ç°äº†ä»£ç æç¤º

    func init() {
        fmt.Println("init_method_learn.go")
        field1 = "test"
    
        entity := Entity{age: 1}
        var i IntPriority = &entity
        fmt.Println(i)
    }
    
    type Entity struct {
        age int
    }
    
    func (e *Entity) GetPriority() int {
        return e.age
    }
    

ç”±äºæˆ‘ä»¬Entityç»“æ„åªå®ç°äº†GetPriorityæ–¹æ³•ï¼Œä¸‹é¢ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘

    entity1 := Entity{age: 1}
    entity2 := Entity{age: 2}
    
    // ç¼–è¯‘é”™è¯¯
    fmt.Println(Compare(entity2, entity1))
    // ç¼–è¯‘é”™è¯¯
    var i IntPriority = &entity1
    

6.2 æ¥å£æ˜¯å¼•ç”¨ç±»å‹ï¼Œç»“æ„ä½“æ˜¯å€¼ç±»å‹
-------------------

å³ä½¿Entityå®ç°äº†IntPriorityä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œåœ¨è°ƒç”¨Compareçš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨&Entityè·å–æŒ‡é’ˆä¼ å…¥ï¼Œ

å½“éœ€è¦åœ¨å‡½æ•°å†…éƒ¨ä¿®æ”¹ä¼ å…¥çš„å‚æ•°å¹¶ä¸”å¸Œæœ›è¿™äº›ä¿®æ”¹å¯¹å‡½æ•°å¤–éƒ¨å¯è§æ—¶ï¼Œéœ€è¦ä¼ å…¥æŒ‡é’ˆè€Œä¸æ˜¯å¯¹è±¡ã€‚è¿™æ˜¯å› ä¸º Go è¯­è¨€ä¸­çš„ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œè€Œä¸æ˜¯å¼•ç”¨ç±»å‹ã€‚å½“ä¼ é€’ç»“æ„ä½“å¯¹è±¡æ—¶ï¼Œå‡½æ•°å†…éƒ¨ä¼šå¤åˆ¶ä¸€ä»½ç»“æ„ä½“çš„å€¼ï¼Œå¯¹å…¶è¿›è¡Œçš„ä¿®æ”¹ä¸ä¼šå½±å“åŸå§‹çš„ç»“æ„ä½“å¯¹è±¡ã€‚

### æ¥å£ä½œä¸ºå¼•ç”¨ç±»å‹çš„å¥½å¤„ï¼š

1.  çµæ´»æ€§å’ŒåŠ¨æ€æ€§ï¼šå¯ä»¥æ–¹ä¾¿åœ°åœ¨è¿è¡Œæ—¶å°†ä¸åŒçš„å…·ä½“ç±»å‹ä¸æ¥å£å…³è”ï¼Œå®ç°å¤šæ€è¡Œä¸ºï¼Œä½¿ä»£ç èƒ½å¤Ÿé€‚åº”ä¸åŒçš„å®ç°è€Œæ— éœ€å¤§è§„æ¨¡ä¿®æ”¹ã€‚
2.  è§£è€¦æ€§ï¼šé€šè¿‡æ¥å£æ¥å®šä¹‰è¡Œä¸ºè§„èŒƒï¼Œè°ƒç”¨æ–¹åªéœ€å…³æ³¨æ¥å£å®šä¹‰ï¼Œè€Œä¸å…³å¿ƒå…·ä½“å®ç°ç»†èŠ‚ï¼Œå¢å¼ºäº†æ¨¡å—ä¹‹é—´çš„è§£è€¦ã€‚

### ç»“æ„ä½“ä½œä¸ºå€¼ç±»å‹çš„å¥½å¤„ï¼š

1.  ç®€å•å’Œç›´è§‚ï¼šç»“æ„ä½“çš„èµ‹å€¼å’Œä¼ é€’è¡Œä¸ºç›¸å¯¹ç®€å•æ˜ç¡®ï¼Œç¬¦åˆäººä»¬å¯¹ä¸€èˆ¬æ•°æ®ç»“æ„çš„ç†è§£å’Œä½¿ç”¨ä¹ æƒ¯ã€‚
2.  æ•°æ®ç‹¬ç«‹æ€§ï¼šæ¯ä¸ªç»“æ„ä½“å®ä¾‹éƒ½æ˜¯ç‹¬ç«‹çš„æ•°æ®å—ï¼Œä¿®æ”¹ä¸€ä¸ªç»“æ„ä½“å˜é‡ä¸ä¼šå½±å“å…¶ä»–å˜é‡ï¼Œæœ‰åˆ©äºä»£ç çš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
3.  é«˜æ•ˆä¼ é€’ï¼šåœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œå€¼ä¼ é€’å¯ä»¥é¿å…ä¸å¿…è¦çš„æŒ‡é’ˆé—´æ¥æ“ä½œï¼Œæé«˜æ€§èƒ½ï¼Œå¹¶ä¸”é¿å…ä¸€äº›å› æŒ‡é’ˆä½¿ç”¨ä¸å½“å¸¦æ¥çš„é—®é¢˜ã€‚

6.3 ç±»å‹æ–­è¨€
--------

é€šè¿‡ä¸‹é¢ç±»ä¼¼çš„è¯­æ³•ï¼Œå¯ä»¥åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯æŸä¸ªç±»å‹ï¼Œå¦‚æœä¸æ»¡è¶³é‚£ä¹ˆä¼šæŠ›å‡ºpanic

    func main() {
    
        m := map[string]interface{}{}
        var i int = 10
        m["name"] = i
    
        value := m["name"]
        i2 := value.(int)
        // 10
        fmt.Println(i2)
    
        //panic: interface conversion: interface {} is int, not string
        i3 := value.(string)
        fmt.Println(i3)
    }
    

å¦å¤–è¿˜æ”¯æŒè¿”å›æ˜¯å¦æ˜¯è¯¥ç±»å‹ï¼Œå¦‚ä¸‹é¢çš„okï¼Œæ˜¯ä¸€ä¸ªboolç±»å‹ï¼Œè¿™æ ·èƒ½é¿å…panicçš„æŠ›å‡º

    i3, ok := value.(string)
    fmt.Println(i3, ok)
    

6.4 ç±»å‹åˆ†æ”¯
--------

å¦‚ä¸‹æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªaddOneæ–¹æ³•å°è¯•æ”¯æŒæ‰€æœ‰æ•°å€¼ç±»å‹çš„â•1æ“ä½œ

    func addOne(x interface{}) any {
        if x == nil {
           return "NULL"
        } else if intValue, ok := x.(int); ok {
           return intValue + 1
        } else if uintValue, ok := x.(uint); ok {
           return uintValue + 1
        } else {
           panic(fmt.Sprintf("unexpected type %T: %v", x, x))
        }
    }
    

å¯ä»¥é€šè¿‡ç±»å‹æ–­è¨€æ¥åˆ¤æ–­æ˜¯å¦æ˜¯æŸä¸€ä¸ªç±»å‹

ä¹Ÿå¯ä»¥é€šè¿‡switchæ¥åˆ¤æ–­

    func addOne2(value interface{})any{
        switch x := value.(type) {
        case nil:
           return "NULL"
        case int:
           i2 := value.(int)
           return i2+ 1// x has type interface{} here.
        default:
           panic(fmt.Sprintf("unexpected type %T: %v", x, x))
        }
    }