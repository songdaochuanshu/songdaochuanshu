---
layout: post
title: 'ã€URPã€‘Unity[RendererFeatures]è´´èŠ±Decal'
date: "2025-11-19T00:42:41Z"
---
ã€URPã€‘Unity\[RendererFeatures\]è´´èŠ±Decal
=====================================

![ã€URPã€‘Unity[RendererFeatures]è´´èŠ±Decal](https://img2024.cnblogs.com/blog/3685400/202511/3685400-20251119084035571-1040950464.png) Unity URPä¸­çš„Decalï¼ˆè´´èŠ±ï¼‰ç³»ç»Ÿæ˜¯ä¸€ç§ç”¨äºå°†æè´¨æŠ•å°„åˆ°åœºæ™¯å‡ ä½•ä½“è¡¨é¢çš„æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå®ç°è¡€è¿¹ã€å¼¹å­”ã€æ¶‚é¸¦ç­‰åŠ¨æ€è¡¨é¢è£…é¥°æ•ˆæœã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š æ ¸å¿ƒåŠŸèƒ½ä¸ç”¨é€” â€ŒåŠ¨æ€æŠ•å½±â€Œï¼šé€šè¿‡Decal

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**

Unity URPä¸­çš„Decalï¼ˆè´´èŠ±ï¼‰ç³»ç»Ÿæ˜¯ä¸€ç§ç”¨äºå°†æè´¨æŠ•å°„åˆ°åœºæ™¯å‡ ä½•ä½“è¡¨é¢çš„æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå®ç°è¡€è¿¹ã€å¼¹å­”ã€æ¶‚é¸¦ç­‰åŠ¨æ€è¡¨é¢è£…é¥°æ•ˆæœã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š

**æ ¸å¿ƒåŠŸèƒ½ä¸ç”¨é€”**
===========

*   â€Œ**åŠ¨æ€æŠ•å½±**â€Œï¼šé€šè¿‡Decal Projectorç»„ä»¶å°†æè´¨åŠ¨æ€æŠ•å°„åˆ°ä»»æ„è¡¨é¢ï¼ŒåŒ…æ‹¬æ›²é¢å’Œå¤æ‚å‡ ä½•ä½“
*   â€Œ**å…‰ç…§äº¤äº’**â€Œï¼šæ”¯æŒä¸åœºæ™¯å…‰ç…§ç³»ç»Ÿäº¤äº’ï¼Œå¯æ¨¡æ‹Ÿé˜´å½±ã€é«˜å…‰ç­‰ç‰©ç†æ•ˆæœ
*   â€Œ**å…¸å‹åº”ç”¨åœºæ™¯**â€Œï¼š
    *   æ¸¸æˆä¸­çš„å¼¹å­”ã€è¡€è¿¹ã€æ¶‚é¸¦
    *   ç¯å¢ƒç»†èŠ‚å¢å¼ºï¼ˆå¦‚å¢™é¢è£‚ç¼ã€æ±¡æ¸ï¼‰
    *   æŠ€èƒ½èŒƒå›´æŒ‡ç¤ºå™¨ï¼ˆå¦‚Dota2çš„åœ°é¢æ ‡è®°ï¼‰

**æŠ€æœ¯æ¼”è¿›**
========

ç‰ˆæœ¬é˜¶æ®µ

å®ç°æ–¹å¼

ç‰¹æ€§å·®å¼‚

ä¼ ç»Ÿå®ç°

åŸºäºé¢ç‰‡Mesh

ä»…æ”¯æŒå¹³é¢æŠ•å½±ï¼Œæ— æ³•é€‚åº”å¤æ‚æ›²é¢

URPæ—©æœŸ

Projectorç»„ä»¶

å­˜åœ¨æ·±åº¦å†²çª(Z-fighting)é—®é¢˜ï¼Œæ€§èƒ½å¼€é”€å¤§

URP 12+

Decal Renderer Feature

æ”¯æŒPBRæè´¨ï¼Œä¸SRPæ·±åº¦é›†æˆï¼Œæ€§èƒ½ä¼˜åŒ–

åŸç†
==

Unity URPä¸­çš„Decalç³»ç»Ÿé€šè¿‡â€Œ**æ·±åº¦ç¼“å†²é‡å»ºä¸–ç•Œåæ ‡**â€Œå’Œâ€Œ**æè´¨æŠ•å½±æŠ€æœ¯**â€Œå®ç°åŠ¨æ€è´´èŠ±æ•ˆæœï¼Œå…¶æ ¸å¿ƒåŸç†å¯åˆ†ä¸ºä»¥ä¸‹æŠ€æœ¯å±‚çº§ï¼š

* * *

**åº•å±‚æ¸²æŸ“æµç¨‹**
----------

*   â€Œ**æ·±åº¦å›¾é‡‡æ ·**â€Œ
    
    Decal Renderer Featureåœ¨æ¸²æŸ“ç®¡çº¿ä¸­æ’å…¥è‡ªå®šä¹‰Passï¼Œé€šè¿‡`_CameraDepthTexture`è·å–åƒç´ æ·±åº¦å€¼ï¼Œç»“åˆæ‘„åƒæœºå‚æ•°é‡å»ºä¸–ç•Œåæ ‡ã€‚å…³é”®å…¬å¼ï¼š
    
    > worldPos = \_CameraToWorldçŸ©é˜µ Ã— (å±å¹•UV + æ·±åº¦å€¼ Ã— è§†é”¥å‘é‡)
    
*   â€Œ**æŠ•å½±ä½“ç§¯è£å‰ª**â€Œ
    
    ä½¿ç”¨Decal Projectorå®šä¹‰çš„ç«‹æ–¹ä½“è¾¹ç•Œï¼ˆSizeå‚æ•°ï¼‰è¿›è¡Œç©ºé—´è£å‰ªï¼Œé€šè¿‡å°„çº¿ä¸AABBç¢°æ’æ£€æµ‹åˆ¤æ–­åƒç´ æ˜¯å¦åœ¨æŠ•å½±èŒƒå›´å†…ã€‚è¶…å‡ºèŒƒå›´çš„åƒç´ ä¼šè¢«å‰”é™¤ã€‚
    
*   â€Œ**æè´¨æ··åˆ**â€Œ
    
    é‡‡ç”¨â€Œ**å»¶è¿Ÿæ¸²æŸ“è·¯å¾„**â€Œçš„GBufferä¿®æ”¹ç­–ç•¥ï¼Œé€šè¿‡`Blend`æŒ‡ä»¤å°†Decalçš„Albedo/Normal/Metallicç­‰å±æ€§ä¸åœºæ™¯æè´¨æ··åˆï¼Œæ”¯æŒPBRå…‰ç…§äº¤äº’ã€‚
    

* * *

**å…³é”®ä»£ç å®ç°ç¤ºä¾‹**
------------

ä»¥ä¸‹ä¸ºç®€åŒ–ç‰ˆShaderæ ¸å¿ƒé€»è¾‘ï¼š

    hlsl
    // æ·±åº¦é‡å»ºä¸–ç•Œåæ ‡
    float3 ReconstructWorldPos(float2 uv, float depth) {
        float4 clipPos = float4(uv * 2 - 1, depth, 1);
        float4 worldPos = mul(_ClipToWorld, clipPos);
        return worldPos.xyz / worldPos.w;
    }
    
    // æŠ•å½±ä½“ç§¯åˆ¤æ–­
    bool IsInDecalVolume(float3 worldPos, float3 decalPos, float3 size) {
        float3 localPos = mul(_WorldToDecal, float4(worldPos, 1)).xyz;
        return all(abs(localPos) < 0.5);
    }
    

* * *

**æŠ€æœ¯æ¼”è¿›å¯¹æ¯”**
----------

ç‰ˆæœ¬

æŠ€æœ¯æ–¹æ¡ˆ

ç¼ºé™·

æ”¹è¿›ç‚¹

ä¼ ç»Ÿå®ç°

åŸºäºMeshé¢ç‰‡æŠ•å½±

æ— æ³•é€‚åº”æ›²é¢

\-

URP 10

å±å¹•ç©ºé—´æ·±åº¦é‡‡æ ·

é€æ˜ç‰©ä½“ä¸æ”¯æŒ

å‡å°‘Z-fighting

URP 12+

GBufferæ··åˆ+ä½“ç§¯è£å‰ª

æ€§èƒ½å¼€é”€è¾ƒé«˜

æ”¯æŒPBRå’ŒåŠ¨æ€å…‰ç…§

* * *

**æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
----------

*   â€Œ**å±‚çº§å‰”é™¤**â€Œï¼šé€šè¿‡`Decal Layer`åˆ†ç±»æ§åˆ¶ä¸åŒDecalçš„æ¸²æŸ“å±‚çº§
*   â€Œ**è·ç¦»æ·¡å‡º**â€Œï¼š`Draw Distance`å’Œ`Start Fade`å‚æ•°åŠ¨æ€å‡å°‘è¿œå¤„Decalè®¡ç®—
*   â€Œ**æ‰¹å¤„ç†**â€Œï¼šç›¸åŒæè´¨çš„Decal Projectorä¼šè‡ªåŠ¨åˆå¹¶ç»˜åˆ¶è°ƒç”¨

* * *

**å…¸å‹é—®é¢˜è§£å†³æ–¹æ¡ˆ**
------------

*   â€Œ**é€æ˜ç‰©ä½“æ”¯æŒ**â€Œï¼šéœ€è‡ªå®šä¹‰Shaderé‡å†™`AlphaTest`é€»è¾‘
*   â€Œ**æ›²é¢å˜å½¢**â€Œï¼šå¢åŠ `Normal Smoothing`å‚æ•°ä¿®æ­£æ³•çº¿æ’å€¼
*   â€Œ**ç§»åŠ¨ç«¯é€‚é…**â€Œï¼šé™ä½æ·±åº¦å›¾ç²¾åº¦æˆ–ä½¿ç”¨`Depth Prepass`ç­–ç•¥

**å®Œæ•´å®ç°æµç¨‹**
==========

*   åˆ›å»ºURP Assetï¼š
    *   èœå•æ  Edit > Project Settings > Graphics
    *   æŒ‡å®šURP Pipeline Asset
*   æ·»åŠ Decal Renderer Featureï¼š
    *   åœ¨URP Renderer Dataä¸­æ·»åŠ Decal Renderer Feature
    *   è®¾ç½®Priorityæ§åˆ¶æ¸²æŸ“é¡ºåº
*   åˆ›å»ºDecalæè´¨ï¼š
    *   Shaderé€‰æ‹©"Universal Render Pipeline/Decal"
    *   é…ç½®Albedoã€Normalç­‰è´´å›¾é€šé“
*   æ”¾ç½®Decal Projectorï¼š
    *   åˆ›å»ºç©ºGameObject
    *   æ·»åŠ Decal Projectorç»„ä»¶
    *   å…³è”æ­¥éª¤åˆ›å»ºçš„æè´¨

**å…³é”®å‚æ•°è¯¦è§£**
==========

å‚æ•°

ç±»å‹

ä½œç”¨

å…¸å‹å€¼

â€Œ**Size**â€Œ

Vector3

æ§åˆ¶æŠ•å½±ä½“ç§¯å°ºå¯¸

(2,2,2)

â€Œ**Fade Factor**â€Œ

Float \[0-1\]

è¾¹ç¼˜æ¸å˜å¼ºåº¦

0.8

â€Œ**Draw Distance**â€Œ

Float

æ¸²æŸ“è·ç¦»é˜ˆå€¼

20

â€Œ**Start Fade**â€Œ

Float

å¼€å§‹æ·¡å‡ºçš„è·ç¦»

15

â€Œ**Angle Fade**â€Œ

Vector2

åŸºäºè¡¨é¢è§’åº¦çš„æ·¡å‡º

(0.5,0.8)

â€Œ**Affects Transparent**â€Œ

Bool

æ˜¯å¦å½±å“é€æ˜è¡¨é¢

False

**æ¡ˆä¾‹ï¼šå¼¹å­”æ•ˆæœ**
===========

*   â€Œ**æè´¨å‡†å¤‡**â€Œï¼š
    
    *   ä½¿ç”¨8Kæ‰«æçš„å¼¹å­”è´´å›¾ï¼ˆQuixel Megascansï¼‰
    *   æ³•çº¿è´´å›¾å¢å¼ºç«‹ä½“æ„Ÿ
*   â€Œ**åŠ¨æ€ç”Ÿæˆ**â€Œï¼š
    
        csharp
        void CreateBulletHole(Vector3 hitPoint, Vector3 normal) {
            var decal = new GameObject("BulletHole");
            var projector = decal.AddComponent<DecalProjector>();
            projector.material = bulletHoleMaterial;
            decal.transform.position = hitPoint + normal * 0.1f;
            decal.transform.rotation = Quaternion.LookRotation(-normal);
        }
        
    
*   â€Œ**æ€§èƒ½ä¼˜åŒ–**â€Œï¼š
    
    *   ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†Decalå®ä¾‹
    *   è®¾ç½®åˆç†çš„Draw Distanceé¿å…è¿‡åº¦æ¸²æŸ“

**æ³¨æ„äº‹é¡¹**
========

*   â€Œ**æ·±åº¦å†²çª**â€Œï¼šé€‚å½“è°ƒæ•´Projectorçš„Offsetå‚æ•°ï¼ˆå»ºè®®0.05-0.1ï¼‰
*   â€Œ**ç§»åŠ¨å¹³å°**â€Œï¼šéœ€æµ‹è¯•ES3.0è®¾å¤‡å…¼å®¹æ€§ï¼Œå¿…è¦æ—¶é™ä½è´´å›¾åˆ†è¾¨ç‡
*   â€Œ**é€æ˜è¡¨é¢**â€Œï¼šé»˜è®¤ä¸æ”¯æŒé€æ˜ç‰©ä½“æ¥æ”¶Decalï¼Œéœ€ç‰¹æ®ŠShaderå¤„ç†

* * *

> [ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘](https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&sharetype=blogcolumn&sharerId=13021255&sharerefer=PC&sharesource=chenghai37&sharefrom=from_link)**ä¸“æ -ç›´è¾¾**  
> ï¼ˆæ¬¢è¿_ç‚¹èµç•™è¨€_æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰