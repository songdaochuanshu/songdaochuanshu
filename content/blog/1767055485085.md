---
layout: post
title: 'CodeSpirit å¼€å‘ç¯å¢ƒæ­å»ºåŠå¯åŠ¨æŒ‡å—'
date: "2025-12-30T00:44:45Z"
---
CodeSpirit å¼€å‘ç¯å¢ƒæ­å»ºåŠå¯åŠ¨æŒ‡å—
======================

æ¦‚è¿°
--

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿæ­å»ºCodeSpiritï¼ˆç çµï¼‰ä½ä»£ç æ¡†æ¶çš„å¼€å‘ç¯å¢ƒã€‚CodeSpiritåŸºäº .NET 10 å’Œ Aspire 13.0 æ„å»ºï¼Œé€šè¿‡ç®€å•çš„å‡ ä¸ªæ­¥éª¤å³å¯å¯åŠ¨å®Œæ•´çš„å¼€å‘ç¯å¢ƒã€‚

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ22æ—¥  
**æ¡†æ¶ç‰ˆæœ¬**: v2.0.0  
![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224131727898-298580147.png)

å¿«é€Ÿå¼€å§‹
----

### å‰ç½®è¦æ±‚

*   **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 12+, æˆ– Linux (Ubuntu 20.04+)
*   **CPU**: Intel i5 æˆ– AMD Ryzen 5 åŠä»¥ä¸Šï¼ˆæ¨èi7/Ryzen 7ï¼‰
*   **å†…å­˜**: 16GB RAMï¼ˆæ¨è32GBï¼‰
*   **å­˜å‚¨**: è‡³å°‘20GBå¯ç”¨ç©ºé—´ï¼ˆSSDæ¨èï¼‰

> **æ³¨æ„**: CodeSpirité»˜è®¤ä½¿ç”¨GreptimeDBè¿›è¡Œå®¡è®¡æ—¥å¿—å­˜å‚¨å’Œæœç´¢ã€‚Elasticsearchä¸ºå¯é€‰ç»„ä»¶ï¼Œå¦‚éœ€ä½¿ç”¨è¯·å‚è€ƒç›¸å…³é…ç½®æ–‡æ¡£ã€‚

### 1\. å®‰è£… .NET 10 SDK

#### Windows

    # ä½¿ç”¨ winget å®‰è£…
    winget install Microsoft.DotNet.SDK.10
    
    # æˆ–ä¸‹è½½å®‰è£…åŒ…
    # https://dotnet.microsoft.com/download/dotnet/10.0
    

#### macOS

    # ä½¿ç”¨ Homebrew
    brew install --cask dotnet-sdk
    
    # æˆ–ä¸‹è½½å®‰è£…åŒ…
    # https://dotnet.microsoft.com/download/dotnet/10.0
    

#### Linux (Ubuntu)

    # æ·»åŠ å¾®è½¯åŒ…æº
    wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
    sudo dpkg -i packages-microsoft-prod.deb
    sudo apt-get update
    sudo apt-get install -y dotnet-sdk-10.0
    

#### éªŒè¯å®‰è£…

    dotnet --version
    # åº”æ˜¾ç¤º 10.x.x
    

### 2\. å®‰è£…å¼€å‘å·¥å…·

#### Visual Studio 2026 (æ¨è)

*   ä¸‹è½½åœ°å€: [https://visualstudio.microsoft.com/vs/](https://visualstudio.microsoft.com/vs/)
*   é€‰æ‹©å·¥ä½œè´Ÿè½½ï¼š**ASP.NET å’Œ Web å¼€å‘**

#### æˆ–è€… Visual Studio Code

    # Windows
    winget install Microsoft.VisualStudioCode
    
    # macOS
    brew install --cask visual-studio-code
    
    # Linux
    sudo snap install code --classic
    

VS Codeå¿…éœ€æ‰©å±•ï¼š

    code --install-extension ms-dotnettools.csharp
    code --install-extension ms-dotnettools.vscode-dotnet-runtime
    

### 3\. å®‰è£…Docker Desktop

*   ä¸‹è½½åœ°å€: [https://www.docker.com/products/docker-desktop](https://www.docker.com/products/docker-desktop)
*   å®‰è£…åå¯åŠ¨Docker Desktop

éªŒè¯å®‰è£…ï¼š

    docker --version
    

é¡¹ç›®å¯åŠ¨
----

### 1\. å…‹éš†é¡¹ç›®

    git clone https://gitee.com/magicodes/code-spirit.git
    cd code-spirit
    

### 2\. å¯åŠ¨åŸºç¡€æœåŠ¡

CodeSpiritä½¿ç”¨Aspireè‡ªåŠ¨ç®¡ç†æ‰€æœ‰ä¾èµ–æœåŠ¡ï¼Œæ— éœ€æ‰‹åŠ¨å¯åŠ¨Dockerå®¹å™¨ï¼š

    # Aspireä¼šè‡ªåŠ¨å¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š
    # - MySQL/SQL Server (æ ¹æ®é…ç½®é€‰æ‹©ï¼Œç«¯å£: 3306/1433)
    # - Redis (ç«¯å£: 6380)
    # - RabbitMQ (ç«¯å£: 5672, ç®¡ç†ç•Œé¢: 15672)
    # - GreptimeDB (ç«¯å£: 4000/4001)
    # - Seqæ—¥å¿—æœåŠ¡ (ç«¯å£: 5341)
    

> **æœåŠ¡è¯´æ˜**:
> 
> *   **MySQL/SQL Server**: ä¸»æ•°æ®åº“å­˜å‚¨ï¼ˆæ ¹æ®DatabaseTypeé…ç½®é€‰æ‹©ï¼‰
> *   **Redis**: ç¼“å­˜å’Œä¼šè¯å­˜å‚¨ï¼ˆç«¯å£: 6380ï¼‰
> *   **RabbitMQ**: æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼ˆç®¡ç†ç•Œé¢ç«¯å£: 15672ï¼‰
> *   **GreptimeDB**: æ—¶åºæ•°æ®åº“ï¼Œç”¨äºå®¡è®¡æ—¥å¿—å­˜å‚¨ï¼ˆHTTPç«¯å£: 4000, gRPCç«¯å£: 4001ï¼‰
> *   **Seq**: ç»“æ„åŒ–æ—¥å¿—æœåŠ¡ï¼ˆç«¯å£: 5341ï¼‰

### 3\. è¿è¡Œé¡¹ç›®

#### ä½¿ç”¨.NET Aspireï¼ˆæ¨èï¼‰

    # è¿›å…¥AppHosté¡¹ç›®ç›®å½•
    cd Src/CodeSpirit.AppHost
    
    # è¿è¡ŒAspireåº”ç”¨
    dotnet run
    

å¦‚æœæ˜¯æ­£å¸¸å¯åŠ¨ï¼Œå°†çœ‹åˆ°ä»¥ä¸‹ç¼¤çº·çš„æ§åˆ¶å°è¾“å‡ºï¼š

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224131931648-1820053723.png)

å¯åŠ¨åè®¿é—®ï¼š

*   **Aspire Dashboard**: [http://localhost:17109](http://localhost:17109)ï¼ˆè‡ªåŠ¨æ‰“å¼€ï¼‰
*   **Webåº”ç”¨**: [https://localhost:7120](https://localhost:7120)ï¼ˆå¯åŠ¨åæ˜¾ç¤ºå…·ä½“ç«¯å£ï¼‰

> **æ³¨æ„**:

> 1.  å®é™…ç«¯å£å·å¯èƒ½å› ç³»ç»Ÿé…ç½®è€Œå¼‚ï¼Œè¯·æŸ¥çœ‹Aspire Dashboardè·å–å‡†ç¡®çš„ç«¯å£ä¿¡æ¯ã€‚
> 2.  å¦‚ä½•ç™»å½•é¡µæ²¡æœ‰æ­£å¸¸å‘ˆç°ï¼Œè¯·æŒ‰ç…§ä¸‹é¢çš„å¿…å¡«å‚æ•°é…ç½®è¿›è¡Œé…ç½®ã€‚

#### æˆ–è€…ä½¿ç”¨Visual Studio

1.  æ‰“å¼€ `CodeSpirit.sln`
    
2.  è®¾ç½® `CodeSpirit.AppHost` ä¸ºå¯åŠ¨é¡¹ç›®
    
3.  æŒ‰ F5 è¿è¡Œ  
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224131917733-1101676572.png)  
    æ³¨æ„ï¼Œéœ€ç¡®ä¿ä»¥ä¸‹æœåŠ¡å‡æ­£å¸¸å¯åŠ¨ï¼š  
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224131931648-1820053723.png)
    

é¡¹ç›®ç»“æ„
----

CodeSpirité‡‡ç”¨Clean Architectureè®¾è®¡ï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

    CodeSpirit/
    â”œâ”€â”€ Src/
    â”‚   â”œâ”€â”€ ApiServices/                     # APIæœåŠ¡ï¼ˆè§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹ï¼‰
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.IdentityApi/      # èº«ä»½è®¤è¯API
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.ExamApi/          # è€ƒè¯•ç³»ç»ŸAPI  
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.MessagingApi/     # æ¶ˆæ¯æœåŠ¡API
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.ConfigCenter/    # é…ç½®ä¸­å¿ƒAPI
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.FileStorageApi/  # æ–‡ä»¶å­˜å‚¨API
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.SurveyApi/        # é—®å·è°ƒæŸ¥API
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.ApprovalApi/      # å®¡æ‰¹å·¥ä½œæµAPI
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.PathfinderApi/    # AIç›®æ ‡ç®¡ç†API
    â”‚   â”‚   â””â”€â”€ CodeSpirit.AiCardsApi/       # AIå¡ç‰‡API
    â”‚   â”œâ”€â”€ Components/                     # ç»„ä»¶åº“
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Aggregator/       # èšåˆå™¨ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.AiFormFill/       # AIè¡¨å•æ™ºèƒ½å¡«å……ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Amis/             # UIç”Ÿæˆå¼•æ“
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Authorization/    # æƒé™ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Audit/            # å®¡è®¡ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Caching/          # åˆ†å¸ƒå¼ç¼“å­˜ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Charts/           # æ™ºèƒ½å›¾è¡¨ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.ConfigCenter.Client/ # é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.LLM/              # å¤§è¯­è¨€æ¨¡å‹ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Messaging/        # æ¶ˆæ¯é˜Ÿåˆ—ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.MultiTenant/      # å¤šç§Ÿæˆ·ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Navigation/       # å¯¼èˆªç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.PdfGeneration/    # PDFç”Ÿæˆç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.ScheduledTasks/   # å®šæ—¶ä»»åŠ¡ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Settings/         # è®¾ç½®ç®¡ç†ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ CodeSpirit.Shared/           # ç»„ä»¶å…±äº«åº“
    â”‚   â”‚   â””â”€â”€ CodeSpirit.UdlCards/         # UDLå¡ç‰‡ç»„ä»¶
    â”‚   â”œâ”€â”€ CodeSpirit.AppHost/              # Aspireåº”ç”¨å®¿ä¸»
    â”‚   â”œâ”€â”€ CodeSpirit.Core/                 # æ ¸å¿ƒå®šä¹‰
    â”‚   â”œâ”€â”€ CodeSpirit.ServiceDefaults/      # æœåŠ¡é»˜è®¤é…ç½®
    â”‚   â”œâ”€â”€ CodeSpirit.Shared/               # å…¨å±€å…±äº«åº“
    â”‚   â””â”€â”€ CodeSpirit.Web/                  # Webå‰ç«¯é¡¹ç›®
    â”œâ”€â”€ Tests/                               # æµ‹è¯•é¡¹ç›®
    â”œâ”€â”€ Docs/                                # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ k8s/                                 # Kuberneteséƒ¨ç½²æ–‡ä»¶
    â””â”€â”€ CodeSpirit.sln                       # è§£å†³æ–¹æ¡ˆæ–‡ä»¶
    

é»˜è®¤é…ç½®
----

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹é»˜è®¤é…ç½®ï¼Œç”±.NET Aspireè‡ªåŠ¨ç®¡ç†ï¼š

### æ•°æ®åº“è¿æ¥

*   **æ•°æ®åº“ç±»å‹**: æ”¯æŒMySQLå’ŒSQL Serverä¸¤ç§æ•°æ®åº“ï¼ˆé€šè¿‡`DatabaseType`é…ç½®é€‰æ‹©ï¼‰
    
*   **MySQL**: ç«¯å£3306ï¼Œç”±Aspireè‡ªåŠ¨é…ç½®
    
    å¯ä»¥ä»èµ„æºé¢æ¿è®¿é—®ç®¡ç†UIï¼ˆphpmyadminï¼‰ï¼š  
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132002956-598129788.png)
    
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132042244-558588173.png)
    
*   **SQL Server**: ç«¯å£1433ï¼Œç”±Aspireè‡ªåŠ¨é…ç½®
    
*   **æ•°æ®åº“**: è‡ªåŠ¨åˆ›å»ºå’Œè¿ç§»
    
*   **è¿æ¥å­—ç¬¦ä¸²**: ç”±Aspireè‡ªåŠ¨ç®¡ç†
    

### ç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—

*   **Redis**: `localhost:6380`ï¼ˆå…·ä½“è§ç®¡ç†UIï¼‰
    
*   **RabbitMQ**: `localhost:5672` (ç®¡ç†ç•Œé¢: [http://localhost:15672](http://localhost:15672), ç”¨æˆ·å/å¯†ç : admin/Password123)
    
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132123458-1426760447.png)
    

### å…¶ä»–æœåŠ¡ç«¯å£

*   **GreptimeDB**:
    
    *   HTTPç«¯å£: `localhost:4000`
    *   gRPCç«¯å£: `localhost:4001`
    *   å¥åº·æ£€æŸ¥: [http://localhost:4000/health](http://localhost:4000/health)
*   **Seqæ—¥å¿—æœåŠ¡**: `localhost:5341`ï¼ˆå…·ä½“ç«¯å£è§èµ„æºé¢æ¿ï¼‰
    
    ![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132136208-2065968736.png)
    
*   **Redis Commander**: é€šè¿‡Aspire Dashboardè®¿é—®
    

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132147317-671812413.png)

å¿…å¡«å‚æ•°é…ç½®
------

CodeSpirit ä½¿ç”¨ .NET Aspire çš„å‚æ•°ç®¡ç†æœºåˆ¶æ¥é…ç½®æ•æ„Ÿä¿¡æ¯å’Œç¯å¢ƒç›¸å…³å‚æ•°ã€‚åœ¨é¦–æ¬¡å¯åŠ¨å‰ï¼Œæ‚¨éœ€è¦é…ç½®ä»¥ä¸‹å¿…å¡«å‚æ•°ã€‚æç¤ºUIå¦‚ä¸‹ï¼š  
![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132156259-1567610099.png)  
![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132203941-1321498621.png)

### å‚æ•°é…ç½®æ–¹å¼

Aspire æ”¯æŒä¸¤ç§å‚æ•°é…ç½®æ–¹å¼ï¼Œé…ç½®ç³»ç»Ÿä¼šæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§è¯»å–ï¼ˆé«˜ä¼˜å…ˆçº§ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§ï¼‰ï¼š

1.  **User Secrets**ï¼ˆå¼€å‘ç¯å¢ƒæ¨èï¼Œé¿å…æäº¤æ•æ„Ÿä¿¡æ¯åˆ°ä»£ç åº“ï¼‰
2.  **appsettings.json**ï¼ˆå¼€å‘ç¯å¢ƒå¤‡é€‰æ–¹æ¡ˆï¼‰

> **æç¤º**: å¯¹äºæ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ API å¯†é’¥ï¼‰ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ User Secretsï¼Œé¿å…å°†å¯†é’¥æäº¤åˆ°ä»£ç åº“ã€‚

### å¿…å¡«å‚æ•°åˆ—è¡¨

#### LLM é…ç½®å‚æ•°

ä»¥ä¸‹å‚æ•°ç”¨äºé…ç½®é€šç”¨ LLM æœåŠ¡ï¼ˆå¦‚ AI å¡ç‰‡ã€æ™ºèƒ½å®¡æ‰¹ç­‰åŠŸèƒ½ï¼‰ï¼š

å‚æ•°åç§°

è¯´æ˜

æ˜¯å¦å¿…å¡«

é»˜è®¤å€¼

`llm-ApiKey`

LLM APIå¯†é’¥

âœ… **å¿…å¡«**

æ— 

`llm-ApiBaseUrl`

LLM APIåŸºç¡€åœ°å€

å¯é€‰

`https://dashscope.aliyuncs.com/compatible-mode/v1`

`llm-ModelName`

LLMæ¨¡å‹åç§°

å¯é€‰

`qwen-flash`

`llm-TimeoutSeconds`

è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

å¯é€‰

`120`

`llm-MaxTokens`

æœ€å¤§Tokenæ•°

å¯é€‰

`2048`

`llm-UseProxy`

æ˜¯å¦ä½¿ç”¨ä»£ç†

å¯é€‰

`false`

`llm-ProxyAddress`

ä»£ç†åœ°å€

å¯é€‰

ç©ºå­—ç¬¦ä¸²

#### AIè¡¨å•å¡«å…… LLM é…ç½®å‚æ•°

ä»¥ä¸‹å‚æ•°ç”¨äºé…ç½® AI è¡¨å•æ™ºèƒ½å¡«å……åŠŸèƒ½ï¼š

å‚æ•°åç§°

è¯´æ˜

æ˜¯å¦å¿…å¡«

é»˜è®¤å€¼

`ai-form-fill-llm-ApiKey`

AIè¡¨å•å¡«å……LLM APIå¯†é’¥

âœ… **å¿…å¡«**

æ— 

`ai-form-fill-llm-ApiBaseUrl`

APIåŸºç¡€åœ°å€

å¯é€‰

`https://dashscope.aliyuncs.com/compatible-mode/v1`

`ai-form-fill-llm-ModelName`

æ¨¡å‹åç§°

å¯é€‰

`qwen3-max-preview`

`ai-form-fill-llm-DisableThinking`

ç¦ç”¨æ€è€ƒæ¨¡å¼

å¯é€‰

`true`

`ai-form-fill-llm-ResponseFormatType`

å“åº”æ ¼å¼ç±»å‹

å¯é€‰

`json_object`

`ai-form-fill-llm-Temperature`

æ¸©åº¦å‚æ•°

å¯é€‰

`0.1`

`ai-form-fill-llm-TopP`

TopPå‚æ•°

å¯é€‰

`0.9`

`ai-form-fill-llm-EnableStreaming`

å¯ç”¨æµå¼å“åº”

å¯é€‰

`true`

#### å…¶ä»–å¯é€‰å‚æ•°

ä»¥ä¸‹å‚æ•°å·²æœ‰é»˜è®¤å€¼ï¼Œé€šå¸¸æ— éœ€ä¿®æ”¹ï¼š

å‚æ•°åç§°

è¯´æ˜

é»˜è®¤å€¼

`jwt-SecretKey`

JWTå¯†é’¥

`ECBF8FA013844D77AE041A6800D7FF8F`

`jwt-Issuer`

JWTé¢å‘è€…

`codespirit.com`

`jwt-Audience`

JWTå—ä¼—

`CodeSpirit`

`mysql-password`

MySQLå¯†ç 

`Password123`

`sqlserver-password`

SQL Serverå¯†ç 

`P@ssword123456`

`rabbitmq-username`

RabbitMQç”¨æˆ·å

`admin`

`rabbitmq-password`

RabbitMQå¯†ç 

`Password123`

### é…ç½®æ–¹æ³•

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ User Secretsï¼ˆæ¨èå¼€å‘ç¯å¢ƒï¼‰

ä½¿ç”¨ .NET User Secrets å¯ä»¥å®‰å…¨åœ°å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œæ— éœ€æ‹…å¿ƒæäº¤åˆ°ä»£ç åº“ï¼š

    # è¿›å…¥ AppHost é¡¹ç›®ç›®å½•
    cd Src/CodeSpirit.AppHost
    
    # åˆå§‹åŒ– User Secretsï¼ˆå¦‚æœå°šæœªåˆå§‹åŒ–ï¼‰
    dotnet user-secrets init
    
    # è®¾ç½® LLM API å¯†é’¥
    dotnet user-secrets set "llm-ApiKey" "your-llm-api-key-here"
    
    # è®¾ç½® AI è¡¨å•å¡«å…… LLM API å¯†é’¥
    dotnet user-secrets set "ai-form-fill-llm-ApiKey" "your-ai-form-fill-llm-api-key-here"
    
    # æ¸…é™¤æ‰€æœ‰å¯†é’¥
    # dotnet user-secrets clear
    

#### æ–¹æ³•äºŒï¼šä½¿ç”¨ appsettings.jsonï¼ˆå¼€å‘ç¯å¢ƒå¤‡é€‰ï¼‰

ç¼–è¾‘ `Src/CodeSpirit.AppHost/appsettings.json` æ–‡ä»¶ï¼Œæ·»åŠ å‚æ•°é…ç½®ï¼š

    {
      "DatabaseType": "MySql",
      "Logging": {
        "LogLevel": {
          "Default": "Information",
          "Microsoft.AspNetCore": "Warning",
          "Aspire.Hosting.Dcp": "Warning"
        }
      },
      "llm-ApiKey": "your-llm-api-key-here",
      "ai-form-fill-llm-ApiKey": "your-ai-form-fill-llm-api-key-here"
    }
    

> **âš ï¸ é‡è¦æç¤º**:
> 
> *   å¦‚æœä½¿ç”¨ `appsettings.json` é…ç½®æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ç¡®ä¿è¯¥æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore` ä¸­
> *   æˆ–è€…åˆ›å»º `appsettings.Local.json` æ–‡ä»¶ï¼ˆè¯¥æ–‡ä»¶é»˜è®¤å·²åœ¨ `.gitignore` ä¸­ï¼‰ï¼Œé¿å…å°† API å¯†é’¥æäº¤åˆ°ä»£ç åº“
> *   **å¼ºçƒˆæ¨èä½¿ç”¨ User Secrets æ–¹å¼**ï¼Œæ›´å®‰å…¨ä¸”ä¸ä¼šè¯¯æäº¤

### è·å– API å¯†é’¥

#### é˜¿é‡Œäº‘é€šä¹‰åƒé—®ï¼ˆDashScopeï¼‰

å¼€å‘é˜¶æ®µå…è´¹é¢åº¦å®Œå…¨å¤Ÿç”¨ï¼š

1.  è®¿é—® [é˜¿é‡Œäº‘ DashScope](https://www.aliyun.com/benefit?userCode=nw99vwgt)
2.  æ³¨å†Œ/ç™»å½•è´¦å·
3.  åˆ›å»º API Key
4.  å°† API Key é…ç½®åˆ°ä¸Šè¿°å‚æ•°ä¸­

> ğŸ’¡ **æ¨èé˜…è¯»**ï¼š[é˜¿é‡Œäº‘é€šä¹‰åƒé—®å…è´¹ä½“éªŒæŒ‡å—](./%E9%98%BF%E9%87%8C%E4%BA%91%E9%80%9A%E4%B9%89%E5%8D%83%E9%97%AE%E5%85%8D%E8%B4%B9%E4%BD%93%E9%AA%8C%E6%8C%87%E5%8D%97.md) - è¯¦ç»†çš„æ³¨å†ŒæŒ‡å—ã€é…ç½®æ•™ç¨‹å’Œæˆæœ¬åˆ†æï¼Œå¸®åŠ©æ‚¨é›¶æˆæœ¬ä½“éªŒ CodeSpirit çš„å¼ºå¤§ AI èƒ½åŠ›ï¼

#### OpenAIï¼ˆå¦‚ä½¿ç”¨ OpenAI å…¼å®¹æ¥å£ï¼‰

å¦‚æœä½¿ç”¨ OpenAI å…¼å®¹çš„ API æœåŠ¡ï¼Œéœ€è¦ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š

ä½¿ç”¨ User Secrets é…ç½®ï¼š

    dotnet user-secrets set "llm-ApiBaseUrl" "https://api.openai.com/v1"
    dotnet user-secrets set "llm-ModelName" "gpt-4"
    dotnet user-secrets set "llm-ApiKey" "your-openai-api-key-here"
    

æˆ–ä½¿ç”¨ appsettings.json é…ç½®ï¼š

    {
      "llm-ApiBaseUrl": "https://api.openai.com/v1",
      "llm-ModelName": "gpt-4",
      "llm-ApiKey": "your-openai-api-key-here"
    }
    

### éªŒè¯å‚æ•°é…ç½®

å¯åŠ¨é¡¹ç›®åï¼Œå¦‚æœå‚æ•°é…ç½®ä¸æ­£ç¡®ï¼Œæ‚¨ä¼šåœ¨æ§åˆ¶å°æˆ– Aspire Dashboard ä¸­çœ‹åˆ°ç›¸å…³é”™è¯¯ä¿¡æ¯ã€‚ç¡®ä¿ä»¥ä¸‹æœåŠ¡èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨ï¼š

*   âœ… ConfigCenterï¼ˆé…ç½®ä¸­å¿ƒï¼‰- éœ€è¦ LLM å‚æ•°
*   âœ… Web å‰ç«¯ - éœ€è¦ AI è¡¨å•å¡«å…… LLM å‚æ•°

> **æç¤º**: å¦‚æœæš‚æ—¶ä¸éœ€è¦ä½¿ç”¨ AI åŠŸèƒ½ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªå ä½ç¬¦å€¼ï¼Œä½†æŸäº›ä¾èµ– AI çš„åŠŸèƒ½å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚

å¼€å‘å·¥å…·é…ç½®
------

### Visual Studio Code

åˆ›å»º `.vscode/launch.json`ï¼š

    {
      "version": "0.2.0",
      "configurations": [
        {
          "name": "Launch CodeSpirit",
          "type": "coreclr",
          "request": "launch",
          "preLaunchTask": "build",
          "program": "${workspaceFolder}/Src/CodeSpirit.AppHost/bin/Debug/net10.0/CodeSpirit.AppHost.dll",
          "cwd": "${workspaceFolder}/Src/CodeSpirit.AppHost",
          "env": {
            "ASPNETCORE_ENVIRONMENT": "Development"
          }
        }
      ]
    }
    

åˆ›å»º `.vscode/tasks.json`ï¼š

    {
      "version": "2.0.0",
      "tasks": [
        {
          "label": "build",
          "command": "dotnet",
          "type": "process",
          "args": ["build", "${workspaceFolder}/CodeSpirit.sln"],
          "problemMatcher": "$msCompile"
        }
      ]
    }
    

éªŒè¯å®‰è£…
----

### 1\. æ£€æŸ¥æœåŠ¡çŠ¶æ€

è®¿é—®Aspire Dashboard ([http://localhost:17109](http://localhost:17109)) ç¡®è®¤æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œï¼š

*   âœ… CodeSpirit.Web (Webå‰ç«¯)
*   âœ… CodeSpirit.IdentityApi (èº«ä»½è®¤è¯)
*   âœ… CodeSpirit.ConfigCenter (é…ç½®ä¸­å¿ƒ)
*   âœ… CodeSpirit.MessagingApi (æ¶ˆæ¯æœåŠ¡)
*   âœ… CodeSpirit.ExamApi (è€ƒè¯•ç³»ç»Ÿ)
*   âœ… CodeSpirit.FileStorageApi (æ–‡ä»¶å­˜å‚¨)
*   âœ… CodeSpirit.SurveyApi (é—®å·è°ƒæŸ¥)
*   âœ… CodeSpirit.ApprovalApi (å®¡æ‰¹æµç¨‹)
*   âœ… CodeSpirit.PathfinderApi (AIç›®æ ‡ç®¡ç†)
*   âœ… MySQL/SQL Server (æ•°æ®åº“ï¼Œæ ¹æ®é…ç½®)
*   âœ… Redis (ç¼“å­˜)
*   âœ… RabbitMQ (æ¶ˆæ¯é˜Ÿåˆ—)
*   âœ… GreptimeDB (æ—¶åºæ•°æ®åº“)
*   âœ… Seq (æ—¥å¿—æœåŠ¡)

### 2\. æ£€æŸ¥é”™è¯¯

æ‰“å¼€ç»“æ„åŒ–æ—¥å¿—é¢æ¿ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨é”™è¯¯ï¼š

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132237841-409615542.png)

### 3\. è®¿é—®Webç•Œé¢

ç³»ç»Ÿå¹³å°ï¼š[https://localhost:7120](https://localhost:7120)

è´¦å·ï¼šsystemadmin

å¯†ç ï¼šCodeSpirit@2025

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132247398-182230200.png)

ç™»å½•åå¯ä»¥çœ‹åˆ°ç³»ç»Ÿå¹³å°åå°ç®¡ç†UIï¼š

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132258347-1684698426.png)

ç§Ÿæˆ·å¹³å°ï¼ˆé»˜è®¤ç§Ÿæˆ·ï¼‰ï¼š[https://localhost:7120/default/login](https://localhost:7120/default/login)

è´¦å·ï¼šadmin

å¯†ç ï¼š123@Admin

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132312276-873776487.png)

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132320900-136012642.png)

å¸¸è§é—®é¢˜
----

### æ— æ³•æ‰“å¼€ç½‘é¡µ

ä¸€èˆ¬æ˜¯ä»¥ä¸‹æƒ…å†µå¯¼è‡´ï¼š

1.  é•œåƒæ— æ³•æ‹‰å–ï¼Œä¸€èˆ¬åœ¨dockeré¢æ¿æˆ–Aspireç®¡ç†é¢æ¿çš„æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°ã€‚å»ºè®®é…ç½®é•œåƒæºæˆ–è·¯ç”±ä¸Šç½‘ã€‚
    
2.  å…³é”®æœåŠ¡æ•…éšœï¼Œæ¯”å¦‚WebæœåŠ¡å‡ºç°æ•…éšœã€‚
    
3.  ç«¯å£å†²çªæˆ–ç½‘ç»œé”™è¯¯ï¼Œå…·ä½“å¯ä»¥çœ‹å¯åŠ¨æ§åˆ¶å°é”™è¯¯ï¼š
    

![image](https://img2024.cnblogs.com/blog/70544/202512/70544-20251224132339285-1584044125.png)

### ç«¯å£å†²çª

å¦‚æœé‡åˆ°ç«¯å£å†²çªï¼Œä¿®æ”¹ `Src/CodeSpirit.AppHost/Program.cs` ä¸­çš„ç«¯å£é…ç½®ã€‚

### DockeræœåŠ¡å¯åŠ¨å¤±è´¥

ç”±äºé¡¹ç›®ä½¿ç”¨.NET Aspireç®¡ç†æœåŠ¡ï¼Œå¦‚æœé‡åˆ°æœåŠ¡å¯åŠ¨é—®é¢˜ï¼š

    # é‡å¯Aspireåº”ç”¨
    cd Src/CodeSpirit.AppHost
    dotnet run --force
    
    # æŸ¥çœ‹Aspire Dashboardä¸­çš„æœåŠ¡çŠ¶æ€
    # è®¿é—® http://localhost:17109
    

### GreptimeDBå¯åŠ¨å¤±è´¥

    # åœ¨Aspire Dashboardä¸­æŸ¥çœ‹GreptimeDBçŠ¶æ€
    # å¦‚æœå†…å­˜ä¸è¶³ï¼Œå¯ä»¥åœ¨Program.csä¸­è°ƒæ•´GreptimeDBé…ç½®
    
    # æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
    # GreptimeDBéœ€è¦è‡³å°‘512MBå†…å­˜
    

### SSLè¯ä¹¦é—®é¢˜

    # ä¿¡ä»»å¼€å‘è¯ä¹¦
    dotnet dev-certs https --trust
    

### æ•°æ®åº“è¿æ¥é—®é¢˜

    # æ£€æŸ¥æ•°æ®åº“å®¹å™¨çŠ¶æ€ï¼ˆæ ¹æ®é…ç½®çš„æ•°æ®åº“ç±»å‹ï¼‰
    docker ps | grep mysql    # MySQL
    docker ps | grep sqlserver # SQL Server
    
    # é‡å¯æ•°æ®åº“å®¹å™¨
    docker restart mysql      # MySQL
    docker restart sqlserver  # SQL Server
    
    # æˆ–åœ¨Aspire Dashboardä¸­æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€å’Œè¿æ¥ä¿¡æ¯
    

### å†…å­˜ä¸è¶³é—®é¢˜

å¦‚æœç³»ç»Ÿå†…å­˜ä¸è¶³ï¼Œå¯ä»¥ï¼š

1.  å…³é—­ä¸å¿…è¦çš„åº”ç”¨ç¨‹åº
2.  è°ƒæ•´GreptimeDBå†…å­˜è®¾ç½®ï¼ˆåœ¨Program.csä¸­ï¼‰
3.  è€ƒè™‘å‡çº§ç³»ç»Ÿå†…å­˜åˆ°æ¨èé…ç½®ï¼ˆ16GBæ¨èï¼Œ32GBæ›´ä½³ï¼‰

### LLM API å¯†é’¥æœªé…ç½®

å¦‚æœå¯åŠ¨æ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯æˆ–æœåŠ¡æ— æ³•æ­£å¸¸å¯åŠ¨ï¼š

*   ConfigCenter æœåŠ¡å¯åŠ¨å¤±è´¥
*   Web å‰ç«¯æ— æ³•è®¿é—® AI åŠŸèƒ½
*   æ§åˆ¶å°æç¤ºç¼ºå°‘ LLM é…ç½®å‚æ•°

**è§£å†³æ–¹æ¡ˆ**ï¼š

1.  **æ£€æŸ¥å‚æ•°æ˜¯å¦å·²é…ç½®**ï¼š
    
        # æŸ¥çœ‹ User Secretsï¼ˆå¦‚æœä½¿ç”¨ï¼‰
        cd Src/CodeSpirit.AppHost
        dotnet user-secrets list
        
    
2.  **é…ç½®ç¼ºå¤±çš„å‚æ•°**ï¼š
    
    *   å‚è€ƒ [å¿…å¡«å‚æ•°é…ç½®](#%E5%BF%85%E5%A1%AB%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE) ç« èŠ‚
    *   ç¡®ä¿è‡³å°‘é…ç½®äº† `llm-ApiKey` å’Œ `ai-form-fill-llm-ApiKey` ä¸¤ä¸ªå¿…å¡«å‚æ•°
3.  **éªŒè¯é…ç½®**ï¼š
    
    *   é‡å¯åº”ç”¨åï¼Œæ£€æŸ¥ Aspire Dashboard ä¸­çš„æœåŠ¡çŠ¶æ€
    *   æŸ¥çœ‹æœåŠ¡æ—¥å¿—ç¡®è®¤å‚æ•°æ˜¯å¦æ­£ç¡®åŠ è½½

> **æç¤º**: å¦‚æœæš‚æ—¶ä¸éœ€è¦ä½¿ç”¨ AI åŠŸèƒ½ï¼Œå¯ä»¥è®¾ç½®å ä½ç¬¦å€¼ï¼ˆå¦‚ `placeholder-key`ï¼‰ï¼Œä½†ç›¸å…³ AI åŠŸèƒ½å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚

å¼€å‘æ¨¡å¼
----

### çƒ­é‡è½½å¼€å‘

    # å¯ç”¨çƒ­é‡è½½
    cd Src/CodeSpirit.AppHost
    dotnet watch run
    

### è°ƒè¯•æ¨¡å¼

åœ¨Visual Studioæˆ–VS Codeä¸­è®¾ç½®æ–­ç‚¹ï¼ŒæŒ‰F5å¯åŠ¨è°ƒè¯•ã€‚

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
------

### ä½¿ç”¨Kuberneteséƒ¨ç½²

é¡¹ç›®æä¾›äº†å®Œæ•´çš„Kuberneteséƒ¨ç½²æ–‡ä»¶ï¼š

    # éƒ¨ç½²åˆ°Kubernetesé›†ç¾¤
    kubectl apply -f k8s/
    
    # æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
    kubectl get pods -n code-spirit-release
    

### ä½¿ç”¨Dockeréƒ¨ç½²

    # æ„å»ºæ‰€æœ‰æœåŠ¡çš„Dockeré•œåƒ
    dotnet publish CodeSpirit.sln -c Release
    
    # ä½¿ç”¨é¡¹ç›®æä¾›çš„Dockerfileæ„å»ºé•œåƒ
    docker build -f Src/CodeSpirit.Web/Dockerfile -t codespirit-web:latest .
    docker build -f Src/CodeSpirit.IdentityApi/Dockerfile -t codespirit-identity:latest .
    

### é…ç½®ç®¡ç†

ç”Ÿäº§ç¯å¢ƒé…ç½®é€šè¿‡ä»¥ä¸‹æ–¹å¼ç®¡ç†ï¼š

*   **Kubernetes ConfigMap**: å­˜å‚¨åº”ç”¨é…ç½®
*   **Kubernetes Secret**: å­˜å‚¨æ•æ„Ÿä¿¡æ¯
*   **é…ç½®ä¸­å¿ƒ**: åŠ¨æ€é…ç½®ç®¡ç†

ä¸‹ä¸€æ­¥
---

ç¯å¢ƒæ­å»ºå®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š

1.  ğŸ“– é˜…è¯» [é¡¹ç›®æ•´ä½“æ¶æ„è®¾è®¡](./%E9%A1%B9%E7%9B%AE%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.md)
2.  ğŸ”§ äº†è§£ [CodeSpirit.Coreæ ¸å¿ƒæ¡†æ¶](./CodeSpirit.Core%E6%A0%B8%E5%BF%83%E6%A1%86%E6%9E%B6.md)
3.  ğŸ“‹ æŸ¥çœ‹ [æ€»ä½“æŠ€æœ¯ä½“ç³»è¯´æ˜](./%E6%80%BB%E4%BD%93%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E8%AF%B4%E6%98%8E.md)
4.  ğŸ” å­¦ä¹  [ç»Ÿä¸€å¼‚å¸¸å¤„ç†æŒ‡å—](./CodeSpirit%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%8C%87%E5%8D%97.md)
5.  ğŸ’» å‚è€ƒ [CRUDå¼€å‘ç¤ºä¾‹](./CRUD%E5%BC%80%E5%8F%91%E7%A4%BA%E4%BE%8B.md) å¼€å§‹å¼€å‘

è·å–å¸®åŠ©
----

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š

*   [GitHub Issues](https://github.com/your-org/code-spirit/issues)
*   [é¡¹ç›®Wiki](https://github.com/your-org/code-spirit/wiki)
*   [è®¨è®ºåŒº](https://github.com/your-org/code-spirit/discussions)

ç¥æ‚¨å¼€å‘æ„‰å¿«ï¼ğŸš€

ä½œè€…ï¼š[é›ªé›](http://www.cnblogs.com/codelove/)  
å‡ºå¤„ï¼š[http://www.cnblogs.com/codelove/](http://www.cnblogs.com/codelove/)  
å¦‚æœå–œæ¬¢ä½œè€…çš„æ–‡ç« ï¼Œè¯·å…³æ³¨ã€CodeSpirit-ç çµã€‘å…¬ä¼—å·ä»¥ä¾¿ç¬¬ä¸€æ—¶é—´è·å¾—æœ€æ–°å†…å®¹ã€‚æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…æ‰€æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„å¿…é¡»ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œä¸”åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡è¿æ¥ï¼Œå¦åˆ™ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ã€‚  
**é™å¬é¸Ÿè¯­èŠ±é¦™ï¼Œæ¼«èµäº‘å·äº‘èˆ’ã€‚**  
![](https://images.cnblogs.com/cnblogs_com/codelove/315887/o_251224070213_%E5%85%AC%E4%BC%97%E5%8F%B7.jpg)