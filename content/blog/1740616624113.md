---
layout: post
title: 'PowerShellå¼€å‘æ¸¸æˆ Â· æ‰“èœœèœ‚'
date: "2025-02-27T00:37:04Z"
---
PowerShellå¼€å‘æ¸¸æˆ Â· æ‰“èœœèœ‚
====================

![](https://img2024.cnblogs.com/blog/944545/202502/944545-20250226145922384-1676591952.gif)Â  Â Â ![](https://img2024.cnblogs.com/blog/944545/202502/944545-20250226145944103-1839006031.gif)

* * *

å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶éå¸¸æŠ½è±¡ç®€å•ï¼Œä½†æ˜¯åŸºç¡€æ¸¸æˆæ¡†æ¶å·²ç»æ­å»ºï¼Œæ¸¸æˆæœºåˆ¶å®Œå–„ï¼Œå°±ç¼ºç¾å·¥äº†ï¼Œå“ˆå“ˆ~~~~

**ã€é¦–å…ˆã€‘**

Powershellä¸æ˜¯ç”¨æ¥å¼€å‘æ¸¸æˆçš„ï¼Œä½†æ˜¯æ²¡äººè§„å®šä¸èƒ½å¼€å‘ã€‚å› ä¸ºå®ƒå¯ä»¥è°ƒå–windowsä¸‹çš„ç¨‹åºé›†ï¼Œæ¯”å¦‚ .net frameworkã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥çŒœæƒ³ï¼Œåªè¦èƒ½å¼€å¯ä¸€ä¸ªå®æ—¶åˆ·æ–°çš„çª—å£ï¼Œå°±å¯ä»¥åœ¨çª—å£å†…ç»˜åˆ¶å›¾å½¢å’Œæ–‡å­—ã€‚è‡³äºå®æ—¶åˆ·æ–°çš„çª—å£å¦‚ä½•å®ç°ï¼Œåˆ™éœ€è¦è°ƒå–ç¨‹åºé›†ï¼Œå¦‚ä¸‹:

    Add-Type -AssemblyName System.Drawing
    Add-Type -AssemblyName System.Windows.Forms

Drawing è´Ÿè´£ç»˜åˆ¶ä»»åŠ¡

WindowsFormè´Ÿè´£ç®¡ç†çª—å£

ç„¶åå…³é”®çš„æ“ä½œæ˜¯ï¼Œè®¾è®¡ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè®©å…¶ä¸æ–­åœ°è§¦å‘ï¼Œä¸æ–­åœ°è®©å…¶ç»˜åˆ¶æ–°çš„å›¾å½¢ã€‚

    # å®šæ—¶å™¨ç”¨äºæ§åˆ¶æ¸¸æˆæ›´æ–°ï¼Œæ¯ç§’è§¦å‘ 60 æ¬¡ï¼ˆçº¦ 16.67 æ¯«ç§’ï¼‰
    $timer = New-Object System.Windows.Forms.Timer
    $timer.Interval = 16.67

Â ç„¶åè®¾è®¡å®šæ—¶å™¨è§¦å‘äº‹ä»¶

    $timer.Add_Tick({
      //  ...
    })

åœ¨å®šæ—¶å™¨è§¦å‘äº‹ä»¶ä¸­å†™ä¸Šè¿™å¥ï¼š

    $form.Invalidate()

å³è®©æ¯æ¬¡è§¦å‘æ—¶ï¼Œè®©çª—ä½“é‡æ–°paintä¸€æ¬¡ï¼Œå› æ­¤ï¼Œéœ€è¦å®šä¹‰çª—ä½“çš„ Paint äº‹ä»¶å¤„ç†ç¨‹åº

    $form.Add_Paint({
        // ...
    })

å‰©ä¸‹çš„å°±æ˜¯äº¤äº’åŠ¨ç”»è®¾è®¡åŸºç¡€äº†ï¼Œä¸‰éƒ¨æ›² ã€åˆå§‹åŒ– - æ›´æ–° - ç»˜ç”»ã€‘

**ã€ç¨‹åºã€‘**

    # åŠ è½½å¿…è¦çš„ç¨‹åºé›†
    Add-Type -AssemblyName System.Drawing
    Add-Type -AssemblyName System.Windows.Forms
    
    # åˆ›å»ºçª—ä½“
    $form = New-Object System.Windows.Forms.Form
    $form.Text = "æ‰“èœœèœ‚å°æ¸¸æˆ"
    $form.Size = New-Object System.Drawing.Size(800, 600)
    $form.BackColor = [System.Drawing.Color]::Black
    $form.StartPosition = "CenterScreen"
    $form.KeyPreview = $true
    
    # å¯ç”¨åŒç¼“å†²ä»¥å‡å°‘é—ªçƒ
    $doubleBufferProperty = $form.GetType().GetProperty("DoubleBuffered", [System.Reflection.BindingFlags]::NonPublic -bor [System.Reflection.BindingFlags]::Instance)
    $doubleBufferProperty.SetValue($form, $true, $null)
    
    # å®šä¹‰é£æœº
    $planeWidth = 50
    $planeHeight = 30
    $planeX = ($form.ClientSize.Width - $planeWidth) / 2
    $planeY = $form.ClientSize.Height - $planeHeight - 10
    
    # å®šä¹‰èœœèœ‚
    $beeSize = 40
    $bees = New-Object System.Collections.Generic.List[object]
    $beeFallSpeed = 0.5
    
    # å®šä¹‰å­å¼¹
    $bulletSize = 5
    $bullets = New-Object System.Collections.Generic.List[object]
    $bulletSpeed = 10
    
    # å®šä¹‰è®¡åˆ†æ¿ï¼Œåˆå§‹åˆ†æ•°è®¾ä¸º 100
    $score = 100
    $font = New-Object System.Drawing.Font("Arial", 20)
    $brush = New-Object System.Drawing.SolidBrush([System.Drawing.Color]::White)
    
    # å®šæ—¶å™¨ç”¨äºæ§åˆ¶æ¸¸æˆæ›´æ–°ï¼Œæ¯ç§’è§¦å‘ 60 æ¬¡ï¼ˆçº¦ 16.67 æ¯«ç§’ï¼Œè®¾ä¸º 17 æ¯«ç§’ï¼‰
    $timer = New-Object System.Windows.Forms.Timer
    $timer.Interval = 17
    $beeSpawnCounter = 0
    
    # é‡ç½®æ¸¸æˆçš„å‡½æ•°
    function ResetGame {
        $script:planeX = ($form.ClientSize.Width - $planeWidth) / 2
        $script:bees.Clear()
        $script:bullets.Clear()
        $script:score = 100
        $script:beeSpawnCounter = 0
    }
    
    # å®šæ—¶å™¨çš„ Tick äº‹ä»¶å¤„ç†ç¨‹åº
    $timer.Add_Tick({
        param($sender, $e)
        try {
            $script:beeSpawnCounter++
            Write-Host "å®šæ—¶å™¨è§¦å‘ï¼Œå½“å‰è®¡æ•°: $beeSpawnCounter"  # è°ƒè¯•ä¿¡æ¯ï¼Œæ˜¾ç¤ºå®šæ—¶å™¨è§¦å‘åŠè®¡æ•°æƒ…å†µ
    
            # æ§åˆ¶èœœèœ‚æ¯ç§’ç”Ÿæˆ 1 åª
            if ($beeSpawnCounter % 60 -eq 0) {  # æ¯ç§’è§¦å‘ 60 æ¬¡ï¼Œæ¯ 60 æ¬¡ç”Ÿæˆ 1 åªèœœèœ‚
                $beeX = Get-Random -Minimum 0 -Maximum ($form.ClientSize.Width - $beeSize)
                $bees.Add(@{
                    X = $beeX
                    Y = 0
                })
                Write-Host "ç”Ÿæˆèœœèœ‚ï¼ŒX: $beeX, Y: 0"  # è°ƒè¯•ä¿¡æ¯ï¼Œæ˜¾ç¤ºèœœèœ‚ç”Ÿæˆä¿¡æ¯
            }
    
            # æ›´æ–°èœœèœ‚ä½ç½®
            for ($i = $bees.Count - 1; $i -ge 0; $i--) {
                $bee = $bees[$i]
                $bee.Y += $beeFallSpeed
                if ($bee.Y -ge $form.ClientSize.Height) {
                    $bees.RemoveAt($i)
                    # èœœèœ‚åˆ°è¾¾ç”»é¢åº•éƒ¨ï¼Œæ‰£ 10 åˆ†
                    $script:score = [Math]::Max(0, $score - 10)
                }
            }
    
            # æ›´æ–°å­å¼¹ä½ç½®
            for ($i = $bullets.Count - 1; $i -ge 0; $i--) {
                $bullet = $bullets[$i]
                $bullet.Y -= $bulletSpeed
                if ($bullet.Y -lt 0) {
                    $bullets.RemoveAt($i)
                }
            }
    
            # æ£€æŸ¥å­å¼¹æ˜¯å¦å‡»ä¸­èœœèœ‚
            for ($i = $bullets.Count - 1; $i -ge 0; $i--) {
                $bullet = $bullets[$i]
                for ($j = $bees.Count - 1; $j -ge 0; $j--) {
                    $bee = $bees[$j]
                    if ($bullet.X -lt $bee.X + $beeSize -and $bullet.X + $bulletSize -gt $bee.X -and
                        $bullet.Y -lt $bee.Y + $beeSize -and $bullet.Y + $bulletSize -gt $bee.Y) {
                        $bees.RemoveAt($j)
                        $bullets.RemoveAt($i)
                        break
                    }
                }
            }
    
            # æ£€æŸ¥èœœèœ‚æ˜¯å¦ç¢°æ’åˆ°é£æœºï¼ˆä¸åšå¾—åˆ†å’Œæ¶ˆå¤±å¤„ç†ï¼‰
            foreach ($bee in $bees) {
                if ($bee.Y + $beeSize -ge $planeY -and $bee.X + $beeSize -ge $planeX -and $bee.X -le $planeX + $planeWidth) {
                    # ä¸åšä»»ä½•å¤„ç†ï¼Œèœœèœ‚ç»§ç»­ä¸‹è½
                }
            }
    
            # æ£€æŸ¥åˆ†æ•°æ˜¯å¦ä¸º 0ï¼Œä¸º 0 åˆ™é‡ç½®æ¸¸æˆ
            if ($score -eq 0) {
                ResetGame
            }
    
            $form.Invalidate()
        }
        catch {
            Write-Host "å®šæ—¶å™¨ Tick äº‹ä»¶å¤„ç†å‡ºé”™: $_"
            Write-Host $_.ScriptStackTrace
        }
    })
    
    # çª—ä½“çš„ MouseMove äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç”¨äºé€šè¿‡é¼ æ ‡æ§åˆ¶é£æœºä½ç½®
    $form.Add_MouseMove({
        param($sender, $e)
        $newX = $e.X - $planeWidth / 2
        if ($newX -ge 0 -and $newX + $planeWidth -le $form.ClientSize.Width) {
            $script:planeX = $newX
        }
    })
    
    # çª—ä½“çš„ MouseClick äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç”¨äºé€šè¿‡é¼ æ ‡ç‚¹å‡»å‘å°„å­å¼¹
    $form.Add_MouseClick({
        param($sender, $e)
        $bullets.Add(@{
            X = $planeX + $planeWidth / 2 - $bulletSize / 2
            Y = $planeY
        })
    })
    
    # çª—ä½“çš„ Paint äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç”¨äºç»˜åˆ¶æ¸¸æˆå…ƒç´ 
    $form.Add_Paint({
        param($sender, $e)
        $graphics = $e.Graphics
    
        # ç»˜åˆ¶é£æœº
        $graphics.FillRectangle([System.Drawing.Brushes]::Blue, $planeX, $planeY, $planeWidth, $planeHeight)
    
        # ç»˜åˆ¶èœœèœ‚
        foreach ($bee in $bees) {
            $graphics.FillEllipse([System.Drawing.Brushes]::Yellow, $bee.X, $bee.Y, $beeSize, $beeSize)
        }
    
        # ç»˜åˆ¶å­å¼¹
        foreach ($bullet in $bullets) {
            $graphics.FillRectangle([System.Drawing.Brushes]::Red, $bullet.X, $bullet.Y, $bulletSize, $bulletSize)
        }
    
        # ç»˜åˆ¶è®¡åˆ†æ¿
        $graphics.DrawString("Score: $score", $font, $brush, 10, 10)
    })
    
    # çª—ä½“å…³é—­äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç”¨äºæ¸…ç©ºæ•°æ®ç¼“å­˜
    $form.Add_FormClosing({
        param($sender, $e)
        ResetGame
        Write-Host "æ•°æ®ç¼“å­˜å·²æ¸…ç©º"
    })
    
    # å¯åŠ¨å®šæ—¶å™¨
    $timer.Start()
    
    # æ˜¾ç¤ºçª—ä½“
    $form.ShowDialog()

**PS**:

æ³¨æ„ç¨‹åºå¥å£®æ€§ï¼Œæ·»åŠ å¼‚å¸¸æ•è·ï¼Œæ³¨æ„æ•°æ®çš„å†—ä½™ï¼Œå³æ—¶æ¸…ç©ºæ¶ˆé™¤ã€‚

**ã€æœ€åã€‘**

å¯ä»¥çœ‹åˆ°ï¼ŒPowershellå¯ä»¥å¼€å‘æ¸¸æˆï¼Œè¿™åªæ˜¯è±¡å¾æ€§å°è¯•ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…³æ³¨å®ƒæ“…é•¿çš„é¢†åŸŸã€‚ä¸è¿‡ï¼Œè¿™æ¬¡å°è¯•è®©ç¬”è€…å¾ˆå¼€å¿ƒï¼Œå› ä¸ºå³ä½¿ä¸å€ŸåŠ©ä»»ä½•è½¯ä»¶æˆ–ç¨‹åºå¼€å‘æ¡†æ¶ä¹Ÿèƒ½å¼€å‘åº”ç”¨ï¼Œæƒ³æƒ³å°±å¾ˆé…· ğŸ˜ï¼~ï¼Â·Â·Â· Â·Â·Â·