---
layout: post
title: '[python] åŸºäºpython-docxåº“çš„Wordæ–‡æ¡£è‡ªåŠ¨å¤„ç†å…¨è§£'
date: "2026-01-14T00:47:34Z"
---
\[python\] åŸºäºpython-docxåº“çš„Wordæ–‡æ¡£è‡ªåŠ¨å¤„ç†å…¨è§£
======================================

python-docxæ˜¯ä¸€æ¬¾çº¯Pythonå®ç°çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä¸“é—¨ç”¨äºåˆ›å»ºå’Œä¿®æ”¹Microsoft Wordçš„.docxæ ¼å¼æ–‡æ¡£ã€‚è¯¥åº“æ— éœ€ä¾èµ– Microsoft Wordè½¯ä»¶å³å¯è¿è¡Œï¼Œå…·å¤‡ä¼˜ç§€çš„è·¨å¹³å°ç‰¹æ€§ï¼Œå¯åœ¨Windowsã€Macã€Linuxç­‰ç³»ç»Ÿä¸Šä½¿ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpython-docxä»…å…¼å®¹.docx æ ¼å¼ï¼ˆå¯¹åº” Word 2007 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ï¼Œä¸æ”¯æŒæ—§ç‰ˆçš„.doc æ ¼å¼æ–‡ä»¶ã€‚.docxæ˜¯åŸºäºXMLçš„å¼€æ”¾å‹ç¼©æ ¼å¼ï¼Œè€Œ.docæ˜¯äºŒè¿›åˆ¶ç§æœ‰æ ¼å¼ï¼Œå‰è€…ä½“ç§¯æ›´å°ã€å…¼å®¹æ€§æ›´ä¼˜ã€‚

python-docxå®˜æ–¹ä»£ç ä»“åº“è§ï¼š[python-docx](https://github.com/python-openxml/python-docx)ï¼Œè¯¦ç»†æ–‡æ¡£è§ï¼š[python-docx docs](https://python-docx.readthedocs.io/en/latest/)ã€‚æˆªè‡³æœ¬æ–‡æ’°å†™æ—¶ï¼Œpython-docxçš„ç¨³å®šç‰ˆæœ¬ä¸º1.2.0ï¼Œpython-docxå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š

> pip install python-docx

ç›®å½•

*   [1 ä½¿ç”¨è¯´æ˜](#1-ä½¿ç”¨è¯´æ˜)
    *   [1.1 å¿«é€Ÿå…¥é—¨](#11-å¿«é€Ÿå…¥é—¨)
    *   [1.2 Python-docxçš„æ ¸å¿ƒå¯¹è±¡](#12-python-docxçš„æ ¸å¿ƒå¯¹è±¡)
        *   [1.2.1 Documentå¯¹è±¡](#121-documentå¯¹è±¡)
        *   [1.2.2 Tableå¯¹è±¡](#122-tableå¯¹è±¡)
        *   [1.2.3 æ–‡æœ¬å¤„ç†](#123-æ–‡æœ¬å¤„ç†)
        *   [1.2.4 Sectionså¯¹è±¡](#124-sectionså¯¹è±¡)
        *   [1.2.5 é¡µçœ‰é¡µè„šå¯¹è±¡](#125-é¡µçœ‰é¡µè„šå¯¹è±¡)
    *   [1.3 éæ–‡æœ¬å†…å®¹ç®¡ç†](#13-éæ–‡æœ¬å†…å®¹ç®¡ç†)
        *   [1.3.1 æ ·å¼ç®¡ç†](#131-æ ·å¼ç®¡ç†)
        *   [1.3.2 æ‰¹æ³¨ç®¡ç†](#132-æ‰¹æ³¨ç®¡ç†)
        *   [1.3.3 å›¾ç‰‡å¯¹è±¡](#133-å›¾ç‰‡å¯¹è±¡)
    *   [1.4 ç»¼åˆç¤ºä¾‹](#14-ç»¼åˆç¤ºä¾‹)
*   [2 å‚è€ƒ](#2-å‚è€ƒ)

1 ä½¿ç”¨è¯´æ˜
======

1.1 å¿«é€Ÿå…¥é—¨
--------

Python-docxä¸­çš„Wordæ–‡æ¡£å†…å­˜å¯¹è±¡æ¨¡å‹é‡‡ç”¨æ ‘çŠ¶ç»“æ„åˆ†å±‚æ˜ å°„æ–‡æ¡£å…ƒç´ ï¼Œä½¿å¾—ç¨‹åºèƒ½å¤Ÿç²¾å‡†æ§åˆ¶æ–‡æ¡£çš„å†…å®¹ã€æ ¼å¼ä¸å¸ƒå±€ã€‚è¯¥æ ‘çŠ¶ç»“æ„ç¤ºæ„å¦‚ä¸‹ï¼š

    Documentï¼ˆæ–‡æ¡£ï¼‰
    â”œâ”€â”€ Sectionsï¼ˆèŠ‚ï¼‰
    â”œâ”€â”€ Paragraphsï¼ˆæ®µè½ï¼‰
    â”‚   â”œâ”€â”€ Runsï¼ˆæ–‡æœ¬ç‰‡æ®µï¼‰
    â”‚   â””â”€â”€ InlineShapesï¼ˆå†…è”å½¢çŠ¶ï¼Œå¦‚å›¾ç‰‡ï¼‰
    â”œâ”€â”€ Tablesï¼ˆè¡¨æ ¼ï¼‰
    â”‚   â”œâ”€â”€ Rowsï¼ˆè¡Œï¼‰
    â”‚   â”‚   â””â”€â”€ Cellsï¼ˆå•å…ƒæ ¼ï¼‰
    â”‚   â”‚       â””â”€â”€ Paragraphsï¼ˆå•å…ƒæ ¼å†…çš„æ®µè½ï¼‰
    â””â”€â”€ Core Propertiesï¼ˆæ–‡æ¡£å±æ€§ï¼‰
    

å„ä¸ªå¯¹è±¡ç®€ä»‹å¦‚ä¸‹ï¼š

æ ¸å¿ƒå¯¹è±¡

ä»£è¡¨å«ä¹‰

åœ¨æ–‡æ¡£æ ‘ä¸­çš„ä½ç½®

ä¸»è¦åŠŸèƒ½ä¸è¯´æ˜

`Document`

æ•´ä¸ªWordæ–‡æ¡£å¯¹è±¡

æ ¹å¯¹è±¡

ç”¨äºæ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ª`.docx`æ–‡ä»¶

`Sections`

æ–‡æ¡£çš„èŠ‚

`Document.sections`

ç®¡ç†é¡µé¢è®¾ç½®ï¼ˆå¦‚é¡µè¾¹è·ã€çº¸å¼ æ–¹å‘ï¼‰

`Paragraph`

æ®µè½

`Document.paragraphs`æˆ–`Table.cell.paragraphs`

æ–‡æ¡£çš„åŸºæœ¬å•å…ƒç”±ä¸€ä¸ªæˆ–å¤šä¸ª`Run`ç»„æˆï¼Œå¹¶æ‹¥æœ‰ç»Ÿä¸€çš„æ®µè½æ ¼å¼

`Run`

å…·æœ‰ç›¸åŒæ ¼å¼çš„è¿ç»­æ–‡æœ¬

`Paragraph.runs`

æ ¼å¼æ§åˆ¶çš„æœ€å°å•ä½ï¼Œå¯ä»¥å¯¹`Run`å•ç‹¬è®¾ç½®å­—ä½“ã€å¤§å°ç­‰å­—ç¬¦çº§æ ¼å¼

`Table`

è¡¨æ ¼

`Document.tables`

ä»£è¡¨æ–‡æ¡£ä¸­çš„ä¸€ä¸ªè¡¨æ ¼ï¼Œç”±è¡Œï¼ˆ`Table.rows`ï¼‰ã€åˆ—ï¼ˆ`Table.columns`ï¼‰å’Œå•å…ƒæ ¼ï¼ˆ`Table.cell`ï¼‰ç»„æˆ

`Cell`

è¡¨æ ¼å•å…ƒæ ¼

`Table.cell(row,col)`

æ¯ä¸ª`Cell`æœ¬èº«å¯ä»¥åŒ…å«å¤šä¸ª`Paragraph`ï¼Œå°±åƒä¸€ä¸ªå¾®ç¼©æ–‡æ¡£

`InlineShape`

å†…åµŒå½¢çŠ¶ï¼ˆå¦‚å›¾ç‰‡ï¼‰

`Paragraph.add_picture()`åˆ›å»º

ä»£è¡¨æ–‡æ¡£ä¸­ä¸æ–‡æœ¬åœ¨åŒä¸€å±‚çš„å›¾å½¢å¯¹è±¡ï¼Œæœ€å¸¸ç”¨çš„æ˜¯å›¾ç‰‡

`Styles`

æ ·å¼é›†åˆ

`Document.styles`

ç®¡ç†æ–‡æ¡£ä¸­å®šä¹‰çš„æ‰€æœ‰æ ·å¼ï¼ˆå¦‚â€œæ ‡é¢˜1â€ã€â€œæ­£æ–‡â€ç­‰ï¼‰

![](https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/1.jpg)

ä»¥ä¸‹ä»£ç ç¤ºä¾‹æè¿°äº†å¦‚ä½•é€šè¿‡python-docxåº“å¿«é€Ÿå®ç°æ–‡æ¡£çš„åˆ›å»ºï¼Œå®Œæˆæ®µè½ã€æ ‡é¢˜ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰å†…å®¹æ·»åŠ åŠå­—ç¬¦æ®µè½æ ·å¼è®¾ç½®ï¼Œå¹¶ä¿å­˜ä¸ºdocxæ–‡ä»¶ï¼š

    # 1. åˆå§‹åŒ–æ–‡æ¡£
    from docx import Document
    from docx.shared import Inches, Cm
    
    # æ–°å»ºç©ºç™½æ–‡æ¡£ï¼Œä¸æ·»åŠ å‚æ•°ï¼Œé»˜è®¤æ–°å»º
    doc = Document()  
    
    # 2. æ·»åŠ æ®µè½
    # é»˜è®¤éƒ½ä¼šæŠŠå†…å®¹è¿½åŠ åˆ°æ–‡æ¡£çš„æœ«å°¾
    doc.add_paragraph("è¿™æ˜¯æ–‡æ¡£æ­£æ–‡æ®µè½")  # ç›´æ¥æ·»åŠ æ®µè½
    para = doc.add_paragraph("ä¸»æ®µè½") # è¯¥æ–¹æ³•è¿”å›æ–°æ®µè½çš„å¼•ç”¨å¯¹è±¡
    para.insert_paragraph_before("æ’å…¥åœ¨ä¸»æ®µè½ä¸Šæ–¹çš„æ®µè½")  # ä¸»æ®µè½çš„å¼•ç”¨ä¹‹å‰æ’å…¥æ®µè½
    para = doc.add_paragraph("æ’å…¥åœ¨ä¸»æ®µè½ä¸‹æ–¹çš„æ®µè½") # ä¸»æ®µè½çš„å¼•ç”¨ä¹‹åæ’å…¥æ®µè½
    
    # 3. æ·»åŠ æ ‡é¢˜ï¼ˆçº§åˆ«1-9ï¼Œ0ä¸ºæ–‡æ¡£æ ‡é¢˜ï¼‰
    doc.add_heading("æ–‡æ¡£æ€»æ ‡é¢˜", level=0) # ä¸€ä»½æŠ¥å‘Šçš„å°é¢æ ‡é¢˜
    doc.add_heading("ç¬¬ä¸€ç«  æ¦‚è¿°", level=1) # ä¸€çº§æ ‡é¢˜
    doc.add_heading("1.1 æ ¸å¿ƒåŠŸèƒ½", level=2) # äºŒçº§æ ‡é¢˜
    
    # 4. åˆ†é¡µç¬¦
    doc.add_page_break()  # å¼ºåˆ¶åç»­å†…å®¹å¦èµ·ä¸€é¡µ
    
    # 5. æ·»åŠ è¡¨æ ¼ï¼ˆå›ºå®šè¡Œ+åŠ¨æ€è¡Œ+æ ·å¼ï¼‰
    # 5.1 å›ºå®šè¡¨æ ¼ï¼ˆ2è¡Œ2åˆ—ï¼‰
    table1 = doc.add_table(rows=2, cols=2)
    table1.cell(0, 0).text = "å§“å"
    table1.cell(0, 1).text = "å¹´é¾„"
    table1.cell(1, 0).text = "å¼ ä¸‰"
    table1.cell(1, 1).text = "25"
    
    # 5.2 åŠ¨æ€è¡¨æ ¼ï¼ˆè¡¨å¤´+æ•°æ®è¡Œï¼‰
    table2 = doc.add_table(rows=1, cols=3)
    # å°†é¼ æ ‡æ‚¬åœåœ¨Wordè¡¨æ ¼æ ·å¼åº“ä¸­çš„è¡¨æ ¼æ ·å¼ç¼©ç•¥å›¾ä¸Šï¼Œå³å¯æ‰¾åˆ°è¡¨æ ¼æ ·å¼åç§°
    table2.style = "Light Shading Accent 1"  # åº”ç”¨é¢„è®¾æ ·å¼
    headers = ["æ•°é‡", "äº§å“ç¼–å·", "æè¿°"]
    for i, header in enumerate(headers):
        table2.rows[0].cells[i].text = header
    # æ‰¹é‡æ·»åŠ æ•°æ®
    items = [(7, "1024", "æ¯›ç»’å°çŒ«"), (3, "2042", "è²æ¯”ç²¾çµ"), (1, "1288", "è±ªåé¡¹åœˆ")]
    for item in items:
        row = table2.add_row().cells
        row[0].text = str(item[0])
        row[1].text = item[1]
        row[2].text = item[2]
    
    # 6. æ·»åŠ å›¾ç‰‡ï¼ˆæœ¬åœ°æ–‡ä»¶+å°ºå¯¸è°ƒæ•´ï¼‰
    doc.add_picture("test.png", width=Inches(1.5))  # 1.5è‹±å¯¸å®½ï¼ˆè‡ªåŠ¨ç­‰æ¯”ç¼©æ”¾ï¼‰
    doc.add_picture("test2.jpg", width=Cm(5),height=Cm(1))  # åŒæ—¶æŒ‡å®šå®½é«˜
    
    # 7. æ®µè½æ ·å¼ï¼ˆé¡¹ç›®ç¬¦å·/ç¼–å·ï¼‰
    doc.add_paragraph("é¡¹ç›®ç¬¦å·åˆ—è¡¨é¡¹1", style="ListBullet")
    doc.add_paragraph("é¡¹ç›®ç¬¦å·åˆ—è¡¨é¡¹2", style="ListBullet")
    doc.add_paragraph("ç¼–å·åˆ—è¡¨é¡¹1", style="ListNumber")
    
    # 8. å­—ç¬¦æ ¼å¼ï¼ˆç²—ä½“/æ–œä½“ï¼‰
    para = doc.add_paragraph()
    para.add_run("æ™®é€šæ–‡æœ¬ ").bold = False
    para.add_run("ç²—ä½“æ–‡æœ¬").bold = True
    para.add_run(" æ™®é€šæ–‡æœ¬ ").italic = False
    para.add_run("æ–œä½“æ–‡æœ¬").italic = True
    
    # 9. å­—ç¬¦æ ·å¼ï¼ˆé¢„è®¾æ ·å¼ï¼‰
    para2 = doc.add_paragraph("æ™®é€šæ–‡æœ¬ï¼Œ")
    para2.add_run("å¸¦å¼ºè°ƒçš„æ–‡æœ¬", style="Emphasis")  # åº”ç”¨"å¼ºè°ƒ"æ ·å¼
    
    # 10. ä¿å­˜æ–‡æ¡£
    doc.save("test_output.docx")
    

åç»­å†…å®¹å°†å¯¹python-docxçš„å„ä¸ªæ ¸å¿ƒå¯¹è±¡è¿›è¡Œå…·ä½“ä»‹ç»ã€‚

1.2 Python-docxçš„æ ¸å¿ƒå¯¹è±¡
--------------------

### 1.2.1 Documentå¯¹è±¡

Python-docxæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ–‡æ¡£ä¿®æ”¹å·¥å…·ã€‚å³ä½¿åˆ›å»ºæ–°æ–‡æ¡£ï¼Œå…¶åŸç†ä¹Ÿæ˜¯åŸºäºä¸€ä¸ªé¢„è®¾çš„ç©ºç™½æ¨¡æ¿è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤ï¼Œæ–‡æ¡£çš„æ ¼å¼ï¼ˆå¦‚æ ·å¼ã€é¡µçœ‰ã€é¡µè„šï¼‰ä¸æ­£æ–‡å†…å®¹æ˜¯åˆ†ç¦»å­˜å‚¨çš„ï¼Œå³ä½¿æ¸…ç©ºæ¨¡æ¿æ–‡å­—ä¹Ÿä¸ä¼šåˆ é™¤æ ¼å¼è®¾å®šã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºæ–‡æ¡£æˆ–æ‰“å¼€å·²æœ‰æ–‡æ¡£ï¼š

    from docx import Document
    from io import BytesIO, StringIO  # ç”¨äºç±»æ–‡ä»¶å¯¹è±¡æ“ä½œ
    
    """æ¼”ç¤ºpython-docxæ“ä½œæ–‡æ¡£çš„æ ¸å¿ƒåŠŸèƒ½"""
    # ===================== 1. åˆ›å»ºæ–°æ–‡æ¡£å¹¶ä¿å­˜ =====================
    print("1. åˆ›å»ºæ–°æ–‡æ¡£å¹¶ä¿å­˜...")
    # åŸºäºé»˜è®¤æ¨¡æ¿åˆ›å»ºç©ºæ–‡æ¡£
    new_doc = Document()
    new_doc.add_heading('python-docx æ–‡æ¡£æ“ä½œç¤ºä¾‹', level=1)
    new_doc.add_paragraph('è¿™æ˜¯é€šè¿‡python-docxåˆ›å»ºçš„æ–°æ–‡æ¡£')
    # ä¿å­˜æ–°æ–‡æ¡£åˆ°æœ¬åœ°
    new_doc.save('æ–°å»ºæ–‡æ¡£.docx')
    print("âœ… æ–°æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šæ–°å»ºæ–‡æ¡£.docx")
    
    # ===================== 2. æ‰“å¼€ç°æœ‰æ–‡æ¡£å¹¶ä¿®æ”¹ä¿å­˜ =====================
    print("\n2. æ‰“å¼€ç°æœ‰æ–‡æ¡£å¹¶ä¿®æ”¹...")
    # æ‰“å¼€åˆšæ‰åˆ›å»ºçš„æ–‡æ¡£
    existing_doc = Document('æ–°å»ºæ–‡æ¡£.docx')
    # å‘æ–‡æ¡£è¿½åŠ å†…å®¹
    existing_doc.add_paragraph('è¿™æ˜¯æ‰“å¼€ç°æœ‰æ–‡æ¡£åè¿½åŠ çš„å†…å®¹')
    # å¦å­˜ä¸ºæ–°æ–‡ä»¶ï¼ˆé¿å…è¦†ç›–åŸæ–‡ä»¶ï¼‰
    existing_doc.save('ä¿®æ”¹åçš„æ–‡æ¡£.docx')
    print("âœ… ä¿®æ”¹åçš„æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šä¿®æ”¹åçš„æ–‡æ¡£.docx")
    
    # ===================== 3. é€šè¿‡ç±»æ–‡ä»¶å¯¹è±¡ï¼ˆBytesIOï¼‰è¯»å†™æ–‡æ¡£ =====================
    print("\n3. é€šè¿‡ç±»æ–‡ä»¶å¯¹è±¡æ“ä½œæ–‡æ¡£...")
    # 3.1 è¯»å–ï¼šå°†æœ¬åœ°æ–‡æ¡£è¯»å–åˆ°BytesIOæµä¸­
    with open('ä¿®æ”¹åçš„æ–‡æ¡£.docx', 'rb') as f:  # å¿…é¡»ç”¨rbï¼ˆäºŒè¿›åˆ¶è¯»ï¼‰ï¼Œè·¨å¹³å°å…¼å®¹
        doc_stream = BytesIO(f.read())  # ç”¨BytesIOè€ŒéStringIO
    
    # ä»æµä¸­æ‰“å¼€æ–‡æ¡£
    stream_doc = Document(doc_stream)
    # è¿½åŠ å†…å®¹
    stream_doc.add_paragraph('è¿™æ˜¯é€šè¿‡ç±»æ–‡ä»¶å¯¹è±¡æ·»åŠ çš„å†…å®¹')
    
    # 3.2 ä¿å­˜ï¼šå°†æ–‡æ¡£ä¿å­˜åˆ°BytesIOæµä¸­ï¼ˆä¸è½åœ°åˆ°æœ¬åœ°æ–‡ä»¶ï¼‰
    output_stream = BytesIO()
    stream_doc.save(output_stream)
    
    # å¯é€‰ï¼šå°†æµä¸­çš„å†…å®¹å†™å…¥æœ¬åœ°æ–‡ä»¶ï¼ŒéªŒè¯ç»“æœ
    with open('ç±»æ–‡ä»¶å¯¹è±¡ç”Ÿæˆçš„æ–‡æ¡£.docx', 'wb') as f:
        f.write(output_stream.getvalue())
    print("âœ… ç±»æ–‡ä»¶å¯¹è±¡æ“ä½œçš„æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šç±»æ–‡ä»¶å¯¹è±¡ç”Ÿæˆçš„æ–‡æ¡£.docx")
    
    # å…³é—­æµ
    doc_stream.close()
    output_stream.close()
    

### 1.2.2 Tableå¯¹è±¡

Wordè½¯ä»¶ä¸­çš„è¡¨æ ¼åŠŸèƒ½ç›¸å½“å¤æ‚ï¼Œè¿™å¯¼è‡´åœ¨ä½¿ç”¨python-docxæ“ä½œè¡¨æ ¼æ—¶ï¼Œå¾€å¾€éš¾ä»¥æå‰æ˜ç¡®è¡¨æ ¼çš„å…·ä½“å†…å®¹å’Œç»“æ„ï¼Œå¢åŠ äº†å¤„ç†çš„éš¾åº¦ã€‚æœ¬èŠ‚å°†ä»ç®€å•è¡¨æ ¼åˆ°å¤æ‚è¡¨æ ¼æ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨python-docxæ“ä½œè¡¨æ ¼ã€‚

**è§„æ•´è¡¨æ ¼**

è§„æ•´è¡¨æ ¼ä¹Ÿå°±æ˜¯ä¸€ä¸ªè¡Œåˆ—æ•°å›ºå®šã€æ— åˆå¹¶æˆ–çœç•¥å•å…ƒæ ¼çš„æ ‡å‡†è¡¨æ ¼ï¼Œè¿™æ˜¯æœ€åŸºç¡€çš„è¡¨æ ¼å½¢å¼ã€‚å…³ç³»å‹æ•°æ®åº“è¡¨å’Œpandasæ•°æ®è¡¨éƒ½æ˜¯è§„æ•´è¡¨æ ¼çš„å…¸å‹ç¤ºä¾‹ï¼š

    +---+---+---+
    | a | b | c |
    +---+---+---+
    | d | e | f |
    +---+---+---+
    | g | h | i |
    +---+---+---+
    

é€šè¿‡æ§åˆ¶è¡¨æ ¼è¡Œåˆ—æ•°å³å¯åˆ›å»ºè§„æ•´è¡¨æ ¼ï¼š

    from docx import Document
    from docx.shared import Inches
    
    # åˆ›å»ºæ–°æ–‡æ¡£
    doc = Document()
    
    # æ·»åŠ 3è¡Œ2åˆ—çš„è§„æ•´è¡¨æ ¼
    table = doc.add_table(rows=3, cols=2)
    table.style = 'Table Grid'  # æ˜¾ç¤ºè¡¨æ ¼è¾¹æ¡†ï¼Œä¾¿äºæŸ¥çœ‹
    
    # å¡«å……å•å…ƒæ ¼å†…å®¹ï¼ˆa-i å¯¹åº”ç¤ºä¾‹ä¸­çš„è§„æ•´è¡¨æ ¼ï¼‰
    cell_texts = ['a', 'b', 'c', 'd', 'e', 'f']
    idx = 0
    for row in table.rows:
        for cell in row.cells:
            cell.text = cell_texts[idx]
            idx += 1
    
    # ä¿å­˜æ–‡æ¡£
    doc.save('è§„æ•´è¡¨æ ¼ç¤ºä¾‹.docx')
    
    # è¯»å–å¹¶éªŒè¯è§„æ•´è¡¨æ ¼çš„è¡Œåˆ—æ•°ï¼ˆæ¯è¡Œå•å…ƒæ ¼æ•°ç›¸åŒï¼‰
    print("è§„æ•´è¡¨æ ¼æ¯è¡Œçš„å•å…ƒæ ¼æ•°ï¼š")
    for i, row in enumerate(table.rows):
        print(f"ç¬¬{i+1}è¡Œï¼š{len(row.cells)}ä¸ªå•å…ƒæ ¼")
    

**åˆå¹¶å•å…ƒæ ¼**

å°†å¤šä¸ªè¿ç»­çš„æ¨ªå‘æˆ–çºµå‘å•å…ƒæ ¼åˆå¹¶ä¸ºä¸€ä¸ªå•å…ƒæ ¼ï¼Œæ˜¯å®é™…ä½¿ç”¨ä¸­éå¸¸å¸¸è§çš„æ–¹å¼ï¼š

    +---+---+---+   +---+---+---+
    |   a   | b |   |   | b | c |
    +---+---+---+   + a +---+---+
    | c | d | e |   |   | d | e |
    +---+---+---+   +---+---+---+
    | f | g | h |   | f | g | h |
    +---+---+---+   +---+---+---+
    

å®ç°æ–¹å¼ä¸ºå…ˆåˆ›å»ºè§„æ•´è¡¨æ ¼ï¼Œå†é€šè¿‡`cell.merge()`å®ç°å•å…ƒæ ¼çš„æ¨ªå‘æˆ–çºµå‘åˆå¹¶ï¼š

    from docx import Document
    
    doc = Document()
    table = doc.add_table(rows=2, cols=3)
    table.style = 'Table Grid'
    
    # ç¤ºä¾‹1ï¼šæ¨ªå‘åˆå¹¶ï¼ˆç¬¬ä¸€è¡Œç¬¬ä¸€ä¸ªå•å…ƒæ ¼åˆå¹¶å³ä¾§å•å…ƒæ ¼ï¼‰
    cell_1_1 = table.cell(0, 0)  # ç¬¬1è¡Œç¬¬1åˆ—ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰
    cell_1_2 = table.cell(0, 1)
    cell_1_1.merge(cell_1_2)
    cell_1_1.text = 'åˆå¹¶å•å…ƒæ ¼ï¼ˆæ¨ªå‘ï¼‰'
    
    # ç¤ºä¾‹2ï¼šçºµå‘åˆå¹¶ï¼ˆç¬¬ä¸‰åˆ—å‰ä¸¤ä¸ªå•å…ƒæ ¼åˆå¹¶ï¼‰
    cell_1_3 = table.cell(0, 2)
    cell_2_3 = table.cell(1, 2)
    cell_1_3.merge(cell_2_3)
    cell_1_3.text = 'åˆå¹¶å•å…ƒæ ¼ï¼ˆçºµå‘ï¼‰'
    
    # å¡«å……å…¶ä»–å•å…ƒæ ¼
    table.cell(1, 0).text = 'd'
    table.cell(1, 1).text = 'e'
    
    # æŸ¥çœ‹åˆå¹¶åæ¯è¡Œçš„å•å…ƒæ ¼æ•°
    # æ³¨æ„ä»¥ä¸‹å†…å®¹è¿”å›çš„æ˜¯åŸå§‹è¡¨æ ¼ç»“æ„
    print("åˆå¹¶å•å…ƒæ ¼åæ¯è¡Œçš„å•å…ƒæ ¼æ•°ï¼š")
    for i, row in enumerate(table.rows):
        print(f"ç¬¬{i+1}è¡Œï¼š{len(row.cells)}ä¸ªå•å…ƒæ ¼")
    
    doc.save('åˆå¹¶å•å…ƒæ ¼ç¤ºä¾‹.docx')
    

**é€’å½’è¡¨æ ¼**

è¡¨æ ¼å¤„ç†çš„å¦ä¸€ä¸ªå¤æ‚ç‚¹æ˜¯å…¶é€’å½’ç‰¹æ€§ï¼ŒWordä¸­çš„è¡¨æ ¼å•å…ƒæ ¼æœ¬èº«å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ ¼ã€‚å¯ä»¥é€šè¿‡`_Cell.tables`æˆ–`_Cell.iter_inner_content()`æ£€æµ‹åµŒå¥—è¡¨æ ¼ï¼š

*   `_Cell.tables`ï¼šç›´æ¥è¿”å›å•å…ƒæ ¼å†…åŒ…å«çš„æ‰€æœ‰è¡¨æ ¼ã€‚
*   `_Cell.iter_inner_content()`ï¼šæŒ‰æ–‡æ¡£é¡ºåºè¿”å›å•å…ƒæ ¼å†…çš„æ‰€æœ‰å†…å®¹ï¼ˆåŒ…æ‹¬æ®µè½å’Œè¡¨æ ¼ï¼‰ï¼Œä¿æŒè¡¨æ ¼ä¸æ®µè½çš„ç›¸å¯¹ä½ç½®ä¸å˜ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    from docx import Document
    from docx.shared import Inches
    from docx.table import Table
    from docx.text.paragraph import Paragraph
    
    def generate_nested_table_doc():
        """ç”Ÿæˆå¸¦åµŒå¥—è¡¨æ ¼çš„ç¤ºä¾‹Wordæ–‡æ¡£ï¼ˆç¤ºä¾‹æ•°æ®ï¼‰"""
        # 1. åˆ›å»ºæ–°æ–‡æ¡£
        doc = Document()
    
        # 2. åˆ›å»ºå¤–å±‚è¡¨æ ¼ï¼ˆ2è¡Œ2åˆ—ï¼‰
        outer_table = doc.add_table(rows=2, cols=2)
        outer_table.style = 'Table Grid'  # æ˜¾ç¤ºè¡¨æ ¼è¾¹æ¡†
    
        # 3. å¡«å……å¤–å±‚è¡¨æ ¼çš„æ™®é€šå•å…ƒæ ¼
        cell_1_1 = outer_table.cell(0, 0)
        cell_1_1.text = "ä¸‹æ–¹å•å…ƒæ ¼åŒ…å«åµŒå¥—è¡¨æ ¼"
    
        cell_1_2 = outer_table.cell(0, 1)
        cell_1_2.text = "æ™®é€šå•å…ƒæ ¼ï¼ˆæ— åµŒå¥—ï¼‰"
    
        # 4. å…³é”®ï¼šåœ¨ (1,0) å•å…ƒæ ¼ä¸­åµŒå¥—ä¸€ä¸ªå­è¡¨æ ¼
        cell_2_1 = outer_table.cell(1, 0)
        # å…ˆç»™åµŒå¥—è¡¨æ ¼å‰åŠ ä¸€ä¸ªæ®µè½ï¼ˆæ¨¡æ‹ŸçœŸå®æ–‡æ¡£çš„æ··åˆå†…å®¹ï¼‰
        para = cell_2_1.add_paragraph("åµŒå¥—è¡¨æ ¼å‰çš„æ®µè½å†…å®¹ï¼š")
        # åœ¨å•å…ƒæ ¼å†…åˆ›å»ºåµŒå¥—è¡¨æ ¼ï¼ˆ3è¡Œ1åˆ—ï¼‰
        inner_table = cell_2_1.add_table(rows=3, cols=1)
        inner_table.style = 'Table Grid'
        # å¡«å……åµŒå¥—è¡¨æ ¼
        inner_table.cell(0, 0).text = "åµŒå¥—è¡¨æ ¼-è¡Œ1"
        inner_table.cell(1, 0).text = "åµŒå¥—è¡¨æ ¼-è¡Œ2"
        inner_table.cell(2, 0).text = "åµŒå¥—è¡¨æ ¼-è¡Œ3"
        # åµŒå¥—è¡¨æ ¼åå†åŠ ä¸€ä¸ªæ®µè½
        cell_2_1.add_paragraph("åµŒå¥—è¡¨æ ¼åçš„æ®µè½å†…å®¹")
    
        # 5. å¡«å……å¤–å±‚è¡¨æ ¼æœ€åä¸€ä¸ªå•å…ƒæ ¼
        cell_2_2 = outer_table.cell(1, 1)
        cell_2_2.text = "æ™®é€šå•å…ƒæ ¼ï¼ˆæ— åµŒå¥—ï¼‰"
    
        # 6. ä¿å­˜æ–‡æ¡£ï¼ˆç”Ÿæˆç¤ºä¾‹æ•°æ®ï¼‰
        doc.save("åµŒå¥—è¡¨æ ¼.docx")
        print("=" * 50)
        print("âœ… åµŒå¥—è¡¨æ ¼.docx")
        print("=" * 50)
    
    def traverse_table(table, level=0):
        """
        é€’å½’éå†è¡¨æ ¼ï¼Œå¤„ç†åµŒå¥—è¡¨æ ¼
        :param table: è¦éå†çš„è¡¨æ ¼å¯¹è±¡
        :param level: è¡¨æ ¼åµŒå¥—å±‚çº§ï¼ˆå¤–å±‚ä¸º0ï¼Œå†…å±‚+1ï¼‰
        """
        indent = "  " * level  # ç¼©è¿›ï¼Œæ–¹ä¾¿åŒºåˆ†å±‚çº§
        print(f"\n{indent}=== éå†ã€å±‚çº§{level}ã€‘è¡¨æ ¼ ===")
        
        # éå†è¡¨æ ¼çš„æ¯ä¸€è¡Œ
        for row_idx, row in enumerate(table.rows):
            # éå†è¡Œä¸­çš„æ¯ä¸€ä¸ªå•å…ƒæ ¼
            for col_idx, cell in enumerate(row.cells):
                print(f"\n{indent}å•å…ƒæ ¼ ({row_idx+1}, {col_idx+1})ï¼š")
                
                # --------------------------
                # æ–¹æ³•1ï¼š_Cell.tables - ç›´æ¥è·å–å•å…ƒæ ¼å†…çš„æ‰€æœ‰è¡¨æ ¼
                # --------------------------
                inner_tables = cell.tables
                if inner_tables:
                    print(f"{indent}  ğŸ“Œ æ£€æµ‹åˆ° {len(inner_tables)} ä¸ªåµŒå¥—è¡¨æ ¼ï¼š")
                    # é€’å½’éå†æ¯ä¸ªåµŒå¥—è¡¨æ ¼
                    for inner_table in inner_tables:
                        traverse_table(inner_table, level + 1)
                else:
                    print(f"{indent}  ğŸ“Œ æ— åµŒå¥—è¡¨æ ¼")
                
                # --------------------------
                # æ–¹æ³•2ï¼š_Cell.iter_inner_content() - æŒ‰é¡ºåºè·å–å•å…ƒæ ¼å†…æ‰€æœ‰å†…å®¹ï¼ˆæ®µè½+è¡¨æ ¼ï¼‰
                # --------------------------
                print(f"{indent}  ğŸ“Œ å•å…ƒæ ¼å†…å®Œæ•´å†…å®¹ï¼ˆæŒ‰é¡ºåºï¼‰ï¼š")
                for content in cell.iter_inner_content():
                    if isinstance(content, Paragraph):
                        # å¤„ç†æ®µè½å†…å®¹ï¼ˆè¿‡æ»¤ç©ºæ®µè½ï¼‰
                        text = content.text.strip()
                        if text:
                            print(f"{indent} [æ®µè½]ï¼š{text}")
                    elif isinstance(content, Table):
                        # é‡åˆ°è¡¨æ ¼æ—¶çš„æç¤ºï¼ˆé¿å…é‡å¤éå†ï¼Œä»…æ¼”ç¤ºä½ç½®ï¼‰
                        print(f"{indent} [è¡¨æ ¼]ï¼šåµŒå¥—è¡¨æ ¼ï¼ˆå±‚çº§{level+1}ï¼‰")
    
    def parse_nested_tables():
        """è§£æç”Ÿæˆçš„åµŒå¥—è¡¨æ ¼æ–‡æ¡£ï¼Œæ¼”ç¤ºæ ¸å¿ƒæ–¹æ³•"""
        # 1. æ‰“å¼€ç¤ºä¾‹æ–‡æ¡£
        doc = Document("åµŒå¥—è¡¨æ ¼.docx")
    
        # 2. éå†æ–‡æ¡£ä¸­çš„æ‰€æœ‰å¤–å±‚è¡¨æ ¼
        print("\nå¼€å§‹è§£æåµŒå¥—è¡¨æ ¼ï¼š")
        print("-" * 50)
        for table in doc.tables:
            traverse_table(table)
    
    # ä¸»ç¨‹åºå…¥å£
    if __name__ == "__main__":
        # ç”Ÿæˆå¸¦åµŒå¥—è¡¨æ ¼çš„ç¤ºä¾‹æ–‡æ¡£
        generate_nested_table_doc()
        
        # ç¬¬äºŒæ­¥ï¼šè§£æåµŒå¥—è¡¨æ ¼ï¼Œæ¼”ç¤º_Cell.tableså’Œiter_inner_contentçš„ä½¿ç”¨
        parse_nested_tables()
        
        print("\n" + "=" * 50)
        print("âœ… åµŒå¥—è¡¨æ ¼è§£æå®Œæˆï¼")
        print("=" * 50)
    

### 1.2.3 æ–‡æœ¬å¤„ç†

åœ¨Wordæ–‡æ¡£ä¸­ï¼Œå†…å®¹çš„ç»„ç»‡é€»è¾‘åˆ†ä¸ºä¸¤ä¸ªä¸»è¦å±‚çº§ï¼šå—çº§å¯¹è±¡å’Œè¡Œå†…å¯¹è±¡ã€‚

*   å—çº§å¯¹è±¡ï¼ˆå¦‚æ®µè½ã€è¡¨æ ¼ï¼‰æ˜¯å æ®æ•´è¡Œçš„å¤§æ¨¡å—ï¼Œå…¶å®½åº¦ç”±é¡µé¢è¾¹è·ã€åˆ†æ æˆ–å•å…ƒæ ¼è¾¹ç•Œå†³å®šï¼Œæ–‡æœ¬ä¼šåœ¨å…¶å·¦å³è¾¹ç•Œå†…è‡ªåŠ¨æ¢è¡Œã€‚
*   è¡Œå†…å¯¹è±¡åˆ™å­˜åœ¨äºè¿™äº›å¤§æ¨¡å—å†…éƒ¨ï¼Œå¦‚åŠ ç²—çš„è¯è¯­æˆ–å¥å­ï¼Œæœ€å¸¸è§çš„è¡¨ç°å½¢å¼æ˜¯æ–‡æœ¬ç‰‡æ®µï¼ˆrunsï¼‰ã€‚ä¸€ä¸ªæ®µè½å°±æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æœ¬ç‰‡æ®µç»„æˆçš„ã€‚

ç›¸åº”åœ°ï¼Œæ ¼å¼æ§åˆ¶ä¹Ÿåˆ†ä¸ºä¸¤ç±»ï¼š

*   å—çº§å±æ€§ï¼ˆå¦‚ç¼©è¿›ã€é—´è·ã€å¯¹é½æ–¹å¼ï¼‰æ§åˆ¶æ¨¡å—åœ¨é¡µé¢ä¸Šçš„å¸ƒå±€ä½ç½®ï¼›
*   è¡Œå†…å±æ€§ï¼ˆå¦‚å­—ä½“ã€åŠ ç²—ã€é¢œè‰²ï¼‰åˆ™æ§åˆ¶æ¨¡å—å†…éƒ¨æ–‡å­—çš„å…·ä½“å¤–è§‚ã€‚

ä¸‹é¢é€šè¿‡Python-docxçš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºè¿™ä¸¤ç±»æ ¼å¼çš„å®é™…åº”ç”¨ï¼š

    from docx import Document
    from docx.shared import Inches, Pt, RGBColor
    from docx.enum.text import (
        WD_ALIGN_PARAGRAPH,
        WD_TAB_ALIGNMENT,
        WD_TAB_LEADER,
        WD_UNDERLINE
    )
    from docx.enum.dml import MSO_THEME_COLOR
    
    # åˆ›å»ºä¸€ä¸ªæ–°çš„ Word æ–‡æ¡£
    doc = Document()
    
    # ==================== 1. å—çº§æ ¼å¼è®¾ç½®ï¼šæ®µè½å¸ƒå±€æ§åˆ¶ ====================
    # 1.1 æ ‡é¢˜æ®µè½ï¼ˆå±…ä¸­å¯¹é½ã€æ®µåé—´è·ï¼‰
    title_para = doc.add_paragraph("Python-docx æ–‡æœ¬æ ¼å¼ç¤ºä¾‹")
    title_format = title_para.paragraph_format  # å—çº§æ ¼å¼å¯¹è±¡
    title_format.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±…ä¸­å¯¹é½ï¼ˆå—çº§å±æ€§ï¼‰
    title_format.space_after = Pt(18)  # æ®µåé—´è·ï¼ˆå—çº§å±æ€§ï¼‰
    
    # 1.2 æ­£æ–‡æ®µè½ï¼ˆç¼©è¿›ä¸è¡Œé—´è·ï¼‰
    content_para = doc.add_paragraph("è¿™æ˜¯ä¸€ä¸ªå¸¦ç¼©è¿›å’Œè‡ªå®šä¹‰è¡Œé—´è·çš„æ­£æ–‡æ®µè½ã€‚")
    content_format = content_para.paragraph_format
    content_format.left_indent = Inches(0.5)          # å·¦ç¼©è¿›
    content_format.first_line_indent = Inches(-0.25)  # æ‚¬æŒ‚ç¼©è¿›
    content_format.line_spacing = 1.5                # 1.5å€è¡Œé—´è·
    content_format.space_before = Pt(12)             # æ®µå‰é—´è·
    
    # 1.3 å¸¦åˆ¶è¡¨ä½çš„æ®µè½ï¼ˆå—çº§å®šä½ï¼‰
    tab_para = doc.add_paragraph("å§“å:\tå¼ ä¸‰\tå¹´é¾„:\t25")
    tab_format = tab_para.paragraph_format
    tab_stops = tab_format.tab_stops
    # æ·»åŠ ä¸‰ä¸ªåˆ¶è¡¨ä½ï¼ˆä½ç½®ã€å¯¹é½æ–¹å¼ã€å‰å¯¼ç¬¦ï¼‰
    tab_stops.add_tab_stop(Inches(1.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)
    tab_stops.add_tab_stop(Inches(2.5), WD_TAB_ALIGNMENT.LEFT, WD_TAB_LEADER.SPACES)
    tab_stops.add_tab_stop(Inches(3.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)
    
    # 1.4 åˆ†é¡µæ§åˆ¶ï¼ˆå—çº§ä¿æŒä¸å­¤è¡Œæ§åˆ¶ï¼‰
    page_para1 = doc.add_paragraph("è¿™æ˜¯ç« èŠ‚æ ‡é¢˜ï¼ˆç¡®ä¿ä¸ä¸‹ä¸€æ®µåŒé¡µï¼‰")
    page_para1.paragraph_format.keep_with_next = True  # ä¸ä¸‹æ®µåŒé¡µ
    page_para2 = doc.add_paragraph("è¿™æ˜¯ç« èŠ‚å†…å®¹ï¼Œå¯ç”¨äº†å­¤è¡Œæ§åˆ¶ï¼Œé¿å…æ®µè½é¦–è¡Œ/æœ«è¡Œå•ç‹¬æ˜¾ç¤ºåœ¨ä¸€é¡µã€‚" * 20)
    page_para2.paragraph_format.widow_control = True   # é¿å…å­¤è¡Œ
    
    # ==================== 2. è¡Œå†…æ ¼å¼è®¾ç½®ï¼šæ–‡å­—å¤–è§‚æ§åˆ¶ ====================
    char_para = doc.add_paragraph("å­—ç¬¦æ ¼å¼ç¤ºä¾‹ï¼š")
    
    # ç²—ä½“
    bold_run = char_para.add_run("ç²—ä½“æ–‡æœ¬")
    bold_run.font.bold = True
    char_para.add_run(" | ")
    
    # æ–œä½“
    italic_run = char_para.add_run("æ–œä½“æ–‡æœ¬")
    italic_run.font.italic = True
    char_para.add_run(" | ")
    
    # ä¸‹åˆ’çº¿ï¼ˆåŒä¸‹åˆ’çº¿ï¼‰
    underline_run = char_para.add_run("åŒä¸‹åˆ’çº¿æ–‡æœ¬")
    underline_run.font.underline = WD_UNDERLINE.DOUBLE
    char_para.add_run(" | ")
    
    # ä¸åŒå­—å·å’Œé¢œè‰²
    color_run = char_para.add_run("16å·çº¢è‰²æ–‡æœ¬")
    color_run.font.size = Pt(16)               # å­—å·
    color_run.font.color.rgb = RGBColor(255, 0, 0)  # é¢œè‰²
    char_para.add_run(" | ")
    
    # ä¸Šæ ‡
    sup_run = char_para.add_run("ä¸Šæ ‡")
    sup_run.font.superscript = True
    
    # ==================== 3. ä¿å­˜æ–‡æ¡£ ====================
    doc.save("æ–‡æœ¬æ ¼å¼ç¤ºä¾‹.docx")
    print("æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šæ–‡æœ¬æ ¼å¼ç¤ºä¾‹.docx")
    

### 1.2.4 Sectionså¯¹è±¡

Wordå¼•å…¥äº†èŠ‚ï¼ˆsectionï¼‰çš„æ¦‚å¿µï¼Œå®ƒæŒ‡æ–‡æ¡£ä¸­å…·æœ‰ç›¸åŒé¡µé¢å¸ƒå±€ï¼ˆå¦‚é¡µè¾¹è·ã€çº¸å¼ æ–¹å‘ï¼‰çš„è¿ç»­éƒ¨åˆ†ã€‚é€šè¿‡åˆ†èŠ‚ï¼Œç”¨æˆ·å¯ä»¥åœ¨åŒä¸€ä»½æ–‡æ¡£ä¸­æ··åˆä½¿ç”¨ä¸åŒç‰ˆå¼ï¼Œä¾‹å¦‚åŒæ—¶åŒ…å«çºµå‘é¡µé¢å’Œæ¨ªå‘é¡µé¢ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªèŠ‚è¿˜å¯ä»¥ç‹¬ç«‹è®¾ç½®å…¶é¡µçœ‰ä¸é¡µè„šçš„æ ·å¼ã€‚ç»å¤§å¤šæ•°Wordæ–‡æ¡£é»˜è®¤ä»…åŒ…å«ä¸€ä¸ªèŠ‚ï¼Œé€šå¸¸ä¹Ÿæ— éœ€æ›´æ”¹é¡µé¢å¸ƒå±€ã€‚ç„¶è€Œï¼Œå½“ç¡®å®éœ€è¦å¯¹é¡µé¢å¸ƒå±€è¿›è¡Œè°ƒæ•´æ—¶ï¼Œç†è§£èŠ‚çš„åŠŸèƒ½ä¸è®¾ç½®æ–¹æ³•å°±å˜å¾—è‡³å…³é‡è¦ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨python-docxåº“åˆ›å»ºåŒ…å«å¤šä¸ªèŠ‚ã€å„èŠ‚æ‹¥æœ‰ä¸åŒé¡µé¢è®¾ç½®çš„Wordæ–‡æ¡£ï¼š

    from docx import Document
    from docx.enum.section import WD_SECTION_START
    from docx.enum.section import WD_ORIENT
    from docx.shared import Inches
    
    # 1. åˆ›å»ºæ–°æ–‡æ¡£å¹¶æŸ¥çœ‹é»˜è®¤èŠ‚
    document = Document()
    print("åˆå§‹æ–‡æ¡£çš„èŠ‚æ•°é‡ï¼š", len(document.sections))  # é»˜è®¤1ä¸ªèŠ‚
    
    # è·å–é»˜è®¤èŠ‚å¹¶ä¿®æ”¹å…¶åŸºç¡€å¸ƒå±€ï¼ˆçºµå‘ï¼Œå¸¸è§„è¾¹è·ï¼‰
    default_section = document.sections[0]
    # è®¾ç½®é»˜è®¤èŠ‚çš„è¾¹è·ï¼šå·¦1.5è‹±å¯¸ã€å³1è‹±å¯¸ã€ä¸Šä¸‹å„1è‹±å¯¸
    default_section.left_margin = Inches(1.5)
    default_section.right_margin = Inches(1)
    default_section.top_margin = Inches(1)
    default_section.bottom_margin = Inches(1)
    
    # 2. ç»™é»˜è®¤èŠ‚æ·»åŠ å†…å®¹ï¼ˆçºµå‘é¡µé¢å†…å®¹ï¼‰
    document.add_heading('ç¬¬ä¸€èŠ‚ï¼šçºµå‘é¡µé¢å†…å®¹', level=1)
    document.add_paragraph('è¿™æ˜¯é»˜è®¤èŠ‚çš„å†…å®¹ï¼Œé¡µé¢ä¸ºçºµå‘ï¼Œè¾¹è·ï¼šå·¦1.5è‹±å¯¸ã€å³1è‹±å¯¸ã€‚')
    
    # 3. æ·»åŠ æ–°èŠ‚ï¼ˆå¥‡æ•°é¡µå¼€å§‹ï¼Œæ¨ªå‘å¸ƒå±€ï¼‰
    # åˆ›å»ºæ–°èŠ‚ï¼ŒæŒ‡å®šåˆ†èŠ‚ç¬¦ç±»å‹ä¸ºå¥‡æ•°é¡µå¼€å§‹
    new_section = document.add_section(WD_SECTION_START.ODD_PAGE)
    # ä¿®æ”¹æ–°èŠ‚çš„é¡µé¢æ–¹å‘ä¸ºæ¨ªå‘ï¼ˆéœ€åŒæ—¶äº¤æ¢å®½é«˜ï¼‰
    new_section.orientation = WD_ORIENT.LANDSCAPE
    # å…ˆäº¤æ¢å®½é«˜å€¼ï¼Œé¿å…é¡µé¢å°ºå¯¸å¼‚å¸¸
    new_width, new_height = new_section.page_height, new_section.page_width
    new_section.page_width = new_width
    new_section.page_height = new_height
    # è®¾ç½®æ–°èŠ‚çš„è¾¹è·ï¼šå·¦å³å„1.25è‹±å¯¸ï¼Œä¸Šä¸‹å„0.8è‹±å¯¸
    new_section.left_margin = Inches(1.25)
    new_section.right_margin = Inches(1.25)
    new_section.top_margin = Inches(0.8)
    new_section.bottom_margin = Inches(0.8)
    
    # 4. ç»™æ–°èŠ‚æ·»åŠ å†…å®¹ï¼ˆæ¨ªå‘é¡µé¢å†…å®¹ï¼‰
    document.add_heading('ç¬¬äºŒèŠ‚ï¼šæ¨ªå‘é¡µé¢å†…å®¹', level=1)
    document.add_paragraph('è¿™æ˜¯æ–°èŠ‚çš„å†…å®¹ï¼Œé¡µé¢ä¸ºæ¨ªå‘ï¼Œè¾¹è·ï¼šå·¦å³1.25è‹±å¯¸ã€ä¸Šä¸‹0.8è‹±å¯¸ã€‚')
    
    # 5. å†æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ï¼ˆå¶æ•°é¡µå¼€å§‹ï¼Œçºµå‘å¸ƒå±€ï¼‰
    third_section = document.add_section(WD_SECTION_START.EVEN_PAGE)
    # æ¢å¤çºµå‘å¸ƒå±€
    third_section.orientation = WD_ORIENT.PORTRAIT
    third_section.page_width = Inches(8.5)
    third_section.page_height = Inches(11)
    # è®¾ç½®ç‰¹æ®Šè¾¹è·ï¼ˆæ·»åŠ è£…è®¢çº¿ï¼‰
    third_section.gutter = Inches(0.2)  # è£…è®¢çº¿0.2è‹±å¯¸
    third_section.header_distance = Inches(0.6)  # é¡µçœ‰è·ç¦»0.6è‹±å¯¸
    
    # 6. ç»™ç¬¬ä¸‰ä¸ªèŠ‚æ·»åŠ å†…å®¹
    document.add_heading('ç¬¬ä¸‰èŠ‚ï¼šå¸¦è£…è®¢çº¿çš„çºµå‘é¡µé¢', level=1)
    document.add_paragraph('è¿™ä¸€èŠ‚åŒ…å«0.2è‹±å¯¸çš„è£…è®¢çº¿ï¼Œé¡µçœ‰è·ç¦»é¡µé¢é¡¶éƒ¨0.6è‹±å¯¸ã€‚')
    
    # 7. éå†æ‰€æœ‰èŠ‚ï¼Œæ‰“å°å…³é”®å±æ€§
    print("\n=== æ‰€æœ‰èŠ‚çš„å…³é”®å±æ€§ ===")
    for idx, section in enumerate(document.sections):
        print(f"\nç¬¬{idx+1}èŠ‚ï¼š")
        print(f"  èµ·å§‹ç±»å‹ï¼š{section.start_type}")
        print(f"  é¡µé¢æ–¹å‘ï¼š{section.orientation}")
        print(f"  å·¦å³è¾¹è·ï¼š{section.left_margin/914400:.2f}è‹±å¯¸ / {section.right_margin/914400:.2f}è‹±å¯¸")
        print(f"  è£…è®¢çº¿ï¼š{section.gutter/914400:.2f}è‹±å¯¸")
    
    # ä¿å­˜æ–‡æ¡£
    document.save("å¤šèŠ‚æ–‡æ¡£ç¤ºä¾‹.docx")
    print("\næ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šå¤šèŠ‚æ–‡æ¡£ç¤ºä¾‹.docx")
    

### 1.2.5 é¡µçœ‰é¡µè„šå¯¹è±¡

é¡µçœ‰æ˜¯æŒ‡æ˜¾ç¤ºåœ¨æ¯ä¸€é¡µä¸Šé¡µè¾¹è·åŒºåŸŸçš„æ–‡æœ¬ï¼Œä¸æ­£æ–‡å†…å®¹ç›¸äº’ç‹¬ç«‹ï¼Œé€šå¸¸ç”¨äºå±•ç¤ºæ–‡æ¡£æ ‡é¢˜ã€ä½œè€…ã€åˆ›å»ºæ—¥æœŸæˆ–é¡µç ç­‰ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚åŒä¸€æ–‡æ¡£ä¸­çš„é¡µçœ‰åœ¨å„é¡µé¢é—´åŸºæœ¬ä¿æŒä¸€è‡´ï¼Œä»…åœ¨éƒ¨åˆ†å†…å®¹ä¸Šå¯èƒ½å­˜åœ¨ç»†å¾®å·®å¼‚ï¼Œä¾‹å¦‚ç« èŠ‚æ ‡é¢˜æˆ–é¡µç çš„å˜åŒ–ã€‚é¡µè„šåœ¨åŠŸèƒ½å’Œç‰¹æ€§ä¸Šä¸é¡µçœ‰å®Œå…¨ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯é¡µè„šä½äºé¡µé¢åº•éƒ¨ã€‚é¡µè„šä¸è„šæ³¨ä¸åŒï¼Œè„šæ³¨åœ¨å„é¡µé¢é—´å¹¶ä¸ç»Ÿä¸€ã€‚ä»¥ä¸‹æ˜¯æ“ä½œæ–‡æ¡£é¡µçœ‰é¡µè„šçš„ç¤ºä¾‹ä»£ç ï¼š

    from docx import Document
    
    # -------------------------- 1. åˆå§‹åŒ–æ–‡æ¡£å¹¶åˆ›å»ºåŸºç¡€é¡µçœ‰ --------------------------
    # åˆ›å»ºæ–°æ–‡æ¡£
    doc = Document()
    
    # è·å–æ–‡æ¡£çš„ç¬¬ä¸€ä¸ªèŠ‚ï¼ˆæ–°å»ºæ–‡æ¡£é»˜è®¤åªæœ‰1ä¸ªèŠ‚ï¼‰
    section1 = doc.sections[0]
    header1 = section1.header
    
    # æ£€æŸ¥åˆå§‹çŠ¶æ€ï¼šæ–°å»ºæ–‡æ¡£çš„é¡µçœ‰é»˜è®¤å…³è”åˆ°å‰ä¸€èŠ‚é¡µçœ‰è®¾ç½®ï¼ˆæ­¤å¤„æ— å‰ç½®èŠ‚ï¼Œæ•…æ— å®é™…é¡µçœ‰ï¼‰
    print(f"åˆå§‹é¡µçœ‰å…³è”çŠ¶æ€: {header1.is_linked_to_previous}")  # è¾“å‡º: True
    
    # ä¸ºç¬¬ä¸€èŠ‚æ·»åŠ ç®€å•é¡µçœ‰ï¼ˆä»…å·¦ä¾§æ–‡æœ¬ï¼‰
    # ç›´æ¥ç¼–è¾‘é¡µçœ‰çš„ç¬¬ä¸€ä¸ªæ®µè½ï¼ˆæ–°å»ºé¡µçœ‰é»˜è®¤åŒ…å«1ä¸ªç©ºæ®µè½ï¼‰
    para1 = header1.paragraphs[0]
    para1.text = "æ–‡æ¡£ä¸»æ ‡é¢˜ - ç¬¬ä¸€èŠ‚é¡µçœ‰"
    # è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹é¡µçœ‰å®šä¹‰ï¼Œå…³è”çŠ¶æ€å˜ä¸ºFalse
    print(f"æ·»åŠ é¡µçœ‰åå…³è”çŠ¶æ€: {header1.is_linked_to_previous}")  # è¾“å‡º: False
    
    # -------------------------- 2. æ·»åŠ å¸¦åˆ†åŒºï¼ˆå·¦/ä¸­/å³ï¼‰çš„é¡µçœ‰ --------------------------
    # å…ˆæ¸…ç©ºç¬¬ä¸€èŠ‚åŸæœ‰é¡µçœ‰å†…å®¹ï¼Œé‡æ–°è®¾ç½®åˆ†åŒºé¡µçœ‰
    para1.clear()
    # ä½¿ç”¨åˆ¶è¡¨ç¬¦\tåˆ†éš”å·¦ã€ä¸­ã€å³ä¸‰éƒ¨åˆ†å†…å®¹
    para1.text = "å·¦ä¾§ï¼šæ–‡æ¡£åç§°\tå±…ä¸­ï¼š2026å¹´1æœˆ\tå³ä¾§ï¼šé¡µç "
    # åº”ç”¨Wordé»˜è®¤çš„"Header"æ ·å¼ï¼ˆç¡®ä¿åˆ¶è¡¨ä½ç”Ÿæ•ˆï¼‰
    para1.style = doc.styles["Header"]
    
    # -------------------------- 3. æ·»åŠ æ–°èŠ‚å¹¶è®¾ç½®ç‹¬ç«‹é¡µçœ‰ --------------------------
    # å‘æ–‡æ¡£æœ«å°¾æ·»åŠ æ–°èŠ‚ï¼ˆsection2ï¼‰
    section2 = doc.add_section()
    header2 = section2.header
    
    # åˆå§‹çŠ¶æ€ï¼šæ–°èŠ‚çš„é¡µçœ‰é»˜è®¤å…³è”åˆ°å‰ä¸€èŠ‚ï¼ˆsection1ï¼‰
    print(f"ç¬¬äºŒèŠ‚åˆå§‹å…³è”çŠ¶æ€: {header2.is_linked_to_previous}")  # è¾“å‡º: True
    # éªŒè¯ï¼šæ­¤æ—¶ç¼–è¾‘header2çš„å†…å®¹ä¼šç›´æ¥ä¿®æ”¹section1çš„é¡µçœ‰ï¼ˆç»§æ‰¿ç‰¹æ€§ï¼‰
    # å…ˆå–æ¶ˆå…³è”ï¼Œåˆ›å»ºç¬¬äºŒèŠ‚çš„ç‹¬ç«‹é¡µçœ‰
    header2.is_linked_to_previous = False
    # ä¸ºç¬¬äºŒèŠ‚æ·»åŠ ä¸“å±é¡µçœ‰
    para2 = header2.paragraphs[0]
    para2.text = "ç¬¬äºŒèŠ‚ç‹¬ç«‹é¡µçœ‰ - ä»…æœ¬èŠ‚æ˜¾ç¤º"
    
    # -------------------------- 4. æ·»åŠ é¡µè„šï¼ˆä¸é¡µçœ‰ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼‰ --------------------------
    # ä¸ºç¬¬ä¸€èŠ‚æ·»åŠ é¡µè„šï¼ˆåŒ…å«é¡µç ï¼‰
    footer1 = doc.sections[0].footer
    footer1.is_linked_to_previous = False  # å–æ¶ˆå…³è”ï¼Œåˆ›å»ºç‹¬ç«‹é¡µè„š
    footer_para1 = footer1.paragraphs[0]
    footer_para1.text = "\tç¬¬ {PAGE} é¡µ / å…± {NUMPAGES} é¡µ\t"  # å±…ä¸­æ˜¾ç¤ºé¡µç 
    footer_para1.style = doc.styles["Footer"]
    # ä¸ºç¬¬äºŒèŠ‚æ·»åŠ ä¸åŒçš„é¡µè„š
    footer2 = doc.sections[1].footer
    footer2.is_linked_to_previous = False
    footer_para2 = footer2.paragraphs[0]
    footer_para2.text = "ç¬¬äºŒèŠ‚é¡µè„š - è”ç³»äººï¼šæµ‹è¯•è´¦å·"
    
    # -------------------------- 5. åˆ é™¤é¡µçœ‰ï¼ˆæ¢å¤å…³è”çŠ¶æ€ï¼‰ --------------------------
    # è‹¥éœ€åˆ é™¤ç¬¬äºŒèŠ‚çš„ç‹¬ç«‹é¡µçœ‰ï¼Œåªéœ€å°†å…¶å…³è”çŠ¶æ€è®¾ä¸ºTrueï¼ˆä¼šæ°¸ä¹…åˆ é™¤å†…å®¹ï¼‰
    # æ­¤å¤„ä»…æ¼”ç¤ºï¼Œæ³¨é‡Šæ‰é¿å…å½±å“æœ€ç»ˆæ•ˆæœ
    # header2.is_linked_to_previous = True
    
    # -------------------------- 6. ä¿å­˜æ–‡æ¡£ --------------------------
    doc.save("é¡µçœ‰é¡µè„šç¤ºä¾‹.docx")
    print("æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šé¡µçœ‰é¡µè„šç¤ºä¾‹.docx")
    

1.3 éæ–‡æœ¬å†…å®¹ç®¡ç†
-----------

### 1.3.1 æ ·å¼ç®¡ç†

åœ¨Wordä¸­ï¼Œå†…ç½®æ ·å¼ä¼šå‡ºç°åœ¨Wordç•Œé¢çš„æ ·å¼é¢æ¿ä¸­ï¼Œä½†ä¸ä¼šè‡ªåŠ¨åŠ å…¥æ–‡æ¡£ä¸­ï¼Œç›´åˆ°ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨å®ƒã€‚è¿™æ ·é¿å…äº†æ–‡ä»¶å› æ‰€æœ‰æ ·å¼å®šä¹‰è€Œè‡ƒè‚¿ã€‚ä¸€æ—¦æŸæ ·å¼è¢«ä½¿ç”¨ï¼Œå…¶å®šä¹‰å°±ä¼šæ°¸ä¹…åŠ å…¥æ–‡æ¡£ï¼Œå³ä½¿åæ¥åˆ é™¤åº”ç”¨å†…å®¹ä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚å› æ­¤ï¼Œè‹¥è¦ç”¨python-docxä½¿æ ·å¼ç”Ÿæ•ˆï¼Œå¿…é¡»åœ¨åˆå§‹æ–‡æ¡£ä¸­åŒ…å«å…¶å®šä¹‰ï¼Œå¦åˆ™æ ·å¼ä¼šé™é»˜å¤±æ•ˆã€‚  
ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ç¤ºä¾‹ï¼Œå®ƒæ•´åˆäº†æ–‡æ¡£ä¸­æ‰€æœ‰æ ¸å¿ƒçš„æ ·å¼æ“ä½œåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ ·å¼çš„è®¿é—®ã€åº”ç”¨ã€åˆ›å»ºã€åˆ é™¤ï¼Œä»¥åŠå­—ç¬¦æ®µè½æ ¼å¼çš„å®šä¹‰ç­‰ï¼š

    from docx import Document
    from docx.enum.style import WD_STYLE_TYPE
    from docx.shared import Pt, Inches
    from docx.enum.text import WD_UNDERLINE
    
    # 1. åˆ›å»ºæ–°æ–‡æ¡£å¹¶è®¿é—®æ ·å¼é›†åˆ
    doc = Document()
    styles = doc.styles
    print(f"åˆå§‹æ ·å¼æ•°é‡: {len(styles)}")
    
    # 2. è®¿é—®å¹¶ç­›é€‰ç‰¹å®šç±»å‹çš„æ ·å¼
    # ç­›é€‰æ‰€æœ‰æ®µè½æ ·å¼å¹¶æ‰“å°åç§°
    print("\n=== æ‰€æœ‰æ®µè½æ ·å¼ ===")
    paragraph_styles = [s for s in styles if s.type == WD_STYLE_TYPE.PARAGRAPH]
    for style in paragraph_styles[:5]:  # åªæ‰“å°å‰5ä¸ªé¿å…è¾“å‡ºè¿‡é•¿
        print(f"- {style.name}")
    
    # 3. åº”ç”¨ç°æœ‰æ ·å¼åˆ°æ–°æ®µè½
    # æ–¹å¼1: åˆ›å»ºæ—¶æŒ‡å®šæ ·å¼åç§°
    doc.add_heading("æ ·å¼æ“ä½œç¤ºä¾‹", level=0)
    heading1_para = doc.add_paragraph("è¿™æ˜¯åº”ç”¨ Heading 1 æ ·å¼çš„æ®µè½", style="Heading 1")
    # æ–¹å¼2: å…ˆåˆ›å»ºæ®µè½å†èµ‹å€¼æ ·å¼å¯¹è±¡
    normal_para = doc.add_paragraph()
    normal_para.text = "è¿™æ˜¯å…ˆåˆ›å»ºå†åº”ç”¨ Normal æ ·å¼çš„æ®µè½"
    normal_para.style = styles["Normal"]
    
    # 4. åˆ›å»ºè‡ªå®šä¹‰æ ·å¼
    # 4.1 åˆ›å»ºæ®µè½æ ·å¼å¹¶è®¾ç½®åŸºç¡€æ ·å¼ã€å­—ç¬¦æ ¼å¼ã€æ®µè½æ ¼å¼
    citation_style = styles.add_style("Citation", WD_STYLE_TYPE.PARAGRAPH)
    # è®¾ç½®åŸºç¡€æ ·å¼ï¼ˆç»§æ‰¿ Normal æ ·å¼çš„æ ¼å¼ï¼‰
    citation_style.base_style = styles["Normal"]
    # è®¾ç½®å­—ç¬¦æ ¼å¼
    citation_style.font.name = "å®‹ä½“"
    citation_style.font.size = Pt(10)
    citation_style.font.italic = True  # æ–œä½“
    citation_style.font.underline = WD_UNDERLINE.DOT_DASH  # ç‚¹åˆ’çº¿ä¸‹åˆ’çº¿
    # è®¾ç½®æ®µè½æ ¼å¼ï¼ˆæ‚¬æŒ‚ç¼©è¿›ã€æ®µå‰é—´è·ï¼‰
    citation_style.paragraph_format.left_indent = Inches(0.25)
    citation_style.paragraph_format.first_line_indent = Inches(-0.25)
    citation_style.paragraph_format.space_before = Pt(6)
    # è®¾ç½®åç»­æ®µè½æ ·å¼
    citation_style.next_paragraph_style = styles["Normal"]
    
    # åº”ç”¨è‡ªå®šä¹‰æ ·å¼
    citation_para = doc.add_paragraph("è¿™æ˜¯è‡ªå®šä¹‰ Citation æ ·å¼çš„å¼•ç”¨æ–‡æœ¬", style="Citation")
    print(f"\nè‡ªå®šä¹‰æ ·å¼åº”ç”¨ååç§°: {citation_para.style.name}")
    
    # 5. æ§åˆ¶æ ·å¼åœ¨ Word ä¸­çš„æ˜¾ç¤ºï¼ˆå¿«é€Ÿæ ·å¼ã€ä¼˜å…ˆçº§ï¼‰
    body_text_style = styles["Body Text"]
    body_text_style.hidden = False
    body_text_style.quick_style = True
    body_text_style.priority = 1
    
    # 6. å¤„ç†æ½œåœ¨æ ·å¼ï¼ˆLatent Stylesï¼‰
    latent_styles = styles.latent_styles
    print(f"\næ½œåœ¨æ ·å¼æ€»æ•°: {len(latent_styles)}")
    
    # ä¸º List Bullet æ·»åŠ æ½œåœ¨æ ·å¼å®šä¹‰
    if "List Bullet" not in latent_styles:
        latent_list_bullet = latent_styles.add_latent_style("List Bullet")
        latent_list_bullet.hidden = False
        latent_list_bullet.priority = 2
        latent_list_bullet.quick_style = True
    print(f"List Bullet æ½œåœ¨æ ·å¼ä¼˜å…ˆçº§: {latent_styles['List Bullet'].priority}")
    
    # 7. åˆ é™¤æ ·å¼
    print(f"\nåˆ é™¤å‰æ ·å¼æ•°é‡: {len(styles)}")
    if "Citation" in styles:
        styles["Citation"].delete()
        print(f"åˆ é™¤åæ ·å¼æ•°é‡: {len(styles)}")
    
    # 8. ä¿å­˜æ–‡æ¡£
    doc.save("æ ·å¼æ“ä½œç¤ºä¾‹.docx")
    print("\næ–‡æ¡£å·²ä¿å­˜ä¸º: æ ·å¼æ“ä½œç¤ºä¾‹.docx")
    

### 1.3.2 æ‰¹æ³¨ç®¡ç†

Wordæ”¯æŒåœ¨æ–‡æ¡£ä¸­æ·»åŠ æ‰¹æ³¨ï¼Œè¿™æ˜¯å®¡é˜…åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸ç”¨äºä»–äººåœ¨ä¸ä¿®æ”¹åŸæ–‡çš„æƒ…å†µä¸‹æä¾›åé¦ˆã€‚Wordæ–‡æ¡£é‡Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š

1.  é€‰å–æ–‡æœ¬èŒƒå›´ï¼›
2.  ç‚¹å‡»å®¡é˜…å·¥å…·æ ä¸­çš„æ–°å»ºæ‰¹æ³¨ï¼›
3.  è¾“å…¥æˆ–ç²˜è´´æ‰¹æ³¨å†…å®¹ã€‚

æ‰¹æ³¨ä»…èƒ½æ·»åŠ è‡³æ–‡æ¡£ä¸»ä½“ï¼Œä¸å¯æ’å…¥é¡µçœ‰ã€é¡µè„šæˆ–å…¶ä»–æ‰¹æ³¨å†…ã€‚Wordæ–‡æ¡£é‡Œè„šæ³¨å’Œå°¾æ³¨ä¸­ç†è®ºä¸Šå…è®¸æ·»åŠ æ‰¹æ³¨ï¼Œä½†å½“å‰python-docxæš‚ä¸æ”¯æŒè¯¥æ“ä½œã€‚æ­¤å¤–é«˜ç‰ˆæœ¬Wordæ”¯æŒè§£å†³æ‰¹æ³¨å’Œå›å¤æ‰¹æ³¨åŠŸèƒ½ï¼Œä½†python-docxæš‚æœªå®ç°ã€‚ä»¥ä¸‹æ˜¯åŒ…å«æ‰¹æ³¨åˆ›å»ºã€å¯Œæ–‡æœ¬æ‰¹æ³¨ã€å…ƒæ•°æ®ä¿®æ”¹åŠæ‰¹æ³¨éå†çš„å®Œæ•´ç¤ºä¾‹ï¼š

    # å¯¼å…¥å¿…è¦çš„åº“
    from docx import Document
    from datetime import datetime, timezone
    
    """
    åˆ›å»ºæ–‡æ¡£å¹¶æ¼”ç¤ºæ‰¹æ³¨çš„å®Œæ•´æ“ä½œæµç¨‹ï¼š
    1. åˆ›å»ºåŸºç¡€æ‰¹æ³¨
    2. åˆ›å»ºå¯Œæ–‡æœ¬æ ¼å¼æ‰¹æ³¨
    3. ä¿®æ”¹æ‰¹æ³¨å…ƒæ•°æ®
    4. è®¿é—®å’Œéå†æ‰€æœ‰æ‰¹æ³¨
    """
    # 1. åˆå§‹åŒ–æ–‡æ¡£å¯¹è±¡
    doc = Document()
    doc.add_heading("Python-docx æ‰¹æ³¨æ¼”ç¤ºæ–‡æ¡£", level=1)
    
    # 2. ç¤ºä¾‹1ï¼šåˆ›å»ºåŸºç¡€æ–‡æœ¬æ‰¹æ³¨
    para1 = doc.add_paragraph("è¿™æ˜¯ç¬¬ä¸€æ®µæµ‹è¯•æ–‡æœ¬ï¼Œç”¨äºæ·»åŠ åŸºç¡€æ‰¹æ³¨ã€‚")
    # ä¸ºæ•´æ®µæ–‡æœ¬æ·»åŠ åŸºç¡€æ‰¹æ³¨
    basic_comment = doc.add_comment(
        runs=para1.runs,  # å…³è”çš„æ–‡æœ¬å—
        text="åŸºç¡€æ‰¹æ³¨ï¼šè¿™æ®µæ–‡æœ¬è¡¨è¿°æ¸…æ™°ï¼Œå»ºè®®ä¿ç•™ã€‚",  # æ‰¹æ³¨çº¯æ–‡æœ¬å†…å®¹
        author="å¼ ä¸‰",  # æ‰¹æ³¨ä½œè€…
        initials="ZS"  # ä½œè€…ç¼©å†™
    )
    print(f"âœ… åŸºç¡€æ‰¹æ³¨åˆ›å»ºå®Œæˆ")
    # 3. ç¤ºä¾‹2ï¼šåˆ›å»ºå¯Œæ–‡æœ¬æ ¼å¼æ‰¹æ³¨ï¼ˆåŒ…å«ç²—ä½“ã€æ–œä½“ç­‰æ ·å¼ï¼‰
    para2 = doc.add_paragraph("è¿™æ˜¯ç¬¬äºŒæ®µæµ‹è¯•æ–‡æœ¬ï¼Œç”¨äºæ·»åŠ å¯Œæ–‡æœ¬æ‰¹æ³¨ã€‚")
    # åˆ›å»ºç©ºå†…å®¹æ‰¹æ³¨ï¼ˆåç»­æ‰‹åŠ¨æ·»åŠ å¯Œæ–‡æœ¬ï¼‰
    rich_comment = doc.add_comment(
        runs=para2.runs,
        text="",  # åˆå§‹ä¸ºç©ºï¼Œåç»­æ·»åŠ å¯Œæ–‡æœ¬
        author="æå››",
        initials="LS"
    )
    # å‘æ‰¹æ³¨ä¸­æ·»åŠ å¯Œæ–‡æœ¬å†…å®¹
    cmt_para = rich_comment.paragraphs[0]  # è·å–æ‰¹æ³¨çš„é»˜è®¤æ®µè½
    cmt_para.add_run("å¯Œæ–‡æœ¬æ‰¹æ³¨ï¼š")  # æ™®é€šæ–‡æœ¬
    cmt_para.add_run("é‡ç‚¹å»ºè®®ï¼š").bold = True  # ç²—ä½“æ–‡æœ¬
    cmt_para.add_run("è¿™æ®µæ–‡æœ¬éœ€è¦è¡¥å……æ¡ˆä¾‹ï¼Œ").italic = True  # æ–œä½“æ–‡æœ¬
    cmt_para.add_run("å»ºè®®å‚è€ƒè¡Œä¸šæ ‡å‡†ã€‚")  # æ™®é€šæ–‡æœ¬
    
    # 4. ç¤ºä¾‹3ï¼šä¿®æ”¹æ‰¹æ³¨å…ƒæ•°æ®ï¼ˆä½œè€…ã€ç¼©å†™ï¼‰
    basic_comment.author = "å¼ å°ä¸‰"  # ä¿®æ”¹ä½œè€…å
    basic_comment.initials = "ZXS"  # ä¿®æ”¹ä½œè€…ç¼©å†™
    print(f"âœ… åŸºç¡€æ‰¹æ³¨å…ƒæ•°æ®å·²æ›´æ–°ï¼šä½œè€…={basic_comment.author}ï¼Œç¼©å†™={basic_comment.initials}")
    
    # 5. ç¤ºä¾‹4ï¼šè®¿é—®å’Œéå†æ‰€æœ‰æ‰¹æ³¨
    print("\nğŸ“‹ æ–‡æ¡£ä¸­æ‰€æœ‰æ‰¹æ³¨ä¿¡æ¯ï¼š")
    for idx, comment in enumerate(doc.comments):
        print(f"\næ‰¹æ³¨ {idx+1}ï¼š")
        print(f"  ä½œè€…ï¼š{comment.author}")
        print(f"  ç¼©å†™ï¼š{comment.initials}")
        # æå–æ‰¹æ³¨çš„å®Œæ•´æ–‡æœ¬ï¼ˆå…¼å®¹å¯Œæ–‡æœ¬ï¼‰
        comment_text = "\n  ".join([para.text for para in comment.paragraphs])
        print(f"  å†…å®¹ï¼š{comment_text}")
    
    # 6. ä¿å­˜æ–‡æ¡£
    doc.save("æ‰¹æ³¨æ¼”ç¤ºæ–‡æ¡£.docx")
    print("\nğŸ“„ æ–‡æ¡£å·²ä¿å­˜ä¸ºï¼šæ‰¹æ³¨æ¼”ç¤ºæ–‡æ¡£.docx")
    

### 1.3.3 å›¾ç‰‡å¯¹è±¡

Wordæ–‡æ¡£ä¸­çš„å†…å®¹åˆ†ä¸ºä¸¤ä¸ªå›¾å±‚ï¼šæ–‡æœ¬å±‚å’Œç»˜å›¾å±‚ã€‚æ–‡æœ¬å±‚æŒ‰ä»å·¦åˆ°å³ã€è‡ªä¸Šè€Œä¸‹çš„é¡ºåºæ’åˆ—ï¼Œé¡µæ»¡åˆ™è‡ªåŠ¨æ¢é¡µã€‚ç»˜å›¾å±‚ä¸­çš„å¯¹è±¡ç§°ä¸ºå½¢çŠ¶ï¼Œå¯è‡ªç”±æ”¾ç½®ã€‚å›¾ç‰‡æ˜¯ä¸€ç§ç‰¹æ®Šå½¢çŠ¶ï¼Œå¯ç½®äºæ–‡æœ¬å±‚æˆ–ç»˜å›¾å±‚ã€‚ä½äºæ–‡æœ¬å±‚çš„å›¾ç‰‡ç§°ä¸ºåµŒå…¥å¼å›¾ç‰‡ï¼Œå®ƒåœ¨æ’ç‰ˆä¸­è¢«è§†ä¸ºä¸€ä¸ªå¤§å‹æ–‡æœ¬å­—ç¬¦ï¼šè¡Œé«˜ä¼šè‡ªåŠ¨è°ƒæ•´ä»¥å®¹çº³å›¾ç‰‡ï¼Œå¹¶æ”¯æŒç±»ä¼¼æ–‡æœ¬çš„æ¢è¡Œæ•ˆæœã€‚è‹¥åœ¨å…¶å‰æ–¹æ’å…¥æ–‡æœ¬ï¼Œå›¾ç‰‡ä¼šéšä¹‹å‘åç§»åŠ¨ã€‚åµŒå…¥å¼å›¾ç‰‡é€šå¸¸ç‹¬å ä¸€ä¸ªæ®µè½ï¼Œä½†ä¹Ÿå¯ä¸å‰åæ–‡æœ¬å…±å­˜äºåŒä¸€æ®µè½ä¸­ã€‚

å½“å‰python-docxåº“ä»…æ”¯æŒåµŒå…¥å¼å›¾ç‰‡ã€‚é€šè¿‡Document.add\_picture()æ–¹æ³•å¯å°†å›¾ç‰‡é»˜è®¤æ·»åŠ è‡³æ–‡æ¡£æœ«å°¾çš„ç‹¬ç«‹æ®µè½ä¸­ï¼Œä½†ç»è¿‡é€‚å½“è®¾ç½®ï¼Œä¹Ÿèƒ½å®ç°çµæ´»çš„å›¾æ–‡æ··æ’æ•ˆæœï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

    from docx import Document
    from docx.shared import Inches, Pt
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    
    # 1. åˆ›å»ºä¸€ä¸ªæ–°çš„Wordæ–‡æ¡£
    doc = Document()
    
    # 2. åŸºç¡€ç”¨æ³•ï¼šåœ¨æ–‡æ¡£æœ«å°¾æ’å…¥å›¾ç‰‡ï¼ˆå•ç‹¬å ä¸€ä¸ªæ®µè½ï¼‰
    doc.add_heading('1. åŸºç¡€æ’å…¥å›¾ç‰‡', level=2)
    # æ·»åŠ å›¾ç‰‡ï¼Œè®¾ç½®å®½åº¦ä¸º2è‹±å¯¸ï¼ˆé«˜åº¦ä¼šæŒ‰æ¯”ä¾‹è‡ªåŠ¨è°ƒæ•´ï¼‰
    doc.add_picture('test.png', width=Inches(2))
    
    # 3. è¿›é˜¶ç”¨æ³•ï¼šå›¾æ–‡æ··æ’ï¼ˆå›¾ç‰‡å’Œæ–‡æœ¬åœ¨åŒä¸€ä¸ªæ®µè½ï¼‰
    doc.add_heading('2. å›¾æ–‡æ··æ’ç¤ºä¾‹', level=2)
    # åˆ›å»ºä¸€ä¸ªæ–°æ®µè½
    mixed_paragraph = doc.add_paragraph()
    # æ·»åŠ æ–‡æœ¬åˆ°æ®µè½å¼€å¤´
    mixed_paragraph.add_run('è¿™æ˜¯å›¾ç‰‡å·¦ä¾§çš„æ–‡æœ¬ï¼Œ')
    # åœ¨æ®µè½ä¸­æ’å…¥å›¾ç‰‡ï¼ˆéå•ç‹¬æ®µè½ï¼‰
    img_run = mixed_paragraph.add_run()
    img_run.add_picture('test.png', width=Inches(1))
    # åœ¨å›¾ç‰‡å³ä¾§æ·»åŠ æ–‡æœ¬
    mixed_paragraph.add_run('è¿™æ˜¯å›¾ç‰‡å³ä¾§çš„æ–‡æœ¬ã€‚')
    
    # 4. è‡ªå®šä¹‰å›¾ç‰‡å°ºå¯¸+æ®µè½å¯¹é½
    doc.add_heading('3. è‡ªå®šä¹‰å°ºå¯¸ä¸å¯¹é½', level=2)
    align_para = doc.add_paragraph()
    align_para.alignment = WD_ALIGN_PARAGRAPH.CENTER  # æ®µè½å±…ä¸­å¯¹é½
    align_run = align_para.add_run()
    # åŒæ—¶è®¾ç½®å®½åº¦å’Œé«˜åº¦ï¼ˆæ³¨æ„ï¼šå¯èƒ½å¯¼è‡´å›¾ç‰‡å˜å½¢ï¼‰
    align_run.add_picture('test.png', width=Inches(1.5), height=Inches(1))
    align_para.add_run('\nè¿™æ˜¯å±…ä¸­æ˜¾ç¤ºçš„å›¾ç‰‡')
    
    # 5. ä¿å­˜æ–‡æ¡£
    doc.save('å½¢çŠ¶å›¾ç‰‡ç¤ºä¾‹.docx')
    print("æ–‡æ¡£å·²ä¿å­˜ä¸ºå½¢çŠ¶å›¾ç‰‡ç¤ºä¾‹.docx")
    

1.4 ç»¼åˆç¤ºä¾‹
--------

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œpython-docxä¸»è¦è¢«ç”¨äºæ–‡æ¡£ä¿®æ”¹å’Œè‡ªåŠ¨åŒ–ç”Ÿæˆï¼Œè€Œéä»å¤´åˆ›å»ºæ–‡æ¡£ã€‚æœ¬èŠ‚å°†é€šè¿‡ä¸€ä¸ªç»¼åˆç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•å¯¹ä¸€ä¸ªåŒ…å«æ ‡é¢˜ã€æ®µè½ã€å¤šç§è¡¨æ ¼ã€å¤šå¼ å›¾ç‰‡å’Œåˆ†é¡µç¬¦çš„å¤šé¡µæ–‡æ¡£è¿›è¡Œé’ˆå¯¹æ€§ä¿®æ”¹ï¼Œå¹¶æä¾›ç›¸åº”çš„æ–‡æ¡£ç”Ÿæˆä»£ç ã€‚

![](https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/2.jpg)

**æ–‡æ¡£ç”Ÿæˆ**

ä»¥ä¸‹ä»£ç ç”Ÿæˆä¸€ä¸ªç¤ºä¾‹å¤šé¡µæ–‡æ¡£ï¼Œæ¶µç›–äº†æ—¥å¸¸åŠå…¬ä¸­å¸¸è§çš„æ–‡æ¡£ç»“æ„ï¼š

    from docx import Document
    from docx.shared import Inches, Pt
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    from docx.enum.table import WD_TABLE_ALIGNMENT
    from docx.oxml.ns import qn
    import os
    
    def ensure_test_images():
        # ç®€å•ç”Ÿæˆæµ‹è¯•å›¾ç‰‡ï¼ˆå¦‚æœæ²¡æœ‰çš„è¯ï¼‰
        try:
            from PIL import Image
            for i in range(1, 3):
                img_path = f"image{i}.jpg"
                if not os.path.exists(img_path):
                    img = Image.new('RGB', (800, 600), color='lightblue')
                    img.save(img_path)
            print("æµ‹è¯•å›¾ç‰‡å·²å‡†å¤‡å®Œæˆ")
        except ImportError:
            print("è¯·å®‰è£…pillowåº“ï¼špip install pillow")
            exit(1)
    
    # ç”ŸæˆWordæ–‡æ¡£
    def generate_complex_doc():
        # åˆ›å»ºæ–°æ–‡æ¡£
        doc = Document()
        
        # è®¾ç½®æ–‡æ¡£é»˜è®¤å­—ä½“ï¼ˆè§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼‰
        doc.styles['Normal'].font.name = 'å¾®è½¯é›…é»‘'
        doc.styles['Normal']._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
        
        # ========== ç¬¬ä¸€é¡µå†…å®¹ ==========
        # æ ‡é¢˜
        title = doc.add_heading('XXé¡¹ç›®è°ƒç ”æŠ¥å‘Š', 0)
        title.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±…ä¸­å¯¹é½
        title_run = title.runs[0]
        title_run.font.size = Pt(24)
        title_run.font.bold = True
        
        # å‰¯æ ‡é¢˜/è¯´æ˜
        sub_para = doc.add_paragraph('æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š2026å¹´1æœˆ  æŠ¥å‘Šç¼–åˆ¶äººï¼šæµ‹è¯•ç”¨æˆ·')
        sub_para.alignment = WD_ALIGN_PARAGRAPH.RIGHT
        sub_para_run = sub_para.runs[0]
        sub_para_run.font.size = Pt(10)
        
        # æ­£æ–‡æ®µè½
        doc.add_heading('ä¸€ã€é¡¹ç›®æ¦‚è¿°', level=1)
        overview_para = doc.add_paragraph()
        overview_para.add_run('æœ¬é¡¹ç›®é’ˆå¯¹ä¼ä¸šæ•°å­—åŒ–è½¬å‹éœ€æ±‚ï¼Œé‡ç‚¹è§£å†³ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿæ•°æ®å­¤å²›ã€æµç¨‹ä¸è§„èŒƒã€å†³ç­–æ•ˆç‡ä½ç­‰æ ¸å¿ƒé—®é¢˜ã€‚').font.size = Pt(12)
        overview_para.add_run('\né¡¹ç›®è¦†ç›–èŒƒå›´åŒ…æ‹¬ï¼š').font.bold = True
        overview_para.add_run('\n1) ç”Ÿäº§ç®¡ç†æ¨¡å—ï¼šå®ç°ç”Ÿäº§æµç¨‹è‡ªåŠ¨åŒ–ç›‘æ§')
        overview_para.add_run('\n2) é”€å”®ç®¡ç†æ¨¡å—ï¼šæ‰“é€šå®¢æˆ·æ•°æ®ä¸è®¢å•ç³»ç»Ÿ')
        overview_para.add_run('\n3) è´¢åŠ¡ç®¡ç†æ¨¡å—ï¼šå®ç°è´¢åŠ¡æ•°æ®å®æ—¶æ±‡æ€»åˆ†æ')
        
        # ç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼šé¡¹ç›®åŸºç¡€ä¿¡æ¯è¡¨ï¼ˆ2è¡Œ4åˆ—ï¼‰
        doc.add_heading('1.1 é¡¹ç›®åŸºç¡€ä¿¡æ¯', level=2)
        table1 = doc.add_table(rows=2, cols=4)
        table1.alignment = WD_TABLE_ALIGNMENT.CENTER  # è¡¨æ ¼å±…ä¸­
        table1.style = 'Table Grid'  # å¸¦è¾¹æ¡†æ ·å¼
        
        # å¡«å……è¡¨æ ¼1è¡¨å¤´
        hdr_cells = table1.rows[0].cells
        hdr_cells[0].text = 'é¡¹ç›®ç¼–å·'
        hdr_cells[1].text = 'é¡¹ç›®åç§°'
        hdr_cells[2].text = 'å¯åŠ¨æ—¶é—´'
        hdr_cells[3].text = 'é¢„è®¡å·¥æœŸ'
        
        # å¡«å……è¡¨æ ¼1å†…å®¹
        row_cells = table1.rows[1].cells
        row_cells[0].text = 'XM2026001'
        row_cells[1].text = 'ä¼ä¸šæ•°å­—åŒ–è½¬å‹é¡¹ç›®'
        row_cells[2].text = '2026-01-01'
        row_cells[3].text = '12ä¸ªæœˆ'
        
        # è°ƒæ•´è¡¨æ ¼1å•å…ƒæ ¼å­—ä½“
        for row in table1.rows:
            for cell in row.cells:
                for paragraph in cell.paragraphs:
                    for run in paragraph.runs:
                        run.font.size = Pt(10)
                        run.font.name = 'å¾®è½¯é›…é»‘'
                        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
        
        # æ’å…¥ç¬¬ä¸€å¼ å›¾ç‰‡
        doc.add_heading('1.2 é¡¹ç›®æ¶æ„å›¾', level=2)
        img1_para = doc.add_paragraph()
        img1_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        img1_run = img1_para.add_run()
        img1_run.add_picture('image1.jpg', width=Inches(5))  # å›¾ç‰‡å®½åº¦5è‹±å¯¸
        img1_para.add_run('\nå›¾1ï¼šé¡¹ç›®æ•´ä½“æ¶æ„å›¾').font.size = Pt(10)
        
        # æ’å…¥åˆ†é¡µç¬¦ï¼ˆç¬¬ä¸€é¡µç»“æŸï¼‰
        doc.add_page_break()
        
        # ========== ç¬¬äºŒé¡µå†…å®¹ ==========
        doc.add_heading('äºŒã€é¡¹ç›®èµ„æºé…ç½®', level=1)
        resource_para = doc.add_paragraph('æœ¬é¡¹ç›®æ‰€éœ€èµ„æºåŒ…æ‹¬äººåŠ›èµ„æºã€ç¡¬ä»¶èµ„æºã€è½¯ä»¶èµ„æºä¸‰å¤§ç±»ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š')
        
        # ç¬¬äºŒä¸ªè¡¨æ ¼ï¼šèµ„æºé…ç½®è¡¨ï¼ˆ5è¡Œ3åˆ—ï¼‰
        table2 = doc.add_table(rows=5, cols=3)
        table2.style = 'Table Grid'
        table2.alignment = WD_TABLE_ALIGNMENT.CENTER
        
        # å¡«å……è¡¨æ ¼2
        table2_data = [
            ['èµ„æºç±»å‹', 'è§„æ ¼/æ•°é‡', 'å¤‡æ³¨'],
            ['äººåŠ›èµ„æº', 'é¡¹ç›®ç»ç†1äººï¼Œå¼€å‘å·¥ç¨‹å¸ˆ5äººï¼Œæµ‹è¯•å·¥ç¨‹å¸ˆ2äºº', 'å‡ä¸ºå…¨èŒ'],
            ['æœåŠ¡å™¨', '8æ ¸16Gäº‘æœåŠ¡å™¨3å°', 'é˜¿é‡Œäº‘ECS'],
            ['æ•°æ®åº“', 'MySQL 8.0 ä¸»ä»æ¶æ„', 'æ•°æ®å®æ—¶å¤‡ä»½'],
            ['è½¯ä»¶æˆæƒ', 'Pythonã€Officeã€å¼€å‘å·¥å…·', 'ä¼ä¸šç‰ˆæˆæƒ']
        ]
        
        for i, row_data in enumerate(table2_data):
            row_cells = table2.rows[i].cells
            for j, cell_text in enumerate(row_data):
                row_cells[j].text = cell_text
                # è®¾ç½®å•å…ƒæ ¼å­—ä½“
                for paragraph in row_cells[j].paragraphs:
                    for run in paragraph.runs:
                        run.font.size = Pt(10)
                        run.font.name = 'å¾®è½¯é›…é»‘'
                        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
            # è¡¨å¤´åŠ ç²—
            if i == 0:
                for cell in table2.rows[i].cells:
                    for paragraph in cell.paragraphs:
                        for run in paragraph.runs:
                            run.font.bold = True
        
        # æ’å…¥ç¬¬äºŒå¼ å›¾ç‰‡
        doc.add_heading('2.1 èµ„æºéƒ¨ç½²ç¤ºæ„å›¾', level=2)
        img2_para = doc.add_paragraph()
        img2_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        img2_run = img2_para.add_run()
        img2_run.add_picture('image2.jpg', width=Inches(5))
        img2_para.add_run('\nå›¾2ï¼šèµ„æºéƒ¨ç½²æ‹“æ‰‘å›¾').font.size = Pt(10)
        
        # è¡¥å……æ®µè½å†…å®¹
        doc.add_paragraph('èµ„æºé…ç½®éµå¾ªã€Œå¤Ÿç”¨ä¸”é¢„ç•™æ‰©å±•ã€åŸåˆ™ï¼Œç¡¬ä»¶èµ„æºå¯æ ¹æ®é¡¹ç›®è¿›åº¦å¼¹æ€§æ‰©å®¹ï¼ŒäººåŠ›èµ„æºé‡‡ç”¨ã€Œæ ¸å¿ƒ+å¤–åã€æ¨¡å¼ä¿éšœäº¤ä»˜è¿›åº¦ã€‚')
        
        # æ’å…¥åˆ†é¡µç¬¦ï¼ˆç¬¬äºŒé¡µç»“æŸï¼‰
        doc.add_page_break()
        
        # ========== ç¬¬ä¸‰é¡µå†…å®¹ ==========
        doc.add_heading('ä¸‰ã€é¡¹ç›®é£é™©è¯„ä¼°', level=1)
        risk_para = doc.add_paragraph('é€šè¿‡å¯¹æŠ€æœ¯ã€äººå‘˜ã€æˆæœ¬ã€è¿›åº¦å››ä¸ªç»´åº¦çš„è¯„ä¼°ï¼Œè¯†åˆ«å‡ºä»¥ä¸‹æ ¸å¿ƒé£é™©ç‚¹åŠåº”å¯¹æªæ–½ï¼š')
        
        # ç¬¬ä¸‰ä¸ªè¡¨æ ¼ï¼šé£é™©è¯„ä¼°è¡¨ï¼ˆ4è¡Œ4åˆ—ï¼‰
        table3 = doc.add_table(rows=4, cols=4)
        table3.style = 'Table Grid'
        table3.alignment = WD_TABLE_ALIGNMENT.CENTER
        
        table3_data = [
            ['é£é™©ç±»å‹', 'é£é™©ç­‰çº§', 'å½±å“èŒƒå›´', 'åº”å¯¹æªæ–½'],
            ['æŠ€æœ¯é£é™©', 'ä¸­', 'æ ¸å¿ƒåŠŸèƒ½æ¨¡å—', 'æå‰è¿›è¡ŒæŠ€æœ¯é¢„ç ”ï¼Œåˆ¶å®šå¤‡é€‰æ–¹æ¡ˆ'],
            ['è¿›åº¦é£é™©', 'ä½', 'æ•´ä½“äº¤ä»˜', 'è®¾ç½®é‡Œç¨‹ç¢‘èŠ‚ç‚¹ï¼Œæ¯å‘¨è¿›åº¦å¤ç›˜'],
            ['æˆæœ¬é£é™©', 'ä½', 'é¢„ç®—ç®¡æ§', 'å»ºç«‹æˆæœ¬å°è´¦ï¼Œè¶…æ”¯æå‰é¢„è­¦']
        ]
        
        for i, row_data in enumerate(table3_data):
            row_cells = table3.rows[i].cells
            for j, cell_text in enumerate(row_data):
                row_cells[j].text = cell_text
                for paragraph in row_cells[j].paragraphs:
                    for run in paragraph.runs:
                        run.font.size = Pt(10)
                        run.font.name = 'å¾®è½¯é›…é»‘'
                        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
            if i == 0:
                for cell in table3.rows[i].cells:
                    for paragraph in cell.paragraphs:
                        for run in paragraph.runs:
                            run.font.bold = True
        
        # ç»“å°¾æ®µè½
        doc.add_paragraph('\nç»¼ä¸Šæ‰€è¿°ï¼Œæœ¬é¡¹ç›®æ•´ä½“å¯æ§ï¼Œé€šè¿‡ç§‘å­¦çš„èµ„æºé…ç½®å’Œé£é™©ç®¡æ§æªæ–½ï¼Œèƒ½å¤Ÿä¿éšœé¡¹ç›®æŒ‰è®¡åˆ’äº¤ä»˜å¹¶è¾¾åˆ°é¢„æœŸç›®æ ‡ã€‚')
        
        # ä¿å­˜æ–‡æ¡£
        doc.save('é¡¹ç›®æŠ¥å‘Š.docx')
        print("é¡¹ç›®æŠ¥å‘Šæ–‡æ¡£å·²ç”Ÿæˆ")
    
    if __name__ == '__main__':
        ensure_test_images()  # å‡†å¤‡æµ‹è¯•å›¾ç‰‡
        generate_complex_doc()
    

**æ–‡æ¡£ä¿®æ”¹**

æ–‡æ¡£ä¿®æ”¹ä»£ç é’ˆå¯¹ä¸Šè¿°ç”Ÿæˆçš„æ–‡æ¡£ï¼Œå®ç°ä»¥ä¸‹å¸¸è§ä¿®æ”¹éœ€æ±‚ï¼š

*   ä¿®æ”¹æ ‡é¢˜å’Œæ®µè½æ–‡æœ¬
*   ä¿®æ”¹è¡¨æ ¼ä¸­çš„å†…å®¹
*   æ›¿æ¢å›¾ç‰‡
*   æ·»åŠ æ–°çš„æ®µè½å’Œè¡¨æ ¼
*   ä¿®æ”¹å­—ä½“æ ·å¼

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    from docx import Document
    from docx.shared import Inches, Pt
    from docx.shared import RGBColor
    from docx.enum.table import WD_TABLE_ALIGNMENT
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    from docx.oxml.ns import qn
    import os
    
    # ä¿®æ”¹å·²ç”Ÿæˆçš„Wordæ–‡æ¡£
    def modify_complex_doc(file_path):
        # æ‰“å¼€å·²ç”Ÿæˆçš„æ–‡æ¡£
        doc = Document(file_path)
        print("å·²æ‰“å¼€å¾…ä¿®æ”¹çš„æ–‡æ¡£")
        
        # ========== 1. ä¿®æ”¹æ ‡é¢˜ ==========
        # ç¬¬ä¸€ä¸ªæ ‡é¢˜æ˜¯çº§åˆ«0çš„æ ‡é¢˜ï¼ˆä¸»æ ‡é¢˜ï¼‰
        main_title = doc.paragraphs[0]
        main_title.runs[0].text = 'XXä¼ä¸šæ•°å­—åŒ–è½¬å‹é¡¹ç›®ç»ˆç‰ˆæŠ¥å‘Š'  # ä¿®æ”¹ä¸»æ ‡é¢˜æ–‡æœ¬
        main_title.runs[0].font.color.rgb = RGBColor(0, 0, 255)  # æ ‡é¢˜æ”¹ä¸ºè“è‰²
        main_title.runs[0].font.size = Pt(20)
        main_title.runs[0].font.name = 'å¾®è½¯é›…é»‘'
        main_title.runs[0]._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
        main_title.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        # ========== 2. ä¿®æ”¹æ®µè½æ–‡æœ¬ ==========
        # æ‰¾åˆ°"é¡¹ç›®æ¦‚è¿°"ä¸‹çš„æ®µè½ï¼ˆå¯é€šè¿‡æ–‡æœ¬ç‰¹å¾å®šä½ï¼‰
        for para in doc.paragraphs:
            if 'æœ¬é¡¹ç›®é’ˆå¯¹ä¼ä¸šæ•°å­—åŒ–è½¬å‹éœ€æ±‚' in para.text:
                # æ¸…ç©ºåŸæœ‰å†…å®¹ï¼Œé‡æ–°å†™å…¥
                para.clear()
                new_run = para.add_run('æœ¬é¡¹ç›®é’ˆå¯¹å¤§å‹åˆ¶é€ ä¼ä¸šæ•°å­—åŒ–è½¬å‹éœ€æ±‚ï¼Œé‡ç‚¹è§£å†³ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿæ•°æ®å­¤å²›ã€æµç¨‹ä¸è§„èŒƒã€å†³ç­–æ•ˆç‡ä½ç­‰æ ¸å¿ƒé—®é¢˜ã€‚')
                new_run.font.size = Pt(12)
                new_run.font.name = 'å¾®è½¯é›…é»‘'
                new_run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
                # è¿½åŠ å†…å®¹
                para.add_run('\né¡¹ç›®å‡çº§åæ–°å¢ï¼š')
                para.add_run('\n4) ä¾›åº”é“¾ç®¡ç†æ¨¡å—ï¼šæ‰“é€šä¸Šä¸‹æ¸¸ä¾›åº”å•†æ•°æ®')
                break
        
        # ========== 3. ä¿®æ”¹è¡¨æ ¼å†…å®¹å¹¶æ·»åŠ è¡¨æ ¼å ==========
        # è¡¨æ ¼1ï¼šé¡¹ç›®åŸºç¡€ä¿¡æ¯è¡¨ï¼ˆç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼‰
        table1 = doc.tables[0]
        # ä¿®æ”¹é¡¹ç›®ç¼–å·
        table1.rows[1].cells[0].text = 'XM2026001-FINAL'
        # ä¿®æ”¹é¢„è®¡å·¥æœŸ
        table1.rows[1].cells[3].text = '10ä¸ªæœˆ'
        # ç»™ä¿®æ”¹åçš„å•å…ƒæ ¼æ–‡å­—æ ‡çº¢
        for cell in [table1.rows[1].cells[0], table1.rows[1].cells[3]]:
            for para in cell.paragraphs:
                for run in para.runs:
                    run.font.color.rgb = RGBColor(255, 0, 0)
                    run.font.size = Pt(11)
                    run.font.name = 'å¾®è½¯é›…é»‘'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
        
        # ä¸ºè¡¨æ ¼1æ·»åŠ è¡¨æ ¼åï¼ˆè¡¨é¢˜ï¼‰
        # æ‰¾åˆ°è¡¨æ ¼1çš„ä½ç½®ï¼Œåœ¨è¡¨æ ¼ä¸Šæ–¹æ’å…¥è¡¨å
        table1_elem = table1._element
        table_caption1 = doc.add_paragraph('è¡¨1 é¡¹ç›®åŸºç¡€ä¿¡æ¯è¡¨')
        table_caption1.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±…ä¸­å¯¹é½
        table_caption1.paragraph_format.space_before = Pt(0)
        table_caption1.paragraph_format.space_after = Pt(0)
        # è®¾ç½®è¡¨åå­—ä½“æ ¼å¼
        for run in table_caption1.runs:
            run.font.size = Pt(11)
            run.font.name = 'å¾®è½¯é›…é»‘'
            run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
            run.font.bold = True  # åŠ ç²—
        # å°†è¡¨åæ’å…¥åˆ°è¡¨æ ¼ä¸Šæ–¹
        table1_elem.addprevious(table_caption1._element)
        
        # è¡¨æ ¼2ï¼šèµ„æºé…ç½®è¡¨ï¼ˆç¬¬äºŒä¸ªè¡¨æ ¼ï¼‰
        table2 = doc.tables[1]
        # ä¿®æ”¹æœåŠ¡å™¨é…ç½®
        table2.rows[3].cells[1].text = '16æ ¸32Gäº‘æœåŠ¡å™¨3å°ï¼ˆå‡çº§é…ç½®ï¼‰'
        # è®¾ç½®è¡¨æ ¼2å•å…ƒæ ¼å­—ä½“
        for row in table2.rows:
            for cell in row.cells:
                for para in cell.paragraphs:
                    for run in para.runs:
                        run.font.size = Pt(11)
                        run.font.name = 'å¾®è½¯é›…é»‘'
                        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
        
        # ä¸ºè¡¨æ ¼2æ·»åŠ è¡¨æ ¼åï¼ˆè¡¨é¢˜ï¼‰
        table2_elem = table2._element
        table_caption2 = doc.add_paragraph('è¡¨2 é¡¹ç›®èµ„æºé…ç½®è¡¨')
        table_caption2.alignment = WD_ALIGN_PARAGRAPH.CENTER
        for run in table_caption2.runs:
            run.font.size = Pt(11)
            run.font.name = 'å¾®è½¯é›…é»‘'
            run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
            run.font.bold = True
        table2_elem.addprevious(table_caption2._element)
        
        # ========== 4. æ›¿æ¢å›¾ç‰‡å¹¶è§„èŒƒå›¾å ==========
        # å…ˆå‡†å¤‡ä¸€å¼ æ–°çš„æµ‹è¯•å›¾ç‰‡
        from PIL import Image
        new_img_path = 'test.png'
        if not os.path.exists(new_img_path):
            img = Image.new('RGB', (800, 600), color='lightgreen')
            img.save(new_img_path)
        
        # æ‰¾åˆ°ç¬¬ä¸€å¼ å›¾ç‰‡æ‰€åœ¨çš„æ®µè½ï¼ˆé€šè¿‡å›¾ç‰‡ç›¸å…³ç‰¹å¾ï¼‰
        img_para_index = -1
        for i, para in enumerate(doc.paragraphs):
            if 'å›¾1ï¼šé¡¹ç›®æ•´ä½“æ¶æ„å›¾' in para.text or 'graphicData' in str(para._element.xml):
                img_para_index = i
                break
        
        if img_para_index != -1:
            # æ¸…ç©ºæ®µè½ä¸­çš„å›¾ç‰‡å’Œæ–‡å­—ï¼Œé‡æ–°æ·»åŠ 
            img_para = doc.paragraphs[img_para_index]
            img_para.clear()
            
            # é‡æ–°æ·»åŠ æ–°å›¾ç‰‡
            img_run = img_para.add_run()
            img_run.add_picture(new_img_path, width=Inches(5))
            
            # æ·»åŠ è§„èŒƒçš„å›¾åï¼ˆå›¾é¢˜ï¼‰
            img_caption = img_para.add_run('\nå›¾1 é¡¹ç›®æ•´ä½“æ¶æ„å›¾ï¼ˆç»ˆç‰ˆï¼‰')
            img_caption.font.size = Pt(10)
            img_caption.font.name = 'å¾®è½¯é›…é»‘'
            img_caption._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
            img_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        # ========== 5. æ·»åŠ æ–°å†…å®¹å¹¶ä¸ºæ–°è¡¨æ ¼åŠ è¡¨å ==========
        # åœ¨ç¬¬ä¸‰é¡µé£é™©è¯„ä¼°åæ·»åŠ æ–°çš„æ®µè½å’Œè¡¨æ ¼
        # å…ˆæ‰¾åˆ°é£é™©è¯„ä¼°æ ‡é¢˜çš„ä½ç½®ï¼Œåœ¨å…¶åæ·»åŠ å†…å®¹
        for i, para in enumerate(doc.paragraphs):
            if 'ä¸‰ã€é¡¹ç›®é£é™©è¯„ä¼°' in para.text:
                # æ·»åŠ æ–°çš„å­æ ‡é¢˜
                new_sub_heading = doc.add_heading('3.1 é£é™©åº”å¯¹é¢„æ¡ˆ', level=2)
                # æ’å…¥åˆ°æŒ‡å®šä½ç½®
                doc.paragraphs.insert(i+1, new_sub_heading)
                
                # æ·»åŠ æ–°æ®µè½
                new_para = doc.add_paragraph('é’ˆå¯¹é«˜ä¼˜å…ˆçº§é£é™©ï¼Œåˆ¶å®šä¸“é¡¹åº”å¯¹é¢„æ¡ˆï¼ŒåŒ…æ‹¬åº”æ€¥å“åº”æµç¨‹ã€å¤‡ç”¨èµ„æºè°ƒé…æ–¹æ¡ˆç­‰ï¼Œç¡®ä¿é£é™©å‘ç”Ÿæ—¶å¯å¿«é€Ÿå¤„ç½®ã€‚')
                new_para.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
                for run in new_para.runs:
                    run.font.size = Pt(12)
                    run.font.name = 'å¾®è½¯é›…é»‘'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
                doc.paragraphs.insert(i+2, new_para)
                
                # æ·»åŠ æ–°è¡¨æ ¼ï¼ˆåº”æ€¥é¢„æ¡ˆè¡¨ï¼‰
                new_table = doc.add_table(rows=2, cols=2)
                new_table.style = 'Table Grid'
                new_table.alignment = WD_TABLE_ALIGNMENT.CENTER
                # å¡«å……æ–°è¡¨æ ¼
                new_table.rows[0].cells[0].text = 'é£é™©ç±»å‹'
                new_table.rows[0].cells[1].text = 'åº”æ€¥è”ç³»äºº'
                new_table.rows[1].cells[0].text = 'æŠ€æœ¯é£é™©'
                new_table.rows[1].cells[1].text = 'å¼ å·¥ 13800138000'
                # è®¾ç½®æ–°è¡¨æ ¼å­—ä½“
                for row in new_table.rows:
                    for cell in row.cells:
                        for para_cell in cell.paragraphs:
                            for run in para_cell.runs:
                                run.font.size = Pt(10)
                                run.font.name = 'å¾®è½¯é›…é»‘'
                                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
                
                # ä¸ºæ–°è¡¨æ ¼æ·»åŠ è¡¨å
                new_table_caption = doc.add_paragraph('è¡¨3 é£é™©åº”æ€¥è”ç³»äººè¡¨')
                new_table_caption.alignment = WD_ALIGN_PARAGRAPH.CENTER
                for run in new_table_caption.runs:
                    run.font.size = Pt(11)
                    run.font.name = 'å¾®è½¯é›…é»‘'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯é›…é»‘')
                    run.font.bold = True
                
                # æ’å…¥æ–°è¡¨æ ¼åå’Œæ–°è¡¨æ ¼
                doc.element.body.insert(i+3, new_table_caption._element)
                doc.element.body.insert(i+4, new_table._element)
                break
        
        # ========== ä¿å­˜ä¿®æ”¹åçš„æ–‡æ¡£ ==========
        doc.save('é¡¹ç›®æŠ¥å‘Š_ä¿®æ”¹ç‰ˆ.docx')
        print("ä¿®æ”¹åçš„æ–‡æ¡£å·²ä¿å­˜ï¼šé¡¹ç›®æŠ¥å‘Š_ä¿®æ”¹ç‰ˆ.docx")
    
    if __name__ == '__main__':
        # ç¡®ä¿åŸæ–‡æ¡£å­˜åœ¨
        file_path = 'é¡¹ç›®æŠ¥å‘Š.docx'
        if not os.path.exists(file_path):
            print("è¯·å…ˆè¿è¡Œç”Ÿæˆä»£ç åˆ›å»ºåŸå§‹æ–‡æ¡£ï¼")
        else:
            modify_complex_doc(file_path)
    

2 å‚è€ƒ
====

*   [python-docx](https://github.com/python-openxml/python-docx)
*   [python-docx docs](https://python-docx.readthedocs.io/en/latest/)

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š[è½ç—•çš„å¯’å‡](https://www.cnblogs.com/luohenyueji/)ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/luohenyueji/p/19479110](https://www.cnblogs.com/luohenyueji/p/19479110)

![](https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/wechat/content/%E5%8A%A0%E6%B2%B9%E9%B8%AD.gif)