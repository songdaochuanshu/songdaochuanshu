---
layout: post
title: '.NET SDK 9.0.200引入对SLNX解决方案文件的支持'
date: "2025-07-23T00:45:33Z"
---
.NET SDK 9.0.200引入对SLNX解决方案文件的支持
================================

引言
--

解决方案文件长期以来一直是.NET和Visual Studio开发体验的重要组成部分，其格式在过去二十多年基本保持不变。最近，Visual Studio解决方案团队推出了一种基于XML的新格式——SLNX，旨在提供更简洁、更现代的解决方案文件格式。从.NET SDK 9.0.200开始，dotnet CLI正式支持生成和操作SLNX文件，为开发者带来了更高效的解决方案管理方式。本文将详细介绍如何迁移到新格式，探索dotnet CLI对SLNX的支持，并提供实际应用中的注意事项。

正文内容
----

### SLNX格式概述与优势

SLNX是一种基于XML的全新解决方案文件格式，相比传统的.sln文件具有显著优势。传统.sln文件采用自定义文本格式，包含大量重复的配置信息和GUID引用，而SLNX则采用简洁的XML结构，自动处理许多默认配置，使文件更加清晰易读。

以下是传统.sln文件与SLNX文件的对比示例：

    <!-- SLNX文件示例 -->
    <Solution>
      <Configurations>
        <Platform Name="Any CPU" />
        <Platform Name="x64" />
        <Platform Name="x86" />
      </Configurations>
      <Project Path="my-app/my-app.csproj" />
    </Solution>
    

    // 传统.sln文件示例
    Microsoft Visual Studio Solution File, Format Version 12.00
    # Visual Studio Version 17
    VisualStudioVersion = 17.0.31903.59
    MinimumVisualStudioVersion = 10.0.40219.1
    Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "my-app", "my-app\my-app.csproj", "{845B7716-6F03-4D02-8E86-79F95485B5D7}"
    EndProject
    [更多配置节...]
    

SLNX格式的优势包括：

1.  更小的文件体积
2.  更易读的XML结构
3.  自动处理默认配置
4.  更好的版本控制友好性
5.  未来可扩展性更强

这种格式转换的实现得益于Microsoft.VisualStudio.SolutionPersistence开源库，它提供了处理两种格式的统一API。

### 迁移到SLNX格式

#### 准备工作与迁移命令

在SDK 9.0.200之前，创建SLNX文件的唯一方式是通过Visual Studio设置。用户需要勾选"环境 > 预览功能 > 使用解决方案文件持久性模型"设置，才能将现有的.sln文件另存为.slnx格式。

从.NET SDK 9.0.200开始，可以使用命令行工具执行迁移：

    dotnet sln migrate
    

这条命令会读取当前目录下的.sln文件，并生成对应的.slnx文件，同时保留原始.sln文件。

#### 完整迁移示例

让我们通过一个完整的示例演示迁移过程：

1.  首先创建一个新的解决方案：

    PS C:\Users\chethusk\Code\example> dotnet new sln
    The template "Solution File" was created successfully.
    

2.  添加一个控制台项目到解决方案：

    PS C:\Users\chethusk\Code\example> dotnet new console -n my-app
    The template "Console App" was created successfully.
    
    PS C:\Users\chethusk\Code\example> dotnet sln add .\my-app\
    Project `my-app\my-app.csproj` added to the solution.
    

3.  执行迁移命令：

    PS C:\Users\chethusk\Code\example> dotnet sln migrate
    .slnx file C:\Users\chethusk\Code\example\example.slnx generated.
    

迁移后生成的.slnx文件将包含与原解决方案相同的项目引用和配置信息，但以更简洁的XML格式呈现。

### 使用dotnet CLI管理SLNX解决方案

#### 基本操作

dotnet CLI提供了与SLNX文件的完整交互支持，操作方式与传统.sln文件几乎相同：

1.  构建解决方案：

    PS C:\Users\chethusk\Code\example> dotnet build .\example.slnx
    Restore complete (0.6s)
      my-app succeeded (4.3s) → my-app\bin\Debug\net9.0\my-app.dll
    Build succeeded in 5.3s
    

**重要提示**：当目录中同时存在.sln和.slnx文件时，必须明确指定要构建的文件，否则会导致错误。

2.  添加新项目：

    PS C:\Users\chethusk\Code\example> dotnet new classlib -n my-lib
    The template "Class Library" was created successfully.
    
    PS C:\Users\chethusk\Code\example> dotnet sln .\example.slnx add my-lib
    Project `my-lib\my-lib.csproj` added to the solution.
    

3.  列出解决方案中的项目：

    PS C:\Users\chethusk\Code\example> dotnet sln .\example.slnx list
    Project(s)
    ----------
    my-app\my-app.csproj
    my-lib\my-lib.csproj
    

4.  移除项目：

    PS C:\Users\chethusk\Code\example> dotnet sln .\example.slnx remove .\my-lib\
    Project `my-lib\my-lib.csproj` removed from the solution.
    

#### 当前限制

在SDK 9.0.200版本中，有两个命令尚未支持SLNX文件：

*   `dotnet nuget why`
*   `dotnet list package`

根据计划，这两个命令将在2025年3月发布的9.0.201版本中开始支持SLNX格式。

### 生态系统支持现状

虽然dotnet CLI已全面支持SLNX格式，但生态系统中的其他工具支持程度不一，开发者在决定是否迁移时需要谨慎考虑。

#### Visual Studio支持

目前Visual Studio对SLNX文件的支持存在以下限制：

1.  除非启用了"使用解决方案文件持久性模型"预览功能，否则Visual Studio不会加载.slnx文件
2.  双击.slnx文件不会自动打开Visual Studio实例
3.  团队协作时，所有成员都需要启用SLNX持久性设置才能正常工作

这意味着如果团队中有成员未开启该设置，他们将无法打开SLNX文件，可能影响协作效率。

#### C# DevKit支持

C# DevKit可以通过配置支持SLNX文件，但需要手动设置：

    {
      "dotnet.defaultSolution": "example.slnx"
    }
    

开发者需要明确指定SLNX文件路径，才能获得完整的IDE功能支持。

#### slngen工具支持

slngen是一个为无解决方案文件的代码库生成解决方案的命令行工具，目前尚未支持SLNX格式。开发者可以通过跟踪microsoft/slngen#643问题了解其支持进展。

结论
--

.NET SDK 9.0.200引入的SLNX支持代表了解决方案文件格式的重要革新，为开发者带来了更简洁、更现代化的解决方案管理体验。通过dotnet sln migrate命令，开发者可以轻松地将现有解决方案迁移到新格式，并利用dotnet CLI进行完整的生命周期管理。

然而，由于生态系统支持尚未完全成熟，特别是Visual Studio和部分工具的限制，团队在决定是否采用新格式时需要权衡利弊。对于独立开发者或可以控制开发环境配置的团队，SLNX格式提供了显著的改进；而对于需要广泛协作或依赖特定工具链的项目，可能需要等待更全面的生态系统支持。

随着.NET 9的持续演进，预计SLNX格式将获得更广泛的支持，最终可能成为.NET解决方案文件的新标准。开发者应关注后续版本更新，特别是2025年3月发布的9.0.201版本，以获取更完整的SLNX支持功能集。

* * *

  

本文是由葡萄城技术开发团队发布，转载请注明出处：[葡萄城官网](https://www.grapecity.com.cn/)