---
layout: post
title: 'SpringBoot + Vue å®ç° Python åœ¨çº¿è°ƒè¯•å™¨ - æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£'
date: "2026-01-17T00:44:10Z"
---
SpringBoot + Vue å®ç° Python åœ¨çº¿è°ƒè¯•å™¨ - æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£
=========================================

SpringBoot + Vue å®ç° Python åœ¨çº¿è°ƒè¯•å™¨ - æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£
=========================================

ğŸ“‹ ç›®å½•
-----

1.  [é¡¹ç›®æ¦‚è¿°](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0)
2.  [æŠ€æœ¯æ ˆ](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E6%8A%80%E6%9C%AF%E6%A0%88)
3.  [æ¶æ„è®¾è®¡](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1)
4.  [æ ¸å¿ƒå®ç°æ–¹æ³•](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95)
5.  [å…³é”®æŠ€æœ¯ç‚¹](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E7%82%B9)
6.  [APIæ¥å£è®¾è®¡](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#api%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1)
7.  [è°ƒè¯•åŠŸèƒ½å®ç°åŸç†](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E8%B0%83%E8%AF%95%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86)
8.  [å‰ç«¯äº¤äº’å®ç°](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E5%89%8D%E7%AB%AF%E4%BA%A4%E4%BA%92%E5%AE%9E%E7%8E%B0)
9.  [éƒ¨ç½²æ–¹æ¡ˆ](http://localhost:63342/markdownPreview/1811665444/markdown-preview-index-343388764.html?_ijt=iotrqopn59uv59ml7dio5rm5re#%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88)

* * *

é¡¹ç›®æ¦‚è¿°
----

Python åœ¨çº¿è°ƒè¯•å™¨æ˜¯ä¸€ä¸ªåŸºäº Web çš„ Python ä»£ç æ‰§è¡Œå’Œè°ƒè¯•å·¥å…·ï¼Œæ”¯æŒåœ¨çº¿ç¼–å†™ã€è¿è¡Œå’Œäº¤äº’å¼è°ƒè¯• Python ä»£ç ã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯è´Ÿè´£ç”¨æˆ·ç•Œé¢å’Œäº¤äº’ï¼Œåç«¯è´Ÿè´£ä»£ç æ‰§è¡Œå’Œè°ƒè¯•é€»è¾‘ã€‚

* * *

æŠ€æœ¯æ ˆ
---

### åç«¯æŠ€æœ¯æ ˆ

æŠ€æœ¯/æ¡†æ¶

ç‰ˆæœ¬

ç”¨é€”

**Java**

17

ç¼–ç¨‹è¯­è¨€

**Spring Boot**

3.1.5

Webæ¡†æ¶

**Spring Web**

\-

RESTful APIæ”¯æŒ

**Spring Validation**

\-

å‚æ•°éªŒè¯

**Jackson**

\-

JSONåºåˆ—åŒ–/ååºåˆ—åŒ–

**Maven**

3.6+

é¡¹ç›®æ„å»ºå’Œä¾èµ–ç®¡ç†

**Python**

3.x

ä»£ç æ‰§è¡Œç¯å¢ƒ

**æ ¸å¿ƒä¾èµ–ï¼š**

*   `spring-boot-starter-web`: Webå¼€å‘æ”¯æŒ
*   `spring-boot-starter-websocket`: WebSocketæ”¯æŒï¼ˆé¢„ç•™æ‰©å±•ï¼‰
*   `spring-boot-starter-validation`: å‚æ•°éªŒè¯
*   `jackson-databind`: JSONå¤„ç†

### å‰ç«¯æŠ€æœ¯æ ˆ

æŠ€æœ¯/æ¡†æ¶

ç‰ˆæœ¬

ç”¨é€”

**Vue.js**

3.3.4

å‰ç«¯æ¡†æ¶

**Vite**

5.0.0

æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨

**CodeMirror 6**

6.x

ä»£ç ç¼–è¾‘å™¨

**Axios**

1.6.0

HTTPå®¢æˆ·ç«¯

**Node.js**

16+

è¿è¡Œç¯å¢ƒ

**npm**

\-

åŒ…ç®¡ç†å™¨

**æ ¸å¿ƒä¾èµ–ï¼š**

*   `@codemirror/lang-python`: Pythonè¯­è¨€æ”¯æŒ
*   `@codemirror/view`: ç¼–è¾‘å™¨è§†å›¾
*   `@codemirror/state`: ç¼–è¾‘å™¨çŠ¶æ€ç®¡ç†
*   `@codemirror/theme-one-dark`: æ·±è‰²ä¸»é¢˜
*   `@vitejs/plugin-vue`: Vite Vueæ’ä»¶

* * *

æ¶æ„è®¾è®¡
----

### æ•´ä½“æ¶æ„

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    æµè§ˆå™¨ (Browser)                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚          Vue 3 å‰ç«¯åº”ç”¨                          â”‚   â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
    â”‚  â”‚  â”‚ CodeMirror 6 â”‚      â”‚   Axios HTTP     â”‚     â”‚   â”‚
    â”‚  â”‚  â”‚   ç¼–è¾‘å™¨     â”‚      â”‚   å®¢æˆ·ç«¯         â”‚     â”‚   â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ HTTP/REST API
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            Spring Boot åç«¯ (Port: 8080)                 â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚          PythonController                        â”‚   â”‚
    â”‚  â”‚  (REST API ç«¯ç‚¹)                                 â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                   â”‚                                      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚      PythonExecutionService                      â”‚   â”‚
    â”‚  â”‚  (ä»£ç æ‰§è¡Œå’Œè°ƒè¯•é€»è¾‘)                             â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                   â”‚                                      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚      ProcessBuilder + Python Process             â”‚   â”‚
    â”‚  â”‚  (æ‰§è¡ŒPythonä»£ç )                                 â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                   â”‚                                      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚      Python 3.x (ç³»ç»Ÿå®‰è£…)                        â”‚   â”‚
    â”‚  â”‚  - pdb (Pythonè°ƒè¯•å™¨)                             â”‚   â”‚
    â”‚  â”‚  - ä»£ç æ‰§è¡Œ                                       â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    

### åˆ†å±‚æ¶æ„

#### åç«¯åˆ†å±‚

    Controllerå±‚ (PythonController)
        â†“
    Serviceå±‚ (PythonExecutionService)
        â†“
    Processå±‚ (Java ProcessBuilder)
        â†“
    Pythonè¿è¡Œæ—¶ç¯å¢ƒ
    

#### å‰ç«¯åˆ†å±‚

    è§†å›¾å±‚ (App.vue Template)
        â†“
    é€»è¾‘å±‚ (App.vue Script - Composition API)
        â†“
    ç¼–è¾‘å™¨å±‚ (CodeMirror 6)
        â†“
    HTTPå±‚ (Axios)
    

* * *

æ ¸å¿ƒå®ç°æ–¹æ³•
------

### 1\. ä»£ç æ‰§è¡Œå®ç°

#### 1.1 åç«¯å®ç° (PythonExecutionService.executeCode)

**æ ¸å¿ƒæ­¥éª¤ï¼š**

1.  **åˆ›å»ºä¸´æ—¶æ–‡ä»¶**
    
        Path pythonFile = Paths.get(tempDir, "python_" + sessionId + ".py");
        Files.write(pythonFile, code.getBytes("UTF-8"));
        
    
2.  **å¯åŠ¨Pythonè¿›ç¨‹**
    
        ProcessBuilder processBuilder = new ProcessBuilder(pythonCmd, pythonFile.toString());
        processBuilder.environment().put("PYTHONIOENCODING", "utf-8");
        Process process = processBuilder.start();
        
    
3.  **è¯»å–è¾“å‡º**
    
        BufferedReader reader = new BufferedReader(
            new InputStreamReader(process.getInputStream(), "UTF-8"));
        // è®¾ç½®30ç§’è¶…æ—¶
        boolean finished = process.waitFor(30, TimeUnit.SECONDS);
        
    
4.  **æ¸…ç†èµ„æº**
    
        Files.deleteIfExists(pythonFile);
        runningProcesses.remove(sessionId);
        
    

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**

*   ä½¿ç”¨ `ProcessBuilder` åˆ›å»ºç‹¬ç«‹çš„Pythonè¿›ç¨‹
*   è®¾ç½® `PYTHONIOENCODING=utf-8` ç¡®ä¿ä¸­æ–‡è¾“å‡ºæ­£ç¡®
*   ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç”¨æˆ·ä»£ç 
*   è®¾ç½®æ‰§è¡Œè¶…æ—¶é˜²æ­¢æ­»å¾ªç¯
*   UTF-8ç¼–ç å¤„ç†ç¡®ä¿å­—ç¬¦æ­£ç¡®ä¼ è¾“

### 2\. è°ƒè¯•åŠŸèƒ½å®ç°

#### 2.1 æ–­ç‚¹æ’å…¥æœºåˆ¶

**å®ç°æ–¹æ³•ï¼š**

1.  **è¡Œå·æ˜ å°„è¡¨æ„å»º**
    
        Map<Integer, Integer> lineMapping = new HashMap<>();
        // å®é™…è¡Œå· -> åŸå§‹è¡Œå·
        
    
2.  **æ–­ç‚¹ä»£ç æ³¨å…¥**
    
        // åœ¨æ–­ç‚¹è¡Œä¹‹å‰æ’å…¥ pdb.set_trace()
        result.append(indentStr).append("pdb.set_trace()  # Breakpoint at line ")
            .append(originalLineNumber).append("\n");
        
    
3.  **è¡Œå·æ˜ å°„è®°å½•**
    
    *   ä¸ºæ‰€æœ‰æ’å…¥çš„ä»£ç è¡Œå»ºç«‹æ˜ å°„
    *   åŒ…æ‹¬ `import pdb`ã€ç©ºè¡Œã€`pdb.set_trace()` ç­‰
    *   ç¡®ä¿èƒ½å‡†ç¡®è¿˜åŸåŸå§‹è¡Œå·

#### 2.2 äº¤äº’å¼è°ƒè¯•ä¼šè¯ç®¡ç†

**DebugSession ç±»ï¼š**

    private static class DebugSession {
        Process process;              // Pythonè¿›ç¨‹
        BufferedWriter stdin;         // æ ‡å‡†è¾“å…¥æµï¼ˆå‘é€pdbå‘½ä»¤ï¼‰
        Path pythonFile;              // ä¸´æ—¶Pythonæ–‡ä»¶
        boolean isActive;             // ä¼šè¯æ˜¯å¦æ¿€æ´»
        int currentLine;              // å½“å‰æ‰§è¡Œè¡Œå·
        StringBuilder outputBuffer;   // è¾“å‡ºç¼“å†²åŒº
        StringBuilder errorBuffer;    // é”™è¯¯ç¼“å†²åŒº
        Map<Integer, Integer> lineMapping; // è¡Œå·æ˜ å°„è¡¨
    }
    

**ä¼šè¯ç®¡ç†ï¼š**

*   ä½¿ç”¨ `ConcurrentHashMap` å­˜å‚¨å¤šä¸ªè°ƒè¯•ä¼šè¯
*   æ”¯æŒå¹¶å‘è°ƒè¯•å¤šä¸ªç”¨æˆ·
*   è‡ªåŠ¨æ¸…ç†ä¼šè¯èµ„æº

#### 2.3 PDBå‘½ä»¤æ˜ å°„

**æ”¯æŒçš„è°ƒè¯•æ“ä½œï¼š**

æ“ä½œ

PDBå‘½ä»¤

è¯´æ˜

ç»§ç»­æ‰§è¡Œ

`c\n`

continue - ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹

å•æ­¥æ‰§è¡Œ

`n\n`

next - æ‰§è¡Œä¸‹ä¸€è¡Œï¼ˆä¸è¿›å…¥å‡½æ•°ï¼‰

æ­¥å…¥

`s\n`

step - è¿›å…¥å‡½æ•°å†…éƒ¨

æ­¥å‡º

`u\n`

up - è¿”å›åˆ°è°ƒç”¨è€…

**å®ç°æ–¹å¼ï¼š**

    String pdbCommand;
    switch (action) {
        case "continue": pdbCommand = "c\n"; break;
        case "step": pdbCommand = "s\n"; break;
        case "stepOver": pdbCommand = "n\n"; break;
        case "stepOut": pdbCommand = "u\n"; break;
    }
    session.stdin.write(pdbCommand);
    session.stdin.flush();
    

#### 2.4 è¡Œå·è§£æå’Œæ˜ å°„

**PDBè¾“å‡ºæ ¼å¼è§£æï¼š**

    // PDBè¾“å‡ºæ ¼å¼: > /path/to/file.py(è¡Œå·)function_name()
    Pattern pattern = Pattern.compile(">\\s+[^\\(]*\\(\\s*(\\d+)\\s*\\)[^\n]*");
    

**è¡Œå·è½¬æ¢ï¼š**

1.  ä»PDBè¾“å‡ºä¸­æå–å®é™…è¡Œå·
2.  é€šè¿‡æ˜ å°„è¡¨è½¬æ¢ä¸ºåŸå§‹è¡Œå·
3.  å¦‚æœæ²¡æœ‰ç²¾ç¡®åŒ¹é…ï¼Œå‘ä¸ŠæŸ¥æ‰¾æœ€æ¥è¿‘çš„è¡Œå·
4.  è¿”å›ç»™å‰ç«¯æ˜¾ç¤º

### 3\. å‰ç«¯ç¼–è¾‘å™¨å®ç°

#### 3.1 CodeMirror 6 é›†æˆ

**ç¼–è¾‘å™¨åˆå§‹åŒ–ï¼š**

    editorView.value = new EditorView({
        doc: codeContent,
        extensions: [
            basicSetup,           // åŸºç¡€åŠŸèƒ½
            python(),             // Pythonè¯­è¨€æ”¯æŒ
            oneDark,              // æ·±è‰²ä¸»é¢˜
            breakpointGutter,     // æ–­ç‚¹gutter
            currentLineHighlight  // å½“å‰è¡Œé«˜äº®
        ],
        parent: editorContainer.value
    })
    

#### 3.2 æ–­ç‚¹å¯è§†åŒ–

**å®ç°åŸç†ï¼š**

*   ä½¿ç”¨ `GutterMarker` åˆ›å»ºæ–­ç‚¹æ ‡è®°
*   ä½¿ç”¨ `StateField` ç®¡ç†æ–­ç‚¹çŠ¶æ€
*   ä½¿ç”¨ `RangeSet` å­˜å‚¨æ–­ç‚¹ä½ç½®
*   æ”¯æŒç‚¹å‡»gutteråŒºåŸŸåˆ‡æ¢æ–­ç‚¹

**å…³é”®ä»£ç ï¼š**

    // æ–­ç‚¹æ ‡è®°ç±»
    class BreakpointMarker extends GutterMarker {
        toDOM() {
            const span = document.createElement('span')
            span.className = 'breakpoint-marker'
            span.textContent = 'â—'
            return span
        }
    }
    
    // æ–­ç‚¹çŠ¶æ€å­—æ®µ
    const breakpointState = StateField.define({
        create() { return RangeSet.empty },
        update(breakpoints, tr) {
            // å¤„ç†æ–­ç‚¹å˜æ›´
        }
    })
    

#### 3.3 å½“å‰è¡Œé«˜äº®

**å®ç°æ–¹æ³•ï¼š**

    // å½“å‰è¡Œè£…é¥°å™¨
    const currentLineDecoration = Decoration.line({
        class: 'cm-current-line'
    })
    
    // å½“å‰è¡ŒçŠ¶æ€å­—æ®µ
    const currentLineState = StateField.define({
        create() { return RangeSet.empty },
        update(currentLine, tr) {
            // æ›´æ–°å½“å‰è¡Œä½ç½®
        },
        provide: f => EditorView.decorations.from(f)
    })
    

**æ ·å¼å®šä¹‰ï¼š**

    .cm-current-line {
        background-color: rgba(78, 148, 255, 0.15);
        outline: 1px solid rgba(78, 148, 255, 0.3);
    }
    

* * *

å…³é”®æŠ€æœ¯ç‚¹
-----

### 1\. è¿›ç¨‹ç®¡ç†

**è¿›ç¨‹å¯åŠ¨ï¼š**

*   ä½¿ç”¨ `ProcessBuilder` åˆ›å»ºç‹¬ç«‹è¿›ç¨‹
*   åˆ†ç¦»æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡º
*   è®¾ç½®ç¯å¢ƒå˜é‡ç¡®ä¿ç¼–ç æ­£ç¡®

**è¿›ç¨‹æ§åˆ¶ï¼š**

*   ä½¿ç”¨ `Process.waitFor(timeout)` å®ç°è¶…æ—¶æ§åˆ¶
*   ä½¿ç”¨ `Process.destroyForcibly()` å¼ºåˆ¶ç»ˆæ­¢
*   ä½¿ç”¨ `ConcurrentHashMap` ç®¡ç†å¤šä¸ªè¿›ç¨‹

### 2\. å¼‚æ­¥I/Oå¤„ç†

**è¾“å‡ºè¯»å–ï¼š**

    Thread outputThread = new Thread(() -> {
        try (BufferedReader reader = ...) {
            String line;
            while ((line = reader.readLine()) != null && session.isActive) {
                synchronized (session.outputBuffer) {
                    session.outputBuffer.append(line).append("\n");
                }
            }
        }
    });
    outputThread.start();
    

**å…³é”®ç‚¹ï¼š**

*   ä½¿ç”¨ç‹¬ç«‹çº¿ç¨‹è¯»å–è¿›ç¨‹è¾“å‡º
*   ä½¿ç”¨åŒæ­¥å—ä¿è¯çº¿ç¨‹å®‰å…¨
*   å®æ—¶è§£æè¡Œå·å¹¶æ›´æ–°çŠ¶æ€

### 3\. è¡Œå·æ˜ å°„ç®—æ³•

**é—®é¢˜ï¼š**

*   æ’å…¥ `import pdb` å’Œ `pdb.set_trace()` åè¡Œå·ä¼šåç§»
*   PDBæ˜¾ç¤ºçš„æ˜¯æ’å…¥åçš„è¡Œå·ï¼Œéœ€è¦è½¬æ¢ä¸ºåŸå§‹è¡Œå·

**è§£å†³æ–¹æ¡ˆï¼š**

1.  æ„å»ºå®Œæ•´çš„è¡Œå·æ˜ å°„è¡¨
2.  ç²¾ç¡®åŒ¹é…ä¼˜å…ˆ
3.  å‘ä¸ŠæŸ¥æ‰¾æœ€æ¥è¿‘çš„è¡Œå·ï¼ˆæœ€å¤š10è¡Œï¼‰
4.  å¦‚æœæ‰¾ä¸åˆ°ï¼Œä½¿ç”¨ä¼°ç®—æ–¹æ³•

### 4\. ç¼–ç å¤„ç†

**UTF-8ç¼–ç è®¾ç½®ï¼š**

    // åç«¯
    processBuilder.environment().put("PYTHONIOENCODING", "utf-8");
    Files.write(pythonFile, code.getBytes("UTF-8"));
    new InputStreamReader(process.getInputStream(), "UTF-8")
    
    // å‰ç«¯
    // Axiosè‡ªåŠ¨å¤„ç†UTF-8ç¼–ç 
    

**é…ç½®æ–‡ä»¶ï¼š**

    server.servlet.encoding.charset=UTF-8
    server.servlet.encoding.enabled=true
    server.servlet.encoding.force=true
    spring.http.encoding.charset=UTF-8
    spring.http.encoding.enabled=true
    spring.http.encoding.force=true
    

### 5\. ä¼šè¯ç®¡ç†

**ä¼šè¯å­˜å‚¨ï¼š**

    ConcurrentHashMap<String, DebugSession> debugSessions
    ConcurrentHashMap<String, Process> runningProcesses
    

**ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼š**

1.  å¼€å§‹è°ƒè¯•æ—¶åˆ›å»ºä¼šè¯
2.  æ‰§è¡Œè°ƒè¯•å‘½ä»¤æ—¶æ›´æ–°ä¼šè¯
3.  è°ƒè¯•å®Œæˆæˆ–åœæ­¢æ—¶æ¸…ç†ä¼šè¯
4.  è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶

* * *

APIæ¥å£è®¾è®¡
-------

### 1\. ä»£ç æ‰§è¡Œæ¥å£

**æ¥å£ï¼š** `POST /api/python/execute`

**è¯·æ±‚ä½“ï¼š**

    {
        "code": "print('Hello, World!')",
        "sessionId": "session_123"
    }
    

**å“åº”ï¼š**

    {
        "output": "Hello, World!\n",
        "error": "",
        "success": true,
        "sessionId": "session_123"
    }
    

### 2\. è°ƒè¯•æ¥å£

**æ¥å£ï¼š** `POST /api/python/debug`

**è¯·æ±‚ä½“ï¼š**

    {
        "code": "def func():\n    x = 10\n    return x",
        "sessionId": "session_123",
        "breakpoints": [2, 3],
        "action": "start" | "continue" | "step" | "stepOver" | "stepOut"
    }
    

**å“åº”ï¼š**

    {
        "output": "> file.py(2)func()\n-> x = 10",
        "error": "",
        "success": true,
        "currentLine": 2,
        "sessionId": "session_123"
    }
    

### 3\. åœæ­¢æ‰§è¡Œæ¥å£

**æ¥å£ï¼š** `POST /api/python/stop/{sessionId}`

**å“åº”ï¼š**

    æ‰§è¡Œå·²åœæ­¢
    

* * *

è°ƒè¯•åŠŸèƒ½å®ç°åŸç†
--------

### 1\. æ–­ç‚¹æ’å…¥æµç¨‹

    åŸå§‹ä»£ç                    æ’å…¥åä»£ç 
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    1 def func():            1 import pdb
    2     x = 10             2 
    3     return x           3 def func():
                             4     pdb.set_trace()  # Breakpoint at line 2
                             5     x = 10
                             6     return x
    
    è¡Œå·æ˜ å°„:
    å®é™…è¡Œå· -> åŸå§‹è¡Œå·
    4 -> 2
    5 -> 2
    

### 2\. PDBäº¤äº’æµç¨‹

    å‰ç«¯                åç«¯                 Pythonè¿›ç¨‹
    â”‚                   â”‚                      â”‚
    â”‚-- startDebug ---->â”‚                      â”‚
    â”‚                   â”‚-- åˆ›å»ºä¸´æ—¶æ–‡ä»¶ ----->â”‚
    â”‚                   â”‚-- å¯åŠ¨è¿›ç¨‹ --------->â”‚
    â”‚                   â”‚<-- PDBæš‚åœåœ¨ç¬¬Nè¡Œ ---â”‚
    â”‚<-- è¿”å›è¡Œå·N -----â”‚                      â”‚
    â”‚                   â”‚                      â”‚
    â”‚-- step ---------->â”‚                      â”‚
    â”‚                   â”‚-- å‘é€ 's\n' ------->â”‚
    â”‚                   â”‚                      â”‚-- æ­¥å…¥å‡½æ•°
    â”‚                   â”‚<-- PDBæš‚åœåœ¨ç¬¬Mè¡Œ ---â”‚
    â”‚<-- è¿”å›è¡Œå·M -----â”‚                      â”‚
    

### 3\. è¡Œå·è§£ææµç¨‹

    PDBè¾“å‡º: "> file.py(15)func()\n-> x = 10"
             â†“
    æ­£åˆ™åŒ¹é…: Pattern.compile(">\s+[^\(]*\(\s*(\d+)\s*\)")
             â†“
    æå–è¡Œå·: 15
             â†“
    æŸ¥æ‰¾æ˜ å°„: lineMapping.get(15) = 12
             â†“
    è¿”å›å‰ç«¯: currentLine = 12
    

* * *

å‰ç«¯äº¤äº’å®ç°
------

### 1\. Vue 3 Composition API

**å“åº”å¼çŠ¶æ€ï¼š**

    const breakpoints = ref([])
    const currentDebugLine = ref(null)
    const isInDebugMode = ref(false)
    

**ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š**

    onMounted(() => {
        initEditor()
        sessionId.value = generateSessionId()
        window.addEventListener('keydown', handleKeyPress)
    })
    
    onUnmounted(() => {
        window.removeEventListener('keydown', handleKeyPress)
    })
    

### 2\. æ–­ç‚¹ç®¡ç†

**æ·»åŠ æ–­ç‚¹ï¼š**

    const addBreakpoint = () => {
        if (newBreakpoint.value && newBreakpoint.value > 0) {
            if (!breakpoints.value.includes(lineNum)) {
                breakpoints.value.push(lineNum)
                breakpoints.value.sort((a, b) => a - b)
                syncBreakpointsToEditor()
            }
        }
    }
    

**æ–­ç‚¹åŒæ­¥ï¼š**

    watch(breakpoints, () => {
        nextTick(() => {
            syncBreakpointsToEditor()
        })
    }, { deep: true })
    

### 3\. è°ƒè¯•æ§åˆ¶

**è°ƒè¯•å‘½ä»¤æ‰§è¡Œï¼š**

    const executeDebugCommand = async (action) => {
        const response = await axios.post(`${API_BASE}/debug`, {
            code: '',
            sessionId: sessionId.value,
            breakpoints: [],
            action: action  // 'continue', 'step', 'stepOver', 'stepOut'
        })
        
        // æ›´æ–°å½“å‰è¡Œå·å¹¶é«˜äº®
        if (result.currentLine) {
            currentDebugLine.value = result.currentLine
            highlightCurrentLine(result.currentLine)
        }
    }
    

**é”®ç›˜å¿«æ·é”®ï¼š**

*   **F5**: ç»§ç»­æ‰§è¡Œ
*   **F7**: æ­¥å…¥
*   **F8**: å•æ­¥æ‰§è¡Œ
*   **Shift+F8**: æ­¥å‡º

### 4\. å®æ—¶æ›´æ–°æœºåˆ¶

**å½“å‰è¡Œé«˜äº®æ›´æ–°ï¼š**

    const highlightCurrentLine = (lineNum) => {
        const view = editorView.value
        const line = view.state.doc.line(lineNum)
        view.dispatch({
            effects: [
                EditorView.scrollIntoView(line.from, { y: 'center' }),
                setCurrentLineEffect.of(line.from)
            ]
        })
    }
    

* * *

éƒ¨ç½²æ–¹æ¡ˆ
----

> é™„ä»£ç ä»“åº“é“¾æ¥ï¼š[https://gitee.com/ghostmen/python-debug-demo](https://gitee.com/ghostmen/python-debug-demo)

### å¼€å‘ç¯å¢ƒ

**åç«¯ï¼š**

*   ç«¯å£ï¼š8080
*   å¯åŠ¨ï¼š`![img](http://localhost:63342/markdownPreview/1811665444/commandRunner/run.png)mvn spring-boot:run`
*   æˆ–ä½¿ç”¨ï¼š`start-backend.bat` / `start-backend.sh`

**å‰ç«¯ï¼š**

*   ç«¯å£ï¼š3000
*   å¯åŠ¨ï¼š`npm run dev`
*   æˆ–ä½¿ç”¨ï¼š`start-frontend.bat` / `start-frontend.sh`
*   Viteä»£ç†ï¼š`/api` â†’ `http://localhost:8080`

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

**åç«¯ï¼š**

*   æ‰“åŒ…ï¼š`![img](http://localhost:63342/markdownPreview/1811665444/commandRunner/run.png)mvn clean package`
*   è¿è¡Œï¼š`java -jar target/python-debug-backend-1.0.0.jar`
*   é…ç½®ï¼šä¿®æ”¹ `application.properties`
*   åå‘ä»£ç†ï¼šNginx

**å‰ç«¯ï¼š**

*   æ„å»ºï¼š`npm run build`
*   è¾“å‡ºç›®å½•ï¼š`dist/`
*   é™æ€èµ„æºæœåŠ¡å™¨ï¼šNginx / Apache
*   æˆ–é›†æˆåˆ°åç«¯é™æ€èµ„æº

### å®‰å…¨å»ºè®®

1.  **ä»£ç æ‰§è¡Œé™åˆ¶**
    *   æ·»åŠ æ²™ç®±æœºåˆ¶
    *   é™åˆ¶ç³»ç»Ÿè°ƒç”¨
    *   é™åˆ¶èµ„æºä½¿ç”¨ï¼ˆCPUã€å†…å­˜ï¼‰
2.  **ç½‘ç»œå®‰å…¨**
    *   é…ç½®å…·ä½“çš„CORSå…è®¸åŸŸå
    *   ä½¿ç”¨HTTPS
    *   æ·»åŠ èº«ä»½éªŒè¯
3.  **è¾“å…¥éªŒè¯**
    *   éªŒè¯ä»£ç é•¿åº¦
    *   è¿‡æ»¤å±é™©æ“ä½œ
    *   è®¾ç½®æ‰§è¡Œè¶…æ—¶

* * *

æ€§èƒ½ä¼˜åŒ–
----

### 1\. è¿›ç¨‹ç®¡ç†ä¼˜åŒ–

*   é™åˆ¶å¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹æ•°
*   åŠæ—¶æ¸…ç†å·²å®Œæˆçš„è¿›ç¨‹
*   ä½¿ç”¨çº¿ç¨‹æ± ç®¡ç†I/Oæ“ä½œ

### 2\. å‰ç«¯ä¼˜åŒ–

*   ä»£ç ç¼–è¾‘å™¨æ‡’åŠ è½½
*   è¾“å‡ºå†…å®¹è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§é‡è¾“å‡ºæ—¶ï¼‰
*   é˜²æŠ–å¤„ç†é¢‘ç¹çš„æ–­ç‚¹æ“ä½œ

### 3\. ç¼“å­˜ç­–ç•¥

*   ç¼“å­˜Pythonå‘½ä»¤æ£€æµ‹ç»“æœ
*   å¤ç”¨è°ƒè¯•ä¼šè¯ï¼ˆå¦‚æœå¯èƒ½ï¼‰

* * *

æ‰©å±•æ–¹æ¡ˆ
----

### 1\. WebSocketå®æ—¶äº¤äº’

**ä¼˜åŠ¿ï¼š**

*   å®æ—¶åŒå‘é€šä¿¡
*   æ›´å¥½çš„è°ƒè¯•ä½“éªŒ
*   æ”¯æŒæ–­ç‚¹å¤„çš„å˜é‡æŸ¥çœ‹

**å®ç°æ–¹å‘ï¼š**

*   ä½¿ç”¨ Spring WebSocket
*   å‰ç«¯ä½¿ç”¨ WebSocket API
*   å®æ—¶æ¨é€è°ƒè¯•çŠ¶æ€

### 2\. ä½¿ç”¨debugpyæ›¿ä»£pdb

**ä¼˜åŠ¿ï¼š**

*   æ›´ä¸“ä¸šçš„è°ƒè¯•åè®®ï¼ˆDAPï¼‰
*   æ›´å¥½çš„æ€§èƒ½
*   æ”¯æŒæ›´å¤šè°ƒè¯•åŠŸèƒ½

**å®ç°æ–¹å‘ï¼š**

*   é›†æˆdebugpyåº“
*   å®ç°DAPåè®®å®¢æˆ·ç«¯
*   æ”¯æŒå˜é‡æŸ¥çœ‹ã€è¡¨è¾¾å¼æ±‚å€¼ç­‰

### 3\. å¤šæ–‡ä»¶æ”¯æŒ

**å®ç°æ–¹å‘ï¼š**

*   æ–‡ä»¶ç®¡ç†å™¨ç»„ä»¶
*   å¤šæ ‡ç­¾ç¼–è¾‘å™¨
*   æ–‡ä»¶é—´ä¾èµ–ç®¡ç†

### 4\. ä»£ç è¡¥å…¨

**å®ç°æ–¹å‘ï¼š**

*   é›†æˆPythonè¯­è¨€æœåŠ¡å™¨ï¼ˆå¦‚Pyrightï¼‰
*   CodeMirrorè‡ªåŠ¨è¡¥å…¨æ‰©å±•
*   æä¾›ä»£ç æç¤ºå’Œé”™è¯¯æ£€æŸ¥

* * *

æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ
---------

### éš¾ç‚¹1: è¡Œå·æ˜ å°„å‡†ç¡®æ€§

**é—®é¢˜ï¼š** æ’å…¥è°ƒè¯•ä»£ç åï¼Œè¡Œå·åç§»ï¼Œéœ€è¦å‡†ç¡®æ˜ å°„å›åŸå§‹è¡Œå·ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

*   å»ºç«‹å®Œæ•´çš„è¡Œå·æ˜ å°„è¡¨
*   ä½¿ç”¨å‘ä¸ŠæŸ¥æ‰¾ç®—æ³•ä½œä¸ºå¤‡é€‰
*   æ™ºèƒ½åŒ¹é…æœ€æ¥è¿‘çš„è¡Œå·

### éš¾ç‚¹2: PDBè¾“å‡ºè§£æ

**é—®é¢˜ï¼š** PDBè¾“å‡ºæ ¼å¼å¤šæ ·ï¼Œéœ€è¦å‡†ç¡®æå–å½“å‰è¡Œå·ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

*   ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å¤šç§æ ¼å¼
*   ä»åå¾€å‰æŸ¥æ‰¾æœ€æ–°çš„PDBæç¤ºç¬¦
*   å®¹é”™å¤„ç†ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼

### éš¾ç‚¹3: å¼‚æ­¥I/OåŒæ­¥

**é—®é¢˜ï¼š** å¼‚æ­¥è¯»å–è¾“å‡ºä¸åŒæ­¥æ“ä½œä¹‹é—´çš„æ—¶åºé—®é¢˜ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

*   ä½¿ç”¨åŒæ­¥å—ä¿æŠ¤å…±äº«èµ„æº
*   åˆç†çš„ç­‰å¾…æ—¶é—´
*   çŠ¶æ€æ ‡å¿—æ§åˆ¶å¼‚æ­¥è¯»å–

### éš¾ç‚¹4: ç¼–ç é—®é¢˜

**é—®é¢˜ï¼š** Windowsç³»ç»Ÿé»˜è®¤GBKç¼–ç ï¼Œå¯¼è‡´ä¸­æ–‡ä¹±ç ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

*   è®¾ç½® `PYTHONIOENCODING=utf-8` ç¯å¢ƒå˜é‡
*   ç»Ÿä¸€ä½¿ç”¨UTF-8ç¼–ç 
*   Spring Booté…ç½®UTF-8å“åº”ç¼–ç 

* * *

æ€»ç»“
--

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä½¿ç”¨Spring Boot 3.xå’ŒVue 3æ„å»ºï¼Œé€šè¿‡ProcessBuilderæ‰§è¡ŒPythonä»£ç ï¼Œä½¿ç”¨pdbå®ç°äº¤äº’å¼è°ƒè¯•ã€‚æ ¸å¿ƒç‰¹ç‚¹ï¼š

1.  **æŠ€æœ¯é€‰å‹åˆç†**ï¼šç°ä»£åŒ–çš„æŠ€æœ¯æ ˆï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
2.  **å®ç°æ–¹æ¡ˆå¯è¡Œ**ï¼šä½¿ç”¨æˆç†Ÿçš„ProcessBuilderå’Œpdbï¼Œç¨³å®šæ€§å¥½
3.  **ç”¨æˆ·ä½“éªŒè‰¯å¥½**ï¼šå¯è§†åŒ–æ–­ç‚¹ã€å½“å‰è¡Œé«˜äº®ã€å¿«æ·é”®æ”¯æŒ
4.  **æ‰©å±•æ€§å¼º**ï¼šé¢„ç•™WebSocketæ¥å£ï¼Œå¯å‡çº§åˆ°æ›´ä¸“ä¸šçš„è°ƒè¯•æ–¹æ¡ˆ

**æ”¹è¿›æ–¹å‘ï¼š**

*   ä½¿ç”¨debugpyå®ç°æ›´ä¸“ä¸šçš„è°ƒè¯•
*   æ·»åŠ WebSocketå®ç°å®æ—¶äº¤äº’
*   å¢å¼ºå®‰å…¨æ€§å’Œæ€§èƒ½ä¼˜åŒ–
*   æ”¯æŒæ›´å¤šè°ƒè¯•åŠŸèƒ½ï¼ˆå˜é‡æŸ¥çœ‹ã€è¡¨è¾¾å¼æ±‚å€¼ç­‰ï¼‰

* * *

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.0  
**æœ€åæ›´æ–°ï¼š** 2026å¹´