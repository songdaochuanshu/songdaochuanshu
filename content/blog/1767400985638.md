---
layout: post
title: 'FastAPIå“åº”å®æˆ˜ï¼šä»JSONåˆ°HTMLï¼Œè½»æ¾é©¾é©­å¤šç§æ•°æ®æ ¼å¼'
date: "2026-01-03T00:43:05Z"
---
FastAPIå“åº”å®æˆ˜ï¼šä»JSONåˆ°HTMLï¼Œè½»æ¾é©¾é©­å¤šç§æ•°æ®æ ¼å¼
=================================

æœ¬æ–‡æ·±å…¥è§£æFastAPIçš„responsesæ¨¡å—ï¼Œæ¶µç›–JSONã€HTMLç­‰å¤šç§å“åº”æ ¼å¼çš„è¿”å›æ–¹æ³•ï¼Œè¯¦ç»†è®²è§£Jinja2æ¨¡æ¿å¼•æ“çš„é›†æˆä¸ä½¿ç”¨ï¼Œä»¥åŠHTMLé™æ€é¡µé¢çš„è¿”å›ä¸å‚æ•°ä¼ é€’æŠ€å·§ï¼Œå¹¶æä¾›å®Œæ•´ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©å¼€å‘è€…é«˜æ•ˆæ„å»ºWebåº”ç”¨ã€‚

è¿˜åœ¨ä¸ºFastAPIçš„å“åº”æ ¼å¼å¤´ç–¼å—ï¼Ÿæ®ç»Ÿè®¡ï¼Œ**è¶…è¿‡70%çš„åç«¯å¼€å‘è€…**åœ¨æ„å»ºWebåº”ç”¨æ—¶ï¼Œæ›¾å› å“åº”æ ¼å¼ä¸å½“å¯¼è‡´å‰ç«¯è§£æé”™è¯¯æˆ–ç”¨æˆ·ä½“éªŒä¸‹é™ã€‚

> **æ–‡ç« äº®ç‚¹ï¼š**æœ¬æ–‡å°†æ·±å…¥è§£æFastAPIçš„`responses`æ¨¡å—ï¼Œå¸¦ä½ æŒæ¡JSONã€HTMLç­‰å¤šç§å“åº”æ ¼å¼çš„è¿”å›æ–¹æ³•ï¼Œå¹¶è¯¦ç»†è®²è§£æ¨¡æ¿å¼•æ“çš„ä½¿ç”¨æŠ€å·§ã€é™æ€é¡µé¢çš„è¿”å›ä¸ä¼ å‚å®æˆ˜ï¼Œä»¥åŠå‚æ•°çš„é«˜æ•ˆåº”ç”¨ã€‚è¯»å®Œæœ¬æ–‡ï¼Œä½ å°†èƒ½è½»æ¾æ„å»ºåŠŸèƒ½ä¸°å¯Œã€äº¤äº’æµç•…çš„Webåº”ç”¨ã€‚  
>   
> **ğŸ“š ç›®å½•ä¸€è§ˆï¼š**  
> \- âœ¨ FastAPI.responses å“åº”æ ¼å¼å…¨è§£æ  
> \- ğŸ¨ æ¨¡æ¿å¼•æ“ï¼ˆJinja2ï¼‰é›†æˆä¸ä½¿ç”¨  
> \- ğŸŒ HTMLé™æ€é¡µé¢çš„è¿”å›ä¸å‚æ•°ä¼ é€’  
> \- ğŸ”§ è·¯å¾„å‚æ•°ã€æŸ¥è¯¢å‚æ•°ç­‰é«˜çº§ç”¨æ³•  
> \- ğŸ’» å®Œæ•´ä»£ç å®æˆ˜å‚è€ƒ

âœ¨ FastAPI.responses å“åº”æ ¼å¼å…¨è§£æ
---------------------------

FastAPIæä¾›äº†`fastapi.responses`æ¨¡å—ï¼Œè®©ä½ èƒ½è½»æ¾è¿”å›ä¸åŒæ ¼å¼çš„å“åº”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒFastAPIä¼šè‡ªåŠ¨å°†è¿”å›çš„å­—å…¸è½¬æ¢ä¸ºJSONï¼Œä½†æœ‰æ—¶ä½ éœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ã€‚

**æ ¸å¿ƒå“åº”ç±»ï¼š**

\- `JSONResponse`: è¿”å›JSONæ•°æ®ï¼Œæœ€å¸¸ç”¨ã€‚  
\- `HTMLResponse`: è¿”å›HTMLå†…å®¹ï¼Œç”¨äºæ¸²æŸ“é¡µé¢ã€‚  
\- `PlainTextResponse`: è¿”å›çº¯æ–‡æœ¬ã€‚  
\- `RedirectResponse`: é‡å®šå‘åˆ°å…¶ä»–URLã€‚  
\- `FileResponse`: è¿”å›æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€PDFï¼‰ã€‚

ç¤ºä¾‹ï¼šæ˜¾å¼è¿”å›JSONå“åº”ã€‚

    from fastapi import FastAPI
    from fastapi.responses import JSONResponse
    
    app = FastAPI()
    
    @app.get("/data")
    async def get_data():
        return JSONResponse(content={"message": "Hello", "status": "success"}, status_code=200)

é€šè¿‡`JSONResponse`ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰çŠ¶æ€ç å’Œå¤´éƒ¨ä¿¡æ¯ï¼Œæ¯”ä¾èµ–è‡ªåŠ¨è½¬æ¢æ›´çµæ´»ã€‚

ğŸ¨ æ¨¡æ¿å¼•æ“ï¼ˆJinja2ï¼‰é›†æˆä¸ä½¿ç”¨
--------------------

åŠ¨æ€HTMLé¡µé¢ç¦»ä¸å¼€æ¨¡æ¿å¼•æ“ã€‚FastAPIå¸¸ç”¨**Jinja2**æ¥æ¸²æŸ“æ¨¡æ¿ï¼Œå®ç°æ•°æ®ä¸è§†å›¾çš„åˆ†ç¦»ã€‚

    from fastapi import FastAPI, Request
    from fastapi.responses import HTMLResponse
    from fastapi.templating import Jinja2Templates
    
    app = FastAPI()
    templates = Jinja2Templates(directory="templates")  # æ¨¡æ¿æ–‡ä»¶å¤¹
    
    @app.get("/user/{name}", response_class=HTMLResponse)
    async def read_user(request: Request, name: str):
        return templates.TemplateResponse("user.html", {"request": request, "username": name})

åœ¨`templates/user.html`æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨Jinja2è¯­æ³•ï¼š

    <!DOCTYPE html>
    <html>
    <head>
        <title>User Page</title>
    </head>
    <body>
        <h1>Hello, {{ username }}!</h1>
    </body>
    </html>

è¿™æ ·ï¼Œå½“è®¿é—®`/user/John`æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤º"Hello, John!"ã€‚æ¨¡æ¿å¼•æ“è®©åŠ¨æ€å†…å®¹ç”Ÿæˆå˜å¾—ç®€å•ã€‚

ğŸŒ HTMLé™æ€é¡µé¢çš„è¿”å›ä¸å‚æ•°ä¼ é€’
-------------------

é™¤äº†åŠ¨æ€æ¨¡æ¿ï¼ŒFastAPIä¹Ÿèƒ½ç›´æ¥è¿”å›é™æ€HTMLæ–‡ä»¶ï¼Œå¹¶é€šè¿‡å‚æ•°ä¼ é€’æ•°æ®ã€‚

**è¿”å›é™æ€HTMLæ–‡ä»¶ï¼š**ä½¿ç”¨`FileResponse`ã€‚

    from fastapi.responses import FileResponse
    
    @app.get("/static-page")
    async def get_static_page():
        return FileResponse("static/index.html")  # å‡è®¾æ–‡ä»¶åœ¨staticæ–‡ä»¶å¤¹

**å‚æ•°ä¼ é€’åˆ°HTMLï¼š**ç»“åˆæŸ¥è¯¢å‚æ•°æˆ–è·¯å¾„å‚æ•°ï¼ŒåŠ¨æ€ä¿®æ”¹é¡µé¢å†…å®¹ã€‚

    from fastapi.responses import HTMLResponse
    
    @app.get("/greet", response_class=HTMLResponse)
    async def greet(name: str = "Guest"):
        html_content = f"""
        <html>
            <body>
                <h1>Welcome, {name}!</h1>
            </body>
        </html>
        """
        return HTMLResponse(content=html_content)

è®¿é—®`/greet?name=Alice`ï¼Œé¡µé¢ä¼šæ˜¾ç¤º"Welcome, Alice!"ã€‚è¿™ç§æ–¹å¼é€‚åˆç®€å•é¡µé¢ï¼Œæ— éœ€æ¨¡æ¿å¼•æ“ã€‚

ğŸ”§ è·¯å¾„å‚æ•°ã€æŸ¥è¯¢å‚æ•°ç­‰é«˜çº§ç”¨æ³•
-----------------

å‚æ•°æ˜¯Webåº”ç”¨çš„æ ¸å¿ƒã€‚FastAPIæ”¯æŒå¤šç§å‚æ•°ç±»å‹ï¼Œè®©APIæ›´å¼ºå¤§ã€‚

\- **è·¯å¾„å‚æ•°**ï¼šé€šè¿‡URLè·¯å¾„ä¼ é€’ï¼Œå¦‚`/items/{item_id}`ã€‚  
\- **æŸ¥è¯¢å‚æ•°**ï¼šé€šè¿‡URLæŸ¥è¯¢å­—ç¬¦ä¸²ä¼ é€’ï¼Œå¦‚`?name=John&age=30`ã€‚  
\- **è¯·æ±‚ä½“å‚æ•°**ï¼šç”¨äºPOSTè¯·æ±‚ï¼Œä¼ é€’JSONæ•°æ®ã€‚  
\- **ä¾èµ–æ³¨å…¥å‚æ•°**ï¼šé‡ç”¨é€»è¾‘ï¼Œå¦‚éªŒè¯ç”¨æˆ·ã€‚

ç¤ºä¾‹ï¼šæ··åˆä½¿ç”¨è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°ã€‚

    from fastapi import FastAPI, Query
    from fastapi.responses import JSONResponse
    
    app = FastAPI()
    
    @app.get("/items/{category}")
    async def read_items(
        category: str,
        limit: int = Query(10, gt=0),  # æŸ¥è¯¢å‚æ•°ï¼Œé»˜è®¤10ï¼Œå¿…é¡»å¤§äº0
        skip: int = Query(0, ge=0)     # é»˜è®¤0ï¼Œå¿…é¡»å¤§äºç­‰äº0
    ):
        # æ¨¡æ‹Ÿæ•°æ®è¿‡æ»¤
        data = {"category": category, "limit": limit, "skip": skip}
        return JSONResponse(content=data)

è®¿é—®`/items/books?limit=5&skip=2`ï¼Œè¿”å›JSONæ•°æ®ã€‚FastAPIä¼šè‡ªåŠ¨éªŒè¯å‚æ•°ï¼Œæ— æ•ˆæ—¶ä¼šè¿”å›é”™è¯¯å“åº”ã€‚

ğŸ’» å®Œæ•´ä»£ç å®æˆ˜å‚è€ƒ
-----------

ä¸‹é¢æ˜¯ä¸€ä¸ªæ•´åˆäº†å“åº”æ ¼å¼ã€æ¨¡æ¿å¼•æ“å’Œå‚æ•°ä½¿ç”¨çš„å®Œæ•´ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ã€‚

    from fastapi import FastAPI, Request, Query
    from fastapi.responses import JSONResponse, HTMLResponse, FileResponse
    from fastapi.templating import Jinja2Templates
    import os
    
    app = FastAPI()
    templates = Jinja2Templates(directory="templates")
    
    # è¿”å›JSONå“åº”
    @app.get("/api/data")
    async def get_api_data():
        return JSONResponse(content={"message": "APIæ•°æ®", "code": 200})
    
    # ä½¿ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“HTML
    @app.get("/page/{page_name}", response_class=HTMLResponse)
    async def render_page(request: Request, page_name: str):
        return templates.TemplateResponse(f"{page_name}.html", {"request": request, "page": page_name})
    
    # è¿”å›é™æ€HTMLæ–‡ä»¶
    @app.get("/static")
    async def get_static():
        file_path = "static/welcome.html"
        if os.path.exists(file_path):
            return FileResponse(file_path)
        return JSONResponse(content={"error": "æ–‡ä»¶æœªæ‰¾åˆ°"}, status_code=404)
    
    # å‚æ•°ä½¿ç”¨ç¤ºä¾‹ï¼šæŸ¥è¯¢å‚æ•°ä¼ é€’åˆ°HTML
    @app.get("/custom-greet", response_class=HTMLResponse)
    async def custom_greet(name: str = Query("æ—…è¡Œè€…", min_length=1)):
        html = f"""
        <html>
            <head><title>Greeting</title></head>
            <body>
                <h1 style="color: blue;">ä½ å¥½ï¼Œ{name}ï¼æ¬¢è¿æ¥åˆ°FastAPIä¸–ç•Œã€‚</h1>
            </body>
        </html>
        """
        return HTMLResponse(content=html)
    
    if __name__ == "__main__":
        import uvicorn
        uvicorn.run(app, host="0.0.0.0", port=8000)

ç¡®ä¿é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

    - é¡¹ç›®æ ¹ç›®å½•/
    Â Â - main.py (ä»¥ä¸Šä»£ç )
    Â Â - templates/
    Â Â Â Â - ä¾‹å¦‚ index.html, user.html
    Â Â - static/
    Â Â Â Â - welcome.html

è¿è¡Œåï¼Œè®¿é—®ä¸åŒç«¯ç‚¹ä½“éªŒåŠŸèƒ½ï¼š`/api/data`ã€`/page/index`ã€`/static`ã€`/custom-greet?name=å¼ ä¸‰`ã€‚

* * *

å–œæ¬¢æœ¬æ–‡ï¼Ÿä¸è¦é”™è¿‡âœ¨ï¼Œç‚¹èµğŸ‘æ”¶è—â­å…³æ³¨æˆ‘ğŸ‘†ï¼Œä¸€èµ·å­¦ä¹ æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†ï¼Œå®Œå–„ä½ æˆ‘çš„æŠ€èƒ½æ ‘ï¼ä¹Ÿè¯·è·¯è¿‡çš„å¤§ä½¬ç»™äº›å»ºè®®å’ŒæŒ‡æ•™ğŸ‘‰ğŸ‘ˆğŸ¥ºï¼