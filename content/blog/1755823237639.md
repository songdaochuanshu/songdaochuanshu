---
layout: post
title: '在Windows上将git与ssh-agent搭配使用，再也不用输入git密码了'
date: "2025-08-22T00:40:37Z"
---
在Windows上将git与ssh-agent搭配使用，再也不用输入git密码了
========================================

前言
--

之前的文章中已经解决了 Windows 上的 SSH 登录的问题，成功把 Windows 上的 ssh-agent 用起来了，详情可以看这篇文章: [在 Windows 10 上实现免密码 SSH 登录](https://blog.deali.cn/Blog/Post/514395100768e83a)

不过使用 git 还是会反复提示输入私钥密码，烦得很

原因也很简单，打开 git bash 运行一下命令测试就知道了

    $ ssh-add -l
    Could not open a connection to your authentication agent.
    

就是 git 里用的 ssh 是它自带的，不是 Windows 系统的那一个，应该是为了兼容性考虑吧，毕竟之前 Windows 是没有 ssh 的

那么解决思路也很简单，只要配置 git 使用 Windows 的 SSH 就行了

配置
--

一行代码搞定

    git config --global core.sshCommand "'C:\Windows\System32\OpenSSH\ssh.exe'"
    

有问题？
----

一开始我配置完了运行老是出错

    CreateProcessW failed error:2
    posix_spawnp: No such file or directory
    

后面加了 `-v` 参数才发现是我的 `~/.ssh/config` 里的配置

之前配置了 GitHub 走代理

    Host github.com
        User git
        Port 443
        HostName ssh.github.com
        TCPKeepAlive yes
        ProxyCommand "$HOME/scoop/apps/git/current/mingw64/bin/connect.exe -S 127.0.0.1:7890 -a none %h %p"
    

之前在 git 自带的 ssh 环境下运行没问题，但现在用了 Windows 的 ssh 反而不行了，于是把这个 `ProxyCommand` 配置注释掉，就 OK 了

如果有遇到类似问题的同学，可以参考一下。

参考资料
----

*   [How to use SSH with Git and ssh-agent on Windows](https://darraghoriordan.medium.com/how-to-use-ssh-with-git-and-ssh-agent-on-windows-7aeb1f64724)
*   [windows 10 ssh proxycommand: "posix\_spawn: No such file or directory"](https://serverfault.com/questions/956613/windows-10-ssh-proxycommand-posix-spawn-no-such-file-or-directory)

微信公众号：「程序设计实验室」 专注于互联网热门新技术探索与团队敏捷开发实践，包括架构设计、机器学习与数据分析算法、移动端开发、Linux、Web前后端开发等，欢迎一起探讨技术，分享学习实践经验。