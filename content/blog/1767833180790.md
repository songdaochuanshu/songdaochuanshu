---
layout: post
title: 'ä¸‰å¤§ Agent-UI åè®®æ·±åº¦å‰–æï¼šAG-UIã€A2UI ä¸ MCP-UI çš„è®¾è®¡å“²å­¦ä¸å·¥ç¨‹å®è·µ'
date: "2026-01-08T00:46:20Z"
---
ä¸‰å¤§ Agent-UI åè®®æ·±åº¦å‰–æï¼šAG-UIã€A2UI ä¸ MCP-UI çš„è®¾è®¡å“²å­¦ä¸å·¥ç¨‹å®è·µ
=================================================

éšç€å¤§æ¨¡å‹ä»"å¯¹è¯æ¡†"æ¼”è¿›ä¸º"è‡ªä¸»æ™ºèƒ½ä½“"ï¼Œå¦‚ä½•è®© Agent å…·å¤‡å¯Œäº¤äº’èƒ½åŠ›æˆä¸ºå…³é”®æŒ‘æˆ˜ã€‚æœ¬æ–‡åŸºäºé¡¹ç›®å®æˆ˜ï¼Œç»“åˆ AG-UIã€A2UIã€MCP-UI ä¸‰å¤§åè®®çš„æºç æ·±åº¦åˆ†æï¼Œç³»ç»Ÿé˜è¿°å®ƒä»¬çš„è®¾è®¡å“²å­¦ã€æ ¸å¿ƒæœºåˆ¶ã€å®ç°æ–¹æ¡ˆåŠå¯¹æ¥æ–¹å¼ï¼Œå¹¶æ¢è®¨åè®®ç»„åˆä½¿ç”¨çš„æœ€ä½³å®è·µã€‚

> **æ‘˜è¦**ï¼šéšç€å¤§æ¨¡å‹ä»"å¯¹è¯æ¡†"æ¼”è¿›ä¸º"è‡ªä¸»æ™ºèƒ½ä½“"ï¼Œå¦‚ä½•è®© Agent å…·å¤‡å¯Œäº¤äº’èƒ½åŠ›æˆä¸ºå…³é”®æŒ‘æˆ˜ã€‚æœ¬æ–‡åŸºäºé¡¹ç›®å®æˆ˜ï¼Œç»“åˆ AG-UIã€A2UIã€MCP-UI ä¸‰å¤§åè®®çš„æºç æ·±åº¦åˆ†æï¼Œç³»ç»Ÿé˜è¿°å®ƒä»¬çš„è®¾è®¡å“²å­¦ã€æ ¸å¿ƒæœºåˆ¶ã€å®ç°æ–¹æ¡ˆåŠå¯¹æ¥æ–¹å¼ï¼Œå¹¶æ¢è®¨åè®®ç»„åˆä½¿ç”¨çš„æœ€ä½³å®è·µã€‚

* * *

ç›®å½•
--

1.  [å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ Agent-UI åè®®ï¼Ÿ](#1-%E5%BC%95%E8%A8%80%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-agent-ui-%E5%8D%8F%E8%AE%AE)
2.  [AG-UIï¼šäº‹ä»¶é©±åŠ¨çš„æ™ºèƒ½ä½“äº¤äº’åè®®](#2-ag-ui%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93%E4%BA%A4%E4%BA%92%E5%8D%8F%E8%AE%AE)
3.  [A2UIï¼šå£°æ˜å¼ UI çš„é›¶ä¿¡ä»»æ¸²æŸ“å¼•æ“](#3-a2ui%E5%A3%B0%E6%98%8E%E5%BC%8F-ui-%E7%9A%84%E9%9B%B6%E4%BF%A1%E4%BB%BB%E6%B8%B2%E6%9F%93%E5%BC%95%E6%93%8E)
4.  [MCP-UIï¼šMCP åè®®çš„å¯è§†åŒ–æ‰©å±•å±‚](#4-mcp-uimcp-%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E6%89%A9%E5%B1%95%E5%B1%82)
5.  [åè®®ç»„åˆï¼šAG-UI + A2UI çš„ååŒæ¶æ„](#5-%E5%8D%8F%E8%AE%AE%E7%BB%84%E5%90%88ag-ui--a2ui-%E7%9A%84%E5%8D%8F%E5%90%8C%E6%9E%B6%E6%9E%84)
6.  [æŠ€æœ¯é€‰å‹å†³ç­–æ¡†æ¶](#6-%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E5%86%B3%E7%AD%96%E6%A1%86%E6%9E%B6)
7.  [Demo é¡¹ç›®å®æˆ˜è§£æ](#7-demo-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98%E8%A7%A3%E6%9E%90)
8.  [æ€»ç»“ä¸å±•æœ›](#8-%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B)

* * *

1\. å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ Agent-UI åè®®ï¼Ÿ
-------------------------

### 1.1 ä¼ ç»Ÿ Chatbot çš„å±€é™æ€§

ä¼ ç»Ÿçš„ AI èŠå¤©æœºå™¨äººé‡‡ç”¨ç®€å•çš„ **Request-Response** æ¨¡å¼ï¼šç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼Œæ¨¡å‹è¿”å›æ–‡æœ¬ã€‚è¿™ç§æ¨¡å¼åœ¨é¢å¯¹å¤æ‚ä¸šåŠ¡åœºæ™¯æ—¶æš´éœ²å‡ºä¸¥é‡ä¸è¶³ï¼š

    ç”¨æˆ· â†’ "å¸®æˆ‘è®¢ä¸€å®¶åŒ—äº¬çš„å·èœé¦†"
    ä¼ ç»Ÿ Bot â†’ "å¥½çš„ï¼Œæˆ‘æ‰¾åˆ°äº†ä»¥ä¸‹é¤å…ï¼š1. å·åŠé¤å…... 2. çœ‰å·ä¸œå¡..."
    

**é—®é¢˜**ï¼š

*   âŒ æ— æ³•å±•ç¤ºé¤å…å›¾ç‰‡ã€è¯„åˆ†ã€ä»·æ ¼ç­‰ç»“æ„åŒ–ä¿¡æ¯
*   âŒ ç”¨æˆ·éœ€è¦æ‰‹åŠ¨å¤åˆ¶é¤å…åç§°å†å»æœç´¢
*   âŒ æ— æ³•ç›´æ¥åœ¨å¯¹è¯ä¸­å®Œæˆé¢„è®¢æ“ä½œ

### 1.2 Agent æ—¶ä»£çš„æ–°éœ€æ±‚

å½“ AI ä» Chatbot å‡çº§ä¸º Agent åï¼Œäº¤äº’æ¨¡å¼å‘ç”Ÿäº†æœ¬è´¨å˜åŒ–ï¼š

ç»´åº¦

Chatbot

Agent

**è¿è¡Œæ—¶é—´**

çŸ­ï¼ˆæ¯«ç§’çº§ï¼‰

é•¿ï¼ˆç§’/åˆ†é’Ÿçº§ï¼‰

**è¾“å‡ºç±»å‹**

çº¯æ–‡æœ¬

æ–‡æœ¬ + ç»“æ„åŒ–æ•°æ® + UI æ§åˆ¶

**çŠ¶æ€ç®¡ç†**

æ— çŠ¶æ€

å¤æ‚çŠ¶æ€æœº

**äº¤äº’æ¨¡å¼**

å•è½® Q&A

å¤šè½®å·¥å…·è°ƒç”¨ + äººæœºåä½œ

flowchart TB subgraph Chatbot\["ğŸ¤– ä¼ ç»Ÿ Chatbot"\] direction TB U1\["ğŸ‘¤ ç”¨æˆ·"\] -->|"æ–‡æœ¬è¾“å…¥"| B1\["ğŸ’¬ Bot"\] B1 -->|"æ–‡æœ¬è¾“å‡º"| U1 end subgraph Agent\["ğŸ¦¾ æ™ºèƒ½ä½“ Agent"\] direction TB U2\["ğŸ‘¤ ç”¨æˆ·"\] -->|"å¤šæ¨¡æ€è¾“å…¥"| A\["ğŸ§  Agent"\] A -->|"çŠ¶æ€äº‹ä»¶"| SM\["ğŸ“Š çŠ¶æ€æœº"\] SM -->|"UI æ›´æ–°"| UI\["ğŸ–¥ï¸ å¯Œäº¤äº’ UI"\] A <-->|"å·¥å…·è°ƒç”¨"| T\["ğŸ”§ Tools"\] UI -->|"ç”¨æˆ·æ“ä½œ"| A end Chatbot -.->|"æ¼”è¿›"| Agent

### 1.3 ä¸‰ç§åè®®çš„å®šä½

ä¸šç•Œç»™å‡ºäº†ä¸‰ç§æˆªç„¶ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼š

åè®®

æ¥æº

æ ¸å¿ƒå®šä½

ä¸€å¥è¯æ¦‚æ‹¬

**AG-UI**

CopilotKit

äº‹ä»¶é©±åŠ¨çš„çŠ¶æ€åŒæ­¥åè®®

"è®©å‰ç«¯å®æ—¶æ„ŸçŸ¥ Agent çš„æ¯ä¸€æ­¥æ€è€ƒ"

**A2UI**

Google

å£°æ˜å¼ UI ç»„ä»¶è§„èŒƒ

"Agent æè¿°æ„å›¾ï¼Œå®¢æˆ·ç«¯è´Ÿè´£æ¸²æŸ“"

**MCP-UI**

ç¤¾åŒº

MCP å·¥å…·çš„å¯è§†åŒ–æ‰©å±•

"è®©å·¥å…·è°ƒç”¨ç»“æœå…·å¤‡å¯è§†åŒ–èƒ½åŠ›"

* * *

2\. AG-UIï¼šäº‹ä»¶é©±åŠ¨çš„æ™ºèƒ½ä½“äº¤äº’åè®®
----------------------

### 2.1 è®¾è®¡å“²å­¦

AG-UIï¼ˆAgent-User Interaction Protocolï¼‰çš„æ ¸å¿ƒç†å¿µå¯ä»¥æ¦‚æ‹¬ä¸ºï¼š

> **"UI æ˜¯å‰ç«¯çš„é¢†åŸŸï¼ŒAgent åªè´Ÿè´£å¹¿æ’­çŠ¶æ€å˜åŒ–"**

AG-UI è®¤ä¸ºï¼šAgent ä¸åº”è¯¥çŸ¥é“"æŒ‰é’®æ˜¯åœ†çš„è¿˜æ˜¯æ–¹çš„"ï¼Œä¸åº”è¯¥çŸ¥é“"å½“å‰æ˜¯ React è¿˜æ˜¯ Vue"ã€‚Agent åªéœ€è¦å‘Šè¯‰å‰ç«¯ï¼š"æˆ‘æ­£åœ¨è°ƒç”¨æœç´¢å·¥å…·"ã€"æœç´¢å‚æ•°æ˜¯ XXX"ã€"æœç´¢ç»“æœæ˜¯ YYY"ã€‚è‡³äºå¦‚ä½•æ¸²æŸ“è¿™äº›ä¿¡æ¯ï¼Œå®Œå…¨ç”±å‰ç«¯å†³å®šã€‚

è¿™ç§è®¾è®¡å¸¦æ¥äº†å‡ ä¸ªæ ¸å¿ƒä¼˜åŠ¿ï¼š

1.  **å‰ç«¯è‡ªç”±åº¦æœ€å¤§åŒ–**ï¼šåŒä¸€ä¸ª Agent å¯ä»¥å¯¹æ¥ Webã€Mobileã€CLI ç­‰ä¸åŒå®¢æˆ·ç«¯
2.  **å®æ—¶æ€§æå¼º**ï¼šåŸºäºæµå¼äº‹ä»¶ï¼Œç”¨æˆ·èƒ½çœ‹åˆ° Agent æ€è€ƒçš„æ¯ä¸€æ­¥
3.  **ä¸ç°æœ‰åº”ç”¨æ·±åº¦é›†æˆ**ï¼šAgent å¯ä»¥é©±åŠ¨ç°æœ‰ UI çš„çŠ¶æ€å˜åŒ–

flowchart LR subgraph Backend\["ğŸ”™ Agent Backend"\] LLM\["ğŸ§  LLM"\] --> EP\["Event Producer"\] Tools\["ğŸ”§ Tools"\] --> EP end subgraph Transport\["ğŸ“¡ ä¼ è¾“å±‚"\] EP -->|"SSE Stream"| SSE\["text/event-stream"\] end subgraph Frontend\["ğŸ–¥ï¸ Frontend"\] SSE --> Parser\["Event Parser"\] Parser --> SM\["State Machine"\] SM --> |"TEXT\_MESSAGE"| Chat\["ğŸ’¬ èŠå¤©åŒº"\] SM --> |"TOOL\_CALL"| TC\["ğŸ”§ å·¥å…·å¡ç‰‡"\] SM --> |"STATE\_DELTA"| App\["ğŸ“Š åº”ç”¨çŠ¶æ€"\] end

### 2.2 æ ¸å¿ƒæœºåˆ¶ï¼šäº‹ä»¶ç±»å‹ç³»ç»Ÿ

AG-UI å®šä¹‰äº†ä¸€å¥—å®Œæ•´çš„äº‹ä»¶ç±»å‹ä½“ç³»ï¼ˆçº¦ 20+ ç§ï¼‰ï¼ŒæŒ‰åŠŸèƒ½å¯åˆ†ä¸ºå››å¤§ç±»ï¼š

#### 2.2.1 ç”Ÿå‘½å‘¨æœŸäº‹ä»¶

    // æºç ä½ç½®ï¼šag-ui/sdks/typescript/packages/core/src/events.ts
    
    enum EventType {
      // è¿è¡Œç”Ÿå‘½å‘¨æœŸ
      RUN_STARTED = "RUN_STARTED",      // Agent å¼€å§‹æ‰§è¡Œ
      RUN_FINISHED = "RUN_FINISHED",    // Agent æ‰§è¡Œå®Œæˆ
      RUN_ERROR = "RUN_ERROR",          // Agent æ‰§è¡Œå‡ºé”™
      
      // æ­¥éª¤ç”Ÿå‘½å‘¨æœŸ
      STEP_STARTED = "STEP_STARTED",    // å¼€å§‹æ‰§è¡ŒæŸä¸ªæ­¥éª¤
      STEP_FINISHED = "STEP_FINISHED",  // æ­¥éª¤æ‰§è¡Œå®Œæˆ
    }
    

#### 2.2.2 æ¶ˆæ¯æµäº‹ä»¶

    enum EventType {
      // æ–‡æœ¬æ¶ˆæ¯ï¼ˆæµå¼ï¼‰
      TEXT_MESSAGE_START = "TEXT_MESSAGE_START",
      TEXT_MESSAGE_CONTENT = "TEXT_MESSAGE_CONTENT",  // delta: å¢é‡æ–‡æœ¬
      TEXT_MESSAGE_END = "TEXT_MESSAGE_END",
      TEXT_MESSAGE_CHUNK = "TEXT_MESSAGE_CHUNK",      // æ‰¹é‡æ¨¡å¼
      
      // æ€è€ƒè¿‡ç¨‹ï¼ˆå¯é€‰æš´éœ²ï¼‰
      THINKING_TEXT_MESSAGE_START = "THINKING_TEXT_MESSAGE_START",
      THINKING_TEXT_MESSAGE_CONTENT = "THINKING_TEXT_MESSAGE_CONTENT",
      THINKING_TEXT_MESSAGE_END = "THINKING_TEXT_MESSAGE_END",
    }
    

#### 2.2.3 å·¥å…·è°ƒç”¨äº‹ä»¶

    enum EventType {
      // å·¥å…·è°ƒç”¨ç”Ÿå‘½å‘¨æœŸ
      TOOL_CALL_START = "TOOL_CALL_START",   // åŒ…å« toolCallId, toolCallName
      TOOL_CALL_ARGS = "TOOL_CALL_ARGS",      // æµå¼å‚æ•°ï¼šdelta å­—æ®µ
      TOOL_CALL_END = "TOOL_CALL_END",
      TOOL_CALL_RESULT = "TOOL_CALL_RESULT",  // å·¥å…·æ‰§è¡Œç»“æœ
      TOOL_CALL_CHUNK = "TOOL_CALL_CHUNK",    // æ‰¹é‡æ¨¡å¼
    }
    

#### 2.2.4 çŠ¶æ€åŒæ­¥äº‹ä»¶

    enum EventType {
      // çŠ¶æ€ç®¡ç†
      STATE_SNAPSHOT = "STATE_SNAPSHOT",      // å®Œæ•´çŠ¶æ€å¿«ç…§
      STATE_DELTA = "STATE_DELTA",            // å¢é‡çŠ¶æ€ï¼ˆJSON Patch RFC 6902ï¼‰
      MESSAGES_SNAPSHOT = "MESSAGES_SNAPSHOT", // å®Œæ•´æ¶ˆæ¯å†å²
      
      // æ´»åŠ¨çŠ¶æ€ï¼ˆç”¨äº UI å±•ç¤ºï¼‰
      ACTIVITY_SNAPSHOT = "ACTIVITY_SNAPSHOT",
      ACTIVITY_DELTA = "ACTIVITY_DELTA",
    }
    

### 2.3 å®ç°æ–¹æ¡ˆï¼šä¼ è¾“å±‚ä¸å®¢æˆ·ç«¯

#### 2.3.1 ä¼ è¾“å±‚ï¼šSSE + HTTP Binary

AG-UI æ”¯æŒå¤šç§ä¼ è¾“æ–¹å¼ï¼Œå…¶ä¸­ SSEï¼ˆServer-Sent Eventsï¼‰æ˜¯æœ€å¸¸ç”¨çš„ï¼š

    // æºç ä½ç½®ï¼šag-ui/sdks/typescript/packages/client/src/agent/http.ts
    
    export class HttpAgent extends AbstractAgent {
      protected requestInit(input: RunAgentInput): RequestInit {
        return {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "text/event-stream",  // å…³é”®ï¼šè¯·æ±‚ SSE æ ¼å¼
          },
          body: JSON.stringify(input),
        };
      }
    
      run(input: RunAgentInput): Observable<BaseEvent> {
        // 1. å‘èµ· HTTP è¯·æ±‚è·å– SSE æµ
        const httpEvents = runHttpRequest(this.url, this.requestInit(input));
        // 2. è½¬æ¢ä¸º AG-UI äº‹ä»¶æµ
        return transformHttpEventStream(httpEvents);
      }
    }
    

ä¼ è¾“å±‚æ•°æ®æ ¼å¼ç¤ºä¾‹ï¼š

    event: TEXT_MESSAGE_START
    data: {"type":"TEXT_MESSAGE_START","messageId":"msg_001","role":"assistant"}
    
    event: TEXT_MESSAGE_CONTENT
    data: {"type":"TEXT_MESSAGE_CONTENT","messageId":"msg_001","delta":"æˆ‘æ¥å¸®æ‚¨"}
    
    event: TEXT_MESSAGE_CONTENT
    data: {"type":"TEXT_MESSAGE_CONTENT","messageId":"msg_001","delta":"æœç´¢é¤å…..."}
    
    event: TOOL_CALL_START
    data: {"type":"TOOL_CALL_START","toolCallId":"call_001","toolCallName":"search_restaurants"}
    
    event: TOOL_CALL_ARGS
    data: {"type":"TOOL_CALL_ARGS","toolCallId":"call_001","delta":"{\"cuisine\":\"å·èœ\"}"}
    

#### 2.3.2 å®¢æˆ·ç«¯ï¼šObservable + ä¸­é—´ä»¶æ¶æ„

AG-UI å®¢æˆ·ç«¯é‡‡ç”¨ **RxJS Observable** æ¨¡å¼å¤„ç†äº‹ä»¶æµï¼Œå¹¶æ”¯æŒä¸­é—´ä»¶æ‰©å±•ï¼š

    // æºç ä½ç½®ï¼šag-ui/sdks/typescript/packages/client/src/agent/agent.ts
    
    export abstract class AbstractAgent {
      private middlewares: Middleware[] = [];
      
      // è®¢é˜…è€…æ¨¡å¼ï¼šæ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…
      public subscribe(subscriber: AgentSubscriber) {
        this.subscribers.push(subscriber);
        return { unsubscribe: () => { /* ... */ } };
      }
      
      // ä¸­é—´ä»¶æ³¨å†Œ
      public use(...middlewares: (Middleware | MiddlewareFunction)[]): this {
        this.middlewares.push(...normalizedMiddlewares);
        return this;
      }
      
      // æŠ½è±¡æ–¹æ³•ï¼šå…·ä½“ Agent å®ç°äº‹ä»¶æµ
      abstract run(input: RunAgentInput): Observable<BaseEvent>;
    }
    

### 2.4 å¯¹æ¥æ–¹å¼

#### 2.4.1 æœåŠ¡ç«¯å¯¹æ¥ï¼ˆPython ç¤ºä¾‹ï¼‰

    # Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/agents/ag-ui-agent/server.py
    
    from sse_starlette.sse import EventSourceResponse
    
    async def generate_events() -> AsyncGenerator[str, None]:
        # 1. å‘é€ RUN_STARTED
        yield create_event(EventType.RUN_STARTED, {
            "threadId": thread_id,
            "runId": run_id
        })
        
        # 2. æµå¼è°ƒç”¨ LLM
        async for chunk in llm_stream:
            if chunk.choices[0].delta.content:
                yield create_event(EventType.TEXT_MESSAGE_CONTENT, {
                    "messageId": msg_id,
                    "delta": chunk.choices[0].delta.content
                })
            
            if chunk.choices[0].delta.tool_calls:
                # å¤„ç†å·¥å…·è°ƒç”¨...
                yield create_event(EventType.TOOL_CALL_START, {...})
        
        # 3. å‘é€ RUN_FINISHED
        yield create_event(EventType.RUN_FINISHED, {
            "threadId": thread_id,
            "runId": run_id
        })
    
    @app.post("/run")
    async def run(request: RunRequest):
        return EventSourceResponse(generate_events())
    

#### 2.4.2 å‰ç«¯å¯¹æ¥ï¼ˆReact ç¤ºä¾‹ï¼‰

    // Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/apps/web/src/app/ag-ui-demo/page.tsx
    
    const handleSendMessage = async (content: string) => {
      const response = await fetch('http://localhost:8001/run', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ messages: [{ role: 'user', content }] }),
      });
      
      const reader = response.body.getReader();
      const decoder = new TextDecoder();
      
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        
        // è§£æ SSE äº‹ä»¶
        const events = parseSSE(decoder.decode(value));
        
        for (const event of events) {
          switch (event.type) {
            case 'TEXT_MESSAGE_CONTENT':
              // æ›´æ–°æ¶ˆæ¯å†…å®¹ï¼ˆæµå¼ï¼‰
              setMessages(prev => updateMessageContent(prev, event));
              break;
            case 'TOOL_CALL_START':
              // æ˜¾ç¤ºå·¥å…·è°ƒç”¨ UI
              setMessages(prev => addToolCall(prev, event));
              break;
            case 'TOOL_CALL_RESULT':
              // æ¸²æŸ“å·¥å…·ç»“æœ
              setMessages(prev => updateToolResult(prev, event));
              break;
          }
        }
      }
    };
    

stateDiagram-v2 \[\*\] --> Idle: åˆå§‹åŒ– Idle --> Running: RUN\_STARTED state Running { \[\*\] --> Streaming Streaming --> ToolCalling: TOOL\_CALL\_START ToolCalling --> Streaming: TOOL\_CALL\_RESULT Streaming --> Streaming: TEXT\_MESSAGE\_CONTENT } Running --> Idle: RUN\_FINISHED Running --> Error: RUN\_ERROR Error --> Idle: é‡è¯•

* * *

3\. A2UIï¼šå£°æ˜å¼ UI çš„é›¶ä¿¡ä»»æ¸²æŸ“å¼•æ“
------------------------

### 3.1 è®¾è®¡å“²å­¦

A2UIï¼ˆAgent-to-User Interfaceï¼‰ç”± Google æ¨å‡ºï¼Œå…¶æ ¸å¿ƒç†å¿µæ˜¯ï¼š

> **"Safe like data, expressive like code"**ï¼ˆåƒæ•°æ®ä¸€æ ·å®‰å…¨ï¼Œåƒä»£ç ä¸€æ ·æœ‰è¡¨ç°åŠ›ï¼‰

ä¸ AG-UI çš„"å‰ç«¯ä¸»å¯¼"ä¸åŒï¼ŒA2UI é‡‡ç”¨"**åç«¯ä¸»å¯¼**"çš„æ€è·¯ï¼šAgent ä¸ä»…å‘é€æ•°æ®ï¼Œè¿˜å‘é€ **UI ç»“æ„æè¿°**ã€‚ä½†ä¸ºäº†å®‰å…¨ï¼ŒA2UI ç»å¯¹ä¸å…è®¸ Agent å‘é€å¯æ‰§è¡Œä»£ç ï¼ˆHTML/JSï¼‰ï¼Œè€Œæ˜¯å‘é€ä¸€ç§**å£°æ˜å¼çš„ç»„ä»¶æè¿° JSON**ã€‚

#### 3.1.1 å®‰å…¨æ€§è®¾è®¡

A2UI çš„å®‰å…¨æ¨¡å‹åŸºäº"ç™½åå•ç»„ä»¶åº“"ï¼ˆCatalogï¼‰æœºåˆ¶ï¼š

    Agent åªèƒ½è¯´ï¼š"æˆ‘è¦æ¸²æŸ“ä¸€ä¸ª Card ç»„ä»¶ï¼ŒID æ˜¯ 123ï¼Œæ ‡é¢˜æ˜¯ XXX"
    Agent ä¸èƒ½è¯´ï¼š"<script>alert('XSS')</script>"
    

è¿™ç§è®¾è®¡å®Œå…¨æœç»äº† LLM ç”Ÿæˆæ¶æ„ä»£ç çš„é£é™©ã€‚

#### 3.1.2 è·¨å¹³å°è®¾è®¡

ç”±äº A2UI å‘é€çš„æ˜¯æŠ½è±¡ç»„ä»¶æè¿°è€Œéå…·ä½“å®ç°ï¼ŒåŒä¸€å¥—åè®®å¯ä»¥ï¼š

*   åœ¨ **Web** ç«¯æ¸²æŸ“ä¸º DOM å…ƒç´ 
*   åœ¨ **iOS** ç«¯æ¸²æŸ“ä¸º SwiftUI View
*   åœ¨ **Android** ç«¯æ¸²æŸ“ä¸º Compose ç»„ä»¶
*   åœ¨ **Flutter** ä¸­æ¸²æŸ“ä¸º Widget

flowchart TB subgraph Agent\["ğŸ§  Agent"\] LLM\["LLM"\] --> Gen\["A2UI Generator"\] end subgraph Protocol\["ğŸ“¦ A2UI JSON"\] Gen --> JSON\["{â€œupdateComponentsâ€: ...}"\] end subgraph Renderers\["ğŸŒ å„å¹³å°æ¸²æŸ“å™¨"\] JSON --> Web\["ğŸŒ Web\\nLit/React"\] JSON --> iOS\["ğŸ iOS\\nSwiftUI"\] JSON --> Android\["ğŸ¤– Android\\nCompose"\] JSON --> Flutter\["ğŸ¦ Flutter\\nWidget"\] end subgraph Output\["ğŸ“± åŸç”Ÿ UI"\] Web --> O1\["ğŸ–¥ï¸ DOM"\] iOS --> O2\["ğŸ“± UIKit View"\] Android --> O3\["ğŸ“± Compose UI"\] Flutter --> O4\["ğŸ“± Widget Tree"\] end

### 3.2 æ ¸å¿ƒæœºåˆ¶ï¼šé‚»æ¥è¡¨ç»„ä»¶æ¨¡å‹

#### 3.2.1 ä¸ºä»€ä¹ˆä¸ç”¨åµŒå¥— JSONï¼Ÿ

ä¼ ç»Ÿçš„ UI æè¿°é€šå¸¸é‡‡ç”¨åµŒå¥—ç»“æ„ï¼š

    // âŒ ä¼ ç»ŸåµŒå¥—ç»“æ„ - å¯¹ LLM ä¸å‹å¥½
    {
      "type": "Column",
      "children": [
        {
          "type": "Text",
          "text": "Hello"
        },
        {
          "type": "Button",
          "children": [{ "type": "Text", "text": "Click" }]
        }
      ]
    }
    

**é—®é¢˜**ï¼š

*   LLM å¿…é¡»ä¸€æ¬¡æ€§ç”Ÿæˆå®Œç¾åµŒå¥—ï¼Œå®¹æ˜“å‡ºé”™
*   éš¾ä»¥å¢é‡æ›´æ–°ï¼ˆéœ€è¦é‡æ–°å‘é€æ•´ä¸ªæ ‘ï¼‰
*   æ·±å±‚åµŒå¥—éš¾ä»¥æµå¼ç”Ÿæˆ

#### 3.2.2 é‚»æ¥è¡¨æ¨¡å‹

A2UI é‡‡ç”¨**é‚»æ¥è¡¨**ï¼ˆAdjacency Listï¼‰ç»“æ„ï¼Œå°†ç»„ä»¶æ ‘"æ‹å¹³"ä¸ºåˆ—è¡¨ï¼š

    // æºç ä½ç½®ï¼šA2UI/docs/concepts/components.md
    
    // âœ… A2UI é‚»æ¥è¡¨ç»“æ„ - LLM å‹å¥½
    {
      "surfaceUpdate": {
        "surfaceId": "main",
        "components": [
          {"id": "root", "component": {"Column": {"children": {"explicitList": ["greeting", "buttons"]}}}},
          {"id": "greeting", "component": {"Text": {"text": {"literalString": "Hello"}}}},
          {"id": "buttons", "component": {"Row": {"children": {"explicitList": ["cancel-btn", "ok-btn"]}}}},
          {"id": "cancel-btn", "component": {"Button": {"child": "cancel-text", "action": {"name": "cancel"}}}},
          {"id": "cancel-text", "component": {"Text": {"text": {"literalString": "Cancel"}}}},
          {"id": "ok-btn", "component": {"Button": {"child": "ok-text", "action": {"name": "ok"}}}},
          {"id": "ok-text", "component": {"Text": {"text": {"literalString": "OK"}}}}
        ]
      }
    }
    

**ä¼˜åŠ¿**ï¼š

*   âœ… LLM å¯ä»¥é€ä¸ªç”Ÿæˆç»„ä»¶ï¼Œæ— éœ€è€ƒè™‘åµŒå¥—
*   âœ… å¢é‡æ›´æ–°ï¼šåªå‘é€å˜åŒ–çš„ç»„ä»¶
*   âœ… å¤©ç„¶æ”¯æŒæµå¼ä¼ è¾“ï¼ˆJSONL æ ¼å¼ï¼‰

### 3.3 æ¶ˆæ¯ç±»å‹ä½“ç³»

A2UI å®šä¹‰äº†å››ç§æ ¸å¿ƒæ¶ˆæ¯ç±»å‹ï¼š

    // æºç ä½ç½®ï¼šA2UI/specification/0.9/json/server_to_client.json
    
    {
      "oneOf": [
        { "$ref": "#/$defs/CreateSurfaceMessage" },     // åˆ›å»º UI è¡¨é¢
        { "$ref": "#/$defs/UpdateComponentsMessage" },  // æ›´æ–°ç»„ä»¶
        { "$ref": "#/$defs/UpdateDataModelMessage" },   // æ›´æ–°æ•°æ®æ¨¡å‹
        { "$ref": "#/$defs/DeleteSurfaceMessage" }      // åˆ é™¤ UI è¡¨é¢
      ]
    }
    

#### 3.3.1 createSurfaceï¼šåˆå§‹åŒ– UI è¡¨é¢

    {
      "createSurface": {
        "surfaceId": "restaurant-list",
        "catalogId": "a2ui.dev:standard"  // å£°æ˜ä½¿ç”¨çš„ç»„ä»¶åº“
      }
    }
    

#### 3.3.2 updateComponentsï¼šå‘é€ç»„ä»¶å®šä¹‰

    {
      "updateComponents": {
        "surfaceId": "restaurant-list",
        "components": [
          {
            "id": "root",
            "component": {
              "Column": {
                "children": {"explicitList": ["header", "list"]}
              }
            }
          },
          {
            "id": "header",
            "component": {
              "Text": {
                "text": {"literalString": "æ¨èé¤å…"},
                "usageHint": "h1"
              }
            }
          }
          // ... æ›´å¤šç»„ä»¶
        ]
      }
    }
    

#### 3.3.3 updateDataModelï¼šæ•°æ®ä¸ UI åˆ†ç¦»

A2UI çš„ä¸€ä¸ªé‡è¦è®¾è®¡æ˜¯**æ•°æ®æ¨¡å‹ä¸ç»„ä»¶ç»“æ„åˆ†ç¦»**ã€‚ç»„ä»¶å¯ä»¥é€šè¿‡ `path` ç»‘å®šæ•°æ®ï¼š

    // 1. ç»„ä»¶å®šä¹‰ï¼ˆç»“æ„ï¼‰
    {
      "updateComponents": {
        "surfaceId": "restaurant-list",
        "components": [{
          "id": "restaurant-name",
          "component": {
            "Text": {
              "text": {"path": "/restaurants/0/name"}  // æ•°æ®ç»‘å®š
            }
          }
        }]
      }
    }
    
    // 2. æ•°æ®æ›´æ–°ï¼ˆå†…å®¹ï¼‰
    {
      "updateDataModel": {
        "surfaceId": "restaurant-list",
        "path": "/restaurants/0",
        "op": "replace",
        "value": {
          "name": "å·åŠé¤å…",
          "rating": 4.8,
          "price": "$$"
        }
      }
    }
    

**ä¼˜åŠ¿**ï¼š

*   æ›´æ–°æ•°æ®æ— éœ€é‡æ–°å‘é€ç»„ä»¶ç»“æ„
*   å¤šä¸ªç»„ä»¶å¯ä»¥ç»‘å®šåŒä¸€æ•°æ®è·¯å¾„
*   LLM å¯ä»¥åˆ†æ­¥ç”Ÿæˆç»“æ„å’Œæ•°æ®

### 3.4 æ ‡å‡†ç»„ä»¶åº“ï¼ˆCatalogï¼‰

A2UI å®šä¹‰äº†ä¸€å¥—æ ‡å‡†ç»„ä»¶åº“ï¼Œæ¶µç›–å¸¸è§ UI éœ€æ±‚ï¼š

    // æºç ä½ç½®ï¼šA2UI/specification/0.9/json/standard_catalog_definition.json
    
    {
      "$defs": {
        "anyComponent": {
          "oneOf": [
            // å±•ç¤ºç±»
            { "$ref": "#/$defs/Text" },
            { "$ref": "#/$defs/Image" },
            { "$ref": "#/$defs/Icon" },
            { "$ref": "#/$defs/Video" },
            { "$ref": "#/$defs/AudioPlayer" },
            
            // å¸ƒå±€ç±»
            { "$ref": "#/$defs/Row" },
            { "$ref": "#/$defs/Column" },
            { "$ref": "#/$defs/List" },
            
            // å®¹å™¨ç±»
            { "$ref": "#/$defs/Card" },
            { "$ref": "#/$defs/Tabs" },
            { "$ref": "#/$defs/Modal" },
            { "$ref": "#/$defs/Divider" },
            
            // äº¤äº’ç±»
            { "$ref": "#/$defs/Button" },
            { "$ref": "#/$defs/CheckBox" },
            { "$ref": "#/$defs/TextField" },
            { "$ref": "#/$defs/DateTimeInput" },
            { "$ref": "#/$defs/ChoicePicker" },
            { "$ref": "#/$defs/Slider" }
          ]
        }
      }
    }
    

### 3.5 å®¢æˆ·ç«¯æ¸²æŸ“å™¨ï¼ˆRendererï¼‰

A2UI æä¾›äº†å¤šç§æ¸²æŸ“å™¨å®ç°ï¼š

    // æºç ä½ç½®ï¼šA2UI/renderers/lit/src/0.8/core.ts
    
    export * as Events from "./events/events.js";
    export * as Types from "./types/types.js";
    
    import { create as createSignalA2uiMessageProcessor } from "./data/signal-model-processor.js";
    import { A2uiMessageProcessor } from "./data/model-processor.js";
    
    export const Data = {
      createSignalA2uiMessageProcessor,  // å“åº”å¼æ•°æ®å¤„ç†
      A2uiMessageProcessor,               // æ¶ˆæ¯å¤„ç†å™¨
      Guards,
    };
    

æ¸²æŸ“æµç¨‹ï¼š

1.  **è§£ææ¶ˆæ¯**ï¼šå°† JSONL è§£æä¸ºæ¶ˆæ¯å¯¹è±¡
2.  **æ„å»ºç»„ä»¶æ ‘**ï¼šæ ¹æ®é‚»æ¥è¡¨é‡å»ºæ ‘ç»“æ„
3.  **æ•°æ®ç»‘å®š**ï¼šå°† dataModel æ³¨å…¥ç»„ä»¶
4.  **åŸç”Ÿæ¸²æŸ“**ï¼šè°ƒç”¨å¹³å°åŸç”Ÿç»„ä»¶åº“

flowchart LR subgraph Input\["ğŸ“¥ è¾“å…¥"\] JSONL\["JSONL Stream"\] end subgraph Process\["âš™ï¸ å¤„ç†æµç¨‹"\] JSONL --> Parse\["1ï¸âƒ£ è§£ææ¶ˆæ¯"\] Parse --> Build\["2ï¸âƒ£ æ„å»ºç»„ä»¶æ ‘"\] Build --> Bind\["3ï¸âƒ£ æ•°æ®ç»‘å®š"\] Bind --> Render\["4ï¸âƒ£ åŸç”Ÿæ¸²æŸ“"\] end subgraph Output\["ğŸ“± è¾“å‡º"\] Render --> UI\["åŸç”Ÿ UI ç»„ä»¶"\] end subgraph DataFlow\["ğŸ“Š æ•°æ®æµ"\] DM\[("DataModel")\] -.->|"/path/to/data"| Bind end

### 3.6 ç”¨æˆ·äº¤äº’ï¼šAction å›ä¼ 

å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ç­‰äº¤äº’æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ `userAction` æ¶ˆæ¯ï¼š

    // æºç ä½ç½®ï¼šA2UI/specification/0.9/json/client_to_server.json
    
    {
      "userAction": {
        "name": "book_restaurant",           // action åç§°
        "surfaceId": "restaurant-list",
        "sourceComponentId": "book-btn",
        "timestamp": "2024-01-07T10:30:00Z",
        "context": {                         // ä¸Šä¸‹æ–‡æ•°æ®
          "restaurantId": "rest_001",
          "restaurantName": "å·åŠé¤å…"
        }
      }
    }
    

### 3.7 å¯¹æ¥æ–¹å¼

#### 3.7.1 æœåŠ¡ç«¯å¯¹æ¥ï¼ˆPython ç¤ºä¾‹ï¼‰

    # Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/agents/a2ui-agent/server.py
    
    class A2UIGenerator:
        @staticmethod
        def surface_update(surface_id: str, components: list) -> dict:
            return {"surfaceUpdate": {"surfaceId": surface_id, "components": components}}
    
        @staticmethod
        def data_model_update(surface_id: str, path: str, value: any) -> dict:
            return {
                "updateDataModel": {
                    "surfaceId": surface_id,
                    "path": path,
                    "op": "replace",
                    "value": value
                }
            }
    
    async def generate_ui(restaurants: list):
        # 1. åˆ›å»º Surface
        yield json.dumps({"createSurface": {"surfaceId": "main", "catalogId": "standard"}})
        
        # 2. å‘é€ç»„ä»¶ç»“æ„
        components = create_restaurant_list_components()
        yield json.dumps(A2UIGenerator.surface_update("main", components))
        
        # 3. å‘é€æ•°æ®
        for i, restaurant in enumerate(restaurants):
            yield json.dumps(A2UIGenerator.data_model_update(
                "main", 
                f"/restaurants/{i}", 
                restaurant
            ))
    

#### 3.7.2 å‰ç«¯å¯¹æ¥ï¼ˆReact ç¤ºä¾‹ï¼‰

    // Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/apps/web/src/app/a2ui-demo/A2UIRenderer.tsx
    
    const A2UIRenderer = ({ messages }: { messages: A2UIMessage[] }) => {
      const [components, setComponents] = useState<Map<string, ComponentDef>>();
      const [dataModel, setDataModel] = useState<Record<string, any>>({});
      
      useEffect(() => {
        for (const msg of messages) {
          if (msg.updateComponents) {
            // æ›´æ–°ç»„ä»¶ Map
            msg.updateComponents.components.forEach(comp => {
              setComponents(prev => new Map(prev).set(comp.id, comp));
            });
          }
          if (msg.updateDataModel) {
            // æ›´æ–°æ•°æ®æ¨¡å‹
            setDataModel(prev => ({
              ...prev,
              [msg.updateDataModel.path]: msg.updateDataModel.value
            }));
          }
        }
      }, [messages]);
      
      // é€’å½’æ¸²æŸ“ç»„ä»¶æ ‘
      const renderComponent = (id: string) => {
        const comp = components.get(id);
        if (!comp) return null;
        
        // æ ¹æ®ç»„ä»¶ç±»å‹æ˜ å°„åˆ° React ç»„ä»¶
        switch (Object.keys(comp.component)[0]) {
          case 'Text':
            const textValue = resolveValue(comp.component.Text.text, dataModel);
            return <span key={id}>{textValue}</span>;
          case 'Column':
            return (
              <div key={id} className="flex flex-col">
                {comp.component.Column.children.explicitList.map(renderComponent)}
              </div>
            );
          // ... å…¶ä»–ç»„ä»¶
        }
      };
      
      return renderComponent('root');
    };
    

* * *

4\. MCP-UIï¼šMCP åè®®çš„å¯è§†åŒ–æ‰©å±•å±‚
------------------------

### 4.1 è®¾è®¡å“²å­¦

MCP-UI æ˜¯ç¤¾åŒºåŸºäº Anthropic çš„ **Model Context Protocol (MCP)** å¼€å‘çš„ UI æ‰©å±•ã€‚å…¶æ ¸å¿ƒç†å¿µæ˜¯ï¼š

> **"è®©å·¥å…·è°ƒç”¨ç»“æœå…·å¤‡å¯è§†åŒ–èƒ½åŠ›"**

ä¸ AG-UIã€A2UI ä¸åŒï¼ŒMCP-UI ä¸è¯•å›¾å®šä¹‰æ–°çš„åè®®ï¼Œè€Œæ˜¯**å¤ç”¨ç°æœ‰çš„ MCP åè®®**ï¼Œåœ¨å·¥å…·è¿”å›å€¼ä¸­æ·»åŠ  `UIResource` å­—æ®µã€‚

#### 4.1.1 ä¸ MCP çš„å…³ç³»

    MCP åè®®ï¼š
      - Tool Definitionï¼ˆå·¥å…·å®šä¹‰ï¼‰
      - Tool Callï¼ˆå·¥å…·è°ƒç”¨ï¼‰
      - Tool Resultï¼ˆå·¥å…·ç»“æœï¼‰ â† MCP-UI åœ¨è¿™é‡Œæ‰©å±•
    

MCP-UI çš„åˆ›æ–°åœ¨äºï¼šå·¥å…·ä¸ä»…å¯ä»¥è¿”å›æ–‡æœ¬/JSON æ•°æ®ï¼Œè¿˜å¯ä»¥è¿”å›**å¯äº¤äº’çš„ UI ç‰‡æ®µ**ã€‚

### 4.2 æ ¸å¿ƒæœºåˆ¶ï¼šUIResource

#### 4.2.1 UIResource æ•°æ®ç»“æ„

    // æºç ä½ç½®ï¼šmcp-ui/sdks/typescript/server/src/types.ts
    
    interface UIResource {
      type: 'resource';
      resource: {
        uri: string;       // å”¯ä¸€æ ‡è¯†ï¼Œå¦‚ ui://component/booking-form
        mimeType: MimeType; // å†…å®¹ç±»å‹
        text?: string;      // å†…è”å†…å®¹
        blob?: string;      // Base64 ç¼–ç å†…å®¹
        _meta?: Record<string, unknown>;
      };
    }
    
    type MimeType =
      | 'text/html'                           // å†…è” HTML
      | 'text/uri-list'                       // å¤–éƒ¨ URL
      | 'application/vnd.mcp-ui.remote-dom+javascript; framework=react'
      | 'application/vnd.mcp-ui.remote-dom+javascript; framework=webcomponents';
    

#### 4.2.2 ä¸‰ç§æ¸²æŸ“æ¨¡å¼

MCP-UI æ”¯æŒä¸‰ç§ä¸åŒçš„ UI èµ„æºç±»å‹ï¼š

**1\. Raw HTMLï¼ˆå†…è” HTMLï¼‰**

    {
      uri: "ui://restaurant/card",
      mimeType: "text/html",
      text: `
        <div class="restaurant-card">
          <h2>å·åŠé¤å…</h2>
          <button onclick="window.parent.postMessage({type:'tool',payload:{toolName:'book'}},'*')">
            é¢„è®¢
          </button>
        </div>
      `
    }
    

**2\. External URLï¼ˆå¤–éƒ¨é¡µé¢ï¼‰**

    {
      uri: "ui://restaurant/detail",
      mimeType: "text/uri-list",
      text: "https://restaurant.example.com/embed/123"
    }
    

**3\. Remote DOMï¼ˆè¿œç¨‹ DOMï¼‰**

è¿™æ˜¯ MCP-UI æœ€å¼ºå¤§çš„æ¨¡å¼ï¼ŒåŸºäº Shopify çš„ [remote-dom](https://github.com/Shopify/remote-dom) æŠ€æœ¯ï¼š

    {
      uri: "ui://restaurant/form",
      mimeType: "application/vnd.mcp-ui.remote-dom+javascript; framework=react",
      text: `
        // è¿™æ®µ JS åœ¨æ²™ç®±ä¸­æ‰§è¡Œï¼Œé€šè¿‡ JSON æ¶ˆæ¯ä¸å®¿ä¸»é€šä¿¡
        const form = document.createElement('ui-form');
        form.addEventListener('submit', (e) => {
          window.postMessage({ type: 'tool', payload: { toolName: 'submit_booking', params: e.detail } });
        });
        document.body.appendChild(form);
      `
    }
    

flowchart TB subgraph Server\["ğŸ”§ MCP Server"\] Tool\["Tool Result"\] --> UIRes\["UIResource"\] end UIRes --> Type{"mimeType?"} subgraph Mode1\["ğŸ“„ Raw HTML"\] Type -->|"text/html"| HTML\["iframe srcDoc"\] HTML --> Sandbox1\["ğŸ”’ æ²™ç®±æ¸²æŸ“"\] end subgraph Mode2\["ğŸŒ External URL"\] Type -->|"text/uri-list"| URL\["iframe src"\] URL --> Sandbox2\["ğŸ”’ å¤–éƒ¨é¡µé¢"\] end subgraph Mode3\["ğŸ–¥ï¸ Remote DOM"\] Type -->|"remote-dom"| Script\["JS Script"\] Script --> Worker\["ğŸ”’ æ²™ç®±æ‰§è¡Œ"\] Worker -->|"JSON Patch"| Host\["ğŸ  å®¿ä¸»æ¸²æŸ“"\] end Sandbox1 & Sandbox2 & Host --> Actions\["ğŸ“¤ postMessage"\] Actions --> Client\["ğŸ“± å®¢æˆ·ç«¯å¤„ç†"\]

### 4.3 å®¢æˆ·ç«¯æ¸²æŸ“å™¨

#### 4.3.1 UIResourceRenderer ç»„ä»¶

    // æºç ä½ç½®ï¼šmcp-ui/sdks/typescript/client/src/components/UIResourceRenderer.tsx
    
    export const UIResourceRenderer = (props: UIResourceRendererProps) => {
      const { resource, onUIAction, supportedContentTypes } = props;
      const contentType = getContentType(resource);
    
      switch (contentType) {
        case 'rawHtml':
        case 'externalUrl':
          // ä½¿ç”¨ iframe æ²™ç®±æ¸²æŸ“
          return <HTMLResourceRenderer resource={resource} onUIAction={onUIAction} />;
          
        case 'remoteDom':
          // ä½¿ç”¨ Remote DOM æ¸²æŸ“ï¼ˆæ›´å®‰å…¨ã€æ›´çµæ´»ï¼‰
          return <RemoteDOMResourceRenderer resource={resource} onUIAction={onUIAction} />;
          
        default:
          return <p>Unsupported resource type.</p>;
      }
    };
    

#### 4.3.2 Remote DOM æ¸²æŸ“å™¨

Remote DOM æ¨¡å¼ä¸‹ï¼ŒUI é€»è¾‘åœ¨ iframe æ²™ç®±ä¸­æ‰§è¡Œï¼Œä½† DOM å˜åŒ–é€šè¿‡ JSON æ¶ˆæ¯åŒæ­¥åˆ°å®¿ä¸»ï¼š

    // æºç ä½ç½®ï¼šmcp-ui/sdks/typescript/client/src/components/RemoteDOMResourceRenderer.tsx
    
    const RemoteDOMResourceRenderer: React.FC<RemoteDOMResourceProps> = ({
      resource, library, onUIAction
    }) => {
      const iframeRef = useRef<HTMLIFrameElement>(null);
      
      // 1. åˆ›å»º Remote Receiverï¼ˆæ¥æ”¶ DOM å˜åŒ–ï¼‰
      const { receiver, components } = useMemo(() => {
        const reactReceiver = new RemoteReceiver();
        // å°†ç»„ä»¶åº“æ˜ å°„ä¸º Remote Components
        // ...
        return { receiver: reactReceiver, components: componentMap };
      }, [library]);
      
      // 2. ç›‘å¬ iframe æ¶ˆæ¯ï¼ˆUI Actionï¼‰
      useEffect(() => {
        const handleMessage = (event: MessageEvent) => {
          if (event.source === iframeRef.current?.contentWindow) {
            onUIAction?.(event.data as UIActionResult);
          }
        };
        window.addEventListener('message', handleMessage);
        return () => window.removeEventListener('message', handleMessage);
      }, [onUIAction]);
      
      // 3. iframe åŠ è½½åæ³¨å…¥ä»£ç 
      const handleIframeLoad = () => {
        const thread = new ThreadIframe<SandboxAPI>(iframeRef.current);
        thread.imports.render({ code: resource.text, ... }, receiver.connection);
      };
      
      return (
        <>
          <iframe ref={iframeRef} srcDoc={IFRAME_SRC_DOC} onLoad={handleIframeLoad} />
          {/* Remote DOM æ¸²æŸ“ç»“æœ */}
          <RemoteRootRenderer receiver={receiver} components={components} />
        </>
      );
    };
    

### 4.4 UI Action ç³»ç»Ÿ

MCP-UI å®šä¹‰äº†äº”ç§ UI äº¤äº’ç±»å‹ï¼š

    // æºç ä½ç½®ï¼šmcp-ui/sdks/typescript/client/src/types.ts
    
    export type UIActionResult =
      | { type: 'tool', payload: { toolName: string, params: Record<string, unknown> } }
      | { type: 'prompt', payload: { prompt: string } }
      | { type: 'link', payload: { url: string } }
      | { type: 'intent', payload: { intent: string, params: Record<string, unknown> } }
      | { type: 'notify', payload: { message: string } };
    

**ä½¿ç”¨åœºæ™¯**ï¼š

*   `tool`ï¼šè§¦å‘å·¥å…·è°ƒç”¨ï¼ˆå¦‚"é¢„è®¢"æŒ‰é’®ï¼‰
*   `prompt`ï¼šå‘é€æ–°çš„ç”¨æˆ·æ¶ˆæ¯
*   `link`ï¼šæ‰“å¼€å¤–éƒ¨é“¾æ¥
*   `intent`ï¼šè§¦å‘åº”ç”¨å†…æ„å›¾
*   `notify`ï¼šæ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯

### 4.5 å¯¹æ¥æ–¹å¼

#### 4.5.1 æœåŠ¡ç«¯å¯¹æ¥ï¼ˆPython ç¤ºä¾‹ï¼‰

    # Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/agents/mcp-ui-agent/server.py
    
    def create_restaurant_card_ui(restaurants: list) -> dict:
        html = f"""
        <div class="restaurant-list">
            {''.join([f'''
            <div class="restaurant-card" data-id="{r['id']}">
                <img src="{r['image']}" />
                <h3>{r['name']}</h3>
                <p>è¯„åˆ†: {r['rating']} | ä»·æ ¼: {r['price']}</p>
                <button onclick="window.parent.postMessage({{
                    type: 'tool',
                    payload: {{
                        toolName: 'show_booking_form',
                        params: {{ restaurant_name: '{r['name']}' }}
                    }}
                }}, '*')">é¢„è®¢</button>
            </div>
            ''' for r in restaurants])}
        </div>
        """
        
        return {
            "type": "ui_resource",
            "resource": {
                "uri": "ui://restaurant/list",
                "mimeType": "text/html",
                "text": html
            }
        }
    
    @app.post("/run")
    async def run(request: RunRequest):
        if request.tool_call:
            # ç›´æ¥æ‰§è¡Œå·¥å…·è°ƒç”¨
            result = execute_tool(request.tool_call.name, request.tool_call.params)
            return result
        else:
            # è®© LLM å†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·
            response = await call_llm_with_tools(request.messages)
            return response
    

#### 4.5.2 å‰ç«¯å¯¹æ¥ï¼ˆReact ç¤ºä¾‹ï¼‰

    // Demo é¡¹ç›®ï¼šdemo-agent-ui-protocols/apps/web/src/app/mcp-ui-demo/page.tsx
    
    const MCPUIDemo = () => {
      const [currentUI, setCurrentUI] = useState<UIResource | null>(null);
      
      // å¤„ç†æ¥è‡ª UI çš„ Action
      useEffect(() => {
        const handleMessage = async (event: MessageEvent) => {
          const { type, payload } = event.data;
          
          if (type === 'tool') {
            // è°ƒç”¨åç«¯å·¥å…·
            const response = await fetch('http://localhost:8003/run', {
              method: 'POST',
              body: JSON.stringify({ tool_call: payload }),
            });
            const result = await response.json();
            
            if (result.type === 'ui_resource') {
              setCurrentUI(result.resource);
            }
          }
        };
        
        window.addEventListener('message', handleMessage);
        return () => window.removeEventListener('message', handleMessage);
      }, []);
      
      return (
        <div>
          {currentUI && (
            <UIResourceRenderer 
              resource={currentUI.resource}
              onUIAction={handleToolCallback}
            />
          )}
        </div>
      );
    };
    

* * *

5\. åè®®ç»„åˆï¼šAG-UI + A2UI çš„ååŒæ¶æ„
---------------------------

### 5.1 ä¸ºä»€ä¹ˆè¦ç»„åˆä½¿ç”¨ï¼Ÿ

ä¸‰ç§åè®®å¹¶éäº’æ–¥å…³ç³»ï¼Œå®ƒä»¬å¯ä»¥**ååŒå·¥ä½œ**ï¼Œå‘æŒ¥å„è‡ªä¼˜åŠ¿ã€‚ç‰¹åˆ«æ˜¯ **AG-UI + A2UI** çš„ç»„åˆï¼Œåœ¨ A2UI å®˜æ–¹æ–‡æ¡£ä¸­è¢«æ˜ç¡®æåŠï¼š

> "AG UI translates from A2UI messages to AG UI messages, and handles transport and state sync automatically."
> 
> â€” [A2UI Transports æ–‡æ¡£](A2UI/docs/transports.md)

### 5.2 AG-UI ä½œä¸º A2UI çš„ä¼ è¾“å±‚

åœ¨è¿™ç§æ¶æ„ä¸‹ï¼š

*   **A2UI** è´Ÿè´£ï¼šUI ç»“æ„å®šä¹‰ã€ç»„ä»¶è§„èŒƒã€æ•°æ®æ¨¡å‹
*   **AG-UI** è´Ÿè´£ï¼šæ¶ˆæ¯ä¼ è¾“ã€çŠ¶æ€åŒæ­¥ã€äº‹ä»¶è·¯ç”±

flowchart TB subgraph Frontend\["ğŸ–¥ï¸ Frontend"\] Client\["AG-UI Client\\n(Events)"\] --> A2UIMsg\["A2UI Messages\\n(JSON)"\] A2UIMsg --> Renderer\["A2UI Renderer\\n(Components)"\] end subgraph Transport\["ğŸ“¡ Transport"\] Client <-.->|"SSE Events"| Server end subgraph Agent\["ğŸ¤– Agent"\] Server\["AG-UI Server\\n(SSE Stream)"\] --> Generator\["A2UI Generator\\n(JSONL)"\] Generator --> LLM\["LLM / Tools"\] end style Frontend fill:#e3f2fd style Transport fill:#fff3e0 style Agent fill:#f3e5f5

### 5.3 å®ç°æ–¹å¼ï¼šå°† A2UI æ¶ˆæ¯åŒ…è£…ä¸º AG-UI äº‹ä»¶

    // ä¼ªä»£ç ï¼šAG-UI + A2UI é›†æˆ
    
    // 1. Agent ç”Ÿæˆ A2UI æ¶ˆæ¯
    const a2uiMessages = generateA2UIComponents(restaurants);
    
    // 2. åŒ…è£…ä¸º AG-UI çš„ CUSTOM æˆ– ACTIVITY_SNAPSHOT äº‹ä»¶
    for (const msg of a2uiMessages) {
      yield {
        type: EventType.ACTIVITY_SNAPSHOT,
        messageId: `a2ui-${Date.now()}`,
        activityType: "a2ui",  // æ ‡è®°ä¸º A2UI æ¶ˆæ¯
        content: msg,          // A2UI åŸå§‹æ¶ˆæ¯
      };
    }
    
    // 3. å‰ç«¯æ ¹æ® activityType è·¯ç”±åˆ° A2UI æ¸²æŸ“å™¨
    agent.subscribe({
      onActivitySnapshot: (event) => {
        if (event.activityType === "a2ui") {
          a2uiRenderer.processMessage(event.content);
        }
      }
    });
    

### 5.4 AG-UI + MCP-UI çš„ç»„åˆ

AG-UI å®˜æ–¹æä¾›äº† `@ag-ui/mcp-apps-middleware`ï¼Œå¯ä»¥å°† MCP-UI çš„ UI èµ„æºé›†æˆåˆ° AG-UI äº‹ä»¶æµä¸­ï¼š

    // æºç ä½ç½®ï¼šag-ui/middlewares/mcp-apps-middleware/README.md
    
    import { MCPAppsMiddleware } from "@ag-ui/mcp-apps-middleware";
    
    const agent = new YourAgent().use(
      new MCPAppsMiddleware({
        mcpServers: [
          { type: "http", url: "http://localhost:3001/mcp" }
        ],
      })
    );
    
    // ä¸­é—´ä»¶è‡ªåŠ¨ï¼š
    // 1. å‘ç° MCP Server çš„ UI-enabled Tools
    // 2. å°†å·¥å…·æ³¨å…¥ Agent çš„å·¥å…·åˆ—è¡¨
    // 3. æ‰§è¡Œå·¥å…·è°ƒç”¨å¹¶è·å– UIResource
    // 4. å‘å°„ ACTIVITY_SNAPSHOT äº‹ä»¶ï¼ˆactivityType: "mcp-apps"ï¼‰
    

### 5.5 ä¸‰åè®®èåˆæ¶æ„

åœ¨å¤æ‚åœºæ™¯ä¸‹ï¼Œä¸‰ç§åè®®å¯ä»¥åŒæ—¶ä½¿ç”¨ï¼š

flowchart TB subgraph Frontend\["ğŸ–¥ï¸ Frontend"\] subgraph Router\["AG-UI Event Router"\] TextR\["ğŸ“ Text/Tool\\nRenderer"\] A2UIR\["ğŸ“± A2UI Renderer\\n(a2ui type)"\] MCPR\["ğŸ”§ MCP-UI Renderer\\n(mcp-apps type)"\] end end Router <-.->|"SSE Events"| Server subgraph Agent\["ğŸ¤– Agent"\] subgraph ServerLayer\["AG-UI Server + Middlewares"\] LLMAdapter\["LLM Adapter"\] A2AMW\["A2A Middleware"\] MCPMW\["MCP-Apps Middleware"\] end LLMAdapter --> LLM\[("ğŸ§  LLM\\n(OpenAI)")\] A2AMW --> SubAgents\[("ğŸ¤ A2A Agents\\n(Sub-agents)")\] MCPMW --> MCPServers\[("ğŸ”Œ MCP Servers\\n(Tools+UI)")\] end style Frontend fill:#e3f2fd style Agent fill:#f3e5f5 style Router fill:#e8f5e9 style ServerLayer fill:#fff3e0

**å„åè®®èŒè´£**ï¼š

*   **AG-UI**ï¼šä½œä¸º"æ€»çº¿"ï¼Œè´Ÿè´£äº‹ä»¶è·¯ç”±å’ŒçŠ¶æ€åŒæ­¥
*   **A2UI**ï¼šè´Ÿè´£å¤æ‚çš„ã€è·¨å¹³å°çš„å£°æ˜å¼ UI
*   **MCP-UI**ï¼šè´Ÿè´£å·¥å…·çº§åˆ«çš„å¿«é€Ÿ UI æ‰©å±•

* * *

6\. æŠ€æœ¯é€‰å‹å†³ç­–æ¡†æ¶
------------

### 6.1 ç»´åº¦å¯¹æ¯”è¡¨

ç»´åº¦

AG-UI

A2UI

MCP-UI

**æ ¸å¿ƒç†å¿µ**

äº‹ä»¶é©±åŠ¨çš„çŠ¶æ€åŒæ­¥

å£°æ˜å¼ UI ç»„ä»¶è§„èŒƒ

MCP å·¥å…·çš„ UI æ‰©å±•

**UI æ§åˆ¶æƒ**

å‰ç«¯ä¸»å¯¼

åç«¯ä¸»å¯¼ï¼ˆç»“æ„ï¼‰

åç«¯ä¸»å¯¼ï¼ˆå†…å®¹ï¼‰

**å®‰å…¨æ¨¡å‹**

ä¾èµ–å‰ç«¯å®ç°

**æœ€é«˜**ï¼ˆç™½åå•ç»„ä»¶ï¼‰

ä¸­ç­‰ï¼ˆiframe æ²™ç®±ï¼‰

**è·¨å¹³å°èƒ½åŠ›**

å¼±ï¼ˆéœ€å„ç«¯é€‚é…ï¼‰

**æœ€å¼º**ï¼ˆæŠ½è±¡ç»„ä»¶ï¼‰

ä¸­ç­‰ï¼ˆWeb ä¼˜å…ˆï¼‰

**å®æ—¶æ€§**

**æœ€å¼º**ï¼ˆæµå¼äº‹ä»¶ï¼‰

ä¸­ç­‰ï¼ˆJSONL æµï¼‰

å¼±ï¼ˆRequest-Responseï¼‰

**å¼€å‘å¤æ‚åº¦**

å‰ç«¯å¤æ‚

æ¶æ„å¤æ‚

**æœ€ç®€å•**

**ç”Ÿæ€å…¼å®¹æ€§**

CopilotKit ç”Ÿæ€

Google ç”Ÿæ€

MCP ç”Ÿæ€

### 6.2 åœºæ™¯-åè®®åŒ¹é…æŒ‡å—

#### åœºæ™¯ Aï¼šä¼ä¸šçº§ Copilot ç³»ç»Ÿ

**éœ€æ±‚ç‰¹å¾**ï¼š

*   éœ€è¦ä¸ç°æœ‰å¤æ‚ä¸šåŠ¡ç³»ç»Ÿæ·±åº¦é›†æˆ
*   Agent éœ€è¦æ“ä½œç°æœ‰ UI çŠ¶æ€ï¼ˆå¦‚é«˜äº®è¡¨æ ¼è¡Œã€å¡«å†™è¡¨å•ï¼‰
*   éœ€è¦å®æ—¶å±•ç¤º Agent æ€è€ƒè¿‡ç¨‹

**æ¨èæ–¹æ¡ˆ**ï¼š**AG-UI ä¸ºä¸»**

    // AG-UI å¯ä»¥é©±åŠ¨ç°æœ‰ UI çŠ¶æ€
    agent.subscribe({
      onStateDelta: (event) => {
        // å¢é‡æ›´æ–°åº”ç”¨çŠ¶æ€
        applyJsonPatch(appState, event.delta);
      },
      onToolCallStart: (event) => {
        // é«˜äº®ç›¸å…³ UI åŒºåŸŸ
        highlightUIRegion(event.toolCallName);
      }
    });
    

#### åœºæ™¯ Bï¼šè·¨å¹³å°æ¶ˆè´¹çº§ App

**éœ€æ±‚ç‰¹å¾**ï¼š

*   åŒæ—¶æ”¯æŒ Webã€iOSã€Android
*   å¯¹å®‰å…¨æ€§è¦æ±‚æé«˜ï¼ˆé˜²æ­¢ XSSã€å¹»è§‰è¾“å‡ºï¼‰
*   éœ€è¦ç»Ÿä¸€çš„è®¾è®¡è¯­è¨€

**æ¨èæ–¹æ¡ˆ**ï¼š**A2UI ä¸ºä¸»**

    // A2UI ä¸€æ¬¡å®šä¹‰ï¼Œå¤šç«¯æ¸²æŸ“
    {
      "updateComponents": {
        "components": [
          {"id": "card", "component": {"Card": {...}}}
        ]
      }
    }
    
    // Web ç«¯ï¼šæ¸²æŸ“ä¸º <div class="card">
    // iOS ç«¯ï¼šæ¸²æŸ“ä¸º SwiftUI Card
    // Android ç«¯ï¼šæ¸²æŸ“ä¸º Compose Card
    

#### åœºæ™¯ Cï¼šå¼€å‘è€…å·¥å…· / IDE æ’ä»¶

**éœ€æ±‚ç‰¹å¾**ï¼š

*   éœ€è¦å¿«é€Ÿä¸ºç°æœ‰å·¥å…·æ·»åŠ  UI
*   å¸Œæœ›ç¬¬ä¸‰æ–¹å¼€å‘è€…èƒ½è´¡çŒ® UI æ’ä»¶
*   ä¸éœ€è¦å¤æ‚çš„è·¨å¹³å°æ”¯æŒ

**æ¨èæ–¹æ¡ˆ**ï¼š**MCP-UI ä¸ºä¸»**

    // MCP Server è¿”å› UI
    server.tool("show_code_diff", () => ({
      type: "ui_resource",
      resource: {
        uri: "ui://diff/viewer",
        mimeType: "text/html",
        text: generateDiffHTML(changes)
      }
    }));
    

#### åœºæ™¯ Dï¼šå¤æ‚å¤š Agent ç³»ç»Ÿ

**éœ€æ±‚ç‰¹å¾**ï¼š

*   å¤šä¸ª Agent åä½œ
*   æ—¢éœ€è¦å®æ—¶çŠ¶æ€åŒæ­¥ï¼Œåˆéœ€è¦ä¸°å¯Œ UI
*   éœ€è¦è°ƒç”¨å¤–éƒ¨ MCP å·¥å…·

**æ¨èæ–¹æ¡ˆ**ï¼š**AG-UI + A2UI + MCP-UI ç»„åˆ**

    const agent = new OrchestrationAgent()
      .use(new A2AMiddleware({ agentUrls: [...] }))    // è¿æ¥å­ Agent
      .use(new MCPAppsMiddleware({ mcpServers: [...] })) // è¿æ¥ MCP å·¥å…·
      .use(new A2UIMiddleware({ catalog: 'standard' })); // æ”¯æŒ A2UI æ¸²æŸ“
    

### 6.3 å†³ç­–æµç¨‹å›¾

flowchart TB Start(\["ğŸš€ å¼€å§‹é€‰å‹"\]) --> Q1{"æ˜¯å¦éœ€è¦<br/>è·¨å¹³å°åŸç”Ÿæ¸²æŸ“ï¼Ÿ"} Q1 -->|"âœ… Yes"| A2UI\["ğŸ“± A2UI ä¸ºä¸»<br/><i>ç»Ÿä¸€å®šä¹‰ï¼Œå¤šç«¯åŸç”Ÿ</i>"\] Q1 -->|"âŒ No"| Q2{"æ˜¯å¦éœ€è¦<br/>å®æ—¶çŠ¶æ€åŒæ­¥ï¼Ÿ"} Q2 -->|"âœ… Yes"| AGUI\["âš¡ AG-UI ä¸ºä¸»<br/><i>äº‹ä»¶é©±åŠ¨ï¼ŒçŠ¶æ€é€æ˜</i>"\] Q2 -->|"âŒ No"| Q3{"æ˜¯å¦å¤ç”¨<br/>MCP ç”Ÿæ€ï¼Ÿ"} Q3 -->|"âœ… Yes"| MCPUI\["ğŸ”§ MCP-UI ä¸ºä¸»<br/><i>å·¥å…·å³ UIï¼Œæ¸è¿›å¢å¼º</i>"\] Q3 -->|"âŒ No"| Custom\["ğŸ¨ è‡ªå®šä¹‰æ–¹æ¡ˆ<br/><i>æ ¹æ®éœ€æ±‚å®šåˆ¶</i>"\] subgraph Combinations\["ğŸ’¡ ç»„åˆæ–¹æ¡ˆ"\] AGUI --> Combo1\["AG-UI + A2UI<br/><i>äº‹ä»¶ä¼ è¾“ + å£°æ˜å¼UI</i>"\] AGUI --> Combo2\["AG-UI + MCP-UI<br/><i>äº‹ä»¶ä¼ è¾“ + å·¥å…·UI</i>"\] A2UI --> Combo1 end style Start fill:#e1f5fe style A2UI fill:#c8e6c9 style AGUI fill:#fff3e0 style MCPUI fill:#f3e5f5 style Custom fill:#ffecb3

* * *

7\. Demo é¡¹ç›®å®æˆ˜è§£æ
---------------

### 7.1 é¡¹ç›®ç»“æ„

`demo-agent-ui-protocols` é¡¹ç›®é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„"é¤å…æœç´¢"åœºæ™¯ï¼ŒåŒæ—¶æ¼”ç¤ºä¸‰ç§åè®®ï¼š

    demo-agent-ui-protocols/
    â”œâ”€â”€ apps/web/                 # Next.js å‰ç«¯
    â”‚   â””â”€â”€ src/app/
    â”‚       â”œâ”€â”€ ag-ui-demo/       # AG-UI æ¼”ç¤ºé¡µé¢
    â”‚       â”œâ”€â”€ a2ui-demo/        # A2UI æ¼”ç¤ºé¡µé¢
    â”‚       â””â”€â”€ mcp-ui-demo/      # MCP-UI æ¼”ç¤ºé¡µé¢
    â”‚
    â”œâ”€â”€ agents/
    â”‚   â”œâ”€â”€ ag-ui-agent/          # AG-UI Python Agent (port 8001)
    â”‚   â”œâ”€â”€ a2ui-agent/           # A2UI Python Agent (port 8002)
    â”‚   â””â”€â”€ mcp-ui-agent/         # MCP-UI Python Agent (port 8003)
    â”‚
    â””â”€â”€ packages/shared/          # å…±äº«ç±»å‹å®šä¹‰
    

### 7.2 åŒä¸€åœºæ™¯çš„ä¸‰ç§å®ç°å¯¹æ¯”

#### 7.2.1 ç”¨æˆ·è¾“å…¥

> "å¸®æˆ‘æ‰¾ä¸€å®¶åŒ—äº¬çš„å·èœé¦†"

#### 7.2.2 AG-UI å®ç°

    [SSE Stream]
    event: RUN_STARTED
    data: {"runId":"run_001","threadId":"thread_001"}
    
    event: TEXT_MESSAGE_START
    data: {"messageId":"msg_001","role":"assistant"}
    
    event: TEXT_MESSAGE_CONTENT
    data: {"messageId":"msg_001","delta":"å¥½çš„ï¼Œæˆ‘æ¥å¸®æ‚¨"}
    
    event: TEXT_MESSAGE_CONTENT
    data: {"messageId":"msg_001","delta":"æœç´¢åŒ—äº¬çš„å·èœé¦†..."}
    
    event: TOOL_CALL_START
    data: {"toolCallId":"call_001","toolCallName":"search_restaurants"}
    
    event: TOOL_CALL_ARGS
    data: {"toolCallId":"call_001","delta":"{\"cuisine\":\"å·èœ\",\"location\":\"åŒ—äº¬\"}"}
    
    event: TOOL_CALL_RESULT
    data: {"toolCallId":"call_001","result":"[{\"name\":\"å·åŠé¤å…\",...}]"}
    
    event: TEXT_MESSAGE_CONTENT
    data: {"messageId":"msg_001","delta":"ä¸ºæ‚¨æ‰¾åˆ°ä»¥ä¸‹é¤å…ï¼š"}
    
    event: RUN_FINISHED
    data: {"runId":"run_001"}
    

**å‰ç«¯æ•ˆæœ**ï¼šå®æ—¶å±•ç¤ºæ‰“å­—æ•ˆæœ + å·¥å…·è°ƒç”¨å¡ç‰‡

#### 7.2.3 A2UI å®ç°

    [JSONL Stream]
    {"createSurface":{"surfaceId":"results","catalogId":"standard"}}
    
    {"updateComponents":{"surfaceId":"results","components":[
      {"id":"root","component":{"Column":{"children":{"explicitList":["header","list"]}}}},
      {"id":"header","component":{"Text":{"text":{"literalString":"æ¨èé¤å…"},"usageHint":"h1"}}},
      {"id":"list","component":{"List":{"children":{"template":{"dataBinding":"/restaurants","componentId":"card-template"}}}}}
    ]}}
    
    {"updateDataModel":{"surfaceId":"results","path":"/restaurants","value":[
      {"name":"å·åŠé¤å…","rating":4.8,"price":"$$","image":"..."},
      {"name":"çœ‰å·ä¸œå¡","rating":4.5,"price":"$$$","image":"..."}
    ]}}
    

**å‰ç«¯æ•ˆæœ**ï¼šåŸç”Ÿç»„ä»¶æ¸²æŸ“çš„é¤å…å¡ç‰‡åˆ—è¡¨

#### 7.2.4 MCP-UI å®ç°

    // Request
    { "messages": [{ "role": "user", "content": "å¸®æˆ‘æ‰¾ä¸€å®¶åŒ—äº¬çš„å·èœé¦†" }] }
    
    // Response
    {
      "role": "assistant",
      "content": "å¥½çš„ï¼Œè¿™æ˜¯æœç´¢ç»“æœï¼š",
      "ui_resource": {
        "type": "resource",
        "resource": {
          "uri": "ui://restaurant/list",
          "mimeType": "text/html",
          "text": "<div class='restaurant-list'>..."
        }
      }
    }
    

**å‰ç«¯æ•ˆæœ**ï¼šiframe å†…åµŒçš„ HTML å¡ç‰‡

### 7.3 è¿è¡Œ Demo

    # 1. å…‹éš†é¡¹ç›®
    git clone https://github.com/MadLongTom/demo-agent-ui-protocols
    cd demo-agent-ui-protocols
    
    # 2. é…ç½®ç¯å¢ƒå˜é‡
    cp .env.example .env
    # ç¼–è¾‘ .env å¡«å…¥ OPENAI_API_KEY ç­‰
    
    # 3. å®‰è£…ä¾èµ–
    ./install.sh
    
    # 4. å¯åŠ¨æ‰€æœ‰æœåŠ¡
    ./run.sh
    
    # 5. è®¿é—® Demo
    # AG-UI:  http://localhost:3000/ag-ui-demo
    # A2UI:   http://localhost:3000/a2ui-demo
    # MCP-UI: http://localhost:3000/mcp-ui-demo
    

  
  

* * *

8\. æ€»ç»“ä¸å±•æœ›
---------

### 8.1 æ ¸å¿ƒè§‚ç‚¹å›é¡¾

1.  **AG-UI** æ˜¯"äº‹ä»¶æ€»çº¿"ï¼šå®ƒä¸å…³å¿ƒ UI é•¿ä»€ä¹ˆæ ·ï¼Œåªè´Ÿè´£æŠŠ Agent çš„çŠ¶æ€å˜åŒ–å¹¿æ’­å‡ºå»ã€‚é€‚åˆéœ€è¦**æ·±åº¦é›†æˆ**å’Œ**å®æ—¶åé¦ˆ**çš„åœºæ™¯ã€‚
    
2.  **A2UI** æ˜¯"UI å¥‘çº¦"ï¼šå®ƒå®šä¹‰äº†ä¸€å¥—æŠ½è±¡çš„ç»„ä»¶è¯­è¨€ï¼Œè®© Agent èƒ½å¤Ÿ"æè¿° UI æ„å›¾"è€Œä¸æ˜¯"ç”Ÿæˆ UI ä»£ç "ã€‚é€‚åˆ**è·¨å¹³å°**å’Œ**é«˜å®‰å…¨æ€§**åœºæ™¯ã€‚
    
3.  **MCP-UI** æ˜¯"UI æ’ä»¶"ï¼šå®ƒè®© MCP å·¥å…·èƒ½å¤Ÿç›´æ¥è¿”å›å¯è§†åŒ–ç»“æœï¼Œæ— éœ€ä¿®æ”¹å®¿ä¸»åº”ç”¨ã€‚é€‚åˆ**å¿«é€Ÿæ‰©å±•**å’Œ**æ’ä»¶ç”Ÿæ€**åœºæ™¯ã€‚
    
4.  **ç»„åˆä½¿ç”¨**æ˜¯æœ€ä½³å®è·µï¼šAG-UI å¯ä»¥ä½œä¸º A2UI çš„ä¼ è¾“å±‚ï¼ŒMCP-UI å¯ä»¥é€šè¿‡ä¸­é—´ä»¶é›†æˆåˆ° AG-UIã€‚
    

### 8.2 æœªæ¥å±•æœ›

è¶‹åŠ¿

é¢„æœŸå‘å±•

**åè®®èåˆ**

AG-UI å’Œ A2UI å¯èƒ½ä¼šè¿›ä¸€æ­¥æ•´åˆï¼Œå½¢æˆç»Ÿä¸€çš„ Agent-UI æ ‡å‡†

**è¯­éŸ³äº¤äº’**

å¤šæ¨¡æ€æ”¯æŒï¼ˆè¯­éŸ³è¾“å…¥ã€è¯­éŸ³è¾“å‡ºï¼‰å°†æˆä¸ºæ ‡é…

**è¾¹ç¼˜è®¡ç®—**

è½»é‡çº§åè®®æ”¯æŒè®¾å¤‡ç«¯ Agentï¼ˆæ‰‹æœºã€IoTï¼‰

**å®‰å…¨å¢å¼º**

æ›´å®Œå–„çš„æ²™ç®±éš”ç¦»ã€æƒé™æ§åˆ¶æœºåˆ¶

### 8.3 å‚è€ƒèµ„æº

åè®®

å®˜æ–¹ä»“åº“

æ–‡æ¡£

AG-UI

[github.com/ag-ui-protocol/ag-ui](https://github.com/ag-ui-protocol/ag-ui)

[docs.ag-ui.com](https://docs.ag-ui.com)

A2UI

[github.com/google/A2UI](https://github.com/google/A2UI)

[a2ui.org](https://a2ui.dev)

MCP-UI

[github.com/idosal/mcp-ui](https://github.com/idosal/mcp-ui)

\[mcpui.dev\]

* * *

_æœ¬æ–‡åŸºäº `demo-agent-ui-protocols` é¡¹ç›®æºç åˆ†æï¼Œå»ºè®®è¯»è€…ä¸‹è½½è¿è¡Œä½“éªŒã€‚å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿äº¤æµè®¨è®ºã€‚_

[https://github.com/MadLongTom/demo-agent-ui-protocols](https://github.com/MadLongTom/demo-agent-ui-protocols)

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š[MadLongTom](https://www.cnblogs.com/madtom/)ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/madtom/p/19452209](https://www.cnblogs.com/madtom/p/19452209)