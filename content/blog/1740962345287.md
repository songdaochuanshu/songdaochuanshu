---
layout: post
title: '使用cy7c68013调试mt9v011  ov7670 mt9v034 摄像头测试  icamera视频采集调试'
date: "2025-03-03T00:39:05Z"
---
使用cy7c68013调试mt9v011 ov7670 mt9v034 摄像头测试 icamera视频采集调试
-------------------------------------------------------

使用cy7c68013调试mt9v011  ov7670 摄像头测试  icamera视频采集调试

 采集底板选用cp601d，原理图参考icamera设计，使用cy7c68013a芯片设计，固件刷icamera-106.iic（106后的版本均兼容）

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302115906454-1036269594.jpg)

注意好管脚顺序

OE接地使能，

复位管脚接高电平，处于正常工作

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120121006-990229687.png)![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302115808153-1424635916.png)

编写配置文件

iic配置地址为0xba

0x1a, 0x00, 0xBA, // 42 0x5A // sensor slave id  
0x1a, 0x01, 0x00, // pwdn low  
0x1a, 0x02, 0x01, // wordwide <1:8 bit, else:16 bit>  
0x1a, 0x03, 0x01, // register address length 2byte  
0x1a, 0x04, 0x02, // register value length 1byte  
//0x1a, 0x05, 0x01, // reset pin(PC2)  
0x1a, 0x06, 0x01, // IFCLK polarity  
0x1a, 0x0D, 0x02, // IFCLK 24

0x22,0x09,0x005f,  
0x22,0x35,0x0313,  
0x22,0x01,0x000b,  
0x22,0x02,0x0012,  
0x22,0x05,0x0083,  
0x22,0x06,0x001c,  
0x22,0x20,0x1000,

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120217740-758216687.png)

参考芯片手册调整好配置文件，即可出图

视频显示

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120511939-1211756822.png)

调整rgb各个通道增益和曝光，可以让图像更柔和，亮度更合适。

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302120556922-947010668.png)

这就是所谓的白平衡和曝光调节，可以实时看效果

 调试ov7670

线序定义

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123223064-1718019401.png)

安装效果如下，两类摄像头设计的时候线序有所不同，所以装不同位置区分

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123201174-1959642346.jpg)

寄存器配置

0x12, 0x12, 0x80  
0x12, 0x11, 0x01  
0x12, 0x3a, 0x04  
0x12, 0x12, 0x01  
0x12, 0x17, 0x13  
0x12, 0x18, 0x01  
0x12, 0x32, 0xb6  
0x12, 0x19, 0x02  
0x12, 0x1a, 0x7a  
0x12, 0x03, 0x0a  
0x12, 0x0c, 0x00  
0x12, 0x3e, 0x00  
0x12, 0x70, 0x3a  
0x12, 0x71, 0x35  
0x12, 0x72, 0x11  
0x12, 0x73, 0xf0  
0x12, 0xa2, 0x02  
0x12, 0x7a, 0x29  
0x12, 0x7b, 0x04  
0x12, 0x7c, 0x19  
0x12, 0x7d, 0x30  
0x12, 0x7e, 0x56  
0x12, 0x7f, 0x65  
0x12, 0x80, 0x72  
0x12, 0x81, 0x7d  
0x12, 0x82, 0x86  
0x12, 0x83, 0x8c  
0x12, 0x84, 0x95  
0x12, 0x85, 0xa2  
0x12, 0x86, 0xac  
0x12, 0x87, 0xbe  
0x12, 0x88, 0xcf  
0x12, 0x89, 0xe1  
0x12, 0x13, 0xe0  
0x12, 0x00, 0x00  
0x12, 0x10, 0x00  
0x12, 0x0d, 0x40  
0x12, 0x14, 0x38  
0x12, 0xa5, 0x05  
0x12, 0xab, 0x07  
0x12, 0x24, 0x95  
0x12, 0x25, 0x33  
0x12, 0x26, 0xe3  
0x12, 0x9f, 0x72  
0x12, 0xa0, 0x62  
0x12, 0xa1, 0x0b  
0x12, 0xa6, 0xe5  
0x12, 0xa7, 0xe5  
0x12, 0xa8, 0xf0  
0x12, 0xa9, 0x90  
0x12, 0xaa, 0x94  
0x12, 0x13, 0xe5  
0x12, 0x0e, 0x61  
0x12, 0x0f, 0x4b  
0x12, 0x16, 0x02  
0x12, 0x21, 0x02  
0x12, 0x22, 0x91  
0x12, 0x29, 0x07  
0x12, 0x33, 0x0b  
0x12, 0x35, 0x33  
0x12, 0x37, 0x1c  
0x12, 0x38, 0x71  
0x12, 0x39, 0x3d  
0x12, 0x3c, 0x78  
0x12, 0x4d, 0x40  
0x12, 0x4e, 0x20  
0x12, 0x69, 0x55  
0x12, 0x6b, 0x4a  
0x12, 0x74, 0x19  
0x12, 0x8d, 0x4f  
0x12, 0x8e, 0x00  
0x12, 0x8f, 0x00  
0x12, 0x90, 0x00  
0x12, 0x91, 0x00  
0x12, 0x96, 0x00  
0x12, 0x9a, 0x80  
0x12, 0xb0, 0x8c  
0x12, 0xb1, 0x0c  
0x12, 0xb2, 0x0e  
0x12, 0xb3, 0x82  
0x12, 0xb8, 0x0a  
0x12, 0x43, 0x14  
0x12, 0x44, 0xf0  
0x12, 0x45, 0x34  
0x12, 0x46, 0x58  
0x12, 0x47, 0x28  
0x12, 0x48, 0x3a  
0x12, 0x59, 0x88  
0x12, 0x5a, 0x88  
0x12, 0x5b, 0x44  
0x12, 0x5c, 0x67  
0x12, 0x5d, 0x49  
0x12, 0x5e, 0x0e  
0x12, 0x6c, 0x0a  
0x12, 0x6d, 0x55  
0x12, 0x6e, 0x11  
0x12, 0x6f, 0x9f  
0x12, 0x6a, 0x40  
0x12, 0x01, 0x40  
0x12, 0x02, 0x40  
0x12, 0x13, 0xe7  
0x12, 0x4f, 0x78  
0x12, 0x50, 0x73  
0x12, 0x51, 0x05  
0x12, 0x52, 0x17  
0x12, 0x53, 0x69  
0x12, 0x54, 0x7f  
0x12, 0x58, 0x9e  
0x12, 0x41, 0x08  
0x12, 0x3f, 0x00  
0x12, 0x75, 0x05  
0x12, 0x76, 0x60  
0x12, 0x4c, 0x00  
0x12, 0x77, 0x02  
0x12, 0x3d, 0x08  
0x12, 0x4b, 0x09  
0x12, 0xc9, 0x60  
0x12, 0x41, 0x38  
0x12, 0x56, 0x40  
0x12, 0x62, 0x00  
0x12, 0x63, 0x00  
0x12, 0x64, 0x04  
0x12, 0x65, 0x00  
0x12, 0x66, 0x01  
0x12, 0x34, 0x11  
0x12, 0x3b, 0xba  
0x12, 0xa4, 0x88  
0x12, 0x96, 0x00  
0x12, 0x97, 0x30  
0x12, 0x98, 0x20  
0x12, 0x99, 0x20  
0x12, 0x9a, 0x84  
0x12, 0x9b, 0x29  
0x12, 0x9c, 0x03  
0x12, 0x9d, 0x99  
0x12, 0x9e, 0x7f  
0x12, 0x78, 0x04  
0x12, 0x79, 0x01  
0x12, 0xc8, 0xf0  
0x12, 0x79, 0x0f  
0x12, 0xc8, 0x20  
0x12, 0x79, 0x10  
0x12, 0xc8, 0x7e  
0x12, 0xc8, 0x20  
0x12, 0x79, 0x09  
0x12, 0xc8, 0x80  
0x12, 0x79, 0x02  
0x12, 0xc8, 0xc0  
0x12, 0x79, 0x03  
0x12, 0xc8, 0x40  
0x12, 0x79, 0x05  
0x12, 0xc8, 0x30  
0x12, 0x79, 0x26

拍照效果

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302123614445-811860058.png)

启用ov7670的内部自动增益，自动曝光，自动白平衡，采集效果显著比人为手工初步简单配置的效果会好，

配置测试mt9v034（管脚顺序与ov7670兼容）

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302124312466-162931284.jpg)

没有镜头，仍然不影响测试

配置寄存器

mt9v034\_VGA\_RAW  
mode=Video  
iface=Cypress  
format=Raw  
Type=RGGB  
imagesize=640x480  
afmode=CYPRESS\_IIC  
afsubmode=0  
simmian  
fPll=0  
nPClkInvert=0  
nRemoveFirst=0  
n2Cut= 0  
nSlaveID=0  
nSensorCtrl=0  
nBits=0  
nIICSpeed=0  
\[SENSOR\]  
; VENDOR 0x1a for configuration  
; VENDOR 0x1e for vcm  
; VENDOR 0x12 for 1 byte address and 1 byte data  
; VENDOR 0x22 for 1 byte address and 2 bytes data  
; VENDOR 0x32 for 2 bytes address and 1 byte data  
; VENDOR 0x42 for 2 bytes address and 2 bytes data  
; VENDOR 0x52 for 1 byte address and sequence datas  
; VENDOR 0x62 for 2 bytes address and sequence datas

0x1a, 0x00, 0x90, // 42 0x5A // sensor slave id  
0x1a, 0x01, 0x00, // pwdn low  
0x1a, 0x02, 0x01, // wordwide <1:8 bit, else:16 bit>  
0x1a, 0x03, 0x01, // register address length 2byte  
0x1a, 0x04, 0x02, // register value length 1byte  
//0x1a, 0x05, 0x01 // reset pin(PC2)  
0x1a, 0x06, 0x01, // IFCLK polarity

0x22,0x03,0x1e0,  
0x22,0x04,0x280,

  
0x1a, 0x0e, 0x01, // external clock

0x1a, 0x0f, 0x00, // sync

配置完成后，直接操控icamera上位机采集视频图像

![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302124425945-1670701657.png)

可以观测到，帧率达到62fps，图像正常，通过直方图看到摄像头的噪声非常低。

此致所有摄像头测试已经完毕

 ![](https://img2024.cnblogs.com/blog/724662/202503/724662-20250302125429774-1960318989.jpg)

下一期分享下，使用fpga驱动hdmi显示器

posted on 2025-03-02 12:09  [层层惊涛](https://www.cnblogs.com/ccjt)  阅读(31)  评论(0)  [编辑](https://i.cnblogs.com/EditPosts.aspx?postid=18745962)  [收藏](javascript:void\(0\))  [举报](javascript:void\(0\))