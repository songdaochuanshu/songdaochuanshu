---
layout: post
title: 'æ™ºèƒ½æŒ‡é’ˆ'
date: "2025-06-15T00:47:21Z"
---
æ™ºèƒ½æŒ‡é’ˆ
====

åœ¨ C++ ä¸­ï¼Œæ™ºèƒ½æŒ‡é’ˆï¼ˆsmart pointersï¼‰æ˜¯ç”¨äºç®¡ç†åŠ¨æ€åˆ†é…å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„ç±»æ¨¡æ¿ã€‚å®ƒä»¬æ—¨åœ¨å¸®åŠ©å¼€å‘è€…è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œé¿å…å¸¸è§çš„å†…å­˜æ³„æ¼é—®é¢˜ï¼Œå¹¶ç®€åŒ–èµ„æºç®¡ç†ã€‚C++ æ ‡å‡†åº“æä¾›äº†ä¸‰ç§ä¸»è¦ç±»å‹çš„æ™ºèƒ½æŒ‡é’ˆï¼š`std::unique_ptr`ã€`std::shared_ptr` å’Œ `std::weak_ptr`ã€‚æ¯ç§ç±»å‹éƒ½æœ‰å…¶ç‰¹å®šçš„åº”ç”¨åœºæ™¯ã€‚

æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨
=======

1.  **è‡ªåŠ¨å†…å­˜ç®¡ç†**ï¼šæ™ºèƒ½æŒ‡é’ˆèƒ½å¤Ÿè‡ªåŠ¨é‡Šæ”¾æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä»è€Œé¿å…äº†æ‰‹åŠ¨è°ƒç”¨ `delete` å¯èƒ½å¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚
2.  **æ‰€æœ‰æƒè¯­ä¹‰**ï¼š
    *   `std::unique_ptr` å®ç°ç‹¬å æ‰€æœ‰æƒï¼ˆexclusive ownershipï¼‰ï¼Œå³ä¸€ä¸ªå¯¹è±¡åªèƒ½ç”±ä¸€ä¸ª `std::unique_ptr` æ‰€æœ‰ã€‚
    *   `std::shared_ptr` æ”¯æŒå…±äº«æ‰€æœ‰æƒï¼ˆshared ownershipï¼‰ï¼Œå…è®¸å¤šä¸ª `std::shared_ptr` å…±åŒæ‹¥æœ‰åŒä¸€ä¸ªå¯¹è±¡ã€‚
    *   `std::weak_ptr` ç”¨äºè§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œå®ƒæä¾›äº†ä¸€ç§éæ‹¥æœ‰çš„å¼•ç”¨æ–¹å¼æ¥è§‚å¯Ÿ `std::shared_ptr` ç®¡ç†çš„å¯¹è±¡ã€‚

å¦‚ä½•ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ
========

1\. `std::unique_ptr`
---------------------

*   **ä½œç”¨**ï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘æŸä¸ªå¯¹è±¡ï¼Œå½“è¯¥ `std::unique_ptr` è¶…å‡ºä½œç”¨åŸŸæˆ–è¢«æ˜¾å¼åˆ é™¤æ—¶ï¼Œå…¶æ‰€ç®¡ç†çš„å¯¹è±¡ä¼šè¢«è‡ªåŠ¨é”€æ¯ã€‚
*   **ä½¿ç”¨ç¤ºä¾‹**ï¼š

    #include <iostream>
    #include <memory> // åŒ…å«æ™ºèƒ½æŒ‡é’ˆç›¸å…³çš„å¤´æ–‡ä»¶
    
    int main() {
        // åˆ›å»ºä¸€ä¸ª unique_ptr æŒ‡å‘ä¸€ä¸ªæ–°çš„ int å¯¹è±¡
        std::unique_ptr<int> smartPtr = std::make_unique<int>(10);
        
        if (smartPtr) {
            std::cout << "Value: " << *smartPtr << std::endl;
        }
    
        // ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ deleteï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾
        return 0;
    }
    

*   **è½¬ç§»æ‰€æœ‰æƒ**ï¼š

    auto anotherPtr = std::move(smartPtr); // å°†æ‰€æœ‰æƒä» smartPtr è½¬ç§»åˆ° anotherPtr
    // æ­¤æ—¶ smartPtr å·²ç»ä¸å†æ‹¥æœ‰ä»»ä½•å¯¹è±¡ï¼ŒanotherPtr æ‹¥æœ‰åŸå§‹å¯¹è±¡
    

2\. `std::shared_ptr`
---------------------

*   **ä½œç”¨**ï¼šå…è®¸å¤šä¸ª `std::shared_ptr` åŒæ—¶æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åªæœ‰å½“æœ€åä¸€ä¸ª `std::shared_ptr` è¢«é”€æ¯æ—¶ï¼Œè¯¥å¯¹è±¡æ‰ä¼šè¢«é‡Šæ”¾ã€‚
*   **ä½¿ç”¨ç¤ºä¾‹**ï¼š

    #include <iostream>
    #include <memory>
    
    int main() {
        std::shared_ptr<int> sp1 = std::make_shared<int>(20);
        
        {
            std::shared_ptr<int> sp2 = sp1; // å¢åŠ å¼•ç”¨è®¡æ•°
            std::cout << "sp1 use count: " << sp1.use_count() << std::endl; // è¾“å‡º 2
        } // sp2 è¶…å‡ºä½œç”¨åŸŸï¼Œå¼•ç”¨è®¡æ•°å‡å°‘
    
        std::cout << "sp1 use count after sp2 is destroyed: " << sp1.use_count() << std::endl; // è¾“å‡º 1
        
        return 0;
    }
    

3\. `std::weak_ptr`
-------------------

### ä¸»è¦ä½œç”¨ï¼š

### 1\. **è§£å†³å¾ªç¯å¼•ç”¨ï¼ˆreference cycleï¼‰é—®é¢˜**

å½“ä¸¤ä¸ªæˆ–å¤šä¸ª `shared_ptr` ç›¸äº’å¼•ç”¨æ—¶ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå› ä¸ºå¼•ç”¨è®¡æ•°æ°¸è¿œä¸ä¸º0ï¼‰ã€‚ç”¨ `weak_ptr` æ‰“ç ´è¿™ç§å¾ªç¯å¼•ç”¨æ˜¯å®ƒæœ€ä¸»è¦çš„ç”¨é€”ã€‚

    struct B;
    struct A {
        std::shared_ptr<B> b_ptr;
    };
    struct B {
        std::weak_ptr<A> a_ptr;  // ç”¨ weak_ptr é¿å…å¾ªç¯å¼•ç”¨
    };
    

### 2\. **ä¸´æ—¶è®¿é—®å…±äº«èµ„æºï¼Œä¸å»¶é•¿èµ„æºç”Ÿå‘½å‘¨æœŸ**

æœ‰æ—¶ä½ å¸Œæœ›è®¿é—®æŸä¸ªèµ„æºï¼Œä½†ä¸å¸Œæœ›å› ä¸ºä½ è®¿é—®å®ƒå°±å»¶é•¿å®ƒçš„ç”Ÿå‘½ï¼Œè¿™æ—¶å€™å°±ç”¨ `weak_ptr`ã€‚

    std::shared_ptr<int> sp = std::make_shared<int>(42);
    std::weak_ptr<int> wp = sp; // ä¸å¢åŠ å¼•ç”¨è®¡æ•°
    
    if (auto spt = wp.lock()) {  // lock() è¿”å› shared_ptrï¼Œå¦‚æœèµ„æºå·²é‡Šæ”¾åˆ™è¿”å›ç©ºæŒ‡é’ˆ
        std::cout << *spt << '\n';
    } else {
        std::cout << "èµ„æºå·²ç»è¢«é‡Šæ”¾\n";
    }
    

`weak_ptr` å’Œ `shared_ptr`å…³ç³»
---------------------------

`weak_ptr` å’Œ `shared_ptr` æ˜¯ C++ æ™ºèƒ½æŒ‡é’ˆåº“ä¸­çš„ä¸¤ä¸ªç´§å¯†ç›¸å…³çš„ç±»å‹ï¼Œå®ƒä»¬çš„å…³ç³»å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥ç†è§£ï¼š

1.  ### **`weak_ptr` æ˜¯å¯¹ `shared_ptr` çš„ä¸€ç§â€œéæ‹¥æœ‰â€å¼•ç”¨**
    

*   `shared_ptr` ç®¡ç†èµ„æºçš„**ç”Ÿå‘½å‘¨æœŸ**ï¼Œå¹¶ç»´æŠ¤**å¼•ç”¨è®¡æ•°ï¼ˆuse\_countï¼‰**ã€‚
*   `weak_ptr` è§‚å¯Ÿç”± `shared_ptr` ç®¡ç†çš„èµ„æºï¼Œä½†**ä¸å‚ä¸å¼•ç”¨è®¡æ•°**ï¼Œä¹Ÿä¸ä¼šå½±å“èµ„æºçš„é‡Šæ”¾æ—¶é—´ã€‚

    std::shared_ptr<int> sp = std::make_shared<int>(10);
    std::weak_ptr<int> wp = sp;  // wp ä¸å¢åŠ å¼•ç”¨è®¡æ•°
    

* * *

### 2\. **`weak_ptr` å¯ä»¥ä» `shared_ptr` æ„é€ è€Œæ¥ï¼Œåä¹‹ä¸èƒ½ç›´æ¥æ„é€ **

*   âœ… ä» `shared_ptr` åˆ›å»º `weak_ptr`ï¼ˆä¸ä¼šå¢åŠ å¼•ç”¨è®¡æ•°ï¼‰ï¼š

    std::shared_ptr<MyClass> sp = std::make_shared<MyClass>();
    std::weak_ptr<MyClass> wp = sp;
    

*   âŒ ä¸èƒ½ç›´æ¥ä» `weak_ptr` è·å¾—è£¸æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œéœ€è¦å…ˆè°ƒç”¨ `.lock()` è·å– `shared_ptr`ï¼š

    if (auto spt = wp.lock()) {
        // ä½¿ç”¨ spt è®¿é—®å¯¹è±¡
    }
    

* * *

### 3\. **å…±äº«ç›¸åŒçš„å¼•ç”¨æ§åˆ¶å—ï¼ˆcontrol blockï¼‰**

*   `shared_ptr` å’Œç”±å®ƒç”Ÿæˆçš„ `weak_ptr` éƒ½å…±äº«åŒä¸€ä¸ªæ§åˆ¶å—ã€‚
    *   æ§åˆ¶å—ä¸­åŒ…å«ï¼š
        *   `use_count`ï¼šå½“å‰æœ‰å¤šå°‘ä¸ª `shared_ptr` æ‹¥æœ‰èµ„æºã€‚
        *   `weak_count`ï¼šå½“å‰æœ‰å¤šå°‘ä¸ª `weak_ptr` å¼•ç”¨æ§åˆ¶å—ã€‚
*   å½“ `use_count == 0` æ—¶ï¼Œèµ„æºè¢«é‡Šæ”¾ï¼›
*   å½“ `use_count == 0 && weak_count == 0` æ—¶ï¼Œæ§åˆ¶å—æœ¬èº«ä¹Ÿè¢«é”€æ¯ã€‚

* * *

### 4\. **å…¸å‹åº”ç”¨åœºæ™¯ï¼šè§£å†³å¾ªç¯å¼•ç”¨**

åœ¨ä¸¤ä¸ªç±»ç›¸äº’å¼•ç”¨æ—¶ï¼Œå¦‚æœéƒ½ç”¨ `shared_ptr`ï¼Œå°±å¯èƒ½å‘ç”Ÿèµ„æºæ— æ³•é‡Šæ”¾çš„é—®é¢˜ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰ã€‚è¿™æ—¶ï¼Œåº”è¯¥è®©å…¶ä¸­ä¸€æ–¹ä½¿ç”¨ `weak_ptr`ã€‚

    struct Node {
        std::shared_ptr<Node> next;
        std::weak_ptr<Node> prev;  // é˜²æ­¢å¾ªç¯å¼•ç”¨
    };
    

* * *

### æ€»ç»“ä¸€å¥è¯ï¼š

> `shared_ptr` æ˜¯èµ„æºçš„â€œæ‰€æœ‰è€…â€ï¼Œ`weak_ptr` æ˜¯èµ„æºçš„â€œæ—è§‚è€…â€ï¼›`weak_ptr` ä¾èµ– `shared_ptr` å­˜åœ¨ï¼Œä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚

* * *

å¦‚æœä½ å¸Œæœ›ä¸€ä¸ªå¯¹è±¡å…±äº«èµ„æº â†’ ç”¨ `shared_ptr`ï¼› å¦‚æœä½ å¸Œæœ›è®¿é—®ä½†ä¸æ‹¥æœ‰èµ„æºï¼ˆé¿å…å¾ªç¯å¼•ç”¨æˆ–å»¶é•¿ç”Ÿå‘½å‘¨æœŸï¼‰â†’ ç”¨ `weak_ptr`ã€‚

### ä½¿ç”¨ weak\_ptr çš„å‡ ä¸ªå…³é”®ç‚¹ï¼š

ç‰¹æ€§

è¯´æ˜

`weak_ptr<T>`

ä¸æ‹¥æœ‰èµ„æºï¼Œä¸å¢åŠ å¼•ç”¨è®¡æ•°

`.lock()`

å°è¯•è·å–èµ„æºçš„ `shared_ptr`ï¼Œå¯èƒ½ä¸ºç©º

`.expired()`

åˆ¤æ–­èµ„æºæ˜¯å¦å·²ç»è¢«é”€æ¯

`.use_count()`

è¿”å›å½“å‰èµ„æºè¢«å¤šå°‘ä¸ª `shared_ptr` æ‹¥æœ‰

æ™ºèƒ½æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸ
=========

**`shared_ptr`ã€`weak_ptr` å’Œ `unique_ptr` è¿™äº›æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æœ¬èº«åœ¨ç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šç«‹åˆ»è¢«ææ„ã€‚**æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æœ¬èº«ï¼ˆ`shared_ptr`ã€`weak_ptr`ã€`unique_ptr`ï¼‰åœ¨ç¦»å¼€ä½œç”¨åŸŸæ—¶éƒ½ä¼š**ç«‹åˆ»ææ„**ï¼›æ˜¯å¦é‡Šæ”¾èµ„æºï¼Œå–å†³äºå®ƒæ˜¯å¦æ‹¥æœ‰èµ„æºï¼Œä»¥åŠèµ„æºçš„å¼•ç”¨è®¡æ•°æ˜¯å¦å½’é›¶ã€‚

* * *

å…³é”®ç‚¹æ€»ç»“ï¼š
------

æ™ºèƒ½æŒ‡é’ˆç±»å‹

æŒ‡é’ˆå¯¹è±¡ï¼ˆè‡ªèº«ï¼‰ç¦»å¼€ä½œç”¨åŸŸæ˜¯å¦ç«‹åˆ»ææ„ï¼Ÿ

èµ„æºæ˜¯å¦ä¸€å®šè¢«é‡Šæ”¾ï¼Ÿ

`unique_ptr`

âœ… æ˜¯ï¼Œç«‹åˆ»ææ„

âœ… æ˜¯ï¼Œç«‹å³é‡Šæ”¾èµ„æº

`shared_ptr`

âœ… æ˜¯ï¼Œç«‹åˆ»ææ„

âš ï¸ ä»…å½“å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶é‡Šæ”¾èµ„æº

`weak_ptr`

âœ… æ˜¯ï¼Œç«‹åˆ»ææ„

âŒ å¦ï¼Œä¸å½±å“èµ„æºæ˜¯å¦é‡Šæ”¾ï¼ˆä¸æ‹¥æœ‰èµ„æºï¼‰

### ğŸ”¹ `unique_ptr`

*   **æ‹¥æœ‰å”¯ä¸€èµ„æº**ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼š
    *   æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æœ¬èº«è¢«ææ„ âœ…
    *   æ‰€ç®¡ç†çš„èµ„æºä¹Ÿç«‹å³ `delete` âœ…

    {
        std::unique_ptr<int> up = std::make_unique<int>(10);
    } // up è¢«é”€æ¯ï¼Œå¯¹è±¡ç«‹å³é‡Šæ”¾
    

* * *

### ğŸ”¹ `shared_ptr`

*   **æ‹¥æœ‰å…±äº«èµ„æº**ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼š
    *   æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æœ¬èº«ææ„ âœ…
    *   èµ„æºåªæœ‰åœ¨æ‰€æœ‰ `shared_ptr` éƒ½é”€æ¯ï¼ˆå¼•ç”¨è®¡æ•° = 0ï¼‰æ—¶æ‰è¢«é‡Šæ”¾ âš ï¸

    {
        std::shared_ptr<int> sp1 = std::make_shared<int>(20);
        {
            std::shared_ptr<int> sp2 = sp1; // use_count = 2
        } // sp2 ææ„ï¼Œä½†èµ„æºè¿˜æ²¡é‡Šæ”¾
    } // sp1 ææ„ï¼Œuse_count = 0ï¼Œèµ„æºé‡Šæ”¾
    

* * *

### ğŸ”¹ `weak_ptr`

*   **ä¸æ‹¥æœ‰èµ„æº**ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼š
    *   `weak_ptr` å¯¹è±¡ç«‹åˆ»ææ„ âœ…
    *   å®ƒè§‚å¯Ÿçš„èµ„æºä¸ä¼šå—å½±å“ âŒ

    {
        std::weak_ptr<int> wp;
        {
            std::shared_ptr<int> sp = std::make_shared<int>(30);
            wp = sp;
        } // sp ææ„ï¼Œèµ„æºé‡Šæ”¾
    } // wp ææ„ï¼Œä½†æ²¡å½±å“èµ„æºé‡Šæ”¾æ—¶æœº
    

ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ C++ ç¤ºä¾‹ç¨‹åºï¼Œ**æ¸…æ™°æ¼”ç¤ºäº† `shared_ptr`ã€`weak_ptr` å’Œ `unique_ptr` åœ¨ä½•æ—¶è¢«é”€æ¯**ï¼ˆå¯¹è±¡ææ„ï¼‰ã€‚

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç®€å•çš„ç±»ï¼Œæ‰“å°æ„é€ ä¸ææ„ï¼Œä»¥ä¾¿è§‚å¯ŸæŒ‡é’ˆä½•æ—¶é‡Šæ”¾èµ„æºï¼š

* * *

### âœ… ç¤ºä¾‹ä»£ç ï¼ˆå«æ³¨é‡Šï¼‰ï¼š

    #include <iostream>
    #include <memory>
    
    class MyClass {
    public:
        MyClass(int val) : value(val) {
            std::cout << "MyClass(" << value << ") constructed.\n";
        }
        ~MyClass() {
            std::cout << "MyClass(" << value << ") destructed.\n";
        }
    
    private:
        int value;
    };
    
    void demo_shared_ptr() {
        std::cout << "\n[shared_ptr demo]\n";
        std::shared_ptr<MyClass> sp1 = std::make_shared<MyClass>(1);
        {
            std::shared_ptr<MyClass> sp2 = sp1;
            std::cout << "shared_ptr use_count: " << sp1.use_count() << "\n";
        } // sp2 ç¦»å¼€ä½œç”¨åŸŸï¼Œuse_count å‡ 1
        std::cout << "shared_ptr use_count: " << sp1.use_count() << "\n";
    } // sp1 ç¦»å¼€ä½œç”¨åŸŸï¼Œå¯¹è±¡ææ„
    
    void demo_weak_ptr() {
        std::cout << "\n[weak_ptr demo]\n";
        std::weak_ptr<MyClass> wp;
        {
            std::shared_ptr<MyClass> sp = std::make_shared<MyClass>(2);
            wp = sp;
            std::cout << "Inside scope, expired? " << std::boolalpha << wp.expired() << "\n";
        } // sp è¢«é”€æ¯ï¼Œèµ„æºè¢«é‡Šæ”¾
        std::cout << "Outside scope, expired? " << std::boolalpha << wp.expired() << "\n";
        if (auto locked = wp.lock()) {
            std::cout << "locked shared_ptr is valid\n";
        } else {
            std::cout << "locked shared_ptr is null\n";
        }
    }
    
    void demo_unique_ptr() {
        std::cout << "\n[unique_ptr demo]\n";;
    
        std::unique_ptr<MyClass> up1 = std::make_unique<MyClass>(3);
        std::cout << "up1 owns the resource\n";
    
        // std::unique_ptr<MyClass> up2 = up1; // âŒ é”™è¯¯ï¼šä¸èƒ½æ‹·è´
        std::unique_ptr<MyClass> up2 = std::move(up1); // âœ… ç§»åŠ¨æ‰€æœ‰æƒ
    
        if (!up1) {
            std::cout << "up1 is now null after move\n";
        }
        if (up2) {
            std::cout << "up2 owns the resource after move\n";
        }
    
        // ç”¨ reset() é‡Šæ”¾å½“å‰å¯¹è±¡
        up2.reset();  // è°ƒç”¨ææ„å‡½æ•°ï¼Œé‡Šæ”¾ MyClass(3)
        std::cout << "up2.reset() called, resource released\n";
    
        // ç”¨ reset(new T) æ›¿æ¢ä¸ºæ–°çš„å¯¹è±¡
        up2.reset(new MyClass(4));
        std::cout << "up2 now owns a new object\n";
    
        // ç¦»å¼€ä½œç”¨åŸŸåï¼Œup2 è‡ªåŠ¨é‡Šæ”¾æ–°å¯¹è±¡ MyClass(4)
    }
    
    
    int main() {
        demo_shared_ptr();
        demo_weak_ptr();
        demo_unique_ptr();
        std::cout << "\n[Program End]\n";
        return 0;
    }
    
    

* * *

### ğŸ§¾ è¾“å‡ºç¤ºä¾‹ï¼ˆè¯´æ˜èµ„æºé‡Šæ”¾æ—¶æœºï¼‰ï¼š

    [shared_ptr demo]
    MyClass(1) constructed.
    shared_ptr use_count: 2
    shared_ptr use_count: 1
    MyClass(1) destructed.
    
    [weak_ptr demo]
    MyClass(2) constructed.
    Inside scope, expired? false
    MyClass(2) destructed.
    Outside scope, expired? true
    locked shared_ptr is null
    
    [unique_ptr demo with move and reset]
    MyClass(3) constructed.
    up1 owns the resource
    up1 is now null after move
    up2 owns the resource after move
    MyClass(3) destructed.
    up2.reset() called, resource released
    MyClass(4) constructed.
    up2 now owns a new object
    MyClass(4) destructed.
    
    [Program End]
    

* * *

æ€»ç»“
--

*   **`std::unique_ptr`**ï¼šé€‚ç”¨äºå•ä¸€æ‰€æœ‰æƒçš„æƒ…å†µï¼Œæ˜¯æœ€è½»é‡çº§çš„é€‰æ‹©ï¼Œæ€§èƒ½æœ€ä¼˜ã€‚
*   **`std::shared_ptr`**ï¼šé€‚ç”¨äºéœ€è¦å¤šä¸ªæŒ‡é’ˆå…±äº«åŒä¸€èµ„æºçš„åœºæ™¯ï¼Œä½†è¦æ³¨æ„æ½œåœ¨çš„æ€§èƒ½å¼€é”€å’Œå¾ªç¯å¼•ç”¨é—®é¢˜ã€‚
*   **`std::weak_ptr`**ï¼šé€šå¸¸ä¸ `std::shared_ptr` ç»“åˆä½¿ç”¨ï¼Œç”¨æ¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œæˆ–è€…ä»…ä½œä¸ºä¸´æ—¶å¼•ç”¨è€Œä¸å½±å“å¯¹è±¡ç”Ÿå‘½å‘¨æœŸã€‚

æœªç»ä½œè€…åŒæ„è¯·å‹¿è½¬è½½

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ä½œè€…ï¼š[aixueforever](https://www.cnblogs.com/aslanvon/)ï¼ŒåŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/aslanvon/p/18928233](https://www.cnblogs.com/aslanvon/p/18928233)