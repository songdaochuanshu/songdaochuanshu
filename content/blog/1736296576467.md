---
layout: post
title: 'manim边做边学--动画组合'
date: "2025-01-08T00:36:16Z"
---
manim边做边学--动画组合
===============

动画组合类的作用是将多个动画组合起来，以实现更复杂的动画效果。

`Manim`中有**4个**用于动画组合的类：

1.  `AnimationGroup`：将多个动画组合在一起同时播放，能一次性呈现多个对象的不同变化
2.  `LaggedStart`：按照添加顺序依次启动多个动画，每个动画间有延迟，使动画呈现出清晰的先后顺序
3.  `LaggedStartMap`：对一组对象应用相同动画，并按顺序逐个启动且有延迟，快速实现批量相似动画效果
4.  `Succession`：严格按照添加顺序依次播放多个动画，前一个完成后下一个才开始，确保动画按特定流程进行

1\. 动画概述
========

1.1. AnimationGroup
-------------------

当需要同时播放多个动画时，`AnimationGroup`非常有用。

例如，在一个场景中，需要同时移动多个图形、改变它们的颜色或执行其他操作。

`AnimationGroup`中包含的所有动画会同时开始和结束，可以通过设置`lag_ratio`参数来调整动画之间的延迟比例。

它的参数主要有：

**参数名称**

**类型**

**说明**

animations

\[Animation\]

要播放的动画对象序列

group

Group

包含多个Mobject的组

run\_time

float

动画持续时间

rate\_func

func

基于相对运行时间定义动画进度的函数

lag\_ratio

float

定义动画应用于子对象的延迟

参数`lag_ratio`默认为`0`，表示所有动画同时播放。

若`lag_ratio=0.5`，表示下一个动画将在前一个动画播放到 50% 时开始。

1.2. LaggedStart
----------------

当需要按顺序播放多个动画，但希望它们之间有一定的延迟时，`LaggedStart`是一个很好的选择。

例如，依次显示一系列的文本内容或逐个移动多个对象。

`LaggedStart`用于创建具有节奏感的动画序列，使观众能够清晰地看到每个动画的发生过程。

动画会按照它们被添加的顺序依次启动，每个动画之间有一定的延迟。

它的参数主要有：

**参数名称**

**类型**

**说明**

animations

\[Animation\]

要播放的动画对象序列

lag\_ratio

float

定义动画应用于子对象的延迟

run\_time

float

动画的持续时间

1.3. LaggedStartMap
-------------------

当需要对一组对象应用相同的动画，但希望它们之间有一定的延迟时，`LaggedStartMap`非常实用。

例如，逐个显示一组文本对象或逐个移动一组图形。

`LaggedStartMap`适用于处理大量相似对象的动画，通过简洁的方式实现逐个动画的延迟效果。

它的参数主要有：

**参数名称**

**类型**

**说明**

AnimationClass

func

要应用于mobject的动画类

mobject

Mobject

动画要应用到的Mobject

arg\_creator

func

要应用于Mobject的函数

run\_time

float

动画的持续时间

lag\_ratio

float

定义动画应用于子对象的延迟

1.4. Succession
---------------

当需要按顺序依次播放多个动画，且每个动画必须在前一个动画完成后才能开始时，`Succession`是首选。

例如，先移动一个对象，然后再对其进行旋转或缩放等操作。

`Succession`用于创建复杂的动画流程，确保动画按照特定的顺序执行，动画会按照它们被添加的顺序依次播放，前一个动画完成后，下一个动画才会开始。

它的参数主要有：

**参数名称**

**类型**

**说明**

animations

\[Animation\]

要播放的动画对象序列

lag\_ratio

float

定义动画应用于子对象的延迟

run\_time

float

动画的持续时间

2\. 使用示例
========

下面通过一些示例演示这4个动画组合类的使用。

2.1. 同时移动和变色多个图形
----------------

此示例中，展示了`AnimationGroup`并行处理多个动画的能力。

示例中同时启动圆形的移动动画和正方形的变色动画，让多个对象的不同动画效果同时呈现，且所有动画在同一时刻开始和结束。

    # 创建一个圆形和一个正方形
    c = Circle().shift(LEFT * 2)
    s = Square().shift(RIGHT * 2)
    
    # 定义圆形的移动动画和正方形的变色动画
    anim_circle = c.animate.shift(RIGHT * 4)
    anim_square = s.animate.set_color(RED)
    
    # 使用AnimationGroup同时播放这两个动画
    self.play(AnimationGroup(anim_circle, anim_square))
    

![](https://img2024.cnblogs.com/blog/83005/202501/83005-20250107143120262-1420434422.gif)

2.2. 逐个显示文本内容
-------------

在这个示例中，`LaggedStart`的特点是按照添加动画的顺序依次启动，每个动画之间根据`lag_ratio`（这里设置为 `0.3`）产生延迟。

动画中可以清晰地看到每个文本依次淡入，营造出一种有序的节奏感，适合用于展示一系列相关元素的逐个出现效果。

    # 创建三个文本对象
    text1 = Text("死去元知万事空").shift(UP * 2)
    text2 = Text("但悲不见九州同").next_to(
        text1, DOWN, buff=0.5
    )
    text3 = Text("王师北定中原日").next_to(
        text2, DOWN, buff=0.5
    )
    text4 = Text("家祭无忘告乃翁").next_to(
        text3, DOWN, buff=0.5
    )
    
    # 定义每个文本对象的淡入动画
    anim_text1 = FadeIn(text1)
    anim_text2 = FadeIn(text2)
    anim_text3 = FadeIn(text3)
    anim_text4 = FadeIn(text4)
    
    # 使用LaggedStart按顺序逐个启动动画，每个动画之间有一定延迟
    self.play(
        LaggedStart(
            anim_text1,
            anim_text2,
            anim_text3,
            anim_text4,
            lag_ratio=0.3,
        ),
        run_time=3,
    )
    

![](https://img2024.cnblogs.com/blog/83005/202501/83005-20250107143120250-1673644995.gif)

2.3. 逐个移动一组点并变色
---------------

此例中，`LaggedStartMap`的优势在于可以方便地对一组对象应用相同的动画操作，并且通过`lag_ratio`（设置为 `0.2`）实现逐个对象动画的延迟效果。

这使得一组点能够逐个向下移动并变色，展示了批量处理相似对象动画且控制延迟的能力，适用于处理多个相同类型元素的动画序列。

    # 创建一组点
    dots = VGroup(*[Dot() for _ in range(5)]).arrange_in_grid(
        rows=1, cols=5, buff=1
    )
    dots.shift(UP)
    
    # 定义一个动画函数，用于移动点并变色
    def move_and_color_dot(dot):
        return dot.animate.shift(DOWN * 2).set_color(YELLOW)
    
    # 使用LaggedStartMap对每个点应用动画函数，逐个启动动画且有延迟
    self.play(LaggedStartMap(move_and_color_dot, dots, lag_ratio=0.2))
    

![](https://img2024.cnblogs.com/blog/83005/202501/83005-20250107143120091-687004082.gif)

2.4. 先旋转后移动图形
-------------

在该示例中，Succession严格按照顺序依次执行动画。

先旋转五角星图形，然后向上下左右四个方向分别射出不同颜色的点。

    # 创建一个三角形
    star = Star()
    dot1 = Dot(color=RED)
    dot2 = Dot(color=GREEN)
    dot3 = Dot(color=YELLOW)
    dot4 = Dot(color=PURPLE)
    self.add(star, dot1, dot2, dot3, dot4)
    
    # 定义三角形的移动、旋转和缩放动画
    rotate_star = Rotate(star, angle=PI * 2)
    send_dot1 = dot1.animate.shift(UP * 2)
    send_dot2 = dot2.animate.shift(RIGHT * 2)
    send_dot3 = dot3.animate.shift(DOWN * 2)
    send_dot4 = dot4.animate.shift(LEFT * 2)
    
    # 使用Succession按顺序依次播放动画，前一个动画完成后下一个才开始
    self.play(
        Succession(
            rotate_star,
            send_dot1,
            send_dot2,
            send_dot3,
            send_dot4,
        ),
        run_time=3,
    )
    

![](https://img2024.cnblogs.com/blog/83005/202501/83005-20250107143120171-264265697.gif)

3\. 附件
======

文中的代码只是关键部分的截取，完整的代码共享在网盘中（`anim_group.py`），

下载地址: [完整代码](https://url11.ctfile.com/d/45455611-64223578-4fb7ee?p=6872) (访问密码: 6872)