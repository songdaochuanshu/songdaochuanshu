---
layout: post
title: '使用命令行删除 Windows 网络映射驱动器'
date: "2025-10-11T00:37:25Z"
---
使用命令行删除 Windows 网络映射驱动器
=======================

前言
--

不得不吐槽一下，Windows 的体验真是依托答辩

我从大学时就在喷 Windows 垃圾，没想到现在还这么烂🤣

* * *

最近升级了 NAS

之前这三个网络映射盘 (W:, X:, Y:) 是通过 SMB 映射到 TKL FileServer

现在迁移到 TrueNAS 了，得重新映射

但这几个右键菜单一直卡死

![](https://img2024.cnblogs.com/blog/866942/202510/866942-20251010224911407-6904031.png)

解决
--

Windows 资源管理器在右键菜单时会去请求这些共享的状态（容量、缩略图、上下文菜单扩展），如果 NAS 没响应或网络慢，就会卡死。

这时候可以通过命令行来实现删除

使用管理员权限打开 PowerShell

    net use
    

输出

    $ net use
    会记录新的网络连接。
    
    
    状态       本地        远程                      网络
    
    -------------------------------------------------------------------------------
    已断开连接   W:        \\192.168.10.201\ssd      Microsoft Windows Network
    已断开连接   X:        \\192.168.10.201\data     Microsoft Windows Network
    正在重新连接 Y:        \\192.168.10.201\pan      Microsoft Windows Network
    命令成功完成。
    

删除对应的网络驱动器

    net use X: /delete
    net use Y: /delete
    net use W: /delete
    

如果遇到提示 “该连接可能正被使用”，加上 `/y` 强制删除

    net use X: /delete /y
    

刷新资源管理器，就不会再出现了

![](https://img2024.cnblogs.com/blog/866942/202510/866942-20251010224921654-1626910740.png)

建议
--

我看论坛上说这个问题从 XP 时代就存在的

没想到 Windows10 还没修复🤣

建议是把网络驱动器映射放在文件夹里，避免卡顿

另外，Windows 还存在打开任务管理器卡顿的问题，我使用了系统完整性检查命令，之后有所改善

    sfc /scannow
    DISM /Online /Cleanup-Image /RestoreHealth
    

#### 1\. **sfc /scannow**

*   **SFC = System File Checker**
*   检查系统中的 **受保护文件** 是否被修改、损坏。
*   如果发现问题，会尝试用 **WinSxS 缓存里的副本** 来修复。
*   但前提是 WinSxS 自己是完好的。

#### 2\. **DISM /Online /Cleanup-Image /RestoreHealth**

*   **DISM = Deployment Image Servicing and Management**
*   作用更底层，主要修复的是 **WinSxS 组件存储**（系统的“备用零件仓库”）。
*   参数说明：
    *   `/Online` → 作用于当前正在运行的系统（不是离线镜像）。
    *   `/Cleanup-Image` → 针对系统映像执行清理或修复。
    *   `/RestoreHealth` → 检查并修复 WinSxS 里的损坏文件。
*   如果 WinSxS 本身坏了（导致 `sfc /scannow` 没法修），就需要用 DISM 先修 WinSxS。

参考
--

[https://fast.v2ex.com/t/1002754](https://fast.v2ex.com/t/1002754)

微信公众号：「程序设计实验室」 专注于互联网热门新技术探索与团队敏捷开发实践，包括架构设计、机器学习与数据分析算法、移动端开发、Linux、Web前后端开发等，欢迎一起探讨技术，分享学习实践经验。