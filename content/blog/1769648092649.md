---
layout: post
title: 'IDEA 里终于能爽用 Claude Code了！'
date: "2026-01-29T00:54:52Z"
---
IDEA 里终于能爽用 Claude Code了！
-------------------------

如果你是 JetBrains 家 IDE 的重度用户，大概率有过这样的体验：想用 Claude Code、Codex 这类终端 AI 工具时，只能在 Terminal 里跑着用。这些 CLI 工具虽强大，但缺少原生 UI 交互，体验上有些局限。虽然可以通过 [Claude Code UI 类开源项目](https://mp.weixin.qq.com/s/GYaq_HNo5mKh2WjWtuEMyg)来缓解，如 vibe kanban、1Code，但在写代码这件事上，没有什么比“在熟悉的 IDE 面板里直接对话”更爽了。

2025 年底，JetBrains 给 AI Assistant 插件更新了一个重磅功能：**支持自定义 ACP（Agent Client Protocol）配置**。这意味着你现在可以把任何支持 ACP 的 Agent 接入到 AI Assistant 里，包括 Claude Code。

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173144014-1258158068.png)

这篇文章 Guide 就来手把手带大家在 IDEA 里通过 ACP 爽用 Claude Code，希望能给喜欢 IDEA 的朋友提供一个不一样选择。

> **需要注意**：目前 ACP 还是 Beta 版，体验上可能存在一些小问题，Guide 在周末用了之后整体感觉还是很不错的。

ACP 是什么？
--------

ACP 全称 **Agent Client Protocol**，是一个开放协议，用来规范 AI Agent 与代码编辑器/IDE 之间的通信方式。它类似于 Language Server Protocol (LSP)，但专注于 AI 代理的集成，帮助开发者在不同编辑器中使用各种 AI 工具，而无需为每个组合构建自定义适配器。

简单理解，它就是一个让 AI Agent 和 IDE "即插即用"的通用接口——就像 USB-C 之于设备连接一样。

ACP 由 Zed Industries（Zed 编辑器的开发者）主导开发，与 Anthropic、Google 等合作，JetBrains 目前也加入了。

### 为什么需要 ACP？

在没有 ACP 之前，每个 AI Agent 想接入某个 IDE，都需要单独开发适配器。Claude Code 要写一套，Cursor 要写一套，Windsurf 也要写一套——重复造轮子，而且一旦 Agent 更新，适配器还得跟着改。

ACP 的核心思路是：**定义一套标准的通信协议，任何 Agent 只要实现了 ACP Server，任何 IDE 只要实现了 ACP Client，两者就能直接对接**。

关于 ACP 更详细的介绍，可以查看官方文档：**[https://agentclientprotocol.com/overview/introduction](https://agentclientprotocol.com/overview/introduction)** 。

### 生态现状

目前加入 ACP 生态的成员包括：

*   **IDE 端**：JetBrains 全家桶、Zed 等。
*   **Agent 端**：Claude Code、Codex、Gemini CLI、Kimi CLI、Qoder CLI 等。

就连 Docker 也在 2025 年 11 月 13 日宣布将其开源多代理运行时 cagent 内置到 Docker Desktop，并支持 Agent Client Protocol (ACP)，以实现 AI 代理与 IDE/编辑器（如 Zed、VS Code）的无缝集成。

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173143974-1842736266.png)

这意味着可以在容器化环境中运行 AI 代理，简化开发工作流，如代码生成、测试和重构，同时保持容器隔离性。

### 技术原理

ACP 底层基于 **JSON-RPC 2.0** 协议（与 LSP 完全相同），Agent 作为 Server 运行一个独立的进程，IDE 通过 stdin/stdout 与之通信。好处是 Agent 不需要被打包进 IDE 插件里，保持独立性和可维护性。

flowchart LR subgraph IDE\["IDE (ACP Client)"\] AIAI\["AI Assistant<br/>Plugin"\] end subgraph ACP\_Agent\["ACP Agent Process"\] ACPServer\["ACP Server<br/>JSON-RPC"\] LLM\["AI Backend<br/>(Claude/GPT/...)"\] Tools\["MCP Tools<br/>Filesystem/Git/..."\] end AIAI <-->|"stdin/stdout<br/>JSON-RPC"| ACPServer ACPServer --> LLM ACPServer --> Tools

前置条件
----

要在 IDEA 里用 ACP 接入 Claude Code，需要满足：

1.  **IDE 版本**：IntelliJ IDEA 2024.2 到 2025.3.x 或更高版本。ACP 支持从 2025 年底开始逐步集成，确保你的 IDEA 已更新到支持 ACP 的构建。
2.  **AI Assistant 插件**：确保已安装并启用
3.  **Claude Code**：已安装并能正常运行
4.  **claude-code-acp**：Zed 提供的 ACP 适配器（下文会讲如何安装）

你可以检查 AI Assistant 插件版本，在 `File > Settings > Plugins` 里搜索 "JetBrains AI Assistant"，确认版本号在 2025.12 之后。

配置 ACP
------

### 第一步：找到配置入口

打开 AI Assistant 的聊天面板，点击右上角选择下拉框，你会看到 **「配置 ACP 智能体」** 选项。

点击后，IDE 会自动打开一个 `acp.json` 配置文件。

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173144068-1933796045.png)

### 第二步：安装 claude-code-acp

Zed 官方提供了一个 ACP 适配器 `@zed-industries/claude-code-acp`，用来桥接 Claude Code 和 ACP 协议。

    pnpm install -g @zed-industries/claude-code-acp
    

注意必须用 `-g` 全局安装，这样 ACP Server 才能作为独立命令被调用。

安装完成后，你会在全局 bin 目录里看到 `claude-code-acp` 命令。

    ❯ pnpm bin -g
    /Users/guide/Library/pnpm
    ❯ ls /Users/guide/Library/pnpm
    claude-code-acp global          store
    

### 第三步：编辑 acp.json

在 `acp.json` 中添加 Claude Code 的配置：

      "agent_servers": {
        "Claude Code": {
          "command": "/Users/guide/Library/pnpm/claude-code-acp"
        }
      }
    

注意将路径替换为你本地的，或者将其添加到环境变量中。

保存文件后，回到 AI Assistant 的聊天面板，再次点击模型选择下拉框，你应该能看到 **Claude Code** 出现在列表里了。

爽用 Claude Code
--------------

### 基础对话

选择 Claude Code 作为 Agent 后，你就可以像用内置 Claude 一样进行对话：

*   代码编写
*   代码解释
*   Bug 诊断
*   重构建议
*   生成单元测试

这个周末，我就通过这种方式成功重构优化了 [《SpringAI 智能面试平台+RAG 知识库》](https://javaguide.cn/zhuanlan/interview-guide.html)这个项目：

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173144705-1193410820.png)

这个项目的配套实战项目教程正在更新，涉及到 Prompt Engineering、大模型集成、RAG（检索增强生成）、高性能对象存储与向量数据库。后续的话，还会同步上Agent 项目。

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173144039-1166943395.png)

内容非常全面，非常适合想要实战 AI 项目或者准备 AI 大模型应用开发岗位面试的朋友，来一张刚写完的**3.4w 字+35 道题目**的 RAG 面试题总结，大家感受一下（点此链接了解： [星球](https://javaguide.cn/about-the-author/zhishixingqiu-two-years.html)）：

### 模式和模型选择

Claude Code 的 ACP 模式会识别你原本配置的所有设置，包括：

1.  **模式选择**：Plan 模式、Code 模式等
2.  **模型选择**：claude-sonnet-4.5、claude-opus-4.5 等
3.  **第三方中转站**：如果你配置了自定义 API 地址，也会生效

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173144162-1887692308.png)

可以看到我这里目前就成功对接了第三方 GLM 模型，这个在国内也是用的人比较多的：

![](https://img2024.cnblogs.com/blog/1843652/202601/1843652-20260128173143924-878778054.png)

### MCP 工具支持

这是 ACP 方式相比内置 Agent 的最大优势——**完整支持 MCP（Model Context Protocol）工具**。

MCP 是 Anthropic 推出的另一个协议，用来让 LLM 接入外部工具和数据源。比如你可以配置：

*   **文件系统工具**：让 Agent 读写项目文件
*   **Git 工具**：让 Agent 执行 commit、diff 操作
*   **数据库工具**：让 Agent 查询生产环境数据
*   **自定义 API**：接入公司内部服务

用 ACP 接入 Claude Code 后，这些 MCP 工具都会被识别并可用。而 AI Assistant 内置的 Claude Agent 只能识别第三方 API 地址，MCP 工具是**不支持**的。

ACP vs 内置 Agent：如何选择？
---------------------

**特性**

**ACP (Claude Code + Adapter)**

**IDEA 内置 Claude Agent (官方/三方插件)**

**核心定位**

终端驱动的任务型机器人 (Task-Oriented)

侧边栏对话型助手 (Chat-Oriented)

**MCP 工具支持**

**✅ 完整原生支持** (可调用本地 Python/DB 等)

**❌ 支持有限** (多局限于 IDE 内部 API)

**模型灵活性**

**✅ 极高** (自由切换 3.5 Sonnet / 3.7 / Opus)

**⚠️ 受限** (通常绑定插件商提供的特定版本)

**API 兼容性**

**✅ 支持** 中转站 / OneAPI 等自定义 Endpoint

**⚠️ 部分支持** (官方插件常强制要求官方 Key)

**工作模式**

**✅ 拥有 Plan / Act 独立模式**

**❌ 主要是单轮或多轮对话**

**环境上下文**

**✅ 强** (通过 MCP 直接读取系统/库文档)

**✅ 强** (深度集成 IDE 索引，理解代码库)

**配置门槛**

**较高** (需要配置 Node 环境及 Proxy)

**极低** (插件市场一键安装)

**建议**：

*   如果你**需要 MCP 工具**，必须用 ACP 方式
*   如果你**习惯 Claude Code 的 Plan 模式**，用 ACP 更顺手
*   如果你**想要开箱即用**，内置 Agent 更省心

接入其他 Agent
----------

除了 Claude Code，你也可以接入其他支持 ACP 的 Agent。比如 Gemini CLI (Google) 、 Cagent (Docker)：

    {
      "agent_servers": {
        "Claude Code": {
          "command": "/Users/guide/Library/pnpm/claude-code-acp"
        },
        "Gemini CLI": {
          "command": "gemini-acp",
          "args": ["--model", "gemini-2.0-pro"]
        },
        "Docker Cagent": {
          "command": "cagent",
          "args": ["acp", "agent.yml"]
        }
      }
    }
    

踩坑与排查
-----

### ACP 初始化失败

JetBrains AI Assistant 无法运行 "pnpm" 命令（`IOException: Cannot run program "pnpm", error=2, No such file or directory`）。

    ❯ pnpm bin -g
    /Users/guide/Library/pnpm
    ❯ ls /Users/guide/Library/pnpm
    claude-code-acp global
    

注意将 command 路径替换为你本地的，或者将其添加到环境变量中。

### Agent 无响应

如果选择 Agent 后聊天没反应：

1.  检查 Agent 进程是否启动：`ps aux | grep claude-code-acp`
2.  查看 AI Assistant 的日志：`Help > Show Log in Finder`
3.  确认 Claude Code 本身能正常在终端运行

总结
--

ACP 目前还处于快速发展阶段，2025 年底才正式进入 Beta。有几个值得期待的方向：

1.  **更多 Agent 支持**：Cursor、Windsurf 等热门 AI 工具可能会推出 ACP Server
2.  **Per-Project 配置**：JetBrains 的 Issue 追踪显示，他们正在计划支持项目级别的 ACP 配置
3.  **社区生态**：随着协议开放，可能会出现更多第三方 Agent

如果你是 JetBrains IDE 的重度用户，又不太喜欢在终端环境使用 Claude Code ，或者你需要 MCP 工具的强大能力，那么 ACP 就是目前的终极解决方案。

虽然配置稍微麻烦一点，但一旦搞定，你就能在熟悉的 IDE 环境里获得：

*   稳定的 UI 体验
*   完整的 Claude Code 功能
*   MCP 工具的加持

posted on 2026-01-28 17:32  [JavaGuide](https://www.cnblogs.com/javaguide)  阅读(174)  评论(1)    [收藏](javascript:void\(0\))  [举报](javascript:void\(0\))