---
layout: post
title: 'Flaskæ ¸å¿ƒæŠ€èƒ½ï¼šä»é›¶ä¸Šæ‰‹è§†å›¾å‡½æ•°'
date: "2025-12-10T00:44:43Z"
---
Flaskæ ¸å¿ƒæŠ€èƒ½ï¼šä»é›¶ä¸Šæ‰‹è§†å›¾å‡½æ•°
==================

æœ¬æ–‡ç³»ç»Ÿä»‹ç»äº†Flaskæ¡†æ¶ä¸­è§†å›¾å‡½æ•°çš„å®šä¹‰ä¸æ ¸å¿ƒæ“ä½œã€‚è¯¦ç»†è®²è§£äº†å¦‚ä½•ä½¿ç”¨è£…é¥°å™¨ç»‘å®šè·¯ç”±ã€é€šè¿‡requestå¯¹è±¡å¤„ç†GET/POSTè¯·æ±‚æ•°æ®ã€åˆ©ç”¨jsonifyå’Œrender\_templateç­‰è¿”å›å¤šæ ·åŒ–å“åº”ã€‚æ–‡ç« è¿˜æ¶µç›–äº†è‡ªå®šä¹‰é”™è¯¯å¤„ç†é¡µé¢ã€å¸¸ç”¨HTTPçŠ¶æ€ç çš„è®¾ç½®æ–¹æ³•ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ•´åˆäº†æ‰€æœ‰å…³é”®åŠŸèƒ½çš„å®Œæ•´Flaskåº”ç”¨ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€ŸæŒæ¡è§†å›¾å‡½æ•°çš„å®ç”¨æŠ€èƒ½ã€‚

æƒ³å¿«é€Ÿä¸Šæ‰‹Flaskï¼Œå´è¢«è§†å›¾å‡½æ•°ç»•æ™•äº†å¤´ï¼Ÿ è¦çŸ¥é“ï¼Œ**è¶…è¿‡80%çš„Flaskæ ¸å¿ƒé€»è¾‘éƒ½ç¼–å†™åœ¨è§†å›¾å‡½æ•°é‡Œ**ï¼ŒæŒæ¡å®ƒï¼Œä½ å°±æ‹¿ä¸‹äº†Flaskå¼€å‘çš„åŠå£æ±Ÿå±±ï¼

> æœ¬æ–‡ä¸ºä½ æ¸…æ™°æ‹†è§£Flaskè§†å›¾å‡½æ•°çš„æ–¹æ–¹é¢é¢ï¼šä»åŸºæœ¬å®šä¹‰ã€è¯·æ±‚æ•°æ®è·å–ã€å“åº”è¿”å›åˆ°é”™è¯¯å¤„ç†ä¸çŠ¶æ€ç è®¾ç½®ã€‚ä½ å°†å­¦åˆ°å¦‚ä½•è®©è§†å›¾å‡½æ•°æ—¢å¥å£®åˆå¥½ç”¨ï¼Œå¹¶é™„ä¸Šä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„å®Œæ•´ç¤ºä¾‹ã€‚

ğŸš€ ç›®å½•ä¸€è§ˆ
-------

\- è§†å›¾å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ  
\- å¦‚ä½•å®šä¹‰ä¸€ä¸ªè§†å›¾å‡½æ•°ï¼Ÿ  
\- å¦‚ä½•å¤„ç†è¯·æ±‚æ•°æ®ï¼Ÿï¼ˆGET/POSTï¼‰  
\- å¦‚ä½•è¿”å›å¤šæ ·åŒ–çš„å“åº”ï¼Ÿ  
\- å¦‚ä½•è¿›è¡Œé”™è¯¯å¤„ç†ï¼Ÿ  
\- å¦‚ä½•ç†è§£å’Œä½¿ç”¨çŠ¶æ€ç ï¼Ÿ  
\- å®Œæ•´ä»£ç ç¤ºä¾‹

ğŸ¤” è§†å›¾å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ
-----------

ç®€å•è¯´ï¼Œè§†å›¾å‡½æ•°å°±æ˜¯ä½ ä¸ºæŸä¸ªç‰¹å®šçš„URLï¼ˆè·¯ç”±ï¼‰ç¼–å†™çš„å¤„ç†å‡½æ•°ã€‚å½“ç”¨æˆ·è®¿é—®è¿™ä¸ªURLæ—¶ï¼ŒFlaskå°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶å°†å‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå“åº”å‘é€ç»™ç”¨æˆ·çš„æµè§ˆå™¨ã€‚

å®ƒæ˜¯è¿æ¥**è¯·æ±‚ï¼ˆRequestï¼‰**å’Œ**å“åº”ï¼ˆResponseï¼‰**çš„æ ¸å¿ƒæ¡¥æ¢ï¼Œæ˜¯ä½ å®ç°ä¸šåŠ¡é€»è¾‘çš„ä¸»è¦èˆå°ã€‚

âœï¸ å¦‚ä½•å®šä¹‰ä¸€ä¸ªè§†å›¾å‡½æ•°ï¼Ÿ
--------------

å®šä¹‰è§†å›¾å‡½æ•°åªéœ€ä¸¤æ­¥ï¼š1. ä½¿ç”¨ `@app.route` è£…é¥°å™¨ç»‘å®šURLï¼›2. ç¼–å†™ä¸€ä¸ªPythonå‡½æ•°ã€‚

    from flask import Flask
    app = Flask(__name__)
    
    # 1. ç»‘å®šè·¯ç”± â€˜/â€˜
    @app.route('/')
    def index():
        # 2. ç¼–å†™å¤„ç†é€»è¾‘
        return 'æ¬¢è¿æ¥åˆ°é¦–é¡µï¼'
    
    # å¸¦å˜é‡çš„è·¯ç”±
    @app.route('/user/')
    def show_user_profile(username): # å˜é‡åå¿…é¡»ä¸è·¯ç”±ä¸­ä¸€è‡´
        return f'ç”¨æˆ·ï¼š{username}'

**è£…é¥°å™¨**æ˜¯å…³é”®ï¼Œå®ƒå‘Šè¯‰Flaskå“ªä¸ªURLè§¦å‘å“ªä¸ªå‡½æ•°ã€‚

ğŸ“¥ å¦‚ä½•å¤„ç†è¯·æ±‚æ•°æ®ï¼Ÿï¼ˆGET/POSTï¼‰
----------------------

Webåº”ç”¨çš„æ ¸å¿ƒæ˜¯ä¸ç”¨æˆ·è¾“å…¥äº’åŠ¨ã€‚Flaskçš„ `request` å¯¹è±¡å°è£…äº†æ‰€æœ‰è¯·æ±‚æ•°æ®ã€‚

    from flask import request
    
    # å¤„ç†GETè¯·æ±‚çš„æŸ¥è¯¢å‚æ•°ï¼š/search?q=keyword
    @app.route('/search')
    def search():
        keyword = request.args.get('q', '') # å®‰å…¨è·å–å‚æ•°ï¼Œé¿å…KeyError
        return f'æœç´¢å…³é”®è¯ï¼š{keyword}'
    
    # å¤„ç†POSTè¯·æ±‚çš„è¡¨å•æ•°æ®ï¼ˆå¦‚ç™»å½•ï¼‰
    @app.route('/login', methods=['POST']) # å¿…é¡»æŒ‡æ˜methods
    def login():
        username = request.form.get('username')
        password = request.form.get('password')
        # ... éªŒè¯é€»è¾‘ ...
        return f'ç”¨æˆ· {username} å°è¯•ç™»å½•'
    
    # å¤„ç†JSONæ ¼å¼çš„è¯·æ±‚ä½“ï¼ˆå¸¸è§äºAPIï¼‰
    @app.route('/api/data', methods=['POST'])
    def receive_data():
        json_data = request.get_json() # ç›´æ¥è§£æä¸ºå­—å…¸/åˆ—è¡¨
        return {'received': json_data}, 200

è®°ä½ï¼š**request.args** ç”¨äºGETæŸ¥è¯¢å‚æ•°ï¼Œ**request.form** ç”¨äºPOSTè¡¨å•æ•°æ®ï¼Œ**request.get\_json()** ç”¨äºJSONæ•°æ®ã€‚

ğŸ“¤ å¦‚ä½•è¿”å›å¤šæ ·åŒ–çš„å“åº”ï¼Ÿ
--------------

è§†å›¾å‡½æ•°å¯ä»¥è¿”å›å¤šç§ç±»å‹çš„å“åº”ï¼Œä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²ã€‚

    from flask import render_template, jsonify, redirect, url_for, make_response
    
    # 1. è¿”å›å­—ç¬¦ä¸²ï¼ˆé»˜è®¤ï¼‰
    @app.route('/hello')
    def hello():
        return 'Hello, World!'
    
    # 2. è¿”å›JSONï¼ˆæ„å»ºAPIå¿…å¤‡ï¼‰
    @app.route('/user/')
    def get_user(user_id):
        user_data = {'id': user_id, 'name': 'å¼ ä¸‰'}
        return jsonify(user_data) # è‡ªåŠ¨è®¾ç½®Content-Typeä¸ºapplication/json
    
    # 3. è¿”å›HTMLæ¨¡æ¿
    @app.route('/home')
    def home():
        return render_template('home.html', title='ä¸»é¡µ')
    
    # 4. é‡å®šå‘
    @app.route('/old')
    def old_endpoint():
        return redirect(url_for('home')) # é‡å®šå‘åˆ°â€˜homeâ€™å‡½æ•°å¯¹åº”çš„URL
    
    # 5. è‡ªå®šä¹‰å“åº”å¯¹è±¡ï¼ˆè®¾ç½®Headerã€Cookieç­‰ï¼‰
    @app.route('/custom')
    def custom_response():
        resp = make_response(render_template('index.html'))
        resp.set_cookie('token', 'abc123')
        resp.headers['X-Custom-Header'] = 'Value'
        return resp

ä½¿ç”¨ `jsonify()` è¿”å›JSONï¼Œ`render_template()` è¿”å›æ¸²æŸ“çš„HTMLï¼Œ`redirect()` è¿›è¡Œé¡µé¢è·³è½¬ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„ä¸‰ç§æ–¹å¼ã€‚

âš ï¸ å¦‚ä½•è¿›è¡Œé”™è¯¯å¤„ç†ï¼Ÿ
------------

ä¼˜é›…åœ°å¤„ç†é”™è¯¯èƒ½æå¤§æå‡ç”¨æˆ·ä½“éªŒã€‚Flaskå…è®¸ä½ ä¸ºç‰¹å®šé”™è¯¯ç å®šåˆ¶é¡µé¢æˆ–å“åº”ã€‚

    from flask import render_template
    
    # 1. ä½¿ç”¨è£…é¥°å™¨æ³¨å†Œé”™è¯¯å¤„ç†å™¨
    @app.errorhandler(404)
    def page_not_found(error):
        # å¯ä»¥è¿”å›æ¨¡æ¿ï¼Œä¹Ÿå¯ä»¥è¿”å›JSONï¼ˆé’ˆå¯¹APIï¼‰
        return render_template('404.html'), 404 # å¿…é¡»è¿”å›é”™è¯¯ç 
    
    @app.errorhandler(500)
    def internal_server_error(error):
        return 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åå†è¯•ï¼', 500
    
    # 2. åœ¨è§†å›¾å‡½æ•°ä¸­æ‰‹åŠ¨è§¦å‘é”™è¯¯
    @app.route('/admin')
    def admin():
        # å‡è®¾ç”¨æˆ·æœªç™»å½•ï¼Œåˆ™è¿”å›403ç¦æ­¢è®¿é—®
        # å¯ä»¥ä½¿ç”¨ abort() å‡½æ•°ç«‹å³ä¸­æ–­å¹¶è¿”å›é”™è¯¯å“åº”
        from flask import abort
        abort(403)

**@app.errorhandler** æ˜¯è‡ªå®šä¹‰é”™è¯¯é¡µé¢çš„æ ‡å‡†æ–¹æ³•ï¼Œåˆ«å¿˜äº†åœ¨è¿”å›å€¼é‡ŒæŒ‡æ˜çŠ¶æ€ç ã€‚

ğŸ”¢ å¦‚ä½•ç†è§£å’Œä½¿ç”¨çŠ¶æ€ç ï¼Ÿ
--------------

HTTPçŠ¶æ€ç æ˜¯æœåŠ¡å™¨å¯¹è¯·æ±‚çš„â€œå›åº”è¯­â€ã€‚åœ¨Flaskä¸­ï¼Œä½ å¯ä»¥è½»æ¾è®¾ç½®å®ƒã€‚

å¸¸è§çŠ¶æ€ç ï¼š

\- **200 OK**ï¼šè¯·æ±‚æˆåŠŸï¼ˆFlaskè¿”å›å­—ç¬¦ä¸²æˆ–æ¨¡æ¿æ—¶é»˜è®¤ï¼‰  
\- **301/302**ï¼šé‡å®šå‘ï¼ˆ\`redirect()\` é»˜è®¤è¿”å›302ï¼‰  
\- **400 Bad Request**ï¼šå®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯  
\- **404 Not Found**ï¼šèµ„æºä¸å­˜åœ¨  
\- **500 Internal Server Error**ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯  

è®¾ç½®æ–¹æ³•å¾ˆç®€å•ï¼Œåœ¨è¿”å›å€¼ååŠ ä¸Šæ•°å­—å³å¯ï¼š

    @app.route('/created')
    def created():
        # åˆ›å»ºæˆåŠŸï¼Œè¿”å›201 CreatedçŠ¶æ€ç 
        return 'èµ„æºå·²åˆ›å»º', 201
    
    @app.route('/no_content')
    def no_content():
        # å¤„ç†æˆåŠŸï¼Œä½†æ— å†…å®¹è¿”å›ï¼Œè¿”å›204 No Content
        return '', 204

ğŸ§ª å®Œæ•´ä»£ç ç¤ºä¾‹
---------

å°†ä»¥ä¸ŠçŸ¥è¯†ç‚¹èåˆï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåŠŸèƒ½è¾ƒå…¨çš„Flaskåº”ç”¨ç¤ºä¾‹ï¼š

    from flask import Flask, request, jsonify, render_template_string, abort
    
    app = Flask(__name__)
    
    # é¦–é¡µï¼Œè¿”å›å­—ç¬¦ä¸²
    @app.route('/')
    def index():
        return 'æ¬¢è¿ï¼è¯•è¯•è®¿é—® /hello?name=ä½ çš„åå­— æˆ–å‘ /submit å‘é€POSTè¯·æ±‚ã€‚'
    
    # å¤„ç†GETè¯·æ±‚å’ŒæŸ¥è¯¢å‚æ•°
    @app.route('/hello')
    def hello():
        name = request.args.get('name', 'é™Œç”Ÿäºº')
        return f'ä½ å¥½ï¼Œ{name}ï¼'
    
    # å¤„ç†POSTè¯·æ±‚å’Œè¡¨å•æ•°æ®
    @app.route('/submit', methods=['POST'])
    def submit():
        data = request.form.get('data')
        if not data:
            return 'æœªæ¥æ”¶åˆ°æ•°æ®', 400 # å®¢æˆ·ç«¯é”™è¯¯
        return jsonify({'status': 'success', 'received_data': data})
    
    # å¸¦å˜é‡è·¯ç”±å’Œæ¨¡æ‹ŸAPI
    @app.route('/api/users/')
    def get_user_api(user_id):
        if user_id > 100:
            abort(404, description="ç”¨æˆ·ä¸å­˜åœ¨") # è§¦å‘404é”™è¯¯
        return jsonify({'user_id': user_id, 'name': 'æµ‹è¯•ç”¨æˆ·'})
    
    # è‡ªå®šä¹‰404é”™è¯¯å¤„ç†
    @app.errorhandler(404)
    def not_found(error):
        # è¿”å›ä¸€ä¸ªç®€å•çš„HTMLé”™è¯¯é¡µé¢
        html_template = '''
        <h1>é¡µé¢èµ°ä¸¢å•¦ï¼</h1>
        <p>{{ error_description }}</p>
        '''
        return render_template_string(html_template, error_description=error.description), 404
    
    if __name__ == '__main__':
        app.run(debug=True)

å¤åˆ¶ä»¥ä¸Šä»£ç åˆ° `app.py`ï¼Œè¿è¡Œ `python app.py`ï¼Œå³å¯åœ¨æœ¬åœ°ä½“éªŒæ‰€æœ‰åŠŸèƒ½ã€‚

* * *

å–œæ¬¢æœ¬æ–‡ï¼Ÿä¸è¦é”™è¿‡âœ¨ï¼Œç‚¹èµğŸ‘æ”¶è—â­å…³æ³¨æˆ‘ğŸ‘†ï¼Œä¸€èµ·å­¦ä¹ æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†ï¼Œå®Œå–„ä½ æˆ‘çš„æŠ€èƒ½æ ‘ï¼