---
layout: post
title: 'ç©è½¬AIæ–°å£°æ€ | ç©è½¬TTS/ASR/YuanQI æ‰“é€ è‡ªå·±çš„AIåŠ©æ‰‹'
date: "2025-06-08T00:46:58Z"
---
ç©è½¬AIæ–°å£°æ€ | ç©è½¬TTS/ASR/YuanQI æ‰“é€ è‡ªå·±çš„AIåŠ©æ‰‹
====================================

å‰è¨€
==

halo, å„ä½ä½¬å‹è¿™æ˜¯æˆ‘24å¹´å†™çš„æ•´ç†ä¸€ä¸‹å‘å‡ºæ¥, å¯èƒ½æœ‰ç‚¹è€äº†, aiå‘å±•è¿™ä¹ˆå¿«......

æœ¬æ¬¡å¸¦æ¥çš„æ˜¯è…¾è®¯äº‘ç©è½¬AIæ–°å£°æ€è¯­éŸ³äº§å“åº”ç”¨å®è·µ,åˆ©ç”¨ TTS / ASR / å…ƒå™¨æ™ºèƒ½ä½“ æ‰“é€ ä¸€ä¸ªã€Šå°æœ‹å‹çš„æ•…äº‹å±‹ã€‹æ™ºèƒ½ä½“ Bot æœ€è¿‘è…¾è®¯å‘å¸ƒäº†å…ƒå®,é‚£ä¹ˆæˆ‘ä»¬å°±åšä¸€ä¸ªä¸“å±è®²æ•…äº‹çš„ç«¥è¯åŒ è¯¥ bot å¯ä»¥å®ç°è¯­éŸ³å’Œæ™ºèƒ½ä½“äº¤æµè¾¾åˆ°å’Œå°æœ‹å‹äº’åŠ¨,åœ¨æ­¤ä¹‹å‰æˆ‘å…ˆä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯ TTSã€ASR ä»¥åŠå…ƒå™¨æ™ºèƒ½ä½“(ç®€å•ç•¥è¿‡è¯¦ç»†å­¦ä¹ å‰å¾€: [ã€Šç»§ChatGPTçš„çƒ­æ½®AIçš„æ–°äº§ç‰©-æ™ºèƒ½ä½“å…ƒå™¨Agentå¹³å°ã€‹](https://cloud.tencent.com/developer/article/2432947)

> ğŸ’° æœ¬ç¯‡æ–‡ç« ä»å­¦ä¹  TTS/ASR åˆ°é¡¹ç›®å®æˆ˜ç³»åˆ—ç»“åˆè…¾è®¯äº‘è¯­éŸ³äº§å“å’Œ AI æ™ºèƒ½ä½“èŠ±è´¹äº†ä¸€æ˜ŸæœŸçš„æ—¶é—´è®¾è®¡åŠ å¼€å‘,æˆ‘ç›¸ä¿¡å–œæ¬¢æ£é¼“çš„åŒå­¦è‚¯å®šä¼šéå¸¸å–œæ¬¢è¿™ç¯‡æ–‡ç« ä»ä»‹ç» TTS / ASR / YuanQi Agent API ä¸€å¥—å®Œæ•´çš„ä½“ç³»æ­å»ºå‰ç«¯ã€åç«¯ä»¥åŠæ™ºèƒ½ä½“,æ–‡ç« å½“ä¸­åŒ…æ½äº†å‰ç«¯çŸ¥è¯†ã€åç«¯çŸ¥è¯†ã€ä»¥åŠ AI Agent çŸ¥è¯†ç‚¹ é‚£ä¹ˆæ¥ç©è½¬AIæ–°å£°æ€å§!  
> ä¸»è¦æŠ€æœ¯æ¡†æ¶: Java / Vue3  
> æ™ºèƒ½ä½“ Agent: å…ƒå™¨æ™ºèƒ½ä½“ API  
> âš ï¸ æœ¬æ–‡ç« éœ€è¦ä¸€å®šå¼€å‘åŸºç¡€çš„åŒå­¦,åé¢çš„é¡¹ç›®å®æˆ˜æˆ‘ä¸ä¼šè¯´çš„éå¸¸è¯¦ç»†,é‡ç‚¹åœ¨äºå·©å›ºå­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹!  
> å·²ä¸Šçº¿éƒ¨ç½²: h[ttps://yby6.com/agentai/](https://yby6.com/agentai/)

![ç©è½¬AIæ–°å£°æ€](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205109613-591182146.png)

TTS è¯­éŸ³åˆæˆ
--------

TTS çš„å…¨è‹±æ–‡ Text To Speech è¡¨ç¤ºæ–‡æœ¬è½¬è¯­éŸ³çš„åŠŸèƒ½, è…¾è®¯äº‘è¯­éŸ³åˆæˆæ»¡è¶³å°†æ–‡æœ¬è½¬åŒ–æˆæ‹ŸäººåŒ–è¯­éŸ³çš„éœ€æ±‚ï¼Œæ‰“é€šäººæœºäº¤äº’é—­ç¯ã€‚æä¾›å¤šåœºæ™¯ã€å¤šè¯­è¨€çš„éŸ³è‰²é€‰æ‹©ï¼Œæ”¯æŒ SSML æ ‡è®°è¯­è¨€ï¼Œæ”¯æŒè‡ªå®šä¹‰éŸ³é‡ã€è¯­é€Ÿç­‰å‚æ•°ï¼Œè®©å‘éŸ³æ›´ä¸“ä¸šã€æ›´ç¬¦åˆåœºæ™¯éœ€æ±‚ã€‚è¯­éŸ³åˆæˆå¹¿æ³›é€‚ç”¨äºæ™ºèƒ½å®¢æœã€æœ‰å£°é˜…è¯»ã€æ–°é—»æ’­æŠ¥ã€äººæœºäº¤äº’ç­‰ä¸šåŠ¡åœºæ™¯ã€‚

åœ¨äº§å“é¡µé¢å¯ä»¥è¿›è¡Œè¯•ç”¨äº§å“: [è¯­éŸ³åˆæˆTTS](https://cloud.tencent.com/product/tts?)

![è…¾è®¯äº‘äº§å“è¯•ç”¨](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110558-847227471.png)

### TTS äº§å“ç‰¹æ€§

1.  é«˜æ‹ŸçœŸåº¦
    1.  è…¾è®¯äº‘åŸºäºä¸šç•Œé¢†å…ˆæŠ€æœ¯æ„å»ºçš„è¯­éŸ³åˆæˆç³»ç»Ÿï¼Œå…·å¤‡åˆæˆé€Ÿåº¦å¿«ã€åˆæˆè¯­éŸ³è‡ªç„¶æµç•…ç­‰ç‰¹ç‚¹ï¼Œåˆæˆè¯­éŸ³æ‹ŸçœŸåº¦é«˜ï¼Œèƒ½å¤Ÿç¬¦åˆå¤šæ ·çš„åº”ç”¨åœºæ™¯ï¼Œè®©è®¾å¤‡å’Œåº”ç”¨è½»æ¾å‘å£°ï¼Œäººæœºè¯­éŸ³äº¤äº’æ•ˆæœæ›´åŠ é€¼çœŸã€‚
2.  çµæ´»è®¾ç½®
    1.  è…¾è®¯äº‘è¯­éŸ³åˆæˆæ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€ç²¤è¯­ã€å››å·è¯ï¼Œä¹Ÿå¯ä»¥åˆæˆä¸­è‹±æ··è¯»è¯­éŸ³ï¼›æ”¯æŒæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„éŸ³é‡ã€è¯­é€Ÿç­‰å±æ€§ï¼›æ”¯æŒç¦»çº¿éŸ³é¢‘æ–‡ä»¶å’Œå®æ—¶éŸ³é¢‘æµä¸¤ç§åˆæˆæ ¼å¼ï¼›æ”¯æŒç”µè¯ã€ç§»åŠ¨ App ç­‰å¤šç§åœºæ™¯å’Œåˆæˆæ•ˆæœé€‰æ‹©ã€‚
3.  å£°éŸ³å¤šæ ·
    1.  è…¾è®¯äº‘è¯­éŸ³åˆæˆæ”¯æŒå¤šç§ç”·å£°ã€å¥³å£°çš„é€‰æ‹©ï¼Œä½¿å¾—éŸ³è‰²èƒ½å¤Ÿè¦†ç›–å¤šæ ·åŒ–çš„åº”ç”¨åœºæ™¯ï¼Œé€‚ç”¨äºç”µè¯å®¢æœï¼Œå°è¯´æœ—è¯»ï¼Œæ¶ˆæ¯æ’­æŠ¥ç­‰åœºæ™¯ã€‚æ­¤å¤–ï¼Œè…¾è®¯äº‘æ”¯æŒä¸ºä¼ä¸šå®¢æˆ·å®šåˆ¶å‘å£°äººã€‚
4.  å…è´¹ä½“éªŒæ–°ç”¨æˆ·å¯ä»¥é¢†å– 800 ä¸‡çš„è¯­éŸ³åˆæˆèµ„æºç”¨åˆ°çˆ½

![äº§å“ç‰¹æ€§](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112365-643553391.png)

ASR è¯­éŸ³è¯†åˆ«
--------

ASR çš„å…¨è‹±æ–‡ Automatic Speech Recognitionï¼ŒASR è¡¨ç¤ºæ–‡æœ¬è½¬è¯­éŸ³çš„åŠŸèƒ½, è…¾è®¯äº‘è¯­éŸ³è¯†åˆ«æ˜¯å°†è¯­éŸ³è½¬åŒ–æˆæ–‡å­—çš„PaaSäº§å“ï¼Œä¸ºä¼ä¸šæä¾›ç²¾å‡†è€Œæå…·æ€§ä»·æ¯”çš„è¯†åˆ«æœåŠ¡ã€‚è¢«å¾®ä¿¡ã€ç‹è€…è£è€€ã€è…¾è®¯è§†é¢‘ç­‰å¤§é‡ä¸šåŠ¡ä½¿ç”¨ï¼Œé€‚ç”¨äºå½•éŸ³è´¨æ£€ã€ä¼šè®®å®æ—¶è½¬å†™ã€è¯­éŸ³è¾“å…¥æ³•ç­‰å¤šä¸ªåœºæ™¯ã€‚

è…¾è®¯äº‘åœ¨è¯­éŸ³è¯†åˆ«é¢†åŸŸæ‹¥æœ‰å¤šä¸ªå­äº§å“åŠŸèƒ½: å½•éŸ³æ–‡ä»¶è¯†åˆ«ã€å½•éŸ³æé€Ÿç‰ˆæœ¬è¯†åˆ«ã€å®æ—¶è¯­éŸ³è¯†åˆ«ã€ä¸€å¥è¯è¯†åˆ«ã€è¯­éŸ³å¼‚æ­¥è¯†åˆ« æ¯ä¸ªè¯†åˆ«ç”¨äºä¸åŒçš„åœºæ™¯,æ ¹æ®æ‚¨çš„ä¸šåŠ¡æ¥ä½¿ç”¨å¯¹åº”çš„è¯†åˆ«å°†ä¼šäº‹åŠåŠŸå€!

![ASRè¯­éŸ³è¯†åˆ«äº§å“ç›®å½•](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115812-1919655863.png)

### ASR äº§å“ä¼˜åŠ¿

1.  æŠ€æœ¯å…ˆè¿›
    1.  è¯­éŸ³è¯†åˆ«å¼•æ“é‡‡ç”¨è‡ªä¸»ç ”å‘çš„TransformeræŠ€æœ¯ï¼Œå…·å¤‡è¾ƒå¥½çš„é²æ£’æ€§ã€‚æ”¯æŒå£°éŸ³å’Œæ–‡æœ¬å±‚é¢çš„è‡ªé€‚åº”èƒ½åŠ›å’Œè¯­è¨€æ··åˆè¯†åˆ«èƒ½åŠ›ã€‚ä¸­æ–‡æ™®é€šè¯ã€è‹±æ–‡ã€æ™®ç²¤è‹±å¼•æ“çš„è¯†åˆ«å­—å‡†ç‡å‡èƒ½æ»¡è¶³å¹¿æ³›çš„å•†ç”¨åœºæ™¯ã€‚
2.  å¤šè¯­ç§ã€å¤šæ–¹è¨€
    1.  ç›®å‰æ”¯æŒä¸­æ–‡æ™®é€šè¯ã€è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­ã€æ³°è¯­ã€é©¬æ¥è¯­ç­‰13ä¸ªè¯­ç§ï¼Œæ”¯æŒç²¤è¯­ã€ä¸Šæµ·è¯ã€å››å·è¯ç­‰24ç§æ–¹è¨€ï¼Œå¹¶å°†æŒç»­å¼€æ”¾å…¶ä»–è¯­ç§å’Œæ–¹è¨€çš„è¯†åˆ«èƒ½åŠ›ã€‚æ”¯æŒé€šè¿‡å•ä¸€å¼•æ“è¯†åˆ«æ™®é€šè¯ã€ç²¤è¯­ã€è‹±è¯­ä¸‰ä¸ªè¯­ç§ã€‚
3.  æ€§ä»·æ¯”é«˜
    1.  è…¾è®¯äº‘æä¾›é¢„ä»˜è´¹ã€åä»˜è´¹ç­‰å¤šç§çµæ´»è®¡è´¹æ¨¡å¼ï¼Œåœ¨é¢„ä»˜è´¹åŒ…æä¾›äº†è¾ƒå¤§ä¼˜æƒ ï¼Œè¯†åˆ«1å°æ—¶è¯­éŸ³ä¸åˆ°1å…ƒã€‚æ¯æœˆèµ é€å…è´¹é¢åº¦ï¼Œæœ€å¤§ç¨‹åº¦é™ä½å®¢æˆ·æˆæœ¬ã€‚

å‰å¾€è¯­éŸ³è¯†åˆ«äº§å“é¡µé¢å¯ä»¥ä½“éªŒè¯•ç”¨äº§å“ [è¯­éŸ³è¯†åˆ«\_å®æ—¶è¯­éŸ³è¯†åˆ«\_å½•éŸ³æ–‡ä»¶è¯†åˆ«\_è¯­éŸ³è½¬æ–‡æœ¬æœåŠ¡ - è…¾è®¯äº‘](https://cloud.tencent.com/product/asr?from_column=20421&from=20421)

![åŠŸèƒ½ä½“éªŒ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205107856-238359362.png)

æ”¯æŒå°ç¨‹åºä½“éªŒå’Œ PC ç«¯ä½“éªŒ å®æ—¶è¯†åˆ«å’ŒéŸ³é¢‘æ–‡ä»¶è¯†åˆ«

èµ„æºåŒ…æ¨è
-----

è§‰å¾—è¿˜ä¸é”™è¶ç°åœ¨ 618 å…¥æ‰‹æ›´åŠ åˆ’ç®—ä¾¿å®œ[ã€è…¾è®¯äº‘ã€‘äº‘æœåŠ¡å™¨ã€äº‘æ•°æ®åº“ã€COSã€CDNã€çŸ­ä¿¡ç­‰äº‘äº§å“ç‰¹æƒ çƒ­å–ä¸­](https://cloud.tencent.com/act)

è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆéœ€æ±‚é‡å¤§çš„éå¸¸å»ºè®®é€Ÿåº¦å…¥æ‰‹å•ä¹°è¿˜æ˜¯å¾ˆä¸åˆ’ç®—çš„

![ä¼˜æƒ äº§å“](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205120044-1960493838.png)

æ¥å…¥ TTS è¯­éŸ³åˆæˆ
===========

åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»ä»‹ç»äº† TTS / ASR æ˜¯ä»€ä¹ˆä¸œè¥¿æœ‰ä»€ä¹ˆç”¨,æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¥å…¥ TTS / ASR åˆ°ç¨‹åºå½“ä¸­ä½¿ç”¨åŒå­¦ä»¬å‡†å¤‡é£™è½¦å•¦!

å¼€é€š ASR
------

å‰å¾€å‰å¾€è…¾è®¯äº‘è¯­éŸ³åˆæˆæœåŠ¡ [è¯­éŸ³åˆæˆ](https://console.cloud.tencent.com/tts)

![å¼€é€šè¯­éŸ³åˆæˆ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205109469-1938678498.png)

ç‚¹å‡»èµ„æºåŒ… æ–°ç”¨æˆ·å¯ä»¥é¢†å–ä¸€ä¸ªå…è´¹èµ„æºåŒ…å†…å«800ä¸‡è°ƒç”¨å­—ç¬¦ç”¨åˆ°çˆ½ä½†æ˜¯ä¸å«é•¿æ–‡æœ¬çš„(600 å­—ç¬¦)ä¹Ÿå¤Ÿæˆ‘ä»¬çš„éœ€æ±‚äº†

![é¢†å–å…è´¹é¢åº¦èµ„æºåŒ…](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110567-1145853168.png)

æ¥ç€æˆ‘ä»¬ç‚¹å‡»åˆæˆéŸ³é¢‘æ¥è¯•è¯•çœ‹æ•ˆæœ, çœ‹ä½ çš„æ„Ÿè§‰é€‰æ‹©ä»»æ„ä¸€ä¸ªéŸ³é¢‘éŸ³è‰²ç„¶åè¾“å…¥ä½ æƒ³è¦åˆæˆçš„éŸ³é¢‘æ–‡æœ¬, ç‚¹å‡»åˆæˆè¯­éŸ³å³å¯

![åˆæˆéŸ³é¢‘å°é²œ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205119023-1352108020.png)

åˆæˆä¸­, å¦‚æœåˆæˆæˆåŠŸåˆ™æ—è¾¹çš„ä¸¤ä¸ªæŒ‰é’®éƒ½å°†å¯ç‚¹å‡»,ä¸€ä¸ªæ˜¯ä¸‹è½½éŸ³é¢‘ ä¸€ä¸ªæ˜¯æ’­æ”¾

[ğŸ“çˆ±å°é™-åˆæˆéŸ³é¢‘.wav](https://www.yuque.com/attachments/yuque/0/2024/wav/2426233/1718116058277-6e6795f5-2f77-47ea-a2e0-2423d96ea99d.wav)

![åˆæˆæˆåŠŸ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205108003-555768210.png)

å¦‚æœæƒ³å¬ä¸Šä¸€æ®µéŸ³é¢‘å¯åœ¨åˆæˆè®°å½•æŸ¥çœ‹å¹¶ä¸”ä¸‹è½½ç­‰æ“ä½œ

![åˆæˆè®°å½•](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112309-1064815410.png)

æ¶ˆè€—çš„å­—ç¬¦éƒ½åœ¨å…è´¹çš„èµ„æºåŒ…å½“ä¸­

![æ¶ˆè€—æŸ¥çœ‹](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205106499-114924157.png)

TTS æ–‡æ¡£
------

ç‚¹å‡»å³ä¸‹è§’å›¾æ ‡åœ¨é€‰æ‹©è¯­éŸ³åˆæˆ

![è¯­éŸ³åˆæˆæ–‡æ¡£](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112364-695951830.png)

![è¯­éŸ³åˆæˆæ–‡æ¡£ 2](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205114880-937034046.png)

### æ¥å£æè¿°

å¦‚æœä½ ä¸ä½¿ç”¨å®˜æ–¹æä¾›çš„ SDK è¿›è¡Œæ¥å…¥é‚£ä¹ˆå°±éœ€è¦å•ç‹¬æ“ä½œè¿™ä¸ªè¯·æ±‚æ¥å£äº†

æ¥å£è¯·æ±‚åŸŸåï¼š `tts.tencentcloudapi.com`

è…¾è®¯äº‘è¯­éŸ³åˆæˆæŠ€æœ¯ï¼ˆTTSï¼‰å¯ä»¥å°†ä»»æ„æ–‡æœ¬è½¬åŒ–ä¸ºè¯­éŸ³ï¼Œå®ç°è®©æœºå™¨å’Œåº”ç”¨å¼ å£è¯´è¯ã€‚

è…¾è®¯TTSæŠ€æœ¯å¯ä»¥åº”ç”¨åˆ°å¾ˆå¤šåœºæ™¯ï¼Œæ¯”å¦‚ï¼Œç§»åŠ¨APPè¯­éŸ³æ’­æŠ¥æ–°é—»ï¼›æ™ºèƒ½è®¾å¤‡è¯­éŸ³æé†’ï¼›ä¾é ç½‘ä¸Šç°æœ‰èŠ‚ç›®æˆ–å°‘é‡å½•éŸ³ï¼Œå¿«é€Ÿåˆæˆæ˜æ˜Ÿè¯­éŸ³ï¼Œé™ä½é‚€çº¦æˆæœ¬ï¼›æ”¯æŒè½¦è½½å¯¼èˆªè¯­éŸ³åˆæˆçš„ä¸ªæ€§åŒ–è¯­éŸ³æ’­æŠ¥ã€‚

### æ¥å£è¯·æ±‚è¦æ±‚

å®é™…ä¸Šä¹Ÿå°±ä¸¤ä¸ªå¿…å¡« `Textã€SessionId` ä»¥ä¸‹æ˜¯æˆ‘è§‰å¾—ç¬¦åˆæˆ‘çš„ä¸šåŠ¡çš„å¿…è¦å‚æ•°

å…·ä½“çš„å‚æ•°å‰å¾€æ–‡æ¡£æŸ¥çœ‹

å‚æ•°åç§°

å¿…é€‰

ç±»å‹

æè¿°

Text

æ˜¯

String

åˆæˆè¯­éŸ³çš„æºæ–‡æœ¬ï¼ŒæŒ‰UTF-8ç¼–ç ç»Ÿä¸€è®¡ç®—ã€‚ä¸­æ–‡æœ€å¤§æ”¯æŒ150ä¸ªæ±‰å­—ï¼ˆå…¨è§’æ ‡ç‚¹ç¬¦å·ç®—ä¸€ä¸ªæ±‰å­—ï¼‰ï¼›è‹±æ–‡æœ€å¤§æ”¯æŒ500ä¸ªå­—æ¯ï¼ˆåŠè§’æ ‡ç‚¹ç¬¦å·ç®—ä¸€ä¸ªå­—æ¯ï¼‰ã€‚ç¤ºä¾‹å€¼ï¼šä½ å¥½

SessionId

æ˜¯

String

ä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€ä¸ªSessionIdï¼Œä¼šåŸæ ·è¿”å›ï¼Œå»ºè®®ä¼ å…¥ç±»ä¼¼äºuuidçš„å­—ç¬¦ä¸²é˜²æ­¢é‡å¤ã€‚ç¤ºä¾‹å€¼ï¼šsession-1234

VoiceType

å¦

Integer

éŸ³è‰² IDï¼ŒåŒ…æ‹¬æ ‡å‡†éŸ³è‰²ä¸ç²¾å“éŸ³è‰²ï¼Œç²¾å“éŸ³è‰²æ‹ŸçœŸåº¦æ›´é«˜ï¼Œä»·æ ¼ä¸åŒäºæ ‡å‡†éŸ³è‰²ï¼Œè¯·å‚è§[è´­ä¹°æŒ‡å—](https://cloud.tencent.com/document/product/1073/34112) å®Œæ•´çš„éŸ³è‰² ID åˆ—è¡¨è¯·å‚è§[éŸ³è‰²åˆ—è¡¨](https://cloud.tencent.com/document/product/1073/92668) ç¤ºä¾‹å€¼ï¼š0

PrimaryLanguage

å¦

Integer

ä¸»è¯­è¨€ç±»å‹ï¼š- 1-ä¸­æ–‡ï¼ˆé»˜è®¤ï¼‰- 2-è‹±æ–‡ - 3-æ—¥æ–‡ ç¤ºä¾‹å€¼ï¼š1

Codec

å¦

String

è¿”å›éŸ³é¢‘æ ¼å¼ï¼Œå¯å–å€¼ï¼šwavï¼ˆé»˜è®¤ï¼‰ï¼Œmp3ï¼Œpcm ç¤ºä¾‹å€¼ï¼šwav

EmotionCategory

å¦

String

æ§åˆ¶åˆæˆéŸ³é¢‘çš„æƒ…æ„Ÿï¼Œä»…æ”¯æŒå¤šæƒ…æ„ŸéŸ³è‰²ä½¿ç”¨ã€‚å–å€¼: neutral(ä¸­æ€§)ã€sad(æ‚²ä¼¤)ã€happy(é«˜å…´)ã€angry(ç”Ÿæ°”)ã€fear(ææƒ§)ã€news(æ–°é—»)ã€story(æ•…äº‹)ã€radio(å¹¿æ’­)ã€poetry(è¯—æ­Œ)ã€call(å®¢æœ)ã€æ’’å¨‡(sajiao)ã€åŒæ¶(disgusted)ã€éœ‡æƒŠ(amaze)ã€å¹³é™(peaceful)ã€å…´å¥‹(exciting)ã€å‚²å¨‡(aojiao)ã€è§£è¯´(jieshuo)

### è¾“å‡ºå‚æ•°

å‚æ•°åç§°

ç±»å‹

æè¿°

Audio

String

base64ç¼–ç çš„wav/mp3éŸ³é¢‘æ•°æ®ç¤ºä¾‹å€¼ï¼šUklGRlRAABXQVZFZm10IBAAAAABAAEAgD4AAAB9AAACABAAZGF0YSx9AAD+

SessionId

String

ä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€ä¸ªSessionId ç¤ºä¾‹å€¼ï¼šsession-1234

Subtitles

Array of [Subtitle](https://cloud.tencent.com/document/api/107357374#Subtitle)

æ—¶é—´æˆ³ä¿¡æ¯ï¼Œè‹¥æœªå¼€å¯æ—¶é—´æˆ³ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚

RequestId

String

å”¯ä¸€è¯·æ±‚ IDï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¿”å›ã€‚å®šä½é—®é¢˜æ—¶éœ€è¦æä¾›è¯¥æ¬¡è¯·æ±‚çš„ RequestIdã€‚

ç®€å•è®¤è¯†ä¸€äº›è¯·æ±‚å‚æ•°å’Œè¿”å›å‚æ•°, é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å…¥åˆ°è‡ªå·±çš„ç¨‹åºå½“ä¸­, è…¾è®¯äº‘æœ‰ä¸€ä¸ªå« API Explorer è¿™ä¸ªæ˜¯ä¸“é—¨è°ƒè¯•è…¾è®¯äº‘å„ç§äº§å“çš„å¹³å°æ­é… SDK è§£æ”¾åŒæ‰‹,å¯ä»¥è¯´æ˜¯ä¸€ç§’å°±å¯ä»¥é›†æˆåˆ°ç³»ç»Ÿä¸­, å¤§ç™½è¯ ä½ ä¼š CV å§?

![zqZo.gif](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205106323-1009675646.gif)

API è°ƒè¯•
------

[ç‚¹å‡»æˆ‘å‰å¾€](https://console.cloud.tencent.com/api/explorer?Product=tts) API Explorer è°ƒè¯•å¹³å°, é€‰æ‹©åŸºç¡€è¯­éŸ³åˆæˆ é•¿æ–‡æœ¬æˆ‘ä»¬å¯æ²¡æœ‰å…è´¹èµ„æºåŒ…

![API è°ƒè¯•](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110904-1689701811.png)

åœ¨å‰é¢æˆ‘ä»¬è¯´åˆ°è¿™å…­ä¸ªæˆ‘å°±ç»™è¿™å…­ä¸ªå‚æ•°è®¾ç½®å‚æ•°å…¶å®ƒçš„ä½ ä»¬è‡ªå·±çœ‹çœ‹éœ€è¦ä»€ä¹ˆæä»€ä¹ˆ

Text

æè¿°

SessionId

å”¯ä¸€ID

VoiceType

éŸ³é¢‘éŸ³è‰²

PrimaryLanguage

åˆæˆè¯­éŸ³è¯­è¨€ç§ç±»

Codec

è¿”å›éŸ³é¢‘æ ¼å¼

EmotionCategory

æ§åˆ¶åˆæˆéŸ³é¢‘çš„æƒ…æ„Ÿ

åœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥ç‚¹å‡»å›¾å½¢è·³è½¬åˆ°å¯¹åº”çš„æ–‡æ¡£è¯´æ˜

![æ–‡æ¡£è¯´æ˜](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110430-1687279552.png)

### VoiceType

ç‚¹å‡»éŸ³è‰²åˆ—è¡¨é€‰æ‹©ä½ è§‰å¾—å¥½å¬çš„éŸ³è‰² ID æˆ‘è¿™é‡Œå°±é€‰æ‹© çˆ±å°è· 301032 éŸ³è‰²æƒ…æ„Ÿ æä¸ª é«˜å…´

![éŸ³è‰²åˆ—è¡¨](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115295-2051256070.png)

![éŸ³è‰²åˆ—è¡¨ 2](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113917-2070072249.png)

å¦‚æœä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ ·å­å» `åˆæˆéŸ³é¢‘èœå•` è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹ä½ å–œæ¬¢å“ªä¸ªå£å‘³çš„

![éŸ³è‰²åˆ—è¡¨ 3](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205105206-2111874814.png)

### EmotionCategory

è®¾ç½®æƒ…ç»ª æ§åˆ¶åˆæˆéŸ³é¢‘çš„æƒ…æ„Ÿï¼Œä»…æ”¯æŒå¤šæƒ…æ„ŸéŸ³è‰²ä½¿ç”¨ã€‚å–å€¼: neutral(ä¸­æ€§)ã€sad(æ‚²ä¼¤)ã€happy(é«˜å…´)ã€angry(ç”Ÿæ°”)ã€fear(ææƒ§)ã€news(æ–°é—»)ã€story(æ•…äº‹)ã€radio(å¹¿æ’­)ã€poetry(è¯—æ­Œ)ã€call(å®¢æœ)ã€æ’’å¨‡(sajiao)ã€åŒæ¶(disgusted)ã€éœ‡æƒŠ(amaze)ã€å¹³é™(peaceful)ã€å…´å¥‹(exciting)ã€å‚²å¨‡(aojiao)ã€è§£è¯´(jieshuo)

![è®¾ç½®æƒ…ç»ª](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205107042-291152960.png)

### Codec

è®¾ç½®è¿”å›çš„æ ¼å¼æˆ‘è¿™é‡Œå°± mp3 æ ¼å¼

![è¿”å›æ ¼å¼](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205108319-610635199.png)

### PrimaryLanguage

è®¾ç½®åˆæˆè¯­éŸ³è¯­è¨€é»˜è®¤ä¸ºä¸­æ–‡æœ‰éœ€è¦çš„å°±è‡ªå·±æ”¹æ”¹æˆ‘å°±é»˜è®¤äº†

> æå‰é€è§†: FastVoiceType å‚æ•°æ˜¯ç”¨æ¥å¡«å†™å£°éŸ³å¤åˆ» ID ä¹Ÿå°±æ˜¯è‡ªå®šä¹‰éŸ³è‰²å°†ä½ è‡ªå·±çš„éŸ³è‰²å¤åˆ»,åé¢å°±å¯ä»¥ä½¿ç”¨ä½ çš„è¯­æ°”å£°éŸ³æ¥è¯­éŸ³åˆæˆæ’­æ”¾æ˜¯ä¸æ˜¯å¾ˆå¼º, åé¢ä¼šè®²åˆ°

### è°ƒè¯•æ•ˆæœ

å¡«å†™å¥½å¯¹åº”å‚æ•°åç›´æ¥åœ¨çº¿è°ƒç”¨å³å¯

![è°ƒè¯•å‘é€è¯·æ±‚](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205111879-1202522890.png)

![è¯·æ±‚ç»“æœ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112414-545414074.png)

è°ƒç”¨æˆåŠŸ, æ¥å¬å¬çœ‹æµè§ˆå™¨è¾“å…¥`data:audio/mp3;base64,`æ‹¼æ¥ `Audio` å‚æ•°, å³å¯æ’­æ”¾

![éŸ³é¢‘æ’­æ”¾](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205105305-728601990.png)

    data:audio/mp3;base64,//OoxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAV......
    

åŒå­¦ä»¬å¯ä»¥æŠŠç”Ÿæˆçš„è¯­éŸ³å‘åœ¨è¯„è®º,æƒ³ä½ äº†æƒ³å¬ä½ è¯­éŸ³

### ä»£ç ç¤ºä¾‹

æˆ‘ä»¬ä½¿ç”¨ SDK æ¥å…¥ maven ä¾èµ–, ä»£ç éƒ½ç»™æˆ‘ä»¬ç”Ÿæˆå¥½äº†é‚£ä¹ˆæˆ‘ä»¬å°±åˆ›å»ºå·¥ç¨‹è¯•è¯•çœ‹

![ä»£ç ç¤ºä¾‹](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205119275-73623586.png)

åˆ›å»ºåç«¯å·¥ç¨‹
======

è¯·å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹é¢æ–°å¢åç«¯å·¥ç¨‹, åé¢å‰ç«¯å·¥ç¨‹ä¹Ÿè¦æ”¾åœ¨è¿™é‡Œ, åŒä¸€ä¸ªä»“åº“å¥½ç®¡ç†

æˆ‘è¿™é‡Œå°±ä½¿ç”¨ JDK17 ç‰ˆæœ¬

![åˆ›å»ºå·¥ç¨‹](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205120898-1247282948.png)

![å¼•å…¥ä¾èµ–](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205105137-441873962.png)

æ·»åŠ ä¾èµ–

    <!--    è¯­éŸ³åˆæˆ   -->
    <dependency>
      <groupId>com.tencentcloudapi</groupId>
      <artifactId>tencentcloud-sdk-java-tts</artifactId>
      <version>3.1.991</version>
    </dependency>
    

å°†è°ƒè¯•å¥½çš„ä»£ç å¤åˆ¶è¿‡æ¥å³å¯, è¿˜ç¼ºå°‘ API å¯†é’¥ æ ¹æ®æ³¨é‡Šæç¤ºçš„é“¾æ¥å‰å¾€è·å–

![å¤åˆ¶è°ƒè¯•ä»£ç ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205121722-133219374.png)

![è·å–è®¿é—®å¯†é’¥](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205116153-1749821532.png)

### è°ƒè¯•

å¡«å†™å¯†é’¥å®Œæ¯•åå³å¯ç›´æ¥å‘èµ·è¯·æ±‚

![è¯·æ±‚ç»“æœ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205123044-254450235.png)

é‚£ä¹ˆåˆ°è¿™é‡Œå°±å·²ç»ä½¿ç”¨ Java ç®€å•çš„æ¥å…¥å¥½è¯­éŸ³åˆæˆåŠŸèƒ½æ˜¯ä¸æ˜¯è§‰å¾—è§£æ”¾åŒæ‰‹éå¸¸çš„ easy , åé¢å°†ä¼šå’Œè¯­éŸ³è¯†åˆ«å°è£…ä¸ºä¸€ä¸ªå·¥å…·ç±»æä¾›ä½¿ç”¨

æ¥å…¥ ASR è¯­éŸ³è¯†åˆ«
===========

åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»å®Œç¾åœ¨ç¨‹åºå½“ä¸­æ¥å…¥äº†è¯­éŸ³åˆæˆ TTS æ¥ä¸‹æ¥é£™è½¦ ASR è¯­éŸ³è¯†åˆ«, ä¸€æ ·çš„é…æ–¹ä¸€æ ·çš„æ„Ÿè§‰ so easy to happy åˆ‡èœä¸€æ ·

å¼€é€š ASR
------

å‰å¾€è…¾è®¯äº‘è¯­éŸ³è¯†åˆ«æœåŠ¡ç½‘ç«™: [è¯­éŸ³è¯†åˆ«\_å®æ—¶è¯­éŸ³è¯†åˆ«\_å½•éŸ³æ–‡ä»¶è¯†åˆ«\_è¯­éŸ³è½¬æ–‡æœ¬æœåŠ¡ - è…¾è®¯äº‘](https://cloud.tencent.com/product/asr?from_column=20421&from=20421)

![å¼€é€š è¯­éŸ³è¯†åˆ«](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205119293-805221609.png)

![ç«‹å³å¼€é€š](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113113-610538859.png)

å¼€é€šåè…¾è®¯äº‘ä¼šèµ é€æ–°ç”¨æˆ·å…è´¹é¢åº¦,è€Œä¸”è¿˜æ˜¯ `æ¯ä¸ªæœˆ` éƒ½æœ‰è¿™ä¹ˆå¤šå…è´¹é¢åº¦æä¾›ä½¿ç”¨åªèƒ½è¯´è‰¯å¿ƒäº‘

![å…è´¹èµ„æºé¢åº¦](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115730-869342999.png)

ç‚¹å‡»åŠŸèƒ½ä½“éªŒ, æ–¹å¯ä½“éªŒè¯­éŸ³è¯†åˆ«, åˆšåˆšå¥½å‰é¢æˆ‘ä»¬ç”¨è¯­éŸ³åˆæˆäº†ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶è®¿é—® Base64 å°±å¯ä»¥ä¸‹è½½åˆ°æœ¬åœ°äº†

æˆ‘ä»¬é€‰æ‹©é€šç”¨è¯­éŸ³è¯†åˆ«å³å¯, å¤§æ¨¡å‹è¯†åˆ«å¯ä»¥æé«˜å‡†ç¡®ç‡æœ‰èµ„æºçš„æ–¹å¯å°è¯•ä¸€æ³¢

ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶åç›´æ¥ç‚¹å‡»å¼€å§‹è¯†åˆ«

ç»“æœè¾“å‡ºåœ¨ä¸‹æ–¹, å¾€ä¸‹æ»‘å°±å¯ä»¥çœ‹åˆ°éŸ³é¢‘å†…å®¹

ASR æ–‡æ¡£
------

é‚£ä¹ˆç®€å•ä½“éªŒåæˆ‘ä»¬æ¥å¼€å§‹æ¥å…¥åˆ°ç¨‹åºå½“ä¸­, æ¥å…¥å‰è¿˜æ˜¯ä¸€æ ·å…ˆçœ‹çœ‹æ–‡æ¡£æ€ä¹ˆæ“ä½œ

æœ¬æ¬¡å­¦ä¹ çš„æ¥å£æœ‰ä¸‰ä¸ª `å½•éŸ³æ–‡ä»¶è¯†åˆ«`ã€`å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆ`ã€`å®æ—¶è¯­éŸ³è¯†åˆ«`

ä¸‹é¢æˆ‘å°†ä¸€ä¸ªä¸ªçš„ä»‹ç»å’Œä½¿ç”¨æœ€ç»ˆå°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»å½“ä¸­, éƒ½æ˜¯ä½¿ç”¨çš„è…¾è®¯äº‘ SDK

å½•éŸ³æ–‡ä»¶è¯†åˆ«
------

æ¥å£è¯·æ±‚åŸŸåï¼š `asr.tencentcloudapi.com` é»˜è®¤æ¥å£è¯·æ±‚é¢‘ç‡é™åˆ¶ï¼š`20æ¬¡/ç§’`ã€‚

æœ¬æ¥å£å¯å¯¹è¾ƒé•¿çš„å½•éŸ³æ–‡ä»¶è¿›è¡Œè¯†åˆ«, æˆ‘ä»¬åé¢è¦å†™ä¸€ä¸ªæ•…äº‹æ™ºèƒ½ä½“, è¿”å›çš„æ–‡æœ¬ä¿¡æ¯å¶å°”ä¼šå¾ˆé•¿é‚£ä¹ˆå°±éœ€è¦ç”¨è¿™ä¸ª

### æ¥å£æè¿°

â€¢ æ¥å£é»˜è®¤é™é¢‘ï¼š20æ¬¡/ç§’ã€‚æ­¤å¤„ä»…é™åˆ¶ä»»åŠ¡æäº¤é¢‘æ¬¡ï¼Œä¸è¯†åˆ«ç»“æœè¿”å›æ—¶æ•ˆæ— å…³

â€¢ è¿”å›æ—¶æ•ˆï¼šå¼‚æ­¥å›è°ƒï¼Œéå®æ—¶è¿”å›ã€‚æœ€é•¿3å°æ—¶è¿”å›è¯†åˆ«ç»“æœï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ1å°æ—¶çš„éŸ³é¢‘1-3åˆ†é’Ÿå³å¯å®Œæˆè¯†åˆ«

â€¢ éŸ³é¢‘æ ¼å¼ï¼š`wavã€mp3ã€m4aã€flvã€mp4ã€wmaã€3gpã€amrã€aacã€ogg-opusã€flac`

â€¢ éŸ³é¢‘æäº¤æ–¹å¼ï¼šæœ¬æ¥å£æ”¯æŒéŸ³é¢‘ URL ã€æœ¬åœ°éŸ³é¢‘æ–‡ä»¶ä¸¤ç§è¯·æ±‚æ–¹å¼ã€‚

â€¢ éŸ³é¢‘é™åˆ¶ï¼šéŸ³é¢‘ URL æ—¶é•¿ä¸èƒ½å¤§äº5å°æ—¶ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡1GBï¼›æœ¬åœ°éŸ³é¢‘æ–‡ä»¶ä¸èƒ½å¤§äº5MB

### æ¥å£è¯·æ±‚è¦æ±‚

å®é™…ä¸Šæˆ‘ä»¬å°±åªéœ€è¦è¿™äº”ä¸ªå‚æ•°, å…¶å®ƒçš„å‚æ•°æŸ¥çœ‹æ–‡æ¡£ä»‹ç»æ¥ä½¿ç”¨æˆ‘å°±ä¸ä¸€ä¸€ç»™åŒå­¦æ¼”ç¤ºäº†

æ¯”å¦‚å…¶ä¸­çš„ä¸€ä¸ªçƒ­è¯å¢å¼ºåŠŸèƒ½å°±æ˜¯å°†åŒæ‹¼éŸ³çš„æ–‡å­—è¯†åˆ«ä¸ºä½ å®šä¹‰çš„æ¯”å¦‚çƒ­è¯å®šä¹‰`æ¨ä¸æ˜“å‘€`

å¦‚æœè¯†åˆ«å‡ºæ¥çš„åŒæ‹¼éŸ³ `æ¨å¸ƒä¾å–(yangbuyiya)` å°±ä¼šå°†å…¶è¿›è¡Œæ›¿æ¢, éƒ½æ˜¯éå¸¸å¥½ç†è§£çš„

å‚æ•°åç§°

æè¿°

EngineModelType

å¼•æ“æ¨¡å‹ç±»å‹ å°±ä¸¤ä¸ª ä¸€ä¸ªæ˜¯ç”µè¯ç”¨çš„ä¸€ä¸ªæ˜¯é€šç”¨çš„, æˆ‘ä»¬ç›´æ¥ä½¿ç”¨é€šç”¨å³å¯ **16k\_zh**

ChannelNum

è¯†åˆ«å£°é“æ•° 1ï¼šå•å£°é“ï¼ˆ16kéŸ³é¢‘ä»…æ”¯æŒå•å£°é“ï¼Œ**è¯·å‹¿**è®¾ç½®ä¸ºåŒå£°é“ï¼‰ 2ï¼šåŒå£°é“ï¼ˆä»…æ”¯æŒ8kç”µè¯éŸ³é¢‘ï¼Œä¸”åŒå£°é“åº”åˆ†åˆ«ä¸ºé€šè¯åŒæ–¹ï¼‰

ResTextFormat

è¯†åˆ«ç»“æœè¿”å›æ ·å¼åŸºç¡€è¯†åˆ«ç»“æœ

SourceType

éŸ³é¢‘æ•°æ®æ¥æº 0ï¼šéŸ³é¢‘URLï¼› 1ï¼šéŸ³é¢‘æ•°æ®ï¼ˆpost bodyï¼‰

Data

éŸ³é¢‘æ•°æ®base64ç¼–ç  **å½“ SourceType å€¼ä¸º 1 æ—¶é¡»å¡«å†™è¯¥å­—æ®µï¼Œä¸º 0 æ—¶ä¸éœ€è¦å¡«å†™**

### è¾“å‡ºå‚æ•°

å‚æ•°åç§°

ç±»å‹

æè¿°

Data

[Task](https://cloud.tencent.com/document/api/1093/37824#Task)

å½•éŸ³æ–‡ä»¶è¯†åˆ«çš„è¯·æ±‚è¿”å›ç»“æœï¼ŒåŒ…å«ç»“æœæŸ¥è¯¢éœ€è¦çš„TaskId

RequestId

String

å”¯ä¸€è¯·æ±‚ IDï¼Œç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¿”å›ï¼ˆè‹¥è¯·æ±‚å› å…¶ä»–åŸå› æœªèƒ½æŠµè¾¾æœåŠ¡ç«¯ï¼Œåˆ™è¯¥æ¬¡è¯·æ±‚ä¸ä¼šè·å¾— RequestIdï¼‰ã€‚å®šä½é—®é¢˜æ—¶éœ€è¦æä¾›è¯¥æ¬¡è¯·æ±‚çš„ RequestIdã€‚

å¯ä»¥çœ‹åˆ°è¯¥æ¥å£è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªéŸ³é¢‘è€Œæ˜¯ä¸€ä¸ªä»»åŠ¡ ID é‚£ä¹ˆ å°±éœ€è¦é€šè¿‡ä»»åŠ¡ ID å»æŸ¥è¯¢åˆ°æˆ‘ä»¬å¯¹åº”çš„è¯†åˆ«ç»“æœ

### ç»“æœæŸ¥è¯¢

è°ƒç”¨å½•éŸ³æ–‡ä»¶è¯†åˆ«è¯·æ±‚æ¥å£åï¼Œæœ‰å›è°ƒå’Œè½®è¯¢ä¸¤ç§æ–¹å¼è·å–è¯†åˆ«ç»“æœ

> æ³¨æ„ä»»åŠ¡æœ‰æ•ˆæœŸä¸º24å°æ—¶ï¼Œè¶…è¿‡24å°æ—¶çš„ä»»åŠ¡è¯·ä¸è¦å†æŸ¥è¯¢ï¼Œä¸”ä¸è¦ä¾èµ–TaskIdä½œä¸ºä¸šåŠ¡å”¯ä¸€IDï¼Œä¸åŒæ—¥æœŸå¯èƒ½å‡ºç°é‡å¤TaskId  
> âš ï¸ é»˜è®¤æ¥å£è¯·æ±‚é¢‘ç‡é™åˆ¶ï¼š50æ¬¡/ç§’ å¦‚æœéœ€è¦æé«˜è¯·æ±‚é¢‘ç‡é™åˆ¶çš„éœ€æ±‚ï¼Œé‚£å°±è¦æäº¤å·¥å•äº†: [å·¥å•](https://console.cloud.tencent.com/workorder/category)

### æ¥å£è¯·æ±‚è¦æ±‚

å‚æ•°åç§°

å¿…é€‰

ç±»å‹

æè¿°

TaskId

æ˜¯

Integer

ä»CreateRecTaskæ¥å£è·å–çš„TaskIdï¼Œç”¨äºè·å–ä»»åŠ¡çŠ¶æ€ä¸ç»“æœã€‚**æ³¨æ„ï¼šTaskIdæœ‰æ•ˆæœŸä¸º24å°æ—¶ï¼Œè¶…è¿‡24å°æ—¶çš„TaskIdè¯·ä¸è¦å†æŸ¥è¯¢ã€‚** ç¤ºä¾‹å€¼ï¼š4500055927

ä¹Ÿå°±æ˜¯å‰é¢æ‹¿åˆ°çš„ä»»åŠ¡ ID ä¼ é€’è¿‡å»å°±å¯ä»¥è¿”å›è¯­éŸ³è¯†åˆ«ç»“æœäº†

### è¾“å‡ºå‚æ•°

å‚æ•°åç§°

ç±»å‹

æè¿°

Data

[TaskStatus](https://cloud.tencent.com/document/api/1093/37824#TaskStatus)

å½•éŸ³æ–‡ä»¶è¯†åˆ«çš„è¯·æ±‚è¿”å›ç»“æœã€‚ç¤ºä¾‹å€¼ï¼š{ "Response": { "RequestId": "8824366f-0e8f-4bd4-892

RequestId

String

å”¯ä¸€è¯·æ±‚ IDï¼Œç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¿”å›ï¼ˆè‹¥è¯·æ±‚å› å…¶ä»–åŸå› æœªèƒ½æŠµè¾¾æœåŠ¡ç«¯ï¼Œåˆ™è¯¥æ¬¡è¯·æ±‚ä¸ä¼šè·å¾— RequestIdï¼‰ã€‚å®šä½é—®é¢˜æ—¶éœ€è¦æä¾›è¯¥æ¬¡è¯·æ±‚çš„ RequestIdã€‚

æ¥å£æˆ‘ä»¬å·²ç»äº†è§£å®Œæ¯•æ¥å§ä¸€æ ·çš„æ“ä½œ, ä½¿ç”¨ API è°ƒè¯•

### å½•éŸ³æ–‡ä»¶è¯†åˆ«æ¥å£ API è°ƒè¯•

ç‚¹å‡»è°ƒè¯•, æˆ‘ä»¬ç›´æ¥é€‰æ‹©å½•éŸ³æ–‡ä»¶è¯†åˆ«è¯·æ±‚, å¡«å†™å­—æ®µæ•°æ®

`EngineModelType` æˆ‘ä»¬æ¥å…¥çš„æ˜¯ä¸­æ–‡æ ¹æ®æè¿°å¡«å…¥ `16_zh` å³å¯

`ChannelNum` ç”¨äºè¯†åˆ«éŸ³é“æ•°æ ¹æ®æè¿°ç›´æ¥å¡«å…¥ `1` å³å¯

`ResTextFormat` è¯†åˆ«ç»“æœè¿”å›æ ·å¼ æˆ‘ä»¬ç›´æ¥é€‰æ‹© 0ï¼šåŸºç¡€è¯†åˆ«ç»“æœ, æˆ‘ä»¬éœ€æ±‚åªæ˜¯ç”¨äºå¯¹è¯è¯†åˆ«, å¦‚æœç”¨åœ¨å­—å¹•ä¸Šé¢å°±éœ€è¦ é€‰æ‹© 3 äº†

`SourceType` éŸ³é¢‘æ•°æ®æ¥æºåé¢æˆ‘æ˜¯ç›´æ¥é€šè¿‡å‰ç«¯è½¬ base64 ç»™åç«¯åˆ™é€‰æ‹©ä½¿ç”¨ post body ä¼ é€’å‚æ•°

`Data` éŸ³é¢‘æ•°æ®base64ç¼–ç  å½“ `SourceType` å€¼ä¸º 1 æ—¶é¡»å¡«å†™è¯¥å­—æ®µï¼Œä¸º 0 æ—¶ä¸éœ€è¦å¡«å†™

> âš ï¸ éŸ³é¢‘æ•°æ®è¦å°äº5MBï¼ˆå«ï¼‰, æˆ‘ä»¬é—®ç­”ä¸ä¼šè¶…è¿‡ 1mb å¯¹è¯åé¢ä¼šè®¾ç½®æ—¶é—´çš„ 30s å·®ä¸å¤šäº†

å¡«å…¥ä¸¤ä¸ªå‚æ•°, å¦‚æœæ²¡æœ‰éŸ³é¢‘é‚£å°±å»è¯­éŸ³åˆæˆæä¸€ä¸ªå¥½å§, å°±ä¸å¸¦ç€åŒå­¦æ“ä½œäº†

ç›´æ¥ç‚¹å‡»å‘èµ·è¯·æ±‚å³å¯, è®°å¾—å§ `data:audio/mp3;base64,` åˆ é™¤å“¦è¦ä¸ç„¶ 400 é”™è¯¯

### è°ƒè¯•æ•ˆæœ

æˆåŠŸæ‹¿åˆ°ä»»åŠ¡ ID, ç„¶åå¤åˆ¶ä»»åŠ¡ ID å†å»è¯·æ±‚ä¸€ä¸‹æŸ¥è¯¢æ¥å£å³å¯

æŸ¥è¯¢æˆåŠŸå®Œæˆ

æ¥ä¸‹æ¥ä¸€æ ·çš„æ“ä½œ, å¼€å§‹æ¥å…¥ç¨‹åºå½“ä¸­

### ä»£ç ç¤ºä¾‹

æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å…¥åˆ°ç¨‹åºå½“ä¸­æ“ä½œä¸€éå°± ok å•¦

### ASR ä¾èµ–

è€è§„çŸ©å¼•å…¥ä¾èµ–, åé¢å¯ä»¥ä½¿ç”¨ç”¨æ•´ä½“çš„æ›¿æ¢è¿™ä¸¤ä¸ª

    <!--    è¯­éŸ³è¯†åˆ«    -->
    <dependency>
        <groupId>com.tencentcloudapi</groupId>
        <artifactId>tencentcloud-sdk-java-asr</artifactId>
        <version>3.1.1040</version>
    </dependency>
    

### åˆ›å»ºéŸ³é¢‘è¯†åˆ«æµ‹è¯•ç±»

æ‰“å¼€å‰é¢åˆ›å»ºçš„å·¥ç¨‹æ–°å¢è¯­éŸ³è¯†åˆ«çš„å•å…ƒæµ‹è¯•, å¤šä¸ªç›¸åŒçš„åœ¨è¿™é‡Œç»Ÿä¸€å®ç°

![å•å…ƒæµ‹è¯•å½•éŸ³è¯†åˆ«](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205120115-427203695.png)

    @Test
    void voice2text_1() throws TencentCloudSDKException {
    
    // å®ä¾‹åŒ–ä¸€ä¸ªhttpé€‰é¡¹ï¼Œå¯é€‰çš„ï¼Œæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥è·³è¿‡
    HttpProfile httpProfile = new HttpProfile();
    httpProfile.setEndpoint("asr.tencentcloudapi.com");
    // å®ä¾‹åŒ–ä¸€ä¸ªclienté€‰é¡¹ï¼Œå¯é€‰çš„ï¼Œæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥è·³è¿‡
    ClientProfile clientProfile = new ClientProfile();
    clientProfile.setHttpProfile(httpProfile);
    // å®ä¾‹åŒ–è¦è¯·æ±‚äº§å“çš„clientå¯¹è±¡,clientProfileæ˜¯å¯é€‰çš„
    AsrClient client = new AsrClient(cred, "ap-guangzhou", clientProfile);
    // å®ä¾‹åŒ–ä¸€ä¸ªè¯·æ±‚å¯¹è±¡,æ¯ä¸ªæ¥å£éƒ½ä¼šå¯¹åº”ä¸€ä¸ªrequestå¯¹è±¡
    CreateRecTaskRequest req = new CreateRecTaskRequest();
    req.setEngineModelType("16k_zh");
    req.setChannelNum(1L);
    req.setResTextFormat(0L);
    req.setSourceType(1L);
    StringBuffer stringBuffer = new StringBuffer(
    "//OoVVVVVVVVVV"
        );
        req.setData(stringBuffer.toString());
        // è¿”å›çš„respæ˜¯ä¸€ä¸ªCreateRecTaskResponseçš„å®ä¾‹ï¼Œä¸è¯·æ±‚å¯¹è±¡å¯¹åº”
        CreateRecTaskResponse resp = client.CreateRecTask(req);
        log.info("ä»»åŠ¡ID: {}", resp.getData().getTaskId());
        // å®ä¾‹åŒ–ä¸€ä¸ªè¯·æ±‚å¯¹è±¡,æ¯ä¸ªæ¥å£éƒ½ä¼šå¯¹åº”ä¸€ä¸ªrequestå¯¹è±¡
        DescribeTaskStatusRequest query = new DescribeTaskStatusRequest();
        query.setTaskId(resp.getData().getTaskId());
    
    }
    
    
    
    @Test
    void queryResult() throws Exception {
        // å®ä¾‹åŒ–ä¸€ä¸ªhttpé€‰é¡¹ï¼Œå¯é€‰çš„ï¼Œæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥è·³è¿‡
        HttpProfile httpProfile = new HttpProfile();
        httpProfile.setEndpoint("asr.tencentcloudapi.com");
        // å®ä¾‹åŒ–ä¸€ä¸ªclienté€‰é¡¹ï¼Œå¯é€‰çš„ï¼Œæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥è·³è¿‡
        ClientProfile clientProfile = new ClientProfile();
        clientProfile.setHttpProfile(httpProfile);
        // å®ä¾‹åŒ–è¦è¯·æ±‚äº§å“çš„clientå¯¹è±¡,clientProfileæ˜¯å¯é€‰çš„
        AsrClient client = new AsrClient(cred, "ap-guangzhou", clientProfile);
        DescribeTaskStatusRequest query = new DescribeTaskStatusRequest();
        // å¡«å…¥ä»»åŠ¡ID
        query.setTaskId(9365213113L);
        // è¿”å›çš„respæ˜¯ä¸€ä¸ªDescribeTaskStatusResponseçš„å®ä¾‹ï¼Œä¸è¯·æ±‚å¯¹è±¡å¯¹åº”
        DescribeTaskStatusResponse queryRes = client.DescribeTaskStatus(query);
        final String result = JSONUtil.toJsonStr(queryRes);
        log.info("å½•éŸ³æ–‡ä»¶è¯†åˆ«1: {}", result);
    }
    

![ç»“æœ1](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205122972-2141607286.png)

æ‹¿åˆ°ä»»åŠ¡ ID å†å»æ‰§è¡ŒæŸ¥è¯¢å½•éŸ³è¯†åˆ«ç»“æœå¦‚ä¸Šå›¾, è¿™ç§æ–¹å¼æœ‰ç‚¹éº»çƒ¦äº†è¾“å‡ºçš„è¯†åˆ«ç»“æœå¸¦äº† `åŒ…å«æœ‰æ•ˆäººå£°æ—¶é—´æˆ³` è¿˜è¦è°ƒä¸¤ä¸ªæ¥å£, æ¥ä¸‹æ¥ä»‹ç»å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆ,ä¸€ä¸ªæ¥å£æå®šä¹Ÿç¬¦åˆæˆ‘ä»¬çš„ä¸šåŠ¡å°±æ˜¯è¦æé€Ÿ!!!

å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆ
---------

æé€Ÿç‰ˆå’Œæ™®é€šç‰ˆæœ¬æ˜¯å·®ä¸å¤šä¸€æ ·çš„ å‰å¾€æé€Ÿç‰ˆæ–‡æ¡£æŸ¥çœ‹è¯·æ±‚å‚æ•°: [è¯­éŸ³è¯†åˆ« å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆ-API æ–‡æ¡£-æ–‡æ¡£ä¸­å¿ƒ-è…¾è®¯äº‘](https://cloud.tencent.com/document/product/1093/52097)

> æé€Ÿç‰ˆæœ¬æ˜¯æ²¡æœ‰ API è°ƒè¯•çš„æ‰€ä»¥è…¾è®¯äº‘å‡†å¤‡äº† demo æ¡ˆä¾‹æˆ‘ä»¬ç›´æ¥ copy

ç®€å•çœ‹ä¸€ä¸‹æ–‡æ¡£çš„å„ä¸ªå‚æ•°

å¾€ä¸‹æ»‘æ‰¾åˆ° Java æ¡ˆä¾‹ ç‚¹å‡»è·å–ä»£ç 

è·³è½¬åˆ° github ä»“åº“ç›´æ¥ cv æ¡ˆä¾‹åˆ°æˆ‘ä»¬å·¥ç¨‹å½“ä¸­, å¯¹åº”çš„æé€Ÿç‰ˆæœ¬çš„ä¾èµ–æ˜¯å¦å¤–çš„åœ¨ pom å½“ä¸­è·å–

    <!-- https://mvnrepository.com/artifact/com.tencentcloudapi/tencentcloud-speech-sdk-java -->
    <dependency>
        <groupId>com.tencentcloudapi</groupId>
        <artifactId>tencentcloud-speech-sdk-java</artifactId>
        <!--å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬-->
        <version>1.0.44</version>
    </dependency>
    

### å‘èµ·è°ƒè¯•

æŠŠå¯†é’¥å‚æ•°å…¨éƒ¨å¡«å†™å®Œæ¯•å, åœ¨æ ¹æ®å‰é¢çš„éŸ³é¢‘éšä¾¿ä¸‹è½½ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶, ç›´æ¥å‘èµ·

å¯ä»¥çœ‹åˆ°ç›´æ¥è¯†åˆ«å‡ºæ¥äº†æ–‡æœ¬ä¸éœ€è¦è°ƒç”¨ä¸¤ä¸ªæ¥å£, ä¹Ÿå¯ä»¥æ§åˆ¶è¯çº§åˆ«æ—¶é—´æˆ³, è¿”å›æ•°æ®éå¸¸å¿«

è¿™æ ·å­å°±å·²ç»æˆåŠŸ, è¿˜å‰©ä¸‹æœ€åä¸€ä¸ª `å®æ—¶è¯­éŸ³è¯†åˆ«`

å®æ—¶è¯­éŸ³è¯†åˆ«
------

å®æ—¶è¯­éŸ³è¯†åˆ«, å¦‚æœæ˜¯æœåŠ¡ç«¯å¯¹æ¥é‚£ä¹ˆå°±éœ€è¦å’Œå‰ç«¯æ­é… web socket è¿›è¡ŒåŒå‘é“¾æ¥, å¤šæ­¤ä¸€ä¸¾æˆ‘è¿™é‡Œå°±ä½¿ç”¨å‰ç«¯æ¥æ“ä½œ

å‰å¾€å®æ—¶è¯­éŸ³è¯†åˆ«æ–‡æ¡£ [è¯­éŸ³è¯†åˆ« å®æ—¶è¯­éŸ³è¯†åˆ«(websocket)-API æ–‡æ¡£-æ–‡æ¡£ä¸­å¿ƒ-è…¾è®¯äº‘](https://cloud.tencent.com/document/product/1093/48982)

ç‚¹å‡» JS ç¤ºä¾‹ æ‹‰ä¸‹æ¥æ•´ä¸ªå·¥ç¨‹

å…‹éš†åœ°å€: git clone [https://github.com/TencentCloud/tencentcloud-speech-sdk-js.git](https://github.com/TencentCloud/tencentcloud-speech-sdk-js.git)

![æ‹‰å–æ¡ˆä¾‹](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113221-1962310488.png)

å·¥ç¨‹æ‹‰ä¸‹æ¥åç›´æ¥ npm i æ‰§è¡Œä¸€ä¸‹ ä¸‹è½½å‰ç«¯çš„ä¾èµ–

![demoæ¡ˆä¾‹](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113416-863873744.png)

æ‰§è¡Œå®Œæ¯•å, å¡«å…¥å¯†é’¥å‚æ•°, ç„¶åæ‰§è¡Œ `npm run dev` å¯åŠ¨å·¥ç¨‹

![é…ç½®æ–‡ä»¶](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205105234-1502785762.png)

å·¥ç¨‹å¯åŠ¨æˆåŠŸ, å¼€å¯è¯†åˆ«è¿›è¡Œå®æ—¶å¯¹è¯æµ‹è¯•çœ‹çœ‹æ˜¯å¦æ‰“é€š

![å®æ—¶è¯­éŸ³è¯†åˆ« 1](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205119234-767749553.png)

è¿›è¡Œè¯´è¯å°†ä¼šæé€Ÿçš„è¾“å‡ºæ–‡æœ¬ä¿¡æ¯å¾ˆæµç•…

![å®æ—¶è¯­éŸ³è¯†åˆ« 2](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205114289-2102483168.gif)

åˆ°æ­¤, æˆ‘ä»¬çš„è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆå·²ç»å…¨éƒ¨å­¦ä¼šäº†, æ¥ä¸‹æ¥å°±è¦å¼€å§‹æˆ‘ä»¬çš„é¡¹ç›®å®æˆ˜å·©å›ºçŸ¥è¯†ç‚¹çš„ä½¿ç”¨æƒ…å†µäº†, éƒ½çœ‹åˆ°è¿™é‡Œäº†ä¸è¦å¿˜è®°ç»™ä¸æ˜“ä¸€é”®ä¸‰è¿.

æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯­éŸ³æŠ€æœ¯åŠŸèƒ½å°è£…ä¸€ä¸‹,ä¸ºäº†é¡¹ç›®å®æˆ˜æ‰“åŸºç¡€ç›´æ¥è°ƒç”¨å°±è¡Œ.

å°è£…è¯­éŸ³ç³»ç»Ÿå·¥å…·ç±»
=========

å°†ä¸åŒçš„åŠŸèƒ½åˆ†åˆ«å°è£…åˆ°ä¸åŒçš„å·¥å…·ç±»å½“ä¸­, å½•éŸ³æ–‡ä»¶è¯†åˆ«æ™®é€šç‰ˆæœ¬æˆ‘å°±æ²¡å°è£…äº†æˆ‘ç”¨ä¸åˆ°, è¿™é‡Œæˆ‘å°±å°è£…äº†æé€Ÿç‰ˆå’Œè¯­éŸ³åˆæˆ

### æ–°å¢è…¾è®¯é…ç½®æ–‡ä»¶ç±»

åœ¨å¯åŠ¨ç±»åŒçº§åˆ«ç›®å½•æ–°å¢ `config`æ–‡ä»¶å¤¹,æ–°å¢ `TencentConfig` ç”¨äºé…ç½®å¯†é’¥ä¿¡æ¯, ä¸‹é¢ä»£ç å®šä¹‰äº† instance ç”¨äºåœ¨é™æ€æ–¹æ³•å½“ä¸­ä¹Ÿå¯è°ƒç”¨

![é…ç½®æ–‡ä»¶](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205118790-487917086.png)

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.config;
    
    import jakarta.annotation.PostConstruct;
    import lombok.Data;
    import lombok.Getter;
    import org.springframework.boot.context.properties.ConfigurationProperties;
    import org.springframework.stereotype.Component;
    
    
    /**
     * è…¾è®¯é…ç½®
     *
     * @author Yang Shuai
     * Create By 2024/06/14
     */
    @Data
    @Component
    @ConfigurationProperties(prefix = "tencent", ignoreInvalidFields = true)
    public class TencentConfig {
    
        private String appId;
        private String secretId;
        private String secretKey;
        @Getter
        private static TencentConfig instance;
        /**
         * è¦åœ¨é™æ€æ–¹æ³•é‡Œé¢è°ƒç”¨IOCå®¹å™¨çš„beanå¯¹è±¡
         * PostConstruct åœ¨æ„é€ å‡½æ•°æ‰§è¡Œä¹‹åæ‰§è¡Œã€‚
         * å¯ä»¥æ–¹ä¾¿çš„æŠŠæ³¨å…¥çš„beanå¯¹è±¡ç»™åˆ°é™æ€å±æ€§
         * æºç ï¼š AutowiredAnnotationBeanPostProcessor çš„ buildAutowiringMetadata å‡½æ•°
         * ç»•è¿‡äº†é™æ€ä¸è¿›è¡Œæ³¨å…¥
         */
        @PostConstruct
        public void init() {
            instance = this;
        }
    
    }
    

ä¿®æ”¹é…ç½®æ–‡ä»¶,å¡«å…¥å¯†é’¥ä¿¡æ¯

![å¯†é’¥](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115888-1026123953.png)

### ç¼–å†™è¯­éŸ³è¯†åˆ«å·¥å…·ç±» ASR

åœ¨å¯åŠ¨ç±»åŒçº§åˆ«ç›®å½•æ–°å¢ utils æ–‡ä»¶å¤¹,æ–°å¢ `AsrUtils` ç±», é‡Œé¢å°±åŒ…å«ä¸€ä¸ªå½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆ, å¦‚æœè¦é›†æˆæ™®é€šç‰ˆæœ¬åœ¨è¿™é‡Œäº›å³å¯

ä»£ç å°±æ˜¯åˆå§‹åŒ–å‡­è¯å’Œè¯·æ±‚å‚æ•°å·¥æ•´è§„èŒƒ

![è¯­éŸ³è¯†åˆ«å·¥å…·ç±»](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205123026-2112965927.png)

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.utils;
    
    
    import com.tencent.SpeechClient;
    import com.tencent.asr.model.Credential;
    import com.tencent.asr.model.FlashRecognitionRequest;
    import com.tencent.asr.model.FlashRecognitionResponse;
    import com.tencent.asr.service.FlashRecognizer;
    import com.yby6.agent.agentserver.config.TencentConfig;
    import lombok.extern.slf4j.Slf4j;
    import org.springframework.web.multipart.MultipartFile;
    
    import java.math.BigDecimal;
    import java.math.RoundingMode;
    
    
    /**
     * å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆæœ¬ - å·¥å…·ç±»
     *
     * @author Yang Shuai
     * Create By 2024/06/14
     */
    @Slf4j
    public class AsrUtils {
        private static final Credential credential = initCredential();
        private static final FlashRecognizer recognizer = initRecognizer();
        private static final FlashRecognitionRequest recognitionRequest = initRecognitionRequest();
    
        /**
         * åˆå§‹åŒ–å‡­è¯
         *
         * @return {@link Credential}
         */
        private static Credential initCredential() {
            TencentConfig instance = TencentConfig.getInstance();
            return Credential.builder()
                    .secretId(instance.getSecretId())
                    .secretKey(instance.getSecretKey())
                    .build();
        }
    
        /**
         * åˆå§‹åŒ–è¯†åˆ«å™¨
         *
         * @return {@link FlashRecognizer}
         */
        private static FlashRecognizer initRecognizer() {
            TencentConfig instance = TencentConfig.getInstance();
            return SpeechClient.newFlashRecognizer(instance.getAppId(), credential);
        }
    
        /**
         * åˆå§‹åŒ–è¯†åˆ«è¯·æ±‚
         *
         * @return {@link FlashRecognitionRequest}
         */
        private static FlashRecognitionRequest initRecognitionRequest() {
            FlashRecognitionRequest request = FlashRecognitionRequest.initialize();
            request.setEngineType("16k_zh"); // å¼•æ“ç±»å‹
            request.setFirstChannelOnly(1); // å•å£°é“
            request.setVoiceFormat("ogg-opus"); // è¯­éŸ³æ ¼å¼
            request.setSpeakerDiarization(0); // è¯´è¯äººåˆ†ç¦»
            request.setFilterDirty(0); // è¿‡æ»¤è„è¯
            request.setFilterModal(0); // è¿‡æ»¤è¯­æ°”è¯
            request.setFilterPunc(0); // è¿‡æ»¤æ ‡ç‚¹
            request.setConvertNumMode(1); // æ•°å­—è½¬æ¢
            request.setWordInfo(1); // è¯çº§åˆ«ç»“æœ
            return request;
        }
    
    
        /**
         * è¯­éŸ³è½¬æ–‡æœ¬å¿«é€Ÿç‰ˆ
         *
         * @param data è¯­éŸ³æ–‡ä»¶æµ
         * @return {@link FlashRecognitionResponse}
         */
        public static FlashRecognitionResponse voiceToTextSpeedEdition(MultipartFile data) {
            try {
                FlashRecognitionResponse recognize = recognizer.recognize(recognitionRequest, data.getBytes());
                Long audioDuration = recognize.getAudioDuration();
                // audioDuration  å››èˆäº”å…¥è®¡ç®— ä¸ä¿ç•™å°æ•° æ­£æ•°
                BigDecimal videoDuration = BigDecimal.valueOf(audioDuration)
                        .divide(BigDecimal.valueOf(1000), 0, RoundingMode.HALF_UP);
                recognize.setAudioDuration(videoDuration.longValue());
                return recognize;
            } catch (Exception e) {
                log.error("å½•éŸ³æ–‡ä»¶è¯†åˆ«æé€Ÿç‰ˆè¯†åˆ«å¼‚å¸¸: {}", e.getMessage());
                throw new RuntimeException("å½•éŸ³æ–‡ä»¶è¯†åˆ«å¤±è´¥", e);
            }
        }
    
    
    }
    

### ç¼–å†™è¯­éŸ³åˆæˆå·¥å…·ç±» TTS

åœ¨ `utils`åŒ…ä¸‹é¢æ–°å¢ `TtsUtils` ç±», é‡Œé¢å°±åŒ…å«è…¾è®¯äº‘è¯­éŸ³åˆæˆä»£ç ,åˆå§‹åŒ–äº†å‡­è¯,å’Œè¯·æ±‚å®¢æˆ·ç«¯

è¯·æ±‚å‚æ•°æˆ‘è¿™é‡Œå°±å›ºå®šåœ¨è¿™é‡Œ, å› ä¸ºè¿™ä¸ªæ˜¯ä¸ç»å¸¸æ›´æ”¹çš„

![è¯­éŸ³åˆæˆå·¥å…·ç±»](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205121168-1686636046.png)

### æµ‹è¯•å·¥å…·ç±»

åœ¨æ–°å¢å‰è‡ªå®šä¹‰ä¸€ä¸ªå“åº”ä½“è¿”å›ç±»

![å“åº”ä½“è¿”å›ç±»](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205119558-1374736523.png)

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.resp;
    
    import java.io.Serial;
    import java.io.Serializable;
    
    /**
     * å“åº”ä¿¡æ¯ä¸»ä½“
     * @author Yang Shuai
     * Create By 2023/12/10
     */
    public class R<T> implements Serializable {
        /**
         * æˆåŠŸ
         */
        public static final int SUCCESS = 200;
        /**
         * å¤±è´¥
         */
        public static final int FAIL = 500;
        /**
         * å¤±è´¥å¿½ç•¥
         */
        public static final int FAILIGNORE = 201;
        @Serial
        private static final long serialVersionUID = 1L;
        /**
         * æ¶ˆæ¯çŠ¶æ€ç 
         */
        private int code;
    
        /**
         * æ¶ˆæ¯å†…å®¹
         */
        private String msg;
    
        /**
         * æ•°æ®å¯¹è±¡
         */
        private T data;
    
        public static <T> R<T> ok() {
            return restResult(null, SUCCESS, "æ“ä½œæˆåŠŸ");
        }
    
        public static <T> R<T> ok(T data) {
            return restResult(data, SUCCESS, "æ“ä½œæˆåŠŸ");
        }
    
        public static <T> R<T> ok(String msg) {
            return restResult(null, SUCCESS, msg);
        }
    
        public static <T> R<T> ok(String msg, T data) {
            return restResult(data, SUCCESS, msg);
        }
    
        public static <T> R<T> fail() {
            return restResult(null, FAIL, "æ“ä½œå¤±è´¥");
        }
    
        public static <T> R<T> failIgnore() {
            return restResult(null, FAILIGNORE, "æ“ä½œå¤±è´¥");
        }
    
        public static <T> R<T> failIgnore(T data) {
            return restResult(data, FAILIGNORE, "æ“ä½œå¤±è´¥");
        }
    
        public static <T> R<T> fail(String msg) {
            return restResult(null, FAIL, msg);
        }
    
        public static <T> R<T> fail(T data) {
            return restResult(data, FAIL, "æ“ä½œå¤±è´¥");
        }
    
        public static <T> R<T> fail(String msg, T data) {
            return restResult(data, FAIL, msg);
        }
    
        public static <T> R<T> fail(int code, String msg) {
            return restResult(null, code, msg);
        }
    
        public static <T> R<T> check(int row) {
            return row > 0 ? ok() : fail();
        }
    
        public static <T> R<T> check(boolean isTure) {
            return isTure ? ok() : fail();
        }
    
    
        /**
         * è¿”å›è­¦å‘Šæ¶ˆæ¯
         *
         * @param msg è¿”å›å†…å®¹
         * @return è­¦å‘Šæ¶ˆæ¯
         */
        public static <T> R<T> warn(String msg) {
            return restResult(null, 601, msg);
        }
    
        /**
         * è¿”å›è­¦å‘Šæ¶ˆæ¯
         *
         * @param msg  è¿”å›å†…å®¹
         * @param data æ•°æ®å¯¹è±¡
         * @return è­¦å‘Šæ¶ˆæ¯
         */
        public static <T> R<T> warn(String msg, T data) {
            return restResult(data, 601, msg);
        }
    
        private static <T> R<T> restResult(T data, int code, String msg) {
            R<T> r = new R<>();
            r.setCode(code);
            r.setData(data);
            r.setMsg(msg);
            return r;
        }
    
        public static <T> Boolean isError(R<T> ret) {
            return !isSuccess(ret);
        }
    
        public static <T> Boolean isSuccess(R<T> ret) {
            return R.SUCCESS == ret.getCode();
        }
    
        public int getCode() {
            return code;
        }
    
        public void setCode(int code) {
            this.code = code;
        }
    
        public String getMsg() {
            return msg;
        }
    
        public void setMsg(String msg) {
            this.msg = msg;
        }
    
        public T getData() {
            return data;
        }
    
        public void setData(T data) {
            this.data = data;
        }
    }
    

æµ‹è¯•å°è£…çš„å·¥å…·ç±»æ˜¯å¦å¯ä»¥æˆåŠŸè°ƒç”¨, æ–°å¢ `controller`æ¥å£åŒ…, æ–°å¢ `AudioController` æ¥å£

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.controller;
    
    import com.tencent.asr.model.FlashRecognitionResponse;
    import com.yby6.agent.agentserver.resp.R;
    import com.yby6.agent.agentserver.utils.AsrUtils;
    import com.yby6.agent.agentserver.utils.TtsUtils;
    import lombok.RequiredArgsConstructor;
    import org.springframework.web.bind.annotation.PostMapping;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RequestParam;
    import org.springframework.web.bind.annotation.RestController;
    import org.springframework.web.multipart.MultipartFile;
    
    /**
     * éŸ³é¢‘æ§åˆ¶å™¨
     *
     * @author Yang Shuai
     * Create By 2024/06/15
     */
    @RestController
    @RequestMapping("speechSynthesis")
    @RequiredArgsConstructor
    public class AudioController {
    
        /**
         * è¯­éŸ³è½¬æ–‡æœ¬
         *
         * @param audioFile éŸ³é¢‘æ–‡ä»¶
         * @return {@link FlashRecognitionResponse}
         */
        @PostMapping("tencentVoiceToText")
        public R<FlashRecognitionResponse> voiceToText(@RequestParam MultipartFile audioFile) {
            return R.ok(AsrUtils.voiceToTextSpeedEdition(audioFile));
        }
    
        /**
         * æ–‡æœ¬è½¬è¯­éŸ³
         *
         * @param text æ–‡æœ¬
         * @return {@link String}
         */
        @PostMapping("tencentTextToVoice")
        public R<String> textToVoice(@RequestParam String text) {
            return R.ok(TtsUtils.textToVoice(text));
        }
    
    }
    

ä½¿ç”¨è°ƒè¯•å·¥å…·å‘èµ· API è¯·æ±‚, çœ‹ä½ å–œæ¬¢ç”¨ä»€ä¹ˆå·¥å…·æˆ‘è¿™é‡Œå°±ä½¿ç”¨ `ApiFox`

å¦‚æœä½ ä¹Ÿæ˜¯ç”¨çš„ `ApiFox` å¯ä»¥ä¸‹è½½ä¸€ä¸ªæ’ä»¶

ç„¶åå³å‡»æ¥å£ç±», ä¼šå‡ºç° `upload to apifox` è¿™ä¸ªå°†ä¼šè‡ªåŠ¨ç”Ÿæˆ API æ¥å£æ–‡æ¡£

æ¥ç€æ‰“å¼€ `ApiFox å®¢æˆ·ç«¯`ç›´æ¥å‘èµ·è°ƒè¯•

è¯­éŸ³åˆæˆæˆåŠŸ, æ¥ä¸‹æ¥è®¿é—®è¿™ä¸ªéŸ³é¢‘ä¸‹è½½ä¸‹æ¥ç”¨äºæµ‹è¯•è¯­éŸ³è¯†åˆ«, å¯ä»¥çœ‹ä¸‹å›¾æ“ä½œ, éå¸¸å¿«è¯†åˆ«çš„é€Ÿåº¦

è¿™æ ·å­æˆ‘ä»¬å°±å·²ç»å°è£…æˆåŠŸå•¦, éå¸¸çš„èˆ’æœ, æ¥ä¸‹æ¥å°±æ˜¯è¿›å…¥çœŸæ­£çš„é¡¹ç›®å®æˆ˜å¼€å‘é˜¶æ®µ, åœ¨å¼€å‘ä»»ä½•é¡¹ç›®ä¹‹å‰æˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œè®¾è®¡éœ€æ±‚å’ŒåŸå‹

è®¾è®¡-é¡¹ç›®å®æˆ˜-è¯­éŸ³ AI åŠ©æ‰‹
================

æœ¬æ¬¡çš„é¡¹ç›®åœ¨å‰è¨€æ€ç»´å¯¼å›¾å°±å·²ç»æåˆ°è¿‡, å®ç°ä¸€ä¸ªè‡ªå·±çš„æ™ºèƒ½ä½“ AI è¯­éŸ³åŠ©æ‰‹(ç«¥è¯åŒ ), ä¸»é¢˜æ˜¯å°æœ‹å‹çš„æ•…äº‹å±‹.

ä¸‹é¢å°±æ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„åç«¯ä½¿ç”¨ Java è¯­è¨€æ¡†æ¶ä½¿ç”¨ SpringBoot åœ¨å‰é¢æˆ‘ä»¬ä¹Ÿæ­å»ºè¿‡, é‚£ä¹ˆå‰ç«¯ä¸€å¦‚æ—¢å¾€çš„ä½¿ç”¨ Vue æ¡†æ¶ + Element Plus ç»„ä»¶åº“.

æ™ºèƒ½ä½“å°±é€‰æ‹©ä½¿ç”¨è…¾è®¯å…ƒå™¨,åˆ©ç”¨å…ƒå™¨ Agent å¹³å°å¯ä»¥åˆ¶ä½œå‡ºä¸“å±çš„ AI å¹¶ä¸”å…è´¹æä¾›ä¸€ä¸ªäº¿çš„ API ä½¿ç”¨é¢åº¦, æ€ä¹ˆç”¨çš„å®Œ?

é‚£ä¹ˆåºŸè¯ä¸å¤šè¯´å¼€å§‹æ‰“é€  ç©è½¬ AI æ–°å£°æ€, æ‰“é€ è‡ªå·±çš„AIåŠ©æ‰‹ !!!

![ç©è½¬AIæ–°å£°æ€](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205111300-153024081.png)

é¡¹ç›®æ•´ä½“æ‰§è¡Œæµç¨‹å›¾
---------

æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å‘è¦å¼€å‘çš„é¡¹ç›®æµç¨‹æ“ä½œå›¾æˆ‘å·²ç»ç”»å¥½äº†, éå¸¸çš„ç®€å•, ç”¨æˆ·å®æ—¶å¯¹è¯è¿›è¡Œå‘é€é—®ç­”è¯·æ±‚è°ƒç”¨é—®ç­”æ¥å£è§£ææ–‡æœ¬ or éŸ³é¢‘æ–‡ä»¶,æ¥ç€è°ƒç”¨ yuanqi-sdk-java çš„å®ç° api, æ‹¿åˆ°ç»“æœè¿›è¡Œè¯­éŸ³åˆæˆä¸€èµ·è¿”å›ç»™å‰ç«¯æ˜¾ç¤º

åœ¨å¯åŠ¨é¡¹ç›®ä¹‹å‰éƒ½éœ€è¦äº§å“æ¥ç”»ä¸€ä¸ªåŸå‹æ‰“ä¸ªè‰ç¨¿è¦æ€ä¹ˆåš?

å‰ç«¯åŸå‹è‰ç¨¿
------

æˆ‘å¿«é©¬åŠ é­åŠ¨ç”¨å¤§è„‘æƒ³å‡ºäº†ä¸‹é¢çš„è‰ç¨¿å›¾, é¦–å…ˆæ˜¯ç”¨æˆ·æŒ‰ä½è¿›è¡Œå¯¹è¯(å®æ—¶è¯†åˆ«æˆ–è€…å½•éŸ³è¯†åˆ«)ã€è½¬æ–‡æœ¬åœ¨æ ¹æ®æ–‡æœ¬è¯·æ±‚æ™ºèƒ½ä½“ AI æ‹¿åˆ°é—®ç­”ç»“æœ, æ‹¿åˆ°ç»“æœåè°ƒç”¨è¯­éŸ³åˆæˆå‡ºéŸ³é¢‘ä¸€åŒè¿”å›ç»™å‰ç«¯

å‰ç«¯å¯ä»¥æ’­æ”¾éŸ³é¢‘è®²è¿°ç»“æœ, ä¹Ÿå¯ä»¥ç›´æ¥çœ‹ç»“æœå¹¶ä¸”ä¸ºæµè¯•æ•ˆæœ

åŠŸèƒ½:

1.  æŒ‰ä½è¯´è¯ å‘èµ·è¯­éŸ³è¯†åˆ«
2.  æ¶ˆæ¯å“åº”å®Œæ¯•å‰ç«¯è‡ªåŠ¨æ’­æ”¾éŸ³é¢‘å’Œç»“æœ
3.  æ”¯æŒä¸‹æ»‘å–æ¶ˆé—®ç­”

é‚£ä¹ˆç®€å•çœ‹å®Œè‰ç¨¿æˆ‘ç»™åŒå­¦ä»¬æ¼”ç¤ºæ•´ä½“é¡¹ç›®,åœ¨å†™æ–‡ç« ä¹‹å‰æˆ‘å°±å·²ç»æŠŠé¡¹ç›®å®Œæˆ,ç»™å¤§å®¶æ¼”ç¤ºæ¼”ç¤ºæ•ˆæœçŸ¥é“è¦åšäº›ä»€ä¹ˆ

> 

![ä½ è¯´å¥å®è¯](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205107734-1357413250.png)

çœ‹å®Œæ¼”ç¤ºå°±è¦å¼€å§‹é¡¹ç›®å®æˆ˜é˜¶æ®µ, å¯ä¸æ˜¯ä»é›¶å¼€å§‹äº†å¾ˆå¤šåŸºç¡€çš„æˆ‘å°±ä¸è¯¦ç»†è¯´æ˜, éš¾ç‚¹æˆ‘éƒ½ä¼šä¸€ä¸€åˆ—ä¸¾å‡ºæ¥çš„å¼€å§‹ç©è½¬ AI æ–°å£°æ€å§

å®è·µ-é¡¹ç›®å®æˆ˜-æ¥å£å¼€å‘
============

åœ¨å‰é¢æˆ‘ä»¬å·²ç»å®Œæˆäº†è¯­éŸ³æŠ€æœ¯çš„å°è£…, ç°åœ¨å°±è¦å¼€å‘é—®ç­”æ¥å£, æ­¤æ¥å£æˆ‘æ‰“ç®—å°†å‰ç«¯çš„ `å®æ—¶è¯­éŸ³è¯†åˆ«` å’Œ `å½•éŸ³æ–‡ä»¶è¯†åˆ«` éƒ½ç”¨è¿™ä¸ªæ¥å£æ¥å®Œæˆé—®ç­”æ“ä½œ, é‚£ä¹ˆ `å‰ç«¯å¯èƒ½ä¼ é€’çš„æ•°æ®` å¦‚ä¸‹:

1.  å½•éŸ³æ–‡ä»¶æé€Ÿç‰ˆè¯†åˆ«: ä¼ é€’çš„æ˜¯éŸ³é¢‘æ–‡ä»¶æµ Blob è¿™ä¸ªåç«¯å°±éœ€è¦ç”¨ `MultipartFile`æ¥è¿›è¡Œæ¥æ”¶
2.  å®æ—¶è¯­éŸ³è¯†åˆ«: ä¼ é€’æ˜¯æ–‡æœ¬,åœ¨å‰é¢çš„å®æ—¶è¯­éŸ³è¯†åˆ« demo æˆ‘ä»¬å°±å·²ç»çœ‹åˆ°

é‚£ä¹ˆé—®é¢˜æ¥äº†, æˆ‘æ¥å£å¯èƒ½ä¼ é€’ blob ä¹Ÿå¯èƒ½ä¼ é€’æ–‡æœ¬ æ¥å£æ¥æ”¶æ˜¯ä¸æ˜¯ä¸æ–¹ä¾¿, æ‰€ä»¥æˆ‘æäº†ä¸ªè§£å†³æ–¹æ¡ˆå¾ˆèˆ’æœçš„ç”¨ä¸€ä¸ªå­—æ®µè§£å†³, é‚£ä¹ˆè§£å†³æ–¹æ¡ˆå¦‚ä¸‹:

1.  å½•éŸ³æ–‡ä»¶æé€Ÿç‰ˆè¯†åˆ«: ä¼ é€’çš„æ˜¯éŸ³é¢‘æ–‡ä»¶æµ Blob , é‚£ä¹ˆæˆ‘å°±åœ¨å‰ç«¯è½¬æ¢ä¸º Base64 çš„å­—ç¬¦é‚£ä¹ˆåç«¯åœ¨è½¬æé€Ÿç‰ˆéœ€è¦çš„ byte æ•°ç»„æ•°æ®å³å¯
2.  å®æ—¶è¯­éŸ³è¯†åˆ«: ä¼ é€’æ˜¯æ–‡æœ¬,åœ¨å‰é¢çš„å®æ—¶è¯­éŸ³è¯†åˆ« demo æˆ‘ä»¬å°±å·²ç»çœ‹åˆ°

æ•´ä½“æµç¨‹å›¾å¦‚ä¸‹;

![èšåˆæ¥å£](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205108027-1763107062.png)

å¼€å‘èšåˆé—®ç­”æ¥å£
--------

æ–°å¢ `ChatCompletionController` æ§åˆ¶å™¨

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.controller;
    
    import com.yby6.agent.agentserver.req.ChatYuanQiRequestVo;
    import com.yby6.agent.agentserver.resp.ChatYuanQiRequestDto;
    import com.yby6.agent.agentserver.resp.R;
    import com.yby6.agent.agentserver.service.AudioService;
    import lombok.RequiredArgsConstructor;
    import org.springframework.web.bind.annotation.RequestBody;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RequestMethod;
    import org.springframework.web.bind.annotation.RestController;
    import org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter;
    
    /**
     * å¤šæ™ºèƒ½ä½“é—®ç­”
     *
     * @author Yang Shuai
     * Create By 2024/6/19
     */
    @RestController
    @RequestMapping("v1")
    @RequiredArgsConstructor
    public class ChatCompletionController {
    
        // .. æ¥å£
    
    }
    

### æ–°å¢èšåˆ vo

ç”¨äºæ¥æ”¶å‰ç«¯ä¼ é€’çš„æ•°æ®, ç›®å‰æˆ‘ä»¬åªéœ€è¦çœ‹ `audioFile`å­—æ®µ, å…¶ä»–ä¸¤ä¸ªæ˜¯ä¸ºäº†ä»¥åæ‰©å±•åŠŸèƒ½ä½¿ç”¨å…ˆæš‚å­˜åœ¨è¿™é‡Œ.

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.req;
    
    
    import com.yby6.yuanqi.sdk.domain.yuanqi.Message;
    import lombok.AllArgsConstructor;
    import lombok.Builder;
    import lombok.Data;
    import lombok.NoArgsConstructor;
    
    import java.io.Serializable;
    import java.util.List;
    
    /**
     * å…ƒå™¨è¯·æ±‚å‚æ•°
     *
     * @author yangs
     * @date 2024/06/17
     */
    @Data
    @Builder
    @NoArgsConstructor
    @AllArgsConstructor
    public class ChatYuanQiRequestVo implements Serializable {
    
        
        /**
         * åŠ©ç†id
         */
        private String assistantId;
        
        /**
         * Base64éŸ³é¢‘æ•°æ® or æ–‡æœ¬
         */
        private String audioFile;
        
        /**
         * å¤šæ¨¡æ€ - é—®é¢˜æè¿°
         */
        private List<Message> messages;
    }
    

### æ–°å¢è¿”å›å“åº” dto

ç”¨äºè¿”å›ç»™å‰ç«¯å›ºå®šæ ¼å¼çš„å“åº”ä½“æ•°æ®, æœºå™¨äººè¯­éŸ³ã€ç”¨æˆ·çš„æ¶ˆæ¯ã€æœºå™¨äººé—®ç­”æ¶ˆæ¯

æ¥å£çš„æ­å»º, Java åŒå­¦éƒ½çŸ¥é“ä¸€èˆ¬åœ¨ SpringBoot ä½“ç³»æ˜¯è¦ä¸‰å±‚çš„ å…¶ä¸­ service å±‚å°±æœ‰ serviceã€impl æ¥å£å’Œå®ç°å±‚,æˆ‘è¿™é‡Œå°±æ²¡æœ‰å» impl å®ç°å±‚ç›´æ¥å¼•ç”¨æ¥å£å±‚ç®€æ´ä¸€ä¸¢ä¸¢è‡ªå·±é¡¹ç›®éšä¾¿ææå…¬å¸å¯ä¸èƒ½ä¹±æ¥, è·Ÿç€å…¬å¸è§„èŒƒèµ°.

### åˆ›å»º audioService å®ç°é—®ç­”åŠŸèƒ½

ä¿®æ”¹ `ChatCompletionController` ä»£ç è°ƒç”¨éŸ³é¢‘æœåŠ¡

AudioService å®ç°é—®ç­”åŠŸèƒ½ä¸€å…±ä¸‰ä¸ªæ­¥éª¤

1.  æ ¹æ®å‰ç«¯ä¼ é€’çš„æ•°æ®æ¥åˆ¤æ–­ä¸åŒçš„ä¸šåŠ¡ å‰ç«¯ä¼šä¼ é€’base64çš„å½•éŸ³æ–‡ä»¶æ¥è¯†åˆ« æˆ–è€… ç»è¿‡å®æ—¶è¯­éŸ³è¯†åˆ«çš„æ–‡æœ¬
2.  æ‹¿åˆ°æ–‡æœ¬è°ƒç”¨å…ƒæ°”é—®ç­”
3.  æ‹¿åˆ°å…ƒå™¨é—®ç­”è¿›è¡Œæ•°æ®è¿‡æ»¤æœ€åè¯­éŸ³åˆæˆ
4.  ç»„è£…è¿”å›å“åº”ä½“æ•°æ®

æ ¹æ®å‰ç«¯ä¼ é€’çš„æ•°æ®æ¥åˆ¤æ–­ä¸åŒçš„ä¸šåŠ¡ å‰ç«¯ä¼šä¼ é€’base64çš„å½•éŸ³æ–‡ä»¶æ¥è¯†åˆ« æˆ–è€… ç»è¿‡å®æ—¶è¯­éŸ³è¯†åˆ«çš„æ–‡æœ¬

åˆ¤æ–­æ˜¯å¦å­˜åœ¨ base64 çš„æ•°æ® æˆ‘ä»¬ç›´æ¥æ ¹æ®å‰ç¼€ `data:audio/`å‰ç«¯ä¼ é€’çš„å§‹ç»ˆæ˜¯éŸ³é¢‘æ–‡ä»¶ç›´æ¥æ ¹æ® audio æ¥åˆ¤æ–­å³å¯

ä»£ç å¦‚ä¸‹:

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205118546-470117198.png)

### æ–°å¢ Base64 è½¬ MultipartFile å·¥å…·ç±»

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver.utils;
    
    import cn.hutool.core.codec.Base64Decoder;
    import org.springframework.mock.web.MockMultipartFile;
    import org.springframework.web.multipart.MultipartFile;
    
    /**
     * base64è½¬å¤šéƒ¨åˆ†æ–‡ä»¶
     *
     * @author Yang Shuai
     * Create By 2024/06/19
     */
    public class Base64ToMultipartFile {
    
        /**
         * å°†Base64å­—ç¬¦ä¸²è½¬æ¢ä¸ºMultipartFile
         *
         * @param base64 Base64å­—ç¬¦ä¸²
         * @return MultipartFile
         */
        public static MultipartFile base64ToMultipartFile(String base64) {
            // å»æ‰base64å­—ç¬¦ä¸²çš„å‰ç¼€ï¼ˆå¦‚æœæœ‰ï¼‰
            String[] base64Array = base64.split(",");
            String data = base64Array.length > 1 ? base64Array[1] : base64Array[0];
    
            // è§£ç Base64å­—ç¬¦ä¸²
            byte[] decodedBytes = Base64Decoder.decode(data);
    
            // æ¨æ–­æ–‡ä»¶ç±»å‹ï¼Œå¦‚æœbase64å­—ç¬¦ä¸²æœ‰å‰ç¼€ä¿¡æ¯åˆ™ä½¿ç”¨å‰ç¼€ä¿¡æ¯
            String mimeType = "audio/ogg"; // é»˜è®¤MIMEç±»å‹ä¸ºéŸ³é¢‘æ–‡ä»¶
            if (base64Array.length > 1 && base64Array[0].contains("data:")) {
                String typeInfo = base64Array[0].split(";")[0];
                mimeType = typeInfo.split(":")[1];
            }
    
            // åˆ›å»ºMultipartFileå¯¹è±¡
            return new MockMultipartFile("file", "recording.wav", mimeType, decodedBytes);
        }
    }
    

ç”±äº springboot3.x é‡Œé¢æ²¡æœ‰ spring-mock ä¾èµ–äº† å˜æˆäº† spring-test æ‰€ä»¥æ‰‹åŠ¨å¼•å…¥ä¸€ä¸‹æ¥ä½¿ç”¨

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205109410-976911603.png)

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205105241-320189471.png)

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-test</artifactId>
        <version>6.1.8</version>
    </dependency>
    

å¦‚æœä¸æƒ³å¼•å…¥ä¾èµ–ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œ ç›´æ¥è‡ªå·±å†™ä¸€ä¸ª MockMultipartFile ï¼Œ çœ‹ä½ å–œæ¬¢å“ªä¸ªæ–¹å¼

    package com.yby6.agent.agentserver.utils.file;
    
    import org.springframework.util.FileCopyUtils;
    import org.springframework.web.multipart.MultipartFile;
    
    import java.io.ByteArrayInputStream;
    import java.io.File;
    import java.io.IOException;
    import java.io.InputStream;
    
    
    /**
     * æ¨¡æ‹Ÿå¤šéƒ¨åˆ†æ–‡ä»¶
     *
     * @author yangs
     * @date 2024/06/20
     */
    public class MockMultipartFile implements MultipartFile {
        private final String name;
    
        private final String originalFilename;
    
        private final String contentType;
    
        private final byte[] content;
    
        /**
         * Create a new MultipartFileDto with the given content.
         *
         * @param name    the name of the file
         * @param content the content of the file
         */
        public MockMultipartFile(String name, byte[] content) {
            this(name, "", null, content);
        }
    
        /**
         * Create a new MultipartFileDto with the given content.
         *
         * @param name          the name of the file
         * @param contentStream the content of the file as stream
         * @throws IOException if reading from the stream failed
         */
        public MockMultipartFile(String name, InputStream contentStream) throws IOException {
            this(name, "", null, FileCopyUtils.copyToByteArray(contentStream));
        }
    
        /**
         * Create a new MultipartFileDto with the given content.
         *
         * @param name             the name of the file
         * @param originalFilename the original filename (as on the client's machine)
         * @param contentType      the content type (if known)
         * @param content          the content of the file
         */
        public MockMultipartFile(String name, String originalFilename, String contentType, byte[] content) {
            this.name = name;
            this.originalFilename = (originalFilename != null ? originalFilename : "");
            this.contentType = contentType;
            this.content = (content != null ? content : new byte[0]);
        }
    
        /**
         * Create a new MultipartFileDto with the given content.
         *
         * @param name             the name of the file
         * @param originalFilename the original filename (as on the client's machine)
         * @param contentType      the content type (if known)
         * @param contentStream    the content of the file as stream
         * @throws IOException if reading from the stream failed
         */
        public MockMultipartFile(String name, String originalFilename, String contentType, InputStream contentStream)
                throws IOException {
    
            this(name, originalFilename, contentType, FileCopyUtils.copyToByteArray(contentStream));
        }
    
        @Override
        public String getName() {
            return this.name;
        }
    
        @Override
        public String getOriginalFilename() {
            return this.originalFilename;
        }
    
        @Override
        public String getContentType() {
            return this.contentType;
        }
    
        @Override
        public boolean isEmpty() {
            return (this.content.length == 0);
        }
    
        @Override
        public long getSize() {
            return this.content.length;
        }
    
        @Override
        public byte[] getBytes() throws IOException {
            return this.content;
        }
    
        @Override
        public InputStream getInputStream() throws IOException {
            return new ByteArrayInputStream(this.content);
        }
    
        @Override
        public void transferTo(File dest) throws IOException, IllegalStateException {
            FileCopyUtils.copy(this.content, dest);
        }
    }
    

æé—®æ•°æ®å·²ç»æ‹¿åˆ°æ‰‹,é‚£ä¹ˆå°±è¦å¼€å§‹è°ƒç”¨æˆ‘ä»¬çš„æ™ºèƒ½ä½“, åœ¨å‰é¢æˆ‘ä»¬ä¸€ç›´è¯´æ­å»ºæ™ºèƒ½ä½“é‚£ä¹ˆç°åœ¨æ¥å•¦, å¦‚æœæƒ³è¦ä¸–ç•Œä¸Šæœ€æœ€æœ€æœ€è¯¦ç»†çš„å…ƒå™¨æ•™ç¨‹å‰å¾€: [ç»§ChatGPTçš„çƒ­æ½®AIçš„æ–°äº§ç‰©-æ™ºèƒ½ä½“å…ƒå™¨Agentå¹³å°](https://cloud.tencent.com/developer/article/2423792) , é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥åˆ›å»ºè‡ªå·±ä¸“å±çš„æ™ºèƒ½ä½“ã€Šç«¥è¯åŒ ã€‹

æˆ‘è¿™é‡Œæå‰åˆ›å»ºå¥½äº†ä¸€ä¸ª [ã€Šå°æœ‹å‹çš„æ•…äº‹å±‹ã€‹](https://yuanqi.tencent.com/agent/pCwCLmfl48p7?from=share&shareId=TK5rN7MMKrQy)æ„Ÿå…´è¶£å¯ä»¥ç©ç©

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205106670-669738425.png)

ä¸‹é¢å°±å¼€å§‹æ­å»ºä¸“å±ä½ çš„æ™ºèƒ½ä½“ botï¼Œ æˆ‘ç®€å•æ“ä½œè¦è¯¦ç»†çš„å­¦ä¹ å¿«å»ä¸Šé¢é“¾æ¥

æ­å»ºç«¥è¯åŒ 
-----

å¡«å…¥åç§°ã€ç®€ä»‹ åé¢ç›´æ¥ä½¿ç”¨ AI æ¥ç”Ÿæˆå³å¯, æ’ä»¶ã€å·¥ä½œæµã€çŸ¥è¯†åº“éƒ½ä¸éœ€è¦æˆ‘ä»¬ç°åœ¨åªéœ€è¦æ­å»ºä¸€ä¸ªç®€å•çš„å³å¯åé¢æŒç»­åŠ å¼º,å¦‚æœæƒ³æå‰åŠ å¼ºçœ‹ä¸Šé¢æåˆ°çš„å…ƒå™¨æ•™ç¨‹å³å¯åˆ†åˆ†é’Ÿæˆä¸ºé«˜æ‰‹

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205111759-1440234863.png)

ç„¶åç›´æ¥å‘å¸ƒç«¥è¯åŒ æ™ºèƒ½ä½“,å‘å¸ƒå®Œæ¯•å¯ä»¥åœ¨æˆ‘çš„åˆ›å»ºå½“ä¸­æŸ¥çœ‹åˆ°å¾—è¦ç­‰å¾…å®¡æ ¸æˆåŠŸåæ‰å¯ä»¥è°ƒç”¨ APi æ¥å£, è€å¿ƒç­‰å¾…å‡ åˆ†é’Ÿ

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205109397-2055220434.png)

ç‚¹å‡»è°ƒç”¨ API å”¤å‡º æ™ºèƒ½ä½“ ID ã€tokenã€ç”¨æˆ· ID åœ¨ä»£ç ç¤ºä¾‹é‡Œé¢éœ€è¦ç€ä¸‰ä¸ªä¿å­˜ä¸€ä¸‹

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205114193-1996201391.png)

### è°ƒè¯•ä¸€ä¸‹ API

å¯ä»¥æ­£å¸¸è°ƒç”¨æˆåŠŸæ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¥å…¥ç¨‹åºå½“ä¸­ä½¿ç”¨

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115829-498136443.png)

### ä½¿ç”¨ yuanqi-sdk-java æ¥å…¥å…ƒå™¨

è¯¥ SDK æ˜¯æˆ‘å…­æœˆä»½å¼€å‘çš„è…¾è®¯å…ƒå™¨æ™ºèƒ½ä½“ API Java SDK æ˜¯å¯¹è…¾è®¯å…ƒå™¨æ™ºèƒ½ä½“çš„APIè¿›è¡Œäº†å°è£…ï¼Œæ–¹ä¾¿Javaå¼€å‘è€…æ¥å…¥ç³»ç»Ÿè°ƒç”¨

gitee: [https://gitee.com/yangbuyi/yuanqi-sdk-java](https://gitee.com/yangbuyi/yuanqi-sdk-java)

github: [https://github.com/yangbuyiya/yuanqi-sdk-java](https://github.com/yangbuyiya/yuanqi-sdk-java)

å¤§ä½¬å¯ä»¥æŸ¥çœ‹æä¾›çš„æ¥å…¥æŒ‡å— cv å³å¯å‘èµ·è°ƒç”¨ï¼Œå¡æ‹‰ç±³å°±è·Ÿç€æˆ‘æ¥å§

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112216-1010374816.png)

ä¾èµ–å¸‚åœºæœç´¢ yuanqi-sdk-java

ç‚¹æˆ‘å‰å¾€: [https://mvnrepository.com/artifact/com.yby6.yuanqi/yuanqi-sdk-java/1.3](https://mvnrepository.com/artifact/com.yby6.yuanqi/yuanqi-sdk-java/1.3)

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205118076-210688343.png)

ä¿®æ”¹ agent-servce å·¥ç¨‹ pom æ–‡ä»¶æ·»åŠ å…ƒå™¨ SDK ä¾èµ–

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205111442-409375737.png)

æ¥ç€åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç±»æ¥æµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205121694-1735873331.png)

é—®ç­”ç»“æœå¦‚ä¸‹ï¼š è¾“å‡ºéå¸¸çš„å¿«ï¼Œä¸€ä¸ªæ•…äº‹æˆ‘ä»¬å¯ä»¥å®šä¹‰ 100-200 å·¦å³å°±å¾ˆå®Œç¾

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205108089-2137387690.png)

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver;
    
    import com.yby6.yuanqi.sdk.common.Constants;
    import com.yby6.yuanqi.sdk.domain.yuanqi.Message;
    import com.yby6.yuanqi.sdk.domain.yuanqi.MessageContent;
    import com.yby6.yuanqi.sdk.domain.yuanqi.YuanQiCompletionRequest;
    import com.yby6.yuanqi.sdk.domain.yuanqi.YuanQiCompletionResponse;
    import com.yby6.yuanqi.sdk.session.YuanQiConfiguration;
    import com.yby6.yuanqi.sdk.session.YuanQiSession;
    import com.yby6.yuanqi.sdk.session.defaults.DefaultYuanQiSessionFactory;
    import lombok.extern.slf4j.Slf4j;
    import org.junit.Before;
    import org.junit.Test;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RestController;
    
    import java.util.Collections;
    
    
    /**
     * æ¥å…¥å…ƒå™¨æ™ºèƒ½ä½“API æµ‹è¯•
     *
     * @author Yang Shuai
     * Create By 2024/06/19
     */
    @Slf4j
    public class YuanQiAPI {
        private YuanQiSession yuanQiSession;
    
        @Before
        public void test_YuanQISessionFactory() {
            // 1. é…ç½®æ–‡ä»¶
            YuanQiConfiguration yuanQiConfiguration = new YuanQiConfiguration();
            yuanQiConfiguration.setApiHost("https://yuanqi.tencent.com/openapi/");
            yuanQiConfiguration.setApiKey("Bearer æ™ºèƒ½ä½“TOKEN");
            // 2. ä¼šè¯å·¥å‚
            DefaultYuanQiSessionFactory factory = new DefaultYuanQiSessionFactory(yuanQiConfiguration);
            // 3. å¼€å¯ä¼šè¯
            this.yuanQiSession = factory.openSession();
            log.info("openAiSession:{}", yuanQiSession);
        }
    
        @Test
        public void test_chat_completions() {
            // 1. åˆ›å»ºå‚æ•°
            YuanQiCompletionRequest chatCompletion = YuanQiCompletionRequest
                    .builder()
                    .messages(Collections.singletonList(Message.builder().role(Constants.Role.USER).content(
                            Collections.singletonList(
                                    MessageContent.builder().type(Constants.Type.TEXT)
                                            .text("ä½ æ˜¯è°å‘€?").build()
                            )
                    ).build()))
                    .userId("ç”¨æˆ·ID")
                    .assistantId("æ™ºèƒ½ä½“ID")
                    .stream(false)
                    .build();
            // 2. å‘èµ·è¯·æ±‚
            YuanQiCompletionResponse yuanQiCompletionResponse = yuanQiSession.completions(chatCompletion);
            // 3. è§£æç»“æœ
            yuanQiCompletionResponse.getChoices().forEach(e -> {
                log.info("æµ‹è¯•ç»“æœï¼š{}", e.getMessage());
                log.info("æ¶ˆæ¯: {}", e.getMessage().getContent());
            });
        }
    }
    

### SpringBoot æ¥å…¥ SDK

æ ¹æ® `yuanqi-sdk-java` ä»“åº“çš„ README å½“ä¸­è¯´æ˜çš„å¼•å…¥æ–¹æ³•æˆ‘ä»¬ç›´æ¥å¤åˆ¶åˆ°ç¨‹åºå½“ä¸­

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110030-1907200488.png)

ç„¶åæˆ‘åœ¨å…ƒå™¨å±æ€§å½“ä¸­åŠ äº†å»ºé€ è€…è®¾è®¡æ¨¡å¼ä»£ç ï¼Œæ–¹ä¾¿ç›´æ¥æ„å»ºä¸éœ€è¦åœ¨æ‰‹åŠ¨ new å’Œä¼ é€’ä¸å¿…è¦çš„æ•°æ®ï¼Œåœ¨ä¸€å¼€å§‹å°±å°†æ™ºèƒ½ä½“IDã€ç”¨æˆ· ID ä¼ é€’å®Œæ¯•

`@ConfigurationProperties` è¿™ä¸ªæ³¨è§£å°±ä¸ç”¨å¤šè¯´äº†æ¥æ”¶é…ç½®æ–‡ä»¶çš„æ•°æ®

æ¥ç€çœ‹ `YuanQiSDKConfig` é…ç½®åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ– sdk çš„ä¼šè¯å·¥å‚å¹¶ä¸”ä½¿ç”¨ spring æœºåˆ¶ å¯ç”¨é…ç½®å±æ€§ `@EnableConfigurationProperties` æ³¨è§£æŒ‡å®šæˆ‘ä»¬çš„å±æ€§ç±»å³å¯æ‹¿åˆ°ç›¸å…³æ•°æ®ï¼Œè¿™é‡Œéƒ½åŸºç¡€å°±ä¸è¿‡å¤šè¯´æ˜

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115820-742462372.png)

æ¥ç€ä¿®æ”¹é…ç½®æ–‡ä»¶ yaml å°†å…ƒå™¨çš„å±æ€§å‚æ•°å¡«å…¥, è¿™æ ·å­å°±å®Œæˆäº†æ¥å…¥å…ƒå™¨ SDK

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115549-1800637948.png)

æ¥ç€æˆ‘ä»¬ä¿®æ”¹ `YuanQiAPI`å…ƒå™¨æµ‹è¯•ç±»ï¼Œæ–°å¢ yuanQiSessionã€yuanQiSDKConfigProperties é…ç½®æ¥ç€ä»£ç å½“ä¸­ä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„å»ºé€ è€…å°±ä¸ç”¨è‡ªå·±å†å»è®¾ç½®æ™ºèƒ½ä½“ ID å’Œç”¨æˆ· ID äº†

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205112594-1374313040.png)

    /*
     *  æ‚¨å¯ä»¥æ›´æ”¹æ­¤é¡¹ç›®ä½†è¯·ä¸è¦åˆ é™¤ä½œè€…ç½²åè°¢è°¢ï¼Œå¦åˆ™æ ¹æ®ä¸­åäººæ°‘å…±å’Œå›½ç‰ˆæƒæ³•è¿›è¡Œå¤„ç†.
     *  You may change this item but please do not remove the author's signature,
     *  otherwise it will be dealt with according to the Copyright Law of the People's Republic of China.
     *
     *  yangbuyi Copyright (c) https://yby6.com 2024.
     */
    
    package com.yby6.agent.agentserver;
    
    import com.yby6.agent.agentserver.config.properties.YuanQiSDKConfigProperties;
    import com.yby6.yuanqi.sdk.common.Constants;
    import com.yby6.yuanqi.sdk.domain.yuanqi.Message;
    import com.yby6.yuanqi.sdk.domain.yuanqi.MessageContent;
    import com.yby6.yuanqi.sdk.domain.yuanqi.YuanQiCompletionRequest;
    import com.yby6.yuanqi.sdk.domain.yuanqi.YuanQiCompletionResponse;
    import com.yby6.yuanqi.sdk.session.YuanQiSession;
    import lombok.extern.slf4j.Slf4j;
    
    import org.junit.jupiter.api.Test;
    import org.springframework.boot.test.context.SpringBootTest;
    import org.springframework.beans.factory.annotation.Autowired;
    
    import java.util.Collections;
    
    
    /**
     * æ¥å…¥å…ƒå™¨æ™ºèƒ½ä½“API æµ‹è¯•
     *
     * @author Yang Shuai
     * Create By 2024/06/19
     */
    @Slf4j
    @SpringBootTest
    public class YuanQiAPI {
        
        @Autowired
        private YuanQiSession yuanQiSession;
        @Autowired
        private YuanQiSDKConfigProperties yuanQiSDKConfigProperties;
        
        @Test
        public void test_chat_completions() {
            // 1. åˆ›å»ºå‚æ•°
            YuanQiCompletionRequest chatCompletion = yuanQiSDKConfigProperties.builder()
                    .messages(Collections.singletonList(Message.builder().role(Constants.Role.USER).content(
                            Collections.singletonList(
                                    MessageContent.builder().type(Constants.Type.TEXT)
                                            .text("è®²ä¸€ä¸ªæ˜Ÿé™…ç²¾çµè“å¤šå¤šçš„æ•…äº‹").build()
                            )
                    ).build()))
                    .stream(false)
                    .build();
            // 2. å‘èµ·è¯·æ±‚
            YuanQiCompletionResponse yuanQiCompletionResponse = yuanQiSession.completions(chatCompletion);
            // 3. è§£æç»“æœ
            yuanQiCompletionResponse.getChoices().forEach(e -> {
                log.info("æµ‹è¯•ç»“æœï¼š{}", e.getMessage().getContent());
                log.info("è§’è‰²: {}", e.getMessage().getRole());
            });
        }
    }
    

åˆ°æ­¤æˆ‘ä»¬çš„å…ƒå™¨æ¥å…¥å°±å·²ç»å®Œæ¯•äº†ï¼Œæ¥ä¸‹æ¥ç»§ç»­å¯¹æ¥ `audioService` æ–¹æ³•æŠŠå…ƒå™¨é—®ç­”å®ç°å®Œæ¯•

### å®Œå–„ä¸šåŠ¡

åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»å®Œæˆäº† æ ¹æ®å‰ç«¯ä¼ é€’çš„æ•°æ®æ¥åˆ¤æ–­ä¸åŒçš„ä¸šåŠ¡

ç°åœ¨å®Œæˆä¸€ä¸‹å…ƒå™¨æ™ºèƒ½ä½“é—®ç­”ï¼Œ æ ¹æ®ä¼ é€’è¿‡æ¥çš„æé—®ä¼ é€’ç»™å…ƒå™¨è·å–é—®ç­”ç»“æœ

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205110959-495364807.png)

æœ€åå°±ä¸ç”¨æˆ‘è¯´äº†æ‹¿åˆ°é—®ç­”ç»“æœç›´æ¥è¯­éŸ³åˆæˆï¼Œå¹¶ä¸”ç»„è£…è¿”å›æ•°æ®ç»™åˆ°å‰ç«¯

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205108246-1029422305.png)

æœ€ç»ˆæ•´ä½“ä»£ç ï¼Œ æˆ‘ä»¬å°±å·²ç»å®Œæˆäº†åç«¯çš„é—®ç­”æ¥å£ç¼–å†™æ˜¯ä¸æ˜¯ç®€ç®€å•å•ï¼Ÿ

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113658-339985297.png)

æ¥ä¸‹æ¥æˆ‘ä»¬æ•´ä½“æµ‹è¯•ä¸€ä¸‹å°±å¯ä»¥å¼€å¯å‰ç«¯çš„é¡¹ç›®ä¹‹è·¯äº†

å¯åŠ¨åç«¯å·¥ç¨‹æ‰“å¼€è°ƒè¯•å·¥å…· å‘èµ·èšåˆé—®ç­”æ¥å£è¯·æ±‚ ä¼ é€’ base64 éŸ³é¢‘æ•°æ®æˆ–è€…æ™®é€šæ–‡æœ¬è¿›è¡Œæé—®

è¾“å…¥æ™®é€šæ–‡æœ¬æˆåŠŸçš„é—®ç­”æˆåŠŸå¹¶ä¸”è¿”å›äº†æœºå™¨äººéŸ³é¢‘ã€æœºå™¨äººç»“æœã€ç”¨æˆ·æé—® æ•°æ®æä¾›å‰ç«¯ä½¿ç”¨

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205115337-864594658.png)

æ¥ä¸‹é‡Œæˆ‘ä»¬ä¼ é€’è¿”å›å‡ºæ¥çš„ base64 æ¥è¿›è¡Œæ“ä½œ

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205111481-447003502.png)

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205121630-229190365.png)

æ²¡æœ‰ä»»ä½•é—®é¢˜, ä½¿ç”¨æœºå™¨äººéŸ³é¢‘æ¥æµ‹è¯•èšåˆæ¥å£ä¼ é€’éŸ³é¢‘æ–‡ä»¶å’Œæ™®é€šæ–‡ä»¶çš„ä¸šåŠ¡æµç¨‹æˆåŠŸ, æ˜¯ä¸æ˜¯å¾ˆç®€å•

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205113206-248739520.png)

åˆ°æ­¤æˆ‘ä»¬çš„åç«¯å·¥ç¨‹å°±å·²ç»æ­å»ºå®Œæ¯•, ä½†è¿˜æ²¡å®Œå“¦åé¢ä¼šç»§ç»­æ‰©å±•åŠŸèƒ½, é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å¼€å‘å‰ç«¯å·¥ç¨‹äº†, åŒå­¦ä»¬å†²å†²å†²å•Š

è¿˜æ²¡å®Œéƒ½ç»™æˆ‘ç»§ç»­å­¦
=========

ç”±äºè¶…å‡ºäº†5ä¸‡å­—æ•°é™åˆ¶, æˆ‘è¿™é‡Œéœ€è¦æ–°å¼€ä¸€ç¯‡æ–‡ç« , ç¬¬äºŒç¯‡æ‰æ˜¯é‡ä¸­ä¹‹é‡å…¨æ˜¯åŠŸèƒ½å®ç°åˆ«å¿˜è®°äº†

[ç©è½¬AIæ–°å£°æ€ | ç©è½¬TTS/ASR/YuanQI æ‰“é€ è‡ªå·±çš„AIåŠ©æ‰‹ ç¬¬äºŒç¯‡](https://cloud.tencent.com/developer/article/2430995)
-----------------------------------------------------------------------------------------------

æœ€å
==

æœ¬æœŸç»“æŸå’±ä»¬ä¸‹æ¬¡å†è§ğŸ‘‹~

å…³æ³¨æˆ‘ä¸è¿·è·¯ï¼Œå¦‚æœæœ¬ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæˆ–è€…ä½ æœ‰ä»€ä¹ˆç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¸€èˆ¬çœ‹åˆ°éƒ½ä¼šå›å¤çš„ã€‚å¤§å®¶ç‚¹èµæ”¯æŒä¸€ä¸‹å“Ÿ~ ğŸ’—

![ ](https://img2024.cnblogs.com/blog/1735255/202506/1735255-20250607205109229-326977241.png)

ä½ çš„å‹åŠ›æ¥æºäºæ— æ³•è‡ªå¾‹ï¼Œåªæ˜¯å‡è£…åŠªåŠ›ï¼Œç°çŠ¶è·Ÿä¸ä¸Šå†…å¿ƒæ¬²æœ›ï¼Œæ‰€ä»¥ä½ ç„¦è™‘åˆææ…Œã€‚â€”â€”æ¨ä¸æ˜“