---
layout: post
title: '扣子Coze实战：智能体（Agent）1分钟自动仿写公众号爆文，一键自动发布'
date: "2025-12-13T00:42:03Z"
---
扣子Coze实战：智能体（Agent）1分钟自动仿写公众号爆文，一键自动发布
======================================

大家好，我是汤师爷，专注AI智能体分享，致力于帮助100W人用智能体创富~

你有没有遇到过这样的情况：

*   看到一篇爆文，想改成自己的风格却不知从何下手？
*   每天为公众号内容发愁，想发又怕质量不高？
*   文章改写费时费力，排版更是让人头大？

我今天要分享的Coze智能体工作流，将彻底解决这些问题。

轻松实现一键仿写+自动发布，让你1分钟搞定从文章改写到公众号发布的全流程！

这套工作流非常适合需要快速创作内容的自媒体人，它能显著提升你的内容生产效率。

如下图所示，智能体不仅能生成高质量的公众号爆文，还能直接将文章同步到你的草稿箱。

1.工作流整体流程
---------

1.  获取原文章内容：使用Coze插件从指定URL中提取完整的文章内容，包括标题、正文和图片等元素。
2.  AI分析提取核心观点：AI大模型深入分析原文章的结构和内容，提取出关键观点、论据和写作风格特点。
3.  根据要求改写文章：基于用户输入的具体需求（如受众群体、写作风格、特定观点等），AI对文章进行创造性改写。
4.  生成爆款文案：AI大模型根据前面的分析结果，创作出吸引眼球的爆款文案。
5.  转换成公众号格式：将文本内容转换为公众号支持的HTML格式，添加适当的排版、字体和颜色样式，确保手机端阅读体验良好。
6.  上传封面图片：通过AI大模型生成精美图片，并上传至公众号素材库。一张优质封面图能显著提升文章的吸引力和传播效果。
7.  发布到公众号草稿箱：最后将完整排版的文章和封面图自动提交到公众号后台的草稿箱中，等待创作者最终确认和发布。

2.详细工作流节点
---------

### 2.1 开始节点

开始节点需要4个输入变量：

*   输入：
    *   url：原文章链接（可选）
    *   prompt：改写要求（必填）
    *   appid：公众号AppID（必填）
    *   appsecret：公众号AppSecret（必填）

### 2.2 如何获取公众号AppID和AppSecret？

1.  登录微信公众平台
2.  进入「设置与开发」-「基本配置」
3.  在「公众号开发信息」中找到AppID
4.  点击AppSecret后面的「查看」，扫码后即可获取

### 2.3 文章内容获取

通过【微信公众号API】插件的【extract\_wx\_article】工具，获取对标文章的内容。

*   输入：开始 - url

### 2.4 观点提取

接下来，这里我们使用了一个大模型节点，专门用于分析文章的写作风格和提取核心观点。

大模型\_观点提取节点配置：

*   输入：
    *   title：extract\_wx\_article - title
    *   content：extract\_wx\_article - content
*   系统提示词：根据用户提供文章内容，分析文章的风格和写作方式，提取文章核心观点，最终输出，文章风格、文章摘要、核心观点。
*   用户提示词：{{title}} {{content}}
*   输出变量：
    *   style：写作风格
    *   point：核心观点
    *   abstract：文章摘要

### 2.5 改写文章内容

使用大模型节点，根据提取的观点和用户要求，重新创作文章。

*   输入：
    *   style：大模型\_观点提取 - style
    *   point：大模型\_观点提取 - point
    *   abstract：大模型\_观点提取 - abstract
    *   prompt：开始 - prompt
*   系统提示词

    ##角色：自媒体博主
    作为自媒体作者擅长爆款文案写作，把握读者心里，根据用户给定的主题和题目按要求创作文章，创作一篇文章，文章不少于1200字。
    ##Style:
    1.作者日常观点论述文章，注意文章开头技巧（开篇、调动读者情绪、激发引导读者思考），引发读者阅读兴趣。
    2.开门见山，提出主题和观点，着重引发读者的情感共鸣，以情动人，让读者在阅读中产生强烈的情感体验;
    3.语言风格：个人深度思考风格，简洁的日常表达方式
    4.长短句组合，短句使语言简洁、明快，整句散句结合使语言错落有致，丰富文章的层次和可读性;
    5.段落转折连接，避免使用：首先、其次、最后、总而言之、总之等逻辑连接词，不要使用“繁杂的世界，快节奏的世界，充满变化的世界里”等虚无的形容词。杜绝AI味道
    ##Step：
    1.根据用户提供的标题和观点信息进行创作，文章不少于1200字
    2.深度思考后，构思主题、大纲和内容
    3.创作符合风格和要求的文章
    4.完成文章后，自行审稿和修改润色
    5.最后直接输出文章正文内容，不需要输出标题。
    
    ##内容格式：
    1、使用Markdown语法风格，区分一级、二级、三级标题使用标签“#、##、###”。
    2、文中核心句子使用HTML标签包裹
    <span style="color: rgb(202,88,99); font-weight: bold;" >句子</span>
    3、长短句组合，避免单个句子超过3行。
    
    ##注意事项:
    1.【禁止使用和出现英文、单词】
    2.文章须严格遵循1200字的字数要求,控制篇幅,做到详略得当,避免内容单薄。
    3.杜绝任何抄袭、剽窃等侵权行为,文章内容须为原创,切勿照搬照抄他人作品。
    4.严禁在文章中出现任何违反国家法律法规、社会公序良俗或影响平台形象的不当言论。
    

*   用户提示词：

    参考文章信息如下：
    风格：<{{style}}>
    观点：<{{point}}>
    摘要：<{{abstract}}>
    #额外写作要求
    <{{prompt}}>
    

*   输出：
    *   content：改写后的文章内容

这个节点的系统提示词设计得很巧妙，要求AI：

*   作为自媒体作者擅长爆款文案写作
*   开门见山，引发读者情感共鸣
*   使用长短句组合，避免AI味道
*   文章不少于1200字
*   使用Markdown语法，核心句子用HTML标签突出

### 2.6 生成爆款标题

使用大模型节点，**大模型\_标题**节点专门负责生成吸引人的标题。

*   输入：
    *   content：改写后的文章内容
*   系统提示词：

    # 角色
    你是一位擅长创作爆款标题的助手，能够根据文章内容精准提炼出吸引人的标题
    自媒体写作，标题决定点击率，内容决定转发率。
    ## 技能
    ### 技能 1: 生成爆款标题
    1. 当用户提供文章信息时，仔细分析文章的主题、关键内容和亮点。
    2. 情感词汇用于引起读者情绪波动，核心问题点明文章关键，反常识制造冲击
    长度建议:20-40个字，不可有特殊字符
    标题风格特征总结:
    富有感染力
    强调情感共鸣
    突出问题观点
    简洁有力
    能调动读者情绪
    3.直接返回标题
    ## 限制:
    - 只根据文章信息生成标题，不进行其他无关创作。
    - 直接返回标题，无需其他信息。
    

### 2.7 Markdown转公众号HTML

使用【**markdown 转微信公众号 html**】插件，将Markdown格式的文章转换成公众号支持的HTML格式。

*   输入：
    *   markdown：改写后的文章内容
    *   theme：配色主题
    *   font：字体样式

### 2.8 生成图片

使用【图像生成】插件，生成文章封面图片

### **2.9 获取公众号Access Token**

使用【微信公众号API】插件，【get\_access\_token】工具节点获取公众号API调用凭证。

*   输入：
    *   appid：开始节点的appid
    *   appsecret：开始节点的appsecret

### 2.10 上传封面图片

使用【微信公众号API】插件，【add\_material】工具节点负责上传文章封面图片到公众号素材库。

*   输入：
    *   access\_token：上一步获取的token
    *   image\_url：图片链接地址

### 2.11 文章排版美化

代码\_排版节点会给文章添加公众号头部样式，让文章更美观。

这个节点会在文章顶部添加"点击蓝字，关注我们"的提示，并插入封面图片。

*   输入：
    *   contentHtml：从”md2html“节点中，选择data，这是从markdown转HTML节点输出的数据，包含了完整的文章内容格式化后的HTML代码
    *   imageUrl：从”add\_material“节点中，选择url，这个参数接收的是我们通过前面的图片上传节点获得的图片URL，会作为文章的封面图片使用
    *   headerHtml：这个参数是文章的头部HTML代码，用于添加公众号文章顶部的样式和结构，比如"点击蓝字关注我们"的提示文字、封面图片等。

headerHtml的代码：

    <section style="font-size: 16px;text-align: center;justify-content: center;display: flex;flex-flow: row;margin-top: 10px;margin-bottom: 10px;"class=""><section style="display: inline-block;vertical-align: middle;width: auto;align-self: center;flex: 0 0 auto;min-width: 5%;height: auto;box-sizing:border-box;"><section style="text-align: right;margin-top: 10px;margin-bottom: 10px;line-height: 0;"><section style="vertical-align: middle;display: inline-block;line-height: 0;width: 50px;height: auto;box-sizing:border-box;"><p style="margin-left: 0px; margin-right: 0px;"><img class="rich_pages wxw-img"data-imgfileid="100001574"data-s="300,640"src="https://mmbiz.qpic.cn/sz_mmbiz_png/MVPvEL7Qg0GVeTBgmu2jBFwpXRXOe4Kf7Hfj3INGtpUwRTibBHDicib4rtGLstNjJ5VgOa0qqnRDSOicZ2rLxicB2uQ/640?wx_fmt=png"data-type="png"style="vertical-align: middle;width: 100%;box-sizing:border-box;max-width:100% !important;"data-ratio="0.34869240348692404"data-w="803"/></p></section></section></section><section style="display: inline-block;vertical-align: middle;width: auto;align-self: center;flex: 0 0 auto;border-width: 0px;border-style: none;border-color: #3e3e3e;border-radius: 0px 5px 5px 0px;overflow: hidden;min-width: 5%;height: auto;padding: 5px 15px;box-shadow: #d3f3ed 0px 0px 0px;box-sizing:border-box;"class=""><section style="text-align: justify;color: #3e3e3e;"><p style="text-wrap: wrap; margin-left: 0px; margin-right: 0px;">点击蓝字，关注我们</p></section></section><section style="display: inline-block;vertical-align: top;width: auto;min-width: 5%;flex: 0 0 auto;height: auto;box-sizing:border-box;"><section style="text-align: left;margin-top: 10px;margin-bottom: 10px;line-height: 0;"><section style="vertical-align: middle;display: inline-block;line-height: 0;width: 50px;height: auto;box-sizing:border-box;"class=""><p style="margin-left: 0px; margin-right: 0px;"><img class="rich_pages wxw-img"data-s="300,640"data-type="png"style="vertical-align: middle;width: 100%;box-sizing:border-box;max-width:100% !important;"src="https://mmbiz.qpic.cn/sz_mmbiz_png/MVPvEL7Qg0GVeTBgmu2jBFwpXRXOe4Kf7Hfj3INGtpUwRTibBHDicib4rtGLstNjJ5VgOa0qqnRDSOicZ2rLxicB2uQ/640?wx_fmt=png"data-imgfileid="100001575"data-ratio="0.34869240348692404"data-w="803"/></p></section></section></section></section><section style="font-size: 16px;text-align: center;margin-top: 10px;margin-bottom: 10px;line-height: 0;"><section style="display: inline-block;"class=""><p style="margin-left: 0px; margin-right: 0px;"><img class="rich_pages wxw-img"  src="图片地址" data-type="jpg" style="vertical-align: baseline;box-sizing:border-box;" data-ratio="0.7320754716981132" /></p></section></section><section style="font-size: 16px;text-align: left;justify-content: flex-start;display: flex;flex-flow: row;margin-top: 10px;margin-bottom: 10px;"><section style="display: inline-block;width: auto;vertical-align: middle;align-self: center;flex: 100 100 0%;background-color: rgba(255, 255, 255, 0);height: auto;box-sizing:border-box;"class=""><section style="margin-bottom: 10px;"><section style="background-color: #edc0a9;height: 1px;"><br/></section></section></section></section><section class="_135editor"data-role="paragraph"></section>
    

Python代码：

    import json
    async def main(args: Args) -> Output:
        params = args.params
        headerHtml = params['headerHtml']
        contentHtml = params['contentHtml']
        imageUrl = params['imageUrl']
        headerHtml = headerHtml.replace('图片地址',imageUrl)
        html = headerHtml+contentHtml
    
        ret: Output = {
            "html": html
        }
        return ret
    

*   输出：
    *   html：文章终稿的html代码

### 2.12 发布到草稿箱

使用【微信公众号API】插件，【add\_draft】工具节点将最终的文章发布到公众号草稿箱。

*   输入：
    *   access\_token：API凭证
    *   content：排版后的HTML内容
    *   thumb\_media\_id：封面图片ID
    *   title：文章标题
    *   need\_open\_comment：是否开启评论

### 2.13 获取草稿预览链接

使用【微信公众号API】插件，【get\_draft】工具节点获取草稿的预览链接，方便你查看效果。

### 2.14 结束节点

最终输出草稿预览链接，整个流程完成！

3.总结
----

通过这套工作流，你可以轻松实现：

*   快速提取文章核心观点
*   按自己的风格和需求改写文章
*   自动生成吸引眼球的爆款标题
*   一键发布到公众号草稿箱

整个过程完全自动化，显著提升内容创作效率，特别适合需要持续输出优质内容的自媒体创作者。

在AI时代，掌握这些智能工具就等于抢占了内容创作的快车道。

学会运用AI智能体，让你的创作之路更轻松、更高效！

> 对了，我整理了一份开源的智能体学习手册，爆肝 10 万字，价值 999 元。现在限时开放领取👉：[tangshiye.cn](https://tangshiye.cn) 手慢无。

本文来自博客园，作者：[AI架构师汤师爷](https://www.cnblogs.com/tangshiye/)，转载请注明原文链接：[https://www.cnblogs.com/tangshiye/p/19341825](https://www.cnblogs.com/tangshiye/p/19341825)