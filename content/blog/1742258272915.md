---
layout: post
title: 'Semantic Kerneläººå·¥æ™ºèƒ½ï¼š1ã€ä»DeepSeek APIè°ƒç”¨åˆ°Semantic Kernelé›†æˆï¼šæ·±åº¦è§£æèŠå¤©æœºå™¨äººå¼€å‘å…¨é“¾è·¯'
date: "2025-03-18T00:37:52Z"
---
Semantic Kerneläººå·¥æ™ºèƒ½ï¼š1ã€ä»DeepSeek APIè°ƒç”¨åˆ°Semantic Kernelé›†æˆï¼šæ·±åº¦è§£æèŠå¤©æœºå™¨äººå¼€å‘å…¨é“¾è·¯
======================================================================

å¼•è¨€ï¼šAIæ—¶ä»£ä¸‹çš„èŠå¤©æœºå™¨äººå¼€å‘èŒƒå¼æ¼”è¿›
====================

åœ¨ç”Ÿæˆå¼AIæŠ€æœ¯çˆ†å‘çš„å½“ä¸‹ï¼ŒåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„èŠå¤©æœºå™¨äººå¼€å‘å·²å½¢æˆæ ‡å‡†åŒ–æŠ€æœ¯é“¾è·¯ã€‚æœ¬æ–‡å°†ç»“åˆDeepSeek APIä¸å¾®è½¯Semantic Kernelæ¡†æ¶ï¼Œä»¥C#è¯­è¨€å®æˆ˜æ¼”ç¤ºä»åŸºç¡€APIè°ƒç”¨åˆ°é«˜çº§æ¡†æ¶é›†æˆçš„å®Œæ•´å¼€å‘æµç¨‹ã€‚

ç¯å¢ƒå‡†å¤‡ä¸åŸºç¡€é…ç½®
=========

*   .NET 9 SDK
*   Visual Studio 2022æˆ–VSCode
*   DeepSeek APIå¯†é’¥ [å®˜ç½‘ç”³è¯·](https://platform.deepseek.com/usage)

DeepSeek APIåŸºç¡€è°ƒç”¨
================

DeepSeek APIçš„Endpointåœ°å€ä¸ºï¼š`https://api.deepseek.com/chat/completions`ï¼Œç›¸å…³æ–‡æ¡£å¯æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://api-docs.deepseek.com/zh-cn/api/create-chat-completion)

1.  å•è½®å¯¹è¯å®ç°  
    [ä»£ç ç¤ºä¾‹](https://github.com/huangmingji/DeepSeek.ApiHttpClient/blob/main/src/DeepSeek.ApiHttpClient/DeepSeekClient.cs)

    public async Task<ResponseBody> GetChatMessageContentsAsync(CancellationToken cancellationToken = new CancellationToken())
    {
        var client = new HttpClient();
        var request = new HttpRequestMessage(HttpMethod.Post, _builder.Endpoint);
        request.Headers.Add("Accept", "application/json");
        request.Headers.Add("Authorization", $"Bearer {_builder.ApiKey}");
    
        _body.Stream = false;
        var content = new StringContent(_body.SerializeObject(), null, "application/json");
        request.Content = content;
        var response = await client.SendAsync(request, cancellationToken);
        var responseBody = await response.Content.ReadAsStringAsync(cancellationToken);
        return JsonConvert.DeserializeObject<ResponseBody>(responseBody) ?? new ResponseBody();
    }
    

2.  æµå¼å“åº”å¤„ç†  
    [ä»£ç ç¤ºä¾‹](https://github.com/huangmingji/DeepSeek.ApiHttpClient/blob/main/src/DeepSeek.ApiHttpClient/DeepSeekClient.cs)

    public async IAsyncEnumerable<ResponseBody> GetStreamingChatMessageContentsAsync([EnumeratorCancellation] CancellationToken cancellationToken = new CancellationToken())
    {
        var client = new HttpClient();
        var request = new HttpRequestMessage(HttpMethod.Post, _builder.Endpoint);
        request.Headers.Add("Accept", "application/json");
        request.Headers.Add("Authorization", $"Bearer {_builder.ApiKey}");
        
        _body.Stream = true;
        var content = new StringContent(_body.SerializeObject(), null, "application/json");
        request.Content = content;
        var response = await client.SendAsync(request, cancellationToken);
        var stream = await response.Content.ReadAsStreamAsync(cancellationToken);
        var reader = new StreamReader(stream);
        while (!reader.EndOfStream)
        {
            var line = await reader.ReadLineAsync(cancellationToken);
            if (string.IsNullOrEmpty(line) || line.StartsWith(":")) continue;
            if (line.StartsWith("data: "))
            {
                var jsonData = line["data: ".Length ..];
                if (jsonData == "[DONE]") break;
                yield return JsonConvert.DeserializeObject<ResponseBody>(jsonData) ?? new ResponseBody();
            }
        }
    }
    

Semantic Kernelæ¡†æ¶é›†æˆ
===================

[Semantic Kernel](https://learn.microsoft.com/zh-cn/semantic-kernel/overview/)æ˜¯ä¸€ç§è½»å‹å¼€æºå¼€å‘å·¥å…·åŒ…ï¼Œå¯ç”¨äºè½»æ¾ç”Ÿæˆ AI ä»£ç†å¹¶å°†æœ€æ–°çš„ AI æ¨¡å‹é›†æˆåˆ° C#ã€Python æˆ– Java ä»£ç åº“ä¸­ã€‚ å®ƒå……å½“ä¸€ä¸ªé«˜æ•ˆçš„ä¸­é—´ä»¶ï¼Œå¯å®ç°ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆçš„å¿«é€Ÿäº¤ä»˜ã€‚  
DeepSeek APIä¸Semantic Kernelæ¡†æ¶é›†æˆï¼Œå¯å¿«é€Ÿå®ç°åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„èŠå¤©æœºå™¨äººå¼€å‘ã€‚ç”±äºDeepSeek APIä¸OpenAI APIçš„å…¼å®¹æ€§ï¼Œå› æ­¤DeepSeek APIä¸Semantic Kernelæ¡†æ¶çš„é›†æˆéå¸¸ç®€å•ã€‚åªéœ€ä½¿ç”¨OpenAIçš„è¿æ¥å™¨ï¼Œå³å¯å¿«é€Ÿå®ç°DeepSeek APIä¸Semantic Kernelæ¡†æ¶çš„é›†æˆã€‚

1.  NuGetåŒ…å®‰è£…

    dotnet add package Microsoft.SemanticKernel
    

2.  Semantic Kernelåˆå§‹åŒ–

    var openAIClientCredential = new ApiKeyCredential(apiKey);
    var openAIClientOption = new OpenAIClientOptions
    {
        Endpoint = new Uri("https://api.deepseek.com"),
    
    };
    var builder = Kernel.CreateBuilder()
        .AddOpenAIChatCompletion(modelId, new OpenAIClient(openAIClientCredential, openAIClientOption));
    
    var kernel = builder.Build();
    

3.  èŠå¤©æœºå™¨äººå¼€å‘

    var chatCompletionService = kernel.GetRequiredService<IChatCompletionService>();
    
    Console.WriteLine("ğŸ˜€User >> "+ chatHistory.Last().Content);
    var result = chatCompletionService.GetStreamingChatMessageContentsAsync(
        chatHistory
    );
    Console.Write("ğŸ‘¨Assistant >> ");
    await foreach (var item in result)
    {
        Thread.Sleep(200);
        Console.Write(item.Content);
    }
    

[ä»£ç ç¤ºä¾‹](https://github.com/huangmingji/DeepSeek.ApiHttpClient/blob/main/src/DeepSeek.ApiHttpClient.Demo/Program.cs)