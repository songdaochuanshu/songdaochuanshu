---
layout: post
title: 'ä½¿ç”¨django-crispy-formsç¾åŒ–è¡¨å•UI'
date: "2025-07-20T00:51:01Z"
---
ä½¿ç”¨django-crispy-formsç¾åŒ–è¡¨å•UI
===========================

å‰è¨€
--

æ¬§å…‹ï¼Œç»§ç»­æ¥å†™è¿™ä¸ªä¸­å°é¡¹ç›®è¡ç”Ÿå‡ºæ¥çš„ç³»åˆ—æ–‡ç« 

ä»Šå¤©ä»‹ç»ä¸€ä¸ªå¯ä»¥ç¾åŒ–ç•Œé¢çš„åº“

Django å¼€å‘è®²ç©¶ä¸ªå¿«ï¼Œå¤©ä¸‹æ­¦åŠŸï¼Œå”¯å¿«ä¸ç ´

forms åŠŸèƒ½è‡ªç„¶æ˜¯è¦ç”¨çš„ï¼Œè‡ªå¸¦è¡¨å• UI ç”Ÿæˆå’ŒéªŒè¯ï¼Œå®ç° demo æ—¶éå¸¸æ–¹ä¾¿

ä¹‹å‰æˆ‘åœ¨ DjangoStarter æ¡†æ¶é‡Œå·²ç»å°è£…äº†ä¸€å¥— forms è¡Œä¸ºå’Œæ ·å¼äº†ï¼Œåœ¨ `src/django_starter/contrib/forms` é‡Œ

è¿™å¥—å·²ç»ä¸é”™äº†ï¼Œä¹Ÿæ˜¯ç”¨ TailwindCSS æ¥å®ç°æ ·å¼ï¼ŒæŒºå¥½çœ‹çš„

ä¸è¿‡åœ¨å¼€å‘ä¸­å°é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘å‘ç°äº† django-crispy-forms è¿™ä¸ªåº“ï¼Œæä¾›äº†æ›´å¤šç¾åŒ–è¡¨å• UI çš„çµæ´»æ€§ã€‚

DjangoStarteré‡Œçš„å®ç°
-----------------

å…ˆæ¥çœ‹çœ‹ DjangoStarter æ¡†æ¶çš„å®ç°

     forms
     â”œâ”€ widgets
     â”‚  â”œâ”€ __init__.py
     â”‚  â”œâ”€ multiple_file.py
     â”‚  â””â”€ flowbite_date_picker.py
     â”œâ”€ templates
     â”‚  â””â”€ django_starter
     â”‚     â””â”€ forms
     â”‚        â”œâ”€ widgets
     â”‚        â””â”€ form_template.html
     â”œâ”€ __init__.py
     â”œâ”€ widget_classes.py
     â”œâ”€ mixins.py
     â””â”€ base.py
    

### template

src/django\_starter/contrib/forms/templates/django\_starter/forms/form\_template.html

    {% for field in form %}
        <div>
            <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                   for="{{ field.id_for_label }}">{{ field.label }}</label>
            {{ field }}
            <div class="mt-2 text-sm text-gray-500 dark:text-gray-200">
                {{ field.help_text }}
            </div>
            <div class="mt-2 text-sm text-red-600 dark:text-red-500">
                {{ field.errors }}
            </div>
        </div>
    {% endfor %}
    

### widgets

src/django\_starter/contrib/forms/widgets/flowbite\_date\_picker.py

    from django import forms
    
    class FlowbiteDatePickerWidget(forms.DateInput):
        template_name = 'django_starter/forms/widgets/flowbite_date_picker.html'
    
        def __init__(self, attrs=None, custom_class=''):
            final_attrs = {'class': custom_class}
            if attrs:
                final_attrs.update(attrs)
            super(FlowbiteDatePickerWidget, self).__init__(attrs=final_attrs)
    

src/django\_starter/contrib/forms/widgets/multiple\_file.py

    from django import forms
    
    
    class MultipleFileInput(forms.ClearableFileInput):
        allow_multiple_selected = True
    
    
    class MultipleFileField(forms.FileField):
        def __init__(self, *args, **kwargs):
            kwargs.setdefault("widget", MultipleFileInput())
            super().__init__(*args, **kwargs)
    
        def clean(self, data, initial=None):
            single_file_clean = super().clean
            if isinstance(data, (list, tuple)):
                result = [single_file_clean(d, initial) for d in data]
            else:
                result = [single_file_clean(data, initial)]
            return result
    

### forms ä»£ç 

src/django\_starter/contrib/forms/mixins.py

    from django import forms
    from .widget_classes import *
    
    
    class BaseFormMixin:
        """æä¾›è¡¨å•æ ·å¼çš„é€šç”¨æ··å…¥ç±»"""
    
        widget_classes = {
            forms.TextInput: TEXT_INPUT_CLASS,
            forms.Textarea: TEXT_AREA_CLASS,
            forms.EmailInput: TEXT_INPUT_CLASS,
            forms.PasswordInput: PASSWORD_INPUT_CLASS,
            forms.Select: SELECT_CLASS,
            forms.DateInput: DATE_INPUT_CLASS,
            forms.NumberInput: NUMBER_INPUT_CLASS,
        }
    
        def apply_widget_classes(self):
            """æ ¹æ®widgetç±»å‹ä¸ºè¡¨å•å­—æ®µåº”ç”¨æ ·å¼"""
            for field_name, field in self.fields.items():
                widget_class = self.widget_classes.get(type(field.widget))
                if widget_class:
                    field.widget.attrs.update({'class': widget_class})
    
        def __init__(self, *args, **kwargs):
            super().__init__(*args, **kwargs)
            self.apply_widget_classes()
    

widget\_classes.py çš„ä»£ç å°±ä¸è´´äº†

å°±æ˜¯ Tailwind CSS çš„æ ·å¼

crispy-forms æ˜¯å’‹å®ç°çš„
------------------

å®‰è£…åï¼Œç®€å•é…ç½®ä¸‹å°±èƒ½ç”¨äº†

ä½¿ç”¨èµ·æ¥ç±»ä¼¼ä¸‹é¢è¿™æ ·

    {% load crispy_forms_tags %}
    
    <div class="sm:col-span-6">
        {{ form.name|as_crispy_field }}
    </div>
    
    <div class="sm:col-span-3">
        {{ form.dvr_brand|as_crispy_field }}
    </div>
    
    <div class="sm:col-span-3">
        {{ form.dvr_model|as_crispy_field }}
    </div>
    
    <div class="sm:col-span-3">
        {{ form.dvr_ip|as_crispy_field }}
    </div>
    
    <div class="sm:col-span-3">
        {{ form.status|as_crispy_field }}
    </div>
    

å®‰è£…
--

å®‰è£…ä¾èµ–

    pdm install django-crispy-forms
    

ç„¶åæ·»åŠ åˆ°

    INSTALLED_APPS = (
        ...
        'crispy_forms',
    )
    

### Template packs

ç„¶åè¿˜å¾—å®‰è£… Template packs

ä¸ç„¶åªæ˜¯ä¸ªç©ºå£³

å®˜æ–¹æ”¯æŒçš„åªæœ‰ Bootstrap ç³»åˆ—ï¼Œæœ‰ç‚¹ out äº†

å¥½åœ¨ç¤¾åŒºä¹Ÿæä¾›äº†ä¸å°‘ï¼Œè¿™é‡Œæˆ‘åªå…³æ³¨ Tailwind CSS çš„åº“ï¼Œåå­—æ˜¯ [crispy-tailwind](https://github.com/django-crispy-forms/crispy-tailwind)

    pdm add crispy-tailwind
    

å…¶ä»– UI åº“è¿˜æœ‰å¾ˆå¤šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥åœ¨å®˜ç½‘çœ‹åˆ°: [https://django-crispy-forms.readthedocs.io/en/latest/install.html#template-packs](https://django-crispy-forms.readthedocs.io/en/latest/install.html#template-packs)

è¿™ä¸ªåŒæ ·ä¹Ÿå¾—æ·»åŠ è¿›å»

    INSTALLED_APPS = (
        ...
        'crispy_forms',
        'crispy_tailwind',
    )
    

### é…ç½®

åœ¨é…ç½®æ–‡ä»¶é‡Œä¿®æ”¹é»˜è®¤çš„ Template Packs

src/config/settings/components/crispy\_forms.py

    CRISPY_ALLOWED_TEMPLATE_PACKS = "tailwind"
    CRISPY_TEMPLATE_PACK = "tailwind"
    

ä½¿ç”¨
--

æœ€ç®€å•çš„ç”¨æ³•æ˜¯åªä¿®æ”¹æ¨¡æ¿æ–‡ä»¶

    {% load crispy_forms_tags %}
    
    <form method="post" class="my-class">
        {{ my_formset|crispy }}
    </form>
    

ç›®å‰ä¸­å°é¡¹ç›®ä¹Ÿåªç”¨åˆ°äº†è¿™ä¸ª

æ­é… `django-select2` å¯ä»¥å®ç°ä¸‹æ‹‰æœç´¢æ¡†

ä¸è¿‡æ ·å¼ä¸å¥½æ”¹ï¼Œæˆ‘æŠ˜è…¾äº†ä¸€æ®µæ—¶é—´ä¹Ÿæ²¡æ”¹å¥½ï¼Œç´¢æ€§å…ˆä¸ç†äº†ï¼Œåæ­£å°±æ˜¯ä¸€ä¸ªå¿«é€Ÿå®ç°çš„ DEMO

åç»­æœ‰éœ€æ±‚å†ç”¨ React é‡å†™é¡µé¢å°±è¡Œäº†

å°ç»“
--

æˆ‘å‘ç° Django ç›¸å…³çš„æŠ€æœ¯è¿˜ç®—æ˜¯æ¯”è¾ƒå°ä¼—çš„

ä¸€èˆ¬å†™è¿™ç§æ–‡ç« å°±æ²¡ä»€ä¹ˆäººçœ‹

æˆ‘åš Django ä¹Ÿå¥½å‡ å¹´çš„æ—¶é—´äº†ï¼Œæ¡†æ¶æºç çœ‹äº†ï¼Œè„šæ‰‹æ¶ä¹Ÿæäº†ï¼Œç”¨å¾—éå¸¸é¡ºæ‰‹

è™½ç„¶ç°åœ¨ python çš„ web æ¡†æ¶æœ‰å¾ˆå¤šï¼Œä¸è¿‡æ‰€æœ‰é¡¹ç›®æœ€ç»ˆéƒ½ä¼šæˆä¸º Django çš„æ ·å­ğŸ¤£

å°±è¿™æ ·å§ï¼Œpython é¡¹ç›®è¿™ä¸€å—ï¼Œæˆ‘è¿˜æ˜¯ä¼šç»§ç»­åšæŒ Django ï¼Œæ¯•ç«Ÿæ˜¯çœŸçš„æ–¹ä¾¿å¥½ç”¨

å½“ç„¶ä¹Ÿä¸æ’æ–¥å°è¯•æ–°çš„ç©æ„ï¼Œæ¯”å¦‚æœ€è¿‘æœ‰ä¸ª [Litestar](https://docs.litestar.dev/2/) å·ç§°è¦å¹²æ‰ FastAPI çš„ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œæœ‰æ—¶é—´å¯ä»¥è¯•è¯•çœ‹

å¾®ä¿¡å…¬ä¼—å·ï¼šã€Œç¨‹åºè®¾è®¡å®éªŒå®¤ã€ ä¸“æ³¨äºäº’è”ç½‘çƒ­é—¨æ–°æŠ€æœ¯æ¢ç´¢ä¸å›¢é˜Ÿæ•æ·å¼€å‘å®è·µï¼ŒåŒ…æ‹¬æ¶æ„è®¾è®¡ã€æœºå™¨å­¦ä¹ ä¸æ•°æ®åˆ†æç®—æ³•ã€ç§»åŠ¨ç«¯å¼€å‘ã€Linuxã€Webå‰åç«¯å¼€å‘ç­‰ï¼Œæ¬¢è¿ä¸€èµ·æ¢è®¨æŠ€æœ¯ï¼Œåˆ†äº«å­¦ä¹ å®è·µç»éªŒã€‚