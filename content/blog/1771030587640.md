---
layout: post
title: 'MAFå¿«é€Ÿå…¥é—¨ï¼ˆ16ï¼‰ç”¨æˆ·æ™ºèƒ½ä½“äº¤äº’åè®®AG-UIï¼ˆä¸Šï¼‰'
date: "2026-02-14T00:56:27Z"
---
MAFå¿«é€Ÿå…¥é—¨ï¼ˆ16ï¼‰ç”¨æˆ·æ™ºèƒ½ä½“äº¤äº’åè®®AG-UIï¼ˆä¸Šï¼‰
============================

![MAFå¿«é€Ÿå…¥é—¨ï¼ˆ16ï¼‰ç”¨æˆ·æ™ºèƒ½ä½“äº¤äº’åè®®AG-UIï¼ˆä¸Šï¼‰](https://img2024.cnblogs.com/blog/381412/202602/381412-20260213222607884-1836311076.png) AG-UI å…¨ç§° Agentâ€“User Interaction Protocol å³ æ™ºèƒ½ä½“-ç”¨æˆ· äº¤äº’åè®®ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ã€åŸºäºäº‹ä»¶çš„åè®®ï¼Œç”± CopilotKit å›¢é˜Ÿå‘èµ·ï¼Œç”¨äºæ ‡å‡†åŒ– AI Agent ä¸ ç”¨æˆ·ç•Œé¢ çš„å®æ—¶äº¤äº’ã€‚æœ¬æ–‡ä»‹ç»äº†AG-UIåè®®çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°AG-UIåè®®ï¼ŒAG-UIå’ŒMCPï¼ŒA2Açš„å¯¹æ¯”ï¼Œéšåä»‹ç»äº†å¦‚ä½•åœ¨MAFä¸­å¿«é€Ÿå¼€å‘ä¸€ä¸ªåŸºäºAG-UIçš„å¯¹è¯åº”ç”¨ã€‚

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Edisonã€‚

æœ€è¿‘æˆ‘ä¸€ç›´åœ¨è·Ÿç€åœ£æ°çš„ã€Š[.NET+AIæ™ºèƒ½ä½“å¼€å‘è¿›é˜¶](https://mp.weixin.qq.com/s?__biz=MzA4NzQzNTg4Ng==&mid=2651744458&idx=1&sn=139f7584e81aeecd0945133bdc2b4791&scene=21#wechat_redirect)ã€‹è¯¾ç¨‹å­¦ä¹ MAFå¼€å‘å¤šæ™ºèƒ½ä½“å·¥ä½œæµï¼Œæˆ‘å¼ºçƒˆæ¨èä½ ä¹Ÿä¸Šè½¦è·Ÿæˆ‘ä¸€èµ·å‡ºå‘ï¼

[ä¸Šä¸€ç¯‡](https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper15)ï¼Œæˆ‘ä»¬å­¦ä¹ äº†MAFä¸­å¿«é€Ÿè°ƒè¯•çš„åˆ©å™¨DevUIã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸ªç”¨æˆ·æ™ºèƒ½ä½“äº¤äº’åè®®ï¼šAG-UIã€‚

**1 ä»€ä¹ˆæ˜¯AG-UI**
==============

AG-UI å…¨ç§°Â **Agentâ€“User Interaction ProtocolÂ å³Â æ™ºèƒ½ä½“-ç”¨æˆ· äº¤äº’åè®®ï¼Œ**è¿™æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ã€åŸºäºäº‹ä»¶çš„åè®®ï¼Œç”± CopilotKit å›¢é˜Ÿå‘èµ·ï¼Œç”¨äºæ ‡å‡†åŒ– AI Agent ä¸ ç”¨æˆ·ç•Œé¢ çš„å®æ—¶äº¤äº’ã€‚

### ä¸ºä»€ä¹ˆå‡ºç°AG-UIåè®®ï¼Ÿ

è¿™æ˜¯å› ä¸ºåœ¨æ„å»ºAI Agentåº”ç”¨çš„ç•Œé¢æ—¶ï¼Œä¼ ç»ŸAPIæ¨¡å¼é¢ä¸´å¾ˆå¤šé—®é¢˜å’ŒæŒ‘æˆ˜ï¼š

![image](https://img2024.cnblogs.com/blog/381412/202602/381412-20260213222047426-1470758576.png)

è€ŒAG-UIåˆ™æ˜¯ä¸“é—¨ä¸ºAI Agentä¸ç”¨æˆ·ç•Œé¢çš„äº¤äº’è€Œè®¾è®¡çš„åè®®ï¼Œå…¶æ ¸å¿ƒä»·å€¼ä½“ç°åœ¨ï¼š

*   ğŸ“¡Â **å®æ—¶æµå¼å“åº”**ï¼šå³æ—¶å±•ç¤º Agent è¾“å‡ºï¼Œæ— éœ€ç­‰å¾…
    
*   ğŸ¯Â **äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼šç»†ç²’åº¦çš„äº¤äº’äº‹ä»¶ï¼Œç²¾ç¡®æ§åˆ¶ UI
    
*   ğŸ”„Â **çŠ¶æ€åŒæ­¥æœºåˆ¶**ï¼šSnapshot/Delta æ¨¡å¼ï¼Œä¿æŒ UI ä¸ Agent çŠ¶æ€ä¸€è‡´
    
*   ğŸ”§Â **å·¥å…·è°ƒç”¨å¯è§†åŒ–**ï¼šé€æ˜å±•ç¤º Agent çš„æ€è€ƒå’Œè¡ŒåŠ¨è¿‡ç¨‹
    

### ä¸‰å¤§Agentåè®®å¯¹æ¯”

æˆ‘ä»¬ä¹‹å‰å·²ç»å­¦ä¹ äº†MCP å’Œ A2Aä¸¤ä¸ªé‡è¦çš„åè®®äº†ï¼ŒåŠ ä¸ŠAG-UIï¼Œå®ƒä»¬å…±åŒç»„æˆäº†Agentçš„ä¸‰å¤§é€šä¿¡åè®®ä½“ç³»ã€‚

ä¸è¿‡ï¼Œå®ƒä»¬çš„å®šä½å„æœ‰ä¾§é‡ï¼Œå¹¶ééæ­¤å³å½¼ï¼Œè€Œæ˜¯ååŒä½¿ç”¨ï¼Œç”¨å½¢è±¡çš„æ¯”å–»æ¥è®²ï¼š

**AG-UI åƒæ˜¯"å®¢æœçª—å£"ï¼š**

*   ç”¨æˆ·ä¸ Agent ä¹‹é—´çš„äº¤äº’ç•Œé¢
    
*   å®æ—¶å±•ç¤º Agent çš„å·¥ä½œçŠ¶æ€
    
*   æ”¯æŒç”¨æˆ·è¾“å…¥å’Œåé¦ˆ
    

**MCP åƒæ˜¯"å·¥å…·ç®±"ï¼š**

*   Agent è°ƒç”¨å¤–éƒ¨å·¥å…·å®Œæˆä»»åŠ¡
    
*   å·¥å…·æ˜¯è¢«åŠ¨çš„ï¼Œç­‰å¾…è°ƒç”¨
    
*   æ‰©å±• Agent çš„èƒ½åŠ›è¾¹ç•Œ
    

**A2A åƒæ˜¯"åŒäº‹åä½œ"ï¼š**

*   å¤šä¸ª Agent ä¹‹é—´çš„ä»»åŠ¡åˆ†å‘
    
*   æ¯ä¸ª Agent éƒ½æ˜¯è‡ªä¸»çš„
    
*   å¯ä»¥äº’ç›¸å§”æ‰˜å’Œåä½œ
    

åœ¨å®é™…ä¼ä¸šåœºæ™¯ä¸­ï¼Œ****ä¸‰å¤§åè®®é€šå¸¸ååŒä½¿ç”¨ï¼š****

*   **AG-UI**ï¼šç”¨æˆ·é€šè¿‡ç•Œé¢ä¸ä¸» Agent äº¤äº’
    
*   **MCP**ï¼šAgent å†…éƒ¨ä½¿ç”¨ MCP è°ƒç”¨å·¥å…·
    
*   **A2A**ï¼šå¤æ‚ä»»åŠ¡å§”æ‰˜ç»™ä¸“å®¶ Agent å¤„ç†
    

ä¸‹å›¾å±•ç¤ºäº†ä¸‰å¤§åè®®çš„è¯¦ç»†å¯¹æ¯”ï¼š

![image](https://img2024.cnblogs.com/blog/381412/202602/381412-20260213222138115-952680249.png)

**2 å¿«é€Ÿå¼€å§‹ï¼šAG-UIå¯¹è¯åº”ç”¨**
====================

AG-UIåè®®å®šä¹‰äº†æ¸…æ™°çš„æ¶æ„ç»„ä»¶ï¼ŒåŒ…æ‹¬ Serverã€Client å’Œ Agentã€‚

åœ¨MAFä¸­æä¾›äº†ä¸€ä¸ªå†…ç½®çš„AG-UIç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åˆ›å»ºé›†æˆAG-UIçš„Agentåº”ç”¨ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€æ­¥ä¸€æ­¥å®Œæˆä¸€ä¸ªAG-UIå¯¹è¯åº”ç”¨æ¶‰åŠåˆ°çš„Server å’Œ Clientã€‚

### AG-UI Server

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªASP.NET Webåº”ç”¨ï¼Œå®‰è£…ä»¥ä¸‹NuGetåŒ…ï¼š

Microsoft.Agents.AI.Hosting.AGUI.AspNetCore
Microsoft.Agents.AI.OpenAI
Microsoft.Extensions.AI.OpenAI

ç„¶åï¼Œå°±æ˜¯æ•´ä¸ªç¤ºä¾‹çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸€å—ä¸€å—æ¥è¯´ï¼š

ï¼ˆ1ï¼‰åˆ›å»ºåº”ç”¨å¹¶æ³¨å†ŒAG-UIæœåŠ¡

// Step0. Create WebApplication builder
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddHttpClient().AddLogging();

// Step1. Register AG-UI services
builder.Services.AddAGUI();

ï¼ˆ2ï¼‰åˆ›å»ºä¸€ä¸ªAI Agentï¼š

var app = builder.Build();

// Step2. Load Configuration
var config = new ConfigurationBuilder()
    .AddJsonFile($"appsettings.json", optional: false, reloadOnChange: true)
    .AddJsonFile($"appsettings.{Environment.GetEnvironmentVariable("ASPNETCORE\_ENVIRONMENT")}.json", optional: true, reloadOnChange: true)
    .Build();
var openAIProvider = config.GetSection("OpenAI").Get<OpenAIProvider>();

// Step3. Create one ChatClient
var chatClient = new OpenAIClient(
        new ApiKeyCredential(openAIProvider.ApiKey),
        new OpenAIClientOptions { Endpoint = new Uri(openAIProvider.Endpoint) })
    .GetChatClient(openAIProvider.ModelId)
    .AsIChatClient();

// Step4. Create one AI Agent
var agent = chatClient.AsAIAgent(
    name: "AGUI-Assistant",
    instructions: "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„AIåŠ©æ‰‹ï¼Œè¯·ä½¿ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚");
Console.WriteLine("âœ… AI Agent åˆ›å»ºæˆåŠŸ");

ï¼ˆ3ï¼‰æ˜ å°„AGUIç«¯ç‚¹å¹¶å¯åŠ¨åº”ç”¨ï¼š

// Step5. Mapping AG-UI Endpoints
app.MapAGUI("/", agent);

Console.WriteLine("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
Console.WriteLine("ğŸš€ AG-UI Server å·²å¯åŠ¨");
Console.WriteLine("ğŸ“ ç«¯ç‚¹åœ°å€: https://localhost:8443/");
Console.WriteLine("ğŸ’¡ ä½¿ç”¨ Ctrl+C åœæ­¢æœåŠ¡");
Console.WriteLine("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

app.Run();

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä»…ç”¨ä¸€è¡Œä»£ç  app.MapAGUI() å°±å¯ç”¨äº†AG-UIåè®®ï¼ŒSo Easy!

å¯åŠ¨èµ·æ¥çš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image](https://img2024.cnblogs.com/blog/381412/202602/381412-20260213222325381-1327622437.png)

### **AG-UI Client**

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ§åˆ¶å°åº”ç”¨ï¼Œå®‰è£…ä»¥ä¸‹NuGetåŒ…ï¼š

Microsoft.Agents.AI.AGUI
Microsoft.Agents.AI

ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºAG-UI Client å’Œ AI Agentï¼š

// Load Configuration
var config = new ConfigurationBuilder()
    .AddJsonFile($"appsettings.json", optional: false, reloadOnChange: true)
    .Build();
var openAIProvider = config.GetSection("OpenAI").Get<OpenAIProvider>();
var serverEndpoint = config.GetValue<string\>("AGUI\_SERVER\_URL")
    ?? "https://localhost:8443";
Console.WriteLine("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
Console.WriteLine("ğŸš€ AG-UI å®¢æˆ·ç«¯å·²å¯åŠ¨");
Console.WriteLine($"ğŸ“ æœåŠ¡ç«¯åœ°å€: {serverEndpoint}");
Console.WriteLine("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n");
// Step1. Create HTTP Client
using HttpClient httpClient = new()
{
    Timeout \= TimeSpan.FromSeconds(60)
};
// Step2. Create AG-UI Client
var chatClient = new AGUIChatClient(httpClient, serverEndpoint);
// Step3. Create AI Agent
var agent = chatClient.AsAIAgent(
    name: "agui-client",
    description: "AG-UI Client Agent");

ç„¶åï¼Œå‡†å¤‡å¼€å§‹å¯¹è¯ï¼š

// Step4. Prepare for Conversation
var session = await agent.GetNewSessionAsync();
var messages = new List<ChatMessage>()
{
    new ChatMessage(ChatRole.System, "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„AIåŠ©æ‰‹ï¼Œä½¿ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚")
};
Console.WriteLine("ğŸ’¬ å¼€å§‹å¯¹è¯ï¼ˆè¾“å…¥ :q æˆ– quit é€€å‡ºï¼‰\\n");

while (true)
{
    Console.Write("ğŸ‘¤ ç”¨æˆ·: ");
    string? message = Console.ReadLine();
    if (string.IsNullOrWhiteSpace(message)) 
        continue;
    if (message is ":q" or "quit") 
        break;
    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
    messages.Add(new ChatMessage(ChatRole.User, message));
    // æµå¼æ¥æ”¶å“åº”
    Console.Write("ğŸ¤– åŠ©æ‰‹: ");
    await foreach (var update in agent.RunStreamingAsync(messages, session))
    {
        foreach (AIContent content in update.Contents)
        {
            switch (content)
            {
                case TextContent textContent:
                    Console.Write(textContent.Text);
                    break;
                case UsageContent usageContent:
                    Console.WriteLine($"\\n\[ğŸ“Š Tokens: {usageContent.Details.TotalTokenCount}\]");
                    break;
                default:
                    Console.Write("Unknown content!");
                    break;
            }
        }
    }
    Console.WriteLine("\\n");
}
Console.WriteLine("ğŸ‘‹ å†è§ï¼");
Console.ReadKey();

æœ€ç»ˆçš„è°ƒè¯•æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![agui-gif-demo-001](https://img2024.cnblogs.com/blog/381412/202602/381412-20260213222507160-684244773.gif)

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„å¯¹è¯å®¢æˆ·ç«¯ï¼Œå®æ—¶çš„æµå¼å“åº”ä¹Ÿä¸éœ€è¦æˆ‘ä»¬å†™è¿‡å¤šä»£ç å®ç°ã€‚

**3 å°ç»“**
========

æœ¬æ–‡ä»‹ç»äº†AG-UIåè®®çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°AG-UIåè®®ï¼ŒAG-UIå’ŒMCPï¼ŒA2Açš„å¯¹æ¯”ï¼Œéšåä»‹ç»äº†å¦‚ä½•åœ¨MAFä¸­å¿«é€Ÿå¼€å‘ä¸€ä¸ªåŸºäºAG-UIçš„å¯¹è¯åº”ç”¨ã€‚

ç¤ºä¾‹æºç 
====

GitHub:Â [https://github.com/EdisonTalk/MAFD](https://github.com/EdisonTalk/MAFD)

å‚è€ƒèµ„æ–™
====

åœ£æ°ï¼Œã€Š[.NET + AI æ™ºèƒ½ä½“å¼€å‘è¿›é˜¶](https://www.cnblogs.com/sheng-jie/p/19200934)ã€‹ï¼ˆæ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜…ï¼‰

Microsoft Learnï¼Œã€Š[Agent Framework Tutorials](https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview?wt.mc_id=MVP_397012)ã€‹

![](https://images.cnblogs.com/cnblogs_com/edisonchou/1647700/o_200902144330EdisonTalk-Footer.jpg)

ä½œè€…ï¼šçˆ±è¿ªç”Ÿ

å‡ºå¤„ï¼š[https://edisontalk.cnblogs.com](https://edisontalk.cnblogs.com "from")

æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„å¿…é¡»ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œä¸”åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡é“¾æ¥ã€‚

[![](http://service.t.sina.com.cn/widget/qmd/2068032061/d643d182/10.png)](https://weibo.com/u/2068032061?s=6uyXnP)