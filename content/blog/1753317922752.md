---
layout: post
title: 'å…¥èŒ3ä¸ªæœˆï¼Œä¸ºå†·é—¨ç¼–ç¨‹è¯­è¨€ InterSystems ObjectScript ç¼–å†™äº†ä¸€ä¸ª VSCode æ’ä»¶'
date: "2025-07-24T00:45:22Z"
---
å…¥èŒ3ä¸ªæœˆï¼Œä¸ºå†·é—¨ç¼–ç¨‹è¯­è¨€ InterSystems ObjectScript ç¼–å†™äº†ä¸€ä¸ª VSCode æ’ä»¶
=======================================================

èƒŒæ™¯ä»‹ç»
----

InterSystems ObjectScript æ˜¯ç”± InterSystems å…¬å¸å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼Œè¯ç”Ÿäº 1980 å¹´ä»£åˆæœŸã€‚å®ƒæœ€åˆæ˜¯ä¸ºäº†æ”¯æŒ InterSystems çš„æ•°æ®åº“äº§å“ï¼ˆå¦‚ CachÃ©ï¼‰è€Œè®¾è®¡çš„ï¼Œç»“åˆäº†é¢å‘å¯¹è±¡å’Œè¿‡ç¨‹å¼ç¼–ç¨‹çš„ç‰¹æ€§ã€‚ObjectScript çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†é«˜æ•ˆåœ°å¤„ç†åŒ»ç–—ã€è´¢åŠ¡å’Œå…¶ä»–é«˜æ€§èƒ½è®¡ç®—é¢†åŸŸçš„æ•°æ®å¯†é›†å‹åº”ç”¨ã€‚  
å…¬å¸è€é¡¹ç›®ä½¿ç”¨çš„æ˜¯è¿™ä¸ªæŠ€æœ¯æ ˆï¼Œæˆ‘æ²¡å¾—é€‰ï¼Œå¾—ä½¿ç”¨ã€‚æˆ‘æ˜æ˜¾æ„Ÿè§‰åˆ°ï¼Œè¿™ä¸ªç¼–ç¨‹è¯­è¨€çš„ç¤¾åŒºè¿œå°äºJava,Spring, C#ï¼Œ.NET, Python, AIç­‰ä¸»æµç¼–ç¨‹è¯­è¨€ä»¥åŠæŠ€æœ¯æ ˆç¤¾åŒºã€‚å‡ºäº†é”™åªèƒ½æŸ¥å®˜æ–¹APIï¼ŒAIç¼–ç¨‹è¾…åŠ©åœ¨è¿™ä¸ªè¯­è¨€ä¸Šè¡¨ç°æ¬ ä½³ï¼Œæ¯”å¦‚ä¼šä¸ºä¸€ä¸ªç±»ç”ŸæˆAPIä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œä»¥åŠæ— æ³•å¯Ÿè§‰åˆ°ç¼–è¯‘é¡ºåºä¹‹ç±»çš„åº•å±‚é”™è¯¯ã€‚

å’Œä¸»æµç¼–ç¨‹è¯­è¨€çš„å¯¹æ¯”
----------

### ç›¸åŒç‚¹

#### é¢å‘å¯¹è±¡ç¼–ç¨‹

æœ‰é™æ€æ–¹æ³•å’Œæ™®é€šæ–¹æ³•ã€‚

#### å¼‚å¸¸å¤„ç†

ä½¿ç”¨ `TRY/CATCH` ç»“æ„å¤„ç†å¼‚å¸¸ï¼Œç±»ä¼¼äºå…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼š

    TRY {
        // å¯èƒ½å‡ºé”™çš„ä»£ç 
        SET result = 10 / 0
    } CATCH ex {
        WRITE "Error: " _ ex.DisplayString()
    }
    

#### å…¨å±€å˜é‡

`SET ^MyGlobal("UserCount") = 100`

#### "$"ä¸ºå¼€å¤´çš„å˜é‡çš„è¯­æ³•

è®©æˆ‘æƒ³èµ·æ¥äº†phpçš„å˜é‡ã€‚`$JOB`,`$ZDATE("YYYY-MM-DD")`

#### ç±»ä¼¼äºCçš„å®å®šä¹‰

æ”¯æŒé¢„å¤„ç†å™¨æŒ‡ä»¤å’Œå®å®šä¹‰ï¼Œåœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ–‡æœ¬æ›¿æ¢ï¼š

    #define DEBUG 1
    #if DEBUG
        WRITE "Debug mode enabled"
    #endif
    

#### ç°ä»£åŒ…ç®¡ç†å·¥å…·

zpm "search"

### å·®å¼‚

#### é«˜åº¦å°è£…çš„ä¾‹ç¨‹

æœ‰ç‚¹åƒmysqlçš„å­˜å‚¨è¿‡ç¨‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨

### åäººç±»çš„å‡½æ•°ä¹ æƒ¯

Collectionsé›†åˆçš„SetAtæ–¹æ³•

    do myList.SetAt("red",2)
    

ä»–è¿™é‡Œkeyæ˜¯åœ¨æœ€åä¸€ä¸ªå‚æ•°çš„ä½ç½®ï¼Œvalueåœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®ã€‚

Forå¾ªç¯æ˜¯`FOR var=start:increment:end`ï¼Œä¸»æµè¯­è¨€æ˜¯`FOR var=start:end:increment`  
FOR i = 1 : 1 : 10 { code }

Propertyå’ŒParameterå‚»å‚»åˆ†ä¸æ¸…  
ä¸¤ä¸ªéƒ½æ˜¯å±æ€§çš„æ„æ€ï¼Œå‰è€…è¡¨ç¤ºå¯ä»¥æ›´æ”¹ï¼Œåè€…è¡¨ç¤ºå¸¸é‡ï¼Œç±»ä¼¼äºä¸»æµç¼–ç¨‹è¯­è¨€çš„constå…³é”®å­—ã€‚

#### å¥‡ç‰¹çš„è¯­æ³•

å­—ç¬¦ä¸²åŒ…å«  
`##class`è°ƒç”¨

#### ç¼–è¯‘é¡ºåºäººå·¥å¹²é¢„

å¾ˆå¤´ç–¼çš„ç‰¹æ€§ï¼Œè®©æˆ‘æƒ³èµ·æ¥è¢«C++çš„æ‰‹åŠ¨å†…å­˜ç®¡ç†æŠ˜ç£¨ï¼Œç°åœ¨éœ€è¦è‡ªå·±æŒ‡å®šç¼–è¯‘é¡ºåºã€‚

#### ä»£ç ç”Ÿæˆå™¨

ç”¨ä»£ç ç”Ÿæˆä»£ç ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚  
è¾ƒéš¾è°ƒè¯•ï¼ŒåŒå¼•å·é…å¯¹çš„æŠ˜ç£¨ã€‚

    If $CLASSMETHOD(type, "%Extends", "%Boolean")
    	{
    			Do %code.WriteLine("   do data.Write($Select(.."_propName_"="""": ""null"", +.."_propName_": ""true"", 1: ""false""))")
    	}
    		ElseIf $CLASSMETHOD(type, "%Extends", "%Integer") || $CLASSMETHOD(type, "%Extends", "%Numeric")
    			|| $CLASSMETHOD(type, "%Extends", "%Float") || $CLASSMETHOD(type, "%Extends", "%Double")
    	{
    			Do %code.WriteLine("   do data.Write($Select(.." _ propName _ "="""": ""null"", 1: $FNUMBER(+.." _ propName _ ", ""N"")))")
    		}
    		Else
    		{
    			Do %code.WriteLine("   do data.Write($Select(.."_propName_"="""": ""null"", 1: """""""" _ .."_propName_"_""""""""))")
    		}
    

#### ä¸å­˜åœ¨å¤šçº¿ç¨‹çš„ç±»å’Œæ–¹æ³•

ObjectScript æœ¬èº«å¹¶æ²¡æœ‰æä¾›ç±»ä¼¼å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Java æˆ– Pythonï¼‰ä¸­çš„ä¼ ç»Ÿ å¤šçº¿ç¨‹ ç±»æˆ–æ–¹æ³•ã€‚JOB åœ¨ ObjectScript ä¸­æ˜¯åŸºäº å¤šè¿›ç¨‹ çš„ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ å¤šçº¿ç¨‹ã€‚

InterSystems ObjectScript ç±»å›¾æŸ¥çœ‹å™¨
-------------------------------

![image](https://img2024.cnblogs.com/blog/1201453/202507/1201453-20250723210420053-86537865.png)

ä¸€ä¸ªç”¨äºç”Ÿæˆ InterSystems ObjectScript ç±»çš„ UML ç±»å›¾çš„ Visual Studio Code æ‰©å±•ã€‚æ­¤æ‰©å±•ä¸ä»…ç”Ÿæˆç±»å›¾ï¼Œè¿˜æä¾›äº¤äº’å¼æ˜¾ç¤ºå’Œå¯¼èˆªåŠŸèƒ½ã€‚

![image](https://img2024.cnblogs.com/blog/1201453/202507/1201453-20250723210434742-2074267741.png)

### åŠŸèƒ½

*   ä» `.cls` æ–‡ä»¶ç”Ÿæˆ UML ç±»å›¾
*   æ”¯æŒç±»çº§å’Œæ–‡ä»¶å¤¹çº§å›¾è¡¨ç”Ÿæˆ
*   åœ¨ç¼–è¾‘å™¨å’Œèµ„æºç®¡ç†å™¨ä¸­é›†æˆä¸Šä¸‹æ–‡èœå•
*   å¯è§†åŒ–ç±»å…³ç³»ã€å±æ€§å’Œæ–¹æ³•
*   åŸºäº PlantUML æä¾›å¯é çš„å›¾è¡¨è¡¨ç¤º
*   ä½¿ç”¨ PlantUML Web æœåŠ¡å™¨ç”Ÿæˆå›¾è¡¨ï¼ˆæ— éœ€å®‰è£… Javaï¼‰
*   **æ–°å¢ï¼š** ä¸ InterSystems IRIS ç›´æ¥é›†æˆï¼Œè·å–æœåŠ¡å™¨ç«¯ç±»ä¿¡æ¯
*   **æ–°å¢ï¼š** ä»å›¾è¡¨ç›´æ¥åœ¨ IRIS Documatic ä¸­æµè§ˆç±»
*   äº¤äº’å¼ç±»å›¾å¯¼èˆª
    *   ç‚¹å‡»ç±»åã€å±æ€§æˆ–æ–¹æ³•å¯å¿«é€Ÿè·³è½¬åˆ°ç›¸åº”ä»£ç 
    *   SVG å›¾è¡¨åµŒå…¥ HTML ä¸­å®ç°å¹³æ»‘äº¤äº’
    *   ç±»å…³ç³»çš„å¯è§†åŒ–å¯¼èˆª

### è¦æ±‚

æ“ä½œç³»ç»Ÿ

å¿…éœ€

å¯é€‰ï¼ˆç”¨äºæœ¬åœ° PlantUML ç”Ÿæˆï¼‰

Windows

\- VSCode 1.96.0+  
\- ObjectScript ç±»æ–‡ä»¶(`.cls`)

\- Java 8+

Linux

\- VSCode 1.96.0+  
\- ObjectScript ç±»æ–‡ä»¶(`.cls`)

\- Java 8+  
\- Graphviz

ğŸ’¡ _ä½¿ç”¨ PlantUML Web æœåŠ¡å™¨æ—¶ï¼Œä¸éœ€è¦ Java å’Œ Graphvizã€‚_

### å®‰è£…

1.  ä» VS Code å®‰è£…æ‰©å±•
2.  ç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£… Java è¿è¡Œæ—¶ç¯å¢ƒ (JRE)ï¼ˆä½¿ç”¨ PlantUML Web æœåŠ¡å™¨æ—¶å¯é€‰ï¼‰
3.  å®‰è£…åé‡å¯ VS Code

> ğŸ’¡ **æŸ¥çœ‹è¯¦ç»†å›¾æ–‡æ•™ç¨‹**ï¼šå¦‚éœ€æŸ¥çœ‹å®‰è£…å’Œä½¿ç”¨çš„è¯¦ç»†æˆªå›¾æ¼”ç¤ºï¼Œè¯·è®¿é—® [GitHub ä»“åº“æ–‡æ¡£](https://github.com/cjy513203427/intersystems-objectscript-class-diagram-view/blob/master/README.zh-CN.md)

### ä½¿ç”¨æ–¹æ³•

#### ç”Ÿæˆç±»å›¾

1.  åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ `.cls` æ–‡ä»¶
2.  ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ç”Ÿæˆç±»å›¾ï¼š
    *   æŒ‰ä¸‹ `Ctrl+Alt+U`
    *   å³é”®ç‚¹å‡»æ–‡ä»¶å¹¶é€‰æ‹©"ç”Ÿæˆç±»å›¾"
    *   å³é”®ç‚¹å‡»åŒ…å« `.cls` æ–‡ä»¶çš„æ–‡ä»¶å¤¹å¹¶é€‰æ‹©"ç”Ÿæˆç±»å›¾"
3.  å‡ºç°æç¤ºæ—¶ï¼Œé€‰æ‹©æ‚¨é¦–é€‰çš„ç”Ÿæˆæ–¹æ³•ï¼š
    *   **æœ¬åœ° Java**ï¼šä½¿ç”¨æœ¬åœ° Java å®‰è£…ç”Ÿæˆå›¾è¡¨å¹¶åœ¨ VS Code ä¸­æ˜¾ç¤º
    *   **PlantUML Web æœåŠ¡å™¨**ï¼šç”Ÿæˆå¯ä»¥åœ¨ä»»ä½•æµè§ˆå™¨ä¸­æ‰“å¼€çš„ URLï¼ˆæ— éœ€å®‰è£… Javaï¼‰

#### ä½¿ç”¨ PlantUML Web æœåŠ¡å™¨

é€‰æ‹©"PlantUML Web æœåŠ¡å™¨"é€‰é¡¹æ—¶ï¼š

*   æ— éœ€æœ¬åœ° Java å®‰è£…
*   å›¾è¡¨åœ¨ PlantUML Web æœåŠ¡å™¨ä¸Šç”Ÿæˆ
*   æ‚¨å¯ä»¥å°† URL å¤åˆ¶åˆ°å‰ªè´´æ¿æˆ–ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
*   å¯ä»¥ä¸ä»–äººå…±äº« URL ä»¥æŸ¥çœ‹å›¾è¡¨

#### ä½¿ç”¨ IRIS é›†æˆç”Ÿæˆç±»å›¾

æ­¤åŠŸèƒ½ä¾èµ–äº Intersystem æ’ä»¶ï¼Œå®ƒå°†ä»æ‰€é€‰ç±»ç”Ÿæˆæ‰€æœ‰ç±»å±æ€§ã€å‚æ•°å’Œæ–¹æ³•ã€‚  
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥åŠŸèƒ½ä¼šç”Ÿæˆæ•´ä¸ªç»§æ‰¿å±‚æ¬¡ç»“æ„ï¼Œå³ä½¿æ˜¯æœ¬åœ°é¡¹ç›®ä¸­ä¸å­˜åœ¨çš„ç±»ä¹Ÿä¼šåŒ…å«åœ¨å†…ã€‚

1.  åœ¨ VS Code è®¾ç½®ä¸­é…ç½®æ‚¨çš„ IRIS è¿æ¥ï¼š
    *   å‰å¾€è®¾ç½® > æ‰©å±• > InterSystems ObjectScript ç±»å›¾
    *   è¾“å…¥æ‚¨çš„ IRIS æœåŠ¡å™¨ä¸»æœºã€ç«¯å£ã€å‘½åç©ºé—´ã€ç”¨æˆ·åå’Œå¯†ç 
2.  åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ `.cls` æ–‡ä»¶
3.  å³é”®ç‚¹å‡»å¹¶é€‰æ‹©"ç”Ÿæˆ InterSystems ç±»å›¾"
4.  æ‰©å±•å°†è¿æ¥åˆ°æ‚¨çš„ IRIS æœåŠ¡å™¨å¹¶ä½¿ç”¨æœåŠ¡å™¨ä¸­çš„ç±»ä¿¡æ¯ç”Ÿæˆå›¾è¡¨
5.  ç‚¹å‡»å›¾è¡¨ä¸­çš„ç±»åã€å±æ€§æˆ–æ–¹æ³•å¯ä»¥ï¼š
    *   åœ¨ IRIS Documatic ä¸­æ‰“å¼€ç±»
    *   åœ¨ IRIS ä¸­æŸ¥çœ‹å±æ€§å®šä¹‰
    *   åœ¨ IRIS ä¸­å¯¼èˆªåˆ°æ–¹æ³•å®ç°

#### äº¤äº’åŠŸèƒ½

*   ç‚¹å‡»å›¾è¡¨å…ƒç´ å¯ä»¥ï¼š
    *   è·³è½¬åˆ°ç±»å®šä¹‰
    *   æŸ¥çœ‹å±æ€§å®šä¹‰
    *   å¯¼èˆªåˆ°æ–¹æ³•å®ç°
*   æ”¯æŒå›¾è¡¨ç¼©æ”¾å’Œå¹³ç§»
*   æ¸…æ™°å¯è§†åŒ–ç±»å…³ç³»

### é”®ç›˜å¿«æ·é”®

*   `Ctrl+Alt+U`ï¼šä¸ºå½“å‰æ‰“å¼€çš„ `.cls` æ–‡ä»¶ç”Ÿæˆç±»å›¾

### æ‰©å±•è®¾ç½®

æ­¤æ‰©å±•æä¾›ä»¥ä¸‹å‘½ä»¤ï¼š

*   `intersystems-objectscript-class-diagram-view.generateClassDiagram`ï¼šä¸ºé€‰å®šçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ç”Ÿæˆç±»å›¾
*   `intersystems-objectscript-class-diagram-view.generateIntersystemsClassDiagram`ï¼šä½¿ç”¨ IRIS æœåŠ¡å™¨ä¿¡æ¯ç”Ÿæˆç±»å›¾

æ­¤æ‰©å±•æä¾›ä»¥ä¸‹è®¾ç½®ï¼š

*   `intersystems-objectscript-class-diagram-view.server.host`ï¼šIRIS æœåŠ¡å™¨ä¸»æœº
*   `intersystems-objectscript-class-diagram-view.server.port`ï¼šIRIS æœåŠ¡å™¨ç«¯å£
*   `intersystems-objectscript-class-diagram-view.server.namespace`ï¼šIRIS å‘½åç©ºé—´
*   `intersystems-objectscript-class-diagram-view.server.username`ï¼šIRIS æœåŠ¡å™¨ç”¨æˆ·å
*   `intersystems-objectscript-class-diagram-view.server.password`ï¼šIRIS æœåŠ¡å™¨å¯†ç 

### å·²çŸ¥é—®é¢˜

*   **å­ç±»ç”Ÿæˆ**ï¼šç¼ºå°‘ä¸ºå½“å‰ç±»ç”Ÿæˆå­ç±»å›¾çš„åŠŸèƒ½
*   **å¤§å‹é¡¹ç›®æ€§èƒ½**ï¼š
    *   ä½¿ç”¨å³é”®ä¸ºå¤§å‹æ–‡ä»¶å¤¹ç”Ÿæˆå›¾è¡¨å¯èƒ½ä¼šæœ‰æ˜æ˜¾å»¶è¿Ÿ
    *   å¯¹äºå¤§å‹é¡¹ç›®ç”Ÿæˆçš„ webview/SVG ç¼ºä¹æµç•…çš„ç¼©æ”¾åŠŸèƒ½å’Œé€‚å½“çš„ç¼©æ”¾

è¯·åœ¨ GitHub ä»“åº“ä¸­æŠ¥å‘Šä»»ä½•é—®é¢˜ã€‚

### è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼éšæ—¶æäº¤æ‹‰å–è¯·æ±‚ã€‚

### è®¸å¯è¯

æ­¤æ‰©å±•æ ¹æ® MIT è®¸å¯è¯æˆæƒã€‚

  
ä½œè€…ï¼š[Restæ¢è·¯è€…](http://www.cnblogs.com/Java-Starter/)  
å‡ºå¤„ï¼š[http://www.cnblogs.com/Java-Starter/](http://www.cnblogs.com/Java-Starter/)  
æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„è¯·ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œè¯·åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡è¿æ¥  
Githubï¼š[https://github.com/cjy513203427](https://github.com/cjy513203427)