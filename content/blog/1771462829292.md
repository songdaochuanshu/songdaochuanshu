---
layout: post
title: '凸优化数学基础笔记（三）：方向导数、梯度向量'
date: "2026-02-19T01:00:29Z"
---
凸优化数学基础笔记（三）：方向导数、梯度向量
======================

​ 所谓方向导数的概念是作为偏导数的概念的前瞻数学概念而引入的，是矩阵微分的重要概念，其主要研究多元函数在变量空间沿任意方向的变化率。

1.方向导数及曲线弧线导数
-------------

​ 所谓方向导数的概念是作为偏导数的概念的前瞻数学概念而引入的，是矩阵微分的重要概念，其主要研究多元函数在变量空间沿任意方向的变化率。

​ **Definition 1** 设\\(f:\\mathbf{R}^n\\rightarrow\\mathbf{R}\\) 在点\\(\\mathbf{X}\_0\\)处可微，\\(\\mathbf{P}\\) 是固定不变的非零向量，\\(\\mathbf{e}\\) 是方向\\(\\mathbf{P}\\) 上的单位向量，则称极限

\\\[\\frac{\\part{f(\\mathbf{X\_0})}}{\\part{\\mathbf{P}}}=\\lim\_{t\\rightarrow{0}^{+}}\\frac{f(\\mathbf{X}\_0+t\\mathbf{e})-f(\\mathbf{X}\_0)}{t} \\tag{1} \\\]

为函数\\(f(\\mathbf{X}\_0)\\) 在点\\(\\mathbf{X}\_0\\) 处沿\\(\\mathbf{P}\\) 方向的方向导数，式中\\(\\frac{\\part{f(\\mathbf{X\_0})}}{\\part{\\mathbf{P}}}\\) 是其简单记。

​ **Definition 2** 设\\(f:\\mathbf{R}^{n}\\rightarrow\\mathbf{R}\\) 是连续函数，\\(\\mathbf{X}\_0\\)，\\(\\mathbf{P}\\in\\mathbf{R}^n\\)，且\\(\\mathbf{P}\\neq{\\mathbf{0}}\\)，若有存在\\(\\delta>0\\)。当\\(t\\in(0,\\delta)\\) 时都有\\(f(\\mathbf{X\_0}+t\\mathbf{P})<f(\\mathbf{X}\_0)\\) ，则称\\(\\mathbf{P}\\)为\\(f\\)在点\\(\\mathbf{X}\_0\\) 处的下降方向。若\\(f(\\mathbf{X}\_0+t\\mathbf{P})>f(\\mathbf{X}\_0)\\) ，则称\\(\\mathbf{P}\\)为\\(f\\) 在点\\(\\mathbf{X}\_0\\)处的上升方向。

​ 由此以上的两个定义可立刻得到如下的结论：

1.  若\\(\\frac{\\part{f(\\mathbf{X}\_0)}}{\\part{\\mathbf{P}}}<0\\)，则多元函数\\(f(\\mathbf{X})\\) 从\\(\\mathbf{X}\_0\\) 出发在\\(\\mathbf{X}\_0\\) 附近沿\\(\\mathbf{P}\\) 方向是下降的；
2.  若\\(\\frac{\\part{f(\\mathbf{X}\_0)}}{\\part{\\mathbf{P\_0}}}>0\\)，则多元函数\\(f(\\mathbf{X})\\) 从\\(\\mathbf{X}\_0\\) 出发在\\(\\mathbf{X}\_0\\) 附近沿\\(\\mathbf{P}\\) 方向是上升的；

​ 事实上，若\\(\\frac{\\part{f(\\mathbf{X}\_0)}}{\\part{\\mathbf{P}}}<0\\)，则当\\(\\exist t>0\\) ,必有如下的充分小，根据上式Definition必有如下表达：

\\\[\\frac{f(\\mathbf{X}\_0+t\\mathbf{e})-f(\\mathbf{X}\_0)}{t}<0 \\tag{2} \\\]

即可得：

\\\[f(\\mathbf{X})<f(\\mathbf{X}\_0) \\tag{3} \\\]

其中：\\(\\mathbf{X}=\\mathbf{X}\_0+t\\mathbf{e}\\) 是从 \\(\\mathbf{X}\_0\\) 出发在\\(\\mathbf{P}\\) 方向上的点，说明\\(f(\\mathbf{X})\\) 方向上是下降的点；同理可以说明，\\(f(\\mathbf{X})\\) ，则\\(f(\\mathbf{X})\\)是上升的。

​ 在直角坐标系中，方向导数有如下定理给出的计算公式，以空间三维函数为例。

​ **定理 1** 若三维多元函数\\(f=f(x,y,z)\\)在点\\(M\_0(x\_0,y\_0,z\_0)\\)处可微，\\(\\cos(\\alpha),cos(\\beta),\\cos(\\gamma)\\) 以\\(l\\)方向的方向余弦，则函数\\(u\\)在点\\(M\_0\\) 处沿\\(l\\) 方向导数必存在，且由如下公式给出

\\\[\\frac{\\part{f}}{\\part{l}}=\\frac{\\part{f}}{\\part{x}}\\cos(\\alpha)+\\frac{\\part{f}}{\\part{y}}\\cos{(\\beta)}+\\frac{\\part{f}}{\\part{z}}\\cos{(\\gamma)} \\tag{4} \\\]

其中\\(\\frac{\\part{f}}{\\part{x}},\\frac{\\part{f}}{\\part{y}},\\frac{\\part{f}}{\\part{z}}\\) 是在点\\(M\_0\\) 处的偏导数。

**证 明：** 设在\\(M\_0(x,y,z)\\)的\\(\\delta-\\)领域内存在动点\\(M\\)的坐标为\\(M(x\_0+\\Delta{x},y\_0+\\Delta{y},z\_0+\\Delta{z})\\) 。因为\\(u\\) 在点\\(M\_0\\) 可微，故有

\\\[\\begin{aligned} \\Delta{f}&=f(\\mathbf{M})-f(\\mathbf{M\_0}) \\\\ &=\\frac{\\part{f}}{\\part{x}}\\Delta{x}+\\frac{\\part{f}}{\\part{y}}\\Delta{y}+\\frac{\\part{f}}{\\part{z}}\\Delta{z}+o(r) \\end{aligned} \\tag{5} \\\]

其中\\(r=\\sqrt{\\Delta{x}^2+\\Delta{y}^2+\\Delta{z}^2}\\)， 将上式除以\\(r\\):

\\\[\\frac{\\Delta{f}}{r}=\\frac{\\part{f}}{\\part{x}}\\frac{\\Delta{x}}{r}+\\frac{\\part{f}}{\\part{y}}\\frac{\\Delta{y}}{r}+\\frac{\\part{f}}{\\part{z}}\\frac{\\Delta{z}}{r}+\\frac{o(r)}{r} \\tag{6} \\\]

当\\(r\\rightarrow{0}\\) ,结合切线的定义可得：

\\\[\\frac{\\part{f}}{\\part{l}}=\\frac{\\part{f}}{\\part{x}}\\cos{\\alpha}+\\frac{\\part{f}}{\\part{y}}\\cos{\\beta}+\\frac{\\part{f}}{\\part{z}}\\cos{\\gamma} \\tag{7} \\\]

​ **定理2** 若存在有向曲线\\(C\\)上取一定的\\(M\_0\\) ，作为计算弧长\\(s\\)的起点，并以\\(C\\)之正向作为\\(s\\)增大的方向；\\(M\\)为\\(C\\) 上的一点，在点\\(M\\) 处沿\\(C\\)之正向作一与\\(C\\)的相切射线\\(l\\)，则在点\\(M\\)处，当函数\\(u\\) 沿\\(l\\) 方向的方向导数就等于函数\\(u\\)对\\(s\\)的全导数，既有下式成立：

\\\[\\frac{\\part{u}}{\\part{l}}=\\frac{\\part{u}}{\\part{s}} \\tag{8} \\\]

**证 明：** 设曲线\\(C\\)以\\(s\\)为参数的参数方程为：

\\\[x=x(s),y=y(s),z=z(s) \\tag{9} \\\]

则沿曲线\\(C\\),函数

\\\[u=u\[x(s),y(s),z(s)\] \\tag{10} \\\]

又由于在点\\(M\\)处，函数\\(u\\)的可微、曲线\\(C\\)光滑，按照复合函数求导定理，得到\\(u\\)对\\(s\\)的全导数：

\\\[\\frac{du}{ds}=\\frac{\\part{u}}{\\part{x}}\\frac{dx}{ds}+\\frac{\\part{u}}{\\part{y}}\\frac{dy}{ds}+\\frac{\\part{u}}{\\part{z}}\\frac{d{z}}{ds} \\tag{11} \\\]

注意到\\(\\frac{dx}{ds},\\frac{dy}{ds},\\frac{dz}{ds}\\) 是曲线\\(C\\)的正方向切线\\(l\\)的方向余弦，若将其写成\\(\\cos{(\\alpha)},\\cos{(\\beta)},\\cos{(\\gamma)}\\) ，即得到\\(u\\)对\\(s\\)的全导数：

\\\[\\frac{du}{ds}=\\frac{\\part{u}}{\\part{s}}\\cos(\\alpha)+\\frac{\\part{u}}{\\part{s}}\\cos(\\beta)+\\frac{\\part{u}}{\\part{s}}\\cos{(\\gamma)} \\tag{12} \\\]

即知道，

\\\[\\frac{\\part{u}}{\\part{l}}=\\frac{du}{ds} \\tag{13} \\\]

上面讲的是函数 \\(u\\)沿直线的方向导数。此外，有时还需要研究函数\\(u\\)沿曲线\\(C\\)(正向)的方向导数，其定义的如下：

​ **Definition 3** 从点\\(M\\)出发沿\\(C\\)之正向取一点\\(M\_1\\), 记弧长 \\(\\overset{\\LARGE{\\frown}}{MM\_1}=\\Delta{s}\\) ，若当\\(M\_1\\rightarrow{M}\\)时，比式

\\\[\\frac{\\Delta{u}}{\\Delta{s}}=\\frac{u(M\_1)-u(M)}{|\\overset{\\LARGE{\\frown}}{MM\_1}|} \\tag{14} \\\]

的极限存在，则称此极限为函数\\(u\\) 在点\\(M\\)处沿曲线\\(C\\)(正向)的方向导数，记作\\(\\frac{\\part{u}}{\\part{s}}\\)，即：

\\\[\\frac{\\part{u}}{\\part{s}}=\\frac{du}{ds} \\tag{15} \\\]

**定 理3** 若在点\\(M\\)处函数\\(u\\)在点\\(M\\) 处沿函数\\(\\mathbf{C}\\) (正向)的方向导数，记作\\(\\frac{\\part{u}}{\\part{s}}\\) ，则有

\\\[\\frac{\\part{u}}{\\part{s}}=\\frac{du}{ds} \\tag{16} \\\]

**证 明**：由于在点\\(M\\)处函数\\(u\\) 可微，曲线\\(C\\)光滑，故有全导数\\(\\frac{du}{ds}\\)存在。而\\(\\frac{\\part{u}}{\\part{s}}\\) 按照定义实际上的是一个右极限

\\\[\\frac{\\part{u}}{\\part{s}}=\\lim\_{\\Delta{t}\\rightarrow{0}}\\frac{\\Delta{u}}{\\Delta{s}} \\tag{17} \\\]

故当\\(\\frac{du}{ds}=\\lim\_{\\Delta{t}\\rightarrow{0}}\\frac{\\Delta{u}}{\\Delta{s}}\\) 存在时，就有\\(\\frac{\\part{u}}{\\part{s}}=\\frac{du}{ds}\\).

**推 论**：若在点\\(\\mathbf{M}\\)处函数\\(u\\) 可微、曲线\\(C\\)光滑，则有：

\\\[\\frac{\\part{u}}{\\part{s}}=\\frac{\\part{u}}{\\part{l}} \\tag{18} \\\]

换而言之：函数\\(u\\)在点\\(M\\)处沿曲线\\(C\\)(正向)的方向导数与函数\\(u\\) 在点\\(M\\) 处沿切线方法（指向\\(C\\)的正向一侧）的方向导数相等。

2\. 梯度向量
--------

​ 方向导数解决了多元变量数性函数\\(u(\\mathbf{M})\\) 在给定点处沿某个方向的变化率描述问题，然而从变量空间中的定义点出发，有无穷多个方向，那么函数\\(u(\\mathbf{M})\\) 沿其中哪个方向的变化率最大？最大的变化率又是多少呢? 在科学技术中常常需要讨论的问题，为了解决这个问题，那么我们从方向导数计算公式（12）出发：

\\\[\\frac{\\part{u}}{\\part{l}}=\\frac{\\part{u}}{\\part{x}}\\cos{\\alpha}+ \\frac{\\part{u}}{\\part{y}}\\cos{\\beta}+\\frac{\\part{u}}{\\part{z}}\\cos{\\gamma} \\tag{19} \\\]

其中\\(\\cos{\\alpha},\\cos{\\beta},\\cos{\\gamma}\\) 为\\(l\\)方向的方向余弦，也就是这个方向上的单位矢量 \\(\\boldsymbol{l}=\\cos{\\alpha}\\boldsymbol{i}+\\cos{\\beta}\\boldsymbol{j}+\\cos{\\gamma}\\boldsymbol{k}\\) 的坐标，若把公式（19）右端可以写为\\(\\mathbf{G}\\) 与\\(\\boldsymbol{l}\\) 的数量积：

\\\[\\frac{\\part{u}}{\\part{l}}=\\mathbf{G}\\cdot\\boldsymbol{l}=|\\mathbf{G}|\\cos(\\mathbf{G},\\boldsymbol{l}) \\tag{20} \\\]

显然，\\(\\mathbf{G}\\) 在给定点的处为一固定矢量，上式表示：\\(\\mathbf{G}\\)在\\(l\\)方向上的投影正好等于函数\\(u\\)在该方向上的方向导数，因此，当方向\\(l\\)与\\(\\mathbf{G}\\)的方向一致时，即\\(cos(\\mathbf{G},\\boldsymbol{l})=1\\) 时，方向导数取得最大值，其值为：

\\\[\\frac{\\part{u}}{\\part{l}}=|\\mathbf{G}| \\tag{21} \\\]

由此可知，矢量\\(\\mathbf{G}\\) 的方向就是函数\\(u(M)\\) 变化率最大的方向，其模也正好是这个最大变化率的数值。我们把\\(\\mathbf{G}\\) 叫做函数\\(u(M)\\) 在给定点处的梯度。一般，有如下的定义。

**Definition 4** 以\\(f(\\mathbf{X})\\) 的\\(n\\) 个偏导数为分量的向量称为\\(f(\\mathbf{X})\\) 在\\(\\mathbf{X}\\) 处的梯度，记为：

\\\[\\nabla{f(\\mathbf{X})}=\\left\[\\frac{\\part{f}}{\\part{x\_1}},\\frac{\\part{f}}{\\part{x\_2}},\\frac{\\part{f}}{\\part{x\_3}},...,\\frac{\\part{f}}{\\part{x\_n}}\\right\]^T \\tag{22} \\\]

梯度也可以称为函数\\(f(\\mathbf{X})\\) 关于向量\\(\\mathbf{X}\\) 的一阶导数。

由此，可以从定义给出梯度与方向导数之间的关系。

**定 理 4** 设\\(f:\\mathbf{R}^n\\rightarrow{\\mathbf{R}}\\) 在点\\(\\mathbf{X}\_0\\)处可微，则方向导数与梯度关系：

\\\[\\frac{\\part{f(\\mathbf{X}\_0)}}{\\part{\\mathbf{P}}}=\\nabla{f(\\mathbf{X}\_0)}^T\\mathbf{e} \\tag{23} \\\]

其中 \\(\\mathbf{e}\\) 是\\(\\mathbf{P}\\) 方向上的单位向量。

​ 由这个定理容易得到下列结论：

​ （1）若\\(\\nabla{f(\\mathbf{X}\_0)^T\\mathbf{P}}<0\\)，则\\(P\\)的方向是函数\\(f(\\mathbf{X})\\) 在点\\(\\mathbf{X}\_0\\) 处的下降方向。

​ （2）若\\(\\nabla{f(\\mathbf{X}\_0)}^T\\mathbf{P}>0\\) , 则\\(P\\)的方向是函数\\(f(\\mathbf{X})\\) 在点\\(\\mathbf{X}\_0\\) 处的上升方向。

方向导数的正负决定了函数值的升降，而升降的快慢就由它的绝对值大小决定。绝对值越大，升降的速度就越快。根据式（19）到式（22）即：

\\\[\\left|\\frac{\\part{f(X\_0)}}{\\part{\\mathbf{P}}}\\right|=|\\nabla f(\\mathbf{X}\_0)^T\\mathbf{e}|= |\\nabla{{f}(\\mathbf{X}\_0)}|\\cdot|\\cos(\\nabla{f(\\mathbf{X}\_0)},\\mathbf{e})|\\leq |\\nabla f(\\mathbf{X}\_0)| \\tag{24} \\\]

上式中的等号，当且仅当\\(\\mathbf{e}\\)的方向与\\(\\nabla{f(\\mathbf{X\_0})}\\) 的方向共线才成立。由此可知，得到如下重要结论：

1.  梯度向量是函数值的最速上升方向；
2.  函数在其梯度正交的方向上的变化率为零；
3.  函数在与其梯度成锐角方向上是上升的，而在成钝角的方向是下降的；
4.  梯度的反向是函数值最速下降方法；

对于一个最优化问题，为了尽快得到最优解，在每一步迭代过程中选取的搜索方向\\(\\mathbf{P}\\) 总是希望它等于或者是靠近于目标函数的负梯度（即\\(-\\nabla{f(\\mathbf{X})}\\)）的方向，这样才能使函数值下降的最快。

梯度的性质及以下几个特殊类型的函数的常用梯度公式：

（1）若 \\(f(\\mathbf{X})=c\\) (c为常数)，则 \\(\\nabla f(\\mathbf{X})=0\\)，即 \\(\\nabla{c}=0\\);

（2）\\(\\nabla(cf(\\mathbf{x}))=c\\nabla(f(\\mathbf{x}))\\) （其中\\(c\\)为常数）；

（3）\\(\\nabla(u\\pm v)=\\nabla(u)\\pm\\nabla(v)\\);

(4) \\(\\nabla(uv)=u\\nabla(v)+v\\nabla(u)\\)

(5) \\(\\nabla{\\frac{u}{v}}=\\frac{1}{v^2}(v\\nabla{u}-u\\nabla{v})\\)

(6) \\(\\nabla f(u)=f^{\\prime}(u)\\nabla{u}\\)

（7）\\(\\nabla(f(u,v))=\\frac{\\part{f}}{\\part{u}}\\nabla(u)+\\frac{\\part{f}}{\\part{v}}\\nabla{v}\\)

(8) \\(\\nabla{\\mathbf{b}^T\\mathbf{X}}=\\mathbf{b}\\)

(9) \\(\\nabla(\\mathbf{X}^T\\mathbf{X})=2\\mathbf{X}\\)

(10) 若 \\(Q\\) 是对称矩阵矩阵，则 \\(\\nabla(\\mathbf{X}^T\\mathbf{Q}\\mathbf{X})=2\\mathbf(QX)\\)