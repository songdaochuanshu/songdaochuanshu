var y=(i,r,o)=>{let n=o[0],{position:s,word:e}=n,l=[],f=new Set;for(;s+e.length<=r&&o.length!==0;){f.add(e),l.push({position:s,length:e.length});let c=s+e.length;for(o.shift();o.length!==0&&(n=o[0],s=n.position,e=n.word,c>s);)o.shift()}return{hits:l,start:i,end:r,count:f.size}},L=(i,r,o=!1)=>{let n=[],s=new Set;return i.forEach(e=>{let l=e.length;if(l===0)return;let f=0,c=-1;for(o||(r=r.toLowerCase(),e=e.toLowerCase());(c=r.indexOf(e,f))>-1;)n.push({position:c,word:e}),s.add(e),f=c+l}),n.sort((e,l)=>e.position!==l.position?e.position-l.position:l.word.length-e.word.length),[n,s]},S=(i,r)=>{let o="",n=r.start;for(let{position:s,length:e}of r.hits)o+=i.substring(n,s),n=s+e,o+=`<mark class="search-keyword">${i.substr(s,e)}</mark>`;return o+=i.substring(n,r.end),o},b=(i,r,o)=>{if(!i){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}let n=[],s=document.getElementById(r),e=document.getElementById(o),l=c=>{let p=[];return n.forEach(({title:t,content:m,url:h})=>{let[C,a]=L(c,t),[u,E]=L(c,m),x=new Set([...a,...E]).size,$=C.length+u.length;if($===0)return;let I=[];C.length!==0&&I.push(y(0,t.length,C));let O=[];for(;u.length!==0;){let d=u[0],{position:g}=d,M=Math.max(0,g-20),T=Math.min(m.length,g+80);O.push(y(M,T,u))}O.sort((d,g)=>d.count!==g.count?g.count-d.count:d.hits.length!==g.hits.length?g.hits.length-d.hits.length:d.start-g.start);let w="";h=new URL(h,location.origin),h.searchParams.append("highlight",c.join(" ")),I.length!==0?w+=`<li><a href="${h.href}" class="search-result-title">${S(t,I[0])}</a>`:w+=`<li><a href="${h.href}" class="search-result-title">${t}</a>`,O.forEach(d=>{w+=`<a href="${h.href}"><p class="search-result">${S(m,d)}...</p></a>`}),w+="</li>",p.push({item:w,id:p.length,hitCount:$,includedCount:x})}),p};(()=>{let c=!i.endsWith("json");fetch(i).then(p=>p.text()).then(p=>{n=c?[...new DOMParser().parseFromString(p,"text/xml").querySelectorAll("entry")].map(t=>({title:t.querySelector("title").textContent,content:t.querySelector("content").textContent,url:t.querySelector("url").textContent})):JSON.parse(p),n=n.filter(t=>t.title).map(t=>(t.title=t.title.trim(),t.content=t.content?t.content.trim().replace(/<[^>]+>/g,""):"",t.url=decodeURIComponent(t.url).replace(/\/{2,}/g,"/"),t)),!!s&&s.addEventListener("input",()=>{let t=s.value.trim().toLowerCase(),m=t.split(/[-\s]+/),h=[];t.length>0&&(h=l(m)),h.sort((a,u)=>a.includedCount!==u.includedCount?u.includedCount-a.includedCount:a.hitCount!==u.hitCount?u.hitCount-a.hitCount:u.id-a.id);let C=window.CONFIG.i18n.hits.replace(/\$\{hits}/,h.length);e.innerHTML=`<div class="search-stats">${C}</div>
            <ul class="search-result-list">${h.map(a=>a.item).join("")}</ul>`})})})()};document.addEventListener("DOMContentLoaded",()=>{b(window.CONFIG.local_search.path,"local-search-input","local-search-result")});
